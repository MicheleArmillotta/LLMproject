[
  {
    "function_name": "module_layout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4399-4405",
    "snippet": "void module_layout(struct module *mod,\n\t\t   struct modversion_info *ver,\n\t\t   struct kernel_param *kp,\n\t\t   struct kernel_symbol *ks,\n\t\t   struct tracepoint * const *tp)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_layout(struct module *mod,\n\t\t   struct modversion_info *ver,\n\t\t   struct kernel_param *kp,\n\t\t   struct kernel_symbol *ks,\n\t\t   struct tracepoint * const *tp)\n{\n}"
  },
  {
    "function_name": "print_modules",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4377-4394",
    "snippet": "void print_modules(void)\n{\n\tstruct module *mod;\n\tchar buf[MODULE_FLAGS_BUF_SIZE];\n\n\tprintk(KERN_DEFAULT \"Modules linked in:\");\n\t/* Most callers should already have preempt disabled, but make sure */\n\tpreempt_disable();\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tpr_cont(\" %s%s\", mod->name, module_flags(mod, buf));\n\t}\n\tpreempt_enable();\n\tif (last_unloaded_module[0])\n\t\tpr_cont(\" [last unloaded: %s]\", last_unloaded_module);\n\tpr_cont(\"\\n\");\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define MODULE_FLAGS_BUF_SIZE (TAINT_FLAGS_COUNT + 4)"
    ],
    "globals_used": [
      "static LIST_HEAD(modules);",
      "static char last_unloaded_module[MODULE_NAME_LEN+1];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\"\\n\""
          ],
          "line": 4393
        },
        "resolved": true,
        "details": {
          "function_name": "pr_cont_pool_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/workqueue.c",
          "lines": "4431-4437",
          "snippet": "static void pr_cont_pool_info(struct worker_pool *pool)\n{\n\tpr_cont(\" cpus=%*pbl\", nr_cpumask_bits, pool->attrs->cpumask);\n\tif (pool->node != NUMA_NO_NODE)\n\t\tpr_cont(\" node=%d\", pool->node);\n\tpr_cont(\" flags=0x%x nice=%d\", pool->flags, pool->attrs->nice);\n}",
          "includes": [
            "#include <trace/events/workqueue.h>",
            "#include \"workqueue_internal.h\"",
            "#include <linux/nmi.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/rculist.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/jhash.h>",
            "#include <linux/idr.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/freezer.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/kthread.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/completion.h>",
            "#include <linux/signal.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU_SHARED_ALIGNED(struct worker_pool [NR_STD_WORKER_POOLS], cpu_worker_pools);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/workqueue.h>\n#include \"workqueue_internal.h\"\n#include <linux/nmi.h>\n#include <linux/sched/isolation.h>\n#include <linux/uaccess.h>\n#include <linux/moduleparam.h>\n#include <linux/nodemask.h>\n#include <linux/rculist.h>\n#include <linux/hashtable.h>\n#include <linux/jhash.h>\n#include <linux/idr.h>\n#include <linux/lockdep.h>\n#include <linux/debug_locks.h>\n#include <linux/freezer.h>\n#include <linux/mempolicy.h>\n#include <linux/hardirq.h>\n#include <linux/kthread.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/completion.h>\n#include <linux/signal.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic DEFINE_PER_CPU_SHARED_ALIGNED(struct worker_pool [NR_STD_WORKER_POOLS], cpu_worker_pools);\n\nstatic void pr_cont_pool_info(struct worker_pool *pool)\n{\n\tpr_cont(\" cpus=%*pbl\", nr_cpumask_bits, pool->attrs->cpumask);\n\tif (pool->node != NUMA_NO_NODE)\n\t\tpr_cont(\" node=%d\", pool->node);\n\tpr_cont(\" flags=0x%x nice=%d\", pool->flags, pool->attrs->nice);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\" [last unloaded: %s]\"",
            "last_unloaded_module"
          ],
          "line": 4392
        },
        "resolved": true,
        "details": {
          "function_name": "pr_cont_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/workqueue.c",
          "lines": "4439-4451",
          "snippet": "static void pr_cont_work(bool comma, struct work_struct *work)\n{\n\tif (work->func == wq_barrier_func) {\n\t\tstruct wq_barrier *barr;\n\n\t\tbarr = container_of(work, struct wq_barrier, work);\n\n\t\tpr_cont(\"%s BAR(%d)\", comma ? \",\" : \"\",\n\t\t\ttask_pid_nr(barr->task));\n\t} else {\n\t\tpr_cont(\"%s %pf\", comma ? \",\" : \"\", work->func);\n\t}\n}",
          "includes": [
            "#include <trace/events/workqueue.h>",
            "#include \"workqueue_internal.h\"",
            "#include <linux/nmi.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/rculist.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/jhash.h>",
            "#include <linux/idr.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/freezer.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/kthread.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/completion.h>",
            "#include <linux/signal.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/workqueue.h>\n#include \"workqueue_internal.h\"\n#include <linux/nmi.h>\n#include <linux/sched/isolation.h>\n#include <linux/uaccess.h>\n#include <linux/moduleparam.h>\n#include <linux/nodemask.h>\n#include <linux/rculist.h>\n#include <linux/hashtable.h>\n#include <linux/jhash.h>\n#include <linux/idr.h>\n#include <linux/lockdep.h>\n#include <linux/debug_locks.h>\n#include <linux/freezer.h>\n#include <linux/mempolicy.h>\n#include <linux/hardirq.h>\n#include <linux/kthread.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/completion.h>\n#include <linux/signal.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic void pr_cont_work(bool comma, struct work_struct *work)\n{\n\tif (work->func == wq_barrier_func) {\n\t\tstruct wq_barrier *barr;\n\n\t\tbarr = container_of(work, struct wq_barrier, work);\n\n\t\tpr_cont(\"%s BAR(%d)\", comma ? \",\" : \"\",\n\t\t\ttask_pid_nr(barr->task));\n\t} else {\n\t\tpr_cont(\"%s %pf\", comma ? \",\" : \"\", work->func);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 4390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_cont",
          "args": [
            "\" %s%s\"",
            "mod->name",
            "module_flags(mod, buf)"
          ],
          "line": 4388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_flags",
          "args": [
            "mod",
            "buf"
          ],
          "line": 4388
        },
        "resolved": true,
        "details": {
          "function_name": "module_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4148-4169",
          "snippet": "static char *module_flags(struct module *mod, char *buf)\n{\n\tint bx = 0;\n\n\tBUG_ON(mod->state == MODULE_STATE_UNFORMED);\n\tif (mod->taints ||\n\t    mod->state == MODULE_STATE_GOING ||\n\t    mod->state == MODULE_STATE_COMING) {\n\t\tbuf[bx++] = '(';\n\t\tbx += module_flags_taint(mod, buf + bx);\n\t\t/* Show a - for module-is-being-unloaded */\n\t\tif (mod->state == MODULE_STATE_GOING)\n\t\t\tbuf[bx++] = '-';\n\t\t/* Show a + for module-is-being-loaded */\n\t\tif (mod->state == MODULE_STATE_COMING)\n\t\t\tbuf[bx++] = '+';\n\t\tbuf[bx++] = ')';\n\t}\n\tbuf[bx] = '\\0';\n\n\treturn buf;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *module_flags(struct module *mod, char *buf)\n{\n\tint bx = 0;\n\n\tBUG_ON(mod->state == MODULE_STATE_UNFORMED);\n\tif (mod->taints ||\n\t    mod->state == MODULE_STATE_GOING ||\n\t    mod->state == MODULE_STATE_COMING) {\n\t\tbuf[bx++] = '(';\n\t\tbx += module_flags_taint(mod, buf + bx);\n\t\t/* Show a - for module-is-being-unloaded */\n\t\tif (mod->state == MODULE_STATE_GOING)\n\t\t\tbuf[bx++] = '-';\n\t\t/* Show a + for module-is-being-loaded */\n\t\tif (mod->state == MODULE_STATE_COMING)\n\t\t\tbuf[bx++] = '+';\n\t\tbuf[bx++] = ')';\n\t}\n\tbuf[bx] = '\\0';\n\n\treturn buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 4385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 4384
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_DEFAULT \"Modules linked in:\""
          ],
          "line": 4382
        },
        "resolved": true,
        "details": {
          "function_name": "kauditd_printk_skb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/audit.c",
          "lines": "540-547",
          "snippet": "static void kauditd_printk_skb(struct sk_buff *skb)\n{\n\tstruct nlmsghdr *nlh = nlmsg_hdr(skb);\n\tchar *data = nlmsg_data(nlh);\n\n\tif (nlh->nlmsg_type != AUDIT_EOE && printk_ratelimit())\n\t\tpr_notice(\"type=%d %s\\n\", nlh->nlmsg_type, data);\n}",
          "includes": [
            "#include \"audit.h\"",
            "#include <net/netns/generic.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/freezer.h>",
            "#include <linux/security.h>",
            "#include <linux/skbuff.h>",
            "#include <net/netlink.h>",
            "#include <net/sock.h>",
            "#include <linux/audit.h>",
            "#include <linux/slab.h>",
            "#include <linux/pid.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kthread.h>",
            "#include <linux/err.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/init.h>",
            "#include <linux/file.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"audit.h\"\n#include <net/netns/generic.h>\n#include <linux/pid_namespace.h>\n#include <linux/freezer.h>\n#include <linux/security.h>\n#include <linux/skbuff.h>\n#include <net/netlink.h>\n#include <net/sock.h>\n#include <linux/audit.h>\n#include <linux/slab.h>\n#include <linux/pid.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/rcupdate.h>\n#include <linux/spinlock.h>\n#include <linux/syscalls.h>\n#include <linux/kernel.h>\n#include <linux/kthread.h>\n#include <linux/err.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/init.h>\n#include <linux/file.h>\n\nstatic void kauditd_printk_skb(struct sk_buff *skb)\n{\n\tstruct nlmsghdr *nlh = nlmsg_hdr(skb);\n\tchar *data = nlmsg_data(nlh);\n\n\tif (nlh->nlmsg_type != AUDIT_EOE && printk_ratelimit())\n\t\tpr_notice(\"type=%d %s\\n\", nlh->nlmsg_type, data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define MODULE_FLAGS_BUF_SIZE (TAINT_FLAGS_COUNT + 4)\n\nstatic LIST_HEAD(modules);\nstatic char last_unloaded_module[MODULE_NAME_LEN+1];\n\nvoid print_modules(void)\n{\n\tstruct module *mod;\n\tchar buf[MODULE_FLAGS_BUF_SIZE];\n\n\tprintk(KERN_DEFAULT \"Modules linked in:\");\n\t/* Most callers should already have preempt disabled, but make sure */\n\tpreempt_disable();\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tpr_cont(\" %s%s\", mod->name, module_flags(mod, buf));\n\t}\n\tpreempt_enable();\n\tif (last_unloaded_module[0])\n\t\tpr_cont(\" [last unloaded: %s]\", last_unloaded_module);\n\tpr_cont(\"\\n\");\n}"
  },
  {
    "function_name": "__module_text_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4363-4373",
    "snippet": "struct module *__module_text_address(unsigned long addr)\n{\n\tstruct module *mod = __module_address(addr);\n\tif (mod) {\n\t\t/* Make sure it's within the text section. */\n\t\tif (!within(addr, mod->init_layout.base, mod->init_layout.text_size)\n\t\t    && !within(addr, mod->core_layout.base, mod->core_layout.text_size))\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "within",
          "args": [
            "addr",
            "mod->core_layout.base",
            "mod->core_layout.text_size"
          ],
          "line": 4369
        },
        "resolved": true,
        "details": {
          "function_name": "within",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3896-3899",
          "snippet": "static inline int within(unsigned long addr, void *start, unsigned long size)\n{\n\treturn ((void *)addr >= start && (void *)addr < start + size);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int within(unsigned long addr, void *start, unsigned long size)\n{\n\treturn ((void *)addr >= start && (void *)addr < start + size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__module_address",
          "args": [
            "addr"
          ],
          "line": 4365
        },
        "resolved": true,
        "details": {
          "function_name": "__module_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4318-4334",
          "snippet": "struct module *__module_address(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tif (addr < module_addr_min || addr > module_addr_max)\n\t\treturn NULL;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tmod = mod_find(addr);\n\tif (mod) {\n\t\tBUG_ON(!within_module(addr, mod));\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define module_addr_max mod_tree.addr_max",
            "#define module_addr_min mod_tree.addr_min"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define module_addr_max mod_tree.addr_max\n#define module_addr_min mod_tree.addr_min\n\nstruct module *__module_address(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tif (addr < module_addr_min || addr > module_addr_max)\n\t\treturn NULL;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tmod = mod_find(addr);\n\tif (mod) {\n\t\tBUG_ON(!within_module(addr, mod));\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstruct module *__module_text_address(unsigned long addr)\n{\n\tstruct module *mod = __module_address(addr);\n\tif (mod) {\n\t\t/* Make sure it's within the text section. */\n\t\tif (!within(addr, mod->init_layout.base, mod->init_layout.text_size)\n\t\t    && !within(addr, mod->core_layout.base, mod->core_layout.text_size))\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}"
  },
  {
    "function_name": "is_module_text_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4345-4354",
    "snippet": "bool is_module_text_address(unsigned long addr)\n{\n\tbool ret;\n\n\tpreempt_disable();\n\tret = __module_text_address(addr) != NULL;\n\tpreempt_enable();\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 4351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__module_text_address",
          "args": [
            "addr"
          ],
          "line": 4350
        },
        "resolved": true,
        "details": {
          "function_name": "__module_text_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4363-4373",
          "snippet": "struct module *__module_text_address(unsigned long addr)\n{\n\tstruct module *mod = __module_address(addr);\n\tif (mod) {\n\t\t/* Make sure it's within the text section. */\n\t\tif (!within(addr, mod->init_layout.base, mod->init_layout.text_size)\n\t\t    && !within(addr, mod->core_layout.base, mod->core_layout.text_size))\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstruct module *__module_text_address(unsigned long addr)\n{\n\tstruct module *mod = __module_address(addr);\n\tif (mod) {\n\t\t/* Make sure it's within the text section. */\n\t\tif (!within(addr, mod->init_layout.base, mod->init_layout.text_size)\n\t\t    && !within(addr, mod->core_layout.base, mod->core_layout.text_size))\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 4349
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nbool is_module_text_address(unsigned long addr)\n{\n\tbool ret;\n\n\tpreempt_disable();\n\tret = __module_text_address(addr) != NULL;\n\tpreempt_enable();\n\n\treturn ret;\n}"
  },
  {
    "function_name": "__module_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4318-4334",
    "snippet": "struct module *__module_address(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tif (addr < module_addr_min || addr > module_addr_max)\n\t\treturn NULL;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tmod = mod_find(addr);\n\tif (mod) {\n\t\tBUG_ON(!within_module(addr, mod));\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define module_addr_max mod_tree.addr_max",
      "#define module_addr_min mod_tree.addr_min"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!within_module(addr, mod)"
          ],
          "line": 4329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "within_module",
          "args": [
            "addr",
            "mod"
          ],
          "line": 4329
        },
        "resolved": true,
        "details": {
          "function_name": "trace_kprobe_within_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_kprobe.c",
          "lines": "57-63",
          "snippet": "static nokprobe_inline bool trace_kprobe_within_module(struct trace_kprobe *tk,\n\t\t\t\t\t\t struct module *mod)\n{\n\tint len = strlen(mod->name);\n\tconst char *name = trace_kprobe_symbol(tk);\n\treturn strncmp(mod->name, name, len) == 0 && name[len] == ':';\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include \"trace_kprobe_selftest.h\"",
            "#include <linux/error-injection.h>",
            "#include <linux/rculist.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int register_kprobe_event(struct trace_kprobe *tk);",
            "static int unregister_kprobe_event(struct trace_kprobe *tk);",
            "NOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Kprobe handler */\nstatic nokprobe_inline"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include \"trace_kprobe_selftest.h\"\n#include <linux/error-injection.h>\n#include <linux/rculist.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n\nstatic int register_kprobe_event(struct trace_kprobe *tk);\nstatic int unregister_kprobe_event(struct trace_kprobe *tk);\nNOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Kprobe handler */\nstatic nokprobe_inline;\n\nstatic nokprobe_inline bool trace_kprobe_within_module(struct trace_kprobe *tk,\n\t\t\t\t\t\t struct module *mod)\n{\n\tint len = strlen(mod->name);\n\tconst char *name = trace_kprobe_symbol(tk);\n\treturn strncmp(mod->name, name, len) == 0 && name[len] == ':';\n}"
        }
      },
      {
        "call_info": {
          "callee": "mod_find",
          "args": [
            "addr"
          ],
          "line": 4327
        },
        "resolved": true,
        "details": {
          "function_name": "mod_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "220-230",
          "snippet": "static struct module *mod_find(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (within_module(addr, mod))\n\t\t\treturn mod;\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(modules);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic struct module *mod_find(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (within_module(addr, mod))\n\t\t\treturn mod;\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_assert_mutex_or_preempt",
          "args": [],
          "line": 4325
        },
        "resolved": true,
        "details": {
          "function_name": "module_assert_mutex_or_preempt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "265-274",
          "snippet": "static void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define module_addr_max mod_tree.addr_max\n#define module_addr_min mod_tree.addr_min\n\nstruct module *__module_address(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tif (addr < module_addr_min || addr > module_addr_max)\n\t\treturn NULL;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tmod = mod_find(addr);\n\tif (mod) {\n\t\tBUG_ON(!within_module(addr, mod));\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}"
  },
  {
    "function_name": "is_module_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4300-4309",
    "snippet": "bool is_module_address(unsigned long addr)\n{\n\tbool ret;\n\n\tpreempt_disable();\n\tret = __module_address(addr) != NULL;\n\tpreempt_enable();\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 4306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__module_address",
          "args": [
            "addr"
          ],
          "line": 4305
        },
        "resolved": true,
        "details": {
          "function_name": "__module_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4318-4334",
          "snippet": "struct module *__module_address(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tif (addr < module_addr_min || addr > module_addr_max)\n\t\treturn NULL;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tmod = mod_find(addr);\n\tif (mod) {\n\t\tBUG_ON(!within_module(addr, mod));\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define module_addr_max mod_tree.addr_max",
            "#define module_addr_min mod_tree.addr_min"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define module_addr_max mod_tree.addr_max\n#define module_addr_min mod_tree.addr_min\n\nstruct module *__module_address(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tif (addr < module_addr_min || addr > module_addr_max)\n\t\treturn NULL;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tmod = mod_find(addr);\n\tif (mod) {\n\t\tBUG_ON(!within_module(addr, mod));\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 4304
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nbool is_module_address(unsigned long addr)\n{\n\tbool ret;\n\n\tpreempt_disable();\n\tret = __module_address(addr) != NULL;\n\tpreempt_enable();\n\n\treturn ret;\n}"
  },
  {
    "function_name": "search_module_extables",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4267-4291",
    "snippet": "const struct exception_table_entry *search_module_extables(unsigned long addr)\n{\n\tconst struct exception_table_entry *e = NULL;\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tmod = __module_address(addr);\n\tif (!mod)\n\t\tgoto out;\n\n\tif (!mod->num_exentries)\n\t\tgoto out;\n\n\te = search_extable(mod->extable,\n\t\t\t   mod->num_exentries,\n\t\t\t   addr);\nout:\n\tpreempt_enable();\n\n\t/*\n\t * Now, if we found one, we are running inside it now, hence\n\t * we cannot unload the module, hence no refcnt needed.\n\t */\n\treturn e;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 4284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "search_extable",
          "args": [
            "mod->extable",
            "mod->num_exentries",
            "addr"
          ],
          "line": 4280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__module_address",
          "args": [
            "addr"
          ],
          "line": 4273
        },
        "resolved": true,
        "details": {
          "function_name": "__module_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4318-4334",
          "snippet": "struct module *__module_address(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tif (addr < module_addr_min || addr > module_addr_max)\n\t\treturn NULL;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tmod = mod_find(addr);\n\tif (mod) {\n\t\tBUG_ON(!within_module(addr, mod));\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define module_addr_max mod_tree.addr_max",
            "#define module_addr_min mod_tree.addr_min"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define module_addr_max mod_tree.addr_max\n#define module_addr_min mod_tree.addr_min\n\nstruct module *__module_address(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tif (addr < module_addr_min || addr > module_addr_max)\n\t\treturn NULL;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tmod = mod_find(addr);\n\tif (mod) {\n\t\tBUG_ON(!within_module(addr, mod));\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 4272
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nconst struct exception_table_entry *search_module_extables(unsigned long addr)\n{\n\tconst struct exception_table_entry *e = NULL;\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tmod = __module_address(addr);\n\tif (!mod)\n\t\tgoto out;\n\n\tif (!mod->num_exentries)\n\t\tgoto out;\n\n\te = search_extable(mod->extable,\n\t\t\t   mod->num_exentries,\n\t\t\t   addr);\nout:\n\tpreempt_enable();\n\n\t/*\n\t * Now, if we found one, we are running inside it now, hence\n\t * we cannot unload the module, hence no refcnt needed.\n\t */\n\treturn e;\n}"
  },
  {
    "function_name": "proc_modules_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4258-4262",
    "snippet": "static int __init proc_modules_init(void)\n{\n\tproc_create(\"modules\", 0, NULL, &proc_modules_operations);\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_create",
          "args": [
            "\"modules\"",
            "0",
            "NULL",
            "&proc_modules_operations"
          ],
          "line": 4260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic int __init proc_modules_init(void)\n{\n\tproc_create(\"modules\", 0, NULL, &proc_modules_operations);\n\treturn 0;\n}"
  },
  {
    "function_name": "modules_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4239-4249",
    "snippet": "static int modules_open(struct inode *inode, struct file *file)\n{\n\tint err = seq_open(file, &modules_op);\n\n\tif (!err) {\n\t\tstruct seq_file *m = file->private_data;\n\t\tm->private = kallsyms_show_value() ? NULL : (void *)8ul;\n\t}\n\n\treturn err;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kallsyms_show_value",
          "args": [],
          "line": 4245
        },
        "resolved": true,
        "details": {
          "function_name": "kallsyms_show_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/kallsyms.c",
          "lines": "645-659",
          "snippet": "int kallsyms_show_value(void)\n{\n\tswitch (kptr_restrict) {\n\tcase 0:\n\t\tif (kallsyms_for_perf())\n\t\t\treturn 1;\n\t/* fallthrough */\n\tcase 1:\n\t\tif (has_capability_noaudit(current, CAP_SYSLOG))\n\t\t\treturn 1;\n\t/* fallthrough */\n\tdefault:\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include <linux/compiler.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/filter.h>",
            "#include <linux/slab.h>",
            "#include <linux/ctype.h>",
            "#include <linux/sched.h>\t/* for cond_resched */",
            "#include <linux/proc_fs.h>",
            "#include <linux/err.h>",
            "#include <linux/kdb.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/init.h>",
            "#include <linux/kallsyms.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/compiler.h>\n#include <linux/ftrace.h>\n#include <linux/filter.h>\n#include <linux/slab.h>\n#include <linux/ctype.h>\n#include <linux/sched.h>\t/* for cond_resched */\n#include <linux/proc_fs.h>\n#include <linux/err.h>\n#include <linux/kdb.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <linux/init.h>\n#include <linux/kallsyms.h>\n\nint kallsyms_show_value(void)\n{\n\tswitch (kptr_restrict) {\n\tcase 0:\n\t\tif (kallsyms_for_perf())\n\t\t\treturn 1;\n\t/* fallthrough */\n\tcase 1:\n\t\tif (has_capability_noaudit(current, CAP_SYSLOG))\n\t\t\treturn 1;\n\t/* fallthrough */\n\tdefault:\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_open",
          "args": [
            "file",
            "&modules_op"
          ],
          "line": 4241
        },
        "resolved": true,
        "details": {
          "function_name": "gcov_seq_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/gcov/fs.c",
          "lines": "179-213",
          "snippet": "static int gcov_seq_open(struct inode *inode, struct file *file)\n{\n\tstruct gcov_node *node = inode->i_private;\n\tstruct gcov_iterator *iter;\n\tstruct seq_file *seq;\n\tstruct gcov_info *info;\n\tint rc = -ENOMEM;\n\n\tmutex_lock(&node_lock);\n\t/*\n\t * Read from a profiling data copy to minimize reference tracking\n\t * complexity and concurrent access and to keep accumulating multiple\n\t * profiling data sets associated with one node simple.\n\t */\n\tinfo = get_accumulated_info(node);\n\tif (!info)\n\t\tgoto out_unlock;\n\titer = gcov_iter_new(info);\n\tif (!iter)\n\t\tgoto err_free_info;\n\trc = seq_open(file, &gcov_seq_ops);\n\tif (rc)\n\t\tgoto err_free_iter_info;\n\tseq = file->private_data;\n\tseq->private = iter;\nout_unlock:\n\tmutex_unlock(&node_lock);\n\treturn rc;\n\nerr_free_iter_info:\n\tgcov_iter_free(iter);\nerr_free_info:\n\tgcov_info_free(info);\n\tgoto out_unlock;\n}",
          "includes": [
            "#include \"gcov.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/mutex.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/list.h>",
            "#include <linux/fs.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(node_lock);",
            "static const struct seq_operations gcov_seq_ops = {\n\t.start\t= gcov_seq_start,\n\t.next\t= gcov_seq_next,\n\t.show\t= gcov_seq_show,\n\t.stop\t= gcov_seq_stop,\n};",
            "static void remove_node(struct gcov_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"gcov.h\"\n#include <linux/seq_file.h>\n#include <linux/mutex.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/list.h>\n#include <linux/fs.h>\n#include <linux/debugfs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(node_lock);\nstatic const struct seq_operations gcov_seq_ops = {\n\t.start\t= gcov_seq_start,\n\t.next\t= gcov_seq_next,\n\t.show\t= gcov_seq_show,\n\t.stop\t= gcov_seq_stop,\n};\nstatic void remove_node(struct gcov_node *node);\n\nstatic int gcov_seq_open(struct inode *inode, struct file *file)\n{\n\tstruct gcov_node *node = inode->i_private;\n\tstruct gcov_iterator *iter;\n\tstruct seq_file *seq;\n\tstruct gcov_info *info;\n\tint rc = -ENOMEM;\n\n\tmutex_lock(&node_lock);\n\t/*\n\t * Read from a profiling data copy to minimize reference tracking\n\t * complexity and concurrent access and to keep accumulating multiple\n\t * profiling data sets associated with one node simple.\n\t */\n\tinfo = get_accumulated_info(node);\n\tif (!info)\n\t\tgoto out_unlock;\n\titer = gcov_iter_new(info);\n\tif (!iter)\n\t\tgoto err_free_info;\n\trc = seq_open(file, &gcov_seq_ops);\n\tif (rc)\n\t\tgoto err_free_iter_info;\n\tseq = file->private_data;\n\tseq->private = iter;\nout_unlock:\n\tmutex_unlock(&node_lock);\n\treturn rc;\n\nerr_free_iter_info:\n\tgcov_iter_free(iter);\nerr_free_info:\n\tgcov_info_free(info);\n\tgoto out_unlock;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int modules_open(struct inode *inode, struct file *file)\n{\n\tint err = seq_open(file, &modules_op);\n\n\tif (!err) {\n\t\tstruct seq_file *m = file->private_data;\n\t\tm->private = kallsyms_show_value() ? NULL : (void *)8ul;\n\t}\n\n\treturn err;\n}"
  },
  {
    "function_name": "m_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4189-4218",
    "snippet": "static int m_show(struct seq_file *m, void *p)\n{\n\tstruct module *mod = list_entry(p, struct module, list);\n\tchar buf[MODULE_FLAGS_BUF_SIZE];\n\tvoid *value;\n\n\t/* We always ignore unformed modules. */\n\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\treturn 0;\n\n\tseq_printf(m, \"%s %u\",\n\t\t   mod->name, mod->init_layout.size + mod->core_layout.size);\n\tprint_unload_info(m, mod);\n\n\t/* Informative for users. */\n\tseq_printf(m, \" %s\",\n\t\t   mod->state == MODULE_STATE_GOING ? \"Unloading\" :\n\t\t   mod->state == MODULE_STATE_COMING ? \"Loading\" :\n\t\t   \"Live\");\n\t/* Used by oprofile and other similar tools. */\n\tvalue = m->private ? NULL : mod->core_layout.base;\n\tseq_printf(m, \" 0x%px\", value);\n\n\t/* Taints info */\n\tif (mod->taints)\n\t\tseq_printf(m, \" %s\", module_flags(mod, buf));\n\n\tseq_puts(m, \"\\n\");\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define MODULE_FLAGS_BUF_SIZE (TAINT_FLAGS_COUNT + 4)"
    ],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"\\n\""
          ],
          "line": 4216
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_seq.c",
          "lines": "208-223",
          "snippet": "void trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\" %s\"",
            "module_flags(mod, buf)"
          ],
          "line": 4214
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_seq.c",
          "lines": "84-103",
          "snippet": "void trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_flags",
          "args": [
            "mod",
            "buf"
          ],
          "line": 4214
        },
        "resolved": true,
        "details": {
          "function_name": "module_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4148-4169",
          "snippet": "static char *module_flags(struct module *mod, char *buf)\n{\n\tint bx = 0;\n\n\tBUG_ON(mod->state == MODULE_STATE_UNFORMED);\n\tif (mod->taints ||\n\t    mod->state == MODULE_STATE_GOING ||\n\t    mod->state == MODULE_STATE_COMING) {\n\t\tbuf[bx++] = '(';\n\t\tbx += module_flags_taint(mod, buf + bx);\n\t\t/* Show a - for module-is-being-unloaded */\n\t\tif (mod->state == MODULE_STATE_GOING)\n\t\t\tbuf[bx++] = '-';\n\t\t/* Show a + for module-is-being-loaded */\n\t\tif (mod->state == MODULE_STATE_COMING)\n\t\t\tbuf[bx++] = '+';\n\t\tbuf[bx++] = ')';\n\t}\n\tbuf[bx] = '\\0';\n\n\treturn buf;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *module_flags(struct module *mod, char *buf)\n{\n\tint bx = 0;\n\n\tBUG_ON(mod->state == MODULE_STATE_UNFORMED);\n\tif (mod->taints ||\n\t    mod->state == MODULE_STATE_GOING ||\n\t    mod->state == MODULE_STATE_COMING) {\n\t\tbuf[bx++] = '(';\n\t\tbx += module_flags_taint(mod, buf + bx);\n\t\t/* Show a - for module-is-being-unloaded */\n\t\tif (mod->state == MODULE_STATE_GOING)\n\t\t\tbuf[bx++] = '-';\n\t\t/* Show a + for module-is-being-loaded */\n\t\tif (mod->state == MODULE_STATE_COMING)\n\t\t\tbuf[bx++] = '+';\n\t\tbuf[bx++] = ')';\n\t}\n\tbuf[bx] = '\\0';\n\n\treturn buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_unload_info",
          "args": [
            "m",
            "mod"
          ],
          "line": 4201
        },
        "resolved": true,
        "details": {
          "function_name": "print_unload_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1147-1151",
          "snippet": "static inline void print_unload_info(struct seq_file *m, struct module *mod)\n{\n\t/* We don't know the usage count, or what modules are using. */\n\tseq_puts(m, \" - -\");\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(modules);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic inline void print_unload_info(struct seq_file *m, struct module *mod)\n{\n\t/* We don't know the usage count, or what modules are using. */\n\tseq_puts(m, \" - -\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "p",
            "structmodule",
            "list"
          ],
          "line": 4191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define MODULE_FLAGS_BUF_SIZE (TAINT_FLAGS_COUNT + 4)\n\nstatic LIST_HEAD(modules);\n\nstatic int m_show(struct seq_file *m, void *p)\n{\n\tstruct module *mod = list_entry(p, struct module, list);\n\tchar buf[MODULE_FLAGS_BUF_SIZE];\n\tvoid *value;\n\n\t/* We always ignore unformed modules. */\n\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\treturn 0;\n\n\tseq_printf(m, \"%s %u\",\n\t\t   mod->name, mod->init_layout.size + mod->core_layout.size);\n\tprint_unload_info(m, mod);\n\n\t/* Informative for users. */\n\tseq_printf(m, \" %s\",\n\t\t   mod->state == MODULE_STATE_GOING ? \"Unloading\" :\n\t\t   mod->state == MODULE_STATE_COMING ? \"Loading\" :\n\t\t   \"Live\");\n\t/* Used by oprofile and other similar tools. */\n\tvalue = m->private ? NULL : mod->core_layout.base;\n\tseq_printf(m, \" 0x%px\", value);\n\n\t/* Taints info */\n\tif (mod->taints)\n\t\tseq_printf(m, \" %s\", module_flags(mod, buf));\n\n\tseq_puts(m, \"\\n\");\n\treturn 0;\n}"
  },
  {
    "function_name": "m_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4184-4187",
    "snippet": "static void m_stop(struct seq_file *m, void *p)\n{\n\tmutex_unlock(&module_mutex);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 4186
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void m_stop(struct seq_file *m, void *p)\n{\n\tmutex_unlock(&module_mutex);\n}"
  },
  {
    "function_name": "m_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4179-4182",
    "snippet": "static void *m_next(struct seq_file *m, void *p, loff_t *pos)\n{\n\treturn seq_list_next(p, &modules, pos);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_list_next",
          "args": [
            "p",
            "&modules",
            "pos"
          ],
          "line": 4181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic void *m_next(struct seq_file *m, void *p, loff_t *pos)\n{\n\treturn seq_list_next(p, &modules, pos);\n}"
  },
  {
    "function_name": "m_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4173-4177",
    "snippet": "static void *m_start(struct seq_file *m, loff_t *pos)\n{\n\tmutex_lock(&module_mutex);\n\treturn seq_list_start(&modules, *pos);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_list_start",
          "args": [
            "&modules",
            "*pos"
          ],
          "line": 4176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 4175
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic void *m_start(struct seq_file *m, loff_t *pos)\n{\n\tmutex_lock(&module_mutex);\n\treturn seq_list_start(&modules, *pos);\n}"
  },
  {
    "function_name": "module_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4148-4169",
    "snippet": "static char *module_flags(struct module *mod, char *buf)\n{\n\tint bx = 0;\n\n\tBUG_ON(mod->state == MODULE_STATE_UNFORMED);\n\tif (mod->taints ||\n\t    mod->state == MODULE_STATE_GOING ||\n\t    mod->state == MODULE_STATE_COMING) {\n\t\tbuf[bx++] = '(';\n\t\tbx += module_flags_taint(mod, buf + bx);\n\t\t/* Show a - for module-is-being-unloaded */\n\t\tif (mod->state == MODULE_STATE_GOING)\n\t\t\tbuf[bx++] = '-';\n\t\t/* Show a + for module-is-being-loaded */\n\t\tif (mod->state == MODULE_STATE_COMING)\n\t\t\tbuf[bx++] = '+';\n\t\tbuf[bx++] = ')';\n\t}\n\tbuf[bx] = '\\0';\n\n\treturn buf;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_flags_taint",
          "args": [
            "mod",
            "buf + bx"
          ],
          "line": 4157
        },
        "resolved": true,
        "details": {
          "function_name": "module_flags_taint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1169-1180",
          "snippet": "static size_t module_flags_taint(struct module *mod, char *buf)\n{\n\tsize_t l = 0;\n\tint i;\n\n\tfor (i = 0; i < TAINT_FLAGS_COUNT; i++) {\n\t\tif (taint_flags[i].module && test_bit(i, &mod->taints))\n\t\t\tbuf[l++] = taint_flags[i].c_true;\n\t}\n\n\treturn l;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic size_t module_flags_taint(struct module *mod, char *buf)\n{\n\tsize_t l = 0;\n\tint i;\n\n\tfor (i = 0; i < TAINT_FLAGS_COUNT; i++) {\n\t\tif (taint_flags[i].module && test_bit(i, &mod->taints))\n\t\t\tbuf[l++] = taint_flags[i].c_true;\n\t}\n\n\treturn l;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "mod->state == MODULE_STATE_UNFORMED"
          ],
          "line": 4152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *module_flags(struct module *mod, char *buf)\n{\n\tint bx = 0;\n\n\tBUG_ON(mod->state == MODULE_STATE_UNFORMED);\n\tif (mod->taints ||\n\t    mod->state == MODULE_STATE_GOING ||\n\t    mod->state == MODULE_STATE_COMING) {\n\t\tbuf[bx++] = '(';\n\t\tbx += module_flags_taint(mod, buf + bx);\n\t\t/* Show a - for module-is-being-unloaded */\n\t\tif (mod->state == MODULE_STATE_GOING)\n\t\t\tbuf[bx++] = '-';\n\t\t/* Show a + for module-is-being-loaded */\n\t\tif (mod->state == MODULE_STATE_COMING)\n\t\t\tbuf[bx++] = '+';\n\t\tbuf[bx++] = ')';\n\t}\n\tbuf[bx] = '\\0';\n\n\treturn buf;\n}"
  },
  {
    "function_name": "module_kallsyms_on_each_symbol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4113-4141",
    "snippet": "int module_kallsyms_on_each_symbol(int (*fn)(void *, const char *,\n\t\t\t\t\t     struct module *, unsigned long),\n\t\t\t\t   void *data)\n{\n\tstruct module *mod;\n\tunsigned int i;\n\tint ret;\n\n\tmodule_assert_mutex();\n\n\tlist_for_each_entry(mod, &modules, list) {\n\t\t/* We hold module_mutex: no need for rcu_dereference_sched */\n\t\tstruct mod_kallsyms *kallsyms = mod->kallsyms;\n\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tfor (i = 0; i < kallsyms->num_symtab; i++) {\n\n\t\t\tif (kallsyms->symtab[i].st_shndx == SHN_UNDEF)\n\t\t\t\tcontinue;\n\n\t\t\tret = fn(data, symname(kallsyms, i),\n\t\t\t\t mod, kallsyms->symtab[i].st_value);\n\t\t\tif (ret != 0)\n\t\t\t\treturn ret;\n\t\t}\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fn",
          "args": [
            "data",
            "symname(kallsyms, i)",
            "mod",
            "kallsyms->symtab[i].st_value"
          ],
          "line": 4134
        },
        "resolved": true,
        "details": {
          "function_name": "cwt_wakefn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/workqueue.c",
          "lines": "2947-2954",
          "snippet": "static int cwt_wakefn(wait_queue_entry_t *wait, unsigned mode, int sync, void *key)\n{\n\tstruct cwt_wait *cwait = container_of(wait, struct cwt_wait, wait);\n\n\tif (cwait->work != key)\n\t\treturn 0;\n\treturn autoremove_wake_function(wait, mode, sync, key);\n}",
          "includes": [
            "#include <trace/events/workqueue.h>",
            "#include \"workqueue_internal.h\"",
            "#include <linux/nmi.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/rculist.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/jhash.h>",
            "#include <linux/idr.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/freezer.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/kthread.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/completion.h>",
            "#include <linux/signal.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/workqueue.h>\n#include \"workqueue_internal.h\"\n#include <linux/nmi.h>\n#include <linux/sched/isolation.h>\n#include <linux/uaccess.h>\n#include <linux/moduleparam.h>\n#include <linux/nodemask.h>\n#include <linux/rculist.h>\n#include <linux/hashtable.h>\n#include <linux/jhash.h>\n#include <linux/idr.h>\n#include <linux/lockdep.h>\n#include <linux/debug_locks.h>\n#include <linux/freezer.h>\n#include <linux/mempolicy.h>\n#include <linux/hardirq.h>\n#include <linux/kthread.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/completion.h>\n#include <linux/signal.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic int cwt_wakefn(wait_queue_entry_t *wait, unsigned mode, int sync, void *key)\n{\n\tstruct cwt_wait *cwait = container_of(wait, struct cwt_wait, wait);\n\n\tif (cwait->work != key)\n\t\treturn 0;\n\treturn autoremove_wake_function(wait, mode, sync, key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "symname",
          "args": [
            "kallsyms",
            "i"
          ],
          "line": 4134
        },
        "resolved": true,
        "details": {
          "function_name": "mod_find_symname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4077-4087",
          "snippet": "static unsigned long mod_find_symname(struct module *mod, const char *name)\n{\n\tunsigned int i;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\tfor (i = 0; i < kallsyms->num_symtab; i++)\n\t\tif (strcmp(name, symname(kallsyms, i)) == 0 &&\n\t\t    kallsyms->symtab[i].st_shndx != SHN_UNDEF)\n\t\t\treturn kallsyms->symtab[i].st_value;\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned long mod_find_symname(struct module *mod, const char *name)\n{\n\tunsigned int i;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\tfor (i = 0; i < kallsyms->num_symtab; i++)\n\t\tif (strcmp(name, symname(kallsyms, i)) == 0 &&\n\t\t    kallsyms->symtab[i].st_shndx != SHN_UNDEF)\n\t\t\treturn kallsyms->symtab[i].st_value;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 4123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_assert_mutex",
          "args": [],
          "line": 4121
        },
        "resolved": true,
        "details": {
          "function_name": "module_assert_mutex_or_preempt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "265-274",
          "snippet": "static void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nint module_kallsyms_on_each_symbol(int (*fn)(void *, const char *,\n\t\t\t\t\t     struct module *, unsigned long),\n\t\t\t\t   void *data)\n{\n\tstruct module *mod;\n\tunsigned int i;\n\tint ret;\n\n\tmodule_assert_mutex();\n\n\tlist_for_each_entry(mod, &modules, list) {\n\t\t/* We hold module_mutex: no need for rcu_dereference_sched */\n\t\tstruct mod_kallsyms *kallsyms = mod->kallsyms;\n\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tfor (i = 0; i < kallsyms->num_symtab; i++) {\n\n\t\t\tif (kallsyms->symtab[i].st_shndx == SHN_UNDEF)\n\t\t\t\tcontinue;\n\n\t\t\tret = fn(data, symname(kallsyms, i),\n\t\t\t\t mod, kallsyms->symtab[i].st_value);\n\t\t\tif (ret != 0)\n\t\t\t\treturn ret;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "module_kallsyms_lookup_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4090-4111",
    "snippet": "unsigned long module_kallsyms_lookup_name(const char *name)\n{\n\tstruct module *mod;\n\tchar *colon;\n\tunsigned long ret = 0;\n\n\t/* Don't lock: we're in enough trouble already. */\n\tpreempt_disable();\n\tif ((colon = strnchr(name, MODULE_NAME_LEN, ':')) != NULL) {\n\t\tif ((mod = find_module_all(name, colon - name, false)) != NULL)\n\t\t\tret = mod_find_symname(mod, colon+1);\n\t} else {\n\t\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\t\tcontinue;\n\t\t\tif ((ret = mod_find_symname(mod, name)) != 0)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tpreempt_enable();\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 4109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mod_find_symname",
          "args": [
            "mod",
            "name"
          ],
          "line": 4105
        },
        "resolved": true,
        "details": {
          "function_name": "mod_find_symname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4077-4087",
          "snippet": "static unsigned long mod_find_symname(struct module *mod, const char *name)\n{\n\tunsigned int i;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\tfor (i = 0; i < kallsyms->num_symtab; i++)\n\t\tif (strcmp(name, symname(kallsyms, i)) == 0 &&\n\t\t    kallsyms->symtab[i].st_shndx != SHN_UNDEF)\n\t\t\treturn kallsyms->symtab[i].st_value;\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned long mod_find_symname(struct module *mod, const char *name)\n{\n\tunsigned int i;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\tfor (i = 0; i < kallsyms->num_symtab; i++)\n\t\tif (strcmp(name, symname(kallsyms, i)) == 0 &&\n\t\t    kallsyms->symtab[i].st_shndx != SHN_UNDEF)\n\t\t\treturn kallsyms->symtab[i].st_value;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 4102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_module_all",
          "args": [
            "name",
            "colon - name",
            "false"
          ],
          "line": 4099
        },
        "resolved": true,
        "details": {
          "function_name": "find_module_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "605-619",
          "snippet": "static struct module *find_module_all(const char *name, size_t len,\n\t\t\t\t      bool even_unformed)\n{\n\tstruct module *mod;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (!even_unformed && mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (strlen(mod->name) == len && !memcmp(mod->name, name, len))\n\t\t\treturn mod;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(modules);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic struct module *find_module_all(const char *name, size_t len,\n\t\t\t\t      bool even_unformed)\n{\n\tstruct module *mod;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (!even_unformed && mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (strlen(mod->name) == len && !memcmp(mod->name, name, len))\n\t\t\treturn mod;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strnchr",
          "args": [
            "name",
            "MODULE_NAME_LEN",
            "':'"
          ],
          "line": 4098
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 4097
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nunsigned long module_kallsyms_lookup_name(const char *name)\n{\n\tstruct module *mod;\n\tchar *colon;\n\tunsigned long ret = 0;\n\n\t/* Don't lock: we're in enough trouble already. */\n\tpreempt_disable();\n\tif ((colon = strnchr(name, MODULE_NAME_LEN, ':')) != NULL) {\n\t\tif ((mod = find_module_all(name, colon - name, false)) != NULL)\n\t\t\tret = mod_find_symname(mod, colon+1);\n\t} else {\n\t\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\t\tcontinue;\n\t\t\tif ((ret = mod_find_symname(mod, name)) != 0)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tpreempt_enable();\n\treturn ret;\n}"
  },
  {
    "function_name": "mod_find_symname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4077-4087",
    "snippet": "static unsigned long mod_find_symname(struct module *mod, const char *name)\n{\n\tunsigned int i;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\tfor (i = 0; i < kallsyms->num_symtab; i++)\n\t\tif (strcmp(name, symname(kallsyms, i)) == 0 &&\n\t\t    kallsyms->symtab[i].st_shndx != SHN_UNDEF)\n\t\t\treturn kallsyms->symtab[i].st_value;\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "symname(kallsyms, i)"
          ],
          "line": 4083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "symname",
          "args": [
            "kallsyms",
            "i"
          ],
          "line": 4083
        },
        "resolved": true,
        "details": {
          "function_name": "mod_find_symname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4077-4087",
          "snippet": "static unsigned long mod_find_symname(struct module *mod, const char *name)\n{\n\tunsigned int i;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\tfor (i = 0; i < kallsyms->num_symtab; i++)\n\t\tif (strcmp(name, symname(kallsyms, i)) == 0 &&\n\t\t    kallsyms->symtab[i].st_shndx != SHN_UNDEF)\n\t\t\treturn kallsyms->symtab[i].st_value;\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "rcu_dereference_sched",
          "args": [
            "mod->kallsyms"
          ],
          "line": 4080
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned long mod_find_symname(struct module *mod, const char *name)\n{\n\tunsigned int i;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\tfor (i = 0; i < kallsyms->num_symtab; i++)\n\t\tif (strcmp(name, symname(kallsyms, i)) == 0 &&\n\t\t    kallsyms->symtab[i].st_shndx != SHN_UNDEF)\n\t\t\treturn kallsyms->symtab[i].st_value;\n\treturn 0;\n}"
  },
  {
    "function_name": "module_get_kallsym",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4050-4075",
    "snippet": "int module_get_kallsym(unsigned int symnum, unsigned long *value, char *type,\n\t\t\tchar *name, char *module_name, int *exported)\n{\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tstruct mod_kallsyms *kallsyms;\n\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tkallsyms = rcu_dereference_sched(mod->kallsyms);\n\t\tif (symnum < kallsyms->num_symtab) {\n\t\t\t*value = kallsyms->symtab[symnum].st_value;\n\t\t\t*type = kallsyms->symtab[symnum].st_info;\n\t\t\tstrlcpy(name, symname(kallsyms, symnum), KSYM_NAME_LEN);\n\t\t\tstrlcpy(module_name, mod->name, MODULE_NAME_LEN);\n\t\t\t*exported = is_exported(name, *value, mod);\n\t\t\tpreempt_enable();\n\t\t\treturn 0;\n\t\t}\n\t\tsymnum -= kallsyms->num_symtab;\n\t}\n\tpreempt_enable();\n\treturn -ERANGE;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 4073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 4068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_exported",
          "args": [
            "name",
            "*value",
            "mod"
          ],
          "line": 4067
        },
        "resolved": true,
        "details": {
          "function_name": "is_exported",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2531-2540",
          "snippet": "static int is_exported(const char *name, unsigned long value,\n\t\t       const struct module *mod)\n{\n\tconst struct kernel_symbol *ks;\n\tif (!mod)\n\t\tks = lookup_symbol(name, __start___ksymtab, __stop___ksymtab);\n\telse\n\t\tks = lookup_symbol(name, mod->syms, mod->syms + mod->num_syms);\n\treturn ks != NULL && kernel_symbol_value(ks) == value;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern const struct kernel_symbol __start___ksymtab[];",
            "extern const struct kernel_symbol __stop___ksymtab[];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nextern const struct kernel_symbol __start___ksymtab[];\nextern const struct kernel_symbol __stop___ksymtab[];\n\nstatic int is_exported(const char *name, unsigned long value,\n\t\t       const struct module *mod)\n{\n\tconst struct kernel_symbol *ks;\n\tif (!mod)\n\t\tks = lookup_symbol(name, __start___ksymtab, __stop___ksymtab);\n\telse\n\t\tks = lookup_symbol(name, mod->syms, mod->syms + mod->num_syms);\n\treturn ks != NULL && kernel_symbol_value(ks) == value;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "module_name",
            "mod->name",
            "MODULE_NAME_LEN"
          ],
          "line": 4066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "name",
            "symname(kallsyms, symnum)",
            "KSYM_NAME_LEN"
          ],
          "line": 4065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "symname",
          "args": [
            "kallsyms",
            "symnum"
          ],
          "line": 4065
        },
        "resolved": true,
        "details": {
          "function_name": "mod_find_symname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4077-4087",
          "snippet": "static unsigned long mod_find_symname(struct module *mod, const char *name)\n{\n\tunsigned int i;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\tfor (i = 0; i < kallsyms->num_symtab; i++)\n\t\tif (strcmp(name, symname(kallsyms, i)) == 0 &&\n\t\t    kallsyms->symtab[i].st_shndx != SHN_UNDEF)\n\t\t\treturn kallsyms->symtab[i].st_value;\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned long mod_find_symname(struct module *mod, const char *name)\n{\n\tunsigned int i;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\tfor (i = 0; i < kallsyms->num_symtab; i++)\n\t\tif (strcmp(name, symname(kallsyms, i)) == 0 &&\n\t\t    kallsyms->symtab[i].st_shndx != SHN_UNDEF)\n\t\t\treturn kallsyms->symtab[i].st_value;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_dereference_sched",
          "args": [
            "mod->kallsyms"
          ],
          "line": 4061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 4056
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 4055
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nint module_get_kallsym(unsigned int symnum, unsigned long *value, char *type,\n\t\t\tchar *name, char *module_name, int *exported)\n{\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tstruct mod_kallsyms *kallsyms;\n\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tkallsyms = rcu_dereference_sched(mod->kallsyms);\n\t\tif (symnum < kallsyms->num_symtab) {\n\t\t\t*value = kallsyms->symtab[symnum].st_value;\n\t\t\t*type = kallsyms->symtab[symnum].st_info;\n\t\t\tstrlcpy(name, symname(kallsyms, symnum), KSYM_NAME_LEN);\n\t\t\tstrlcpy(module_name, mod->name, MODULE_NAME_LEN);\n\t\t\t*exported = is_exported(name, *value, mod);\n\t\t\tpreempt_enable();\n\t\t\treturn 0;\n\t\t}\n\t\tsymnum -= kallsyms->num_symtab;\n\t}\n\tpreempt_enable();\n\treturn -ERANGE;\n}"
  },
  {
    "function_name": "lookup_module_symbol_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "4022-4048",
    "snippet": "int lookup_module_symbol_attrs(unsigned long addr, unsigned long *size,\n\t\t\tunsigned long *offset, char *modname, char *name)\n{\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (within_module(addr, mod)) {\n\t\t\tconst char *sym;\n\n\t\t\tsym = get_ksymbol(mod, addr, size, offset);\n\t\t\tif (!sym)\n\t\t\t\tgoto out;\n\t\t\tif (modname)\n\t\t\t\tstrlcpy(modname, mod->name, MODULE_NAME_LEN);\n\t\t\tif (name)\n\t\t\t\tstrlcpy(name, sym, KSYM_NAME_LEN);\n\t\t\tpreempt_enable();\n\t\t\treturn 0;\n\t\t}\n\t}\nout:\n\tpreempt_enable();\n\treturn -ERANGE;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 4046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 4041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "name",
            "sym",
            "KSYM_NAME_LEN"
          ],
          "line": 4040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "modname",
            "mod->name",
            "MODULE_NAME_LEN"
          ],
          "line": 4038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_ksymbol",
          "args": [
            "mod",
            "addr",
            "size",
            "offset"
          ],
          "line": 4034
        },
        "resolved": true,
        "details": {
          "function_name": "get_ksymbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3919-3962",
          "snippet": "static const char *get_ksymbol(struct module *mod,\n\t\t\t       unsigned long addr,\n\t\t\t       unsigned long *size,\n\t\t\t       unsigned long *offset)\n{\n\tunsigned int i, best = 0;\n\tunsigned long nextval;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\t/* At worse, next value is at end of module */\n\tif (within_module_init(addr, mod))\n\t\tnextval = (unsigned long)mod->init_layout.base+mod->init_layout.text_size;\n\telse\n\t\tnextval = (unsigned long)mod->core_layout.base+mod->core_layout.text_size;\n\n\t/* Scan for closest preceding symbol, and next symbol. (ELF\n\t   starts real symbols at 1). */\n\tfor (i = 1; i < kallsyms->num_symtab; i++) {\n\t\tif (kallsyms->symtab[i].st_shndx == SHN_UNDEF)\n\t\t\tcontinue;\n\n\t\t/* We ignore unnamed symbols: they're uninformative\n\t\t * and inserted at a whim. */\n\t\tif (*symname(kallsyms, i) == '\\0'\n\t\t    || is_arm_mapping_symbol(symname(kallsyms, i)))\n\t\t\tcontinue;\n\n\t\tif (kallsyms->symtab[i].st_value <= addr\n\t\t    && kallsyms->symtab[i].st_value > kallsyms->symtab[best].st_value)\n\t\t\tbest = i;\n\t\tif (kallsyms->symtab[i].st_value > addr\n\t\t    && kallsyms->symtab[i].st_value < nextval)\n\t\t\tnextval = kallsyms->symtab[i].st_value;\n\t}\n\n\tif (!best)\n\t\treturn NULL;\n\n\tif (size)\n\t\t*size = nextval - kallsyms->symtab[best].st_value;\n\tif (offset)\n\t\t*offset = addr - kallsyms->symtab[best].st_value;\n\treturn symname(kallsyms, best);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const char *get_ksymbol(struct module *mod,\n\t\t\t       unsigned long addr,\n\t\t\t       unsigned long *size,\n\t\t\t       unsigned long *offset)\n{\n\tunsigned int i, best = 0;\n\tunsigned long nextval;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\t/* At worse, next value is at end of module */\n\tif (within_module_init(addr, mod))\n\t\tnextval = (unsigned long)mod->init_layout.base+mod->init_layout.text_size;\n\telse\n\t\tnextval = (unsigned long)mod->core_layout.base+mod->core_layout.text_size;\n\n\t/* Scan for closest preceding symbol, and next symbol. (ELF\n\t   starts real symbols at 1). */\n\tfor (i = 1; i < kallsyms->num_symtab; i++) {\n\t\tif (kallsyms->symtab[i].st_shndx == SHN_UNDEF)\n\t\t\tcontinue;\n\n\t\t/* We ignore unnamed symbols: they're uninformative\n\t\t * and inserted at a whim. */\n\t\tif (*symname(kallsyms, i) == '\\0'\n\t\t    || is_arm_mapping_symbol(symname(kallsyms, i)))\n\t\t\tcontinue;\n\n\t\tif (kallsyms->symtab[i].st_value <= addr\n\t\t    && kallsyms->symtab[i].st_value > kallsyms->symtab[best].st_value)\n\t\t\tbest = i;\n\t\tif (kallsyms->symtab[i].st_value > addr\n\t\t    && kallsyms->symtab[i].st_value < nextval)\n\t\t\tnextval = kallsyms->symtab[i].st_value;\n\t}\n\n\tif (!best)\n\t\treturn NULL;\n\n\tif (size)\n\t\t*size = nextval - kallsyms->symtab[best].st_value;\n\tif (offset)\n\t\t*offset = addr - kallsyms->symtab[best].st_value;\n\treturn symname(kallsyms, best);\n}"
        }
      },
      {
        "call_info": {
          "callee": "within_module",
          "args": [
            "addr",
            "mod"
          ],
          "line": 4031
        },
        "resolved": true,
        "details": {
          "function_name": "trace_kprobe_within_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_kprobe.c",
          "lines": "57-63",
          "snippet": "static nokprobe_inline bool trace_kprobe_within_module(struct trace_kprobe *tk,\n\t\t\t\t\t\t struct module *mod)\n{\n\tint len = strlen(mod->name);\n\tconst char *name = trace_kprobe_symbol(tk);\n\treturn strncmp(mod->name, name, len) == 0 && name[len] == ':';\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include \"trace_kprobe_selftest.h\"",
            "#include <linux/error-injection.h>",
            "#include <linux/rculist.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int register_kprobe_event(struct trace_kprobe *tk);",
            "static int unregister_kprobe_event(struct trace_kprobe *tk);",
            "NOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Kprobe handler */\nstatic nokprobe_inline"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include \"trace_kprobe_selftest.h\"\n#include <linux/error-injection.h>\n#include <linux/rculist.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n\nstatic int register_kprobe_event(struct trace_kprobe *tk);\nstatic int unregister_kprobe_event(struct trace_kprobe *tk);\nNOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Kprobe handler */\nstatic nokprobe_inline;\n\nstatic nokprobe_inline bool trace_kprobe_within_module(struct trace_kprobe *tk,\n\t\t\t\t\t\t struct module *mod)\n{\n\tint len = strlen(mod->name);\n\tconst char *name = trace_kprobe_symbol(tk);\n\treturn strncmp(mod->name, name, len) == 0 && name[len] == ':';\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 4028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 4027
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nint lookup_module_symbol_attrs(unsigned long addr, unsigned long *size,\n\t\t\tunsigned long *offset, char *modname, char *name)\n{\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (within_module(addr, mod)) {\n\t\t\tconst char *sym;\n\n\t\t\tsym = get_ksymbol(mod, addr, size, offset);\n\t\t\tif (!sym)\n\t\t\t\tgoto out;\n\t\t\tif (modname)\n\t\t\t\tstrlcpy(modname, mod->name, MODULE_NAME_LEN);\n\t\t\tif (name)\n\t\t\t\tstrlcpy(name, sym, KSYM_NAME_LEN);\n\t\t\tpreempt_enable();\n\t\t\treturn 0;\n\t\t}\n\t}\nout:\n\tpreempt_enable();\n\treturn -ERANGE;\n}"
  },
  {
    "function_name": "lookup_module_symbol_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3998-4020",
    "snippet": "int lookup_module_symbol_name(unsigned long addr, char *symname)\n{\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (within_module(addr, mod)) {\n\t\t\tconst char *sym;\n\n\t\t\tsym = get_ksymbol(mod, addr, NULL, NULL);\n\t\t\tif (!sym)\n\t\t\t\tgoto out;\n\t\t\tstrlcpy(symname, sym, KSYM_NAME_LEN);\n\t\t\tpreempt_enable();\n\t\t\treturn 0;\n\t\t}\n\t}\nout:\n\tpreempt_enable();\n\treturn -ERANGE;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 4018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 4013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "symname",
            "sym",
            "KSYM_NAME_LEN"
          ],
          "line": 4012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_ksymbol",
          "args": [
            "mod",
            "addr",
            "NULL",
            "NULL"
          ],
          "line": 4009
        },
        "resolved": true,
        "details": {
          "function_name": "get_ksymbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3919-3962",
          "snippet": "static const char *get_ksymbol(struct module *mod,\n\t\t\t       unsigned long addr,\n\t\t\t       unsigned long *size,\n\t\t\t       unsigned long *offset)\n{\n\tunsigned int i, best = 0;\n\tunsigned long nextval;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\t/* At worse, next value is at end of module */\n\tif (within_module_init(addr, mod))\n\t\tnextval = (unsigned long)mod->init_layout.base+mod->init_layout.text_size;\n\telse\n\t\tnextval = (unsigned long)mod->core_layout.base+mod->core_layout.text_size;\n\n\t/* Scan for closest preceding symbol, and next symbol. (ELF\n\t   starts real symbols at 1). */\n\tfor (i = 1; i < kallsyms->num_symtab; i++) {\n\t\tif (kallsyms->symtab[i].st_shndx == SHN_UNDEF)\n\t\t\tcontinue;\n\n\t\t/* We ignore unnamed symbols: they're uninformative\n\t\t * and inserted at a whim. */\n\t\tif (*symname(kallsyms, i) == '\\0'\n\t\t    || is_arm_mapping_symbol(symname(kallsyms, i)))\n\t\t\tcontinue;\n\n\t\tif (kallsyms->symtab[i].st_value <= addr\n\t\t    && kallsyms->symtab[i].st_value > kallsyms->symtab[best].st_value)\n\t\t\tbest = i;\n\t\tif (kallsyms->symtab[i].st_value > addr\n\t\t    && kallsyms->symtab[i].st_value < nextval)\n\t\t\tnextval = kallsyms->symtab[i].st_value;\n\t}\n\n\tif (!best)\n\t\treturn NULL;\n\n\tif (size)\n\t\t*size = nextval - kallsyms->symtab[best].st_value;\n\tif (offset)\n\t\t*offset = addr - kallsyms->symtab[best].st_value;\n\treturn symname(kallsyms, best);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const char *get_ksymbol(struct module *mod,\n\t\t\t       unsigned long addr,\n\t\t\t       unsigned long *size,\n\t\t\t       unsigned long *offset)\n{\n\tunsigned int i, best = 0;\n\tunsigned long nextval;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\t/* At worse, next value is at end of module */\n\tif (within_module_init(addr, mod))\n\t\tnextval = (unsigned long)mod->init_layout.base+mod->init_layout.text_size;\n\telse\n\t\tnextval = (unsigned long)mod->core_layout.base+mod->core_layout.text_size;\n\n\t/* Scan for closest preceding symbol, and next symbol. (ELF\n\t   starts real symbols at 1). */\n\tfor (i = 1; i < kallsyms->num_symtab; i++) {\n\t\tif (kallsyms->symtab[i].st_shndx == SHN_UNDEF)\n\t\t\tcontinue;\n\n\t\t/* We ignore unnamed symbols: they're uninformative\n\t\t * and inserted at a whim. */\n\t\tif (*symname(kallsyms, i) == '\\0'\n\t\t    || is_arm_mapping_symbol(symname(kallsyms, i)))\n\t\t\tcontinue;\n\n\t\tif (kallsyms->symtab[i].st_value <= addr\n\t\t    && kallsyms->symtab[i].st_value > kallsyms->symtab[best].st_value)\n\t\t\tbest = i;\n\t\tif (kallsyms->symtab[i].st_value > addr\n\t\t    && kallsyms->symtab[i].st_value < nextval)\n\t\t\tnextval = kallsyms->symtab[i].st_value;\n\t}\n\n\tif (!best)\n\t\treturn NULL;\n\n\tif (size)\n\t\t*size = nextval - kallsyms->symtab[best].st_value;\n\tif (offset)\n\t\t*offset = addr - kallsyms->symtab[best].st_value;\n\treturn symname(kallsyms, best);\n}"
        }
      },
      {
        "call_info": {
          "callee": "within_module",
          "args": [
            "addr",
            "mod"
          ],
          "line": 4006
        },
        "resolved": true,
        "details": {
          "function_name": "trace_kprobe_within_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_kprobe.c",
          "lines": "57-63",
          "snippet": "static nokprobe_inline bool trace_kprobe_within_module(struct trace_kprobe *tk,\n\t\t\t\t\t\t struct module *mod)\n{\n\tint len = strlen(mod->name);\n\tconst char *name = trace_kprobe_symbol(tk);\n\treturn strncmp(mod->name, name, len) == 0 && name[len] == ':';\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include \"trace_kprobe_selftest.h\"",
            "#include <linux/error-injection.h>",
            "#include <linux/rculist.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int register_kprobe_event(struct trace_kprobe *tk);",
            "static int unregister_kprobe_event(struct trace_kprobe *tk);",
            "NOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Kprobe handler */\nstatic nokprobe_inline"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include \"trace_kprobe_selftest.h\"\n#include <linux/error-injection.h>\n#include <linux/rculist.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n\nstatic int register_kprobe_event(struct trace_kprobe *tk);\nstatic int unregister_kprobe_event(struct trace_kprobe *tk);\nNOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Kprobe handler */\nstatic nokprobe_inline;\n\nstatic nokprobe_inline bool trace_kprobe_within_module(struct trace_kprobe *tk,\n\t\t\t\t\t\t struct module *mod)\n{\n\tint len = strlen(mod->name);\n\tconst char *name = trace_kprobe_symbol(tk);\n\treturn strncmp(mod->name, name, len) == 0 && name[len] == ':';\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 4003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 4002
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nint lookup_module_symbol_name(unsigned long addr, char *symname)\n{\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (within_module(addr, mod)) {\n\t\t\tconst char *sym;\n\n\t\t\tsym = get_ksymbol(mod, addr, NULL, NULL);\n\t\t\tif (!sym)\n\t\t\t\tgoto out;\n\t\t\tstrlcpy(symname, sym, KSYM_NAME_LEN);\n\t\t\tpreempt_enable();\n\t\t\treturn 0;\n\t\t}\n\t}\nout:\n\tpreempt_enable();\n\treturn -ERANGE;\n}"
  },
  {
    "function_name": "module_address_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3972-3996",
    "snippet": "const char *module_address_lookup(unsigned long addr,\n\t\t\t    unsigned long *size,\n\t\t\t    unsigned long *offset,\n\t\t\t    char **modname,\n\t\t\t    char *namebuf)\n{\n\tconst char *ret = NULL;\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tmod = __module_address(addr);\n\tif (mod) {\n\t\tif (modname)\n\t\t\t*modname = mod->name;\n\t\tret = get_ksymbol(mod, addr, size, offset);\n\t}\n\t/* Make a copy in here where it's safe */\n\tif (ret) {\n\t\tstrncpy(namebuf, ret, KSYM_NAME_LEN - 1);\n\t\tret = namebuf;\n\t}\n\tpreempt_enable();\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 3993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "namebuf",
            "ret",
            "KSYM_NAME_LEN - 1"
          ],
          "line": 3990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_ksymbol",
          "args": [
            "mod",
            "addr",
            "size",
            "offset"
          ],
          "line": 3986
        },
        "resolved": true,
        "details": {
          "function_name": "get_ksymbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3919-3962",
          "snippet": "static const char *get_ksymbol(struct module *mod,\n\t\t\t       unsigned long addr,\n\t\t\t       unsigned long *size,\n\t\t\t       unsigned long *offset)\n{\n\tunsigned int i, best = 0;\n\tunsigned long nextval;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\t/* At worse, next value is at end of module */\n\tif (within_module_init(addr, mod))\n\t\tnextval = (unsigned long)mod->init_layout.base+mod->init_layout.text_size;\n\telse\n\t\tnextval = (unsigned long)mod->core_layout.base+mod->core_layout.text_size;\n\n\t/* Scan for closest preceding symbol, and next symbol. (ELF\n\t   starts real symbols at 1). */\n\tfor (i = 1; i < kallsyms->num_symtab; i++) {\n\t\tif (kallsyms->symtab[i].st_shndx == SHN_UNDEF)\n\t\t\tcontinue;\n\n\t\t/* We ignore unnamed symbols: they're uninformative\n\t\t * and inserted at a whim. */\n\t\tif (*symname(kallsyms, i) == '\\0'\n\t\t    || is_arm_mapping_symbol(symname(kallsyms, i)))\n\t\t\tcontinue;\n\n\t\tif (kallsyms->symtab[i].st_value <= addr\n\t\t    && kallsyms->symtab[i].st_value > kallsyms->symtab[best].st_value)\n\t\t\tbest = i;\n\t\tif (kallsyms->symtab[i].st_value > addr\n\t\t    && kallsyms->symtab[i].st_value < nextval)\n\t\t\tnextval = kallsyms->symtab[i].st_value;\n\t}\n\n\tif (!best)\n\t\treturn NULL;\n\n\tif (size)\n\t\t*size = nextval - kallsyms->symtab[best].st_value;\n\tif (offset)\n\t\t*offset = addr - kallsyms->symtab[best].st_value;\n\treturn symname(kallsyms, best);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const char *get_ksymbol(struct module *mod,\n\t\t\t       unsigned long addr,\n\t\t\t       unsigned long *size,\n\t\t\t       unsigned long *offset)\n{\n\tunsigned int i, best = 0;\n\tunsigned long nextval;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\t/* At worse, next value is at end of module */\n\tif (within_module_init(addr, mod))\n\t\tnextval = (unsigned long)mod->init_layout.base+mod->init_layout.text_size;\n\telse\n\t\tnextval = (unsigned long)mod->core_layout.base+mod->core_layout.text_size;\n\n\t/* Scan for closest preceding symbol, and next symbol. (ELF\n\t   starts real symbols at 1). */\n\tfor (i = 1; i < kallsyms->num_symtab; i++) {\n\t\tif (kallsyms->symtab[i].st_shndx == SHN_UNDEF)\n\t\t\tcontinue;\n\n\t\t/* We ignore unnamed symbols: they're uninformative\n\t\t * and inserted at a whim. */\n\t\tif (*symname(kallsyms, i) == '\\0'\n\t\t    || is_arm_mapping_symbol(symname(kallsyms, i)))\n\t\t\tcontinue;\n\n\t\tif (kallsyms->symtab[i].st_value <= addr\n\t\t    && kallsyms->symtab[i].st_value > kallsyms->symtab[best].st_value)\n\t\t\tbest = i;\n\t\tif (kallsyms->symtab[i].st_value > addr\n\t\t    && kallsyms->symtab[i].st_value < nextval)\n\t\t\tnextval = kallsyms->symtab[i].st_value;\n\t}\n\n\tif (!best)\n\t\treturn NULL;\n\n\tif (size)\n\t\t*size = nextval - kallsyms->symtab[best].st_value;\n\tif (offset)\n\t\t*offset = addr - kallsyms->symtab[best].st_value;\n\treturn symname(kallsyms, best);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__module_address",
          "args": [
            "addr"
          ],
          "line": 3982
        },
        "resolved": true,
        "details": {
          "function_name": "__module_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4318-4334",
          "snippet": "struct module *__module_address(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tif (addr < module_addr_min || addr > module_addr_max)\n\t\treturn NULL;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tmod = mod_find(addr);\n\tif (mod) {\n\t\tBUG_ON(!within_module(addr, mod));\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define module_addr_max mod_tree.addr_max",
            "#define module_addr_min mod_tree.addr_min"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define module_addr_max mod_tree.addr_max\n#define module_addr_min mod_tree.addr_min\n\nstruct module *__module_address(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tif (addr < module_addr_min || addr > module_addr_max)\n\t\treturn NULL;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tmod = mod_find(addr);\n\tif (mod) {\n\t\tBUG_ON(!within_module(addr, mod));\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 3981
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nconst char *module_address_lookup(unsigned long addr,\n\t\t\t    unsigned long *size,\n\t\t\t    unsigned long *offset,\n\t\t\t    char **modname,\n\t\t\t    char *namebuf)\n{\n\tconst char *ret = NULL;\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tmod = __module_address(addr);\n\tif (mod) {\n\t\tif (modname)\n\t\t\t*modname = mod->name;\n\t\tret = get_ksymbol(mod, addr, size, offset);\n\t}\n\t/* Make a copy in here where it's safe */\n\tif (ret) {\n\t\tstrncpy(namebuf, ret, KSYM_NAME_LEN - 1);\n\t\tret = namebuf;\n\t}\n\tpreempt_enable();\n\n\treturn ret;\n}"
  },
  {
    "function_name": "dereference_module_function_descriptor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3964-3968",
    "snippet": "void * __weak dereference_module_function_descriptor(struct module *mod,\n\t\t\t\t\t\t     void *ptr)\n{\n\treturn ptr;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid * __weak dereference_module_function_descriptor(struct module *mod,\n\t\t\t\t\t\t     void *ptr)\n{\n\treturn ptr;\n}"
  },
  {
    "function_name": "get_ksymbol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3919-3962",
    "snippet": "static const char *get_ksymbol(struct module *mod,\n\t\t\t       unsigned long addr,\n\t\t\t       unsigned long *size,\n\t\t\t       unsigned long *offset)\n{\n\tunsigned int i, best = 0;\n\tunsigned long nextval;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\t/* At worse, next value is at end of module */\n\tif (within_module_init(addr, mod))\n\t\tnextval = (unsigned long)mod->init_layout.base+mod->init_layout.text_size;\n\telse\n\t\tnextval = (unsigned long)mod->core_layout.base+mod->core_layout.text_size;\n\n\t/* Scan for closest preceding symbol, and next symbol. (ELF\n\t   starts real symbols at 1). */\n\tfor (i = 1; i < kallsyms->num_symtab; i++) {\n\t\tif (kallsyms->symtab[i].st_shndx == SHN_UNDEF)\n\t\t\tcontinue;\n\n\t\t/* We ignore unnamed symbols: they're uninformative\n\t\t * and inserted at a whim. */\n\t\tif (*symname(kallsyms, i) == '\\0'\n\t\t    || is_arm_mapping_symbol(symname(kallsyms, i)))\n\t\t\tcontinue;\n\n\t\tif (kallsyms->symtab[i].st_value <= addr\n\t\t    && kallsyms->symtab[i].st_value > kallsyms->symtab[best].st_value)\n\t\t\tbest = i;\n\t\tif (kallsyms->symtab[i].st_value > addr\n\t\t    && kallsyms->symtab[i].st_value < nextval)\n\t\t\tnextval = kallsyms->symtab[i].st_value;\n\t}\n\n\tif (!best)\n\t\treturn NULL;\n\n\tif (size)\n\t\t*size = nextval - kallsyms->symtab[best].st_value;\n\tif (offset)\n\t\t*offset = addr - kallsyms->symtab[best].st_value;\n\treturn symname(kallsyms, best);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "symname",
          "args": [
            "kallsyms",
            "best"
          ],
          "line": 3961
        },
        "resolved": true,
        "details": {
          "function_name": "mod_find_symname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4077-4087",
          "snippet": "static unsigned long mod_find_symname(struct module *mod, const char *name)\n{\n\tunsigned int i;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\tfor (i = 0; i < kallsyms->num_symtab; i++)\n\t\tif (strcmp(name, symname(kallsyms, i)) == 0 &&\n\t\t    kallsyms->symtab[i].st_shndx != SHN_UNDEF)\n\t\t\treturn kallsyms->symtab[i].st_value;\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned long mod_find_symname(struct module *mod, const char *name)\n{\n\tunsigned int i;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\tfor (i = 0; i < kallsyms->num_symtab; i++)\n\t\tif (strcmp(name, symname(kallsyms, i)) == 0 &&\n\t\t    kallsyms->symtab[i].st_shndx != SHN_UNDEF)\n\t\t\treturn kallsyms->symtab[i].st_value;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_arm_mapping_symbol",
          "args": [
            "symname(kallsyms, i)"
          ],
          "line": 3943
        },
        "resolved": true,
        "details": {
          "function_name": "is_arm_mapping_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3906-3912",
          "snippet": "static inline int is_arm_mapping_symbol(const char *str)\n{\n\tif (str[0] == '.' && str[1] == 'L')\n\t\treturn true;\n\treturn str[0] == '$' && strchr(\"axtd\", str[1])\n\t       && (str[2] == '\\0' || str[2] == '.');\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int is_arm_mapping_symbol(const char *str)\n{\n\tif (str[0] == '.' && str[1] == 'L')\n\t\treturn true;\n\treturn str[0] == '$' && strchr(\"axtd\", str[1])\n\t       && (str[2] == '\\0' || str[2] == '.');\n}"
        }
      },
      {
        "call_info": {
          "callee": "within_module_init",
          "args": [
            "addr",
            "mod"
          ],
          "line": 3929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_dereference_sched",
          "args": [
            "mod->kallsyms"
          ],
          "line": 3926
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const char *get_ksymbol(struct module *mod,\n\t\t\t       unsigned long addr,\n\t\t\t       unsigned long *size,\n\t\t\t       unsigned long *offset)\n{\n\tunsigned int i, best = 0;\n\tunsigned long nextval;\n\tstruct mod_kallsyms *kallsyms = rcu_dereference_sched(mod->kallsyms);\n\n\t/* At worse, next value is at end of module */\n\tif (within_module_init(addr, mod))\n\t\tnextval = (unsigned long)mod->init_layout.base+mod->init_layout.text_size;\n\telse\n\t\tnextval = (unsigned long)mod->core_layout.base+mod->core_layout.text_size;\n\n\t/* Scan for closest preceding symbol, and next symbol. (ELF\n\t   starts real symbols at 1). */\n\tfor (i = 1; i < kallsyms->num_symtab; i++) {\n\t\tif (kallsyms->symtab[i].st_shndx == SHN_UNDEF)\n\t\t\tcontinue;\n\n\t\t/* We ignore unnamed symbols: they're uninformative\n\t\t * and inserted at a whim. */\n\t\tif (*symname(kallsyms, i) == '\\0'\n\t\t    || is_arm_mapping_symbol(symname(kallsyms, i)))\n\t\t\tcontinue;\n\n\t\tif (kallsyms->symtab[i].st_value <= addr\n\t\t    && kallsyms->symtab[i].st_value > kallsyms->symtab[best].st_value)\n\t\t\tbest = i;\n\t\tif (kallsyms->symtab[i].st_value > addr\n\t\t    && kallsyms->symtab[i].st_value < nextval)\n\t\t\tnextval = kallsyms->symtab[i].st_value;\n\t}\n\n\tif (!best)\n\t\treturn NULL;\n\n\tif (size)\n\t\t*size = nextval - kallsyms->symtab[best].st_value;\n\tif (offset)\n\t\t*offset = addr - kallsyms->symtab[best].st_value;\n\treturn symname(kallsyms, best);\n}"
  },
  {
    "function_name": "symname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3914-3917",
    "snippet": "static const char *symname(struct mod_kallsyms *kallsyms, unsigned int symnum)\n{\n\treturn kallsyms->strtab + kallsyms->symtab[symnum].st_name;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const char *symname(struct mod_kallsyms *kallsyms, unsigned int symnum)\n{\n\treturn kallsyms->strtab + kallsyms->symtab[symnum].st_name;\n}"
  },
  {
    "function_name": "is_arm_mapping_symbol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3906-3912",
    "snippet": "static inline int is_arm_mapping_symbol(const char *str)\n{\n\tif (str[0] == '.' && str[1] == 'L')\n\t\treturn true;\n\treturn str[0] == '$' && strchr(\"axtd\", str[1])\n\t       && (str[2] == '\\0' || str[2] == '.');\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "\"axtd\"",
            "str[1]"
          ],
          "line": 3910
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int is_arm_mapping_symbol(const char *str)\n{\n\tif (str[0] == '.' && str[1] == 'L')\n\t\treturn true;\n\treturn str[0] == '$' && strchr(\"axtd\", str[1])\n\t       && (str[2] == '\\0' || str[2] == '.');\n}"
  },
  {
    "function_name": "within",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3896-3899",
    "snippet": "static inline int within(unsigned long addr, void *start, unsigned long size)\n{\n\treturn ((void *)addr >= start && (void *)addr < start + size);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int within(unsigned long addr, void *start, unsigned long size)\n{\n\treturn ((void *)addr >= start && (void *)addr < start + size);\n}"
  },
  {
    "function_name": "load_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3651-3847",
    "snippet": "static int load_module(struct load_info *info, const char __user *uargs,\n\t\t       int flags)\n{\n\tstruct module *mod;\n\tlong err = 0;\n\tchar *after_dashes;\n\n\terr = elf_header_check(info);\n\tif (err)\n\t\tgoto free_copy;\n\n\terr = setup_load_info(info, flags);\n\tif (err)\n\t\tgoto free_copy;\n\n\tif (blacklisted(info->name)) {\n\t\terr = -EPERM;\n\t\tgoto free_copy;\n\t}\n\n\terr = module_sig_check(info, flags);\n\tif (err)\n\t\tgoto free_copy;\n\n\terr = rewrite_section_headers(info, flags);\n\tif (err)\n\t\tgoto free_copy;\n\n\t/* Check module struct version now, before we try to use module. */\n\tif (!check_modstruct_version(info, info->mod)) {\n\t\terr = -ENOEXEC;\n\t\tgoto free_copy;\n\t}\n\n\t/* Figure out module layout, and allocate all the memory. */\n\tmod = layout_and_allocate(info, flags);\n\tif (IS_ERR(mod)) {\n\t\terr = PTR_ERR(mod);\n\t\tgoto free_copy;\n\t}\n\n\taudit_log_kern_module(mod->name);\n\n\t/* Reserve our place in the list. */\n\terr = add_unformed_module(mod);\n\tif (err)\n\t\tgoto free_module;\n\n#ifdef CONFIG_MODULE_SIG\n\tmod->sig_ok = info->sig_ok;\n\tif (!mod->sig_ok) {\n\t\tpr_notice_once(\"%s: module verification failed: signature \"\n\t\t\t       \"and/or required key missing - tainting \"\n\t\t\t       \"kernel\\n\", mod->name);\n\t\tadd_taint_module(mod, TAINT_UNSIGNED_MODULE, LOCKDEP_STILL_OK);\n\t}\n#endif\n\n\t/* To avoid stressing percpu allocator, do this once we're unique. */\n\terr = percpu_modalloc(mod, info);\n\tif (err)\n\t\tgoto unlink_mod;\n\n\t/* Now module is in final location, initialize linked lists, etc. */\n\terr = module_unload_init(mod);\n\tif (err)\n\t\tgoto unlink_mod;\n\n\tinit_param_lock(mod);\n\n\t/* Now we've got everything in the final locations, we can\n\t * find optional sections. */\n\terr = find_module_sections(mod, info);\n\tif (err)\n\t\tgoto free_unload;\n\n\terr = check_module_license_and_versions(mod);\n\tif (err)\n\t\tgoto free_unload;\n\n\t/* Set up MODINFO_ATTR fields */\n\tsetup_modinfo(mod, info);\n\n\t/* Fix up syms, so that st_value is a pointer to location. */\n\terr = simplify_symbols(mod, info);\n\tif (err < 0)\n\t\tgoto free_modinfo;\n\n\terr = apply_relocations(mod, info);\n\tif (err < 0)\n\t\tgoto free_modinfo;\n\n\terr = post_relocation(mod, info);\n\tif (err < 0)\n\t\tgoto free_modinfo;\n\n\tflush_module_icache(mod);\n\n\t/* Now copy in args */\n\tmod->args = strndup_user(uargs, ~0UL >> 1);\n\tif (IS_ERR(mod->args)) {\n\t\terr = PTR_ERR(mod->args);\n\t\tgoto free_arch_cleanup;\n\t}\n\n\tdynamic_debug_setup(mod, info->debug, info->num_debug);\n\n\t/* Ftrace init must be called in the MODULE_STATE_UNFORMED state */\n\tftrace_module_init(mod);\n\n\t/* Finally it's fully formed, ready to start executing. */\n\terr = complete_formation(mod, info);\n\tif (err)\n\t\tgoto ddebug_cleanup;\n\n\terr = prepare_coming_module(mod);\n\tif (err)\n\t\tgoto bug_cleanup;\n\n\t/* Module is ready to execute: parsing args may do that. */\n\tafter_dashes = parse_args(mod->name, mod->args, mod->kp, mod->num_kp,\n\t\t\t\t  -32768, 32767, mod,\n\t\t\t\t  unknown_module_param_cb);\n\tif (IS_ERR(after_dashes)) {\n\t\terr = PTR_ERR(after_dashes);\n\t\tgoto coming_cleanup;\n\t} else if (after_dashes) {\n\t\tpr_warn(\"%s: parameters '%s' after `--' ignored\\n\",\n\t\t       mod->name, after_dashes);\n\t}\n\n\t/* Link in to sysfs. */\n\terr = mod_sysfs_setup(mod, info, mod->kp, mod->num_kp);\n\tif (err < 0)\n\t\tgoto coming_cleanup;\n\n\tif (is_livepatch_module(mod)) {\n\t\terr = copy_module_elf(mod, info);\n\t\tif (err < 0)\n\t\t\tgoto sysfs_cleanup;\n\t}\n\n\t/* Get rid of temporary copy. */\n\tfree_copy(info);\n\n\t/* Done! */\n\ttrace_module_load(mod);\n\n\treturn do_init_module(mod);\n\n sysfs_cleanup:\n\tmod_sysfs_teardown(mod);\n coming_cleanup:\n\tmod->state = MODULE_STATE_GOING;\n\tdestroy_params(mod->kp, mod->num_kp);\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_GOING, mod);\n\tklp_module_going(mod);\n bug_cleanup:\n\t/* module_bug_cleanup needs module_mutex protection */\n\tmutex_lock(&module_mutex);\n\tmodule_bug_cleanup(mod);\n\tmutex_unlock(&module_mutex);\n\n\t/* we can't deallocate the module until we clear memory protection */\n\tmodule_disable_ro(mod);\n\tmodule_disable_nx(mod);\n\n ddebug_cleanup:\n\tftrace_release_mod(mod);\n\tdynamic_debug_remove(mod, info->debug);\n\tsynchronize_sched();\n\tkfree(mod->args);\n free_arch_cleanup:\n\tmodule_arch_cleanup(mod);\n free_modinfo:\n\tfree_modinfo(mod);\n free_unload:\n\tmodule_unload_free(mod);\n unlink_mod:\n\tmutex_lock(&module_mutex);\n\t/* Unlink carefully: kallsyms could be walking list. */\n\tlist_del_rcu(&mod->list);\n\tmod_tree_remove(mod);\n\twake_up_all(&module_wq);\n\t/* Wait for RCU-sched synchronizing before releasing mod->list. */\n\tsynchronize_sched();\n\tmutex_unlock(&module_mutex);\n free_module:\n\t/* Free lock-classes; relies on the preceding sync_rcu() */\n\tlockdep_free_key_range(mod->core_layout.base, mod->core_layout.size);\n\n\tmodule_deallocate(mod, info);\n free_copy:\n\tfree_copy(info);\n\treturn err;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_WAIT_QUEUE_HEAD(module_wq);",
      "static BLOCKING_NOTIFIER_HEAD(module_notify_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_copy",
          "args": [
            "info"
          ],
          "line": 3845
        },
        "resolved": true,
        "details": {
          "function_name": "free_copy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2899-2902",
          "snippet": "static void free_copy(struct load_info *info)\n{\n\tvfree(info->hdr);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_copy(struct load_info *info)\n{\n\tvfree(info->hdr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_deallocate",
          "args": [
            "mod",
            "info"
          ],
          "line": 3843
        },
        "resolved": true,
        "details": {
          "function_name": "module_deallocate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3348-3354",
          "snippet": "static void module_deallocate(struct module *mod, struct load_info *info)\n{\n\tpercpu_modfree(mod);\n\tmodule_arch_freeing_init(mod);\n\tmodule_memfree(mod->init_layout.base);\n\tmodule_memfree(mod->core_layout.base);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_deallocate(struct module *mod, struct load_info *info)\n{\n\tpercpu_modfree(mod);\n\tmodule_arch_freeing_init(mod);\n\tmodule_memfree(mod->init_layout.base);\n\tmodule_memfree(mod->core_layout.base);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_free_key_range",
          "args": [
            "mod->core_layout.base",
            "mod->core_layout.size"
          ],
          "line": 3841
        },
        "resolved": true,
        "details": {
          "function_name": "lockdep_free_key_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/lockdep.c",
          "lines": "4164-4205",
          "snippet": "void lockdep_free_key_range(void *start, unsigned long size)\n{\n\tstruct lock_class *class;\n\tstruct hlist_head *head;\n\tunsigned long flags;\n\tint i;\n\tint locked;\n\n\traw_local_irq_save(flags);\n\tlocked = graph_lock();\n\n\t/*\n\t * Unhash all classes that were created by this module:\n\t */\n\tfor (i = 0; i < CLASSHASH_SIZE; i++) {\n\t\thead = classhash_table + i;\n\t\thlist_for_each_entry_rcu(class, head, hash_entry) {\n\t\t\tif (within(class->key, start, size))\n\t\t\t\tzap_class(class);\n\t\t\telse if (within(class->name, start, size))\n\t\t\t\tzap_class(class);\n\t\t}\n\t}\n\n\tif (locked)\n\t\tgraph_unlock();\n\traw_local_irq_restore(flags);\n\n\t/*\n\t * Wait for any possible iterators from look_up_lock_class() to pass\n\t * before continuing to free the memory they refer to.\n\t *\n\t * sync_sched() is sufficient because the read-side is IRQ disable.\n\t */\n\tsynchronize_sched();\n\n\t/*\n\t * XXX at this point we could return the resources to the pool;\n\t * instead we leak them. We would need to change to bitmap allocators\n\t * instead of the linear allocators we have now.\n\t */\n}",
          "includes": [
            "#include \"lockdep_states.h\"",
            "#include \"lockdep_states.h\"",
            "#include \"lockdep_states.h\"",
            "#include \"lockdep_states.h\"",
            "#include <trace/events/lock.h>",
            "#include \"lockdep_internals.h\"",
            "#include <asm/sections.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jhash.h>",
            "#include <linux/random.h>",
            "#include <linux/gfp.h>",
            "#include <linux/bitops.h>",
            "#include <linux/stringify.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/hash.h>",
            "#include <linux/utsname.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/mutex.h>"
          ],
          "macros_used": [
            "#define CLASSHASH_SIZE\t\t(1UL << CLASSHASH_BITS)"
          ],
          "globals_used": [
            "static struct hlist_head classhash_table[CLASSHASH_SIZE];",
            "static int __lock_is_held(const struct lockdep_map *lock, int read);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lockdep_states.h\"\n#include \"lockdep_states.h\"\n#include \"lockdep_states.h\"\n#include \"lockdep_states.h\"\n#include <trace/events/lock.h>\n#include \"lockdep_internals.h\"\n#include <asm/sections.h>\n#include <linux/nmi.h>\n#include <linux/jhash.h>\n#include <linux/random.h>\n#include <linux/gfp.h>\n#include <linux/bitops.h>\n#include <linux/stringify.h>\n#include <linux/ftrace.h>\n#include <linux/hash.h>\n#include <linux/utsname.h>\n#include <linux/irqflags.h>\n#include <linux/debug_locks.h>\n#include <linux/stacktrace.h>\n#include <linux/interrupt.h>\n#include <linux/kallsyms.h>\n#include <linux/spinlock.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/delay.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/task.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n\n#define CLASSHASH_SIZE\t\t(1UL << CLASSHASH_BITS)\n\nstatic struct hlist_head classhash_table[CLASSHASH_SIZE];\nstatic int __lock_is_held(const struct lockdep_map *lock, int read);\n\nvoid lockdep_free_key_range(void *start, unsigned long size)\n{\n\tstruct lock_class *class;\n\tstruct hlist_head *head;\n\tunsigned long flags;\n\tint i;\n\tint locked;\n\n\traw_local_irq_save(flags);\n\tlocked = graph_lock();\n\n\t/*\n\t * Unhash all classes that were created by this module:\n\t */\n\tfor (i = 0; i < CLASSHASH_SIZE; i++) {\n\t\thead = classhash_table + i;\n\t\thlist_for_each_entry_rcu(class, head, hash_entry) {\n\t\t\tif (within(class->key, start, size))\n\t\t\t\tzap_class(class);\n\t\t\telse if (within(class->name, start, size))\n\t\t\t\tzap_class(class);\n\t\t}\n\t}\n\n\tif (locked)\n\t\tgraph_unlock();\n\traw_local_irq_restore(flags);\n\n\t/*\n\t * Wait for any possible iterators from look_up_lock_class() to pass\n\t * before continuing to free the memory they refer to.\n\t *\n\t * sync_sched() is sufficient because the read-side is IRQ disable.\n\t */\n\tsynchronize_sched();\n\n\t/*\n\t * XXX at this point we could return the resources to the pool;\n\t * instead we leak them. We would need to change to bitmap allocators\n\t * instead of the linear allocators we have now.\n\t */\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 3838
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "synchronize_sched",
          "args": [],
          "line": 3837
        },
        "resolved": true,
        "details": {
          "function_name": "synchronize_sched_expedited_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tree_exp.h",
          "lines": "468-540",
          "snippet": "static void synchronize_sched_expedited_wait(void)\n{\n\tint cpu;\n\tunsigned long jiffies_stall;\n\tunsigned long jiffies_start;\n\tunsigned long mask;\n\tint ndetected;\n\tstruct rcu_node *rnp;\n\tstruct rcu_node *rnp_root = rcu_get_root();\n\tint ret;\n\n\ttrace_rcu_exp_grace_period(rcu_state.name, rcu_exp_gp_seq_endval(), TPS(\"startwait\"));\n\tjiffies_stall = rcu_jiffies_till_stall_check();\n\tjiffies_start = jiffies;\n\n\tfor (;;) {\n\t\tret = swait_event_timeout_exclusive(\n\t\t\t\trcu_state.expedited_wq,\n\t\t\t\tsync_rcu_preempt_exp_done_unlocked(rnp_root),\n\t\t\t\tjiffies_stall);\n\t\tif (ret > 0 || sync_rcu_preempt_exp_done_unlocked(rnp_root))\n\t\t\treturn;\n\t\tWARN_ON(ret < 0);  /* workqueues should not be signaled. */\n\t\tif (rcu_cpu_stall_suppress)\n\t\t\tcontinue;\n\t\tpanic_on_rcu_stall();\n\t\tpr_err(\"INFO: %s detected expedited stalls on CPUs/tasks: {\",\n\t\t       rcu_state.name);\n\t\tndetected = 0;\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tndetected += rcu_print_task_exp_stall(rnp);\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tstruct rcu_data *rdp;\n\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tndetected++;\n\t\t\t\trdp = per_cpu_ptr(&rcu_data, cpu);\n\t\t\t\tpr_cont(\" %d-%c%c%c\", cpu,\n\t\t\t\t\t\"O.\"[!!cpu_online(cpu)],\n\t\t\t\t\t\"o.\"[!!(rdp->grpmask & rnp->expmaskinit)],\n\t\t\t\t\t\"N.\"[!!(rdp->grpmask & rnp->expmaskinitnext)]);\n\t\t\t}\n\t\t}\n\t\tpr_cont(\" } %lu jiffies s: %lu root: %#lx/%c\\n\",\n\t\t\tjiffies - jiffies_start, rcu_state.expedited_sequence,\n\t\t\trnp_root->expmask, \".T\"[!!rnp_root->exp_tasks]);\n\t\tif (ndetected) {\n\t\t\tpr_err(\"blocking rcu_node structures:\");\n\t\t\trcu_for_each_node_breadth_first(rnp) {\n\t\t\t\tif (rnp == rnp_root)\n\t\t\t\t\tcontinue; /* printed unconditionally */\n\t\t\t\tif (sync_rcu_preempt_exp_done_unlocked(rnp))\n\t\t\t\t\tcontinue;\n\t\t\t\tpr_cont(\" l=%u:%d-%d:%#lx/%c\",\n\t\t\t\t\trnp->level, rnp->grplo, rnp->grphi,\n\t\t\t\t\trnp->expmask,\n\t\t\t\t\t\".T\"[!!rnp->exp_tasks]);\n\t\t\t}\n\t\t\tpr_cont(\"\\n\");\n\t\t}\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tdump_cpu_task(cpu);\n\t\t\t}\n\t\t}\n\t\tjiffies_stall = 3 * rcu_jiffies_till_stall_check() + 3;\n\t}\n}",
          "includes": [
            "#include <linux/lockdep.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockdep.h>\n\nstatic void synchronize_sched_expedited_wait(void)\n{\n\tint cpu;\n\tunsigned long jiffies_stall;\n\tunsigned long jiffies_start;\n\tunsigned long mask;\n\tint ndetected;\n\tstruct rcu_node *rnp;\n\tstruct rcu_node *rnp_root = rcu_get_root();\n\tint ret;\n\n\ttrace_rcu_exp_grace_period(rcu_state.name, rcu_exp_gp_seq_endval(), TPS(\"startwait\"));\n\tjiffies_stall = rcu_jiffies_till_stall_check();\n\tjiffies_start = jiffies;\n\n\tfor (;;) {\n\t\tret = swait_event_timeout_exclusive(\n\t\t\t\trcu_state.expedited_wq,\n\t\t\t\tsync_rcu_preempt_exp_done_unlocked(rnp_root),\n\t\t\t\tjiffies_stall);\n\t\tif (ret > 0 || sync_rcu_preempt_exp_done_unlocked(rnp_root))\n\t\t\treturn;\n\t\tWARN_ON(ret < 0);  /* workqueues should not be signaled. */\n\t\tif (rcu_cpu_stall_suppress)\n\t\t\tcontinue;\n\t\tpanic_on_rcu_stall();\n\t\tpr_err(\"INFO: %s detected expedited stalls on CPUs/tasks: {\",\n\t\t       rcu_state.name);\n\t\tndetected = 0;\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tndetected += rcu_print_task_exp_stall(rnp);\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tstruct rcu_data *rdp;\n\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tndetected++;\n\t\t\t\trdp = per_cpu_ptr(&rcu_data, cpu);\n\t\t\t\tpr_cont(\" %d-%c%c%c\", cpu,\n\t\t\t\t\t\"O.\"[!!cpu_online(cpu)],\n\t\t\t\t\t\"o.\"[!!(rdp->grpmask & rnp->expmaskinit)],\n\t\t\t\t\t\"N.\"[!!(rdp->grpmask & rnp->expmaskinitnext)]);\n\t\t\t}\n\t\t}\n\t\tpr_cont(\" } %lu jiffies s: %lu root: %#lx/%c\\n\",\n\t\t\tjiffies - jiffies_start, rcu_state.expedited_sequence,\n\t\t\trnp_root->expmask, \".T\"[!!rnp_root->exp_tasks]);\n\t\tif (ndetected) {\n\t\t\tpr_err(\"blocking rcu_node structures:\");\n\t\t\trcu_for_each_node_breadth_first(rnp) {\n\t\t\t\tif (rnp == rnp_root)\n\t\t\t\t\tcontinue; /* printed unconditionally */\n\t\t\t\tif (sync_rcu_preempt_exp_done_unlocked(rnp))\n\t\t\t\t\tcontinue;\n\t\t\t\tpr_cont(\" l=%u:%d-%d:%#lx/%c\",\n\t\t\t\t\trnp->level, rnp->grplo, rnp->grphi,\n\t\t\t\t\trnp->expmask,\n\t\t\t\t\t\".T\"[!!rnp->exp_tasks]);\n\t\t\t}\n\t\t\tpr_cont(\"\\n\");\n\t\t}\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tdump_cpu_task(cpu);\n\t\t\t}\n\t\t}\n\t\tjiffies_stall = 3 * rcu_jiffies_till_stall_check() + 3;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "wake_up_all",
          "args": [
            "&module_wq"
          ],
          "line": 3835
        },
        "resolved": true,
        "details": {
          "function_name": "swake_up_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/swait.c",
          "lines": "49-69",
          "snippet": "void swake_up_all(struct swait_queue_head *q)\n{\n\tstruct swait_queue *curr;\n\tLIST_HEAD(tmp);\n\n\traw_spin_lock_irq(&q->lock);\n\tlist_splice_init(&q->task_list, &tmp);\n\twhile (!list_empty(&tmp)) {\n\t\tcurr = list_first_entry(&tmp, typeof(*curr), task_list);\n\n\t\twake_up_state(curr->task, TASK_NORMAL);\n\t\tlist_del_init(&curr->task_list);\n\n\t\tif (list_empty(&tmp))\n\t\t\tbreak;\n\n\t\traw_spin_unlock_irq(&q->lock);\n\t\traw_spin_lock_irq(&q->lock);\n\t}\n\traw_spin_unlock_irq(&q->lock);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nvoid swake_up_all(struct swait_queue_head *q)\n{\n\tstruct swait_queue *curr;\n\tLIST_HEAD(tmp);\n\n\traw_spin_lock_irq(&q->lock);\n\tlist_splice_init(&q->task_list, &tmp);\n\twhile (!list_empty(&tmp)) {\n\t\tcurr = list_first_entry(&tmp, typeof(*curr), task_list);\n\n\t\twake_up_state(curr->task, TASK_NORMAL);\n\t\tlist_del_init(&curr->task_list);\n\n\t\tif (list_empty(&tmp))\n\t\t\tbreak;\n\n\t\traw_spin_unlock_irq(&q->lock);\n\t\traw_spin_lock_irq(&q->lock);\n\t}\n\traw_spin_unlock_irq(&q->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mod_tree_remove",
          "args": [
            "mod"
          ],
          "line": 3834
        },
        "resolved": true,
        "details": {
          "function_name": "mod_tree_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "218-218",
          "snippet": "static void mod_tree_remove(struct module *mod) { }",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_tree_remove(struct module *mod) { }"
        }
      },
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&mod->list"
          ],
          "line": 3833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 3831
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_unload_free",
          "args": [
            "mod"
          ],
          "line": 3829
        },
        "resolved": true,
        "details": {
          "function_name": "module_unload_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1153-1155",
          "snippet": "static inline void module_unload_free(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void module_unload_free(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_modinfo",
          "args": [
            "mod"
          ],
          "line": 3827
        },
        "resolved": true,
        "details": {
          "function_name": "free_modinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2509-2518",
          "snippet": "static void free_modinfo(struct module *mod)\n{\n\tstruct module_attribute *attr;\n\tint i;\n\n\tfor (i = 0; (attr = modinfo_attrs[i]); i++) {\n\t\tif (attr->free)\n\t\t\tattr->free(mod);\n\t}\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};\n\nstatic void free_modinfo(struct module *mod)\n{\n\tstruct module_attribute *attr;\n\tint i;\n\n\tfor (i = 0; (attr = modinfo_attrs[i]); i++) {\n\t\tif (attr->free)\n\t\t\tattr->free(mod);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_arch_cleanup",
          "args": [
            "mod"
          ],
          "line": 3825
        },
        "resolved": true,
        "details": {
          "function_name": "module_arch_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2118-2120",
          "snippet": "void __weak module_arch_cleanup(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_arch_cleanup(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "mod->args"
          ],
          "line": 3823
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dynamic_debug_remove",
          "args": [
            "mod",
            "info->debug"
          ],
          "line": 3821
        },
        "resolved": true,
        "details": {
          "function_name": "dynamic_debug_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2725-2729",
          "snippet": "static void dynamic_debug_remove(struct module *mod, struct _ddebug *debug)\n{\n\tif (debug)\n\t\tddebug_remove_module(mod->name);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void dynamic_debug_remove(struct module *mod, struct _ddebug *debug)\n{\n\tif (debug)\n\t\tddebug_remove_module(mod->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ftrace_release_mod",
          "args": [
            "mod"
          ],
          "line": 3820
        },
        "resolved": true,
        "details": {
          "function_name": "ftrace_release_mod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/ftrace.c",
          "lines": "5692-5756",
          "snippet": "void ftrace_release_mod(struct module *mod)\n{\n\tstruct ftrace_mod_map *mod_map;\n\tstruct ftrace_mod_map *n;\n\tstruct dyn_ftrace *rec;\n\tstruct ftrace_page **last_pg;\n\tstruct ftrace_page *tmp_page = NULL;\n\tstruct ftrace_page *pg;\n\tint order;\n\n\tmutex_lock(&ftrace_lock);\n\n\tif (ftrace_disabled)\n\t\tgoto out_unlock;\n\n\tlist_for_each_entry_safe(mod_map, n, &ftrace_mod_maps, list) {\n\t\tif (mod_map->mod == mod) {\n\t\t\tlist_del_rcu(&mod_map->list);\n\t\t\tcall_rcu_sched(&mod_map->rcu, ftrace_free_mod_map);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/*\n\t * Each module has its own ftrace_pages, remove\n\t * them from the list.\n\t */\n\tlast_pg = &ftrace_pages_start;\n\tfor (pg = ftrace_pages_start; pg; pg = *last_pg) {\n\t\trec = &pg->records[0];\n\t\tif (within_module_core(rec->ip, mod) ||\n\t\t    within_module_init(rec->ip, mod)) {\n\t\t\t/*\n\t\t\t * As core pages are first, the first\n\t\t\t * page should never be a module page.\n\t\t\t */\n\t\t\tif (WARN_ON(pg == ftrace_pages_start))\n\t\t\t\tgoto out_unlock;\n\n\t\t\t/* Check if we are deleting the last page */\n\t\t\tif (pg == ftrace_pages)\n\t\t\t\tftrace_pages = next_to_ftrace_page(last_pg);\n\n\t\t\tftrace_update_tot_cnt -= pg->index;\n\t\t\t*last_pg = pg->next;\n\n\t\t\tpg->next = tmp_page;\n\t\t\ttmp_page = pg;\n\t\t} else\n\t\t\tlast_pg = &pg->next;\n\t}\n out_unlock:\n\tmutex_unlock(&ftrace_lock);\n\n\tfor (pg = tmp_page; pg; pg = tmp_page) {\n\n\t\t/* Needs to be called outside of ftrace_lock */\n\t\tclear_mod_from_hashes(pg);\n\n\t\torder = get_count_order(pg->size / ENTRIES_PER_PAGE);\n\t\tfree_pages((unsigned long)pg->records, order);\n\t\ttmp_page = pg->next;\n\t\tkfree(pg);\n\t}\n}",
          "includes": [
            "#include \"trace_stat.h\"",
            "#include \"trace_output.h\"",
            "#include <asm/setup.h>",
            "#include <asm/sections.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/hash.h>",
            "#include <linux/list.h>",
            "#include <linux/sort.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/tracefs.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/stop_machine.h>"
          ],
          "macros_used": [
            "#define ENTRIES_PER_PAGE (PAGE_SIZE / ENTRY_SIZE)"
          ],
          "globals_used": [
            "static int ftrace_disabled",
            "static DEFINE_MUTEX(ftrace_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_stat.h\"\n#include \"trace_output.h\"\n#include <asm/setup.h>\n#include <asm/sections.h>\n#include <trace/events/sched.h>\n#include <linux/rcupdate.h>\n#include <linux/hash.h>\n#include <linux/list.h>\n#include <linux/sort.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/sysctl.h>\n#include <linux/ftrace.h>\n#include <linux/module.h>\n#include <linux/bsearch.h>\n#include <linux/uaccess.h>\n#include <linux/kthread.h>\n#include <linux/hardirq.h>\n#include <linux/tracefs.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/kallsyms.h>\n#include <linux/sched/task.h>\n#include <linux/clocksource.h>\n#include <linux/stop_machine.h>\n\n#define ENTRIES_PER_PAGE (PAGE_SIZE / ENTRY_SIZE)\n\nstatic int ftrace_disabled;\nstatic DEFINE_MUTEX(ftrace_lock);\n\nvoid ftrace_release_mod(struct module *mod)\n{\n\tstruct ftrace_mod_map *mod_map;\n\tstruct ftrace_mod_map *n;\n\tstruct dyn_ftrace *rec;\n\tstruct ftrace_page **last_pg;\n\tstruct ftrace_page *tmp_page = NULL;\n\tstruct ftrace_page *pg;\n\tint order;\n\n\tmutex_lock(&ftrace_lock);\n\n\tif (ftrace_disabled)\n\t\tgoto out_unlock;\n\n\tlist_for_each_entry_safe(mod_map, n, &ftrace_mod_maps, list) {\n\t\tif (mod_map->mod == mod) {\n\t\t\tlist_del_rcu(&mod_map->list);\n\t\t\tcall_rcu_sched(&mod_map->rcu, ftrace_free_mod_map);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/*\n\t * Each module has its own ftrace_pages, remove\n\t * them from the list.\n\t */\n\tlast_pg = &ftrace_pages_start;\n\tfor (pg = ftrace_pages_start; pg; pg = *last_pg) {\n\t\trec = &pg->records[0];\n\t\tif (within_module_core(rec->ip, mod) ||\n\t\t    within_module_init(rec->ip, mod)) {\n\t\t\t/*\n\t\t\t * As core pages are first, the first\n\t\t\t * page should never be a module page.\n\t\t\t */\n\t\t\tif (WARN_ON(pg == ftrace_pages_start))\n\t\t\t\tgoto out_unlock;\n\n\t\t\t/* Check if we are deleting the last page */\n\t\t\tif (pg == ftrace_pages)\n\t\t\t\tftrace_pages = next_to_ftrace_page(last_pg);\n\n\t\t\tftrace_update_tot_cnt -= pg->index;\n\t\t\t*last_pg = pg->next;\n\n\t\t\tpg->next = tmp_page;\n\t\t\ttmp_page = pg;\n\t\t} else\n\t\t\tlast_pg = &pg->next;\n\t}\n out_unlock:\n\tmutex_unlock(&ftrace_lock);\n\n\tfor (pg = tmp_page; pg; pg = tmp_page) {\n\n\t\t/* Needs to be called outside of ftrace_lock */\n\t\tclear_mod_from_hashes(pg);\n\n\t\torder = get_count_order(pg->size / ENTRIES_PER_PAGE);\n\t\tfree_pages((unsigned long)pg->records, order);\n\t\ttmp_page = pg->next;\n\t\tkfree(pg);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_disable_nx",
          "args": [
            "mod"
          ],
          "line": 3817
        },
        "resolved": true,
        "details": {
          "function_name": "module_disable_nx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2035-2035",
          "snippet": "static void module_disable_nx(const struct module *mod) { }",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_disable_nx(const struct module *mod) { }"
        }
      },
      {
        "call_info": {
          "callee": "module_disable_ro",
          "args": [
            "mod"
          ],
          "line": 3816
        },
        "resolved": true,
        "details": {
          "function_name": "module_disable_ro",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1932-1942",
          "snippet": "void module_disable_ro(const struct module *mod)\n{\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tfrob_text(&mod->core_layout, set_memory_rw);\n\tfrob_rodata(&mod->core_layout, set_memory_rw);\n\tfrob_ro_after_init(&mod->core_layout, set_memory_rw);\n\tfrob_text(&mod->init_layout, set_memory_rw);\n\tfrob_rodata(&mod->init_layout, set_memory_rw);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_disable_ro(const struct module *mod)\n{\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tfrob_text(&mod->core_layout, set_memory_rw);\n\tfrob_rodata(&mod->core_layout, set_memory_rw);\n\tfrob_ro_after_init(&mod->core_layout, set_memory_rw);\n\tfrob_text(&mod->init_layout, set_memory_rw);\n\tfrob_rodata(&mod->init_layout, set_memory_rw);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_bug_cleanup",
          "args": [
            "mod"
          ],
          "line": 3812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "klp_module_going",
          "args": [
            "mod"
          ],
          "line": 3808
        },
        "resolved": true,
        "details": {
          "function_name": "klp_module_going",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/livepatch/core.c",
          "lines": "1030-1047",
          "snippet": "void klp_module_going(struct module *mod)\n{\n\tif (WARN_ON(mod->state != MODULE_STATE_GOING &&\n\t\t    mod->state != MODULE_STATE_COMING))\n\t\treturn;\n\n\tmutex_lock(&klp_mutex);\n\t/*\n\t * Each module has to know that klp_module_going()\n\t * has been called. We never know what module will\n\t * get patched by a new patch.\n\t */\n\tmod->klp_alive = false;\n\n\tklp_cleanup_module_patches_limited(mod, NULL);\n\n\tmutex_unlock(&klp_mutex);\n}",
          "includes": [
            "#include \"transition.h\"",
            "#include \"patch.h\"",
            "#include \"core.h\"",
            "#include <asm/cacheflush.h>",
            "#include <linux/completion.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/elf.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"transition.h\"\n#include \"patch.h\"\n#include \"core.h\"\n#include <asm/cacheflush.h>\n#include <linux/completion.h>\n#include <linux/moduleloader.h>\n#include <linux/elf.h>\n#include <linux/livepatch.h>\n#include <linux/kallsyms.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/mutex.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nvoid klp_module_going(struct module *mod)\n{\n\tif (WARN_ON(mod->state != MODULE_STATE_GOING &&\n\t\t    mod->state != MODULE_STATE_COMING))\n\t\treturn;\n\n\tmutex_lock(&klp_mutex);\n\t/*\n\t * Each module has to know that klp_module_going()\n\t * has been called. We never know what module will\n\t * get patched by a new patch.\n\t */\n\tmod->klp_alive = false;\n\n\tklp_cleanup_module_patches_limited(mod, NULL);\n\n\tmutex_unlock(&klp_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "blocking_notifier_call_chain",
          "args": [
            "&module_notify_list",
            "MODULE_STATE_GOING",
            "mod"
          ],
          "line": 3806
        },
        "resolved": true,
        "details": {
          "function_name": "blocking_notifier_call_chain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/notifier.c",
          "lines": "325-329",
          "snippet": "int blocking_notifier_call_chain(struct blocking_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\treturn __blocking_notifier_call_chain(nh, val, v, -1, NULL);\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint blocking_notifier_call_chain(struct blocking_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\treturn __blocking_notifier_call_chain(nh, val, v, -1, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "destroy_params",
          "args": [
            "mod->kp",
            "mod->num_kp"
          ],
          "line": 3805
        },
        "resolved": true,
        "details": {
          "function_name": "destroy_params",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "734-741",
          "snippet": "void destroy_params(const struct kernel_param *params, unsigned num)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < num; i++)\n\t\tif (params[i].ops->free)\n\t\t\tparams[i].ops->free(params[i].arg);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nvoid destroy_params(const struct kernel_param *params, unsigned num)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < num; i++)\n\t\tif (params[i].ops->free)\n\t\t\tparams[i].ops->free(params[i].arg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mod_sysfs_teardown",
          "args": [
            "mod"
          ],
          "line": 3802
        },
        "resolved": true,
        "details": {
          "function_name": "mod_sysfs_teardown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1868-1876",
          "snippet": "static void mod_sysfs_teardown(struct module *mod)\n{\n\tdel_usage_links(mod);\n\tmodule_remove_modinfo_attrs(mod);\n\tmodule_param_sysfs_remove(mod);\n\tkobject_put(mod->mkobj.drivers_dir);\n\tkobject_put(mod->holders_dir);\n\tmod_sysfs_fini(mod);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_sysfs_teardown(struct module *mod)\n{\n\tdel_usage_links(mod);\n\tmodule_remove_modinfo_attrs(mod);\n\tmodule_param_sysfs_remove(mod);\n\tkobject_put(mod->mkobj.drivers_dir);\n\tkobject_put(mod->holders_dir);\n\tmod_sysfs_fini(mod);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_init_module",
          "args": [
            "mod"
          ],
          "line": 3799
        },
        "resolved": true,
        "details": {
          "function_name": "do_init_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3430-3538",
          "snippet": "static noinline int do_init_module(struct module *mod)\n{\n\tint ret = 0;\n\tstruct mod_initfree *freeinit;\n\n\tfreeinit = kmalloc(sizeof(*freeinit), GFP_KERNEL);\n\tif (!freeinit) {\n\t\tret = -ENOMEM;\n\t\tgoto fail;\n\t}\n\tfreeinit->module_init = mod->init_layout.base;\n\n\t/*\n\t * We want to find out whether @mod uses async during init.  Clear\n\t * PF_USED_ASYNC.  async_schedule*() will set it.\n\t */\n\tcurrent->flags &= ~PF_USED_ASYNC;\n\n\tdo_mod_ctors(mod);\n\t/* Start the module */\n\tif (mod->init != NULL)\n\t\tret = do_one_initcall(mod->init);\n\tif (ret < 0) {\n\t\tgoto fail_free_freeinit;\n\t}\n\tif (ret > 0) {\n\t\tpr_warn(\"%s: '%s'->init suspiciously returned %d, it should \"\n\t\t\t\"follow 0/-E convention\\n\"\n\t\t\t\"%s: loading module anyway...\\n\",\n\t\t\t__func__, mod->name, ret, __func__);\n\t\tdump_stack();\n\t}\n\n\t/* Now it's a first class citizen! */\n\tmod->state = MODULE_STATE_LIVE;\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_LIVE, mod);\n\n\t/*\n\t * We need to finish all async code before the module init sequence\n\t * is done.  This has potential to deadlock.  For example, a newly\n\t * detected block device can trigger request_module() of the\n\t * default iosched from async probing task.  Once userland helper\n\t * reaches here, async_synchronize_full() will wait on the async\n\t * task waiting on request_module() and deadlock.\n\t *\n\t * This deadlock is avoided by perfomring async_synchronize_full()\n\t * iff module init queued any async jobs.  This isn't a full\n\t * solution as it will deadlock the same if module loading from\n\t * async jobs nests more than once; however, due to the various\n\t * constraints, this hack seems to be the best option for now.\n\t * Please refer to the following thread for details.\n\t *\n\t * http://thread.gmane.org/gmane.linux.kernel/1420814\n\t */\n\tif (!mod->async_probe_requested && (current->flags & PF_USED_ASYNC))\n\t\tasync_synchronize_full();\n\n\tftrace_free_mem(mod, mod->init_layout.base, mod->init_layout.base +\n\t\t\tmod->init_layout.size);\n\tmutex_lock(&module_mutex);\n\t/* Drop initial reference. */\n\tmodule_put(mod);\n\ttrim_init_extable(mod);\n#ifdef CONFIG_KALLSYMS\n\t/* Switch to core kallsyms now init is done: kallsyms may be walking! */\n\trcu_assign_pointer(mod->kallsyms, &mod->core_kallsyms);\n#endif\n\tmodule_enable_ro(mod, true);\n\tmod_tree_remove_init(mod);\n\tdisable_ro_nx(&mod->init_layout);\n\tmodule_arch_freeing_init(mod);\n\tmod->init_layout.base = NULL;\n\tmod->init_layout.size = 0;\n\tmod->init_layout.ro_size = 0;\n\tmod->init_layout.ro_after_init_size = 0;\n\tmod->init_layout.text_size = 0;\n\t/*\n\t * We want to free module_init, but be aware that kallsyms may be\n\t * walking this with preempt disabled.  In all the failure paths, we\n\t * call synchronize_sched(), but we don't want to slow down the success\n\t * path, so use actual RCU here.\n\t * Note that module_alloc() on most architectures creates W+X page\n\t * mappings which won't be cleaned up until do_free_init() runs.  Any\n\t * code such as mark_rodata_ro() which depends on those mappings to\n\t * be cleaned up needs to sync with the queued work - ie\n\t * rcu_barrier_sched()\n\t */\n\tcall_rcu_sched(&freeinit->rcu, do_free_init);\n\tmutex_unlock(&module_mutex);\n\twake_up_all(&module_wq);\n\n\treturn 0;\n\nfail_free_freeinit:\n\tkfree(freeinit);\nfail:\n\t/* Try to protect us from buggy refcounters. */\n\tmod->state = MODULE_STATE_GOING;\n\tsynchronize_sched();\n\tmodule_put(mod);\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_GOING, mod);\n\tklp_module_going(mod);\n\tftrace_release_mod(mod);\n\tfree_module(mod);\n\twake_up_all(&module_wq);\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(module_wq);",
            "static BLOCKING_NOTIFIER_HEAD(module_notify_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(module_wq);\nstatic BLOCKING_NOTIFIER_HEAD(module_notify_list);\n\nstatic noinline int do_init_module(struct module *mod)\n{\n\tint ret = 0;\n\tstruct mod_initfree *freeinit;\n\n\tfreeinit = kmalloc(sizeof(*freeinit), GFP_KERNEL);\n\tif (!freeinit) {\n\t\tret = -ENOMEM;\n\t\tgoto fail;\n\t}\n\tfreeinit->module_init = mod->init_layout.base;\n\n\t/*\n\t * We want to find out whether @mod uses async during init.  Clear\n\t * PF_USED_ASYNC.  async_schedule*() will set it.\n\t */\n\tcurrent->flags &= ~PF_USED_ASYNC;\n\n\tdo_mod_ctors(mod);\n\t/* Start the module */\n\tif (mod->init != NULL)\n\t\tret = do_one_initcall(mod->init);\n\tif (ret < 0) {\n\t\tgoto fail_free_freeinit;\n\t}\n\tif (ret > 0) {\n\t\tpr_warn(\"%s: '%s'->init suspiciously returned %d, it should \"\n\t\t\t\"follow 0/-E convention\\n\"\n\t\t\t\"%s: loading module anyway...\\n\",\n\t\t\t__func__, mod->name, ret, __func__);\n\t\tdump_stack();\n\t}\n\n\t/* Now it's a first class citizen! */\n\tmod->state = MODULE_STATE_LIVE;\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_LIVE, mod);\n\n\t/*\n\t * We need to finish all async code before the module init sequence\n\t * is done.  This has potential to deadlock.  For example, a newly\n\t * detected block device can trigger request_module() of the\n\t * default iosched from async probing task.  Once userland helper\n\t * reaches here, async_synchronize_full() will wait on the async\n\t * task waiting on request_module() and deadlock.\n\t *\n\t * This deadlock is avoided by perfomring async_synchronize_full()\n\t * iff module init queued any async jobs.  This isn't a full\n\t * solution as it will deadlock the same if module loading from\n\t * async jobs nests more than once; however, due to the various\n\t * constraints, this hack seems to be the best option for now.\n\t * Please refer to the following thread for details.\n\t *\n\t * http://thread.gmane.org/gmane.linux.kernel/1420814\n\t */\n\tif (!mod->async_probe_requested && (current->flags & PF_USED_ASYNC))\n\t\tasync_synchronize_full();\n\n\tftrace_free_mem(mod, mod->init_layout.base, mod->init_layout.base +\n\t\t\tmod->init_layout.size);\n\tmutex_lock(&module_mutex);\n\t/* Drop initial reference. */\n\tmodule_put(mod);\n\ttrim_init_extable(mod);\n#ifdef CONFIG_KALLSYMS\n\t/* Switch to core kallsyms now init is done: kallsyms may be walking! */\n\trcu_assign_pointer(mod->kallsyms, &mod->core_kallsyms);\n#endif\n\tmodule_enable_ro(mod, true);\n\tmod_tree_remove_init(mod);\n\tdisable_ro_nx(&mod->init_layout);\n\tmodule_arch_freeing_init(mod);\n\tmod->init_layout.base = NULL;\n\tmod->init_layout.size = 0;\n\tmod->init_layout.ro_size = 0;\n\tmod->init_layout.ro_after_init_size = 0;\n\tmod->init_layout.text_size = 0;\n\t/*\n\t * We want to free module_init, but be aware that kallsyms may be\n\t * walking this with preempt disabled.  In all the failure paths, we\n\t * call synchronize_sched(), but we don't want to slow down the success\n\t * path, so use actual RCU here.\n\t * Note that module_alloc() on most architectures creates W+X page\n\t * mappings which won't be cleaned up until do_free_init() runs.  Any\n\t * code such as mark_rodata_ro() which depends on those mappings to\n\t * be cleaned up needs to sync with the queued work - ie\n\t * rcu_barrier_sched()\n\t */\n\tcall_rcu_sched(&freeinit->rcu, do_free_init);\n\tmutex_unlock(&module_mutex);\n\twake_up_all(&module_wq);\n\n\treturn 0;\n\nfail_free_freeinit:\n\tkfree(freeinit);\nfail:\n\t/* Try to protect us from buggy refcounters. */\n\tmod->state = MODULE_STATE_GOING;\n\tsynchronize_sched();\n\tmodule_put(mod);\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_GOING, mod);\n\tklp_module_going(mod);\n\tftrace_release_mod(mod);\n\tfree_module(mod);\n\twake_up_all(&module_wq);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_module_load",
          "args": [
            "mod"
          ],
          "line": 3797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_module_elf",
          "args": [
            "mod",
            "info"
          ],
          "line": 3788
        },
        "resolved": true,
        "details": {
          "function_name": "copy_module_elf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2103-2106",
          "snippet": "static int copy_module_elf(struct module *mod, struct load_info *info)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int copy_module_elf(struct module *mod, struct load_info *info)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_livepatch_module",
          "args": [
            "mod"
          ],
          "line": 3787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mod_sysfs_setup",
          "args": [
            "mod",
            "info",
            "mod->kp",
            "mod->num_kp"
          ],
          "line": 3783
        },
        "resolved": true,
        "details": {
          "function_name": "mod_sysfs_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1843-1849",
          "snippet": "static int mod_sysfs_setup(struct module *mod,\n\t\t\t   const struct load_info *info,\n\t\t\t   struct kernel_param *kparam,\n\t\t\t   unsigned int num_params)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int mod_sysfs_setup(struct module *mod,\n\t\t\t   const struct load_info *info,\n\t\t\t   struct kernel_param *kparam,\n\t\t\t   unsigned int num_params)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: parameters '%s' after `--' ignored\\n\"",
            "mod->name",
            "after_dashes"
          ],
          "line": 3778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "after_dashes"
          ],
          "line": 3775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "after_dashes"
          ],
          "line": 3774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_args",
          "args": [
            "mod->name",
            "mod->args",
            "mod->kp",
            "mod->num_kp",
            "-32768",
            "32767",
            "mod",
            "unknown_module_param_cb"
          ],
          "line": 3771
        },
        "resolved": true,
        "details": {
          "function_name": "parse_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "164-217",
          "snippet": "char *parse_args(const char *doing,\n\t\t char *args,\n\t\t const struct kernel_param *params,\n\t\t unsigned num,\n\t\t s16 min_level,\n\t\t s16 max_level,\n\t\t void *arg,\n\t\t int (*unknown)(char *param, char *val,\n\t\t\t\tconst char *doing, void *arg))\n{\n\tchar *param, *val, *err = NULL;\n\n\t/* Chew leading spaces */\n\targs = skip_spaces(args);\n\n\tif (*args)\n\t\tpr_debug(\"doing %s, parsing ARGS: '%s'\\n\", doing, args);\n\n\twhile (*args) {\n\t\tint ret;\n\t\tint irq_was_disabled;\n\n\t\targs = next_arg(args, &param, &val);\n\t\t/* Stop at -- */\n\t\tif (!val && strcmp(param, \"--\") == 0)\n\t\t\treturn err ?: args;\n\t\tirq_was_disabled = irqs_disabled();\n\t\tret = parse_one(param, val, doing, params, num,\n\t\t\t\tmin_level, max_level, arg, unknown);\n\t\tif (irq_was_disabled && !irqs_disabled())\n\t\t\tpr_warn(\"%s: option '%s' enabled irq's!\\n\",\n\t\t\t\tdoing, param);\n\n\t\tswitch (ret) {\n\t\tcase 0:\n\t\t\tcontinue;\n\t\tcase -ENOENT:\n\t\t\tpr_err(\"%s: Unknown parameter `%s'\\n\", doing, param);\n\t\t\tbreak;\n\t\tcase -ENOSPC:\n\t\t\tpr_err(\"%s: `%s' too large for parameter `%s'\\n\",\n\t\t\t       doing, val ?: \"\", param);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tpr_err(\"%s: `%s' invalid for parameter `%s'\\n\",\n\t\t\t       doing, val ?: \"\", param);\n\t\t\tbreak;\n\t\t}\n\n\t\terr = ERR_PTR(ret);\n\t}\n\n\treturn err;\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nchar *parse_args(const char *doing,\n\t\t char *args,\n\t\t const struct kernel_param *params,\n\t\t unsigned num,\n\t\t s16 min_level,\n\t\t s16 max_level,\n\t\t void *arg,\n\t\t int (*unknown)(char *param, char *val,\n\t\t\t\tconst char *doing, void *arg))\n{\n\tchar *param, *val, *err = NULL;\n\n\t/* Chew leading spaces */\n\targs = skip_spaces(args);\n\n\tif (*args)\n\t\tpr_debug(\"doing %s, parsing ARGS: '%s'\\n\", doing, args);\n\n\twhile (*args) {\n\t\tint ret;\n\t\tint irq_was_disabled;\n\n\t\targs = next_arg(args, &param, &val);\n\t\t/* Stop at -- */\n\t\tif (!val && strcmp(param, \"--\") == 0)\n\t\t\treturn err ?: args;\n\t\tirq_was_disabled = irqs_disabled();\n\t\tret = parse_one(param, val, doing, params, num,\n\t\t\t\tmin_level, max_level, arg, unknown);\n\t\tif (irq_was_disabled && !irqs_disabled())\n\t\t\tpr_warn(\"%s: option '%s' enabled irq's!\\n\",\n\t\t\t\tdoing, param);\n\n\t\tswitch (ret) {\n\t\tcase 0:\n\t\t\tcontinue;\n\t\tcase -ENOENT:\n\t\t\tpr_err(\"%s: Unknown parameter `%s'\\n\", doing, param);\n\t\t\tbreak;\n\t\tcase -ENOSPC:\n\t\t\tpr_err(\"%s: `%s' too large for parameter `%s'\\n\",\n\t\t\t       doing, val ?: \"\", param);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tpr_err(\"%s: `%s' invalid for parameter `%s'\\n\",\n\t\t\t       doing, val ?: \"\", param);\n\t\t\tbreak;\n\t\t}\n\n\t\terr = ERR_PTR(ret);\n\t}\n\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prepare_coming_module",
          "args": [
            "mod"
          ],
          "line": 3766
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_coming_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3617-3629",
          "snippet": "static int prepare_coming_module(struct module *mod)\n{\n\tint err;\n\n\tftrace_module_enable(mod);\n\terr = klp_module_coming(mod);\n\tif (err)\n\t\treturn err;\n\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_COMING, mod);\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static BLOCKING_NOTIFIER_HEAD(module_notify_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic BLOCKING_NOTIFIER_HEAD(module_notify_list);\n\nstatic int prepare_coming_module(struct module *mod)\n{\n\tint err;\n\n\tftrace_module_enable(mod);\n\terr = klp_module_coming(mod);\n\tif (err)\n\t\treturn err;\n\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_COMING, mod);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "complete_formation",
          "args": [
            "mod",
            "info"
          ],
          "line": 3762
        },
        "resolved": true,
        "details": {
          "function_name": "complete_formation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3588-3615",
          "snippet": "static int complete_formation(struct module *mod, struct load_info *info)\n{\n\tint err;\n\n\tmutex_lock(&module_mutex);\n\n\t/* Find duplicate symbols (must be called under lock). */\n\terr = verify_export_symbols(mod);\n\tif (err < 0)\n\t\tgoto out;\n\n\t/* This relies on module_mutex for list integrity. */\n\tmodule_bug_finalize(info->hdr, info->sechdrs, mod);\n\n\tmodule_enable_ro(mod, false);\n\tmodule_enable_nx(mod);\n\n\t/* Mark state as coming so strong_try_module_get() ignores us,\n\t * but kallsyms etc. can see us. */\n\tmod->state = MODULE_STATE_COMING;\n\tmutex_unlock(&module_mutex);\n\n\treturn 0;\n\nout:\n\tmutex_unlock(&module_mutex);\n\treturn err;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int complete_formation(struct module *mod, struct load_info *info)\n{\n\tint err;\n\n\tmutex_lock(&module_mutex);\n\n\t/* Find duplicate symbols (must be called under lock). */\n\terr = verify_export_symbols(mod);\n\tif (err < 0)\n\t\tgoto out;\n\n\t/* This relies on module_mutex for list integrity. */\n\tmodule_bug_finalize(info->hdr, info->sechdrs, mod);\n\n\tmodule_enable_ro(mod, false);\n\tmodule_enable_nx(mod);\n\n\t/* Mark state as coming so strong_try_module_get() ignores us,\n\t * but kallsyms etc. can see us. */\n\tmod->state = MODULE_STATE_COMING;\n\tmutex_unlock(&module_mutex);\n\n\treturn 0;\n\nout:\n\tmutex_unlock(&module_mutex);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ftrace_module_init",
          "args": [
            "mod"
          ],
          "line": 3759
        },
        "resolved": true,
        "details": {
          "function_name": "ftrace_module_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/ftrace.c",
          "lines": "5830-5837",
          "snippet": "void ftrace_module_init(struct module *mod)\n{\n\tif (ftrace_disabled || !mod->num_ftrace_callsites)\n\t\treturn;\n\n\tftrace_process_locs(mod, mod->ftrace_callsites,\n\t\t\t    mod->ftrace_callsites + mod->num_ftrace_callsites);\n}",
          "includes": [
            "#include \"trace_stat.h\"",
            "#include \"trace_output.h\"",
            "#include <asm/setup.h>",
            "#include <asm/sections.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/hash.h>",
            "#include <linux/list.h>",
            "#include <linux/sort.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/tracefs.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/stop_machine.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int ftrace_disabled"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_stat.h\"\n#include \"trace_output.h\"\n#include <asm/setup.h>\n#include <asm/sections.h>\n#include <trace/events/sched.h>\n#include <linux/rcupdate.h>\n#include <linux/hash.h>\n#include <linux/list.h>\n#include <linux/sort.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/sysctl.h>\n#include <linux/ftrace.h>\n#include <linux/module.h>\n#include <linux/bsearch.h>\n#include <linux/uaccess.h>\n#include <linux/kthread.h>\n#include <linux/hardirq.h>\n#include <linux/tracefs.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/kallsyms.h>\n#include <linux/sched/task.h>\n#include <linux/clocksource.h>\n#include <linux/stop_machine.h>\n\nstatic int ftrace_disabled;\n\nvoid ftrace_module_init(struct module *mod)\n{\n\tif (ftrace_disabled || !mod->num_ftrace_callsites)\n\t\treturn;\n\n\tftrace_process_locs(mod, mod->ftrace_callsites,\n\t\t\t    mod->ftrace_callsites + mod->num_ftrace_callsites);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dynamic_debug_setup",
          "args": [
            "mod",
            "info->debug",
            "info->num_debug"
          ],
          "line": 3756
        },
        "resolved": true,
        "details": {
          "function_name": "dynamic_debug_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2714-2723",
          "snippet": "static void dynamic_debug_setup(struct module *mod, struct _ddebug *debug, unsigned int num)\n{\n\tif (!debug)\n\t\treturn;\n#ifdef CONFIG_DYNAMIC_DEBUG\n\tif (ddebug_add_module(debug, num, mod->name))\n\t\tpr_err(\"dynamic debug error adding module: %s\\n\",\n\t\t\tdebug->modname);\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void dynamic_debug_setup(struct module *mod, struct _ddebug *debug, unsigned int num)\n{\n\tif (!debug)\n\t\treturn;\n#ifdef CONFIG_DYNAMIC_DEBUG\n\tif (ddebug_add_module(debug, num, mod->name))\n\t\tpr_err(\"dynamic debug error adding module: %s\\n\",\n\t\t\tdebug->modname);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "mod->args"
          ],
          "line": 3752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "mod->args"
          ],
          "line": 3751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strndup_user",
          "args": [
            "uargs",
            "~0UL >> 1"
          ],
          "line": 3750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_module_icache",
          "args": [
            "mod"
          ],
          "line": 3747
        },
        "resolved": true,
        "details": {
          "function_name": "flush_module_icache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3241-3262",
          "snippet": "static void flush_module_icache(const struct module *mod)\n{\n\tmm_segment_t old_fs;\n\n\t/* flush the icache in correct context */\n\told_fs = get_fs();\n\tset_fs(KERNEL_DS);\n\n\t/*\n\t * Flush the instruction cache, since we've played with text.\n\t * Do it before processing of module parameters, so the module\n\t * can provide parameter accessor functions of its own.\n\t */\n\tif (mod->init_layout.base)\n\t\tflush_icache_range((unsigned long)mod->init_layout.base,\n\t\t\t\t   (unsigned long)mod->init_layout.base\n\t\t\t\t   + mod->init_layout.size);\n\tflush_icache_range((unsigned long)mod->core_layout.base,\n\t\t\t   (unsigned long)mod->core_layout.base + mod->core_layout.size);\n\n\tset_fs(old_fs);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void flush_module_icache(const struct module *mod)\n{\n\tmm_segment_t old_fs;\n\n\t/* flush the icache in correct context */\n\told_fs = get_fs();\n\tset_fs(KERNEL_DS);\n\n\t/*\n\t * Flush the instruction cache, since we've played with text.\n\t * Do it before processing of module parameters, so the module\n\t * can provide parameter accessor functions of its own.\n\t */\n\tif (mod->init_layout.base)\n\t\tflush_icache_range((unsigned long)mod->init_layout.base,\n\t\t\t\t   (unsigned long)mod->init_layout.base\n\t\t\t\t   + mod->init_layout.size);\n\tflush_icache_range((unsigned long)mod->core_layout.base,\n\t\t\t   (unsigned long)mod->core_layout.base + mod->core_layout.size);\n\n\tset_fs(old_fs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "post_relocation",
          "args": [
            "mod",
            "info"
          ],
          "line": 3743
        },
        "resolved": true,
        "details": {
          "function_name": "post_relocation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3363-3377",
          "snippet": "static int post_relocation(struct module *mod, const struct load_info *info)\n{\n\t/* Sort exception table now relocations are done. */\n\tsort_extable(mod->extable, mod->extable + mod->num_exentries);\n\n\t/* Copy relocated percpu area over. */\n\tpercpu_modcopy(mod, (void *)info->sechdrs[info->index.pcpu].sh_addr,\n\t\t       info->sechdrs[info->index.pcpu].sh_size);\n\n\t/* Setup kallsyms-specific fields. */\n\tadd_kallsyms(mod, info);\n\n\t/* Arch-specific module finalizing. */\n\treturn module_finalize(info->hdr, info->sechdrs, mod);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int post_relocation(struct module *mod, const struct load_info *info)\n{\n\t/* Sort exception table now relocations are done. */\n\tsort_extable(mod->extable, mod->extable + mod->num_exentries);\n\n\t/* Copy relocated percpu area over. */\n\tpercpu_modcopy(mod, (void *)info->sechdrs[info->index.pcpu].sh_addr,\n\t\t       info->sechdrs[info->index.pcpu].sh_size);\n\n\t/* Setup kallsyms-specific fields. */\n\tadd_kallsyms(mod, info);\n\n\t/* Arch-specific module finalizing. */\n\treturn module_finalize(info->hdr, info->sechdrs, mod);\n}"
        }
      },
      {
        "call_info": {
          "callee": "apply_relocations",
          "args": [
            "mod",
            "info"
          ],
          "line": 3739
        },
        "resolved": true,
        "details": {
          "function_name": "apply_relocations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2302-2333",
          "snippet": "static int apply_relocations(struct module *mod, const struct load_info *info)\n{\n\tunsigned int i;\n\tint err = 0;\n\n\t/* Now do relocations. */\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tunsigned int infosec = info->sechdrs[i].sh_info;\n\n\t\t/* Not a valid relocation section? */\n\t\tif (infosec >= info->hdr->e_shnum)\n\t\t\tcontinue;\n\n\t\t/* Don't bother with non-allocated sections */\n\t\tif (!(info->sechdrs[infosec].sh_flags & SHF_ALLOC))\n\t\t\tcontinue;\n\n\t\t/* Livepatch relocation sections are applied by livepatch */\n\t\tif (info->sechdrs[i].sh_flags & SHF_RELA_LIVEPATCH)\n\t\t\tcontinue;\n\n\t\tif (info->sechdrs[i].sh_type == SHT_REL)\n\t\t\terr = apply_relocate(info->sechdrs, info->strtab,\n\t\t\t\t\t     info->index.sym, i, mod);\n\t\telse if (info->sechdrs[i].sh_type == SHT_RELA)\n\t\t\terr = apply_relocate_add(info->sechdrs, info->strtab,\n\t\t\t\t\t\t info->index.sym, i, mod);\n\t\tif (err < 0)\n\t\t\tbreak;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int apply_relocations(struct module *mod, const struct load_info *info)\n{\n\tunsigned int i;\n\tint err = 0;\n\n\t/* Now do relocations. */\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tunsigned int infosec = info->sechdrs[i].sh_info;\n\n\t\t/* Not a valid relocation section? */\n\t\tif (infosec >= info->hdr->e_shnum)\n\t\t\tcontinue;\n\n\t\t/* Don't bother with non-allocated sections */\n\t\tif (!(info->sechdrs[infosec].sh_flags & SHF_ALLOC))\n\t\t\tcontinue;\n\n\t\t/* Livepatch relocation sections are applied by livepatch */\n\t\tif (info->sechdrs[i].sh_flags & SHF_RELA_LIVEPATCH)\n\t\t\tcontinue;\n\n\t\tif (info->sechdrs[i].sh_type == SHT_REL)\n\t\t\terr = apply_relocate(info->sechdrs, info->strtab,\n\t\t\t\t\t     info->index.sym, i, mod);\n\t\telse if (info->sechdrs[i].sh_type == SHT_RELA)\n\t\t\terr = apply_relocate_add(info->sechdrs, info->strtab,\n\t\t\t\t\t\t info->index.sym, i, mod);\n\t\tif (err < 0)\n\t\t\tbreak;\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "simplify_symbols",
          "args": [
            "mod",
            "info"
          ],
          "line": 3735
        },
        "resolved": true,
        "details": {
          "function_name": "simplify_symbols",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2235-2300",
          "snippet": "static int simplify_symbols(struct module *mod, const struct load_info *info)\n{\n\tElf_Shdr *symsec = &info->sechdrs[info->index.sym];\n\tElf_Sym *sym = (void *)symsec->sh_addr;\n\tunsigned long secbase;\n\tunsigned int i;\n\tint ret = 0;\n\tconst struct kernel_symbol *ksym;\n\n\tfor (i = 1; i < symsec->sh_size / sizeof(Elf_Sym); i++) {\n\t\tconst char *name = info->strtab + sym[i].st_name;\n\n\t\tswitch (sym[i].st_shndx) {\n\t\tcase SHN_COMMON:\n\t\t\t/* Ignore common symbols */\n\t\t\tif (!strncmp(name, \"__gnu_lto\", 9))\n\t\t\t\tbreak;\n\n\t\t\t/* We compiled with -fno-common.  These are not\n\t\t\t   supposed to happen.  */\n\t\t\tpr_debug(\"Common symbol: %s\\n\", name);\n\t\t\tpr_warn(\"%s: please compile with -fno-common\\n\",\n\t\t\t       mod->name);\n\t\t\tret = -ENOEXEC;\n\t\t\tbreak;\n\n\t\tcase SHN_ABS:\n\t\t\t/* Don't need to do anything */\n\t\t\tpr_debug(\"Absolute symbol: 0x%08lx\\n\",\n\t\t\t       (long)sym[i].st_value);\n\t\t\tbreak;\n\n\t\tcase SHN_LIVEPATCH:\n\t\t\t/* Livepatch symbols are resolved by livepatch */\n\t\t\tbreak;\n\n\t\tcase SHN_UNDEF:\n\t\t\tksym = resolve_symbol_wait(mod, info, name);\n\t\t\t/* Ok if resolved.  */\n\t\t\tif (ksym && !IS_ERR(ksym)) {\n\t\t\t\tsym[i].st_value = kernel_symbol_value(ksym);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Ok if weak.  */\n\t\t\tif (!ksym && ELF_ST_BIND(sym[i].st_info) == STB_WEAK)\n\t\t\t\tbreak;\n\n\t\t\tret = PTR_ERR(ksym) ?: -ENOENT;\n\t\t\tpr_warn(\"%s: Unknown symbol %s (err %d)\\n\",\n\t\t\t\tmod->name, name, ret);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\t/* Divert to percpu allocation if a percpu var. */\n\t\t\tif (sym[i].st_shndx == info->index.pcpu)\n\t\t\t\tsecbase = (unsigned long)mod_percpu(mod);\n\t\t\telse\n\t\t\t\tsecbase = info->sechdrs[sym[i].st_shndx].sh_addr;\n\t\t\tsym[i].st_value += secbase;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int simplify_symbols(struct module *mod, const struct load_info *info)\n{\n\tElf_Shdr *symsec = &info->sechdrs[info->index.sym];\n\tElf_Sym *sym = (void *)symsec->sh_addr;\n\tunsigned long secbase;\n\tunsigned int i;\n\tint ret = 0;\n\tconst struct kernel_symbol *ksym;\n\n\tfor (i = 1; i < symsec->sh_size / sizeof(Elf_Sym); i++) {\n\t\tconst char *name = info->strtab + sym[i].st_name;\n\n\t\tswitch (sym[i].st_shndx) {\n\t\tcase SHN_COMMON:\n\t\t\t/* Ignore common symbols */\n\t\t\tif (!strncmp(name, \"__gnu_lto\", 9))\n\t\t\t\tbreak;\n\n\t\t\t/* We compiled with -fno-common.  These are not\n\t\t\t   supposed to happen.  */\n\t\t\tpr_debug(\"Common symbol: %s\\n\", name);\n\t\t\tpr_warn(\"%s: please compile with -fno-common\\n\",\n\t\t\t       mod->name);\n\t\t\tret = -ENOEXEC;\n\t\t\tbreak;\n\n\t\tcase SHN_ABS:\n\t\t\t/* Don't need to do anything */\n\t\t\tpr_debug(\"Absolute symbol: 0x%08lx\\n\",\n\t\t\t       (long)sym[i].st_value);\n\t\t\tbreak;\n\n\t\tcase SHN_LIVEPATCH:\n\t\t\t/* Livepatch symbols are resolved by livepatch */\n\t\t\tbreak;\n\n\t\tcase SHN_UNDEF:\n\t\t\tksym = resolve_symbol_wait(mod, info, name);\n\t\t\t/* Ok if resolved.  */\n\t\t\tif (ksym && !IS_ERR(ksym)) {\n\t\t\t\tsym[i].st_value = kernel_symbol_value(ksym);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Ok if weak.  */\n\t\t\tif (!ksym && ELF_ST_BIND(sym[i].st_info) == STB_WEAK)\n\t\t\t\tbreak;\n\n\t\t\tret = PTR_ERR(ksym) ?: -ENOENT;\n\t\t\tpr_warn(\"%s: Unknown symbol %s (err %d)\\n\",\n\t\t\t\tmod->name, name, ret);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\t/* Divert to percpu allocation if a percpu var. */\n\t\t\tif (sym[i].st_shndx == info->index.pcpu)\n\t\t\t\tsecbase = (unsigned long)mod_percpu(mod);\n\t\t\telse\n\t\t\t\tsecbase = info->sechdrs[sym[i].st_shndx].sh_addr;\n\t\t\tsym[i].st_value += secbase;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_modinfo",
          "args": [
            "mod",
            "info"
          ],
          "line": 3732
        },
        "resolved": true,
        "details": {
          "function_name": "setup_modinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2498-2507",
          "snippet": "static void setup_modinfo(struct module *mod, struct load_info *info)\n{\n\tstruct module_attribute *attr;\n\tint i;\n\n\tfor (i = 0; (attr = modinfo_attrs[i]); i++) {\n\t\tif (attr->setup)\n\t\t\tattr->setup(mod, get_modinfo(info, attr->attr.name));\n\t}\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};\n\nstatic void setup_modinfo(struct module *mod, struct load_info *info)\n{\n\tstruct module_attribute *attr;\n\tint i;\n\n\tfor (i = 0; (attr = modinfo_attrs[i]); i++) {\n\t\tif (attr->setup)\n\t\t\tattr->setup(mod, get_modinfo(info, attr->attr.name));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_module_license_and_versions",
          "args": [
            "mod"
          ],
          "line": 3727
        },
        "resolved": true,
        "details": {
          "function_name": "check_module_license_and_versions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3200-3239",
          "snippet": "static int check_module_license_and_versions(struct module *mod)\n{\n\tint prev_taint = test_taint(TAINT_PROPRIETARY_MODULE);\n\n\t/*\n\t * ndiswrapper is under GPL by itself, but loads proprietary modules.\n\t * Don't use add_taint_module(), as it would prevent ndiswrapper from\n\t * using GPL-only symbols it needs.\n\t */\n\tif (strcmp(mod->name, \"ndiswrapper\") == 0)\n\t\tadd_taint(TAINT_PROPRIETARY_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\n\t/* driverloader was caught wrongly pretending to be under GPL */\n\tif (strcmp(mod->name, \"driverloader\") == 0)\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\n\t/* lve claims to be GPL but upstream won't provide source */\n\tif (strcmp(mod->name, \"lve\") == 0)\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\n\tif (!prev_taint && test_taint(TAINT_PROPRIETARY_MODULE))\n\t\tpr_warn(\"%s: module license taints kernel.\\n\", mod->name);\n\n#ifdef CONFIG_MODVERSIONS\n\tif ((mod->num_syms && !mod->crcs)\n\t    || (mod->num_gpl_syms && !mod->gpl_crcs)\n\t    || (mod->num_gpl_future_syms && !mod->gpl_future_crcs)\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t    || (mod->num_unused_syms && !mod->unused_crcs)\n\t    || (mod->num_unused_gpl_syms && !mod->unused_gpl_crcs)\n#endif\n\t\t) {\n\t\treturn try_to_force_load(mod,\n\t\t\t\t\t \"no versions for exported symbols\");\n\t}\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(modules);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic int check_module_license_and_versions(struct module *mod)\n{\n\tint prev_taint = test_taint(TAINT_PROPRIETARY_MODULE);\n\n\t/*\n\t * ndiswrapper is under GPL by itself, but loads proprietary modules.\n\t * Don't use add_taint_module(), as it would prevent ndiswrapper from\n\t * using GPL-only symbols it needs.\n\t */\n\tif (strcmp(mod->name, \"ndiswrapper\") == 0)\n\t\tadd_taint(TAINT_PROPRIETARY_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\n\t/* driverloader was caught wrongly pretending to be under GPL */\n\tif (strcmp(mod->name, \"driverloader\") == 0)\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\n\t/* lve claims to be GPL but upstream won't provide source */\n\tif (strcmp(mod->name, \"lve\") == 0)\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\n\tif (!prev_taint && test_taint(TAINT_PROPRIETARY_MODULE))\n\t\tpr_warn(\"%s: module license taints kernel.\\n\", mod->name);\n\n#ifdef CONFIG_MODVERSIONS\n\tif ((mod->num_syms && !mod->crcs)\n\t    || (mod->num_gpl_syms && !mod->gpl_crcs)\n\t    || (mod->num_gpl_future_syms && !mod->gpl_future_crcs)\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t    || (mod->num_unused_syms && !mod->unused_crcs)\n\t    || (mod->num_unused_gpl_syms && !mod->unused_gpl_crcs)\n#endif\n\t\t) {\n\t\treturn try_to_force_load(mod,\n\t\t\t\t\t \"no versions for exported symbols\");\n\t}\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_module_sections",
          "args": [
            "mod",
            "info"
          ],
          "line": 3723
        },
        "resolved": true,
        "details": {
          "function_name": "find_module_sections",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3047-3135",
          "snippet": "static int find_module_sections(struct module *mod, struct load_info *info)\n{\n\tmod->kp = section_objs(info, \"__param\",\n\t\t\t       sizeof(*mod->kp), &mod->num_kp);\n\tmod->syms = section_objs(info, \"__ksymtab\",\n\t\t\t\t sizeof(*mod->syms), &mod->num_syms);\n\tmod->crcs = section_addr(info, \"__kcrctab\");\n\tmod->gpl_syms = section_objs(info, \"__ksymtab_gpl\",\n\t\t\t\t     sizeof(*mod->gpl_syms),\n\t\t\t\t     &mod->num_gpl_syms);\n\tmod->gpl_crcs = section_addr(info, \"__kcrctab_gpl\");\n\tmod->gpl_future_syms = section_objs(info,\n\t\t\t\t\t    \"__ksymtab_gpl_future\",\n\t\t\t\t\t    sizeof(*mod->gpl_future_syms),\n\t\t\t\t\t    &mod->num_gpl_future_syms);\n\tmod->gpl_future_crcs = section_addr(info, \"__kcrctab_gpl_future\");\n\n#ifdef CONFIG_UNUSED_SYMBOLS\n\tmod->unused_syms = section_objs(info, \"__ksymtab_unused\",\n\t\t\t\t\tsizeof(*mod->unused_syms),\n\t\t\t\t\t&mod->num_unused_syms);\n\tmod->unused_crcs = section_addr(info, \"__kcrctab_unused\");\n\tmod->unused_gpl_syms = section_objs(info, \"__ksymtab_unused_gpl\",\n\t\t\t\t\t    sizeof(*mod->unused_gpl_syms),\n\t\t\t\t\t    &mod->num_unused_gpl_syms);\n\tmod->unused_gpl_crcs = section_addr(info, \"__kcrctab_unused_gpl\");\n#endif\n#ifdef CONFIG_CONSTRUCTORS\n\tmod->ctors = section_objs(info, \".ctors\",\n\t\t\t\t  sizeof(*mod->ctors), &mod->num_ctors);\n\tif (!mod->ctors)\n\t\tmod->ctors = section_objs(info, \".init_array\",\n\t\t\t\tsizeof(*mod->ctors), &mod->num_ctors);\n\telse if (find_sec(info, \".init_array\")) {\n\t\t/*\n\t\t * This shouldn't happen with same compiler and binutils\n\t\t * building all parts of the module.\n\t\t */\n\t\tpr_warn(\"%s: has both .ctors and .init_array.\\n\",\n\t\t       mod->name);\n\t\treturn -EINVAL;\n\t}\n#endif\n\n#ifdef CONFIG_TRACEPOINTS\n\tmod->tracepoints_ptrs = section_objs(info, \"__tracepoints_ptrs\",\n\t\t\t\t\t     sizeof(*mod->tracepoints_ptrs),\n\t\t\t\t\t     &mod->num_tracepoints);\n#endif\n#ifdef HAVE_JUMP_LABEL\n\tmod->jump_entries = section_objs(info, \"__jump_table\",\n\t\t\t\t\tsizeof(*mod->jump_entries),\n\t\t\t\t\t&mod->num_jump_entries);\n#endif\n#ifdef CONFIG_EVENT_TRACING\n\tmod->trace_events = section_objs(info, \"_ftrace_events\",\n\t\t\t\t\t sizeof(*mod->trace_events),\n\t\t\t\t\t &mod->num_trace_events);\n\tmod->trace_evals = section_objs(info, \"_ftrace_eval_map\",\n\t\t\t\t\tsizeof(*mod->trace_evals),\n\t\t\t\t\t&mod->num_trace_evals);\n#endif\n#ifdef CONFIG_TRACING\n\tmod->trace_bprintk_fmt_start = section_objs(info, \"__trace_printk_fmt\",\n\t\t\t\t\t sizeof(*mod->trace_bprintk_fmt_start),\n\t\t\t\t\t &mod->num_trace_bprintk_fmt);\n#endif\n#ifdef CONFIG_FTRACE_MCOUNT_RECORD\n\t/* sechdrs[0].sh_size is always zero */\n\tmod->ftrace_callsites = section_objs(info, \"__mcount_loc\",\n\t\t\t\t\t     sizeof(*mod->ftrace_callsites),\n\t\t\t\t\t     &mod->num_ftrace_callsites);\n#endif\n#ifdef CONFIG_FUNCTION_ERROR_INJECTION\n\tmod->ei_funcs = section_objs(info, \"_error_injection_whitelist\",\n\t\t\t\t\t    sizeof(*mod->ei_funcs),\n\t\t\t\t\t    &mod->num_ei_funcs);\n#endif\n\tmod->extable = section_objs(info, \"__ex_table\",\n\t\t\t\t    sizeof(*mod->extable), &mod->num_exentries);\n\n\tif (section_addr(info, \"__obsparm\"))\n\t\tpr_warn(\"%s: Ignoring obsolete parameters\\n\", mod->name);\n\n\tinfo->debug = section_objs(info, \"__verbose\",\n\t\t\t\t   sizeof(*info->debug), &info->num_debug);\n\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int find_module_sections(struct module *mod, struct load_info *info)\n{\n\tmod->kp = section_objs(info, \"__param\",\n\t\t\t       sizeof(*mod->kp), &mod->num_kp);\n\tmod->syms = section_objs(info, \"__ksymtab\",\n\t\t\t\t sizeof(*mod->syms), &mod->num_syms);\n\tmod->crcs = section_addr(info, \"__kcrctab\");\n\tmod->gpl_syms = section_objs(info, \"__ksymtab_gpl\",\n\t\t\t\t     sizeof(*mod->gpl_syms),\n\t\t\t\t     &mod->num_gpl_syms);\n\tmod->gpl_crcs = section_addr(info, \"__kcrctab_gpl\");\n\tmod->gpl_future_syms = section_objs(info,\n\t\t\t\t\t    \"__ksymtab_gpl_future\",\n\t\t\t\t\t    sizeof(*mod->gpl_future_syms),\n\t\t\t\t\t    &mod->num_gpl_future_syms);\n\tmod->gpl_future_crcs = section_addr(info, \"__kcrctab_gpl_future\");\n\n#ifdef CONFIG_UNUSED_SYMBOLS\n\tmod->unused_syms = section_objs(info, \"__ksymtab_unused\",\n\t\t\t\t\tsizeof(*mod->unused_syms),\n\t\t\t\t\t&mod->num_unused_syms);\n\tmod->unused_crcs = section_addr(info, \"__kcrctab_unused\");\n\tmod->unused_gpl_syms = section_objs(info, \"__ksymtab_unused_gpl\",\n\t\t\t\t\t    sizeof(*mod->unused_gpl_syms),\n\t\t\t\t\t    &mod->num_unused_gpl_syms);\n\tmod->unused_gpl_crcs = section_addr(info, \"__kcrctab_unused_gpl\");\n#endif\n#ifdef CONFIG_CONSTRUCTORS\n\tmod->ctors = section_objs(info, \".ctors\",\n\t\t\t\t  sizeof(*mod->ctors), &mod->num_ctors);\n\tif (!mod->ctors)\n\t\tmod->ctors = section_objs(info, \".init_array\",\n\t\t\t\tsizeof(*mod->ctors), &mod->num_ctors);\n\telse if (find_sec(info, \".init_array\")) {\n\t\t/*\n\t\t * This shouldn't happen with same compiler and binutils\n\t\t * building all parts of the module.\n\t\t */\n\t\tpr_warn(\"%s: has both .ctors and .init_array.\\n\",\n\t\t       mod->name);\n\t\treturn -EINVAL;\n\t}\n#endif\n\n#ifdef CONFIG_TRACEPOINTS\n\tmod->tracepoints_ptrs = section_objs(info, \"__tracepoints_ptrs\",\n\t\t\t\t\t     sizeof(*mod->tracepoints_ptrs),\n\t\t\t\t\t     &mod->num_tracepoints);\n#endif\n#ifdef HAVE_JUMP_LABEL\n\tmod->jump_entries = section_objs(info, \"__jump_table\",\n\t\t\t\t\tsizeof(*mod->jump_entries),\n\t\t\t\t\t&mod->num_jump_entries);\n#endif\n#ifdef CONFIG_EVENT_TRACING\n\tmod->trace_events = section_objs(info, \"_ftrace_events\",\n\t\t\t\t\t sizeof(*mod->trace_events),\n\t\t\t\t\t &mod->num_trace_events);\n\tmod->trace_evals = section_objs(info, \"_ftrace_eval_map\",\n\t\t\t\t\tsizeof(*mod->trace_evals),\n\t\t\t\t\t&mod->num_trace_evals);\n#endif\n#ifdef CONFIG_TRACING\n\tmod->trace_bprintk_fmt_start = section_objs(info, \"__trace_printk_fmt\",\n\t\t\t\t\t sizeof(*mod->trace_bprintk_fmt_start),\n\t\t\t\t\t &mod->num_trace_bprintk_fmt);\n#endif\n#ifdef CONFIG_FTRACE_MCOUNT_RECORD\n\t/* sechdrs[0].sh_size is always zero */\n\tmod->ftrace_callsites = section_objs(info, \"__mcount_loc\",\n\t\t\t\t\t     sizeof(*mod->ftrace_callsites),\n\t\t\t\t\t     &mod->num_ftrace_callsites);\n#endif\n#ifdef CONFIG_FUNCTION_ERROR_INJECTION\n\tmod->ei_funcs = section_objs(info, \"_error_injection_whitelist\",\n\t\t\t\t\t    sizeof(*mod->ei_funcs),\n\t\t\t\t\t    &mod->num_ei_funcs);\n#endif\n\tmod->extable = section_objs(info, \"__ex_table\",\n\t\t\t\t    sizeof(*mod->extable), &mod->num_exentries);\n\n\tif (section_addr(info, \"__obsparm\"))\n\t\tpr_warn(\"%s: Ignoring obsolete parameters\\n\", mod->name);\n\n\tinfo->debug = section_objs(info, \"__verbose\",\n\t\t\t\t   sizeof(*info->debug), &info->num_debug);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_param_lock",
          "args": [
            "mod"
          ],
          "line": 3719
        },
        "resolved": true,
        "details": {
          "function_name": "init_param_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1863-1865",
          "snippet": "static void init_param_lock(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void init_param_lock(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_unload_init",
          "args": [
            "mod"
          ],
          "line": 3715
        },
        "resolved": true,
        "details": {
          "function_name": "module_unload_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1163-1166",
          "snippet": "static inline int module_unload_init(struct module *mod)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int module_unload_init(struct module *mod)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "percpu_modalloc",
          "args": [
            "mod",
            "info"
          ],
          "line": 3710
        },
        "resolved": true,
        "details": {
          "function_name": "percpu_modalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "731-737",
          "snippet": "static int percpu_modalloc(struct module *mod, struct load_info *info)\n{\n\t/* UP modules shouldn't have this section: ENOMEM isn't quite right */\n\tif (info->sechdrs[info->index.pcpu].sh_size != 0)\n\t\treturn -ENOMEM;\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(modules);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic int percpu_modalloc(struct module *mod, struct load_info *info)\n{\n\t/* UP modules shouldn't have this section: ENOMEM isn't quite right */\n\tif (info->sechdrs[info->index.pcpu].sh_size != 0)\n\t\treturn -ENOMEM;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_taint_module",
          "args": [
            "mod",
            "TAINT_UNSIGNED_MODULE",
            "LOCKDEP_STILL_OK"
          ],
          "line": 3705
        },
        "resolved": true,
        "details": {
          "function_name": "add_taint_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "326-331",
          "snippet": "static inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_notice_once",
          "args": [
            "\"%s: module verification failed: signature \"\n\t\t\t       \"and/or required key missing - tainting \"\n\t\t\t       \"kernel\\n\"",
            "mod->name"
          ],
          "line": 3702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_unformed_module",
          "args": [
            "mod"
          ],
          "line": 3695
        },
        "resolved": true,
        "details": {
          "function_name": "add_unformed_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3553-3586",
          "snippet": "static int add_unformed_module(struct module *mod)\n{\n\tint err;\n\tstruct module *old;\n\n\tmod->state = MODULE_STATE_UNFORMED;\n\nagain:\n\tmutex_lock(&module_mutex);\n\told = find_module_all(mod->name, strlen(mod->name), true);\n\tif (old != NULL) {\n\t\tif (old->state == MODULE_STATE_COMING\n\t\t    || old->state == MODULE_STATE_UNFORMED) {\n\t\t\t/* Wait in case it fails to load. */\n\t\t\tmutex_unlock(&module_mutex);\n\t\t\terr = wait_event_interruptible(module_wq,\n\t\t\t\t\t       finished_loading(mod->name));\n\t\t\tif (err)\n\t\t\t\tgoto out_unlocked;\n\t\t\tgoto again;\n\t\t}\n\t\terr = -EEXIST;\n\t\tgoto out;\n\t}\n\tmod_update_bounds(mod);\n\tlist_add_rcu(&mod->list, &modules);\n\tmod_tree_insert(mod);\n\terr = 0;\n\nout:\n\tmutex_unlock(&module_mutex);\nout_unlocked:\n\treturn err;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(modules);",
            "static DECLARE_WAIT_QUEUE_HEAD(module_wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\nstatic DECLARE_WAIT_QUEUE_HEAD(module_wq);\n\nstatic int add_unformed_module(struct module *mod)\n{\n\tint err;\n\tstruct module *old;\n\n\tmod->state = MODULE_STATE_UNFORMED;\n\nagain:\n\tmutex_lock(&module_mutex);\n\told = find_module_all(mod->name, strlen(mod->name), true);\n\tif (old != NULL) {\n\t\tif (old->state == MODULE_STATE_COMING\n\t\t    || old->state == MODULE_STATE_UNFORMED) {\n\t\t\t/* Wait in case it fails to load. */\n\t\t\tmutex_unlock(&module_mutex);\n\t\t\terr = wait_event_interruptible(module_wq,\n\t\t\t\t\t       finished_loading(mod->name));\n\t\t\tif (err)\n\t\t\t\tgoto out_unlocked;\n\t\t\tgoto again;\n\t\t}\n\t\terr = -EEXIST;\n\t\tgoto out;\n\t}\n\tmod_update_bounds(mod);\n\tlist_add_rcu(&mod->list, &modules);\n\tmod_tree_insert(mod);\n\terr = 0;\n\nout:\n\tmutex_unlock(&module_mutex);\nout_unlocked:\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "audit_log_kern_module",
          "args": [
            "mod->name"
          ],
          "line": 3692
        },
        "resolved": true,
        "details": {
          "function_name": "__audit_log_kern_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/auditsc.c",
          "lines": "2414-2422",
          "snippet": "void __audit_log_kern_module(char *name)\n{\n\tstruct audit_context *context = audit_context();\n\n\tcontext->module.name = kstrdup(name, GFP_KERNEL);\n\tif (!context->module.name)\n\t\taudit_log_lost(\"out of memory in __audit_log_kern_module\");\n\tcontext->type = AUDIT_KERN_MODULE;\n}",
          "includes": [
            "#include \"audit.h\"",
            "#include <uapi/linux/limits.h>",
            "#include <linux/fsnotify_backend.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/ctype.h>",
            "#include <linux/compat.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/capability.h>",
            "#include <asm/syscall.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/highmem.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/list.h>",
            "#include <linux/security.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compiler.h>",
            "#include <linux/netlink.h>",
            "#include <linux/time.h>",
            "#include <linux/personality.h>",
            "#include <linux/audit.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/socket.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/atomic.h>",
            "#include <asm/types.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"audit.h\"\n#include <uapi/linux/limits.h>\n#include <linux/fsnotify_backend.h>\n#include <linux/uaccess.h>\n#include <linux/string.h>\n#include <linux/ctype.h>\n#include <linux/compat.h>\n#include <linux/fs_struct.h>\n#include <linux/capability.h>\n#include <asm/syscall.h>\n#include <linux/syscalls.h>\n#include <linux/highmem.h>\n#include <linux/binfmts.h>\n#include <linux/list.h>\n#include <linux/security.h>\n#include <asm/unistd.h>\n#include <linux/compiler.h>\n#include <linux/netlink.h>\n#include <linux/time.h>\n#include <linux/personality.h>\n#include <linux/audit.h>\n#include <linux/mqueue.h>\n#include <linux/socket.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/atomic.h>\n#include <asm/types.h>\n#include <linux/init.h>\n\nvoid __audit_log_kern_module(char *name)\n{\n\tstruct audit_context *context = audit_context();\n\n\tcontext->module.name = kstrdup(name, GFP_KERNEL);\n\tif (!context->module.name)\n\t\taudit_log_lost(\"out of memory in __audit_log_kern_module\");\n\tcontext->type = AUDIT_KERN_MODULE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "mod"
          ],
          "line": 3688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "mod"
          ],
          "line": 3687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layout_and_allocate",
          "args": [
            "info",
            "flags"
          ],
          "line": 3686
        },
        "resolved": true,
        "details": {
          "function_name": "layout_and_allocate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3293-3345",
          "snippet": "static struct module *layout_and_allocate(struct load_info *info, int flags)\n{\n\tstruct module *mod;\n\tunsigned int ndx;\n\tint err;\n\n\terr = check_modinfo(info->mod, info, flags);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\t/* Allow arches to frob section contents and sizes.  */\n\terr = module_frob_arch_sections(info->hdr, info->sechdrs,\n\t\t\t\t\tinfo->secstrings, info->mod);\n\tif (err < 0)\n\t\treturn ERR_PTR(err);\n\n\t/* We will do a special allocation for per-cpu sections later. */\n\tinfo->sechdrs[info->index.pcpu].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\n\t/*\n\t * Mark ro_after_init section with SHF_RO_AFTER_INIT so that\n\t * layout_sections() can put it in the right place.\n\t * Note: ro_after_init sections also have SHF_{WRITE,ALLOC} set.\n\t */\n\tndx = find_sec(info, \".data..ro_after_init\");\n\tif (ndx)\n\t\tinfo->sechdrs[ndx].sh_flags |= SHF_RO_AFTER_INIT;\n\t/*\n\t * Mark the __jump_table section as ro_after_init as well: these data\n\t * structures are never modified, with the exception of entries that\n\t * refer to code in the __init section, which are annotated as such\n\t * at module load time.\n\t */\n\tndx = find_sec(info, \"__jump_table\");\n\tif (ndx)\n\t\tinfo->sechdrs[ndx].sh_flags |= SHF_RO_AFTER_INIT;\n\n\t/* Determine total sizes, and put offsets in sh_entsize.  For now\n\t   this is done generically; there doesn't appear to be any\n\t   special cases for the architectures. */\n\tlayout_sections(info->mod, info);\n\tlayout_symtab(info->mod, info);\n\n\t/* Allocate and move to the final place */\n\terr = move_module(info->mod, info);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\t/* Module has been copied to its final place now: return it. */\n\tmod = (void *)info->sechdrs[info->index.mod].sh_addr;\n\tkmemleak_load_module(mod, info);\n\treturn mod;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic struct module *layout_and_allocate(struct load_info *info, int flags)\n{\n\tstruct module *mod;\n\tunsigned int ndx;\n\tint err;\n\n\terr = check_modinfo(info->mod, info, flags);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\t/* Allow arches to frob section contents and sizes.  */\n\terr = module_frob_arch_sections(info->hdr, info->sechdrs,\n\t\t\t\t\tinfo->secstrings, info->mod);\n\tif (err < 0)\n\t\treturn ERR_PTR(err);\n\n\t/* We will do a special allocation for per-cpu sections later. */\n\tinfo->sechdrs[info->index.pcpu].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\n\t/*\n\t * Mark ro_after_init section with SHF_RO_AFTER_INIT so that\n\t * layout_sections() can put it in the right place.\n\t * Note: ro_after_init sections also have SHF_{WRITE,ALLOC} set.\n\t */\n\tndx = find_sec(info, \".data..ro_after_init\");\n\tif (ndx)\n\t\tinfo->sechdrs[ndx].sh_flags |= SHF_RO_AFTER_INIT;\n\t/*\n\t * Mark the __jump_table section as ro_after_init as well: these data\n\t * structures are never modified, with the exception of entries that\n\t * refer to code in the __init section, which are annotated as such\n\t * at module load time.\n\t */\n\tndx = find_sec(info, \"__jump_table\");\n\tif (ndx)\n\t\tinfo->sechdrs[ndx].sh_flags |= SHF_RO_AFTER_INIT;\n\n\t/* Determine total sizes, and put offsets in sh_entsize.  For now\n\t   this is done generically; there doesn't appear to be any\n\t   special cases for the architectures. */\n\tlayout_sections(info->mod, info);\n\tlayout_symtab(info->mod, info);\n\n\t/* Allocate and move to the final place */\n\terr = move_module(info->mod, info);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\t/* Module has been copied to its final place now: return it. */\n\tmod = (void *)info->sechdrs[info->index.mod].sh_addr;\n\tkmemleak_load_module(mod, info);\n\treturn mod;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_modstruct_version",
          "args": [
            "info",
            "info->mod"
          ],
          "line": 3680
        },
        "resolved": true,
        "details": {
          "function_name": "check_modstruct_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1369-1373",
          "snippet": "static inline int check_modstruct_version(const struct load_info *info,\n\t\t\t\t\t  struct module *mod)\n{\n\treturn 1;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int check_modstruct_version(const struct load_info *info,\n\t\t\t\t\t  struct module *mod)\n{\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rewrite_section_headers",
          "args": [
            "info",
            "flags"
          ],
          "line": 3675
        },
        "resolved": true,
        "details": {
          "function_name": "rewrite_section_headers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2904-2935",
          "snippet": "static int rewrite_section_headers(struct load_info *info, int flags)\n{\n\tunsigned int i;\n\n\t/* This should always be true, but let's be sure. */\n\tinfo->sechdrs[0].sh_addr = 0;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\tif (shdr->sh_type != SHT_NOBITS\n\t\t    && info->len < shdr->sh_offset + shdr->sh_size) {\n\t\t\tpr_err(\"Module len %lu truncated\\n\", info->len);\n\t\t\treturn -ENOEXEC;\n\t\t}\n\n\t\t/* Mark all sections sh_addr with their address in the\n\t\t   temporary image. */\n\t\tshdr->sh_addr = (size_t)info->hdr + shdr->sh_offset;\n\n#ifndef CONFIG_MODULE_UNLOAD\n\t\t/* Don't load .exit sections */\n\t\tif (strstarts(info->secstrings+shdr->sh_name, \".exit\"))\n\t\t\tshdr->sh_flags &= ~(unsigned long)SHF_ALLOC;\n#endif\n\t}\n\n\t/* Track but don't keep modinfo and version sections. */\n\tinfo->sechdrs[info->index.vers].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\tinfo->sechdrs[info->index.info].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int rewrite_section_headers(struct load_info *info, int flags)\n{\n\tunsigned int i;\n\n\t/* This should always be true, but let's be sure. */\n\tinfo->sechdrs[0].sh_addr = 0;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\tif (shdr->sh_type != SHT_NOBITS\n\t\t    && info->len < shdr->sh_offset + shdr->sh_size) {\n\t\t\tpr_err(\"Module len %lu truncated\\n\", info->len);\n\t\t\treturn -ENOEXEC;\n\t\t}\n\n\t\t/* Mark all sections sh_addr with their address in the\n\t\t   temporary image. */\n\t\tshdr->sh_addr = (size_t)info->hdr + shdr->sh_offset;\n\n#ifndef CONFIG_MODULE_UNLOAD\n\t\t/* Don't load .exit sections */\n\t\tif (strstarts(info->secstrings+shdr->sh_name, \".exit\"))\n\t\t\tshdr->sh_flags &= ~(unsigned long)SHF_ALLOC;\n#endif\n\t}\n\n\t/* Track but don't keep modinfo and version sections. */\n\tinfo->sechdrs[info->index.vers].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\tinfo->sechdrs[info->index.info].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_sig_check",
          "args": [
            "info",
            "flags"
          ],
          "line": 3671
        },
        "resolved": true,
        "details": {
          "function_name": "module_sig_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2794-2797",
          "snippet": "static int module_sig_check(struct load_info *info, int flags)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int module_sig_check(struct load_info *info, int flags)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "blacklisted",
          "args": [
            "info->name"
          ],
          "line": 3666
        },
        "resolved": true,
        "details": {
          "function_name": "blacklisted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3274-3290",
          "snippet": "static bool blacklisted(const char *module_name)\n{\n\tconst char *p;\n\tsize_t len;\n\n\tif (!module_blacklist)\n\t\treturn false;\n\n\tfor (p = module_blacklist; *p; p += len) {\n\t\tlen = strcspn(p, \",\");\n\t\tif (strlen(module_name) == len && !memcmp(module_name, p, len))\n\t\t\treturn true;\n\t\tif (p[len] == ',')\n\t\t\tlen++;\n\t}\n\treturn false;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *module_blacklist;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *module_blacklist;\n\nstatic bool blacklisted(const char *module_name)\n{\n\tconst char *p;\n\tsize_t len;\n\n\tif (!module_blacklist)\n\t\treturn false;\n\n\tfor (p = module_blacklist; *p; p += len) {\n\t\tlen = strcspn(p, \",\");\n\t\tif (strlen(module_name) == len && !memcmp(module_name, p, len))\n\t\t\treturn true;\n\t\tif (p[len] == ',')\n\t\t\tlen++;\n\t}\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_load_info",
          "args": [
            "info",
            "flags"
          ],
          "line": 3662
        },
        "resolved": true,
        "details": {
          "function_name": "setup_load_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2945-3001",
          "snippet": "static int setup_load_info(struct load_info *info, int flags)\n{\n\tunsigned int i;\n\n\t/* Set up the convenience variables */\n\tinfo->sechdrs = (void *)info->hdr + info->hdr->e_shoff;\n\tinfo->secstrings = (void *)info->hdr\n\t\t+ info->sechdrs[info->hdr->e_shstrndx].sh_offset;\n\n\t/* Try to find a name early so we can log errors with a module name */\n\tinfo->index.info = find_sec(info, \".modinfo\");\n\tif (!info->index.info)\n\t\tinfo->name = \"(missing .modinfo section)\";\n\telse\n\t\tinfo->name = get_modinfo(info, \"name\");\n\n\t/* Find internal symbols and strings. */\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tif (info->sechdrs[i].sh_type == SHT_SYMTAB) {\n\t\t\tinfo->index.sym = i;\n\t\t\tinfo->index.str = info->sechdrs[i].sh_link;\n\t\t\tinfo->strtab = (char *)info->hdr\n\t\t\t\t+ info->sechdrs[info->index.str].sh_offset;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (info->index.sym == 0) {\n\t\tpr_warn(\"%s: module has no symbols (stripped?)\\n\", info->name);\n\t\treturn -ENOEXEC;\n\t}\n\n\tinfo->index.mod = find_sec(info, \".gnu.linkonce.this_module\");\n\tif (!info->index.mod) {\n\t\tpr_warn(\"%s: No module found in object\\n\",\n\t\t\tinfo->name ?: \"(missing .modinfo name field)\");\n\t\treturn -ENOEXEC;\n\t}\n\t/* This is temporary: point mod into copy of data. */\n\tinfo->mod = (void *)info->hdr + info->sechdrs[info->index.mod].sh_offset;\n\n\t/*\n\t * If we didn't load the .modinfo 'name' field earlier, fall back to\n\t * on-disk struct mod 'name' field.\n\t */\n\tif (!info->name)\n\t\tinfo->name = info->mod->name;\n\n\tif (flags & MODULE_INIT_IGNORE_MODVERSIONS)\n\t\tinfo->index.vers = 0; /* Pretend no __versions section! */\n\telse\n\t\tinfo->index.vers = find_sec(info, \"__versions\");\n\n\tinfo->index.pcpu = find_pcpusec(info);\n\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int setup_load_info(struct load_info *info, int flags)\n{\n\tunsigned int i;\n\n\t/* Set up the convenience variables */\n\tinfo->sechdrs = (void *)info->hdr + info->hdr->e_shoff;\n\tinfo->secstrings = (void *)info->hdr\n\t\t+ info->sechdrs[info->hdr->e_shstrndx].sh_offset;\n\n\t/* Try to find a name early so we can log errors with a module name */\n\tinfo->index.info = find_sec(info, \".modinfo\");\n\tif (!info->index.info)\n\t\tinfo->name = \"(missing .modinfo section)\";\n\telse\n\t\tinfo->name = get_modinfo(info, \"name\");\n\n\t/* Find internal symbols and strings. */\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tif (info->sechdrs[i].sh_type == SHT_SYMTAB) {\n\t\t\tinfo->index.sym = i;\n\t\t\tinfo->index.str = info->sechdrs[i].sh_link;\n\t\t\tinfo->strtab = (char *)info->hdr\n\t\t\t\t+ info->sechdrs[info->index.str].sh_offset;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (info->index.sym == 0) {\n\t\tpr_warn(\"%s: module has no symbols (stripped?)\\n\", info->name);\n\t\treturn -ENOEXEC;\n\t}\n\n\tinfo->index.mod = find_sec(info, \".gnu.linkonce.this_module\");\n\tif (!info->index.mod) {\n\t\tpr_warn(\"%s: No module found in object\\n\",\n\t\t\tinfo->name ?: \"(missing .modinfo name field)\");\n\t\treturn -ENOEXEC;\n\t}\n\t/* This is temporary: point mod into copy of data. */\n\tinfo->mod = (void *)info->hdr + info->sechdrs[info->index.mod].sh_offset;\n\n\t/*\n\t * If we didn't load the .modinfo 'name' field earlier, fall back to\n\t * on-disk struct mod 'name' field.\n\t */\n\tif (!info->name)\n\t\tinfo->name = info->mod->name;\n\n\tif (flags & MODULE_INIT_IGNORE_MODVERSIONS)\n\t\tinfo->index.vers = 0; /* Pretend no __versions section! */\n\telse\n\t\tinfo->index.vers = find_sec(info, \"__versions\");\n\n\tinfo->index.pcpu = find_pcpusec(info);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "elf_header_check",
          "args": [
            "info"
          ],
          "line": 3658
        },
        "resolved": true,
        "details": {
          "function_name": "elf_header_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2801-2818",
          "snippet": "static int elf_header_check(struct load_info *info)\n{\n\tif (info->len < sizeof(*(info->hdr)))\n\t\treturn -ENOEXEC;\n\n\tif (memcmp(info->hdr->e_ident, ELFMAG, SELFMAG) != 0\n\t    || info->hdr->e_type != ET_REL\n\t    || !elf_check_arch(info->hdr)\n\t    || info->hdr->e_shentsize != sizeof(Elf_Shdr))\n\t\treturn -ENOEXEC;\n\n\tif (info->hdr->e_shoff >= info->len\n\t    || (info->hdr->e_shnum * sizeof(Elf_Shdr) >\n\t\tinfo->len - info->hdr->e_shoff))\n\t\treturn -ENOEXEC;\n\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int elf_header_check(struct load_info *info)\n{\n\tif (info->len < sizeof(*(info->hdr)))\n\t\treturn -ENOEXEC;\n\n\tif (memcmp(info->hdr->e_ident, ELFMAG, SELFMAG) != 0\n\t    || info->hdr->e_type != ET_REL\n\t    || !elf_check_arch(info->hdr)\n\t    || info->hdr->e_shentsize != sizeof(Elf_Shdr))\n\t\treturn -ENOEXEC;\n\n\tif (info->hdr->e_shoff >= info->len\n\t    || (info->hdr->e_shnum * sizeof(Elf_Shdr) >\n\t\tinfo->len - info->hdr->e_shoff))\n\t\treturn -ENOEXEC;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(module_wq);\nstatic BLOCKING_NOTIFIER_HEAD(module_notify_list);\n\nstatic int load_module(struct load_info *info, const char __user *uargs,\n\t\t       int flags)\n{\n\tstruct module *mod;\n\tlong err = 0;\n\tchar *after_dashes;\n\n\terr = elf_header_check(info);\n\tif (err)\n\t\tgoto free_copy;\n\n\terr = setup_load_info(info, flags);\n\tif (err)\n\t\tgoto free_copy;\n\n\tif (blacklisted(info->name)) {\n\t\terr = -EPERM;\n\t\tgoto free_copy;\n\t}\n\n\terr = module_sig_check(info, flags);\n\tif (err)\n\t\tgoto free_copy;\n\n\terr = rewrite_section_headers(info, flags);\n\tif (err)\n\t\tgoto free_copy;\n\n\t/* Check module struct version now, before we try to use module. */\n\tif (!check_modstruct_version(info, info->mod)) {\n\t\terr = -ENOEXEC;\n\t\tgoto free_copy;\n\t}\n\n\t/* Figure out module layout, and allocate all the memory. */\n\tmod = layout_and_allocate(info, flags);\n\tif (IS_ERR(mod)) {\n\t\terr = PTR_ERR(mod);\n\t\tgoto free_copy;\n\t}\n\n\taudit_log_kern_module(mod->name);\n\n\t/* Reserve our place in the list. */\n\terr = add_unformed_module(mod);\n\tif (err)\n\t\tgoto free_module;\n\n#ifdef CONFIG_MODULE_SIG\n\tmod->sig_ok = info->sig_ok;\n\tif (!mod->sig_ok) {\n\t\tpr_notice_once(\"%s: module verification failed: signature \"\n\t\t\t       \"and/or required key missing - tainting \"\n\t\t\t       \"kernel\\n\", mod->name);\n\t\tadd_taint_module(mod, TAINT_UNSIGNED_MODULE, LOCKDEP_STILL_OK);\n\t}\n#endif\n\n\t/* To avoid stressing percpu allocator, do this once we're unique. */\n\terr = percpu_modalloc(mod, info);\n\tif (err)\n\t\tgoto unlink_mod;\n\n\t/* Now module is in final location, initialize linked lists, etc. */\n\terr = module_unload_init(mod);\n\tif (err)\n\t\tgoto unlink_mod;\n\n\tinit_param_lock(mod);\n\n\t/* Now we've got everything in the final locations, we can\n\t * find optional sections. */\n\terr = find_module_sections(mod, info);\n\tif (err)\n\t\tgoto free_unload;\n\n\terr = check_module_license_and_versions(mod);\n\tif (err)\n\t\tgoto free_unload;\n\n\t/* Set up MODINFO_ATTR fields */\n\tsetup_modinfo(mod, info);\n\n\t/* Fix up syms, so that st_value is a pointer to location. */\n\terr = simplify_symbols(mod, info);\n\tif (err < 0)\n\t\tgoto free_modinfo;\n\n\terr = apply_relocations(mod, info);\n\tif (err < 0)\n\t\tgoto free_modinfo;\n\n\terr = post_relocation(mod, info);\n\tif (err < 0)\n\t\tgoto free_modinfo;\n\n\tflush_module_icache(mod);\n\n\t/* Now copy in args */\n\tmod->args = strndup_user(uargs, ~0UL >> 1);\n\tif (IS_ERR(mod->args)) {\n\t\terr = PTR_ERR(mod->args);\n\t\tgoto free_arch_cleanup;\n\t}\n\n\tdynamic_debug_setup(mod, info->debug, info->num_debug);\n\n\t/* Ftrace init must be called in the MODULE_STATE_UNFORMED state */\n\tftrace_module_init(mod);\n\n\t/* Finally it's fully formed, ready to start executing. */\n\terr = complete_formation(mod, info);\n\tif (err)\n\t\tgoto ddebug_cleanup;\n\n\terr = prepare_coming_module(mod);\n\tif (err)\n\t\tgoto bug_cleanup;\n\n\t/* Module is ready to execute: parsing args may do that. */\n\tafter_dashes = parse_args(mod->name, mod->args, mod->kp, mod->num_kp,\n\t\t\t\t  -32768, 32767, mod,\n\t\t\t\t  unknown_module_param_cb);\n\tif (IS_ERR(after_dashes)) {\n\t\terr = PTR_ERR(after_dashes);\n\t\tgoto coming_cleanup;\n\t} else if (after_dashes) {\n\t\tpr_warn(\"%s: parameters '%s' after `--' ignored\\n\",\n\t\t       mod->name, after_dashes);\n\t}\n\n\t/* Link in to sysfs. */\n\terr = mod_sysfs_setup(mod, info, mod->kp, mod->num_kp);\n\tif (err < 0)\n\t\tgoto coming_cleanup;\n\n\tif (is_livepatch_module(mod)) {\n\t\terr = copy_module_elf(mod, info);\n\t\tif (err < 0)\n\t\t\tgoto sysfs_cleanup;\n\t}\n\n\t/* Get rid of temporary copy. */\n\tfree_copy(info);\n\n\t/* Done! */\n\ttrace_module_load(mod);\n\n\treturn do_init_module(mod);\n\n sysfs_cleanup:\n\tmod_sysfs_teardown(mod);\n coming_cleanup:\n\tmod->state = MODULE_STATE_GOING;\n\tdestroy_params(mod->kp, mod->num_kp);\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_GOING, mod);\n\tklp_module_going(mod);\n bug_cleanup:\n\t/* module_bug_cleanup needs module_mutex protection */\n\tmutex_lock(&module_mutex);\n\tmodule_bug_cleanup(mod);\n\tmutex_unlock(&module_mutex);\n\n\t/* we can't deallocate the module until we clear memory protection */\n\tmodule_disable_ro(mod);\n\tmodule_disable_nx(mod);\n\n ddebug_cleanup:\n\tftrace_release_mod(mod);\n\tdynamic_debug_remove(mod, info->debug);\n\tsynchronize_sched();\n\tkfree(mod->args);\n free_arch_cleanup:\n\tmodule_arch_cleanup(mod);\n free_modinfo:\n\tfree_modinfo(mod);\n free_unload:\n\tmodule_unload_free(mod);\n unlink_mod:\n\tmutex_lock(&module_mutex);\n\t/* Unlink carefully: kallsyms could be walking list. */\n\tlist_del_rcu(&mod->list);\n\tmod_tree_remove(mod);\n\twake_up_all(&module_wq);\n\t/* Wait for RCU-sched synchronizing before releasing mod->list. */\n\tsynchronize_sched();\n\tmutex_unlock(&module_mutex);\n free_module:\n\t/* Free lock-classes; relies on the preceding sync_rcu() */\n\tlockdep_free_key_range(mod->core_layout.base, mod->core_layout.size);\n\n\tmodule_deallocate(mod, info);\n free_copy:\n\tfree_copy(info);\n\treturn err;\n}"
  },
  {
    "function_name": "unknown_module_param_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3631-3647",
    "snippet": "static int unknown_module_param_cb(char *param, char *val, const char *modname,\n\t\t\t\t   void *arg)\n{\n\tstruct module *mod = arg;\n\tint ret;\n\n\tif (strcmp(param, \"async_probe\") == 0) {\n\t\tmod->async_probe_requested = true;\n\t\treturn 0;\n\t}\n\n\t/* Check for magic 'dyndbg' arg */\n\tret = ddebug_dyndbg_module_param_cb(param, val, modname);\n\tif (ret != 0)\n\t\tpr_warn(\"%s: unknown parameter '%s' ignored\\n\", modname, param);\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: unknown parameter '%s' ignored\\n\"",
            "modname",
            "param"
          ],
          "line": 3645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddebug_dyndbg_module_param_cb",
          "args": [
            "param",
            "val",
            "modname"
          ],
          "line": 3643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "param",
            "\"async_probe\""
          ],
          "line": 3637
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int unknown_module_param_cb(char *param, char *val, const char *modname,\n\t\t\t\t   void *arg)\n{\n\tstruct module *mod = arg;\n\tint ret;\n\n\tif (strcmp(param, \"async_probe\") == 0) {\n\t\tmod->async_probe_requested = true;\n\t\treturn 0;\n\t}\n\n\t/* Check for magic 'dyndbg' arg */\n\tret = ddebug_dyndbg_module_param_cb(param, val, modname);\n\tif (ret != 0)\n\t\tpr_warn(\"%s: unknown parameter '%s' ignored\\n\", modname, param);\n\treturn 0;\n}"
  },
  {
    "function_name": "prepare_coming_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3617-3629",
    "snippet": "static int prepare_coming_module(struct module *mod)\n{\n\tint err;\n\n\tftrace_module_enable(mod);\n\terr = klp_module_coming(mod);\n\tif (err)\n\t\treturn err;\n\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_COMING, mod);\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static BLOCKING_NOTIFIER_HEAD(module_notify_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "blocking_notifier_call_chain",
          "args": [
            "&module_notify_list",
            "MODULE_STATE_COMING",
            "mod"
          ],
          "line": 3626
        },
        "resolved": true,
        "details": {
          "function_name": "blocking_notifier_call_chain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/notifier.c",
          "lines": "325-329",
          "snippet": "int blocking_notifier_call_chain(struct blocking_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\treturn __blocking_notifier_call_chain(nh, val, v, -1, NULL);\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint blocking_notifier_call_chain(struct blocking_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\treturn __blocking_notifier_call_chain(nh, val, v, -1, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "klp_module_coming",
          "args": [
            "mod"
          ],
          "line": 3622
        },
        "resolved": true,
        "details": {
          "function_name": "klp_module_coming",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/livepatch/core.c",
          "lines": "948-1028",
          "snippet": "int klp_module_coming(struct module *mod)\n{\n\tint ret;\n\tstruct klp_patch *patch;\n\tstruct klp_object *obj;\n\n\tif (WARN_ON(mod->state != MODULE_STATE_COMING))\n\t\treturn -EINVAL;\n\n\tmutex_lock(&klp_mutex);\n\t/*\n\t * Each module has to know that klp_module_coming()\n\t * has been called. We never know what module will\n\t * get patched by a new patch.\n\t */\n\tmod->klp_alive = true;\n\n\tlist_for_each_entry(patch, &klp_patches, list) {\n\t\tklp_for_each_object(patch, obj) {\n\t\t\tif (!klp_is_module(obj) || strcmp(obj->name, mod->name))\n\t\t\t\tcontinue;\n\n\t\t\tobj->mod = mod;\n\n\t\t\tret = klp_init_object_loaded(patch, obj);\n\t\t\tif (ret) {\n\t\t\t\tpr_warn(\"failed to initialize patch '%s' for module '%s' (%d)\\n\",\n\t\t\t\t\tpatch->mod->name, obj->mod->name, ret);\n\t\t\t\tgoto err;\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * Only patch the module if the patch is enabled or is\n\t\t\t * in transition.\n\t\t\t */\n\t\t\tif (!patch->enabled && patch != klp_transition_patch)\n\t\t\t\tbreak;\n\n\t\t\tpr_notice(\"applying patch '%s' to loading module '%s'\\n\",\n\t\t\t\t  patch->mod->name, obj->mod->name);\n\n\t\t\tret = klp_pre_patch_callback(obj);\n\t\t\tif (ret) {\n\t\t\t\tpr_warn(\"pre-patch callback failed for object '%s'\\n\",\n\t\t\t\t\tobj->name);\n\t\t\t\tgoto err;\n\t\t\t}\n\n\t\t\tret = klp_patch_object(obj);\n\t\t\tif (ret) {\n\t\t\t\tpr_warn(\"failed to apply patch '%s' to module '%s' (%d)\\n\",\n\t\t\t\t\tpatch->mod->name, obj->mod->name, ret);\n\n\t\t\t\tklp_post_unpatch_callback(obj);\n\t\t\t\tgoto err;\n\t\t\t}\n\n\t\t\tif (patch != klp_transition_patch)\n\t\t\t\tklp_post_patch_callback(obj);\n\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tmutex_unlock(&klp_mutex);\n\n\treturn 0;\n\nerr:\n\t/*\n\t * If a patch is unsuccessfully applied, return\n\t * error to the module loader.\n\t */\n\tpr_warn(\"patch '%s' failed for module '%s', refusing to load module '%s'\\n\",\n\t\tpatch->mod->name, obj->mod->name, obj->mod->name);\n\tmod->klp_alive = false;\n\tklp_cleanup_module_patches_limited(mod, patch);\n\tmutex_unlock(&klp_mutex);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"transition.h\"",
            "#include \"patch.h\"",
            "#include \"core.h\"",
            "#include <asm/cacheflush.h>",
            "#include <linux/completion.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/elf.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(klp_patches);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"transition.h\"\n#include \"patch.h\"\n#include \"core.h\"\n#include <asm/cacheflush.h>\n#include <linux/completion.h>\n#include <linux/moduleloader.h>\n#include <linux/elf.h>\n#include <linux/livepatch.h>\n#include <linux/kallsyms.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/mutex.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic LIST_HEAD(klp_patches);\n\nint klp_module_coming(struct module *mod)\n{\n\tint ret;\n\tstruct klp_patch *patch;\n\tstruct klp_object *obj;\n\n\tif (WARN_ON(mod->state != MODULE_STATE_COMING))\n\t\treturn -EINVAL;\n\n\tmutex_lock(&klp_mutex);\n\t/*\n\t * Each module has to know that klp_module_coming()\n\t * has been called. We never know what module will\n\t * get patched by a new patch.\n\t */\n\tmod->klp_alive = true;\n\n\tlist_for_each_entry(patch, &klp_patches, list) {\n\t\tklp_for_each_object(patch, obj) {\n\t\t\tif (!klp_is_module(obj) || strcmp(obj->name, mod->name))\n\t\t\t\tcontinue;\n\n\t\t\tobj->mod = mod;\n\n\t\t\tret = klp_init_object_loaded(patch, obj);\n\t\t\tif (ret) {\n\t\t\t\tpr_warn(\"failed to initialize patch '%s' for module '%s' (%d)\\n\",\n\t\t\t\t\tpatch->mod->name, obj->mod->name, ret);\n\t\t\t\tgoto err;\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * Only patch the module if the patch is enabled or is\n\t\t\t * in transition.\n\t\t\t */\n\t\t\tif (!patch->enabled && patch != klp_transition_patch)\n\t\t\t\tbreak;\n\n\t\t\tpr_notice(\"applying patch '%s' to loading module '%s'\\n\",\n\t\t\t\t  patch->mod->name, obj->mod->name);\n\n\t\t\tret = klp_pre_patch_callback(obj);\n\t\t\tif (ret) {\n\t\t\t\tpr_warn(\"pre-patch callback failed for object '%s'\\n\",\n\t\t\t\t\tobj->name);\n\t\t\t\tgoto err;\n\t\t\t}\n\n\t\t\tret = klp_patch_object(obj);\n\t\t\tif (ret) {\n\t\t\t\tpr_warn(\"failed to apply patch '%s' to module '%s' (%d)\\n\",\n\t\t\t\t\tpatch->mod->name, obj->mod->name, ret);\n\n\t\t\t\tklp_post_unpatch_callback(obj);\n\t\t\t\tgoto err;\n\t\t\t}\n\n\t\t\tif (patch != klp_transition_patch)\n\t\t\t\tklp_post_patch_callback(obj);\n\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tmutex_unlock(&klp_mutex);\n\n\treturn 0;\n\nerr:\n\t/*\n\t * If a patch is unsuccessfully applied, return\n\t * error to the module loader.\n\t */\n\tpr_warn(\"patch '%s' failed for module '%s', refusing to load module '%s'\\n\",\n\t\tpatch->mod->name, obj->mod->name, obj->mod->name);\n\tmod->klp_alive = false;\n\tklp_cleanup_module_patches_limited(mod, patch);\n\tmutex_unlock(&klp_mutex);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ftrace_module_enable",
          "args": [
            "mod"
          ],
          "line": 3621
        },
        "resolved": true,
        "details": {
          "function_name": "ftrace_module_enable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/ftrace.c",
          "lines": "5758-5828",
          "snippet": "void ftrace_module_enable(struct module *mod)\n{\n\tstruct dyn_ftrace *rec;\n\tstruct ftrace_page *pg;\n\n\tmutex_lock(&ftrace_lock);\n\n\tif (ftrace_disabled)\n\t\tgoto out_unlock;\n\n\t/*\n\t * If the tracing is enabled, go ahead and enable the record.\n\t *\n\t * The reason not to enable the record immediatelly is the\n\t * inherent check of ftrace_make_nop/ftrace_make_call for\n\t * correct previous instructions.  Making first the NOP\n\t * conversion puts the module to the correct state, thus\n\t * passing the ftrace_make_call check.\n\t *\n\t * We also delay this to after the module code already set the\n\t * text to read-only, as we now need to set it back to read-write\n\t * so that we can modify the text.\n\t */\n\tif (ftrace_start_up)\n\t\tftrace_arch_code_modify_prepare();\n\n\tdo_for_each_ftrace_rec(pg, rec) {\n\t\tint cnt;\n\t\t/*\n\t\t * do_for_each_ftrace_rec() is a double loop.\n\t\t * module text shares the pg. If a record is\n\t\t * not part of this module, then skip this pg,\n\t\t * which the \"break\" will do.\n\t\t */\n\t\tif (!within_module_core(rec->ip, mod) &&\n\t\t    !within_module_init(rec->ip, mod))\n\t\t\tbreak;\n\n\t\tcnt = 0;\n\n\t\t/*\n\t\t * When adding a module, we need to check if tracers are\n\t\t * currently enabled and if they are, and can trace this record,\n\t\t * we need to enable the module functions as well as update the\n\t\t * reference counts for those function records.\n\t\t */\n\t\tif (ftrace_start_up)\n\t\t\tcnt += referenced_filters(rec);\n\n\t\t/* This clears FTRACE_FL_DISABLED */\n\t\trec->flags = cnt;\n\n\t\tif (ftrace_start_up && cnt) {\n\t\t\tint failed = __ftrace_replace_code(rec, 1);\n\t\t\tif (failed) {\n\t\t\t\tftrace_bug(failed, rec);\n\t\t\t\tgoto out_loop;\n\t\t\t}\n\t\t}\n\n\t} while_for_each_ftrace_rec();\n\n out_loop:\n\tif (ftrace_start_up)\n\t\tftrace_arch_code_modify_post_process();\n\n out_unlock:\n\tmutex_unlock(&ftrace_lock);\n\n\tprocess_cached_mods(mod->name);\n}",
          "includes": [
            "#include \"trace_stat.h\"",
            "#include \"trace_output.h\"",
            "#include <asm/setup.h>",
            "#include <asm/sections.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/hash.h>",
            "#include <linux/list.h>",
            "#include <linux/sort.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/tracefs.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/stop_machine.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int ftrace_disabled",
            "static DEFINE_MUTEX(ftrace_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_stat.h\"\n#include \"trace_output.h\"\n#include <asm/setup.h>\n#include <asm/sections.h>\n#include <trace/events/sched.h>\n#include <linux/rcupdate.h>\n#include <linux/hash.h>\n#include <linux/list.h>\n#include <linux/sort.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/sysctl.h>\n#include <linux/ftrace.h>\n#include <linux/module.h>\n#include <linux/bsearch.h>\n#include <linux/uaccess.h>\n#include <linux/kthread.h>\n#include <linux/hardirq.h>\n#include <linux/tracefs.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/kallsyms.h>\n#include <linux/sched/task.h>\n#include <linux/clocksource.h>\n#include <linux/stop_machine.h>\n\nstatic int ftrace_disabled;\nstatic DEFINE_MUTEX(ftrace_lock);\n\nvoid ftrace_module_enable(struct module *mod)\n{\n\tstruct dyn_ftrace *rec;\n\tstruct ftrace_page *pg;\n\n\tmutex_lock(&ftrace_lock);\n\n\tif (ftrace_disabled)\n\t\tgoto out_unlock;\n\n\t/*\n\t * If the tracing is enabled, go ahead and enable the record.\n\t *\n\t * The reason not to enable the record immediatelly is the\n\t * inherent check of ftrace_make_nop/ftrace_make_call for\n\t * correct previous instructions.  Making first the NOP\n\t * conversion puts the module to the correct state, thus\n\t * passing the ftrace_make_call check.\n\t *\n\t * We also delay this to after the module code already set the\n\t * text to read-only, as we now need to set it back to read-write\n\t * so that we can modify the text.\n\t */\n\tif (ftrace_start_up)\n\t\tftrace_arch_code_modify_prepare();\n\n\tdo_for_each_ftrace_rec(pg, rec) {\n\t\tint cnt;\n\t\t/*\n\t\t * do_for_each_ftrace_rec() is a double loop.\n\t\t * module text shares the pg. If a record is\n\t\t * not part of this module, then skip this pg,\n\t\t * which the \"break\" will do.\n\t\t */\n\t\tif (!within_module_core(rec->ip, mod) &&\n\t\t    !within_module_init(rec->ip, mod))\n\t\t\tbreak;\n\n\t\tcnt = 0;\n\n\t\t/*\n\t\t * When adding a module, we need to check if tracers are\n\t\t * currently enabled and if they are, and can trace this record,\n\t\t * we need to enable the module functions as well as update the\n\t\t * reference counts for those function records.\n\t\t */\n\t\tif (ftrace_start_up)\n\t\t\tcnt += referenced_filters(rec);\n\n\t\t/* This clears FTRACE_FL_DISABLED */\n\t\trec->flags = cnt;\n\n\t\tif (ftrace_start_up && cnt) {\n\t\t\tint failed = __ftrace_replace_code(rec, 1);\n\t\t\tif (failed) {\n\t\t\t\tftrace_bug(failed, rec);\n\t\t\t\tgoto out_loop;\n\t\t\t}\n\t\t}\n\n\t} while_for_each_ftrace_rec();\n\n out_loop:\n\tif (ftrace_start_up)\n\t\tftrace_arch_code_modify_post_process();\n\n out_unlock:\n\tmutex_unlock(&ftrace_lock);\n\n\tprocess_cached_mods(mod->name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic BLOCKING_NOTIFIER_HEAD(module_notify_list);\n\nstatic int prepare_coming_module(struct module *mod)\n{\n\tint err;\n\n\tftrace_module_enable(mod);\n\terr = klp_module_coming(mod);\n\tif (err)\n\t\treturn err;\n\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_COMING, mod);\n\treturn 0;\n}"
  },
  {
    "function_name": "complete_formation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3588-3615",
    "snippet": "static int complete_formation(struct module *mod, struct load_info *info)\n{\n\tint err;\n\n\tmutex_lock(&module_mutex);\n\n\t/* Find duplicate symbols (must be called under lock). */\n\terr = verify_export_symbols(mod);\n\tif (err < 0)\n\t\tgoto out;\n\n\t/* This relies on module_mutex for list integrity. */\n\tmodule_bug_finalize(info->hdr, info->sechdrs, mod);\n\n\tmodule_enable_ro(mod, false);\n\tmodule_enable_nx(mod);\n\n\t/* Mark state as coming so strong_try_module_get() ignores us,\n\t * but kallsyms etc. can see us. */\n\tmod->state = MODULE_STATE_COMING;\n\tmutex_unlock(&module_mutex);\n\n\treturn 0;\n\nout:\n\tmutex_unlock(&module_mutex);\n\treturn err;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 3613
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_enable_nx",
          "args": [
            "mod"
          ],
          "line": 3603
        },
        "resolved": true,
        "details": {
          "function_name": "module_enable_nx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2034-2034",
          "snippet": "static void module_enable_nx(const struct module *mod) { }",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_enable_nx(const struct module *mod) { }"
        }
      },
      {
        "call_info": {
          "callee": "module_enable_ro",
          "args": [
            "mod",
            "false"
          ],
          "line": 3602
        },
        "resolved": true,
        "details": {
          "function_name": "module_enable_ro",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1944-1956",
          "snippet": "void module_enable_ro(const struct module *mod, bool after_init)\n{\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tfrob_text(&mod->core_layout, set_memory_ro);\n\tfrob_rodata(&mod->core_layout, set_memory_ro);\n\tfrob_text(&mod->init_layout, set_memory_ro);\n\tfrob_rodata(&mod->init_layout, set_memory_ro);\n\n\tif (after_init)\n\t\tfrob_ro_after_init(&mod->core_layout, set_memory_ro);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_enable_ro(const struct module *mod, bool after_init)\n{\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tfrob_text(&mod->core_layout, set_memory_ro);\n\tfrob_rodata(&mod->core_layout, set_memory_ro);\n\tfrob_text(&mod->init_layout, set_memory_ro);\n\tfrob_rodata(&mod->init_layout, set_memory_ro);\n\n\tif (after_init)\n\t\tfrob_ro_after_init(&mod->core_layout, set_memory_ro);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_bug_finalize",
          "args": [
            "info->hdr",
            "info->sechdrs",
            "mod"
          ],
          "line": 3600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "verify_export_symbols",
          "args": [
            "mod"
          ],
          "line": 3595
        },
        "resolved": true,
        "details": {
          "function_name": "verify_export_symbols",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2201-2232",
          "snippet": "static int verify_export_symbols(struct module *mod)\n{\n\tunsigned int i;\n\tstruct module *owner;\n\tconst struct kernel_symbol *s;\n\tstruct {\n\t\tconst struct kernel_symbol *sym;\n\t\tunsigned int num;\n\t} arr[] = {\n\t\t{ mod->syms, mod->num_syms },\n\t\t{ mod->gpl_syms, mod->num_gpl_syms },\n\t\t{ mod->gpl_future_syms, mod->num_gpl_future_syms },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t{ mod->unused_syms, mod->num_unused_syms },\n\t\t{ mod->unused_gpl_syms, mod->num_unused_gpl_syms },\n#endif\n\t};\n\n\tfor (i = 0; i < ARRAY_SIZE(arr); i++) {\n\t\tfor (s = arr[i].sym; s < arr[i].sym + arr[i].num; s++) {\n\t\t\tif (find_symbol(kernel_symbol_name(s), &owner, NULL,\n\t\t\t\t\ttrue, false)) {\n\t\t\t\tpr_err(\"%s: exports duplicate symbol %s\"\n\t\t\t\t       \" (owned by %s)\\n\",\n\t\t\t\t       mod->name, kernel_symbol_name(s),\n\t\t\t\t       module_name(owner));\n\t\t\t\treturn -ENOEXEC;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int verify_export_symbols(struct module *mod)\n{\n\tunsigned int i;\n\tstruct module *owner;\n\tconst struct kernel_symbol *s;\n\tstruct {\n\t\tconst struct kernel_symbol *sym;\n\t\tunsigned int num;\n\t} arr[] = {\n\t\t{ mod->syms, mod->num_syms },\n\t\t{ mod->gpl_syms, mod->num_gpl_syms },\n\t\t{ mod->gpl_future_syms, mod->num_gpl_future_syms },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t{ mod->unused_syms, mod->num_unused_syms },\n\t\t{ mod->unused_gpl_syms, mod->num_unused_gpl_syms },\n#endif\n\t};\n\n\tfor (i = 0; i < ARRAY_SIZE(arr); i++) {\n\t\tfor (s = arr[i].sym; s < arr[i].sym + arr[i].num; s++) {\n\t\t\tif (find_symbol(kernel_symbol_name(s), &owner, NULL,\n\t\t\t\t\ttrue, false)) {\n\t\t\t\tpr_err(\"%s: exports duplicate symbol %s\"\n\t\t\t\t       \" (owned by %s)\\n\",\n\t\t\t\t       mod->name, kernel_symbol_name(s),\n\t\t\t\t       module_name(owner));\n\t\t\t\treturn -ENOEXEC;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 3592
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int complete_formation(struct module *mod, struct load_info *info)\n{\n\tint err;\n\n\tmutex_lock(&module_mutex);\n\n\t/* Find duplicate symbols (must be called under lock). */\n\terr = verify_export_symbols(mod);\n\tif (err < 0)\n\t\tgoto out;\n\n\t/* This relies on module_mutex for list integrity. */\n\tmodule_bug_finalize(info->hdr, info->sechdrs, mod);\n\n\tmodule_enable_ro(mod, false);\n\tmodule_enable_nx(mod);\n\n\t/* Mark state as coming so strong_try_module_get() ignores us,\n\t * but kallsyms etc. can see us. */\n\tmod->state = MODULE_STATE_COMING;\n\tmutex_unlock(&module_mutex);\n\n\treturn 0;\n\nout:\n\tmutex_unlock(&module_mutex);\n\treturn err;\n}"
  },
  {
    "function_name": "add_unformed_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3553-3586",
    "snippet": "static int add_unformed_module(struct module *mod)\n{\n\tint err;\n\tstruct module *old;\n\n\tmod->state = MODULE_STATE_UNFORMED;\n\nagain:\n\tmutex_lock(&module_mutex);\n\told = find_module_all(mod->name, strlen(mod->name), true);\n\tif (old != NULL) {\n\t\tif (old->state == MODULE_STATE_COMING\n\t\t    || old->state == MODULE_STATE_UNFORMED) {\n\t\t\t/* Wait in case it fails to load. */\n\t\t\tmutex_unlock(&module_mutex);\n\t\t\terr = wait_event_interruptible(module_wq,\n\t\t\t\t\t       finished_loading(mod->name));\n\t\t\tif (err)\n\t\t\t\tgoto out_unlocked;\n\t\t\tgoto again;\n\t\t}\n\t\terr = -EEXIST;\n\t\tgoto out;\n\t}\n\tmod_update_bounds(mod);\n\tlist_add_rcu(&mod->list, &modules);\n\tmod_tree_insert(mod);\n\terr = 0;\n\nout:\n\tmutex_unlock(&module_mutex);\nout_unlocked:\n\treturn err;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);",
      "static DECLARE_WAIT_QUEUE_HEAD(module_wq);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 3583
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mod_tree_insert",
          "args": [
            "mod"
          ],
          "line": 3579
        },
        "resolved": true,
        "details": {
          "function_name": "mod_tree_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "216-216",
          "snippet": "static void mod_tree_insert(struct module *mod) { }",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_tree_insert(struct module *mod) { }"
        }
      },
      {
        "call_info": {
          "callee": "list_add_rcu",
          "args": [
            "&mod->list",
            "&modules"
          ],
          "line": 3578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mod_update_bounds",
          "args": [
            "mod"
          ],
          "line": 3577
        },
        "resolved": true,
        "details": {
          "function_name": "mod_update_bounds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "249-254",
          "snippet": "static void mod_update_bounds(struct module *mod)\n{\n\t__mod_update_bounds(mod->core_layout.base, mod->core_layout.size);\n\tif (mod->init_layout.size)\n\t\t__mod_update_bounds(mod->init_layout.base, mod->init_layout.size);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_update_bounds(struct module *mod)\n{\n\t__mod_update_bounds(mod->core_layout.base, mod->core_layout.size);\n\tif (mod->init_layout.size)\n\t\t__mod_update_bounds(mod->init_layout.base, mod->init_layout.size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_event_interruptible",
          "args": [
            "module_wq",
            "finished_loading(mod->name)"
          ],
          "line": 3568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "finished_loading",
          "args": [
            "mod->name"
          ],
          "line": 3569
        },
        "resolved": true,
        "details": {
          "function_name": "finished_loading",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3380-3398",
          "snippet": "static bool finished_loading(const char *name)\n{\n\tstruct module *mod;\n\tbool ret;\n\n\t/*\n\t * The module_mutex should not be a heavily contended lock;\n\t * if we get the occasional sleep here, we'll go an extra iteration\n\t * in the wait_event_interruptible(), which is harmless.\n\t */\n\tsched_annotate_sleep();\n\tmutex_lock(&module_mutex);\n\tmod = find_module_all(name, strlen(name), true);\n\tret = !mod || mod->state == MODULE_STATE_LIVE\n\t\t|| mod->state == MODULE_STATE_GOING;\n\tmutex_unlock(&module_mutex);\n\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic bool finished_loading(const char *name)\n{\n\tstruct module *mod;\n\tbool ret;\n\n\t/*\n\t * The module_mutex should not be a heavily contended lock;\n\t * if we get the occasional sleep here, we'll go an extra iteration\n\t * in the wait_event_interruptible(), which is harmless.\n\t */\n\tsched_annotate_sleep();\n\tmutex_lock(&module_mutex);\n\tmod = find_module_all(name, strlen(name), true);\n\tret = !mod || mod->state == MODULE_STATE_LIVE\n\t\t|| mod->state == MODULE_STATE_GOING;\n\tmutex_unlock(&module_mutex);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_module_all",
          "args": [
            "mod->name",
            "strlen(mod->name)",
            "true"
          ],
          "line": 3562
        },
        "resolved": true,
        "details": {
          "function_name": "find_module_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "605-619",
          "snippet": "static struct module *find_module_all(const char *name, size_t len,\n\t\t\t\t      bool even_unformed)\n{\n\tstruct module *mod;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (!even_unformed && mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (strlen(mod->name) == len && !memcmp(mod->name, name, len))\n\t\t\treturn mod;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(modules);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic struct module *find_module_all(const char *name, size_t len,\n\t\t\t\t      bool even_unformed)\n{\n\tstruct module *mod;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (!even_unformed && mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (strlen(mod->name) == len && !memcmp(mod->name, name, len))\n\t\t\treturn mod;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "mod->name"
          ],
          "line": 3562
        },
        "resolved": true,
        "details": {
          "function_name": "fetch_store_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_uprobe.c",
          "lines": "137-146",
          "snippet": "static nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/string.h>",
            "#include <linux/namei.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include <linux/rculist.h>\n#include <linux/string.h>\n#include <linux/namei.h>\n#include <linux/uprobes.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n\nstatic nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 3561
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\nstatic DECLARE_WAIT_QUEUE_HEAD(module_wq);\n\nstatic int add_unformed_module(struct module *mod)\n{\n\tint err;\n\tstruct module *old;\n\n\tmod->state = MODULE_STATE_UNFORMED;\n\nagain:\n\tmutex_lock(&module_mutex);\n\told = find_module_all(mod->name, strlen(mod->name), true);\n\tif (old != NULL) {\n\t\tif (old->state == MODULE_STATE_COMING\n\t\t    || old->state == MODULE_STATE_UNFORMED) {\n\t\t\t/* Wait in case it fails to load. */\n\t\t\tmutex_unlock(&module_mutex);\n\t\t\terr = wait_event_interruptible(module_wq,\n\t\t\t\t\t       finished_loading(mod->name));\n\t\t\tif (err)\n\t\t\t\tgoto out_unlocked;\n\t\t\tgoto again;\n\t\t}\n\t\terr = -EEXIST;\n\t\tgoto out;\n\t}\n\tmod_update_bounds(mod);\n\tlist_add_rcu(&mod->list, &modules);\n\tmod_tree_insert(mod);\n\terr = 0;\n\nout:\n\tmutex_unlock(&module_mutex);\nout_unlocked:\n\treturn err;\n}"
  },
  {
    "function_name": "may_init_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3540-3546",
    "snippet": "static int may_init_module(void)\n{\n\tif (!capable(CAP_SYS_MODULE) || modules_disabled)\n\t\treturn -EPERM;\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int modules_disabled = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_MODULE"
          ],
          "line": 3542
        },
        "resolved": true,
        "details": {
          "function_name": "capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/capability.c",
          "lines": "429-432",
          "snippet": "bool capable(int cap)\n{\n\treturn ns_capable(&init_user_ns, cap);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool capable(int cap)\n{\n\treturn ns_capable(&init_user_ns, cap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nint modules_disabled = 0;\n\nstatic int may_init_module(void)\n{\n\tif (!capable(CAP_SYS_MODULE) || modules_disabled)\n\t\treturn -EPERM;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "do_init_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3430-3538",
    "snippet": "static noinline int do_init_module(struct module *mod)\n{\n\tint ret = 0;\n\tstruct mod_initfree *freeinit;\n\n\tfreeinit = kmalloc(sizeof(*freeinit), GFP_KERNEL);\n\tif (!freeinit) {\n\t\tret = -ENOMEM;\n\t\tgoto fail;\n\t}\n\tfreeinit->module_init = mod->init_layout.base;\n\n\t/*\n\t * We want to find out whether @mod uses async during init.  Clear\n\t * PF_USED_ASYNC.  async_schedule*() will set it.\n\t */\n\tcurrent->flags &= ~PF_USED_ASYNC;\n\n\tdo_mod_ctors(mod);\n\t/* Start the module */\n\tif (mod->init != NULL)\n\t\tret = do_one_initcall(mod->init);\n\tif (ret < 0) {\n\t\tgoto fail_free_freeinit;\n\t}\n\tif (ret > 0) {\n\t\tpr_warn(\"%s: '%s'->init suspiciously returned %d, it should \"\n\t\t\t\"follow 0/-E convention\\n\"\n\t\t\t\"%s: loading module anyway...\\n\",\n\t\t\t__func__, mod->name, ret, __func__);\n\t\tdump_stack();\n\t}\n\n\t/* Now it's a first class citizen! */\n\tmod->state = MODULE_STATE_LIVE;\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_LIVE, mod);\n\n\t/*\n\t * We need to finish all async code before the module init sequence\n\t * is done.  This has potential to deadlock.  For example, a newly\n\t * detected block device can trigger request_module() of the\n\t * default iosched from async probing task.  Once userland helper\n\t * reaches here, async_synchronize_full() will wait on the async\n\t * task waiting on request_module() and deadlock.\n\t *\n\t * This deadlock is avoided by perfomring async_synchronize_full()\n\t * iff module init queued any async jobs.  This isn't a full\n\t * solution as it will deadlock the same if module loading from\n\t * async jobs nests more than once; however, due to the various\n\t * constraints, this hack seems to be the best option for now.\n\t * Please refer to the following thread for details.\n\t *\n\t * http://thread.gmane.org/gmane.linux.kernel/1420814\n\t */\n\tif (!mod->async_probe_requested && (current->flags & PF_USED_ASYNC))\n\t\tasync_synchronize_full();\n\n\tftrace_free_mem(mod, mod->init_layout.base, mod->init_layout.base +\n\t\t\tmod->init_layout.size);\n\tmutex_lock(&module_mutex);\n\t/* Drop initial reference. */\n\tmodule_put(mod);\n\ttrim_init_extable(mod);\n#ifdef CONFIG_KALLSYMS\n\t/* Switch to core kallsyms now init is done: kallsyms may be walking! */\n\trcu_assign_pointer(mod->kallsyms, &mod->core_kallsyms);\n#endif\n\tmodule_enable_ro(mod, true);\n\tmod_tree_remove_init(mod);\n\tdisable_ro_nx(&mod->init_layout);\n\tmodule_arch_freeing_init(mod);\n\tmod->init_layout.base = NULL;\n\tmod->init_layout.size = 0;\n\tmod->init_layout.ro_size = 0;\n\tmod->init_layout.ro_after_init_size = 0;\n\tmod->init_layout.text_size = 0;\n\t/*\n\t * We want to free module_init, but be aware that kallsyms may be\n\t * walking this with preempt disabled.  In all the failure paths, we\n\t * call synchronize_sched(), but we don't want to slow down the success\n\t * path, so use actual RCU here.\n\t * Note that module_alloc() on most architectures creates W+X page\n\t * mappings which won't be cleaned up until do_free_init() runs.  Any\n\t * code such as mark_rodata_ro() which depends on those mappings to\n\t * be cleaned up needs to sync with the queued work - ie\n\t * rcu_barrier_sched()\n\t */\n\tcall_rcu_sched(&freeinit->rcu, do_free_init);\n\tmutex_unlock(&module_mutex);\n\twake_up_all(&module_wq);\n\n\treturn 0;\n\nfail_free_freeinit:\n\tkfree(freeinit);\nfail:\n\t/* Try to protect us from buggy refcounters. */\n\tmod->state = MODULE_STATE_GOING;\n\tsynchronize_sched();\n\tmodule_put(mod);\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_GOING, mod);\n\tklp_module_going(mod);\n\tftrace_release_mod(mod);\n\tfree_module(mod);\n\twake_up_all(&module_wq);\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_WAIT_QUEUE_HEAD(module_wq);",
      "static BLOCKING_NOTIFIER_HEAD(module_notify_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_all",
          "args": [
            "&module_wq"
          ],
          "line": 3536
        },
        "resolved": true,
        "details": {
          "function_name": "swake_up_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/swait.c",
          "lines": "49-69",
          "snippet": "void swake_up_all(struct swait_queue_head *q)\n{\n\tstruct swait_queue *curr;\n\tLIST_HEAD(tmp);\n\n\traw_spin_lock_irq(&q->lock);\n\tlist_splice_init(&q->task_list, &tmp);\n\twhile (!list_empty(&tmp)) {\n\t\tcurr = list_first_entry(&tmp, typeof(*curr), task_list);\n\n\t\twake_up_state(curr->task, TASK_NORMAL);\n\t\tlist_del_init(&curr->task_list);\n\n\t\tif (list_empty(&tmp))\n\t\t\tbreak;\n\n\t\traw_spin_unlock_irq(&q->lock);\n\t\traw_spin_lock_irq(&q->lock);\n\t}\n\traw_spin_unlock_irq(&q->lock);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nvoid swake_up_all(struct swait_queue_head *q)\n{\n\tstruct swait_queue *curr;\n\tLIST_HEAD(tmp);\n\n\traw_spin_lock_irq(&q->lock);\n\tlist_splice_init(&q->task_list, &tmp);\n\twhile (!list_empty(&tmp)) {\n\t\tcurr = list_first_entry(&tmp, typeof(*curr), task_list);\n\n\t\twake_up_state(curr->task, TASK_NORMAL);\n\t\tlist_del_init(&curr->task_list);\n\n\t\tif (list_empty(&tmp))\n\t\t\tbreak;\n\n\t\traw_spin_unlock_irq(&q->lock);\n\t\traw_spin_lock_irq(&q->lock);\n\t}\n\traw_spin_unlock_irq(&q->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_module",
          "args": [
            "mod"
          ],
          "line": 3535
        },
        "resolved": true,
        "details": {
          "function_name": "free_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2127-2178",
          "snippet": "static void free_module(struct module *mod)\n{\n\ttrace_module_free(mod);\n\n\tmod_sysfs_teardown(mod);\n\n\t/* We leave it in list to prevent duplicate loads, but make sure\n\t * that noone uses it while it's being deconstructed. */\n\tmutex_lock(&module_mutex);\n\tmod->state = MODULE_STATE_UNFORMED;\n\tmutex_unlock(&module_mutex);\n\n\t/* Remove dynamic debug info */\n\tddebug_remove_module(mod->name);\n\n\t/* Arch-specific cleanup. */\n\tmodule_arch_cleanup(mod);\n\n\t/* Module unload stuff */\n\tmodule_unload_free(mod);\n\n\t/* Free any allocated parameters. */\n\tdestroy_params(mod->kp, mod->num_kp);\n\n\tif (is_livepatch_module(mod))\n\t\tfree_module_elf(mod);\n\n\t/* Now we can delete it from the lists */\n\tmutex_lock(&module_mutex);\n\t/* Unlink carefully: kallsyms could be walking list. */\n\tlist_del_rcu(&mod->list);\n\tmod_tree_remove(mod);\n\t/* Remove this module from bug list, this uses list_del_rcu */\n\tmodule_bug_cleanup(mod);\n\t/* Wait for RCU-sched synchronizing before releasing mod->list and buglist. */\n\tsynchronize_sched();\n\tmutex_unlock(&module_mutex);\n\n\t/* This may be empty, but that's OK */\n\tdisable_ro_nx(&mod->init_layout);\n\tmodule_arch_freeing_init(mod);\n\tmodule_memfree(mod->init_layout.base);\n\tkfree(mod->args);\n\tpercpu_modfree(mod);\n\n\t/* Free lock-classes; relies on the preceding sync_rcu(). */\n\tlockdep_free_key_range(mod->core_layout.base, mod->core_layout.size);\n\n\t/* Finally, free the core (containing the module structure) */\n\tdisable_ro_nx(&mod->core_layout);\n\tmodule_memfree(mod->core_layout.base);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_module(struct module *mod)\n{\n\ttrace_module_free(mod);\n\n\tmod_sysfs_teardown(mod);\n\n\t/* We leave it in list to prevent duplicate loads, but make sure\n\t * that noone uses it while it's being deconstructed. */\n\tmutex_lock(&module_mutex);\n\tmod->state = MODULE_STATE_UNFORMED;\n\tmutex_unlock(&module_mutex);\n\n\t/* Remove dynamic debug info */\n\tddebug_remove_module(mod->name);\n\n\t/* Arch-specific cleanup. */\n\tmodule_arch_cleanup(mod);\n\n\t/* Module unload stuff */\n\tmodule_unload_free(mod);\n\n\t/* Free any allocated parameters. */\n\tdestroy_params(mod->kp, mod->num_kp);\n\n\tif (is_livepatch_module(mod))\n\t\tfree_module_elf(mod);\n\n\t/* Now we can delete it from the lists */\n\tmutex_lock(&module_mutex);\n\t/* Unlink carefully: kallsyms could be walking list. */\n\tlist_del_rcu(&mod->list);\n\tmod_tree_remove(mod);\n\t/* Remove this module from bug list, this uses list_del_rcu */\n\tmodule_bug_cleanup(mod);\n\t/* Wait for RCU-sched synchronizing before releasing mod->list and buglist. */\n\tsynchronize_sched();\n\tmutex_unlock(&module_mutex);\n\n\t/* This may be empty, but that's OK */\n\tdisable_ro_nx(&mod->init_layout);\n\tmodule_arch_freeing_init(mod);\n\tmodule_memfree(mod->init_layout.base);\n\tkfree(mod->args);\n\tpercpu_modfree(mod);\n\n\t/* Free lock-classes; relies on the preceding sync_rcu(). */\n\tlockdep_free_key_range(mod->core_layout.base, mod->core_layout.size);\n\n\t/* Finally, free the core (containing the module structure) */\n\tdisable_ro_nx(&mod->core_layout);\n\tmodule_memfree(mod->core_layout.base);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ftrace_release_mod",
          "args": [
            "mod"
          ],
          "line": 3534
        },
        "resolved": true,
        "details": {
          "function_name": "ftrace_release_mod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/ftrace.c",
          "lines": "5692-5756",
          "snippet": "void ftrace_release_mod(struct module *mod)\n{\n\tstruct ftrace_mod_map *mod_map;\n\tstruct ftrace_mod_map *n;\n\tstruct dyn_ftrace *rec;\n\tstruct ftrace_page **last_pg;\n\tstruct ftrace_page *tmp_page = NULL;\n\tstruct ftrace_page *pg;\n\tint order;\n\n\tmutex_lock(&ftrace_lock);\n\n\tif (ftrace_disabled)\n\t\tgoto out_unlock;\n\n\tlist_for_each_entry_safe(mod_map, n, &ftrace_mod_maps, list) {\n\t\tif (mod_map->mod == mod) {\n\t\t\tlist_del_rcu(&mod_map->list);\n\t\t\tcall_rcu_sched(&mod_map->rcu, ftrace_free_mod_map);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/*\n\t * Each module has its own ftrace_pages, remove\n\t * them from the list.\n\t */\n\tlast_pg = &ftrace_pages_start;\n\tfor (pg = ftrace_pages_start; pg; pg = *last_pg) {\n\t\trec = &pg->records[0];\n\t\tif (within_module_core(rec->ip, mod) ||\n\t\t    within_module_init(rec->ip, mod)) {\n\t\t\t/*\n\t\t\t * As core pages are first, the first\n\t\t\t * page should never be a module page.\n\t\t\t */\n\t\t\tif (WARN_ON(pg == ftrace_pages_start))\n\t\t\t\tgoto out_unlock;\n\n\t\t\t/* Check if we are deleting the last page */\n\t\t\tif (pg == ftrace_pages)\n\t\t\t\tftrace_pages = next_to_ftrace_page(last_pg);\n\n\t\t\tftrace_update_tot_cnt -= pg->index;\n\t\t\t*last_pg = pg->next;\n\n\t\t\tpg->next = tmp_page;\n\t\t\ttmp_page = pg;\n\t\t} else\n\t\t\tlast_pg = &pg->next;\n\t}\n out_unlock:\n\tmutex_unlock(&ftrace_lock);\n\n\tfor (pg = tmp_page; pg; pg = tmp_page) {\n\n\t\t/* Needs to be called outside of ftrace_lock */\n\t\tclear_mod_from_hashes(pg);\n\n\t\torder = get_count_order(pg->size / ENTRIES_PER_PAGE);\n\t\tfree_pages((unsigned long)pg->records, order);\n\t\ttmp_page = pg->next;\n\t\tkfree(pg);\n\t}\n}",
          "includes": [
            "#include \"trace_stat.h\"",
            "#include \"trace_output.h\"",
            "#include <asm/setup.h>",
            "#include <asm/sections.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/hash.h>",
            "#include <linux/list.h>",
            "#include <linux/sort.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/tracefs.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/stop_machine.h>"
          ],
          "macros_used": [
            "#define ENTRIES_PER_PAGE (PAGE_SIZE / ENTRY_SIZE)"
          ],
          "globals_used": [
            "static int ftrace_disabled",
            "static DEFINE_MUTEX(ftrace_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_stat.h\"\n#include \"trace_output.h\"\n#include <asm/setup.h>\n#include <asm/sections.h>\n#include <trace/events/sched.h>\n#include <linux/rcupdate.h>\n#include <linux/hash.h>\n#include <linux/list.h>\n#include <linux/sort.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/sysctl.h>\n#include <linux/ftrace.h>\n#include <linux/module.h>\n#include <linux/bsearch.h>\n#include <linux/uaccess.h>\n#include <linux/kthread.h>\n#include <linux/hardirq.h>\n#include <linux/tracefs.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/kallsyms.h>\n#include <linux/sched/task.h>\n#include <linux/clocksource.h>\n#include <linux/stop_machine.h>\n\n#define ENTRIES_PER_PAGE (PAGE_SIZE / ENTRY_SIZE)\n\nstatic int ftrace_disabled;\nstatic DEFINE_MUTEX(ftrace_lock);\n\nvoid ftrace_release_mod(struct module *mod)\n{\n\tstruct ftrace_mod_map *mod_map;\n\tstruct ftrace_mod_map *n;\n\tstruct dyn_ftrace *rec;\n\tstruct ftrace_page **last_pg;\n\tstruct ftrace_page *tmp_page = NULL;\n\tstruct ftrace_page *pg;\n\tint order;\n\n\tmutex_lock(&ftrace_lock);\n\n\tif (ftrace_disabled)\n\t\tgoto out_unlock;\n\n\tlist_for_each_entry_safe(mod_map, n, &ftrace_mod_maps, list) {\n\t\tif (mod_map->mod == mod) {\n\t\t\tlist_del_rcu(&mod_map->list);\n\t\t\tcall_rcu_sched(&mod_map->rcu, ftrace_free_mod_map);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t/*\n\t * Each module has its own ftrace_pages, remove\n\t * them from the list.\n\t */\n\tlast_pg = &ftrace_pages_start;\n\tfor (pg = ftrace_pages_start; pg; pg = *last_pg) {\n\t\trec = &pg->records[0];\n\t\tif (within_module_core(rec->ip, mod) ||\n\t\t    within_module_init(rec->ip, mod)) {\n\t\t\t/*\n\t\t\t * As core pages are first, the first\n\t\t\t * page should never be a module page.\n\t\t\t */\n\t\t\tif (WARN_ON(pg == ftrace_pages_start))\n\t\t\t\tgoto out_unlock;\n\n\t\t\t/* Check if we are deleting the last page */\n\t\t\tif (pg == ftrace_pages)\n\t\t\t\tftrace_pages = next_to_ftrace_page(last_pg);\n\n\t\t\tftrace_update_tot_cnt -= pg->index;\n\t\t\t*last_pg = pg->next;\n\n\t\t\tpg->next = tmp_page;\n\t\t\ttmp_page = pg;\n\t\t} else\n\t\t\tlast_pg = &pg->next;\n\t}\n out_unlock:\n\tmutex_unlock(&ftrace_lock);\n\n\tfor (pg = tmp_page; pg; pg = tmp_page) {\n\n\t\t/* Needs to be called outside of ftrace_lock */\n\t\tclear_mod_from_hashes(pg);\n\n\t\torder = get_count_order(pg->size / ENTRIES_PER_PAGE);\n\t\tfree_pages((unsigned long)pg->records, order);\n\t\ttmp_page = pg->next;\n\t\tkfree(pg);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "klp_module_going",
          "args": [
            "mod"
          ],
          "line": 3533
        },
        "resolved": true,
        "details": {
          "function_name": "klp_module_going",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/livepatch/core.c",
          "lines": "1030-1047",
          "snippet": "void klp_module_going(struct module *mod)\n{\n\tif (WARN_ON(mod->state != MODULE_STATE_GOING &&\n\t\t    mod->state != MODULE_STATE_COMING))\n\t\treturn;\n\n\tmutex_lock(&klp_mutex);\n\t/*\n\t * Each module has to know that klp_module_going()\n\t * has been called. We never know what module will\n\t * get patched by a new patch.\n\t */\n\tmod->klp_alive = false;\n\n\tklp_cleanup_module_patches_limited(mod, NULL);\n\n\tmutex_unlock(&klp_mutex);\n}",
          "includes": [
            "#include \"transition.h\"",
            "#include \"patch.h\"",
            "#include \"core.h\"",
            "#include <asm/cacheflush.h>",
            "#include <linux/completion.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/elf.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"transition.h\"\n#include \"patch.h\"\n#include \"core.h\"\n#include <asm/cacheflush.h>\n#include <linux/completion.h>\n#include <linux/moduleloader.h>\n#include <linux/elf.h>\n#include <linux/livepatch.h>\n#include <linux/kallsyms.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/mutex.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nvoid klp_module_going(struct module *mod)\n{\n\tif (WARN_ON(mod->state != MODULE_STATE_GOING &&\n\t\t    mod->state != MODULE_STATE_COMING))\n\t\treturn;\n\n\tmutex_lock(&klp_mutex);\n\t/*\n\t * Each module has to know that klp_module_going()\n\t * has been called. We never know what module will\n\t * get patched by a new patch.\n\t */\n\tmod->klp_alive = false;\n\n\tklp_cleanup_module_patches_limited(mod, NULL);\n\n\tmutex_unlock(&klp_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "blocking_notifier_call_chain",
          "args": [
            "&module_notify_list",
            "MODULE_STATE_GOING",
            "mod"
          ],
          "line": 3531
        },
        "resolved": true,
        "details": {
          "function_name": "blocking_notifier_call_chain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/notifier.c",
          "lines": "325-329",
          "snippet": "int blocking_notifier_call_chain(struct blocking_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\treturn __blocking_notifier_call_chain(nh, val, v, -1, NULL);\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint blocking_notifier_call_chain(struct blocking_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\treturn __blocking_notifier_call_chain(nh, val, v, -1, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "mod"
          ],
          "line": 3530
        },
        "resolved": true,
        "details": {
          "function_name": "module_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1132-1143",
          "snippet": "void module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "synchronize_sched",
          "args": [],
          "line": 3529
        },
        "resolved": true,
        "details": {
          "function_name": "synchronize_sched_expedited_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tree_exp.h",
          "lines": "468-540",
          "snippet": "static void synchronize_sched_expedited_wait(void)\n{\n\tint cpu;\n\tunsigned long jiffies_stall;\n\tunsigned long jiffies_start;\n\tunsigned long mask;\n\tint ndetected;\n\tstruct rcu_node *rnp;\n\tstruct rcu_node *rnp_root = rcu_get_root();\n\tint ret;\n\n\ttrace_rcu_exp_grace_period(rcu_state.name, rcu_exp_gp_seq_endval(), TPS(\"startwait\"));\n\tjiffies_stall = rcu_jiffies_till_stall_check();\n\tjiffies_start = jiffies;\n\n\tfor (;;) {\n\t\tret = swait_event_timeout_exclusive(\n\t\t\t\trcu_state.expedited_wq,\n\t\t\t\tsync_rcu_preempt_exp_done_unlocked(rnp_root),\n\t\t\t\tjiffies_stall);\n\t\tif (ret > 0 || sync_rcu_preempt_exp_done_unlocked(rnp_root))\n\t\t\treturn;\n\t\tWARN_ON(ret < 0);  /* workqueues should not be signaled. */\n\t\tif (rcu_cpu_stall_suppress)\n\t\t\tcontinue;\n\t\tpanic_on_rcu_stall();\n\t\tpr_err(\"INFO: %s detected expedited stalls on CPUs/tasks: {\",\n\t\t       rcu_state.name);\n\t\tndetected = 0;\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tndetected += rcu_print_task_exp_stall(rnp);\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tstruct rcu_data *rdp;\n\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tndetected++;\n\t\t\t\trdp = per_cpu_ptr(&rcu_data, cpu);\n\t\t\t\tpr_cont(\" %d-%c%c%c\", cpu,\n\t\t\t\t\t\"O.\"[!!cpu_online(cpu)],\n\t\t\t\t\t\"o.\"[!!(rdp->grpmask & rnp->expmaskinit)],\n\t\t\t\t\t\"N.\"[!!(rdp->grpmask & rnp->expmaskinitnext)]);\n\t\t\t}\n\t\t}\n\t\tpr_cont(\" } %lu jiffies s: %lu root: %#lx/%c\\n\",\n\t\t\tjiffies - jiffies_start, rcu_state.expedited_sequence,\n\t\t\trnp_root->expmask, \".T\"[!!rnp_root->exp_tasks]);\n\t\tif (ndetected) {\n\t\t\tpr_err(\"blocking rcu_node structures:\");\n\t\t\trcu_for_each_node_breadth_first(rnp) {\n\t\t\t\tif (rnp == rnp_root)\n\t\t\t\t\tcontinue; /* printed unconditionally */\n\t\t\t\tif (sync_rcu_preempt_exp_done_unlocked(rnp))\n\t\t\t\t\tcontinue;\n\t\t\t\tpr_cont(\" l=%u:%d-%d:%#lx/%c\",\n\t\t\t\t\trnp->level, rnp->grplo, rnp->grphi,\n\t\t\t\t\trnp->expmask,\n\t\t\t\t\t\".T\"[!!rnp->exp_tasks]);\n\t\t\t}\n\t\t\tpr_cont(\"\\n\");\n\t\t}\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tdump_cpu_task(cpu);\n\t\t\t}\n\t\t}\n\t\tjiffies_stall = 3 * rcu_jiffies_till_stall_check() + 3;\n\t}\n}",
          "includes": [
            "#include <linux/lockdep.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockdep.h>\n\nstatic void synchronize_sched_expedited_wait(void)\n{\n\tint cpu;\n\tunsigned long jiffies_stall;\n\tunsigned long jiffies_start;\n\tunsigned long mask;\n\tint ndetected;\n\tstruct rcu_node *rnp;\n\tstruct rcu_node *rnp_root = rcu_get_root();\n\tint ret;\n\n\ttrace_rcu_exp_grace_period(rcu_state.name, rcu_exp_gp_seq_endval(), TPS(\"startwait\"));\n\tjiffies_stall = rcu_jiffies_till_stall_check();\n\tjiffies_start = jiffies;\n\n\tfor (;;) {\n\t\tret = swait_event_timeout_exclusive(\n\t\t\t\trcu_state.expedited_wq,\n\t\t\t\tsync_rcu_preempt_exp_done_unlocked(rnp_root),\n\t\t\t\tjiffies_stall);\n\t\tif (ret > 0 || sync_rcu_preempt_exp_done_unlocked(rnp_root))\n\t\t\treturn;\n\t\tWARN_ON(ret < 0);  /* workqueues should not be signaled. */\n\t\tif (rcu_cpu_stall_suppress)\n\t\t\tcontinue;\n\t\tpanic_on_rcu_stall();\n\t\tpr_err(\"INFO: %s detected expedited stalls on CPUs/tasks: {\",\n\t\t       rcu_state.name);\n\t\tndetected = 0;\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tndetected += rcu_print_task_exp_stall(rnp);\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tstruct rcu_data *rdp;\n\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tndetected++;\n\t\t\t\trdp = per_cpu_ptr(&rcu_data, cpu);\n\t\t\t\tpr_cont(\" %d-%c%c%c\", cpu,\n\t\t\t\t\t\"O.\"[!!cpu_online(cpu)],\n\t\t\t\t\t\"o.\"[!!(rdp->grpmask & rnp->expmaskinit)],\n\t\t\t\t\t\"N.\"[!!(rdp->grpmask & rnp->expmaskinitnext)]);\n\t\t\t}\n\t\t}\n\t\tpr_cont(\" } %lu jiffies s: %lu root: %#lx/%c\\n\",\n\t\t\tjiffies - jiffies_start, rcu_state.expedited_sequence,\n\t\t\trnp_root->expmask, \".T\"[!!rnp_root->exp_tasks]);\n\t\tif (ndetected) {\n\t\t\tpr_err(\"blocking rcu_node structures:\");\n\t\t\trcu_for_each_node_breadth_first(rnp) {\n\t\t\t\tif (rnp == rnp_root)\n\t\t\t\t\tcontinue; /* printed unconditionally */\n\t\t\t\tif (sync_rcu_preempt_exp_done_unlocked(rnp))\n\t\t\t\t\tcontinue;\n\t\t\t\tpr_cont(\" l=%u:%d-%d:%#lx/%c\",\n\t\t\t\t\trnp->level, rnp->grplo, rnp->grphi,\n\t\t\t\t\trnp->expmask,\n\t\t\t\t\t\".T\"[!!rnp->exp_tasks]);\n\t\t\t}\n\t\t\tpr_cont(\"\\n\");\n\t\t}\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tdump_cpu_task(cpu);\n\t\t\t}\n\t\t}\n\t\tjiffies_stall = 3 * rcu_jiffies_till_stall_check() + 3;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "freeinit"
          ],
          "line": 3525
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 3519
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_rcu_sched",
          "args": [
            "&freeinit->rcu",
            "do_free_init"
          ],
          "line": 3518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_arch_freeing_init",
          "args": [
            "mod"
          ],
          "line": 3501
        },
        "resolved": true,
        "details": {
          "function_name": "module_arch_freeing_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2122-2124",
          "snippet": "void __weak module_arch_freeing_init(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_arch_freeing_init(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "disable_ro_nx",
          "args": [
            "&mod->init_layout"
          ],
          "line": 3500
        },
        "resolved": true,
        "details": {
          "function_name": "disable_ro_nx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2033-2033",
          "snippet": "static void disable_ro_nx(const struct module_layout *layout) { }",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void disable_ro_nx(const struct module_layout *layout) { }"
        }
      },
      {
        "call_info": {
          "callee": "mod_tree_remove_init",
          "args": [
            "mod"
          ],
          "line": 3499
        },
        "resolved": true,
        "details": {
          "function_name": "mod_tree_remove_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "217-217",
          "snippet": "static void mod_tree_remove_init(struct module *mod) { }",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_tree_remove_init(struct module *mod) { }"
        }
      },
      {
        "call_info": {
          "callee": "module_enable_ro",
          "args": [
            "mod",
            "true"
          ],
          "line": 3498
        },
        "resolved": true,
        "details": {
          "function_name": "module_enable_ro",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1944-1956",
          "snippet": "void module_enable_ro(const struct module *mod, bool after_init)\n{\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tfrob_text(&mod->core_layout, set_memory_ro);\n\tfrob_rodata(&mod->core_layout, set_memory_ro);\n\tfrob_text(&mod->init_layout, set_memory_ro);\n\tfrob_rodata(&mod->init_layout, set_memory_ro);\n\n\tif (after_init)\n\t\tfrob_ro_after_init(&mod->core_layout, set_memory_ro);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_enable_ro(const struct module *mod, bool after_init)\n{\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tfrob_text(&mod->core_layout, set_memory_ro);\n\tfrob_rodata(&mod->core_layout, set_memory_ro);\n\tfrob_text(&mod->init_layout, set_memory_ro);\n\tfrob_rodata(&mod->init_layout, set_memory_ro);\n\n\tif (after_init)\n\t\tfrob_ro_after_init(&mod->core_layout, set_memory_ro);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_assign_pointer",
          "args": [
            "mod->kallsyms",
            "&mod->core_kallsyms"
          ],
          "line": 3496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trim_init_extable",
          "args": [
            "mod"
          ],
          "line": 3493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 3490
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ftrace_free_mem",
          "args": [
            "mod",
            "mod->init_layout.base",
            "mod->init_layout.base +\n\t\t\tmod->init_layout.size"
          ],
          "line": 3488
        },
        "resolved": true,
        "details": {
          "function_name": "ftrace_free_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/ftrace.c",
          "lines": "6049-6117",
          "snippet": "void ftrace_free_mem(struct module *mod, void *start_ptr, void *end_ptr)\n{\n\tunsigned long start = (unsigned long)(start_ptr);\n\tunsigned long end = (unsigned long)(end_ptr);\n\tstruct ftrace_page **last_pg = &ftrace_pages_start;\n\tstruct ftrace_page *pg;\n\tstruct dyn_ftrace *rec;\n\tstruct dyn_ftrace key;\n\tstruct ftrace_mod_map *mod_map = NULL;\n\tstruct ftrace_init_func *func, *func_next;\n\tstruct list_head clear_hash;\n\tint order;\n\n\tINIT_LIST_HEAD(&clear_hash);\n\n\tkey.ip = start;\n\tkey.flags = end;\t/* overload flags, as it is unsigned long */\n\n\tmutex_lock(&ftrace_lock);\n\n\t/*\n\t * If we are freeing module init memory, then check if\n\t * any tracer is active. If so, we need to save a mapping of\n\t * the module functions being freed with the address.\n\t */\n\tif (mod && ftrace_ops_list != &ftrace_list_end)\n\t\tmod_map = allocate_ftrace_mod_map(mod, start, end);\n\n\tfor (pg = ftrace_pages_start; pg; last_pg = &pg->next, pg = *last_pg) {\n\t\tif (end < pg->records[0].ip ||\n\t\t    start >= (pg->records[pg->index - 1].ip + MCOUNT_INSN_SIZE))\n\t\t\tcontinue;\n again:\n\t\trec = bsearch(&key, pg->records, pg->index,\n\t\t\t      sizeof(struct dyn_ftrace),\n\t\t\t      ftrace_cmp_recs);\n\t\tif (!rec)\n\t\t\tcontinue;\n\n\t\t/* rec will be cleared from hashes after ftrace_lock unlock */\n\t\tadd_to_clear_hash_list(&clear_hash, rec);\n\n\t\tif (mod_map)\n\t\t\tsave_ftrace_mod_rec(mod_map, rec);\n\n\t\tpg->index--;\n\t\tftrace_update_tot_cnt--;\n\t\tif (!pg->index) {\n\t\t\t*last_pg = pg->next;\n\t\t\torder = get_count_order(pg->size / ENTRIES_PER_PAGE);\n\t\t\tfree_pages((unsigned long)pg->records, order);\n\t\t\tkfree(pg);\n\t\t\tpg = container_of(last_pg, struct ftrace_page, next);\n\t\t\tif (!(*last_pg))\n\t\t\t\tftrace_pages = pg;\n\t\t\tcontinue;\n\t\t}\n\t\tmemmove(rec, rec + 1,\n\t\t\t(pg->index - (rec - pg->records)) * sizeof(*rec));\n\t\t/* More than one function may be in this block */\n\t\tgoto again;\n\t}\n\tmutex_unlock(&ftrace_lock);\n\n\tlist_for_each_entry_safe(func, func_next, &clear_hash, list) {\n\t\tclear_func_from_hashes(func);\n\t\tkfree(func);\n\t}\n}",
          "includes": [
            "#include \"trace_stat.h\"",
            "#include \"trace_output.h\"",
            "#include <asm/setup.h>",
            "#include <asm/sections.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/hash.h>",
            "#include <linux/list.h>",
            "#include <linux/sort.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/tracefs.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/stop_machine.h>"
          ],
          "macros_used": [
            "#define ENTRIES_PER_PAGE (PAGE_SIZE / ENTRY_SIZE)"
          ],
          "globals_used": [
            "static DEFINE_MUTEX(ftrace_lock);",
            "static struct ftrace_ops __rcu *ftrace_ops_list"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_stat.h\"\n#include \"trace_output.h\"\n#include <asm/setup.h>\n#include <asm/sections.h>\n#include <trace/events/sched.h>\n#include <linux/rcupdate.h>\n#include <linux/hash.h>\n#include <linux/list.h>\n#include <linux/sort.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/sysctl.h>\n#include <linux/ftrace.h>\n#include <linux/module.h>\n#include <linux/bsearch.h>\n#include <linux/uaccess.h>\n#include <linux/kthread.h>\n#include <linux/hardirq.h>\n#include <linux/tracefs.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/kallsyms.h>\n#include <linux/sched/task.h>\n#include <linux/clocksource.h>\n#include <linux/stop_machine.h>\n\n#define ENTRIES_PER_PAGE (PAGE_SIZE / ENTRY_SIZE)\n\nstatic DEFINE_MUTEX(ftrace_lock);\nstatic struct ftrace_ops __rcu *ftrace_ops_list;\n\nvoid ftrace_free_mem(struct module *mod, void *start_ptr, void *end_ptr)\n{\n\tunsigned long start = (unsigned long)(start_ptr);\n\tunsigned long end = (unsigned long)(end_ptr);\n\tstruct ftrace_page **last_pg = &ftrace_pages_start;\n\tstruct ftrace_page *pg;\n\tstruct dyn_ftrace *rec;\n\tstruct dyn_ftrace key;\n\tstruct ftrace_mod_map *mod_map = NULL;\n\tstruct ftrace_init_func *func, *func_next;\n\tstruct list_head clear_hash;\n\tint order;\n\n\tINIT_LIST_HEAD(&clear_hash);\n\n\tkey.ip = start;\n\tkey.flags = end;\t/* overload flags, as it is unsigned long */\n\n\tmutex_lock(&ftrace_lock);\n\n\t/*\n\t * If we are freeing module init memory, then check if\n\t * any tracer is active. If so, we need to save a mapping of\n\t * the module functions being freed with the address.\n\t */\n\tif (mod && ftrace_ops_list != &ftrace_list_end)\n\t\tmod_map = allocate_ftrace_mod_map(mod, start, end);\n\n\tfor (pg = ftrace_pages_start; pg; last_pg = &pg->next, pg = *last_pg) {\n\t\tif (end < pg->records[0].ip ||\n\t\t    start >= (pg->records[pg->index - 1].ip + MCOUNT_INSN_SIZE))\n\t\t\tcontinue;\n again:\n\t\trec = bsearch(&key, pg->records, pg->index,\n\t\t\t      sizeof(struct dyn_ftrace),\n\t\t\t      ftrace_cmp_recs);\n\t\tif (!rec)\n\t\t\tcontinue;\n\n\t\t/* rec will be cleared from hashes after ftrace_lock unlock */\n\t\tadd_to_clear_hash_list(&clear_hash, rec);\n\n\t\tif (mod_map)\n\t\t\tsave_ftrace_mod_rec(mod_map, rec);\n\n\t\tpg->index--;\n\t\tftrace_update_tot_cnt--;\n\t\tif (!pg->index) {\n\t\t\t*last_pg = pg->next;\n\t\t\torder = get_count_order(pg->size / ENTRIES_PER_PAGE);\n\t\t\tfree_pages((unsigned long)pg->records, order);\n\t\t\tkfree(pg);\n\t\t\tpg = container_of(last_pg, struct ftrace_page, next);\n\t\t\tif (!(*last_pg))\n\t\t\t\tftrace_pages = pg;\n\t\t\tcontinue;\n\t\t}\n\t\tmemmove(rec, rec + 1,\n\t\t\t(pg->index - (rec - pg->records)) * sizeof(*rec));\n\t\t/* More than one function may be in this block */\n\t\tgoto again;\n\t}\n\tmutex_unlock(&ftrace_lock);\n\n\tlist_for_each_entry_safe(func, func_next, &clear_hash, list) {\n\t\tclear_func_from_hashes(func);\n\t\tkfree(func);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "async_synchronize_full",
          "args": [],
          "line": 3486
        },
        "resolved": true,
        "details": {
          "function_name": "async_synchronize_full",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/async.c",
          "lines": "241-244",
          "snippet": "void async_synchronize_full(void)\n{\n\tasync_synchronize_full_domain(NULL);\n}",
          "includes": [
            "#include \"workqueue_internal.h\"",
            "#include <linux/workqueue.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/wait.h>",
            "#include <linux/export.h>",
            "#include <linux/ktime.h>",
            "#include <linux/atomic.h>",
            "#include <linux/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"workqueue_internal.h\"\n#include <linux/workqueue.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/wait.h>\n#include <linux/export.h>\n#include <linux/ktime.h>\n#include <linux/atomic.h>\n#include <linux/async.h>\n\nvoid async_synchronize_full(void)\n{\n\tasync_synchronize_full_domain(NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dump_stack",
          "args": [],
          "line": 3460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: '%s'->init suspiciously returned %d, it should \"\n\t\t\t\"follow 0/-E convention\\n\"\n\t\t\t\"%s: loading module anyway...\\n\"",
            "__func__",
            "mod->name",
            "ret",
            "__func__"
          ],
          "line": 3456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_one_initcall",
          "args": [
            "mod->init"
          ],
          "line": 3451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_mod_ctors",
          "args": [
            "mod"
          ],
          "line": 3448
        },
        "resolved": true,
        "details": {
          "function_name": "do_mod_ctors",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3401-3409",
          "snippet": "static void do_mod_ctors(struct module *mod)\n{\n#ifdef CONFIG_CONSTRUCTORS\n\tunsigned long i;\n\n\tfor (i = 0; i < mod->num_ctors; i++)\n\t\tmod->ctors[i]();\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void do_mod_ctors(struct module *mod)\n{\n#ifdef CONFIG_CONSTRUCTORS\n\tunsigned long i;\n\n\tfor (i = 0; i < mod->num_ctors; i++)\n\t\tmod->ctors[i]();\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*freeinit)",
            "GFP_KERNEL"
          ],
          "line": 3435
        },
        "resolved": true,
        "details": {
          "function_name": "debug_kmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/debug/kdb/kdb_support.c",
          "lines": "745-801",
          "snippet": "void *debug_kmalloc(size_t size, gfp_t flags)\n{\n\tunsigned int rem, h_offset;\n\tstruct debug_alloc_header *best, *bestprev, *prev, *h;\n\tvoid *p = NULL;\n\tif (!get_dap_lock()) {\n\t\t__release(dap_lock);\t/* we never actually got it */\n\t\treturn NULL;\n\t}\n\th = (struct debug_alloc_header *)(debug_alloc_pool + dah_first);\n\tif (dah_first_call) {\n\t\th->size = sizeof(debug_alloc_pool_aligned) - dah_overhead;\n\t\tdah_first_call = 0;\n\t}\n\tsize = ALIGN(size, dah_align);\n\tprev = best = bestprev = NULL;\n\twhile (1) {\n\t\tif (h->size >= size && (!best || h->size < best->size)) {\n\t\t\tbest = h;\n\t\t\tbestprev = prev;\n\t\t\tif (h->size == size)\n\t\t\t\tbreak;\n\t\t}\n\t\tif (!h->next)\n\t\t\tbreak;\n\t\tprev = h;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h->next);\n\t}\n\tif (!best)\n\t\tgoto out;\n\trem = best->size - size;\n\t/* The pool must always contain at least one header */\n\tif (best->next == 0 && bestprev == NULL && rem < dah_overhead)\n\t\tgoto out;\n\tif (rem >= dah_overhead) {\n\t\tbest->size = size;\n\t\th_offset = ((char *)best - debug_alloc_pool) +\n\t\t\t   dah_overhead + best->size;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h_offset);\n\t\th->size = rem - dah_overhead;\n\t\th->next = best->next;\n\t} else\n\t\th_offset = best->next;\n\tbest->caller = __builtin_return_address(0);\n\tdah_used += best->size;\n\tdah_used_max = max(dah_used, dah_used_max);\n\tif (bestprev)\n\t\tbestprev->next = h_offset;\n\telse\n\t\tdah_first = h_offset;\n\tp = (char *)best + dah_overhead;\n\tmemset(p, POISON_INUSE, best->size - 1);\n\t*((char *)p + best->size - 1) = POISON_END;\nout:\n\tspin_unlock(&dap_lock);\n\treturn p;\n}",
          "includes": [
            "#include \"kdb_private.h\"",
            "#include <linux/slab.h>",
            "#include <linux/kdb.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/highmem.h>",
            "#include <linux/module.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/stddef.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define dah_overhead ALIGN(sizeof(struct debug_alloc_header), dah_align)",
            "#define dah_align 8"
          ],
          "globals_used": [
            "static u64 debug_alloc_pool_aligned[256*1024/dah_align];",
            "static char *debug_alloc_pool = (char *)debug_alloc_pool_aligned;",
            "static u32 dah_first, dah_first_call = 1, dah_used, dah_used_max;",
            "static DEFINE_SPINLOCK(dap_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kdb_private.h\"\n#include <linux/slab.h>\n#include <linux/kdb.h>\n#include <linux/uaccess.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/highmem.h>\n#include <linux/module.h>\n#include <linux/ptrace.h>\n#include <linux/vmalloc.h>\n#include <linux/stddef.h>\n#include <linux/kallsyms.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n#include <stdarg.h>\n\n#define dah_overhead ALIGN(sizeof(struct debug_alloc_header), dah_align)\n#define dah_align 8\n\nstatic u64 debug_alloc_pool_aligned[256*1024/dah_align];\nstatic char *debug_alloc_pool = (char *)debug_alloc_pool_aligned;\nstatic u32 dah_first, dah_first_call = 1, dah_used, dah_used_max;\nstatic DEFINE_SPINLOCK(dap_lock);\n\nvoid *debug_kmalloc(size_t size, gfp_t flags)\n{\n\tunsigned int rem, h_offset;\n\tstruct debug_alloc_header *best, *bestprev, *prev, *h;\n\tvoid *p = NULL;\n\tif (!get_dap_lock()) {\n\t\t__release(dap_lock);\t/* we never actually got it */\n\t\treturn NULL;\n\t}\n\th = (struct debug_alloc_header *)(debug_alloc_pool + dah_first);\n\tif (dah_first_call) {\n\t\th->size = sizeof(debug_alloc_pool_aligned) - dah_overhead;\n\t\tdah_first_call = 0;\n\t}\n\tsize = ALIGN(size, dah_align);\n\tprev = best = bestprev = NULL;\n\twhile (1) {\n\t\tif (h->size >= size && (!best || h->size < best->size)) {\n\t\t\tbest = h;\n\t\t\tbestprev = prev;\n\t\t\tif (h->size == size)\n\t\t\t\tbreak;\n\t\t}\n\t\tif (!h->next)\n\t\t\tbreak;\n\t\tprev = h;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h->next);\n\t}\n\tif (!best)\n\t\tgoto out;\n\trem = best->size - size;\n\t/* The pool must always contain at least one header */\n\tif (best->next == 0 && bestprev == NULL && rem < dah_overhead)\n\t\tgoto out;\n\tif (rem >= dah_overhead) {\n\t\tbest->size = size;\n\t\th_offset = ((char *)best - debug_alloc_pool) +\n\t\t\t   dah_overhead + best->size;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h_offset);\n\t\th->size = rem - dah_overhead;\n\t\th->next = best->next;\n\t} else\n\t\th_offset = best->next;\n\tbest->caller = __builtin_return_address(0);\n\tdah_used += best->size;\n\tdah_used_max = max(dah_used, dah_used_max);\n\tif (bestprev)\n\t\tbestprev->next = h_offset;\n\telse\n\t\tdah_first = h_offset;\n\tp = (char *)best + dah_overhead;\n\tmemset(p, POISON_INUSE, best->size - 1);\n\t*((char *)p + best->size - 1) = POISON_END;\nout:\n\tspin_unlock(&dap_lock);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(module_wq);\nstatic BLOCKING_NOTIFIER_HEAD(module_notify_list);\n\nstatic noinline int do_init_module(struct module *mod)\n{\n\tint ret = 0;\n\tstruct mod_initfree *freeinit;\n\n\tfreeinit = kmalloc(sizeof(*freeinit), GFP_KERNEL);\n\tif (!freeinit) {\n\t\tret = -ENOMEM;\n\t\tgoto fail;\n\t}\n\tfreeinit->module_init = mod->init_layout.base;\n\n\t/*\n\t * We want to find out whether @mod uses async during init.  Clear\n\t * PF_USED_ASYNC.  async_schedule*() will set it.\n\t */\n\tcurrent->flags &= ~PF_USED_ASYNC;\n\n\tdo_mod_ctors(mod);\n\t/* Start the module */\n\tif (mod->init != NULL)\n\t\tret = do_one_initcall(mod->init);\n\tif (ret < 0) {\n\t\tgoto fail_free_freeinit;\n\t}\n\tif (ret > 0) {\n\t\tpr_warn(\"%s: '%s'->init suspiciously returned %d, it should \"\n\t\t\t\"follow 0/-E convention\\n\"\n\t\t\t\"%s: loading module anyway...\\n\",\n\t\t\t__func__, mod->name, ret, __func__);\n\t\tdump_stack();\n\t}\n\n\t/* Now it's a first class citizen! */\n\tmod->state = MODULE_STATE_LIVE;\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_LIVE, mod);\n\n\t/*\n\t * We need to finish all async code before the module init sequence\n\t * is done.  This has potential to deadlock.  For example, a newly\n\t * detected block device can trigger request_module() of the\n\t * default iosched from async probing task.  Once userland helper\n\t * reaches here, async_synchronize_full() will wait on the async\n\t * task waiting on request_module() and deadlock.\n\t *\n\t * This deadlock is avoided by perfomring async_synchronize_full()\n\t * iff module init queued any async jobs.  This isn't a full\n\t * solution as it will deadlock the same if module loading from\n\t * async jobs nests more than once; however, due to the various\n\t * constraints, this hack seems to be the best option for now.\n\t * Please refer to the following thread for details.\n\t *\n\t * http://thread.gmane.org/gmane.linux.kernel/1420814\n\t */\n\tif (!mod->async_probe_requested && (current->flags & PF_USED_ASYNC))\n\t\tasync_synchronize_full();\n\n\tftrace_free_mem(mod, mod->init_layout.base, mod->init_layout.base +\n\t\t\tmod->init_layout.size);\n\tmutex_lock(&module_mutex);\n\t/* Drop initial reference. */\n\tmodule_put(mod);\n\ttrim_init_extable(mod);\n#ifdef CONFIG_KALLSYMS\n\t/* Switch to core kallsyms now init is done: kallsyms may be walking! */\n\trcu_assign_pointer(mod->kallsyms, &mod->core_kallsyms);\n#endif\n\tmodule_enable_ro(mod, true);\n\tmod_tree_remove_init(mod);\n\tdisable_ro_nx(&mod->init_layout);\n\tmodule_arch_freeing_init(mod);\n\tmod->init_layout.base = NULL;\n\tmod->init_layout.size = 0;\n\tmod->init_layout.ro_size = 0;\n\tmod->init_layout.ro_after_init_size = 0;\n\tmod->init_layout.text_size = 0;\n\t/*\n\t * We want to free module_init, but be aware that kallsyms may be\n\t * walking this with preempt disabled.  In all the failure paths, we\n\t * call synchronize_sched(), but we don't want to slow down the success\n\t * path, so use actual RCU here.\n\t * Note that module_alloc() on most architectures creates W+X page\n\t * mappings which won't be cleaned up until do_free_init() runs.  Any\n\t * code such as mark_rodata_ro() which depends on those mappings to\n\t * be cleaned up needs to sync with the queued work - ie\n\t * rcu_barrier_sched()\n\t */\n\tcall_rcu_sched(&freeinit->rcu, do_free_init);\n\tmutex_unlock(&module_mutex);\n\twake_up_all(&module_wq);\n\n\treturn 0;\n\nfail_free_freeinit:\n\tkfree(freeinit);\nfail:\n\t/* Try to protect us from buggy refcounters. */\n\tmod->state = MODULE_STATE_GOING;\n\tsynchronize_sched();\n\tmodule_put(mod);\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_GOING, mod);\n\tklp_module_going(mod);\n\tftrace_release_mod(mod);\n\tfree_module(mod);\n\twake_up_all(&module_wq);\n\treturn ret;\n}"
  },
  {
    "function_name": "do_free_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3417-3422",
    "snippet": "static void do_free_init(struct rcu_head *head)\n{\n\tstruct mod_initfree *m = container_of(head, struct mod_initfree, rcu);\n\tmodule_memfree(m->module_init);\n\tkfree(m);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "m"
          ],
          "line": 3421
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_memfree",
          "args": [
            "m->module_init"
          ],
          "line": 3420
        },
        "resolved": true,
        "details": {
          "function_name": "module_memfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2113-2116",
          "snippet": "void __weak module_memfree(void *module_region)\n{\n\tvfree(module_region);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_memfree(void *module_region)\n{\n\tvfree(module_region);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "head",
            "structmod_initfree",
            "rcu"
          ],
          "line": 3419
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void do_free_init(struct rcu_head *head)\n{\n\tstruct mod_initfree *m = container_of(head, struct mod_initfree, rcu);\n\tmodule_memfree(m->module_init);\n\tkfree(m);\n}"
  },
  {
    "function_name": "do_mod_ctors",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3401-3409",
    "snippet": "static void do_mod_ctors(struct module *mod)\n{\n#ifdef CONFIG_CONSTRUCTORS\n\tunsigned long i;\n\n\tfor (i = 0; i < mod->num_ctors; i++)\n\t\tmod->ctors[i]();\n#endif\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mod->ctors[i]",
          "args": [],
          "line": 3407
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void do_mod_ctors(struct module *mod)\n{\n#ifdef CONFIG_CONSTRUCTORS\n\tunsigned long i;\n\n\tfor (i = 0; i < mod->num_ctors; i++)\n\t\tmod->ctors[i]();\n#endif\n}"
  },
  {
    "function_name": "finished_loading",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3380-3398",
    "snippet": "static bool finished_loading(const char *name)\n{\n\tstruct module *mod;\n\tbool ret;\n\n\t/*\n\t * The module_mutex should not be a heavily contended lock;\n\t * if we get the occasional sleep here, we'll go an extra iteration\n\t * in the wait_event_interruptible(), which is harmless.\n\t */\n\tsched_annotate_sleep();\n\tmutex_lock(&module_mutex);\n\tmod = find_module_all(name, strlen(name), true);\n\tret = !mod || mod->state == MODULE_STATE_LIVE\n\t\t|| mod->state == MODULE_STATE_GOING;\n\tmutex_unlock(&module_mutex);\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 3395
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_module_all",
          "args": [
            "name",
            "strlen(name)",
            "true"
          ],
          "line": 3392
        },
        "resolved": true,
        "details": {
          "function_name": "find_module_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "605-619",
          "snippet": "static struct module *find_module_all(const char *name, size_t len,\n\t\t\t\t      bool even_unformed)\n{\n\tstruct module *mod;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (!even_unformed && mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (strlen(mod->name) == len && !memcmp(mod->name, name, len))\n\t\t\treturn mod;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(modules);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic struct module *find_module_all(const char *name, size_t len,\n\t\t\t\t      bool even_unformed)\n{\n\tstruct module *mod;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (!even_unformed && mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (strlen(mod->name) == len && !memcmp(mod->name, name, len))\n\t\t\treturn mod;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 3392
        },
        "resolved": true,
        "details": {
          "function_name": "fetch_store_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_uprobe.c",
          "lines": "137-146",
          "snippet": "static nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/string.h>",
            "#include <linux/namei.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include <linux/rculist.h>\n#include <linux/string.h>\n#include <linux/namei.h>\n#include <linux/uprobes.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n\nstatic nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 3391
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sched_annotate_sleep",
          "args": [],
          "line": 3390
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic bool finished_loading(const char *name)\n{\n\tstruct module *mod;\n\tbool ret;\n\n\t/*\n\t * The module_mutex should not be a heavily contended lock;\n\t * if we get the occasional sleep here, we'll go an extra iteration\n\t * in the wait_event_interruptible(), which is harmless.\n\t */\n\tsched_annotate_sleep();\n\tmutex_lock(&module_mutex);\n\tmod = find_module_all(name, strlen(name), true);\n\tret = !mod || mod->state == MODULE_STATE_LIVE\n\t\t|| mod->state == MODULE_STATE_GOING;\n\tmutex_unlock(&module_mutex);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "post_relocation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3363-3377",
    "snippet": "static int post_relocation(struct module *mod, const struct load_info *info)\n{\n\t/* Sort exception table now relocations are done. */\n\tsort_extable(mod->extable, mod->extable + mod->num_exentries);\n\n\t/* Copy relocated percpu area over. */\n\tpercpu_modcopy(mod, (void *)info->sechdrs[info->index.pcpu].sh_addr,\n\t\t       info->sechdrs[info->index.pcpu].sh_size);\n\n\t/* Setup kallsyms-specific fields. */\n\tadd_kallsyms(mod, info);\n\n\t/* Arch-specific module finalizing. */\n\treturn module_finalize(info->hdr, info->sechdrs, mod);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_finalize",
          "args": [
            "info->hdr",
            "info->sechdrs",
            "mod"
          ],
          "line": 3376
        },
        "resolved": true,
        "details": {
          "function_name": "module_finalize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3356-3361",
          "snippet": "int __weak module_finalize(const Elf_Ehdr *hdr,\n\t\t\t   const Elf_Shdr *sechdrs,\n\t\t\t   struct module *me)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nint __weak module_finalize(const Elf_Ehdr *hdr,\n\t\t\t   const Elf_Shdr *sechdrs,\n\t\t\t   struct module *me)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_kallsyms",
          "args": [
            "mod",
            "info"
          ],
          "line": 3373
        },
        "resolved": true,
        "details": {
          "function_name": "add_kallsyms",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2709-2711",
          "snippet": "static void add_kallsyms(struct module *mod, const struct load_info *info)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void add_kallsyms(struct module *mod, const struct load_info *info)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "percpu_modcopy",
          "args": [
            "mod",
            "(void *)info->sechdrs[info->index.pcpu].sh_addr",
            "info->sechdrs[info->index.pcpu].sh_size"
          ],
          "line": 3369
        },
        "resolved": true,
        "details": {
          "function_name": "percpu_modcopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "745-750",
          "snippet": "static inline void percpu_modcopy(struct module *mod,\n\t\t\t\t  const void *from, unsigned long size)\n{\n\t/* pcpusec should be 0, and size of that section should be 0. */\n\tBUG_ON(size != 0);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void percpu_modcopy(struct module *mod,\n\t\t\t\t  const void *from, unsigned long size)\n{\n\t/* pcpusec should be 0, and size of that section should be 0. */\n\tBUG_ON(size != 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sort_extable",
          "args": [
            "mod->extable",
            "mod->extable + mod->num_exentries"
          ],
          "line": 3366
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int post_relocation(struct module *mod, const struct load_info *info)\n{\n\t/* Sort exception table now relocations are done. */\n\tsort_extable(mod->extable, mod->extable + mod->num_exentries);\n\n\t/* Copy relocated percpu area over. */\n\tpercpu_modcopy(mod, (void *)info->sechdrs[info->index.pcpu].sh_addr,\n\t\t       info->sechdrs[info->index.pcpu].sh_size);\n\n\t/* Setup kallsyms-specific fields. */\n\tadd_kallsyms(mod, info);\n\n\t/* Arch-specific module finalizing. */\n\treturn module_finalize(info->hdr, info->sechdrs, mod);\n}"
  },
  {
    "function_name": "module_finalize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3356-3361",
    "snippet": "int __weak module_finalize(const Elf_Ehdr *hdr,\n\t\t\t   const Elf_Shdr *sechdrs,\n\t\t\t   struct module *me)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nint __weak module_finalize(const Elf_Ehdr *hdr,\n\t\t\t   const Elf_Shdr *sechdrs,\n\t\t\t   struct module *me)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "module_deallocate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3348-3354",
    "snippet": "static void module_deallocate(struct module *mod, struct load_info *info)\n{\n\tpercpu_modfree(mod);\n\tmodule_arch_freeing_init(mod);\n\tmodule_memfree(mod->init_layout.base);\n\tmodule_memfree(mod->core_layout.base);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_memfree",
          "args": [
            "mod->core_layout.base"
          ],
          "line": 3353
        },
        "resolved": true,
        "details": {
          "function_name": "module_memfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2113-2116",
          "snippet": "void __weak module_memfree(void *module_region)\n{\n\tvfree(module_region);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_memfree(void *module_region)\n{\n\tvfree(module_region);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_arch_freeing_init",
          "args": [
            "mod"
          ],
          "line": 3351
        },
        "resolved": true,
        "details": {
          "function_name": "module_arch_freeing_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2122-2124",
          "snippet": "void __weak module_arch_freeing_init(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_arch_freeing_init(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "percpu_modfree",
          "args": [
            "mod"
          ],
          "line": 3350
        },
        "resolved": true,
        "details": {
          "function_name": "percpu_modfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "738-740",
          "snippet": "static inline void percpu_modfree(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void percpu_modfree(struct module *mod)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_deallocate(struct module *mod, struct load_info *info)\n{\n\tpercpu_modfree(mod);\n\tmodule_arch_freeing_init(mod);\n\tmodule_memfree(mod->init_layout.base);\n\tmodule_memfree(mod->core_layout.base);\n}"
  },
  {
    "function_name": "layout_and_allocate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3293-3345",
    "snippet": "static struct module *layout_and_allocate(struct load_info *info, int flags)\n{\n\tstruct module *mod;\n\tunsigned int ndx;\n\tint err;\n\n\terr = check_modinfo(info->mod, info, flags);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\t/* Allow arches to frob section contents and sizes.  */\n\terr = module_frob_arch_sections(info->hdr, info->sechdrs,\n\t\t\t\t\tinfo->secstrings, info->mod);\n\tif (err < 0)\n\t\treturn ERR_PTR(err);\n\n\t/* We will do a special allocation for per-cpu sections later. */\n\tinfo->sechdrs[info->index.pcpu].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\n\t/*\n\t * Mark ro_after_init section with SHF_RO_AFTER_INIT so that\n\t * layout_sections() can put it in the right place.\n\t * Note: ro_after_init sections also have SHF_{WRITE,ALLOC} set.\n\t */\n\tndx = find_sec(info, \".data..ro_after_init\");\n\tif (ndx)\n\t\tinfo->sechdrs[ndx].sh_flags |= SHF_RO_AFTER_INIT;\n\t/*\n\t * Mark the __jump_table section as ro_after_init as well: these data\n\t * structures are never modified, with the exception of entries that\n\t * refer to code in the __init section, which are annotated as such\n\t * at module load time.\n\t */\n\tndx = find_sec(info, \"__jump_table\");\n\tif (ndx)\n\t\tinfo->sechdrs[ndx].sh_flags |= SHF_RO_AFTER_INIT;\n\n\t/* Determine total sizes, and put offsets in sh_entsize.  For now\n\t   this is done generically; there doesn't appear to be any\n\t   special cases for the architectures. */\n\tlayout_sections(info->mod, info);\n\tlayout_symtab(info->mod, info);\n\n\t/* Allocate and move to the final place */\n\terr = move_module(info->mod, info);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\t/* Module has been copied to its final place now: return it. */\n\tmod = (void *)info->sechdrs[info->index.mod].sh_addr;\n\tkmemleak_load_module(mod, info);\n\treturn mod;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmemleak_load_module",
          "args": [
            "mod",
            "info"
          ],
          "line": 3343
        },
        "resolved": true,
        "details": {
          "function_name": "kmemleak_load_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2757-2760",
          "snippet": "static inline void kmemleak_load_module(const struct module *mod,\n\t\t\t\t\tconst struct load_info *info)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void kmemleak_load_module(const struct module *mod,\n\t\t\t\t\tconst struct load_info *info)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 3339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "move_module",
          "args": [
            "info->mod",
            "info"
          ],
          "line": 3337
        },
        "resolved": true,
        "details": {
          "function_name": "move_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3137-3198",
          "snippet": "static int move_module(struct module *mod, struct load_info *info)\n{\n\tint i;\n\tvoid *ptr;\n\n\t/* Do the allocs. */\n\tptr = module_alloc(mod->core_layout.size);\n\t/*\n\t * The pointer to this block is stored in the module structure\n\t * which is inside the block. Just mark it as not being a\n\t * leak.\n\t */\n\tkmemleak_not_leak(ptr);\n\tif (!ptr)\n\t\treturn -ENOMEM;\n\n\tmemset(ptr, 0, mod->core_layout.size);\n\tmod->core_layout.base = ptr;\n\n\tif (mod->init_layout.size) {\n\t\tptr = module_alloc(mod->init_layout.size);\n\t\t/*\n\t\t * The pointer to this block is stored in the module structure\n\t\t * which is inside the block. This block doesn't need to be\n\t\t * scanned as it contains data and code that will be freed\n\t\t * after the module is initialized.\n\t\t */\n\t\tkmemleak_ignore(ptr);\n\t\tif (!ptr) {\n\t\t\tmodule_memfree(mod->core_layout.base);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tmemset(ptr, 0, mod->init_layout.size);\n\t\tmod->init_layout.base = ptr;\n\t} else\n\t\tmod->init_layout.base = NULL;\n\n\t/* Transfer each section which specifies SHF_ALLOC */\n\tpr_debug(\"final section addresses:\\n\");\n\tfor (i = 0; i < info->hdr->e_shnum; i++) {\n\t\tvoid *dest;\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\n\t\tif (!(shdr->sh_flags & SHF_ALLOC))\n\t\t\tcontinue;\n\n\t\tif (shdr->sh_entsize & INIT_OFFSET_MASK)\n\t\t\tdest = mod->init_layout.base\n\t\t\t\t+ (shdr->sh_entsize & ~INIT_OFFSET_MASK);\n\t\telse\n\t\t\tdest = mod->core_layout.base + shdr->sh_entsize;\n\n\t\tif (shdr->sh_type != SHT_NOBITS)\n\t\t\tmemcpy(dest, (void *)shdr->sh_addr, shdr->sh_size);\n\t\t/* Update sh_addr to point to copy in image. */\n\t\tshdr->sh_addr = (unsigned long)dest;\n\t\tpr_debug(\"\\t0x%lx %s\\n\",\n\t\t\t (long)shdr->sh_addr, info->secstrings + shdr->sh_name);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))\n\nstatic int move_module(struct module *mod, struct load_info *info)\n{\n\tint i;\n\tvoid *ptr;\n\n\t/* Do the allocs. */\n\tptr = module_alloc(mod->core_layout.size);\n\t/*\n\t * The pointer to this block is stored in the module structure\n\t * which is inside the block. Just mark it as not being a\n\t * leak.\n\t */\n\tkmemleak_not_leak(ptr);\n\tif (!ptr)\n\t\treturn -ENOMEM;\n\n\tmemset(ptr, 0, mod->core_layout.size);\n\tmod->core_layout.base = ptr;\n\n\tif (mod->init_layout.size) {\n\t\tptr = module_alloc(mod->init_layout.size);\n\t\t/*\n\t\t * The pointer to this block is stored in the module structure\n\t\t * which is inside the block. This block doesn't need to be\n\t\t * scanned as it contains data and code that will be freed\n\t\t * after the module is initialized.\n\t\t */\n\t\tkmemleak_ignore(ptr);\n\t\tif (!ptr) {\n\t\t\tmodule_memfree(mod->core_layout.base);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tmemset(ptr, 0, mod->init_layout.size);\n\t\tmod->init_layout.base = ptr;\n\t} else\n\t\tmod->init_layout.base = NULL;\n\n\t/* Transfer each section which specifies SHF_ALLOC */\n\tpr_debug(\"final section addresses:\\n\");\n\tfor (i = 0; i < info->hdr->e_shnum; i++) {\n\t\tvoid *dest;\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\n\t\tif (!(shdr->sh_flags & SHF_ALLOC))\n\t\t\tcontinue;\n\n\t\tif (shdr->sh_entsize & INIT_OFFSET_MASK)\n\t\t\tdest = mod->init_layout.base\n\t\t\t\t+ (shdr->sh_entsize & ~INIT_OFFSET_MASK);\n\t\telse\n\t\t\tdest = mod->core_layout.base + shdr->sh_entsize;\n\n\t\tif (shdr->sh_type != SHT_NOBITS)\n\t\t\tmemcpy(dest, (void *)shdr->sh_addr, shdr->sh_size);\n\t\t/* Update sh_addr to point to copy in image. */\n\t\tshdr->sh_addr = (unsigned long)dest;\n\t\tpr_debug(\"\\t0x%lx %s\\n\",\n\t\t\t (long)shdr->sh_addr, info->secstrings + shdr->sh_name);\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "layout_symtab",
          "args": [
            "info->mod",
            "info"
          ],
          "line": 3334
        },
        "resolved": true,
        "details": {
          "function_name": "layout_symtab",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2705-2707",
          "snippet": "static inline void layout_symtab(struct module *mod, struct load_info *info)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void layout_symtab(struct module *mod, struct load_info *info)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "layout_sections",
          "args": [
            "info->mod",
            "info"
          ],
          "line": 3333
        },
        "resolved": true,
        "details": {
          "function_name": "layout_sections",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2359-2445",
          "snippet": "static void layout_sections(struct module *mod, struct load_info *info)\n{\n\tstatic unsigned long const masks[][2] = {\n\t\t/* NOTE: all executable code must be the first section\n\t\t * in this array; otherwise modify the text_size\n\t\t * finder in the two loops below */\n\t\t{ SHF_EXECINSTR | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ SHF_ALLOC, SHF_WRITE | ARCH_SHF_SMALL },\n\t\t{ SHF_RO_AFTER_INIT | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ SHF_WRITE | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ ARCH_SHF_SMALL | SHF_ALLOC, 0 }\n\t};\n\tunsigned int m, i;\n\n\tfor (i = 0; i < info->hdr->e_shnum; i++)\n\t\tinfo->sechdrs[i].sh_entsize = ~0UL;\n\n\tpr_debug(\"Core section allocation order:\\n\");\n\tfor (m = 0; m < ARRAY_SIZE(masks); ++m) {\n\t\tfor (i = 0; i < info->hdr->e_shnum; ++i) {\n\t\t\tElf_Shdr *s = &info->sechdrs[i];\n\t\t\tconst char *sname = info->secstrings + s->sh_name;\n\n\t\t\tif ((s->sh_flags & masks[m][0]) != masks[m][0]\n\t\t\t    || (s->sh_flags & masks[m][1])\n\t\t\t    || s->sh_entsize != ~0UL\n\t\t\t    || strstarts(sname, \".init\"))\n\t\t\t\tcontinue;\n\t\t\ts->sh_entsize = get_offset(mod, &mod->core_layout.size, s, i);\n\t\t\tpr_debug(\"\\t%s\\n\", sname);\n\t\t}\n\t\tswitch (m) {\n\t\tcase 0: /* executable */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.text_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 1: /* RO: text and ro-data */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.ro_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 2: /* RO after init */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.ro_after_init_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 4: /* whole core */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tpr_debug(\"Init section allocation order:\\n\");\n\tfor (m = 0; m < ARRAY_SIZE(masks); ++m) {\n\t\tfor (i = 0; i < info->hdr->e_shnum; ++i) {\n\t\t\tElf_Shdr *s = &info->sechdrs[i];\n\t\t\tconst char *sname = info->secstrings + s->sh_name;\n\n\t\t\tif ((s->sh_flags & masks[m][0]) != masks[m][0]\n\t\t\t    || (s->sh_flags & masks[m][1])\n\t\t\t    || s->sh_entsize != ~0UL\n\t\t\t    || !strstarts(sname, \".init\"))\n\t\t\t\tcontinue;\n\t\t\ts->sh_entsize = (get_offset(mod, &mod->init_layout.size, s, i)\n\t\t\t\t\t | INIT_OFFSET_MASK);\n\t\t\tpr_debug(\"\\t%s\\n\", sname);\n\t\t}\n\t\tswitch (m) {\n\t\tcase 0: /* executable */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tmod->init_layout.text_size = mod->init_layout.size;\n\t\t\tbreak;\n\t\tcase 1: /* RO: text and ro-data */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tmod->init_layout.ro_size = mod->init_layout.size;\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\t/*\n\t\t\t * RO after init doesn't apply to init_layout (only\n\t\t\t * core_layout), so it just takes the value of ro_size.\n\t\t\t */\n\t\t\tmod->init_layout.ro_after_init_size = mod->init_layout.ro_size;\n\t\t\tbreak;\n\t\tcase 4: /* whole init */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tbreak;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))",
            "#define ARCH_SHF_SMALL 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))\n#define ARCH_SHF_SMALL 0\n\nstatic void layout_sections(struct module *mod, struct load_info *info)\n{\n\tstatic unsigned long const masks[][2] = {\n\t\t/* NOTE: all executable code must be the first section\n\t\t * in this array; otherwise modify the text_size\n\t\t * finder in the two loops below */\n\t\t{ SHF_EXECINSTR | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ SHF_ALLOC, SHF_WRITE | ARCH_SHF_SMALL },\n\t\t{ SHF_RO_AFTER_INIT | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ SHF_WRITE | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ ARCH_SHF_SMALL | SHF_ALLOC, 0 }\n\t};\n\tunsigned int m, i;\n\n\tfor (i = 0; i < info->hdr->e_shnum; i++)\n\t\tinfo->sechdrs[i].sh_entsize = ~0UL;\n\n\tpr_debug(\"Core section allocation order:\\n\");\n\tfor (m = 0; m < ARRAY_SIZE(masks); ++m) {\n\t\tfor (i = 0; i < info->hdr->e_shnum; ++i) {\n\t\t\tElf_Shdr *s = &info->sechdrs[i];\n\t\t\tconst char *sname = info->secstrings + s->sh_name;\n\n\t\t\tif ((s->sh_flags & masks[m][0]) != masks[m][0]\n\t\t\t    || (s->sh_flags & masks[m][1])\n\t\t\t    || s->sh_entsize != ~0UL\n\t\t\t    || strstarts(sname, \".init\"))\n\t\t\t\tcontinue;\n\t\t\ts->sh_entsize = get_offset(mod, &mod->core_layout.size, s, i);\n\t\t\tpr_debug(\"\\t%s\\n\", sname);\n\t\t}\n\t\tswitch (m) {\n\t\tcase 0: /* executable */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.text_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 1: /* RO: text and ro-data */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.ro_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 2: /* RO after init */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.ro_after_init_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 4: /* whole core */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tpr_debug(\"Init section allocation order:\\n\");\n\tfor (m = 0; m < ARRAY_SIZE(masks); ++m) {\n\t\tfor (i = 0; i < info->hdr->e_shnum; ++i) {\n\t\t\tElf_Shdr *s = &info->sechdrs[i];\n\t\t\tconst char *sname = info->secstrings + s->sh_name;\n\n\t\t\tif ((s->sh_flags & masks[m][0]) != masks[m][0]\n\t\t\t    || (s->sh_flags & masks[m][1])\n\t\t\t    || s->sh_entsize != ~0UL\n\t\t\t    || !strstarts(sname, \".init\"))\n\t\t\t\tcontinue;\n\t\t\ts->sh_entsize = (get_offset(mod, &mod->init_layout.size, s, i)\n\t\t\t\t\t | INIT_OFFSET_MASK);\n\t\t\tpr_debug(\"\\t%s\\n\", sname);\n\t\t}\n\t\tswitch (m) {\n\t\tcase 0: /* executable */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tmod->init_layout.text_size = mod->init_layout.size;\n\t\t\tbreak;\n\t\tcase 1: /* RO: text and ro-data */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tmod->init_layout.ro_size = mod->init_layout.size;\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\t/*\n\t\t\t * RO after init doesn't apply to init_layout (only\n\t\t\t * core_layout), so it just takes the value of ro_size.\n\t\t\t */\n\t\t\tmod->init_layout.ro_after_init_size = mod->init_layout.ro_size;\n\t\t\tbreak;\n\t\tcase 4: /* whole init */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tbreak;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_sec",
          "args": [
            "info",
            "\"__jump_table\""
          ],
          "line": 3326
        },
        "resolved": true,
        "details": {
          "function_name": "find_sec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "345-357",
          "snippet": "static unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 3307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_frob_arch_sections",
          "args": [
            "info->hdr",
            "info->sechdrs",
            "info->secstrings",
            "info->mod"
          ],
          "line": 3304
        },
        "resolved": true,
        "details": {
          "function_name": "module_frob_arch_sections",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3264-3270",
          "snippet": "int __weak module_frob_arch_sections(Elf_Ehdr *hdr,\n\t\t\t\t     Elf_Shdr *sechdrs,\n\t\t\t\t     char *secstrings,\n\t\t\t\t     struct module *mod)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nint __weak module_frob_arch_sections(Elf_Ehdr *hdr,\n\t\t\t\t     Elf_Shdr *sechdrs,\n\t\t\t\t     char *secstrings,\n\t\t\t\t     struct module *mod)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 3301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_modinfo",
          "args": [
            "info->mod",
            "info",
            "flags"
          ],
          "line": 3299
        },
        "resolved": true,
        "details": {
          "function_name": "check_modinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "3003-3045",
          "snippet": "static int check_modinfo(struct module *mod, struct load_info *info, int flags)\n{\n\tconst char *modmagic = get_modinfo(info, \"vermagic\");\n\tint err;\n\n\tif (flags & MODULE_INIT_IGNORE_VERMAGIC)\n\t\tmodmagic = NULL;\n\n\t/* This is allowed: modprobe --force will invalidate it. */\n\tif (!modmagic) {\n\t\terr = try_to_force_load(mod, \"bad vermagic\");\n\t\tif (err)\n\t\t\treturn err;\n\t} else if (!same_magic(modmagic, vermagic, info->index.vers)) {\n\t\tpr_err(\"%s: version magic '%s' should be '%s'\\n\",\n\t\t       info->name, modmagic, vermagic);\n\t\treturn -ENOEXEC;\n\t}\n\n\tif (!get_modinfo(info, \"intree\")) {\n\t\tif (!test_taint(TAINT_OOT_MODULE))\n\t\t\tpr_warn(\"%s: loading out-of-tree module taints kernel.\\n\",\n\t\t\t\tmod->name);\n\t\tadd_taint_module(mod, TAINT_OOT_MODULE, LOCKDEP_STILL_OK);\n\t}\n\n\tcheck_modinfo_retpoline(mod, info);\n\n\tif (get_modinfo(info, \"staging\")) {\n\t\tadd_taint_module(mod, TAINT_CRAP, LOCKDEP_STILL_OK);\n\t\tpr_warn(\"%s: module is from the staging directory, the quality \"\n\t\t\t\"is unknown, you have been warned.\\n\", mod->name);\n\t}\n\n\terr = check_modinfo_livepatch(mod, info);\n\tif (err)\n\t\treturn err;\n\n\t/* Set up license info based on the info section */\n\tset_license(mod, get_modinfo(info, \"license\"));\n\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char vermagic[] = VERMAGIC_STRING;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const char vermagic[] = VERMAGIC_STRING;\n\nstatic int check_modinfo(struct module *mod, struct load_info *info, int flags)\n{\n\tconst char *modmagic = get_modinfo(info, \"vermagic\");\n\tint err;\n\n\tif (flags & MODULE_INIT_IGNORE_VERMAGIC)\n\t\tmodmagic = NULL;\n\n\t/* This is allowed: modprobe --force will invalidate it. */\n\tif (!modmagic) {\n\t\terr = try_to_force_load(mod, \"bad vermagic\");\n\t\tif (err)\n\t\t\treturn err;\n\t} else if (!same_magic(modmagic, vermagic, info->index.vers)) {\n\t\tpr_err(\"%s: version magic '%s' should be '%s'\\n\",\n\t\t       info->name, modmagic, vermagic);\n\t\treturn -ENOEXEC;\n\t}\n\n\tif (!get_modinfo(info, \"intree\")) {\n\t\tif (!test_taint(TAINT_OOT_MODULE))\n\t\t\tpr_warn(\"%s: loading out-of-tree module taints kernel.\\n\",\n\t\t\t\tmod->name);\n\t\tadd_taint_module(mod, TAINT_OOT_MODULE, LOCKDEP_STILL_OK);\n\t}\n\n\tcheck_modinfo_retpoline(mod, info);\n\n\tif (get_modinfo(info, \"staging\")) {\n\t\tadd_taint_module(mod, TAINT_CRAP, LOCKDEP_STILL_OK);\n\t\tpr_warn(\"%s: module is from the staging directory, the quality \"\n\t\t\t\"is unknown, you have been warned.\\n\", mod->name);\n\t}\n\n\terr = check_modinfo_livepatch(mod, info);\n\tif (err)\n\t\treturn err;\n\n\t/* Set up license info based on the info section */\n\tset_license(mod, get_modinfo(info, \"license\"));\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic struct module *layout_and_allocate(struct load_info *info, int flags)\n{\n\tstruct module *mod;\n\tunsigned int ndx;\n\tint err;\n\n\terr = check_modinfo(info->mod, info, flags);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\t/* Allow arches to frob section contents and sizes.  */\n\terr = module_frob_arch_sections(info->hdr, info->sechdrs,\n\t\t\t\t\tinfo->secstrings, info->mod);\n\tif (err < 0)\n\t\treturn ERR_PTR(err);\n\n\t/* We will do a special allocation for per-cpu sections later. */\n\tinfo->sechdrs[info->index.pcpu].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\n\t/*\n\t * Mark ro_after_init section with SHF_RO_AFTER_INIT so that\n\t * layout_sections() can put it in the right place.\n\t * Note: ro_after_init sections also have SHF_{WRITE,ALLOC} set.\n\t */\n\tndx = find_sec(info, \".data..ro_after_init\");\n\tif (ndx)\n\t\tinfo->sechdrs[ndx].sh_flags |= SHF_RO_AFTER_INIT;\n\t/*\n\t * Mark the __jump_table section as ro_after_init as well: these data\n\t * structures are never modified, with the exception of entries that\n\t * refer to code in the __init section, which are annotated as such\n\t * at module load time.\n\t */\n\tndx = find_sec(info, \"__jump_table\");\n\tif (ndx)\n\t\tinfo->sechdrs[ndx].sh_flags |= SHF_RO_AFTER_INIT;\n\n\t/* Determine total sizes, and put offsets in sh_entsize.  For now\n\t   this is done generically; there doesn't appear to be any\n\t   special cases for the architectures. */\n\tlayout_sections(info->mod, info);\n\tlayout_symtab(info->mod, info);\n\n\t/* Allocate and move to the final place */\n\terr = move_module(info->mod, info);\n\tif (err)\n\t\treturn ERR_PTR(err);\n\n\t/* Module has been copied to its final place now: return it. */\n\tmod = (void *)info->sechdrs[info->index.mod].sh_addr;\n\tkmemleak_load_module(mod, info);\n\treturn mod;\n}"
  },
  {
    "function_name": "blacklisted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3274-3290",
    "snippet": "static bool blacklisted(const char *module_name)\n{\n\tconst char *p;\n\tsize_t len;\n\n\tif (!module_blacklist)\n\t\treturn false;\n\n\tfor (p = module_blacklist; *p; p += len) {\n\t\tlen = strcspn(p, \",\");\n\t\tif (strlen(module_name) == len && !memcmp(module_name, p, len))\n\t\t\treturn true;\n\t\tif (p[len] == ',')\n\t\t\tlen++;\n\t}\n\treturn false;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *module_blacklist;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "module_name",
            "p",
            "len"
          ],
          "line": 3284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "module_name"
          ],
          "line": 3284
        },
        "resolved": true,
        "details": {
          "function_name": "fetch_store_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_uprobe.c",
          "lines": "137-146",
          "snippet": "static nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/string.h>",
            "#include <linux/namei.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include <linux/rculist.h>\n#include <linux/string.h>\n#include <linux/namei.h>\n#include <linux/uprobes.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n\nstatic nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcspn",
          "args": [
            "p",
            "\",\""
          ],
          "line": 3283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *module_blacklist;\n\nstatic bool blacklisted(const char *module_name)\n{\n\tconst char *p;\n\tsize_t len;\n\n\tif (!module_blacklist)\n\t\treturn false;\n\n\tfor (p = module_blacklist; *p; p += len) {\n\t\tlen = strcspn(p, \",\");\n\t\tif (strlen(module_name) == len && !memcmp(module_name, p, len))\n\t\t\treturn true;\n\t\tif (p[len] == ',')\n\t\t\tlen++;\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "module_frob_arch_sections",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3264-3270",
    "snippet": "int __weak module_frob_arch_sections(Elf_Ehdr *hdr,\n\t\t\t\t     Elf_Shdr *sechdrs,\n\t\t\t\t     char *secstrings,\n\t\t\t\t     struct module *mod)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nint __weak module_frob_arch_sections(Elf_Ehdr *hdr,\n\t\t\t\t     Elf_Shdr *sechdrs,\n\t\t\t\t     char *secstrings,\n\t\t\t\t     struct module *mod)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "flush_module_icache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3241-3262",
    "snippet": "static void flush_module_icache(const struct module *mod)\n{\n\tmm_segment_t old_fs;\n\n\t/* flush the icache in correct context */\n\told_fs = get_fs();\n\tset_fs(KERNEL_DS);\n\n\t/*\n\t * Flush the instruction cache, since we've played with text.\n\t * Do it before processing of module parameters, so the module\n\t * can provide parameter accessor functions of its own.\n\t */\n\tif (mod->init_layout.base)\n\t\tflush_icache_range((unsigned long)mod->init_layout.base,\n\t\t\t\t   (unsigned long)mod->init_layout.base\n\t\t\t\t   + mod->init_layout.size);\n\tflush_icache_range((unsigned long)mod->core_layout.base,\n\t\t\t   (unsigned long)mod->core_layout.base + mod->core_layout.size);\n\n\tset_fs(old_fs);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "old_fs"
          ],
          "line": 3261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_icache_range",
          "args": [
            "(unsigned long)mod->core_layout.base",
            "(unsigned long)mod->core_layout.base + mod->core_layout.size"
          ],
          "line": 3258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_icache_range",
          "args": [
            "(unsigned long)mod->init_layout.base",
            "(unsigned long)mod->init_layout.base\n\t\t\t\t   + mod->init_layout.size"
          ],
          "line": 3255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "KERNEL_DS"
          ],
          "line": 3247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_fs",
          "args": [],
          "line": 3246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void flush_module_icache(const struct module *mod)\n{\n\tmm_segment_t old_fs;\n\n\t/* flush the icache in correct context */\n\told_fs = get_fs();\n\tset_fs(KERNEL_DS);\n\n\t/*\n\t * Flush the instruction cache, since we've played with text.\n\t * Do it before processing of module parameters, so the module\n\t * can provide parameter accessor functions of its own.\n\t */\n\tif (mod->init_layout.base)\n\t\tflush_icache_range((unsigned long)mod->init_layout.base,\n\t\t\t\t   (unsigned long)mod->init_layout.base\n\t\t\t\t   + mod->init_layout.size);\n\tflush_icache_range((unsigned long)mod->core_layout.base,\n\t\t\t   (unsigned long)mod->core_layout.base + mod->core_layout.size);\n\n\tset_fs(old_fs);\n}"
  },
  {
    "function_name": "check_module_license_and_versions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3200-3239",
    "snippet": "static int check_module_license_and_versions(struct module *mod)\n{\n\tint prev_taint = test_taint(TAINT_PROPRIETARY_MODULE);\n\n\t/*\n\t * ndiswrapper is under GPL by itself, but loads proprietary modules.\n\t * Don't use add_taint_module(), as it would prevent ndiswrapper from\n\t * using GPL-only symbols it needs.\n\t */\n\tif (strcmp(mod->name, \"ndiswrapper\") == 0)\n\t\tadd_taint(TAINT_PROPRIETARY_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\n\t/* driverloader was caught wrongly pretending to be under GPL */\n\tif (strcmp(mod->name, \"driverloader\") == 0)\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\n\t/* lve claims to be GPL but upstream won't provide source */\n\tif (strcmp(mod->name, \"lve\") == 0)\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\n\tif (!prev_taint && test_taint(TAINT_PROPRIETARY_MODULE))\n\t\tpr_warn(\"%s: module license taints kernel.\\n\", mod->name);\n\n#ifdef CONFIG_MODVERSIONS\n\tif ((mod->num_syms && !mod->crcs)\n\t    || (mod->num_gpl_syms && !mod->gpl_crcs)\n\t    || (mod->num_gpl_future_syms && !mod->gpl_future_crcs)\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t    || (mod->num_unused_syms && !mod->unused_crcs)\n\t    || (mod->num_unused_gpl_syms && !mod->unused_gpl_crcs)\n#endif\n\t\t) {\n\t\treturn try_to_force_load(mod,\n\t\t\t\t\t \"no versions for exported symbols\");\n\t}\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "try_to_force_load",
          "args": [
            "mod",
            "\"no versions for exported symbols\""
          ],
          "line": 3234
        },
        "resolved": true,
        "details": {
          "function_name": "try_to_force_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1264-1274",
          "snippet": "static int try_to_force_load(struct module *mod, const char *reason)\n{\n#ifdef CONFIG_MODULE_FORCE_LOAD\n\tif (!test_taint(TAINT_FORCED_MODULE))\n\t\tpr_warn(\"%s: %s: kernel tainted.\\n\", mod->name, reason);\n\tadd_taint_module(mod, TAINT_FORCED_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\treturn 0;\n#else\n\treturn -ENOEXEC;\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int try_to_force_load(struct module *mod, const char *reason)\n{\n#ifdef CONFIG_MODULE_FORCE_LOAD\n\tif (!test_taint(TAINT_FORCED_MODULE))\n\t\tpr_warn(\"%s: %s: kernel tainted.\\n\", mod->name, reason);\n\tadd_taint_module(mod, TAINT_FORCED_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\treturn 0;\n#else\n\treturn -ENOEXEC;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: module license taints kernel.\\n\"",
            "mod->name"
          ],
          "line": 3223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_taint",
          "args": [
            "TAINT_PROPRIETARY_MODULE"
          ],
          "line": 3222
        },
        "resolved": true,
        "details": {
          "function_name": "test_taint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/panic.c",
          "lines": "367-370",
          "snippet": "int test_taint(unsigned flag)\n{\n\treturn test_bit(flag, &tainted_mask);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nstatic unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;\n\nint test_taint(unsigned flag)\n{\n\treturn test_bit(flag, &tainted_mask);\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_taint_module",
          "args": [
            "mod",
            "TAINT_PROPRIETARY_MODULE",
            "LOCKDEP_NOW_UNRELIABLE"
          ],
          "line": 3219
        },
        "resolved": true,
        "details": {
          "function_name": "add_taint_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "326-331",
          "snippet": "static inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "mod->name",
            "\"lve\""
          ],
          "line": 3218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "mod->name",
            "\"driverloader\""
          ],
          "line": 3213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_taint",
          "args": [
            "TAINT_PROPRIETARY_MODULE",
            "LOCKDEP_NOW_UNRELIABLE"
          ],
          "line": 3210
        },
        "resolved": true,
        "details": {
          "function_name": "add_taint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/panic.c",
          "lines": "386-392",
          "snippet": "void add_taint(unsigned flag, enum lockdep_ok lockdep_ok)\n{\n\tif (lockdep_ok == LOCKDEP_NOW_UNRELIABLE && __debug_locks_off())\n\t\tpr_warn(\"Disabling lock debugging due to kernel taint\\n\");\n\n\tset_bit(flag, &tainted_mask);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nstatic unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;\n\nvoid add_taint(unsigned flag, enum lockdep_ok lockdep_ok)\n{\n\tif (lockdep_ok == LOCKDEP_NOW_UNRELIABLE && __debug_locks_off())\n\t\tpr_warn(\"Disabling lock debugging due to kernel taint\\n\");\n\n\tset_bit(flag, &tainted_mask);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "mod->name",
            "\"ndiswrapper\""
          ],
          "line": 3209
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic int check_module_license_and_versions(struct module *mod)\n{\n\tint prev_taint = test_taint(TAINT_PROPRIETARY_MODULE);\n\n\t/*\n\t * ndiswrapper is under GPL by itself, but loads proprietary modules.\n\t * Don't use add_taint_module(), as it would prevent ndiswrapper from\n\t * using GPL-only symbols it needs.\n\t */\n\tif (strcmp(mod->name, \"ndiswrapper\") == 0)\n\t\tadd_taint(TAINT_PROPRIETARY_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\n\t/* driverloader was caught wrongly pretending to be under GPL */\n\tif (strcmp(mod->name, \"driverloader\") == 0)\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\n\t/* lve claims to be GPL but upstream won't provide source */\n\tif (strcmp(mod->name, \"lve\") == 0)\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\n\tif (!prev_taint && test_taint(TAINT_PROPRIETARY_MODULE))\n\t\tpr_warn(\"%s: module license taints kernel.\\n\", mod->name);\n\n#ifdef CONFIG_MODVERSIONS\n\tif ((mod->num_syms && !mod->crcs)\n\t    || (mod->num_gpl_syms && !mod->gpl_crcs)\n\t    || (mod->num_gpl_future_syms && !mod->gpl_future_crcs)\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t    || (mod->num_unused_syms && !mod->unused_crcs)\n\t    || (mod->num_unused_gpl_syms && !mod->unused_gpl_crcs)\n#endif\n\t\t) {\n\t\treturn try_to_force_load(mod,\n\t\t\t\t\t \"no versions for exported symbols\");\n\t}\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "move_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3137-3198",
    "snippet": "static int move_module(struct module *mod, struct load_info *info)\n{\n\tint i;\n\tvoid *ptr;\n\n\t/* Do the allocs. */\n\tptr = module_alloc(mod->core_layout.size);\n\t/*\n\t * The pointer to this block is stored in the module structure\n\t * which is inside the block. Just mark it as not being a\n\t * leak.\n\t */\n\tkmemleak_not_leak(ptr);\n\tif (!ptr)\n\t\treturn -ENOMEM;\n\n\tmemset(ptr, 0, mod->core_layout.size);\n\tmod->core_layout.base = ptr;\n\n\tif (mod->init_layout.size) {\n\t\tptr = module_alloc(mod->init_layout.size);\n\t\t/*\n\t\t * The pointer to this block is stored in the module structure\n\t\t * which is inside the block. This block doesn't need to be\n\t\t * scanned as it contains data and code that will be freed\n\t\t * after the module is initialized.\n\t\t */\n\t\tkmemleak_ignore(ptr);\n\t\tif (!ptr) {\n\t\t\tmodule_memfree(mod->core_layout.base);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tmemset(ptr, 0, mod->init_layout.size);\n\t\tmod->init_layout.base = ptr;\n\t} else\n\t\tmod->init_layout.base = NULL;\n\n\t/* Transfer each section which specifies SHF_ALLOC */\n\tpr_debug(\"final section addresses:\\n\");\n\tfor (i = 0; i < info->hdr->e_shnum; i++) {\n\t\tvoid *dest;\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\n\t\tif (!(shdr->sh_flags & SHF_ALLOC))\n\t\t\tcontinue;\n\n\t\tif (shdr->sh_entsize & INIT_OFFSET_MASK)\n\t\t\tdest = mod->init_layout.base\n\t\t\t\t+ (shdr->sh_entsize & ~INIT_OFFSET_MASK);\n\t\telse\n\t\t\tdest = mod->core_layout.base + shdr->sh_entsize;\n\n\t\tif (shdr->sh_type != SHT_NOBITS)\n\t\t\tmemcpy(dest, (void *)shdr->sh_addr, shdr->sh_size);\n\t\t/* Update sh_addr to point to copy in image. */\n\t\tshdr->sh_addr = (unsigned long)dest;\n\t\tpr_debug(\"\\t0x%lx %s\\n\",\n\t\t\t (long)shdr->sh_addr, info->secstrings + shdr->sh_name);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"\\t0x%lx %s\\n\"",
            "(long)shdr->sh_addr",
            "info->secstrings + shdr->sh_name"
          ],
          "line": 3193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dest",
            "(void *)shdr->sh_addr",
            "shdr->sh_size"
          ],
          "line": 3190
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy_skip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/events/internal.h",
          "lines": "178-182",
          "snippet": "static inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/hardirq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/hardirq.h>\n\nstatic inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"final section addresses:\\n\""
          ],
          "line": 3175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ptr",
            "0",
            "mod->init_layout.size"
          ],
          "line": 3169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_memfree",
          "args": [
            "mod->core_layout.base"
          ],
          "line": 3166
        },
        "resolved": true,
        "details": {
          "function_name": "module_memfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2113-2116",
          "snippet": "void __weak module_memfree(void *module_region)\n{\n\tvfree(module_region);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_memfree(void *module_region)\n{\n\tvfree(module_region);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmemleak_ignore",
          "args": [
            "ptr"
          ],
          "line": 3164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_alloc",
          "args": [
            "mod->init_layout.size"
          ],
          "line": 3157
        },
        "resolved": true,
        "details": {
          "function_name": "module_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2731-2734",
          "snippet": "void * __weak module_alloc(unsigned long size)\n{\n\treturn vmalloc_exec(size);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid * __weak module_alloc(unsigned long size)\n{\n\treturn vmalloc_exec(size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ptr",
            "0",
            "mod->core_layout.size"
          ],
          "line": 3153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmemleak_not_leak",
          "args": [
            "ptr"
          ],
          "line": 3149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))\n\nstatic int move_module(struct module *mod, struct load_info *info)\n{\n\tint i;\n\tvoid *ptr;\n\n\t/* Do the allocs. */\n\tptr = module_alloc(mod->core_layout.size);\n\t/*\n\t * The pointer to this block is stored in the module structure\n\t * which is inside the block. Just mark it as not being a\n\t * leak.\n\t */\n\tkmemleak_not_leak(ptr);\n\tif (!ptr)\n\t\treturn -ENOMEM;\n\n\tmemset(ptr, 0, mod->core_layout.size);\n\tmod->core_layout.base = ptr;\n\n\tif (mod->init_layout.size) {\n\t\tptr = module_alloc(mod->init_layout.size);\n\t\t/*\n\t\t * The pointer to this block is stored in the module structure\n\t\t * which is inside the block. This block doesn't need to be\n\t\t * scanned as it contains data and code that will be freed\n\t\t * after the module is initialized.\n\t\t */\n\t\tkmemleak_ignore(ptr);\n\t\tif (!ptr) {\n\t\t\tmodule_memfree(mod->core_layout.base);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tmemset(ptr, 0, mod->init_layout.size);\n\t\tmod->init_layout.base = ptr;\n\t} else\n\t\tmod->init_layout.base = NULL;\n\n\t/* Transfer each section which specifies SHF_ALLOC */\n\tpr_debug(\"final section addresses:\\n\");\n\tfor (i = 0; i < info->hdr->e_shnum; i++) {\n\t\tvoid *dest;\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\n\t\tif (!(shdr->sh_flags & SHF_ALLOC))\n\t\t\tcontinue;\n\n\t\tif (shdr->sh_entsize & INIT_OFFSET_MASK)\n\t\t\tdest = mod->init_layout.base\n\t\t\t\t+ (shdr->sh_entsize & ~INIT_OFFSET_MASK);\n\t\telse\n\t\t\tdest = mod->core_layout.base + shdr->sh_entsize;\n\n\t\tif (shdr->sh_type != SHT_NOBITS)\n\t\t\tmemcpy(dest, (void *)shdr->sh_addr, shdr->sh_size);\n\t\t/* Update sh_addr to point to copy in image. */\n\t\tshdr->sh_addr = (unsigned long)dest;\n\t\tpr_debug(\"\\t0x%lx %s\\n\",\n\t\t\t (long)shdr->sh_addr, info->secstrings + shdr->sh_name);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "find_module_sections",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3047-3135",
    "snippet": "static int find_module_sections(struct module *mod, struct load_info *info)\n{\n\tmod->kp = section_objs(info, \"__param\",\n\t\t\t       sizeof(*mod->kp), &mod->num_kp);\n\tmod->syms = section_objs(info, \"__ksymtab\",\n\t\t\t\t sizeof(*mod->syms), &mod->num_syms);\n\tmod->crcs = section_addr(info, \"__kcrctab\");\n\tmod->gpl_syms = section_objs(info, \"__ksymtab_gpl\",\n\t\t\t\t     sizeof(*mod->gpl_syms),\n\t\t\t\t     &mod->num_gpl_syms);\n\tmod->gpl_crcs = section_addr(info, \"__kcrctab_gpl\");\n\tmod->gpl_future_syms = section_objs(info,\n\t\t\t\t\t    \"__ksymtab_gpl_future\",\n\t\t\t\t\t    sizeof(*mod->gpl_future_syms),\n\t\t\t\t\t    &mod->num_gpl_future_syms);\n\tmod->gpl_future_crcs = section_addr(info, \"__kcrctab_gpl_future\");\n\n#ifdef CONFIG_UNUSED_SYMBOLS\n\tmod->unused_syms = section_objs(info, \"__ksymtab_unused\",\n\t\t\t\t\tsizeof(*mod->unused_syms),\n\t\t\t\t\t&mod->num_unused_syms);\n\tmod->unused_crcs = section_addr(info, \"__kcrctab_unused\");\n\tmod->unused_gpl_syms = section_objs(info, \"__ksymtab_unused_gpl\",\n\t\t\t\t\t    sizeof(*mod->unused_gpl_syms),\n\t\t\t\t\t    &mod->num_unused_gpl_syms);\n\tmod->unused_gpl_crcs = section_addr(info, \"__kcrctab_unused_gpl\");\n#endif\n#ifdef CONFIG_CONSTRUCTORS\n\tmod->ctors = section_objs(info, \".ctors\",\n\t\t\t\t  sizeof(*mod->ctors), &mod->num_ctors);\n\tif (!mod->ctors)\n\t\tmod->ctors = section_objs(info, \".init_array\",\n\t\t\t\tsizeof(*mod->ctors), &mod->num_ctors);\n\telse if (find_sec(info, \".init_array\")) {\n\t\t/*\n\t\t * This shouldn't happen with same compiler and binutils\n\t\t * building all parts of the module.\n\t\t */\n\t\tpr_warn(\"%s: has both .ctors and .init_array.\\n\",\n\t\t       mod->name);\n\t\treturn -EINVAL;\n\t}\n#endif\n\n#ifdef CONFIG_TRACEPOINTS\n\tmod->tracepoints_ptrs = section_objs(info, \"__tracepoints_ptrs\",\n\t\t\t\t\t     sizeof(*mod->tracepoints_ptrs),\n\t\t\t\t\t     &mod->num_tracepoints);\n#endif\n#ifdef HAVE_JUMP_LABEL\n\tmod->jump_entries = section_objs(info, \"__jump_table\",\n\t\t\t\t\tsizeof(*mod->jump_entries),\n\t\t\t\t\t&mod->num_jump_entries);\n#endif\n#ifdef CONFIG_EVENT_TRACING\n\tmod->trace_events = section_objs(info, \"_ftrace_events\",\n\t\t\t\t\t sizeof(*mod->trace_events),\n\t\t\t\t\t &mod->num_trace_events);\n\tmod->trace_evals = section_objs(info, \"_ftrace_eval_map\",\n\t\t\t\t\tsizeof(*mod->trace_evals),\n\t\t\t\t\t&mod->num_trace_evals);\n#endif\n#ifdef CONFIG_TRACING\n\tmod->trace_bprintk_fmt_start = section_objs(info, \"__trace_printk_fmt\",\n\t\t\t\t\t sizeof(*mod->trace_bprintk_fmt_start),\n\t\t\t\t\t &mod->num_trace_bprintk_fmt);\n#endif\n#ifdef CONFIG_FTRACE_MCOUNT_RECORD\n\t/* sechdrs[0].sh_size is always zero */\n\tmod->ftrace_callsites = section_objs(info, \"__mcount_loc\",\n\t\t\t\t\t     sizeof(*mod->ftrace_callsites),\n\t\t\t\t\t     &mod->num_ftrace_callsites);\n#endif\n#ifdef CONFIG_FUNCTION_ERROR_INJECTION\n\tmod->ei_funcs = section_objs(info, \"_error_injection_whitelist\",\n\t\t\t\t\t    sizeof(*mod->ei_funcs),\n\t\t\t\t\t    &mod->num_ei_funcs);\n#endif\n\tmod->extable = section_objs(info, \"__ex_table\",\n\t\t\t\t    sizeof(*mod->extable), &mod->num_exentries);\n\n\tif (section_addr(info, \"__obsparm\"))\n\t\tpr_warn(\"%s: Ignoring obsolete parameters\\n\", mod->name);\n\n\tinfo->debug = section_objs(info, \"__verbose\",\n\t\t\t\t   sizeof(*info->debug), &info->num_debug);\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "section_objs",
          "args": [
            "info",
            "\"__verbose\"",
            "sizeof(*info->debug)",
            "&info->num_debug"
          ],
          "line": 3131
        },
        "resolved": true,
        "details": {
          "function_name": "section_objs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "367-377",
          "snippet": "static void *section_objs(const struct load_info *info,\n\t\t\t  const char *name,\n\t\t\t  size_t object_size,\n\t\t\t  unsigned int *num)\n{\n\tunsigned int sec = find_sec(info, name);\n\n\t/* Section 0 has sh_addr 0 and sh_size 0. */\n\t*num = info->sechdrs[sec].sh_size / object_size;\n\treturn (void *)info->sechdrs[sec].sh_addr;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void *section_objs(const struct load_info *info,\n\t\t\t  const char *name,\n\t\t\t  size_t object_size,\n\t\t\t  unsigned int *num)\n{\n\tunsigned int sec = find_sec(info, name);\n\n\t/* Section 0 has sh_addr 0 and sh_size 0. */\n\t*num = info->sechdrs[sec].sh_size / object_size;\n\treturn (void *)info->sechdrs[sec].sh_addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: Ignoring obsolete parameters\\n\"",
            "mod->name"
          ],
          "line": 3129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "section_addr",
          "args": [
            "info",
            "\"__obsparm\""
          ],
          "line": 3128
        },
        "resolved": true,
        "details": {
          "function_name": "section_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "360-364",
          "snippet": "static void *section_addr(const struct load_info *info, const char *name)\n{\n\t/* Section 0 has sh_addr 0. */\n\treturn (void *)info->sechdrs[find_sec(info, name)].sh_addr;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void *section_addr(const struct load_info *info, const char *name)\n{\n\t/* Section 0 has sh_addr 0. */\n\treturn (void *)info->sechdrs[find_sec(info, name)].sh_addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: has both .ctors and .init_array.\\n\"",
            "mod->name"
          ],
          "line": 3085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_sec",
          "args": [
            "info",
            "\".init_array\""
          ],
          "line": 3080
        },
        "resolved": true,
        "details": {
          "function_name": "find_sec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "345-357",
          "snippet": "static unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int find_module_sections(struct module *mod, struct load_info *info)\n{\n\tmod->kp = section_objs(info, \"__param\",\n\t\t\t       sizeof(*mod->kp), &mod->num_kp);\n\tmod->syms = section_objs(info, \"__ksymtab\",\n\t\t\t\t sizeof(*mod->syms), &mod->num_syms);\n\tmod->crcs = section_addr(info, \"__kcrctab\");\n\tmod->gpl_syms = section_objs(info, \"__ksymtab_gpl\",\n\t\t\t\t     sizeof(*mod->gpl_syms),\n\t\t\t\t     &mod->num_gpl_syms);\n\tmod->gpl_crcs = section_addr(info, \"__kcrctab_gpl\");\n\tmod->gpl_future_syms = section_objs(info,\n\t\t\t\t\t    \"__ksymtab_gpl_future\",\n\t\t\t\t\t    sizeof(*mod->gpl_future_syms),\n\t\t\t\t\t    &mod->num_gpl_future_syms);\n\tmod->gpl_future_crcs = section_addr(info, \"__kcrctab_gpl_future\");\n\n#ifdef CONFIG_UNUSED_SYMBOLS\n\tmod->unused_syms = section_objs(info, \"__ksymtab_unused\",\n\t\t\t\t\tsizeof(*mod->unused_syms),\n\t\t\t\t\t&mod->num_unused_syms);\n\tmod->unused_crcs = section_addr(info, \"__kcrctab_unused\");\n\tmod->unused_gpl_syms = section_objs(info, \"__ksymtab_unused_gpl\",\n\t\t\t\t\t    sizeof(*mod->unused_gpl_syms),\n\t\t\t\t\t    &mod->num_unused_gpl_syms);\n\tmod->unused_gpl_crcs = section_addr(info, \"__kcrctab_unused_gpl\");\n#endif\n#ifdef CONFIG_CONSTRUCTORS\n\tmod->ctors = section_objs(info, \".ctors\",\n\t\t\t\t  sizeof(*mod->ctors), &mod->num_ctors);\n\tif (!mod->ctors)\n\t\tmod->ctors = section_objs(info, \".init_array\",\n\t\t\t\tsizeof(*mod->ctors), &mod->num_ctors);\n\telse if (find_sec(info, \".init_array\")) {\n\t\t/*\n\t\t * This shouldn't happen with same compiler and binutils\n\t\t * building all parts of the module.\n\t\t */\n\t\tpr_warn(\"%s: has both .ctors and .init_array.\\n\",\n\t\t       mod->name);\n\t\treturn -EINVAL;\n\t}\n#endif\n\n#ifdef CONFIG_TRACEPOINTS\n\tmod->tracepoints_ptrs = section_objs(info, \"__tracepoints_ptrs\",\n\t\t\t\t\t     sizeof(*mod->tracepoints_ptrs),\n\t\t\t\t\t     &mod->num_tracepoints);\n#endif\n#ifdef HAVE_JUMP_LABEL\n\tmod->jump_entries = section_objs(info, \"__jump_table\",\n\t\t\t\t\tsizeof(*mod->jump_entries),\n\t\t\t\t\t&mod->num_jump_entries);\n#endif\n#ifdef CONFIG_EVENT_TRACING\n\tmod->trace_events = section_objs(info, \"_ftrace_events\",\n\t\t\t\t\t sizeof(*mod->trace_events),\n\t\t\t\t\t &mod->num_trace_events);\n\tmod->trace_evals = section_objs(info, \"_ftrace_eval_map\",\n\t\t\t\t\tsizeof(*mod->trace_evals),\n\t\t\t\t\t&mod->num_trace_evals);\n#endif\n#ifdef CONFIG_TRACING\n\tmod->trace_bprintk_fmt_start = section_objs(info, \"__trace_printk_fmt\",\n\t\t\t\t\t sizeof(*mod->trace_bprintk_fmt_start),\n\t\t\t\t\t &mod->num_trace_bprintk_fmt);\n#endif\n#ifdef CONFIG_FTRACE_MCOUNT_RECORD\n\t/* sechdrs[0].sh_size is always zero */\n\tmod->ftrace_callsites = section_objs(info, \"__mcount_loc\",\n\t\t\t\t\t     sizeof(*mod->ftrace_callsites),\n\t\t\t\t\t     &mod->num_ftrace_callsites);\n#endif\n#ifdef CONFIG_FUNCTION_ERROR_INJECTION\n\tmod->ei_funcs = section_objs(info, \"_error_injection_whitelist\",\n\t\t\t\t\t    sizeof(*mod->ei_funcs),\n\t\t\t\t\t    &mod->num_ei_funcs);\n#endif\n\tmod->extable = section_objs(info, \"__ex_table\",\n\t\t\t\t    sizeof(*mod->extable), &mod->num_exentries);\n\n\tif (section_addr(info, \"__obsparm\"))\n\t\tpr_warn(\"%s: Ignoring obsolete parameters\\n\", mod->name);\n\n\tinfo->debug = section_objs(info, \"__verbose\",\n\t\t\t\t   sizeof(*info->debug), &info->num_debug);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "check_modinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3003-3045",
    "snippet": "static int check_modinfo(struct module *mod, struct load_info *info, int flags)\n{\n\tconst char *modmagic = get_modinfo(info, \"vermagic\");\n\tint err;\n\n\tif (flags & MODULE_INIT_IGNORE_VERMAGIC)\n\t\tmodmagic = NULL;\n\n\t/* This is allowed: modprobe --force will invalidate it. */\n\tif (!modmagic) {\n\t\terr = try_to_force_load(mod, \"bad vermagic\");\n\t\tif (err)\n\t\t\treturn err;\n\t} else if (!same_magic(modmagic, vermagic, info->index.vers)) {\n\t\tpr_err(\"%s: version magic '%s' should be '%s'\\n\",\n\t\t       info->name, modmagic, vermagic);\n\t\treturn -ENOEXEC;\n\t}\n\n\tif (!get_modinfo(info, \"intree\")) {\n\t\tif (!test_taint(TAINT_OOT_MODULE))\n\t\t\tpr_warn(\"%s: loading out-of-tree module taints kernel.\\n\",\n\t\t\t\tmod->name);\n\t\tadd_taint_module(mod, TAINT_OOT_MODULE, LOCKDEP_STILL_OK);\n\t}\n\n\tcheck_modinfo_retpoline(mod, info);\n\n\tif (get_modinfo(info, \"staging\")) {\n\t\tadd_taint_module(mod, TAINT_CRAP, LOCKDEP_STILL_OK);\n\t\tpr_warn(\"%s: module is from the staging directory, the quality \"\n\t\t\t\"is unknown, you have been warned.\\n\", mod->name);\n\t}\n\n\terr = check_modinfo_livepatch(mod, info);\n\tif (err)\n\t\treturn err;\n\n\t/* Set up license info based on the info section */\n\tset_license(mod, get_modinfo(info, \"license\"));\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char vermagic[] = VERMAGIC_STRING;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_license",
          "args": [
            "mod",
            "get_modinfo(info, \"license\")"
          ],
          "line": 3042
        },
        "resolved": true,
        "details": {
          "function_name": "set_license",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2447-2459",
          "snippet": "static void set_license(struct module *mod, const char *license)\n{\n\tif (!license)\n\t\tlicense = \"unspecified\";\n\n\tif (!license_is_gpl_compatible(license)) {\n\t\tif (!test_taint(TAINT_PROPRIETARY_MODULE))\n\t\t\tpr_warn(\"%s: module license '%s' taints kernel.\\n\",\n\t\t\t\tmod->name, license);\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\t}\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void set_license(struct module *mod, const char *license)\n{\n\tif (!license)\n\t\tlicense = \"unspecified\";\n\n\tif (!license_is_gpl_compatible(license)) {\n\t\tif (!test_taint(TAINT_PROPRIETARY_MODULE))\n\t\t\tpr_warn(\"%s: module license '%s' taints kernel.\\n\",\n\t\t\t\tmod->name, license);\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_modinfo",
          "args": [
            "info",
            "\"license\""
          ],
          "line": 3042
        },
        "resolved": true,
        "details": {
          "function_name": "get_modinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2480-2496",
          "snippet": "static char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_modinfo_livepatch",
          "args": [
            "mod",
            "info"
          ],
          "line": 3037
        },
        "resolved": true,
        "details": {
          "function_name": "check_modinfo_livepatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2850-2859",
          "snippet": "static int check_modinfo_livepatch(struct module *mod, struct load_info *info)\n{\n\tif (get_modinfo(info, \"livepatch\")) {\n\t\tpr_err(\"%s: module is marked as livepatch module, but livepatch support is disabled\",\n\t\t       mod->name);\n\t\treturn -ENOEXEC;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int check_modinfo_livepatch(struct module *mod, struct load_info *info)\n{\n\tif (get_modinfo(info, \"livepatch\")) {\n\t\tpr_err(\"%s: module is marked as livepatch module, but livepatch support is disabled\",\n\t\t       mod->name);\n\t\treturn -ENOEXEC;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: module is from the staging directory, the quality \"\n\t\t\t\"is unknown, you have been warned.\\n\"",
            "mod->name"
          ],
          "line": 3033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_taint_module",
          "args": [
            "mod",
            "TAINT_CRAP",
            "LOCKDEP_STILL_OK"
          ],
          "line": 3032
        },
        "resolved": true,
        "details": {
          "function_name": "add_taint_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "326-331",
          "snippet": "static inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_modinfo_retpoline",
          "args": [
            "mod",
            "info"
          ],
          "line": 3029
        },
        "resolved": true,
        "details": {
          "function_name": "check_modinfo_retpoline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2862-2869",
          "snippet": "static void check_modinfo_retpoline(struct module *mod, struct load_info *info)\n{\n\tif (retpoline_module_ok(get_modinfo(info, \"retpoline\")))\n\t\treturn;\n\n\tpr_warn(\"%s: loading module not compiled with retpoline compiler.\\n\",\n\t\tmod->name);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void check_modinfo_retpoline(struct module *mod, struct load_info *info)\n{\n\tif (retpoline_module_ok(get_modinfo(info, \"retpoline\")))\n\t\treturn;\n\n\tpr_warn(\"%s: loading module not compiled with retpoline compiler.\\n\",\n\t\tmod->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: loading out-of-tree module taints kernel.\\n\"",
            "mod->name"
          ],
          "line": 3024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_taint",
          "args": [
            "TAINT_OOT_MODULE"
          ],
          "line": 3023
        },
        "resolved": true,
        "details": {
          "function_name": "test_taint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/panic.c",
          "lines": "367-370",
          "snippet": "int test_taint(unsigned flag)\n{\n\treturn test_bit(flag, &tainted_mask);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nstatic unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;\n\nint test_taint(unsigned flag)\n{\n\treturn test_bit(flag, &tainted_mask);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s: version magic '%s' should be '%s'\\n\"",
            "info->name",
            "modmagic",
            "vermagic"
          ],
          "line": 3017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "same_magic",
          "args": [
            "modmagic",
            "vermagic",
            "info->index.vers"
          ],
          "line": 3016
        },
        "resolved": true,
        "details": {
          "function_name": "same_magic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1375-1379",
          "snippet": "static inline int same_magic(const char *amagic, const char *bmagic,\n\t\t\t     bool has_crcs)\n{\n\treturn strcmp(amagic, bmagic) == 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int same_magic(const char *amagic, const char *bmagic,\n\t\t\t     bool has_crcs)\n{\n\treturn strcmp(amagic, bmagic) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "try_to_force_load",
          "args": [
            "mod",
            "\"bad vermagic\""
          ],
          "line": 3013
        },
        "resolved": true,
        "details": {
          "function_name": "try_to_force_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1264-1274",
          "snippet": "static int try_to_force_load(struct module *mod, const char *reason)\n{\n#ifdef CONFIG_MODULE_FORCE_LOAD\n\tif (!test_taint(TAINT_FORCED_MODULE))\n\t\tpr_warn(\"%s: %s: kernel tainted.\\n\", mod->name, reason);\n\tadd_taint_module(mod, TAINT_FORCED_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\treturn 0;\n#else\n\treturn -ENOEXEC;\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int try_to_force_load(struct module *mod, const char *reason)\n{\n#ifdef CONFIG_MODULE_FORCE_LOAD\n\tif (!test_taint(TAINT_FORCED_MODULE))\n\t\tpr_warn(\"%s: %s: kernel tainted.\\n\", mod->name, reason);\n\tadd_taint_module(mod, TAINT_FORCED_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\treturn 0;\n#else\n\treturn -ENOEXEC;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const char vermagic[] = VERMAGIC_STRING;\n\nstatic int check_modinfo(struct module *mod, struct load_info *info, int flags)\n{\n\tconst char *modmagic = get_modinfo(info, \"vermagic\");\n\tint err;\n\n\tif (flags & MODULE_INIT_IGNORE_VERMAGIC)\n\t\tmodmagic = NULL;\n\n\t/* This is allowed: modprobe --force will invalidate it. */\n\tif (!modmagic) {\n\t\terr = try_to_force_load(mod, \"bad vermagic\");\n\t\tif (err)\n\t\t\treturn err;\n\t} else if (!same_magic(modmagic, vermagic, info->index.vers)) {\n\t\tpr_err(\"%s: version magic '%s' should be '%s'\\n\",\n\t\t       info->name, modmagic, vermagic);\n\t\treturn -ENOEXEC;\n\t}\n\n\tif (!get_modinfo(info, \"intree\")) {\n\t\tif (!test_taint(TAINT_OOT_MODULE))\n\t\t\tpr_warn(\"%s: loading out-of-tree module taints kernel.\\n\",\n\t\t\t\tmod->name);\n\t\tadd_taint_module(mod, TAINT_OOT_MODULE, LOCKDEP_STILL_OK);\n\t}\n\n\tcheck_modinfo_retpoline(mod, info);\n\n\tif (get_modinfo(info, \"staging\")) {\n\t\tadd_taint_module(mod, TAINT_CRAP, LOCKDEP_STILL_OK);\n\t\tpr_warn(\"%s: module is from the staging directory, the quality \"\n\t\t\t\"is unknown, you have been warned.\\n\", mod->name);\n\t}\n\n\terr = check_modinfo_livepatch(mod, info);\n\tif (err)\n\t\treturn err;\n\n\t/* Set up license info based on the info section */\n\tset_license(mod, get_modinfo(info, \"license\"));\n\n\treturn 0;\n}"
  },
  {
    "function_name": "setup_load_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2945-3001",
    "snippet": "static int setup_load_info(struct load_info *info, int flags)\n{\n\tunsigned int i;\n\n\t/* Set up the convenience variables */\n\tinfo->sechdrs = (void *)info->hdr + info->hdr->e_shoff;\n\tinfo->secstrings = (void *)info->hdr\n\t\t+ info->sechdrs[info->hdr->e_shstrndx].sh_offset;\n\n\t/* Try to find a name early so we can log errors with a module name */\n\tinfo->index.info = find_sec(info, \".modinfo\");\n\tif (!info->index.info)\n\t\tinfo->name = \"(missing .modinfo section)\";\n\telse\n\t\tinfo->name = get_modinfo(info, \"name\");\n\n\t/* Find internal symbols and strings. */\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tif (info->sechdrs[i].sh_type == SHT_SYMTAB) {\n\t\t\tinfo->index.sym = i;\n\t\t\tinfo->index.str = info->sechdrs[i].sh_link;\n\t\t\tinfo->strtab = (char *)info->hdr\n\t\t\t\t+ info->sechdrs[info->index.str].sh_offset;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (info->index.sym == 0) {\n\t\tpr_warn(\"%s: module has no symbols (stripped?)\\n\", info->name);\n\t\treturn -ENOEXEC;\n\t}\n\n\tinfo->index.mod = find_sec(info, \".gnu.linkonce.this_module\");\n\tif (!info->index.mod) {\n\t\tpr_warn(\"%s: No module found in object\\n\",\n\t\t\tinfo->name ?: \"(missing .modinfo name field)\");\n\t\treturn -ENOEXEC;\n\t}\n\t/* This is temporary: point mod into copy of data. */\n\tinfo->mod = (void *)info->hdr + info->sechdrs[info->index.mod].sh_offset;\n\n\t/*\n\t * If we didn't load the .modinfo 'name' field earlier, fall back to\n\t * on-disk struct mod 'name' field.\n\t */\n\tif (!info->name)\n\t\tinfo->name = info->mod->name;\n\n\tif (flags & MODULE_INIT_IGNORE_MODVERSIONS)\n\t\tinfo->index.vers = 0; /* Pretend no __versions section! */\n\telse\n\t\tinfo->index.vers = find_sec(info, \"__versions\");\n\n\tinfo->index.pcpu = find_pcpusec(info);\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "find_pcpusec",
          "args": [
            "info"
          ],
          "line": 2998
        },
        "resolved": true,
        "details": {
          "function_name": "find_pcpusec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "741-744",
          "snippet": "static unsigned int find_pcpusec(struct load_info *info)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned int find_pcpusec(struct load_info *info)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_sec",
          "args": [
            "info",
            "\"__versions\""
          ],
          "line": 2996
        },
        "resolved": true,
        "details": {
          "function_name": "find_sec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "345-357",
          "snippet": "static unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: No module found in object\\n\"",
            "info->name ?: \"(missing .modinfo name field)\""
          ],
          "line": 2979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: module has no symbols (stripped?)\\n\"",
            "info->name"
          ],
          "line": 2973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_modinfo",
          "args": [
            "info",
            "\"name\""
          ],
          "line": 2959
        },
        "resolved": true,
        "details": {
          "function_name": "get_modinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2480-2496",
          "snippet": "static char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int setup_load_info(struct load_info *info, int flags)\n{\n\tunsigned int i;\n\n\t/* Set up the convenience variables */\n\tinfo->sechdrs = (void *)info->hdr + info->hdr->e_shoff;\n\tinfo->secstrings = (void *)info->hdr\n\t\t+ info->sechdrs[info->hdr->e_shstrndx].sh_offset;\n\n\t/* Try to find a name early so we can log errors with a module name */\n\tinfo->index.info = find_sec(info, \".modinfo\");\n\tif (!info->index.info)\n\t\tinfo->name = \"(missing .modinfo section)\";\n\telse\n\t\tinfo->name = get_modinfo(info, \"name\");\n\n\t/* Find internal symbols and strings. */\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tif (info->sechdrs[i].sh_type == SHT_SYMTAB) {\n\t\t\tinfo->index.sym = i;\n\t\t\tinfo->index.str = info->sechdrs[i].sh_link;\n\t\t\tinfo->strtab = (char *)info->hdr\n\t\t\t\t+ info->sechdrs[info->index.str].sh_offset;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (info->index.sym == 0) {\n\t\tpr_warn(\"%s: module has no symbols (stripped?)\\n\", info->name);\n\t\treturn -ENOEXEC;\n\t}\n\n\tinfo->index.mod = find_sec(info, \".gnu.linkonce.this_module\");\n\tif (!info->index.mod) {\n\t\tpr_warn(\"%s: No module found in object\\n\",\n\t\t\tinfo->name ?: \"(missing .modinfo name field)\");\n\t\treturn -ENOEXEC;\n\t}\n\t/* This is temporary: point mod into copy of data. */\n\tinfo->mod = (void *)info->hdr + info->sechdrs[info->index.mod].sh_offset;\n\n\t/*\n\t * If we didn't load the .modinfo 'name' field earlier, fall back to\n\t * on-disk struct mod 'name' field.\n\t */\n\tif (!info->name)\n\t\tinfo->name = info->mod->name;\n\n\tif (flags & MODULE_INIT_IGNORE_MODVERSIONS)\n\t\tinfo->index.vers = 0; /* Pretend no __versions section! */\n\telse\n\t\tinfo->index.vers = find_sec(info, \"__versions\");\n\n\tinfo->index.pcpu = find_pcpusec(info);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "rewrite_section_headers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2904-2935",
    "snippet": "static int rewrite_section_headers(struct load_info *info, int flags)\n{\n\tunsigned int i;\n\n\t/* This should always be true, but let's be sure. */\n\tinfo->sechdrs[0].sh_addr = 0;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\tif (shdr->sh_type != SHT_NOBITS\n\t\t    && info->len < shdr->sh_offset + shdr->sh_size) {\n\t\t\tpr_err(\"Module len %lu truncated\\n\", info->len);\n\t\t\treturn -ENOEXEC;\n\t\t}\n\n\t\t/* Mark all sections sh_addr with their address in the\n\t\t   temporary image. */\n\t\tshdr->sh_addr = (size_t)info->hdr + shdr->sh_offset;\n\n#ifndef CONFIG_MODULE_UNLOAD\n\t\t/* Don't load .exit sections */\n\t\tif (strstarts(info->secstrings+shdr->sh_name, \".exit\"))\n\t\t\tshdr->sh_flags &= ~(unsigned long)SHF_ALLOC;\n#endif\n\t}\n\n\t/* Track but don't keep modinfo and version sections. */\n\tinfo->sechdrs[info->index.vers].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\tinfo->sechdrs[info->index.info].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strstarts",
          "args": [
            "info->secstrings+shdr->sh_name",
            "\".exit\""
          ],
          "line": 2925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Module len %lu truncated\\n\"",
            "info->len"
          ],
          "line": 2915
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int rewrite_section_headers(struct load_info *info, int flags)\n{\n\tunsigned int i;\n\n\t/* This should always be true, but let's be sure. */\n\tinfo->sechdrs[0].sh_addr = 0;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\tif (shdr->sh_type != SHT_NOBITS\n\t\t    && info->len < shdr->sh_offset + shdr->sh_size) {\n\t\t\tpr_err(\"Module len %lu truncated\\n\", info->len);\n\t\t\treturn -ENOEXEC;\n\t\t}\n\n\t\t/* Mark all sections sh_addr with their address in the\n\t\t   temporary image. */\n\t\tshdr->sh_addr = (size_t)info->hdr + shdr->sh_offset;\n\n#ifndef CONFIG_MODULE_UNLOAD\n\t\t/* Don't load .exit sections */\n\t\tif (strstarts(info->secstrings+shdr->sh_name, \".exit\"))\n\t\t\tshdr->sh_flags &= ~(unsigned long)SHF_ALLOC;\n#endif\n\t}\n\n\t/* Track but don't keep modinfo and version sections. */\n\tinfo->sechdrs[info->index.vers].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\tinfo->sechdrs[info->index.info].sh_flags &= ~(unsigned long)SHF_ALLOC;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "free_copy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2899-2902",
    "snippet": "static void free_copy(struct load_info *info)\n{\n\tvfree(info->hdr);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfree",
          "args": [
            "info->hdr"
          ],
          "line": 2901
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_copy(struct load_info *info)\n{\n\tvfree(info->hdr);\n}"
  },
  {
    "function_name": "copy_module_from_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2872-2897",
    "snippet": "static int copy_module_from_user(const void __user *umod, unsigned long len,\n\t\t\t\t  struct load_info *info)\n{\n\tint err;\n\n\tinfo->len = len;\n\tif (info->len < sizeof(*(info->hdr)))\n\t\treturn -ENOEXEC;\n\n\terr = security_kernel_load_data(LOADING_MODULE);\n\tif (err)\n\t\treturn err;\n\n\t/* Suck in entire file: we'll want most of it. */\n\tinfo->hdr = __vmalloc(info->len,\n\t\t\tGFP_KERNEL | __GFP_NOWARN, PAGE_KERNEL);\n\tif (!info->hdr)\n\t\treturn -ENOMEM;\n\n\tif (copy_chunked_from_user(info->hdr, umod, info->len) != 0) {\n\t\tvfree(info->hdr);\n\t\treturn -EFAULT;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfree",
          "args": [
            "info->hdr"
          ],
          "line": 2892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_chunked_from_user",
          "args": [
            "info->hdr",
            "umod",
            "info->len"
          ],
          "line": 2891
        },
        "resolved": true,
        "details": {
          "function_name": "copy_chunked_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2822-2835",
          "snippet": "static int copy_chunked_from_user(void *dst, const void __user *usrc, unsigned long len)\n{\n\tdo {\n\t\tunsigned long n = min(len, COPY_CHUNK_SIZE);\n\n\t\tif (copy_from_user(dst, usrc, n) != 0)\n\t\t\treturn -EFAULT;\n\t\tcond_resched();\n\t\tdst += n;\n\t\tusrc += n;\n\t\tlen -= n;\n\t} while (len);\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define COPY_CHUNK_SIZE (16*PAGE_SIZE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define COPY_CHUNK_SIZE (16*PAGE_SIZE)\n\nstatic int copy_chunked_from_user(void *dst, const void __user *usrc, unsigned long len)\n{\n\tdo {\n\t\tunsigned long n = min(len, COPY_CHUNK_SIZE);\n\n\t\tif (copy_from_user(dst, usrc, n) != 0)\n\t\t\treturn -EFAULT;\n\t\tcond_resched();\n\t\tdst += n;\n\t\tusrc += n;\n\t\tlen -= n;\n\t} while (len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__vmalloc",
          "args": [
            "info->len",
            "GFP_KERNEL | __GFP_NOWARN",
            "PAGE_KERNEL"
          ],
          "line": 2886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_kernel_load_data",
          "args": [
            "LOADING_MODULE"
          ],
          "line": 2881
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int copy_module_from_user(const void __user *umod, unsigned long len,\n\t\t\t\t  struct load_info *info)\n{\n\tint err;\n\n\tinfo->len = len;\n\tif (info->len < sizeof(*(info->hdr)))\n\t\treturn -ENOEXEC;\n\n\terr = security_kernel_load_data(LOADING_MODULE);\n\tif (err)\n\t\treturn err;\n\n\t/* Suck in entire file: we'll want most of it. */\n\tinfo->hdr = __vmalloc(info->len,\n\t\t\tGFP_KERNEL | __GFP_NOWARN, PAGE_KERNEL);\n\tif (!info->hdr)\n\t\treturn -ENOMEM;\n\n\tif (copy_chunked_from_user(info->hdr, umod, info->len) != 0) {\n\t\tvfree(info->hdr);\n\t\treturn -EFAULT;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "check_modinfo_retpoline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2862-2869",
    "snippet": "static void check_modinfo_retpoline(struct module *mod, struct load_info *info)\n{\n\tif (retpoline_module_ok(get_modinfo(info, \"retpoline\")))\n\t\treturn;\n\n\tpr_warn(\"%s: loading module not compiled with retpoline compiler.\\n\",\n\t\tmod->name);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: loading module not compiled with retpoline compiler.\\n\"",
            "mod->name"
          ],
          "line": 2867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "retpoline_module_ok",
          "args": [
            "get_modinfo(info, \"retpoline\")"
          ],
          "line": 2864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_modinfo",
          "args": [
            "info",
            "\"retpoline\""
          ],
          "line": 2864
        },
        "resolved": true,
        "details": {
          "function_name": "get_modinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2480-2496",
          "snippet": "static char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void check_modinfo_retpoline(struct module *mod, struct load_info *info)\n{\n\tif (retpoline_module_ok(get_modinfo(info, \"retpoline\")))\n\t\treturn;\n\n\tpr_warn(\"%s: loading module not compiled with retpoline compiler.\\n\",\n\t\tmod->name);\n}"
  },
  {
    "function_name": "check_modinfo_livepatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2850-2859",
    "snippet": "static int check_modinfo_livepatch(struct module *mod, struct load_info *info)\n{\n\tif (get_modinfo(info, \"livepatch\")) {\n\t\tpr_err(\"%s: module is marked as livepatch module, but livepatch support is disabled\",\n\t\t       mod->name);\n\t\treturn -ENOEXEC;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s: module is marked as livepatch module, but livepatch support is disabled\"",
            "mod->name"
          ],
          "line": 2853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_modinfo",
          "args": [
            "info",
            "\"livepatch\""
          ],
          "line": 2852
        },
        "resolved": true,
        "details": {
          "function_name": "get_modinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2480-2496",
          "snippet": "static char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int check_modinfo_livepatch(struct module *mod, struct load_info *info)\n{\n\tif (get_modinfo(info, \"livepatch\")) {\n\t\tpr_err(\"%s: module is marked as livepatch module, but livepatch support is disabled\",\n\t\t       mod->name);\n\t\treturn -ENOEXEC;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "check_modinfo_livepatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2838-2848",
    "snippet": "static int check_modinfo_livepatch(struct module *mod, struct load_info *info)\n{\n\tif (get_modinfo(info, \"livepatch\")) {\n\t\tmod->klp = true;\n\t\tadd_taint_module(mod, TAINT_LIVEPATCH, LOCKDEP_STILL_OK);\n\t\tpr_notice_once(\"%s: tainting kernel with TAINT_LIVEPATCH\\n\",\n\t\t\t       mod->name);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_notice_once",
          "args": [
            "\"%s: tainting kernel with TAINT_LIVEPATCH\\n\"",
            "mod->name"
          ],
          "line": 2843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_taint_module",
          "args": [
            "mod",
            "TAINT_LIVEPATCH",
            "LOCKDEP_STILL_OK"
          ],
          "line": 2842
        },
        "resolved": true,
        "details": {
          "function_name": "add_taint_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "326-331",
          "snippet": "static inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_modinfo",
          "args": [
            "info",
            "\"livepatch\""
          ],
          "line": 2840
        },
        "resolved": true,
        "details": {
          "function_name": "get_modinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2480-2496",
          "snippet": "static char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int check_modinfo_livepatch(struct module *mod, struct load_info *info)\n{\n\tif (get_modinfo(info, \"livepatch\")) {\n\t\tmod->klp = true;\n\t\tadd_taint_module(mod, TAINT_LIVEPATCH, LOCKDEP_STILL_OK);\n\t\tpr_notice_once(\"%s: tainting kernel with TAINT_LIVEPATCH\\n\",\n\t\t\t       mod->name);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "copy_chunked_from_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2822-2835",
    "snippet": "static int copy_chunked_from_user(void *dst, const void __user *usrc, unsigned long len)\n{\n\tdo {\n\t\tunsigned long n = min(len, COPY_CHUNK_SIZE);\n\n\t\tif (copy_from_user(dst, usrc, n) != 0)\n\t\t\treturn -EFAULT;\n\t\tcond_resched();\n\t\tdst += n;\n\t\tusrc += n;\n\t\tlen -= n;\n\t} while (len);\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define COPY_CHUNK_SIZE (16*PAGE_SIZE)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 2829
        },
        "resolved": true,
        "details": {
          "function_name": "_cond_resched",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "4957-4965",
          "snippet": "int __sched _cond_resched(void)\n{\n\tif (should_resched(0)) {\n\t\tpreempt_schedule_common();\n\t\treturn 1;\n\t}\n\trcu_all_qs();\n\treturn 0;\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nint __sched _cond_resched(void)\n{\n\tif (should_resched(0)) {\n\t\tpreempt_schedule_common();\n\t\treturn 1;\n\t}\n\trcu_all_qs();\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "dst",
            "usrc",
            "n"
          ],
          "line": 2827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "len",
            "COPY_CHUNK_SIZE"
          ],
          "line": 2825
        },
        "resolved": true,
        "details": {
          "function_name": "irq_setup_timings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/internals.h",
          "lines": "374-375",
          "snippet": "static inline void irq_setup_timings(struct irq_desc *desc,\n\t\t\t\t     struct irqaction *act) {}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void __disable_irq(struct irq_desc *desc);",
            "extern void __enable_irq(struct irq_desc *desc);",
            "extern int irq_activate(struct irq_desc *desc);",
            "extern void irq_shutdown(struct irq_desc *desc);",
            "extern void irq_enable(struct irq_desc *desc);",
            "extern void irq_disable(struct irq_desc *desc);",
            "extern void mask_irq(struct irq_desc *desc);",
            "extern void unmask_irq(struct irq_desc *desc);",
            "extern void unmask_threaded_irq(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event(struct irq_desc *desc);",
            "void check_irq_resend(struct irq_desc *desc);",
            "bool irq_wait_for_poll(struct irq_desc *desc);",
            "extern void irq_set_thread_affinity(struct irq_desc *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nextern void __disable_irq(struct irq_desc *desc);\nextern void __enable_irq(struct irq_desc *desc);\nextern int irq_activate(struct irq_desc *desc);\nextern void irq_shutdown(struct irq_desc *desc);\nextern void irq_enable(struct irq_desc *desc);\nextern void irq_disable(struct irq_desc *desc);\nextern void mask_irq(struct irq_desc *desc);\nextern void unmask_irq(struct irq_desc *desc);\nextern void unmask_threaded_irq(struct irq_desc *desc);\nirqreturn_t handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event(struct irq_desc *desc);\nvoid check_irq_resend(struct irq_desc *desc);\nbool irq_wait_for_poll(struct irq_desc *desc);\nextern void irq_set_thread_affinity(struct irq_desc *desc);\n\nstatic inline void irq_setup_timings(struct irq_desc *desc,\n\t\t\t\t     struct irqaction *act) {}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define COPY_CHUNK_SIZE (16*PAGE_SIZE)\n\nstatic int copy_chunked_from_user(void *dst, const void __user *usrc, unsigned long len)\n{\n\tdo {\n\t\tunsigned long n = min(len, COPY_CHUNK_SIZE);\n\n\t\tif (copy_from_user(dst, usrc, n) != 0)\n\t\t\treturn -EFAULT;\n\t\tcond_resched();\n\t\tdst += n;\n\t\tusrc += n;\n\t\tlen -= n;\n\t} while (len);\n\treturn 0;\n}"
  },
  {
    "function_name": "elf_header_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2801-2818",
    "snippet": "static int elf_header_check(struct load_info *info)\n{\n\tif (info->len < sizeof(*(info->hdr)))\n\t\treturn -ENOEXEC;\n\n\tif (memcmp(info->hdr->e_ident, ELFMAG, SELFMAG) != 0\n\t    || info->hdr->e_type != ET_REL\n\t    || !elf_check_arch(info->hdr)\n\t    || info->hdr->e_shentsize != sizeof(Elf_Shdr))\n\t\treturn -ENOEXEC;\n\n\tif (info->hdr->e_shoff >= info->len\n\t    || (info->hdr->e_shnum * sizeof(Elf_Shdr) >\n\t\tinfo->len - info->hdr->e_shoff))\n\t\treturn -ENOEXEC;\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "elf_check_arch",
          "args": [
            "info->hdr"
          ],
          "line": 2808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "info->hdr->e_ident",
            "ELFMAG",
            "SELFMAG"
          ],
          "line": 2806
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int elf_header_check(struct load_info *info)\n{\n\tif (info->len < sizeof(*(info->hdr)))\n\t\treturn -ENOEXEC;\n\n\tif (memcmp(info->hdr->e_ident, ELFMAG, SELFMAG) != 0\n\t    || info->hdr->e_type != ET_REL\n\t    || !elf_check_arch(info->hdr)\n\t    || info->hdr->e_shentsize != sizeof(Elf_Shdr))\n\t\treturn -ENOEXEC;\n\n\tif (info->hdr->e_shoff >= info->len\n\t    || (info->hdr->e_shnum * sizeof(Elf_Shdr) >\n\t\tinfo->len - info->hdr->e_shoff))\n\t\treturn -ENOEXEC;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "module_sig_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2794-2797",
    "snippet": "static int module_sig_check(struct load_info *info, int flags)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int module_sig_check(struct load_info *info, int flags)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "module_sig_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2764-2792",
    "snippet": "static int module_sig_check(struct load_info *info, int flags)\n{\n\tint err = -ENOKEY;\n\tconst unsigned long markerlen = sizeof(MODULE_SIG_STRING) - 1;\n\tconst void *mod = info->hdr;\n\n\t/*\n\t * Require flags == 0, as a module with version information\n\t * removed is no longer the module that was signed\n\t */\n\tif (flags == 0 &&\n\t    info->len > markerlen &&\n\t    memcmp(mod + info->len - markerlen, MODULE_SIG_STRING, markerlen) == 0) {\n\t\t/* We truncate the module to discard the signature */\n\t\tinfo->len -= markerlen;\n\t\terr = mod_verify_sig(mod, info);\n\t}\n\n\tif (!err) {\n\t\tinfo->sig_ok = true;\n\t\treturn 0;\n\t}\n\n\t/* Not having a signature is only an error if we're strict. */\n\tif (err == -ENOKEY && !is_module_sig_enforced())\n\t\terr = 0;\n\n\treturn err;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_module_sig_enforced",
          "args": [],
          "line": 2788
        },
        "resolved": true,
        "details": {
          "function_name": "is_module_sig_enforced",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "283-286",
          "snippet": "bool is_module_sig_enforced(void)\n{\n\treturn sig_enforce;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool sig_enforce = IS_ENABLED(CONFIG_MODULE_SIG_FORCE);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic bool sig_enforce = IS_ENABLED(CONFIG_MODULE_SIG_FORCE);\n\nbool is_module_sig_enforced(void)\n{\n\treturn sig_enforce;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mod_verify_sig",
          "args": [
            "mod",
            "info"
          ],
          "line": 2779
        },
        "resolved": true,
        "details": {
          "function_name": "mod_verify_sig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module_signing.c",
          "lines": "48-88",
          "snippet": "int mod_verify_sig(const void *mod, struct load_info *info)\n{\n\tstruct module_signature ms;\n\tsize_t sig_len, modlen = info->len;\n\n\tpr_devel(\"==>%s(,%zu)\\n\", __func__, modlen);\n\n\tif (modlen <= sizeof(ms))\n\t\treturn -EBADMSG;\n\n\tmemcpy(&ms, mod + (modlen - sizeof(ms)), sizeof(ms));\n\tmodlen -= sizeof(ms);\n\n\tsig_len = be32_to_cpu(ms.sig_len);\n\tif (sig_len >= modlen)\n\t\treturn -EBADMSG;\n\tmodlen -= sig_len;\n\tinfo->len = modlen;\n\n\tif (ms.id_type != PKEY_ID_PKCS7) {\n\t\tpr_err(\"%s: Module is not signed with expected PKCS#7 message\\n\",\n\t\t       info->name);\n\t\treturn -ENOPKG;\n\t}\n\n\tif (ms.algo != 0 ||\n\t    ms.hash != 0 ||\n\t    ms.signer_len != 0 ||\n\t    ms.key_id_len != 0 ||\n\t    ms.__pad[0] != 0 ||\n\t    ms.__pad[1] != 0 ||\n\t    ms.__pad[2] != 0) {\n\t\tpr_err(\"%s: PKCS#7 signature info has unexpected non-zero params\\n\",\n\t\t       info->name);\n\t\treturn -EBADMSG;\n\t}\n\n\treturn verify_pkcs7_signature(mod, modlen, mod + modlen, sig_len,\n\t\t\t\t      NULL, VERIFYING_MODULE_SIGNATURE,\n\t\t\t\t      NULL, NULL);\n}",
          "includes": [
            "#include \"module-internal.h\"",
            "#include <crypto/public_key.h>",
            "#include <linux/verification.h>",
            "#include <linux/string.h>",
            "#include <linux/errno.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"module-internal.h\"\n#include <crypto/public_key.h>\n#include <linux/verification.h>\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/kernel.h>\n\nint mod_verify_sig(const void *mod, struct load_info *info)\n{\n\tstruct module_signature ms;\n\tsize_t sig_len, modlen = info->len;\n\n\tpr_devel(\"==>%s(,%zu)\\n\", __func__, modlen);\n\n\tif (modlen <= sizeof(ms))\n\t\treturn -EBADMSG;\n\n\tmemcpy(&ms, mod + (modlen - sizeof(ms)), sizeof(ms));\n\tmodlen -= sizeof(ms);\n\n\tsig_len = be32_to_cpu(ms.sig_len);\n\tif (sig_len >= modlen)\n\t\treturn -EBADMSG;\n\tmodlen -= sig_len;\n\tinfo->len = modlen;\n\n\tif (ms.id_type != PKEY_ID_PKCS7) {\n\t\tpr_err(\"%s: Module is not signed with expected PKCS#7 message\\n\",\n\t\t       info->name);\n\t\treturn -ENOPKG;\n\t}\n\n\tif (ms.algo != 0 ||\n\t    ms.hash != 0 ||\n\t    ms.signer_len != 0 ||\n\t    ms.key_id_len != 0 ||\n\t    ms.__pad[0] != 0 ||\n\t    ms.__pad[1] != 0 ||\n\t    ms.__pad[2] != 0) {\n\t\tpr_err(\"%s: PKCS#7 signature info has unexpected non-zero params\\n\",\n\t\t       info->name);\n\t\treturn -EBADMSG;\n\t}\n\n\treturn verify_pkcs7_signature(mod, modlen, mod + modlen, sig_len,\n\t\t\t\t      NULL, VERIFYING_MODULE_SIGNATURE,\n\t\t\t\t      NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "mod + info->len - markerlen",
            "MODULE_SIG_STRING",
            "markerlen"
          ],
          "line": 2776
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int module_sig_check(struct load_info *info, int flags)\n{\n\tint err = -ENOKEY;\n\tconst unsigned long markerlen = sizeof(MODULE_SIG_STRING) - 1;\n\tconst void *mod = info->hdr;\n\n\t/*\n\t * Require flags == 0, as a module with version information\n\t * removed is no longer the module that was signed\n\t */\n\tif (flags == 0 &&\n\t    info->len > markerlen &&\n\t    memcmp(mod + info->len - markerlen, MODULE_SIG_STRING, markerlen) == 0) {\n\t\t/* We truncate the module to discard the signature */\n\t\tinfo->len -= markerlen;\n\t\terr = mod_verify_sig(mod, info);\n\t}\n\n\tif (!err) {\n\t\tinfo->sig_ok = true;\n\t\treturn 0;\n\t}\n\n\t/* Not having a signature is only an error if we're strict. */\n\tif (err == -ENOKEY && !is_module_sig_enforced())\n\t\terr = 0;\n\n\treturn err;\n}"
  },
  {
    "function_name": "kmemleak_load_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2757-2760",
    "snippet": "static inline void kmemleak_load_module(const struct module *mod,\n\t\t\t\t\tconst struct load_info *info)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void kmemleak_load_module(const struct module *mod,\n\t\t\t\t\tconst struct load_info *info)\n{\n}"
  },
  {
    "function_name": "kmemleak_load_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2737-2755",
    "snippet": "static void kmemleak_load_module(const struct module *mod,\n\t\t\t\t const struct load_info *info)\n{\n\tunsigned int i;\n\n\t/* only scan the sections containing data */\n\tkmemleak_scan_area(mod, sizeof(struct module), GFP_KERNEL);\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\t/* Scan all writable sections that's not executable */\n\t\tif (!(info->sechdrs[i].sh_flags & SHF_ALLOC) ||\n\t\t    !(info->sechdrs[i].sh_flags & SHF_WRITE) ||\n\t\t    (info->sechdrs[i].sh_flags & SHF_EXECINSTR))\n\t\t\tcontinue;\n\n\t\tkmemleak_scan_area((void *)info->sechdrs[i].sh_addr,\n\t\t\t\t   info->sechdrs[i].sh_size, GFP_KERNEL);\n\t}\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmemleak_scan_area",
          "args": [
            "(void *)info->sechdrs[i].sh_addr",
            "info->sechdrs[i].sh_size",
            "GFP_KERNEL"
          ],
          "line": 2752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmemleak_scan_area",
          "args": [
            "mod",
            "sizeof(struct module)",
            "GFP_KERNEL"
          ],
          "line": 2743
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void kmemleak_load_module(const struct module *mod,\n\t\t\t\t const struct load_info *info)\n{\n\tunsigned int i;\n\n\t/* only scan the sections containing data */\n\tkmemleak_scan_area(mod, sizeof(struct module), GFP_KERNEL);\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\t/* Scan all writable sections that's not executable */\n\t\tif (!(info->sechdrs[i].sh_flags & SHF_ALLOC) ||\n\t\t    !(info->sechdrs[i].sh_flags & SHF_WRITE) ||\n\t\t    (info->sechdrs[i].sh_flags & SHF_EXECINSTR))\n\t\t\tcontinue;\n\n\t\tkmemleak_scan_area((void *)info->sechdrs[i].sh_addr,\n\t\t\t\t   info->sechdrs[i].sh_size, GFP_KERNEL);\n\t}\n}"
  },
  {
    "function_name": "module_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2731-2734",
    "snippet": "void * __weak module_alloc(unsigned long size)\n{\n\treturn vmalloc_exec(size);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vmalloc_exec",
          "args": [
            "size"
          ],
          "line": 2733
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid * __weak module_alloc(unsigned long size)\n{\n\treturn vmalloc_exec(size);\n}"
  },
  {
    "function_name": "dynamic_debug_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2725-2729",
    "snippet": "static void dynamic_debug_remove(struct module *mod, struct _ddebug *debug)\n{\n\tif (debug)\n\t\tddebug_remove_module(mod->name);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ddebug_remove_module",
          "args": [
            "mod->name"
          ],
          "line": 2728
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void dynamic_debug_remove(struct module *mod, struct _ddebug *debug)\n{\n\tif (debug)\n\t\tddebug_remove_module(mod->name);\n}"
  },
  {
    "function_name": "dynamic_debug_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2714-2723",
    "snippet": "static void dynamic_debug_setup(struct module *mod, struct _ddebug *debug, unsigned int num)\n{\n\tif (!debug)\n\t\treturn;\n#ifdef CONFIG_DYNAMIC_DEBUG\n\tif (ddebug_add_module(debug, num, mod->name))\n\t\tpr_err(\"dynamic debug error adding module: %s\\n\",\n\t\t\tdebug->modname);\n#endif\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"dynamic debug error adding module: %s\\n\"",
            "debug->modname"
          ],
          "line": 2720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddebug_add_module",
          "args": [
            "debug",
            "num",
            "mod->name"
          ],
          "line": 2719
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void dynamic_debug_setup(struct module *mod, struct _ddebug *debug, unsigned int num)\n{\n\tif (!debug)\n\t\treturn;\n#ifdef CONFIG_DYNAMIC_DEBUG\n\tif (ddebug_add_module(debug, num, mod->name))\n\t\tpr_err(\"dynamic debug error adding module: %s\\n\",\n\t\t\tdebug->modname);\n#endif\n}"
  },
  {
    "function_name": "add_kallsyms",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2709-2711",
    "snippet": "static void add_kallsyms(struct module *mod, const struct load_info *info)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void add_kallsyms(struct module *mod, const struct load_info *info)\n{\n}"
  },
  {
    "function_name": "layout_symtab",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2705-2707",
    "snippet": "static inline void layout_symtab(struct module *mod, struct load_info *info)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void layout_symtab(struct module *mod, struct load_info *info)\n{\n}"
  },
  {
    "function_name": "add_kallsyms",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2667-2703",
    "snippet": "static void add_kallsyms(struct module *mod, const struct load_info *info)\n{\n\tunsigned int i, ndst;\n\tconst Elf_Sym *src;\n\tElf_Sym *dst;\n\tchar *s;\n\tElf_Shdr *symsec = &info->sechdrs[info->index.sym];\n\n\t/* Set up to point into init section. */\n\tmod->kallsyms = mod->init_layout.base + info->mod_kallsyms_init_off;\n\n\tmod->kallsyms->symtab = (void *)symsec->sh_addr;\n\tmod->kallsyms->num_symtab = symsec->sh_size / sizeof(Elf_Sym);\n\t/* Make sure we get permanent strtab: don't use info->strtab. */\n\tmod->kallsyms->strtab = (void *)info->sechdrs[info->index.str].sh_addr;\n\n\t/* Set types up while we still have access to sections. */\n\tfor (i = 0; i < mod->kallsyms->num_symtab; i++)\n\t\tmod->kallsyms->symtab[i].st_info\n\t\t\t= elf_type(&mod->kallsyms->symtab[i], info);\n\n\t/* Now populate the cut down core kallsyms for after init. */\n\tmod->core_kallsyms.symtab = dst = mod->core_layout.base + info->symoffs;\n\tmod->core_kallsyms.strtab = s = mod->core_layout.base + info->stroffs;\n\tsrc = mod->kallsyms->symtab;\n\tfor (ndst = i = 0; i < mod->kallsyms->num_symtab; i++) {\n\t\tif (i == 0 || is_livepatch_module(mod) ||\n\t\t    is_core_symbol(src+i, info->sechdrs, info->hdr->e_shnum,\n\t\t\t\t   info->index.pcpu)) {\n\t\t\tdst[ndst] = src[i];\n\t\t\tdst[ndst++].st_name = s - mod->core_kallsyms.strtab;\n\t\t\ts += strlcpy(s, &mod->kallsyms->strtab[src[i].st_name],\n\t\t\t\t     KSYM_NAME_LEN) + 1;\n\t\t}\n\t}\n\tmod->core_kallsyms.num_symtab = ndst;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "s",
            "&mod->kallsyms->strtab[src[i].st_name]",
            "KSYM_NAME_LEN"
          ],
          "line": 2698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_core_symbol",
          "args": [
            "src+i",
            "info->sechdrs",
            "info->hdr->e_shnum",
            "info->index.pcpu"
          ],
          "line": 2694
        },
        "resolved": true,
        "details": {
          "function_name": "is_core_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2583-2607",
          "snippet": "static bool is_core_symbol(const Elf_Sym *src, const Elf_Shdr *sechdrs,\n\t\t\tunsigned int shnum, unsigned int pcpundx)\n{\n\tconst Elf_Shdr *sec;\n\n\tif (src->st_shndx == SHN_UNDEF\n\t    || src->st_shndx >= shnum\n\t    || !src->st_name)\n\t\treturn false;\n\n#ifdef CONFIG_KALLSYMS_ALL\n\tif (src->st_shndx == pcpundx)\n\t\treturn true;\n#endif\n\n\tsec = sechdrs + src->st_shndx;\n\tif (!(sec->sh_flags & SHF_ALLOC)\n#ifndef CONFIG_KALLSYMS_ALL\n\t    || !(sec->sh_flags & SHF_EXECINSTR)\n#endif\n\t    || (sec->sh_entsize & INIT_OFFSET_MASK))\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))\n\nstatic bool is_core_symbol(const Elf_Sym *src, const Elf_Shdr *sechdrs,\n\t\t\tunsigned int shnum, unsigned int pcpundx)\n{\n\tconst Elf_Shdr *sec;\n\n\tif (src->st_shndx == SHN_UNDEF\n\t    || src->st_shndx >= shnum\n\t    || !src->st_name)\n\t\treturn false;\n\n#ifdef CONFIG_KALLSYMS_ALL\n\tif (src->st_shndx == pcpundx)\n\t\treturn true;\n#endif\n\n\tsec = sechdrs + src->st_shndx;\n\tif (!(sec->sh_flags & SHF_ALLOC)\n#ifndef CONFIG_KALLSYMS_ALL\n\t    || !(sec->sh_flags & SHF_EXECINSTR)\n#endif\n\t    || (sec->sh_entsize & INIT_OFFSET_MASK))\n\t\treturn false;\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_livepatch_module",
          "args": [
            "mod"
          ],
          "line": 2693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elf_type",
          "args": [
            "&mod->kallsyms->symtab[i]",
            "info"
          ],
          "line": 2686
        },
        "resolved": true,
        "details": {
          "function_name": "elf_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2543-2581",
          "snippet": "static char elf_type(const Elf_Sym *sym, const struct load_info *info)\n{\n\tconst Elf_Shdr *sechdrs = info->sechdrs;\n\n\tif (ELF_ST_BIND(sym->st_info) == STB_WEAK) {\n\t\tif (ELF_ST_TYPE(sym->st_info) == STT_OBJECT)\n\t\t\treturn 'v';\n\t\telse\n\t\t\treturn 'w';\n\t}\n\tif (sym->st_shndx == SHN_UNDEF)\n\t\treturn 'U';\n\tif (sym->st_shndx == SHN_ABS || sym->st_shndx == info->index.pcpu)\n\t\treturn 'a';\n\tif (sym->st_shndx >= SHN_LORESERVE)\n\t\treturn '?';\n\tif (sechdrs[sym->st_shndx].sh_flags & SHF_EXECINSTR)\n\t\treturn 't';\n\tif (sechdrs[sym->st_shndx].sh_flags & SHF_ALLOC\n\t    && sechdrs[sym->st_shndx].sh_type != SHT_NOBITS) {\n\t\tif (!(sechdrs[sym->st_shndx].sh_flags & SHF_WRITE))\n\t\t\treturn 'r';\n\t\telse if (sechdrs[sym->st_shndx].sh_flags & ARCH_SHF_SMALL)\n\t\t\treturn 'g';\n\t\telse\n\t\t\treturn 'd';\n\t}\n\tif (sechdrs[sym->st_shndx].sh_type == SHT_NOBITS) {\n\t\tif (sechdrs[sym->st_shndx].sh_flags & ARCH_SHF_SMALL)\n\t\t\treturn 's';\n\t\telse\n\t\t\treturn 'b';\n\t}\n\tif (strstarts(info->secstrings + sechdrs[sym->st_shndx].sh_name,\n\t\t      \".debug\")) {\n\t\treturn 'n';\n\t}\n\treturn '?';\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define ARCH_SHF_SMALL 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define ARCH_SHF_SMALL 0\n\nstatic char elf_type(const Elf_Sym *sym, const struct load_info *info)\n{\n\tconst Elf_Shdr *sechdrs = info->sechdrs;\n\n\tif (ELF_ST_BIND(sym->st_info) == STB_WEAK) {\n\t\tif (ELF_ST_TYPE(sym->st_info) == STT_OBJECT)\n\t\t\treturn 'v';\n\t\telse\n\t\t\treturn 'w';\n\t}\n\tif (sym->st_shndx == SHN_UNDEF)\n\t\treturn 'U';\n\tif (sym->st_shndx == SHN_ABS || sym->st_shndx == info->index.pcpu)\n\t\treturn 'a';\n\tif (sym->st_shndx >= SHN_LORESERVE)\n\t\treturn '?';\n\tif (sechdrs[sym->st_shndx].sh_flags & SHF_EXECINSTR)\n\t\treturn 't';\n\tif (sechdrs[sym->st_shndx].sh_flags & SHF_ALLOC\n\t    && sechdrs[sym->st_shndx].sh_type != SHT_NOBITS) {\n\t\tif (!(sechdrs[sym->st_shndx].sh_flags & SHF_WRITE))\n\t\t\treturn 'r';\n\t\telse if (sechdrs[sym->st_shndx].sh_flags & ARCH_SHF_SMALL)\n\t\t\treturn 'g';\n\t\telse\n\t\t\treturn 'd';\n\t}\n\tif (sechdrs[sym->st_shndx].sh_type == SHT_NOBITS) {\n\t\tif (sechdrs[sym->st_shndx].sh_flags & ARCH_SHF_SMALL)\n\t\t\treturn 's';\n\t\telse\n\t\t\treturn 'b';\n\t}\n\tif (strstarts(info->secstrings + sechdrs[sym->st_shndx].sh_name,\n\t\t      \".debug\")) {\n\t\treturn 'n';\n\t}\n\treturn '?';\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void add_kallsyms(struct module *mod, const struct load_info *info)\n{\n\tunsigned int i, ndst;\n\tconst Elf_Sym *src;\n\tElf_Sym *dst;\n\tchar *s;\n\tElf_Shdr *symsec = &info->sechdrs[info->index.sym];\n\n\t/* Set up to point into init section. */\n\tmod->kallsyms = mod->init_layout.base + info->mod_kallsyms_init_off;\n\n\tmod->kallsyms->symtab = (void *)symsec->sh_addr;\n\tmod->kallsyms->num_symtab = symsec->sh_size / sizeof(Elf_Sym);\n\t/* Make sure we get permanent strtab: don't use info->strtab. */\n\tmod->kallsyms->strtab = (void *)info->sechdrs[info->index.str].sh_addr;\n\n\t/* Set types up while we still have access to sections. */\n\tfor (i = 0; i < mod->kallsyms->num_symtab; i++)\n\t\tmod->kallsyms->symtab[i].st_info\n\t\t\t= elf_type(&mod->kallsyms->symtab[i], info);\n\n\t/* Now populate the cut down core kallsyms for after init. */\n\tmod->core_kallsyms.symtab = dst = mod->core_layout.base + info->symoffs;\n\tmod->core_kallsyms.strtab = s = mod->core_layout.base + info->stroffs;\n\tsrc = mod->kallsyms->symtab;\n\tfor (ndst = i = 0; i < mod->kallsyms->num_symtab; i++) {\n\t\tif (i == 0 || is_livepatch_module(mod) ||\n\t\t    is_core_symbol(src+i, info->sechdrs, info->hdr->e_shnum,\n\t\t\t\t   info->index.pcpu)) {\n\t\t\tdst[ndst] = src[i];\n\t\t\tdst[ndst++].st_name = s - mod->core_kallsyms.strtab;\n\t\t\ts += strlcpy(s, &mod->kallsyms->strtab[src[i].st_name],\n\t\t\t\t     KSYM_NAME_LEN) + 1;\n\t\t}\n\t}\n\tmod->core_kallsyms.num_symtab = ndst;\n}"
  },
  {
    "function_name": "layout_symtab",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2616-2660",
    "snippet": "static void layout_symtab(struct module *mod, struct load_info *info)\n{\n\tElf_Shdr *symsect = info->sechdrs + info->index.sym;\n\tElf_Shdr *strsect = info->sechdrs + info->index.str;\n\tconst Elf_Sym *src;\n\tunsigned int i, nsrc, ndst, strtab_size = 0;\n\n\t/* Put symbol section at end of init part of module. */\n\tsymsect->sh_flags |= SHF_ALLOC;\n\tsymsect->sh_entsize = get_offset(mod, &mod->init_layout.size, symsect,\n\t\t\t\t\t info->index.sym) | INIT_OFFSET_MASK;\n\tpr_debug(\"\\t%s\\n\", info->secstrings + symsect->sh_name);\n\n\tsrc = (void *)info->hdr + symsect->sh_offset;\n\tnsrc = symsect->sh_size / sizeof(*src);\n\n\t/* Compute total space required for the core symbols' strtab. */\n\tfor (ndst = i = 0; i < nsrc; i++) {\n\t\tif (i == 0 || is_livepatch_module(mod) ||\n\t\t    is_core_symbol(src+i, info->sechdrs, info->hdr->e_shnum,\n\t\t\t\t   info->index.pcpu)) {\n\t\t\tstrtab_size += strlen(&info->strtab[src[i].st_name])+1;\n\t\t\tndst++;\n\t\t}\n\t}\n\n\t/* Append room for core symbols at end of core part. */\n\tinfo->symoffs = ALIGN(mod->core_layout.size, symsect->sh_addralign ?: 1);\n\tinfo->stroffs = mod->core_layout.size = info->symoffs + ndst * sizeof(Elf_Sym);\n\tmod->core_layout.size += strtab_size;\n\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\n\t/* Put string table section at end of init part of module. */\n\tstrsect->sh_flags |= SHF_ALLOC;\n\tstrsect->sh_entsize = get_offset(mod, &mod->init_layout.size, strsect,\n\t\t\t\t\t info->index.str) | INIT_OFFSET_MASK;\n\tpr_debug(\"\\t%s\\n\", info->secstrings + strsect->sh_name);\n\n\t/* We'll tack temporary mod_kallsyms on the end. */\n\tmod->init_layout.size = ALIGN(mod->init_layout.size,\n\t\t\t\t      __alignof__(struct mod_kallsyms));\n\tinfo->mod_kallsyms_init_off = mod->init_layout.size;\n\tmod->init_layout.size += sizeof(struct mod_kallsyms);\n\tmod->init_layout.size = debug_align(mod->init_layout.size);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug_align",
          "args": [
            "mod->init_layout.size"
          ],
          "line": 2659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "mod->init_layout.size",
            "__alignof__(struct mod_kallsyms)"
          ],
          "line": 2655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"\\t%s\\n\"",
            "info->secstrings + strsect->sh_name"
          ],
          "line": 2652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_offset",
          "args": [
            "mod",
            "&mod->init_layout.size",
            "strsect",
            "info->index.str"
          ],
          "line": 2650
        },
        "resolved": true,
        "details": {
          "function_name": "get_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2344-2353",
          "snippet": "static long get_offset(struct module *mod, unsigned int *size,\n\t\t       Elf_Shdr *sechdr, unsigned int section)\n{\n\tlong ret;\n\n\t*size += arch_mod_section_prepend(mod, section);\n\tret = ALIGN(*size, sechdr->sh_addralign ?: 1);\n\t*size = ret + sechdr->sh_size;\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic long get_offset(struct module *mod, unsigned int *size,\n\t\t       Elf_Shdr *sechdr, unsigned int section)\n{\n\tlong ret;\n\n\t*size += arch_mod_section_prepend(mod, section);\n\tret = ALIGN(*size, sechdr->sh_addralign ?: 1);\n\t*size = ret + sechdr->sh_size;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_align",
          "args": [
            "mod->core_layout.size"
          ],
          "line": 2646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "mod->core_layout.size",
            "symsect->sh_addralign ?: 1"
          ],
          "line": 2643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "&info->strtab[src[i].st_name]"
          ],
          "line": 2637
        },
        "resolved": true,
        "details": {
          "function_name": "fetch_store_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_uprobe.c",
          "lines": "137-146",
          "snippet": "static nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/string.h>",
            "#include <linux/namei.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include <linux/rculist.h>\n#include <linux/string.h>\n#include <linux/namei.h>\n#include <linux/uprobes.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n\nstatic nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_core_symbol",
          "args": [
            "src+i",
            "info->sechdrs",
            "info->hdr->e_shnum",
            "info->index.pcpu"
          ],
          "line": 2635
        },
        "resolved": true,
        "details": {
          "function_name": "is_core_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2583-2607",
          "snippet": "static bool is_core_symbol(const Elf_Sym *src, const Elf_Shdr *sechdrs,\n\t\t\tunsigned int shnum, unsigned int pcpundx)\n{\n\tconst Elf_Shdr *sec;\n\n\tif (src->st_shndx == SHN_UNDEF\n\t    || src->st_shndx >= shnum\n\t    || !src->st_name)\n\t\treturn false;\n\n#ifdef CONFIG_KALLSYMS_ALL\n\tif (src->st_shndx == pcpundx)\n\t\treturn true;\n#endif\n\n\tsec = sechdrs + src->st_shndx;\n\tif (!(sec->sh_flags & SHF_ALLOC)\n#ifndef CONFIG_KALLSYMS_ALL\n\t    || !(sec->sh_flags & SHF_EXECINSTR)\n#endif\n\t    || (sec->sh_entsize & INIT_OFFSET_MASK))\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))\n\nstatic bool is_core_symbol(const Elf_Sym *src, const Elf_Shdr *sechdrs,\n\t\t\tunsigned int shnum, unsigned int pcpundx)\n{\n\tconst Elf_Shdr *sec;\n\n\tif (src->st_shndx == SHN_UNDEF\n\t    || src->st_shndx >= shnum\n\t    || !src->st_name)\n\t\treturn false;\n\n#ifdef CONFIG_KALLSYMS_ALL\n\tif (src->st_shndx == pcpundx)\n\t\treturn true;\n#endif\n\n\tsec = sechdrs + src->st_shndx;\n\tif (!(sec->sh_flags & SHF_ALLOC)\n#ifndef CONFIG_KALLSYMS_ALL\n\t    || !(sec->sh_flags & SHF_EXECINSTR)\n#endif\n\t    || (sec->sh_entsize & INIT_OFFSET_MASK))\n\t\treturn false;\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_livepatch_module",
          "args": [
            "mod"
          ],
          "line": 2634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"\\t%s\\n\"",
            "info->secstrings + symsect->sh_name"
          ],
          "line": 2627
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))\n\nstatic void layout_symtab(struct module *mod, struct load_info *info)\n{\n\tElf_Shdr *symsect = info->sechdrs + info->index.sym;\n\tElf_Shdr *strsect = info->sechdrs + info->index.str;\n\tconst Elf_Sym *src;\n\tunsigned int i, nsrc, ndst, strtab_size = 0;\n\n\t/* Put symbol section at end of init part of module. */\n\tsymsect->sh_flags |= SHF_ALLOC;\n\tsymsect->sh_entsize = get_offset(mod, &mod->init_layout.size, symsect,\n\t\t\t\t\t info->index.sym) | INIT_OFFSET_MASK;\n\tpr_debug(\"\\t%s\\n\", info->secstrings + symsect->sh_name);\n\n\tsrc = (void *)info->hdr + symsect->sh_offset;\n\tnsrc = symsect->sh_size / sizeof(*src);\n\n\t/* Compute total space required for the core symbols' strtab. */\n\tfor (ndst = i = 0; i < nsrc; i++) {\n\t\tif (i == 0 || is_livepatch_module(mod) ||\n\t\t    is_core_symbol(src+i, info->sechdrs, info->hdr->e_shnum,\n\t\t\t\t   info->index.pcpu)) {\n\t\t\tstrtab_size += strlen(&info->strtab[src[i].st_name])+1;\n\t\t\tndst++;\n\t\t}\n\t}\n\n\t/* Append room for core symbols at end of core part. */\n\tinfo->symoffs = ALIGN(mod->core_layout.size, symsect->sh_addralign ?: 1);\n\tinfo->stroffs = mod->core_layout.size = info->symoffs + ndst * sizeof(Elf_Sym);\n\tmod->core_layout.size += strtab_size;\n\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\n\t/* Put string table section at end of init part of module. */\n\tstrsect->sh_flags |= SHF_ALLOC;\n\tstrsect->sh_entsize = get_offset(mod, &mod->init_layout.size, strsect,\n\t\t\t\t\t info->index.str) | INIT_OFFSET_MASK;\n\tpr_debug(\"\\t%s\\n\", info->secstrings + strsect->sh_name);\n\n\t/* We'll tack temporary mod_kallsyms on the end. */\n\tmod->init_layout.size = ALIGN(mod->init_layout.size,\n\t\t\t\t      __alignof__(struct mod_kallsyms));\n\tinfo->mod_kallsyms_init_off = mod->init_layout.size;\n\tmod->init_layout.size += sizeof(struct mod_kallsyms);\n\tmod->init_layout.size = debug_align(mod->init_layout.size);\n}"
  },
  {
    "function_name": "is_core_symbol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2583-2607",
    "snippet": "static bool is_core_symbol(const Elf_Sym *src, const Elf_Shdr *sechdrs,\n\t\t\tunsigned int shnum, unsigned int pcpundx)\n{\n\tconst Elf_Shdr *sec;\n\n\tif (src->st_shndx == SHN_UNDEF\n\t    || src->st_shndx >= shnum\n\t    || !src->st_name)\n\t\treturn false;\n\n#ifdef CONFIG_KALLSYMS_ALL\n\tif (src->st_shndx == pcpundx)\n\t\treturn true;\n#endif\n\n\tsec = sechdrs + src->st_shndx;\n\tif (!(sec->sh_flags & SHF_ALLOC)\n#ifndef CONFIG_KALLSYMS_ALL\n\t    || !(sec->sh_flags & SHF_EXECINSTR)\n#endif\n\t    || (sec->sh_entsize & INIT_OFFSET_MASK))\n\t\treturn false;\n\n\treturn true;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))\n\nstatic bool is_core_symbol(const Elf_Sym *src, const Elf_Shdr *sechdrs,\n\t\t\tunsigned int shnum, unsigned int pcpundx)\n{\n\tconst Elf_Shdr *sec;\n\n\tif (src->st_shndx == SHN_UNDEF\n\t    || src->st_shndx >= shnum\n\t    || !src->st_name)\n\t\treturn false;\n\n#ifdef CONFIG_KALLSYMS_ALL\n\tif (src->st_shndx == pcpundx)\n\t\treturn true;\n#endif\n\n\tsec = sechdrs + src->st_shndx;\n\tif (!(sec->sh_flags & SHF_ALLOC)\n#ifndef CONFIG_KALLSYMS_ALL\n\t    || !(sec->sh_flags & SHF_EXECINSTR)\n#endif\n\t    || (sec->sh_entsize & INIT_OFFSET_MASK))\n\t\treturn false;\n\n\treturn true;\n}"
  },
  {
    "function_name": "elf_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2543-2581",
    "snippet": "static char elf_type(const Elf_Sym *sym, const struct load_info *info)\n{\n\tconst Elf_Shdr *sechdrs = info->sechdrs;\n\n\tif (ELF_ST_BIND(sym->st_info) == STB_WEAK) {\n\t\tif (ELF_ST_TYPE(sym->st_info) == STT_OBJECT)\n\t\t\treturn 'v';\n\t\telse\n\t\t\treturn 'w';\n\t}\n\tif (sym->st_shndx == SHN_UNDEF)\n\t\treturn 'U';\n\tif (sym->st_shndx == SHN_ABS || sym->st_shndx == info->index.pcpu)\n\t\treturn 'a';\n\tif (sym->st_shndx >= SHN_LORESERVE)\n\t\treturn '?';\n\tif (sechdrs[sym->st_shndx].sh_flags & SHF_EXECINSTR)\n\t\treturn 't';\n\tif (sechdrs[sym->st_shndx].sh_flags & SHF_ALLOC\n\t    && sechdrs[sym->st_shndx].sh_type != SHT_NOBITS) {\n\t\tif (!(sechdrs[sym->st_shndx].sh_flags & SHF_WRITE))\n\t\t\treturn 'r';\n\t\telse if (sechdrs[sym->st_shndx].sh_flags & ARCH_SHF_SMALL)\n\t\t\treturn 'g';\n\t\telse\n\t\t\treturn 'd';\n\t}\n\tif (sechdrs[sym->st_shndx].sh_type == SHT_NOBITS) {\n\t\tif (sechdrs[sym->st_shndx].sh_flags & ARCH_SHF_SMALL)\n\t\t\treturn 's';\n\t\telse\n\t\t\treturn 'b';\n\t}\n\tif (strstarts(info->secstrings + sechdrs[sym->st_shndx].sh_name,\n\t\t      \".debug\")) {\n\t\treturn 'n';\n\t}\n\treturn '?';\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define ARCH_SHF_SMALL 0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strstarts",
          "args": [
            "info->secstrings + sechdrs[sym->st_shndx].sh_name",
            "\".debug\""
          ],
          "line": 2576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ELF_ST_TYPE",
          "args": [
            "sym->st_info"
          ],
          "line": 2548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ELF_ST_BIND",
          "args": [
            "sym->st_info"
          ],
          "line": 2547
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define ARCH_SHF_SMALL 0\n\nstatic char elf_type(const Elf_Sym *sym, const struct load_info *info)\n{\n\tconst Elf_Shdr *sechdrs = info->sechdrs;\n\n\tif (ELF_ST_BIND(sym->st_info) == STB_WEAK) {\n\t\tif (ELF_ST_TYPE(sym->st_info) == STT_OBJECT)\n\t\t\treturn 'v';\n\t\telse\n\t\t\treturn 'w';\n\t}\n\tif (sym->st_shndx == SHN_UNDEF)\n\t\treturn 'U';\n\tif (sym->st_shndx == SHN_ABS || sym->st_shndx == info->index.pcpu)\n\t\treturn 'a';\n\tif (sym->st_shndx >= SHN_LORESERVE)\n\t\treturn '?';\n\tif (sechdrs[sym->st_shndx].sh_flags & SHF_EXECINSTR)\n\t\treturn 't';\n\tif (sechdrs[sym->st_shndx].sh_flags & SHF_ALLOC\n\t    && sechdrs[sym->st_shndx].sh_type != SHT_NOBITS) {\n\t\tif (!(sechdrs[sym->st_shndx].sh_flags & SHF_WRITE))\n\t\t\treturn 'r';\n\t\telse if (sechdrs[sym->st_shndx].sh_flags & ARCH_SHF_SMALL)\n\t\t\treturn 'g';\n\t\telse\n\t\t\treturn 'd';\n\t}\n\tif (sechdrs[sym->st_shndx].sh_type == SHT_NOBITS) {\n\t\tif (sechdrs[sym->st_shndx].sh_flags & ARCH_SHF_SMALL)\n\t\t\treturn 's';\n\t\telse\n\t\t\treturn 'b';\n\t}\n\tif (strstarts(info->secstrings + sechdrs[sym->st_shndx].sh_name,\n\t\t      \".debug\")) {\n\t\treturn 'n';\n\t}\n\treturn '?';\n}"
  },
  {
    "function_name": "is_exported",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2531-2540",
    "snippet": "static int is_exported(const char *name, unsigned long value,\n\t\t       const struct module *mod)\n{\n\tconst struct kernel_symbol *ks;\n\tif (!mod)\n\t\tks = lookup_symbol(name, __start___ksymtab, __stop___ksymtab);\n\telse\n\t\tks = lookup_symbol(name, mod->syms, mod->syms + mod->num_syms);\n\treturn ks != NULL && kernel_symbol_value(ks) == value;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern const struct kernel_symbol __start___ksymtab[];",
      "extern const struct kernel_symbol __stop___ksymtab[];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kernel_symbol_value",
          "args": [
            "ks"
          ],
          "line": 2539
        },
        "resolved": true,
        "details": {
          "function_name": "kernel_symbol_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "532-539",
          "snippet": "static unsigned long kernel_symbol_value(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn (unsigned long)offset_to_ptr(&sym->value_offset);\n#else\n\treturn sym->value;\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned long kernel_symbol_value(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn (unsigned long)offset_to_ptr(&sym->value_offset);\n#else\n\treturn sym->value;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lookup_symbol",
          "args": [
            "name",
            "mod->syms",
            "mod->syms + mod->num_syms"
          ],
          "line": 2538
        },
        "resolved": true,
        "details": {
          "function_name": "lookup_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2523-2529",
          "snippet": "static const struct kernel_symbol *lookup_symbol(const char *name,\n\tconst struct kernel_symbol *start,\n\tconst struct kernel_symbol *stop)\n{\n\treturn bsearch(name, start, stop - start,\n\t\t\tsizeof(struct kernel_symbol), cmp_name);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const struct kernel_symbol *lookup_symbol(const char *name,\n\tconst struct kernel_symbol *start,\n\tconst struct kernel_symbol *stop)\n{\n\treturn bsearch(name, start, stop - start,\n\t\t\tsizeof(struct kernel_symbol), cmp_name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nextern const struct kernel_symbol __start___ksymtab[];\nextern const struct kernel_symbol __stop___ksymtab[];\n\nstatic int is_exported(const char *name, unsigned long value,\n\t\t       const struct module *mod)\n{\n\tconst struct kernel_symbol *ks;\n\tif (!mod)\n\t\tks = lookup_symbol(name, __start___ksymtab, __stop___ksymtab);\n\telse\n\t\tks = lookup_symbol(name, mod->syms, mod->syms + mod->num_syms);\n\treturn ks != NULL && kernel_symbol_value(ks) == value;\n}"
  },
  {
    "function_name": "lookup_symbol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2523-2529",
    "snippet": "static const struct kernel_symbol *lookup_symbol(const char *name,\n\tconst struct kernel_symbol *start,\n\tconst struct kernel_symbol *stop)\n{\n\treturn bsearch(name, start, stop - start,\n\t\t\tsizeof(struct kernel_symbol), cmp_name);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bsearch",
          "args": [
            "name",
            "start",
            "stop - start",
            "sizeof(struct kernel_symbol)",
            "cmp_name"
          ],
          "line": 2527
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const struct kernel_symbol *lookup_symbol(const char *name,\n\tconst struct kernel_symbol *start,\n\tconst struct kernel_symbol *stop)\n{\n\treturn bsearch(name, start, stop - start,\n\t\t\tsizeof(struct kernel_symbol), cmp_name);\n}"
  },
  {
    "function_name": "free_modinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2509-2518",
    "snippet": "static void free_modinfo(struct module *mod)\n{\n\tstruct module_attribute *attr;\n\tint i;\n\n\tfor (i = 0; (attr = modinfo_attrs[i]); i++) {\n\t\tif (attr->free)\n\t\t\tattr->free(mod);\n\t}\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "attr->free",
          "args": [
            "mod"
          ],
          "line": 2516
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};\n\nstatic void free_modinfo(struct module *mod)\n{\n\tstruct module_attribute *attr;\n\tint i;\n\n\tfor (i = 0; (attr = modinfo_attrs[i]); i++) {\n\t\tif (attr->free)\n\t\t\tattr->free(mod);\n\t}\n}"
  },
  {
    "function_name": "setup_modinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2498-2507",
    "snippet": "static void setup_modinfo(struct module *mod, struct load_info *info)\n{\n\tstruct module_attribute *attr;\n\tint i;\n\n\tfor (i = 0; (attr = modinfo_attrs[i]); i++) {\n\t\tif (attr->setup)\n\t\t\tattr->setup(mod, get_modinfo(info, attr->attr.name));\n\t}\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "attr->setup",
          "args": [
            "mod",
            "get_modinfo(info, attr->attr.name)"
          ],
          "line": 2505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_modinfo",
          "args": [
            "info",
            "attr->attr.name"
          ],
          "line": 2505
        },
        "resolved": true,
        "details": {
          "function_name": "get_modinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2480-2496",
          "snippet": "static char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};\n\nstatic void setup_modinfo(struct module *mod, struct load_info *info)\n{\n\tstruct module_attribute *attr;\n\tint i;\n\n\tfor (i = 0; (attr = modinfo_attrs[i]); i++) {\n\t\tif (attr->setup)\n\t\t\tattr->setup(mod, get_modinfo(info, attr->attr.name));\n\t}\n}"
  },
  {
    "function_name": "get_modinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2480-2496",
    "snippet": "static char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "p",
            "tag",
            "taglen"
          ],
          "line": 2492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "next_string",
          "args": [
            "p",
            "&size"
          ],
          "line": 2491
        },
        "resolved": true,
        "details": {
          "function_name": "next_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2462-2478",
          "snippet": "static char *next_string(char *string, unsigned long *secsize)\n{\n\t/* Skip non-zero chars */\n\twhile (string[0]) {\n\t\tstring++;\n\t\tif ((*secsize)-- <= 1)\n\t\t\treturn NULL;\n\t}\n\n\t/* Skip any zero padding. */\n\twhile (!string[0]) {\n\t\tstring++;\n\t\tif ((*secsize)-- <= 1)\n\t\t\treturn NULL;\n\t}\n\treturn string;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *next_string(char *string, unsigned long *secsize)\n{\n\t/* Skip non-zero chars */\n\twhile (string[0]) {\n\t\tstring++;\n\t\tif ((*secsize)-- <= 1)\n\t\t\treturn NULL;\n\t}\n\n\t/* Skip any zero padding. */\n\twhile (!string[0]) {\n\t\tstring++;\n\t\tif ((*secsize)-- <= 1)\n\t\t\treturn NULL;\n\t}\n\treturn string;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "tag"
          ],
          "line": 2483
        },
        "resolved": true,
        "details": {
          "function_name": "fetch_store_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_uprobe.c",
          "lines": "137-146",
          "snippet": "static nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/string.h>",
            "#include <linux/namei.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include <linux/rculist.h>\n#include <linux/string.h>\n#include <linux/namei.h>\n#include <linux/uprobes.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n\nstatic nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *get_modinfo(struct load_info *info, const char *tag)\n{\n\tchar *p;\n\tunsigned int taglen = strlen(tag);\n\tElf_Shdr *infosec = &info->sechdrs[info->index.info];\n\tunsigned long size = infosec->sh_size;\n\n\t/*\n\t * get_modinfo() calls made before rewrite_section_headers()\n\t * must use sh_offset, as sh_addr isn't set!\n\t */\n\tfor (p = (char *)info->hdr + infosec->sh_offset; p; p = next_string(p, &size)) {\n\t\tif (strncmp(p, tag, taglen) == 0 && p[taglen] == '=')\n\t\t\treturn p + taglen + 1;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "next_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2462-2478",
    "snippet": "static char *next_string(char *string, unsigned long *secsize)\n{\n\t/* Skip non-zero chars */\n\twhile (string[0]) {\n\t\tstring++;\n\t\tif ((*secsize)-- <= 1)\n\t\t\treturn NULL;\n\t}\n\n\t/* Skip any zero padding. */\n\twhile (!string[0]) {\n\t\tstring++;\n\t\tif ((*secsize)-- <= 1)\n\t\t\treturn NULL;\n\t}\n\treturn string;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic char *next_string(char *string, unsigned long *secsize)\n{\n\t/* Skip non-zero chars */\n\twhile (string[0]) {\n\t\tstring++;\n\t\tif ((*secsize)-- <= 1)\n\t\t\treturn NULL;\n\t}\n\n\t/* Skip any zero padding. */\n\twhile (!string[0]) {\n\t\tstring++;\n\t\tif ((*secsize)-- <= 1)\n\t\t\treturn NULL;\n\t}\n\treturn string;\n}"
  },
  {
    "function_name": "set_license",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2447-2459",
    "snippet": "static void set_license(struct module *mod, const char *license)\n{\n\tif (!license)\n\t\tlicense = \"unspecified\";\n\n\tif (!license_is_gpl_compatible(license)) {\n\t\tif (!test_taint(TAINT_PROPRIETARY_MODULE))\n\t\t\tpr_warn(\"%s: module license '%s' taints kernel.\\n\",\n\t\t\t\tmod->name, license);\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\t}\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_taint_module",
          "args": [
            "mod",
            "TAINT_PROPRIETARY_MODULE",
            "LOCKDEP_NOW_UNRELIABLE"
          ],
          "line": 2456
        },
        "resolved": true,
        "details": {
          "function_name": "add_taint_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "326-331",
          "snippet": "static inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: module license '%s' taints kernel.\\n\"",
            "mod->name",
            "license"
          ],
          "line": 2454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_taint",
          "args": [
            "TAINT_PROPRIETARY_MODULE"
          ],
          "line": 2453
        },
        "resolved": true,
        "details": {
          "function_name": "test_taint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/panic.c",
          "lines": "367-370",
          "snippet": "int test_taint(unsigned flag)\n{\n\treturn test_bit(flag, &tainted_mask);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nstatic unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;\n\nint test_taint(unsigned flag)\n{\n\treturn test_bit(flag, &tainted_mask);\n}"
        }
      },
      {
        "call_info": {
          "callee": "license_is_gpl_compatible",
          "args": [
            "license"
          ],
          "line": 2452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void set_license(struct module *mod, const char *license)\n{\n\tif (!license)\n\t\tlicense = \"unspecified\";\n\n\tif (!license_is_gpl_compatible(license)) {\n\t\tif (!test_taint(TAINT_PROPRIETARY_MODULE))\n\t\t\tpr_warn(\"%s: module license '%s' taints kernel.\\n\",\n\t\t\t\tmod->name, license);\n\t\tadd_taint_module(mod, TAINT_PROPRIETARY_MODULE,\n\t\t\t\t LOCKDEP_NOW_UNRELIABLE);\n\t}\n}"
  },
  {
    "function_name": "layout_sections",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2359-2445",
    "snippet": "static void layout_sections(struct module *mod, struct load_info *info)\n{\n\tstatic unsigned long const masks[][2] = {\n\t\t/* NOTE: all executable code must be the first section\n\t\t * in this array; otherwise modify the text_size\n\t\t * finder in the two loops below */\n\t\t{ SHF_EXECINSTR | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ SHF_ALLOC, SHF_WRITE | ARCH_SHF_SMALL },\n\t\t{ SHF_RO_AFTER_INIT | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ SHF_WRITE | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ ARCH_SHF_SMALL | SHF_ALLOC, 0 }\n\t};\n\tunsigned int m, i;\n\n\tfor (i = 0; i < info->hdr->e_shnum; i++)\n\t\tinfo->sechdrs[i].sh_entsize = ~0UL;\n\n\tpr_debug(\"Core section allocation order:\\n\");\n\tfor (m = 0; m < ARRAY_SIZE(masks); ++m) {\n\t\tfor (i = 0; i < info->hdr->e_shnum; ++i) {\n\t\t\tElf_Shdr *s = &info->sechdrs[i];\n\t\t\tconst char *sname = info->secstrings + s->sh_name;\n\n\t\t\tif ((s->sh_flags & masks[m][0]) != masks[m][0]\n\t\t\t    || (s->sh_flags & masks[m][1])\n\t\t\t    || s->sh_entsize != ~0UL\n\t\t\t    || strstarts(sname, \".init\"))\n\t\t\t\tcontinue;\n\t\t\ts->sh_entsize = get_offset(mod, &mod->core_layout.size, s, i);\n\t\t\tpr_debug(\"\\t%s\\n\", sname);\n\t\t}\n\t\tswitch (m) {\n\t\tcase 0: /* executable */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.text_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 1: /* RO: text and ro-data */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.ro_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 2: /* RO after init */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.ro_after_init_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 4: /* whole core */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tpr_debug(\"Init section allocation order:\\n\");\n\tfor (m = 0; m < ARRAY_SIZE(masks); ++m) {\n\t\tfor (i = 0; i < info->hdr->e_shnum; ++i) {\n\t\t\tElf_Shdr *s = &info->sechdrs[i];\n\t\t\tconst char *sname = info->secstrings + s->sh_name;\n\n\t\t\tif ((s->sh_flags & masks[m][0]) != masks[m][0]\n\t\t\t    || (s->sh_flags & masks[m][1])\n\t\t\t    || s->sh_entsize != ~0UL\n\t\t\t    || !strstarts(sname, \".init\"))\n\t\t\t\tcontinue;\n\t\t\ts->sh_entsize = (get_offset(mod, &mod->init_layout.size, s, i)\n\t\t\t\t\t | INIT_OFFSET_MASK);\n\t\t\tpr_debug(\"\\t%s\\n\", sname);\n\t\t}\n\t\tswitch (m) {\n\t\tcase 0: /* executable */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tmod->init_layout.text_size = mod->init_layout.size;\n\t\t\tbreak;\n\t\tcase 1: /* RO: text and ro-data */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tmod->init_layout.ro_size = mod->init_layout.size;\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\t/*\n\t\t\t * RO after init doesn't apply to init_layout (only\n\t\t\t * core_layout), so it just takes the value of ro_size.\n\t\t\t */\n\t\t\tmod->init_layout.ro_after_init_size = mod->init_layout.ro_size;\n\t\t\tbreak;\n\t\tcase 4: /* whole init */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tbreak;\n\t\t}\n\t}\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))",
      "#define ARCH_SHF_SMALL 0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug_align",
          "args": [
            "mod->init_layout.size"
          ],
          "line": 2441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_align",
          "args": [
            "mod->init_layout.size"
          ],
          "line": 2430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_align",
          "args": [
            "mod->init_layout.size"
          ],
          "line": 2426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"\\t%s\\n\"",
            "sname"
          ],
          "line": 2422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_offset",
          "args": [
            "mod",
            "&mod->init_layout.size",
            "s",
            "i"
          ],
          "line": 2420
        },
        "resolved": true,
        "details": {
          "function_name": "get_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2344-2353",
          "snippet": "static long get_offset(struct module *mod, unsigned int *size,\n\t\t       Elf_Shdr *sechdr, unsigned int section)\n{\n\tlong ret;\n\n\t*size += arch_mod_section_prepend(mod, section);\n\tret = ALIGN(*size, sechdr->sh_addralign ?: 1);\n\t*size = ret + sechdr->sh_size;\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic long get_offset(struct module *mod, unsigned int *size,\n\t\t       Elf_Shdr *sechdr, unsigned int section)\n{\n\tlong ret;\n\n\t*size += arch_mod_section_prepend(mod, section);\n\tret = ALIGN(*size, sechdr->sh_addralign ?: 1);\n\t*size = ret + sechdr->sh_size;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstarts",
          "args": [
            "sname",
            "\".init\""
          ],
          "line": 2418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "masks"
          ],
          "line": 2410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"Init section allocation order:\\n\""
          ],
          "line": 2409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_align",
          "args": [
            "mod->core_layout.size"
          ],
          "line": 2404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_align",
          "args": [
            "mod->core_layout.size"
          ],
          "line": 2400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_align",
          "args": [
            "mod->core_layout.size"
          ],
          "line": 2396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_align",
          "args": [
            "mod->core_layout.size"
          ],
          "line": 2392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"\\t%s\\n\"",
            "sname"
          ],
          "line": 2388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstarts",
          "args": [
            "sname",
            "\".init\""
          ],
          "line": 2385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "masks"
          ],
          "line": 2377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"Core section allocation order:\\n\""
          ],
          "line": 2376
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define INIT_OFFSET_MASK (1UL << (BITS_PER_LONG-1))\n#define ARCH_SHF_SMALL 0\n\nstatic void layout_sections(struct module *mod, struct load_info *info)\n{\n\tstatic unsigned long const masks[][2] = {\n\t\t/* NOTE: all executable code must be the first section\n\t\t * in this array; otherwise modify the text_size\n\t\t * finder in the two loops below */\n\t\t{ SHF_EXECINSTR | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ SHF_ALLOC, SHF_WRITE | ARCH_SHF_SMALL },\n\t\t{ SHF_RO_AFTER_INIT | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ SHF_WRITE | SHF_ALLOC, ARCH_SHF_SMALL },\n\t\t{ ARCH_SHF_SMALL | SHF_ALLOC, 0 }\n\t};\n\tunsigned int m, i;\n\n\tfor (i = 0; i < info->hdr->e_shnum; i++)\n\t\tinfo->sechdrs[i].sh_entsize = ~0UL;\n\n\tpr_debug(\"Core section allocation order:\\n\");\n\tfor (m = 0; m < ARRAY_SIZE(masks); ++m) {\n\t\tfor (i = 0; i < info->hdr->e_shnum; ++i) {\n\t\t\tElf_Shdr *s = &info->sechdrs[i];\n\t\t\tconst char *sname = info->secstrings + s->sh_name;\n\n\t\t\tif ((s->sh_flags & masks[m][0]) != masks[m][0]\n\t\t\t    || (s->sh_flags & masks[m][1])\n\t\t\t    || s->sh_entsize != ~0UL\n\t\t\t    || strstarts(sname, \".init\"))\n\t\t\t\tcontinue;\n\t\t\ts->sh_entsize = get_offset(mod, &mod->core_layout.size, s, i);\n\t\t\tpr_debug(\"\\t%s\\n\", sname);\n\t\t}\n\t\tswitch (m) {\n\t\tcase 0: /* executable */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.text_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 1: /* RO: text and ro-data */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.ro_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 2: /* RO after init */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tmod->core_layout.ro_after_init_size = mod->core_layout.size;\n\t\t\tbreak;\n\t\tcase 4: /* whole core */\n\t\t\tmod->core_layout.size = debug_align(mod->core_layout.size);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tpr_debug(\"Init section allocation order:\\n\");\n\tfor (m = 0; m < ARRAY_SIZE(masks); ++m) {\n\t\tfor (i = 0; i < info->hdr->e_shnum; ++i) {\n\t\t\tElf_Shdr *s = &info->sechdrs[i];\n\t\t\tconst char *sname = info->secstrings + s->sh_name;\n\n\t\t\tif ((s->sh_flags & masks[m][0]) != masks[m][0]\n\t\t\t    || (s->sh_flags & masks[m][1])\n\t\t\t    || s->sh_entsize != ~0UL\n\t\t\t    || !strstarts(sname, \".init\"))\n\t\t\t\tcontinue;\n\t\t\ts->sh_entsize = (get_offset(mod, &mod->init_layout.size, s, i)\n\t\t\t\t\t | INIT_OFFSET_MASK);\n\t\t\tpr_debug(\"\\t%s\\n\", sname);\n\t\t}\n\t\tswitch (m) {\n\t\tcase 0: /* executable */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tmod->init_layout.text_size = mod->init_layout.size;\n\t\t\tbreak;\n\t\tcase 1: /* RO: text and ro-data */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tmod->init_layout.ro_size = mod->init_layout.size;\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\t/*\n\t\t\t * RO after init doesn't apply to init_layout (only\n\t\t\t * core_layout), so it just takes the value of ro_size.\n\t\t\t */\n\t\t\tmod->init_layout.ro_after_init_size = mod->init_layout.ro_size;\n\t\t\tbreak;\n\t\tcase 4: /* whole init */\n\t\t\tmod->init_layout.size = debug_align(mod->init_layout.size);\n\t\t\tbreak;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "get_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2344-2353",
    "snippet": "static long get_offset(struct module *mod, unsigned int *size,\n\t\t       Elf_Shdr *sechdr, unsigned int section)\n{\n\tlong ret;\n\n\t*size += arch_mod_section_prepend(mod, section);\n\tret = ALIGN(*size, sechdr->sh_addralign ?: 1);\n\t*size = ret + sechdr->sh_size;\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "*size",
            "sechdr->sh_addralign ?: 1"
          ],
          "line": 2350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arch_mod_section_prepend",
          "args": [
            "mod",
            "section"
          ],
          "line": 2349
        },
        "resolved": true,
        "details": {
          "function_name": "arch_mod_section_prepend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2336-2341",
          "snippet": "unsigned int __weak arch_mod_section_prepend(struct module *mod,\n\t\t\t\t\t     unsigned int section)\n{\n\t/* default implementation just returns zero */\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nunsigned int __weak arch_mod_section_prepend(struct module *mod,\n\t\t\t\t\t     unsigned int section)\n{\n\t/* default implementation just returns zero */\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic long get_offset(struct module *mod, unsigned int *size,\n\t\t       Elf_Shdr *sechdr, unsigned int section)\n{\n\tlong ret;\n\n\t*size += arch_mod_section_prepend(mod, section);\n\tret = ALIGN(*size, sechdr->sh_addralign ?: 1);\n\t*size = ret + sechdr->sh_size;\n\treturn ret;\n}"
  },
  {
    "function_name": "arch_mod_section_prepend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2336-2341",
    "snippet": "unsigned int __weak arch_mod_section_prepend(struct module *mod,\n\t\t\t\t\t     unsigned int section)\n{\n\t/* default implementation just returns zero */\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nunsigned int __weak arch_mod_section_prepend(struct module *mod,\n\t\t\t\t\t     unsigned int section)\n{\n\t/* default implementation just returns zero */\n\treturn 0;\n}"
  },
  {
    "function_name": "apply_relocations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2302-2333",
    "snippet": "static int apply_relocations(struct module *mod, const struct load_info *info)\n{\n\tunsigned int i;\n\tint err = 0;\n\n\t/* Now do relocations. */\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tunsigned int infosec = info->sechdrs[i].sh_info;\n\n\t\t/* Not a valid relocation section? */\n\t\tif (infosec >= info->hdr->e_shnum)\n\t\t\tcontinue;\n\n\t\t/* Don't bother with non-allocated sections */\n\t\tif (!(info->sechdrs[infosec].sh_flags & SHF_ALLOC))\n\t\t\tcontinue;\n\n\t\t/* Livepatch relocation sections are applied by livepatch */\n\t\tif (info->sechdrs[i].sh_flags & SHF_RELA_LIVEPATCH)\n\t\t\tcontinue;\n\n\t\tif (info->sechdrs[i].sh_type == SHT_REL)\n\t\t\terr = apply_relocate(info->sechdrs, info->strtab,\n\t\t\t\t\t     info->index.sym, i, mod);\n\t\telse if (info->sechdrs[i].sh_type == SHT_RELA)\n\t\t\terr = apply_relocate_add(info->sechdrs, info->strtab,\n\t\t\t\t\t\t info->index.sym, i, mod);\n\t\tif (err < 0)\n\t\t\tbreak;\n\t}\n\treturn err;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "apply_relocate_add",
          "args": [
            "info->sechdrs",
            "info->strtab",
            "info->index.sym",
            "i",
            "mod"
          ],
          "line": 2327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "apply_relocate",
          "args": [
            "info->sechdrs",
            "info->strtab",
            "info->index.sym",
            "i",
            "mod"
          ],
          "line": 2324
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int apply_relocations(struct module *mod, const struct load_info *info)\n{\n\tunsigned int i;\n\tint err = 0;\n\n\t/* Now do relocations. */\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tunsigned int infosec = info->sechdrs[i].sh_info;\n\n\t\t/* Not a valid relocation section? */\n\t\tif (infosec >= info->hdr->e_shnum)\n\t\t\tcontinue;\n\n\t\t/* Don't bother with non-allocated sections */\n\t\tif (!(info->sechdrs[infosec].sh_flags & SHF_ALLOC))\n\t\t\tcontinue;\n\n\t\t/* Livepatch relocation sections are applied by livepatch */\n\t\tif (info->sechdrs[i].sh_flags & SHF_RELA_LIVEPATCH)\n\t\t\tcontinue;\n\n\t\tif (info->sechdrs[i].sh_type == SHT_REL)\n\t\t\terr = apply_relocate(info->sechdrs, info->strtab,\n\t\t\t\t\t     info->index.sym, i, mod);\n\t\telse if (info->sechdrs[i].sh_type == SHT_RELA)\n\t\t\terr = apply_relocate_add(info->sechdrs, info->strtab,\n\t\t\t\t\t\t info->index.sym, i, mod);\n\t\tif (err < 0)\n\t\t\tbreak;\n\t}\n\treturn err;\n}"
  },
  {
    "function_name": "simplify_symbols",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2235-2300",
    "snippet": "static int simplify_symbols(struct module *mod, const struct load_info *info)\n{\n\tElf_Shdr *symsec = &info->sechdrs[info->index.sym];\n\tElf_Sym *sym = (void *)symsec->sh_addr;\n\tunsigned long secbase;\n\tunsigned int i;\n\tint ret = 0;\n\tconst struct kernel_symbol *ksym;\n\n\tfor (i = 1; i < symsec->sh_size / sizeof(Elf_Sym); i++) {\n\t\tconst char *name = info->strtab + sym[i].st_name;\n\n\t\tswitch (sym[i].st_shndx) {\n\t\tcase SHN_COMMON:\n\t\t\t/* Ignore common symbols */\n\t\t\tif (!strncmp(name, \"__gnu_lto\", 9))\n\t\t\t\tbreak;\n\n\t\t\t/* We compiled with -fno-common.  These are not\n\t\t\t   supposed to happen.  */\n\t\t\tpr_debug(\"Common symbol: %s\\n\", name);\n\t\t\tpr_warn(\"%s: please compile with -fno-common\\n\",\n\t\t\t       mod->name);\n\t\t\tret = -ENOEXEC;\n\t\t\tbreak;\n\n\t\tcase SHN_ABS:\n\t\t\t/* Don't need to do anything */\n\t\t\tpr_debug(\"Absolute symbol: 0x%08lx\\n\",\n\t\t\t       (long)sym[i].st_value);\n\t\t\tbreak;\n\n\t\tcase SHN_LIVEPATCH:\n\t\t\t/* Livepatch symbols are resolved by livepatch */\n\t\t\tbreak;\n\n\t\tcase SHN_UNDEF:\n\t\t\tksym = resolve_symbol_wait(mod, info, name);\n\t\t\t/* Ok if resolved.  */\n\t\t\tif (ksym && !IS_ERR(ksym)) {\n\t\t\t\tsym[i].st_value = kernel_symbol_value(ksym);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Ok if weak.  */\n\t\t\tif (!ksym && ELF_ST_BIND(sym[i].st_info) == STB_WEAK)\n\t\t\t\tbreak;\n\n\t\t\tret = PTR_ERR(ksym) ?: -ENOENT;\n\t\t\tpr_warn(\"%s: Unknown symbol %s (err %d)\\n\",\n\t\t\t\tmod->name, name, ret);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\t/* Divert to percpu allocation if a percpu var. */\n\t\t\tif (sym[i].st_shndx == info->index.pcpu)\n\t\t\t\tsecbase = (unsigned long)mod_percpu(mod);\n\t\t\telse\n\t\t\t\tsecbase = info->sechdrs[sym[i].st_shndx].sh_addr;\n\t\t\tsym[i].st_value += secbase;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mod_percpu",
          "args": [
            "mod"
          ],
          "line": 2291
        },
        "resolved": true,
        "details": {
          "function_name": "mod_percpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "727-730",
          "snippet": "static inline void __percpu *mod_percpu(struct module *mod)\n{\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void __percpu *mod_percpu(struct module *mod)\n{\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: Unknown symbol %s (err %d)\\n\"",
            "mod->name",
            "name",
            "ret"
          ],
          "line": 2284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "ksym"
          ],
          "line": 2283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ELF_ST_BIND",
          "args": [
            "sym[i].st_info"
          ],
          "line": 2280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kernel_symbol_value",
          "args": [
            "ksym"
          ],
          "line": 2275
        },
        "resolved": true,
        "details": {
          "function_name": "kernel_symbol_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "532-539",
          "snippet": "static unsigned long kernel_symbol_value(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn (unsigned long)offset_to_ptr(&sym->value_offset);\n#else\n\treturn sym->value;\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned long kernel_symbol_value(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn (unsigned long)offset_to_ptr(&sym->value_offset);\n#else\n\treturn sym->value;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "ksym"
          ],
          "line": 2274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resolve_symbol_wait",
          "args": [
            "mod",
            "info",
            "name"
          ],
          "line": 2272
        },
        "resolved": true,
        "details": {
          "function_name": "resolve_symbol_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1424-1440",
          "snippet": "static const struct kernel_symbol *\nresolve_symbol_wait(struct module *mod,\n\t\t    const struct load_info *info,\n\t\t    const char *name)\n{\n\tconst struct kernel_symbol *ksym;\n\tchar owner[MODULE_NAME_LEN];\n\n\tif (wait_event_interruptible_timeout(module_wq,\n\t\t\t!IS_ERR(ksym = resolve_symbol(mod, info, name, owner))\n\t\t\t|| PTR_ERR(ksym) != -EBUSY,\n\t\t\t\t\t     30 * HZ) <= 0) {\n\t\tpr_warn(\"%s: gave up waiting for init of module %s.\\n\",\n\t\t\tmod->name, owner);\n\t}\n\treturn ksym;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_WAIT_QUEUE_HEAD(module_wq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(module_wq);\n\nstatic const struct kernel_symbol *\nresolve_symbol_wait(struct module *mod,\n\t\t    const struct load_info *info,\n\t\t    const char *name)\n{\n\tconst struct kernel_symbol *ksym;\n\tchar owner[MODULE_NAME_LEN];\n\n\tif (wait_event_interruptible_timeout(module_wq,\n\t\t\t!IS_ERR(ksym = resolve_symbol(mod, info, name, owner))\n\t\t\t|| PTR_ERR(ksym) != -EBUSY,\n\t\t\t\t\t     30 * HZ) <= 0) {\n\t\tpr_warn(\"%s: gave up waiting for init of module %s.\\n\",\n\t\t\tmod->name, owner);\n\t}\n\treturn ksym;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"Absolute symbol: 0x%08lx\\n\"",
            "(long)sym[i].st_value"
          ],
          "line": 2263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: please compile with -fno-common\\n\"",
            "mod->name"
          ],
          "line": 2256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"Common symbol: %s\\n\"",
            "name"
          ],
          "line": 2255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "name",
            "\"__gnu_lto\"",
            "9"
          ],
          "line": 2250
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int simplify_symbols(struct module *mod, const struct load_info *info)\n{\n\tElf_Shdr *symsec = &info->sechdrs[info->index.sym];\n\tElf_Sym *sym = (void *)symsec->sh_addr;\n\tunsigned long secbase;\n\tunsigned int i;\n\tint ret = 0;\n\tconst struct kernel_symbol *ksym;\n\n\tfor (i = 1; i < symsec->sh_size / sizeof(Elf_Sym); i++) {\n\t\tconst char *name = info->strtab + sym[i].st_name;\n\n\t\tswitch (sym[i].st_shndx) {\n\t\tcase SHN_COMMON:\n\t\t\t/* Ignore common symbols */\n\t\t\tif (!strncmp(name, \"__gnu_lto\", 9))\n\t\t\t\tbreak;\n\n\t\t\t/* We compiled with -fno-common.  These are not\n\t\t\t   supposed to happen.  */\n\t\t\tpr_debug(\"Common symbol: %s\\n\", name);\n\t\t\tpr_warn(\"%s: please compile with -fno-common\\n\",\n\t\t\t       mod->name);\n\t\t\tret = -ENOEXEC;\n\t\t\tbreak;\n\n\t\tcase SHN_ABS:\n\t\t\t/* Don't need to do anything */\n\t\t\tpr_debug(\"Absolute symbol: 0x%08lx\\n\",\n\t\t\t       (long)sym[i].st_value);\n\t\t\tbreak;\n\n\t\tcase SHN_LIVEPATCH:\n\t\t\t/* Livepatch symbols are resolved by livepatch */\n\t\t\tbreak;\n\n\t\tcase SHN_UNDEF:\n\t\t\tksym = resolve_symbol_wait(mod, info, name);\n\t\t\t/* Ok if resolved.  */\n\t\t\tif (ksym && !IS_ERR(ksym)) {\n\t\t\t\tsym[i].st_value = kernel_symbol_value(ksym);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Ok if weak.  */\n\t\t\tif (!ksym && ELF_ST_BIND(sym[i].st_info) == STB_WEAK)\n\t\t\t\tbreak;\n\n\t\t\tret = PTR_ERR(ksym) ?: -ENOENT;\n\t\t\tpr_warn(\"%s: Unknown symbol %s (err %d)\\n\",\n\t\t\t\tmod->name, name, ret);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\t/* Divert to percpu allocation if a percpu var. */\n\t\t\tif (sym[i].st_shndx == info->index.pcpu)\n\t\t\t\tsecbase = (unsigned long)mod_percpu(mod);\n\t\t\telse\n\t\t\t\tsecbase = info->sechdrs[sym[i].st_shndx].sh_addr;\n\t\t\tsym[i].st_value += secbase;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "verify_export_symbols",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2201-2232",
    "snippet": "static int verify_export_symbols(struct module *mod)\n{\n\tunsigned int i;\n\tstruct module *owner;\n\tconst struct kernel_symbol *s;\n\tstruct {\n\t\tconst struct kernel_symbol *sym;\n\t\tunsigned int num;\n\t} arr[] = {\n\t\t{ mod->syms, mod->num_syms },\n\t\t{ mod->gpl_syms, mod->num_gpl_syms },\n\t\t{ mod->gpl_future_syms, mod->num_gpl_future_syms },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t{ mod->unused_syms, mod->num_unused_syms },\n\t\t{ mod->unused_gpl_syms, mod->num_unused_gpl_syms },\n#endif\n\t};\n\n\tfor (i = 0; i < ARRAY_SIZE(arr); i++) {\n\t\tfor (s = arr[i].sym; s < arr[i].sym + arr[i].num; s++) {\n\t\t\tif (find_symbol(kernel_symbol_name(s), &owner, NULL,\n\t\t\t\t\ttrue, false)) {\n\t\t\t\tpr_err(\"%s: exports duplicate symbol %s\"\n\t\t\t\t       \" (owned by %s)\\n\",\n\t\t\t\t       mod->name, kernel_symbol_name(s),\n\t\t\t\t       module_name(owner));\n\t\t\t\treturn -ENOEXEC;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s: exports duplicate symbol %s\"\n\t\t\t\t       \" (owned by %s)\\n\"",
            "mod->name",
            "kernel_symbol_name(s)",
            "module_name(owner)"
          ],
          "line": 2223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_name",
          "args": [
            "owner"
          ],
          "line": 2226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kernel_symbol_name",
          "args": [
            "s"
          ],
          "line": 2225
        },
        "resolved": true,
        "details": {
          "function_name": "kernel_symbol_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "541-548",
          "snippet": "static const char *kernel_symbol_name(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn offset_to_ptr(&sym->name_offset);\n#else\n\treturn sym->name;\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const char *kernel_symbol_name(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn offset_to_ptr(&sym->name_offset);\n#else\n\treturn sym->name;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_symbol",
          "args": [
            "kernel_symbol_name(s)",
            "&owner",
            "NULL",
            "true",
            "false"
          ],
          "line": 2221
        },
        "resolved": true,
        "details": {
          "function_name": "find_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "576-598",
          "snippet": "const struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nconst struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "arr"
          ],
          "line": 2219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int verify_export_symbols(struct module *mod)\n{\n\tunsigned int i;\n\tstruct module *owner;\n\tconst struct kernel_symbol *s;\n\tstruct {\n\t\tconst struct kernel_symbol *sym;\n\t\tunsigned int num;\n\t} arr[] = {\n\t\t{ mod->syms, mod->num_syms },\n\t\t{ mod->gpl_syms, mod->num_gpl_syms },\n\t\t{ mod->gpl_future_syms, mod->num_gpl_future_syms },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t{ mod->unused_syms, mod->num_unused_syms },\n\t\t{ mod->unused_gpl_syms, mod->num_unused_gpl_syms },\n#endif\n\t};\n\n\tfor (i = 0; i < ARRAY_SIZE(arr); i++) {\n\t\tfor (s = arr[i].sym; s < arr[i].sym + arr[i].num; s++) {\n\t\t\tif (find_symbol(kernel_symbol_name(s), &owner, NULL,\n\t\t\t\t\ttrue, false)) {\n\t\t\t\tpr_err(\"%s: exports duplicate symbol %s\"\n\t\t\t\t       \" (owned by %s)\\n\",\n\t\t\t\t       mod->name, kernel_symbol_name(s),\n\t\t\t\t       module_name(owner));\n\t\t\t\treturn -ENOEXEC;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "__symbol_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2180-2192",
    "snippet": "void *__symbol_get(const char *symbol)\n{\n\tstruct module *owner;\n\tconst struct kernel_symbol *sym;\n\n\tpreempt_disable();\n\tsym = find_symbol(symbol, &owner, NULL, true, true);\n\tif (sym && strong_try_module_get(owner))\n\t\tsym = NULL;\n\tpreempt_enable();\n\n\treturn sym ? (void *)kernel_symbol_value(sym) : NULL;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kernel_symbol_value",
          "args": [
            "sym"
          ],
          "line": 2191
        },
        "resolved": true,
        "details": {
          "function_name": "kernel_symbol_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "532-539",
          "snippet": "static unsigned long kernel_symbol_value(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn (unsigned long)offset_to_ptr(&sym->value_offset);\n#else\n\treturn sym->value;\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned long kernel_symbol_value(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn (unsigned long)offset_to_ptr(&sym->value_offset);\n#else\n\treturn sym->value;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 2189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strong_try_module_get",
          "args": [
            "owner"
          ],
          "line": 2187
        },
        "resolved": true,
        "details": {
          "function_name": "strong_try_module_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "315-324",
          "snippet": "static inline int strong_try_module_get(struct module *mod)\n{\n\tBUG_ON(mod && mod->state == MODULE_STATE_UNFORMED);\n\tif (mod && mod->state == MODULE_STATE_COMING)\n\t\treturn -EBUSY;\n\tif (try_module_get(mod))\n\t\treturn 0;\n\telse\n\t\treturn -ENOENT;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int strong_try_module_get(struct module *mod)\n{\n\tBUG_ON(mod && mod->state == MODULE_STATE_UNFORMED);\n\tif (mod && mod->state == MODULE_STATE_COMING)\n\t\treturn -EBUSY;\n\tif (try_module_get(mod))\n\t\treturn 0;\n\telse\n\t\treturn -ENOENT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_symbol",
          "args": [
            "symbol",
            "&owner",
            "NULL",
            "true",
            "true"
          ],
          "line": 2186
        },
        "resolved": true,
        "details": {
          "function_name": "find_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "576-598",
          "snippet": "const struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nconst struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 2185
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid *__symbol_get(const char *symbol)\n{\n\tstruct module *owner;\n\tconst struct kernel_symbol *sym;\n\n\tpreempt_disable();\n\tsym = find_symbol(symbol, &owner, NULL, true, true);\n\tif (sym && strong_try_module_get(owner))\n\t\tsym = NULL;\n\tpreempt_enable();\n\n\treturn sym ? (void *)kernel_symbol_value(sym) : NULL;\n}"
  },
  {
    "function_name": "free_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2127-2178",
    "snippet": "static void free_module(struct module *mod)\n{\n\ttrace_module_free(mod);\n\n\tmod_sysfs_teardown(mod);\n\n\t/* We leave it in list to prevent duplicate loads, but make sure\n\t * that noone uses it while it's being deconstructed. */\n\tmutex_lock(&module_mutex);\n\tmod->state = MODULE_STATE_UNFORMED;\n\tmutex_unlock(&module_mutex);\n\n\t/* Remove dynamic debug info */\n\tddebug_remove_module(mod->name);\n\n\t/* Arch-specific cleanup. */\n\tmodule_arch_cleanup(mod);\n\n\t/* Module unload stuff */\n\tmodule_unload_free(mod);\n\n\t/* Free any allocated parameters. */\n\tdestroy_params(mod->kp, mod->num_kp);\n\n\tif (is_livepatch_module(mod))\n\t\tfree_module_elf(mod);\n\n\t/* Now we can delete it from the lists */\n\tmutex_lock(&module_mutex);\n\t/* Unlink carefully: kallsyms could be walking list. */\n\tlist_del_rcu(&mod->list);\n\tmod_tree_remove(mod);\n\t/* Remove this module from bug list, this uses list_del_rcu */\n\tmodule_bug_cleanup(mod);\n\t/* Wait for RCU-sched synchronizing before releasing mod->list and buglist. */\n\tsynchronize_sched();\n\tmutex_unlock(&module_mutex);\n\n\t/* This may be empty, but that's OK */\n\tdisable_ro_nx(&mod->init_layout);\n\tmodule_arch_freeing_init(mod);\n\tmodule_memfree(mod->init_layout.base);\n\tkfree(mod->args);\n\tpercpu_modfree(mod);\n\n\t/* Free lock-classes; relies on the preceding sync_rcu(). */\n\tlockdep_free_key_range(mod->core_layout.base, mod->core_layout.size);\n\n\t/* Finally, free the core (containing the module structure) */\n\tdisable_ro_nx(&mod->core_layout);\n\tmodule_memfree(mod->core_layout.base);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_memfree",
          "args": [
            "mod->core_layout.base"
          ],
          "line": 2177
        },
        "resolved": true,
        "details": {
          "function_name": "module_memfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2113-2116",
          "snippet": "void __weak module_memfree(void *module_region)\n{\n\tvfree(module_region);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_memfree(void *module_region)\n{\n\tvfree(module_region);\n}"
        }
      },
      {
        "call_info": {
          "callee": "disable_ro_nx",
          "args": [
            "&mod->core_layout"
          ],
          "line": 2176
        },
        "resolved": true,
        "details": {
          "function_name": "disable_ro_nx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2033-2033",
          "snippet": "static void disable_ro_nx(const struct module_layout *layout) { }",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void disable_ro_nx(const struct module_layout *layout) { }"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_free_key_range",
          "args": [
            "mod->core_layout.base",
            "mod->core_layout.size"
          ],
          "line": 2173
        },
        "resolved": true,
        "details": {
          "function_name": "lockdep_free_key_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/lockdep.c",
          "lines": "4164-4205",
          "snippet": "void lockdep_free_key_range(void *start, unsigned long size)\n{\n\tstruct lock_class *class;\n\tstruct hlist_head *head;\n\tunsigned long flags;\n\tint i;\n\tint locked;\n\n\traw_local_irq_save(flags);\n\tlocked = graph_lock();\n\n\t/*\n\t * Unhash all classes that were created by this module:\n\t */\n\tfor (i = 0; i < CLASSHASH_SIZE; i++) {\n\t\thead = classhash_table + i;\n\t\thlist_for_each_entry_rcu(class, head, hash_entry) {\n\t\t\tif (within(class->key, start, size))\n\t\t\t\tzap_class(class);\n\t\t\telse if (within(class->name, start, size))\n\t\t\t\tzap_class(class);\n\t\t}\n\t}\n\n\tif (locked)\n\t\tgraph_unlock();\n\traw_local_irq_restore(flags);\n\n\t/*\n\t * Wait for any possible iterators from look_up_lock_class() to pass\n\t * before continuing to free the memory they refer to.\n\t *\n\t * sync_sched() is sufficient because the read-side is IRQ disable.\n\t */\n\tsynchronize_sched();\n\n\t/*\n\t * XXX at this point we could return the resources to the pool;\n\t * instead we leak them. We would need to change to bitmap allocators\n\t * instead of the linear allocators we have now.\n\t */\n}",
          "includes": [
            "#include \"lockdep_states.h\"",
            "#include \"lockdep_states.h\"",
            "#include \"lockdep_states.h\"",
            "#include \"lockdep_states.h\"",
            "#include <trace/events/lock.h>",
            "#include \"lockdep_internals.h\"",
            "#include <asm/sections.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jhash.h>",
            "#include <linux/random.h>",
            "#include <linux/gfp.h>",
            "#include <linux/bitops.h>",
            "#include <linux/stringify.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/hash.h>",
            "#include <linux/utsname.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/mutex.h>"
          ],
          "macros_used": [
            "#define CLASSHASH_SIZE\t\t(1UL << CLASSHASH_BITS)"
          ],
          "globals_used": [
            "static struct hlist_head classhash_table[CLASSHASH_SIZE];",
            "static int __lock_is_held(const struct lockdep_map *lock, int read);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lockdep_states.h\"\n#include \"lockdep_states.h\"\n#include \"lockdep_states.h\"\n#include \"lockdep_states.h\"\n#include <trace/events/lock.h>\n#include \"lockdep_internals.h\"\n#include <asm/sections.h>\n#include <linux/nmi.h>\n#include <linux/jhash.h>\n#include <linux/random.h>\n#include <linux/gfp.h>\n#include <linux/bitops.h>\n#include <linux/stringify.h>\n#include <linux/ftrace.h>\n#include <linux/hash.h>\n#include <linux/utsname.h>\n#include <linux/irqflags.h>\n#include <linux/debug_locks.h>\n#include <linux/stacktrace.h>\n#include <linux/interrupt.h>\n#include <linux/kallsyms.h>\n#include <linux/spinlock.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/delay.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/task.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n\n#define CLASSHASH_SIZE\t\t(1UL << CLASSHASH_BITS)\n\nstatic struct hlist_head classhash_table[CLASSHASH_SIZE];\nstatic int __lock_is_held(const struct lockdep_map *lock, int read);\n\nvoid lockdep_free_key_range(void *start, unsigned long size)\n{\n\tstruct lock_class *class;\n\tstruct hlist_head *head;\n\tunsigned long flags;\n\tint i;\n\tint locked;\n\n\traw_local_irq_save(flags);\n\tlocked = graph_lock();\n\n\t/*\n\t * Unhash all classes that were created by this module:\n\t */\n\tfor (i = 0; i < CLASSHASH_SIZE; i++) {\n\t\thead = classhash_table + i;\n\t\thlist_for_each_entry_rcu(class, head, hash_entry) {\n\t\t\tif (within(class->key, start, size))\n\t\t\t\tzap_class(class);\n\t\t\telse if (within(class->name, start, size))\n\t\t\t\tzap_class(class);\n\t\t}\n\t}\n\n\tif (locked)\n\t\tgraph_unlock();\n\traw_local_irq_restore(flags);\n\n\t/*\n\t * Wait for any possible iterators from look_up_lock_class() to pass\n\t * before continuing to free the memory they refer to.\n\t *\n\t * sync_sched() is sufficient because the read-side is IRQ disable.\n\t */\n\tsynchronize_sched();\n\n\t/*\n\t * XXX at this point we could return the resources to the pool;\n\t * instead we leak them. We would need to change to bitmap allocators\n\t * instead of the linear allocators we have now.\n\t */\n}"
        }
      },
      {
        "call_info": {
          "callee": "percpu_modfree",
          "args": [
            "mod"
          ],
          "line": 2170
        },
        "resolved": true,
        "details": {
          "function_name": "percpu_modfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "738-740",
          "snippet": "static inline void percpu_modfree(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void percpu_modfree(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "mod->args"
          ],
          "line": 2169
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_arch_freeing_init",
          "args": [
            "mod"
          ],
          "line": 2167
        },
        "resolved": true,
        "details": {
          "function_name": "module_arch_freeing_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2122-2124",
          "snippet": "void __weak module_arch_freeing_init(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_arch_freeing_init(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 2163
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "synchronize_sched",
          "args": [],
          "line": 2162
        },
        "resolved": true,
        "details": {
          "function_name": "synchronize_sched_expedited_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tree_exp.h",
          "lines": "468-540",
          "snippet": "static void synchronize_sched_expedited_wait(void)\n{\n\tint cpu;\n\tunsigned long jiffies_stall;\n\tunsigned long jiffies_start;\n\tunsigned long mask;\n\tint ndetected;\n\tstruct rcu_node *rnp;\n\tstruct rcu_node *rnp_root = rcu_get_root();\n\tint ret;\n\n\ttrace_rcu_exp_grace_period(rcu_state.name, rcu_exp_gp_seq_endval(), TPS(\"startwait\"));\n\tjiffies_stall = rcu_jiffies_till_stall_check();\n\tjiffies_start = jiffies;\n\n\tfor (;;) {\n\t\tret = swait_event_timeout_exclusive(\n\t\t\t\trcu_state.expedited_wq,\n\t\t\t\tsync_rcu_preempt_exp_done_unlocked(rnp_root),\n\t\t\t\tjiffies_stall);\n\t\tif (ret > 0 || sync_rcu_preempt_exp_done_unlocked(rnp_root))\n\t\t\treturn;\n\t\tWARN_ON(ret < 0);  /* workqueues should not be signaled. */\n\t\tif (rcu_cpu_stall_suppress)\n\t\t\tcontinue;\n\t\tpanic_on_rcu_stall();\n\t\tpr_err(\"INFO: %s detected expedited stalls on CPUs/tasks: {\",\n\t\t       rcu_state.name);\n\t\tndetected = 0;\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tndetected += rcu_print_task_exp_stall(rnp);\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tstruct rcu_data *rdp;\n\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tndetected++;\n\t\t\t\trdp = per_cpu_ptr(&rcu_data, cpu);\n\t\t\t\tpr_cont(\" %d-%c%c%c\", cpu,\n\t\t\t\t\t\"O.\"[!!cpu_online(cpu)],\n\t\t\t\t\t\"o.\"[!!(rdp->grpmask & rnp->expmaskinit)],\n\t\t\t\t\t\"N.\"[!!(rdp->grpmask & rnp->expmaskinitnext)]);\n\t\t\t}\n\t\t}\n\t\tpr_cont(\" } %lu jiffies s: %lu root: %#lx/%c\\n\",\n\t\t\tjiffies - jiffies_start, rcu_state.expedited_sequence,\n\t\t\trnp_root->expmask, \".T\"[!!rnp_root->exp_tasks]);\n\t\tif (ndetected) {\n\t\t\tpr_err(\"blocking rcu_node structures:\");\n\t\t\trcu_for_each_node_breadth_first(rnp) {\n\t\t\t\tif (rnp == rnp_root)\n\t\t\t\t\tcontinue; /* printed unconditionally */\n\t\t\t\tif (sync_rcu_preempt_exp_done_unlocked(rnp))\n\t\t\t\t\tcontinue;\n\t\t\t\tpr_cont(\" l=%u:%d-%d:%#lx/%c\",\n\t\t\t\t\trnp->level, rnp->grplo, rnp->grphi,\n\t\t\t\t\trnp->expmask,\n\t\t\t\t\t\".T\"[!!rnp->exp_tasks]);\n\t\t\t}\n\t\t\tpr_cont(\"\\n\");\n\t\t}\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tdump_cpu_task(cpu);\n\t\t\t}\n\t\t}\n\t\tjiffies_stall = 3 * rcu_jiffies_till_stall_check() + 3;\n\t}\n}",
          "includes": [
            "#include <linux/lockdep.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockdep.h>\n\nstatic void synchronize_sched_expedited_wait(void)\n{\n\tint cpu;\n\tunsigned long jiffies_stall;\n\tunsigned long jiffies_start;\n\tunsigned long mask;\n\tint ndetected;\n\tstruct rcu_node *rnp;\n\tstruct rcu_node *rnp_root = rcu_get_root();\n\tint ret;\n\n\ttrace_rcu_exp_grace_period(rcu_state.name, rcu_exp_gp_seq_endval(), TPS(\"startwait\"));\n\tjiffies_stall = rcu_jiffies_till_stall_check();\n\tjiffies_start = jiffies;\n\n\tfor (;;) {\n\t\tret = swait_event_timeout_exclusive(\n\t\t\t\trcu_state.expedited_wq,\n\t\t\t\tsync_rcu_preempt_exp_done_unlocked(rnp_root),\n\t\t\t\tjiffies_stall);\n\t\tif (ret > 0 || sync_rcu_preempt_exp_done_unlocked(rnp_root))\n\t\t\treturn;\n\t\tWARN_ON(ret < 0);  /* workqueues should not be signaled. */\n\t\tif (rcu_cpu_stall_suppress)\n\t\t\tcontinue;\n\t\tpanic_on_rcu_stall();\n\t\tpr_err(\"INFO: %s detected expedited stalls on CPUs/tasks: {\",\n\t\t       rcu_state.name);\n\t\tndetected = 0;\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tndetected += rcu_print_task_exp_stall(rnp);\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tstruct rcu_data *rdp;\n\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tndetected++;\n\t\t\t\trdp = per_cpu_ptr(&rcu_data, cpu);\n\t\t\t\tpr_cont(\" %d-%c%c%c\", cpu,\n\t\t\t\t\t\"O.\"[!!cpu_online(cpu)],\n\t\t\t\t\t\"o.\"[!!(rdp->grpmask & rnp->expmaskinit)],\n\t\t\t\t\t\"N.\"[!!(rdp->grpmask & rnp->expmaskinitnext)]);\n\t\t\t}\n\t\t}\n\t\tpr_cont(\" } %lu jiffies s: %lu root: %#lx/%c\\n\",\n\t\t\tjiffies - jiffies_start, rcu_state.expedited_sequence,\n\t\t\trnp_root->expmask, \".T\"[!!rnp_root->exp_tasks]);\n\t\tif (ndetected) {\n\t\t\tpr_err(\"blocking rcu_node structures:\");\n\t\t\trcu_for_each_node_breadth_first(rnp) {\n\t\t\t\tif (rnp == rnp_root)\n\t\t\t\t\tcontinue; /* printed unconditionally */\n\t\t\t\tif (sync_rcu_preempt_exp_done_unlocked(rnp))\n\t\t\t\t\tcontinue;\n\t\t\t\tpr_cont(\" l=%u:%d-%d:%#lx/%c\",\n\t\t\t\t\trnp->level, rnp->grplo, rnp->grphi,\n\t\t\t\t\trnp->expmask,\n\t\t\t\t\t\".T\"[!!rnp->exp_tasks]);\n\t\t\t}\n\t\t\tpr_cont(\"\\n\");\n\t\t}\n\t\trcu_for_each_leaf_node(rnp) {\n\t\t\tfor_each_leaf_node_possible_cpu(rnp, cpu) {\n\t\t\t\tmask = leaf_node_cpu_bit(rnp, cpu);\n\t\t\t\tif (!(rnp->expmask & mask))\n\t\t\t\t\tcontinue;\n\t\t\t\tdump_cpu_task(cpu);\n\t\t\t}\n\t\t}\n\t\tjiffies_stall = 3 * rcu_jiffies_till_stall_check() + 3;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_bug_cleanup",
          "args": [
            "mod"
          ],
          "line": 2160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mod_tree_remove",
          "args": [
            "mod"
          ],
          "line": 2158
        },
        "resolved": true,
        "details": {
          "function_name": "mod_tree_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "218-218",
          "snippet": "static void mod_tree_remove(struct module *mod) { }",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_tree_remove(struct module *mod) { }"
        }
      },
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&mod->list"
          ],
          "line": 2157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 2155
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_module_elf",
          "args": [
            "mod"
          ],
          "line": 2152
        },
        "resolved": true,
        "details": {
          "function_name": "free_module_elf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2108-2110",
          "snippet": "static void free_module_elf(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_module_elf(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_livepatch_module",
          "args": [
            "mod"
          ],
          "line": 2151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "destroy_params",
          "args": [
            "mod->kp",
            "mod->num_kp"
          ],
          "line": 2149
        },
        "resolved": true,
        "details": {
          "function_name": "destroy_params",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "734-741",
          "snippet": "void destroy_params(const struct kernel_param *params, unsigned num)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < num; i++)\n\t\tif (params[i].ops->free)\n\t\t\tparams[i].ops->free(params[i].arg);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nvoid destroy_params(const struct kernel_param *params, unsigned num)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < num; i++)\n\t\tif (params[i].ops->free)\n\t\t\tparams[i].ops->free(params[i].arg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_unload_free",
          "args": [
            "mod"
          ],
          "line": 2146
        },
        "resolved": true,
        "details": {
          "function_name": "module_unload_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1153-1155",
          "snippet": "static inline void module_unload_free(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void module_unload_free(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_arch_cleanup",
          "args": [
            "mod"
          ],
          "line": 2143
        },
        "resolved": true,
        "details": {
          "function_name": "module_arch_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "2118-2120",
          "snippet": "void __weak module_arch_cleanup(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_arch_cleanup(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "ddebug_remove_module",
          "args": [
            "mod->name"
          ],
          "line": 2140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mod_sysfs_teardown",
          "args": [
            "mod"
          ],
          "line": 2131
        },
        "resolved": true,
        "details": {
          "function_name": "mod_sysfs_teardown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1868-1876",
          "snippet": "static void mod_sysfs_teardown(struct module *mod)\n{\n\tdel_usage_links(mod);\n\tmodule_remove_modinfo_attrs(mod);\n\tmodule_param_sysfs_remove(mod);\n\tkobject_put(mod->mkobj.drivers_dir);\n\tkobject_put(mod->holders_dir);\n\tmod_sysfs_fini(mod);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_sysfs_teardown(struct module *mod)\n{\n\tdel_usage_links(mod);\n\tmodule_remove_modinfo_attrs(mod);\n\tmodule_param_sysfs_remove(mod);\n\tkobject_put(mod->mkobj.drivers_dir);\n\tkobject_put(mod->holders_dir);\n\tmod_sysfs_fini(mod);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_module_free",
          "args": [
            "mod"
          ],
          "line": 2129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_module(struct module *mod)\n{\n\ttrace_module_free(mod);\n\n\tmod_sysfs_teardown(mod);\n\n\t/* We leave it in list to prevent duplicate loads, but make sure\n\t * that noone uses it while it's being deconstructed. */\n\tmutex_lock(&module_mutex);\n\tmod->state = MODULE_STATE_UNFORMED;\n\tmutex_unlock(&module_mutex);\n\n\t/* Remove dynamic debug info */\n\tddebug_remove_module(mod->name);\n\n\t/* Arch-specific cleanup. */\n\tmodule_arch_cleanup(mod);\n\n\t/* Module unload stuff */\n\tmodule_unload_free(mod);\n\n\t/* Free any allocated parameters. */\n\tdestroy_params(mod->kp, mod->num_kp);\n\n\tif (is_livepatch_module(mod))\n\t\tfree_module_elf(mod);\n\n\t/* Now we can delete it from the lists */\n\tmutex_lock(&module_mutex);\n\t/* Unlink carefully: kallsyms could be walking list. */\n\tlist_del_rcu(&mod->list);\n\tmod_tree_remove(mod);\n\t/* Remove this module from bug list, this uses list_del_rcu */\n\tmodule_bug_cleanup(mod);\n\t/* Wait for RCU-sched synchronizing before releasing mod->list and buglist. */\n\tsynchronize_sched();\n\tmutex_unlock(&module_mutex);\n\n\t/* This may be empty, but that's OK */\n\tdisable_ro_nx(&mod->init_layout);\n\tmodule_arch_freeing_init(mod);\n\tmodule_memfree(mod->init_layout.base);\n\tkfree(mod->args);\n\tpercpu_modfree(mod);\n\n\t/* Free lock-classes; relies on the preceding sync_rcu(). */\n\tlockdep_free_key_range(mod->core_layout.base, mod->core_layout.size);\n\n\t/* Finally, free the core (containing the module structure) */\n\tdisable_ro_nx(&mod->core_layout);\n\tmodule_memfree(mod->core_layout.base);\n}"
  },
  {
    "function_name": "module_arch_freeing_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2122-2124",
    "snippet": "void __weak module_arch_freeing_init(struct module *mod)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_arch_freeing_init(struct module *mod)\n{\n}"
  },
  {
    "function_name": "module_arch_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2118-2120",
    "snippet": "void __weak module_arch_cleanup(struct module *mod)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_arch_cleanup(struct module *mod)\n{\n}"
  },
  {
    "function_name": "module_memfree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2113-2116",
    "snippet": "void __weak module_memfree(void *module_region)\n{\n\tvfree(module_region);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfree",
          "args": [
            "module_region"
          ],
          "line": 2115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __weak module_memfree(void *module_region)\n{\n\tvfree(module_region);\n}"
  },
  {
    "function_name": "free_module_elf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2108-2110",
    "snippet": "static void free_module_elf(struct module *mod)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_module_elf(struct module *mod)\n{\n}"
  },
  {
    "function_name": "copy_module_elf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2103-2106",
    "snippet": "static int copy_module_elf(struct module *mod, struct load_info *info)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int copy_module_elf(struct module *mod, struct load_info *info)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "free_module_elf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2096-2101",
    "snippet": "static void free_module_elf(struct module *mod)\n{\n\tkfree(mod->klp_info->sechdrs);\n\tkfree(mod->klp_info->secstrings);\n\tkfree(mod->klp_info);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "mod->klp_info"
          ],
          "line": 2100
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_module_elf(struct module *mod)\n{\n\tkfree(mod->klp_info->sechdrs);\n\tkfree(mod->klp_info->secstrings);\n\tkfree(mod->klp_info);\n}"
  },
  {
    "function_name": "copy_module_elf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2044-2094",
    "snippet": "static int copy_module_elf(struct module *mod, struct load_info *info)\n{\n\tunsigned int size, symndx;\n\tint ret;\n\n\tsize = sizeof(*mod->klp_info);\n\tmod->klp_info = kmalloc(size, GFP_KERNEL);\n\tif (mod->klp_info == NULL)\n\t\treturn -ENOMEM;\n\n\t/* Elf header */\n\tsize = sizeof(mod->klp_info->hdr);\n\tmemcpy(&mod->klp_info->hdr, info->hdr, size);\n\n\t/* Elf section header table */\n\tsize = sizeof(*info->sechdrs) * info->hdr->e_shnum;\n\tmod->klp_info->sechdrs = kmemdup(info->sechdrs, size, GFP_KERNEL);\n\tif (mod->klp_info->sechdrs == NULL) {\n\t\tret = -ENOMEM;\n\t\tgoto free_info;\n\t}\n\n\t/* Elf section name string table */\n\tsize = info->sechdrs[info->hdr->e_shstrndx].sh_size;\n\tmod->klp_info->secstrings = kmemdup(info->secstrings, size, GFP_KERNEL);\n\tif (mod->klp_info->secstrings == NULL) {\n\t\tret = -ENOMEM;\n\t\tgoto free_sechdrs;\n\t}\n\n\t/* Elf symbol section index */\n\tsymndx = info->index.sym;\n\tmod->klp_info->symndx = symndx;\n\n\t/*\n\t * For livepatch modules, core_kallsyms.symtab is a complete\n\t * copy of the original symbol table. Adjust sh_addr to point\n\t * to core_kallsyms.symtab since the copy of the symtab in module\n\t * init memory is freed at the end of do_init_module().\n\t */\n\tmod->klp_info->sechdrs[symndx].sh_addr = \\\n\t\t(unsigned long) mod->core_kallsyms.symtab;\n\n\treturn 0;\n\nfree_sechdrs:\n\tkfree(mod->klp_info->sechdrs);\nfree_info:\n\tkfree(mod->klp_info);\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "mod->klp_info"
          ],
          "line": 2092
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmemdup",
          "args": [
            "info->secstrings",
            "size",
            "GFP_KERNEL"
          ],
          "line": 2068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmemdup",
          "args": [
            "info->sechdrs",
            "size",
            "GFP_KERNEL"
          ],
          "line": 2060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&mod->klp_info->hdr",
            "info->hdr",
            "size"
          ],
          "line": 2056
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy_skip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/events/internal.h",
          "lines": "178-182",
          "snippet": "static inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/hardirq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/hardirq.h>\n\nstatic inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "size",
            "GFP_KERNEL"
          ],
          "line": 2050
        },
        "resolved": true,
        "details": {
          "function_name": "debug_kmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/debug/kdb/kdb_support.c",
          "lines": "745-801",
          "snippet": "void *debug_kmalloc(size_t size, gfp_t flags)\n{\n\tunsigned int rem, h_offset;\n\tstruct debug_alloc_header *best, *bestprev, *prev, *h;\n\tvoid *p = NULL;\n\tif (!get_dap_lock()) {\n\t\t__release(dap_lock);\t/* we never actually got it */\n\t\treturn NULL;\n\t}\n\th = (struct debug_alloc_header *)(debug_alloc_pool + dah_first);\n\tif (dah_first_call) {\n\t\th->size = sizeof(debug_alloc_pool_aligned) - dah_overhead;\n\t\tdah_first_call = 0;\n\t}\n\tsize = ALIGN(size, dah_align);\n\tprev = best = bestprev = NULL;\n\twhile (1) {\n\t\tif (h->size >= size && (!best || h->size < best->size)) {\n\t\t\tbest = h;\n\t\t\tbestprev = prev;\n\t\t\tif (h->size == size)\n\t\t\t\tbreak;\n\t\t}\n\t\tif (!h->next)\n\t\t\tbreak;\n\t\tprev = h;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h->next);\n\t}\n\tif (!best)\n\t\tgoto out;\n\trem = best->size - size;\n\t/* The pool must always contain at least one header */\n\tif (best->next == 0 && bestprev == NULL && rem < dah_overhead)\n\t\tgoto out;\n\tif (rem >= dah_overhead) {\n\t\tbest->size = size;\n\t\th_offset = ((char *)best - debug_alloc_pool) +\n\t\t\t   dah_overhead + best->size;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h_offset);\n\t\th->size = rem - dah_overhead;\n\t\th->next = best->next;\n\t} else\n\t\th_offset = best->next;\n\tbest->caller = __builtin_return_address(0);\n\tdah_used += best->size;\n\tdah_used_max = max(dah_used, dah_used_max);\n\tif (bestprev)\n\t\tbestprev->next = h_offset;\n\telse\n\t\tdah_first = h_offset;\n\tp = (char *)best + dah_overhead;\n\tmemset(p, POISON_INUSE, best->size - 1);\n\t*((char *)p + best->size - 1) = POISON_END;\nout:\n\tspin_unlock(&dap_lock);\n\treturn p;\n}",
          "includes": [
            "#include \"kdb_private.h\"",
            "#include <linux/slab.h>",
            "#include <linux/kdb.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/highmem.h>",
            "#include <linux/module.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/stddef.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define dah_overhead ALIGN(sizeof(struct debug_alloc_header), dah_align)",
            "#define dah_align 8"
          ],
          "globals_used": [
            "static u64 debug_alloc_pool_aligned[256*1024/dah_align];",
            "static char *debug_alloc_pool = (char *)debug_alloc_pool_aligned;",
            "static u32 dah_first, dah_first_call = 1, dah_used, dah_used_max;",
            "static DEFINE_SPINLOCK(dap_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kdb_private.h\"\n#include <linux/slab.h>\n#include <linux/kdb.h>\n#include <linux/uaccess.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/highmem.h>\n#include <linux/module.h>\n#include <linux/ptrace.h>\n#include <linux/vmalloc.h>\n#include <linux/stddef.h>\n#include <linux/kallsyms.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n#include <stdarg.h>\n\n#define dah_overhead ALIGN(sizeof(struct debug_alloc_header), dah_align)\n#define dah_align 8\n\nstatic u64 debug_alloc_pool_aligned[256*1024/dah_align];\nstatic char *debug_alloc_pool = (char *)debug_alloc_pool_aligned;\nstatic u32 dah_first, dah_first_call = 1, dah_used, dah_used_max;\nstatic DEFINE_SPINLOCK(dap_lock);\n\nvoid *debug_kmalloc(size_t size, gfp_t flags)\n{\n\tunsigned int rem, h_offset;\n\tstruct debug_alloc_header *best, *bestprev, *prev, *h;\n\tvoid *p = NULL;\n\tif (!get_dap_lock()) {\n\t\t__release(dap_lock);\t/* we never actually got it */\n\t\treturn NULL;\n\t}\n\th = (struct debug_alloc_header *)(debug_alloc_pool + dah_first);\n\tif (dah_first_call) {\n\t\th->size = sizeof(debug_alloc_pool_aligned) - dah_overhead;\n\t\tdah_first_call = 0;\n\t}\n\tsize = ALIGN(size, dah_align);\n\tprev = best = bestprev = NULL;\n\twhile (1) {\n\t\tif (h->size >= size && (!best || h->size < best->size)) {\n\t\t\tbest = h;\n\t\t\tbestprev = prev;\n\t\t\tif (h->size == size)\n\t\t\t\tbreak;\n\t\t}\n\t\tif (!h->next)\n\t\t\tbreak;\n\t\tprev = h;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h->next);\n\t}\n\tif (!best)\n\t\tgoto out;\n\trem = best->size - size;\n\t/* The pool must always contain at least one header */\n\tif (best->next == 0 && bestprev == NULL && rem < dah_overhead)\n\t\tgoto out;\n\tif (rem >= dah_overhead) {\n\t\tbest->size = size;\n\t\th_offset = ((char *)best - debug_alloc_pool) +\n\t\t\t   dah_overhead + best->size;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h_offset);\n\t\th->size = rem - dah_overhead;\n\t\th->next = best->next;\n\t} else\n\t\th_offset = best->next;\n\tbest->caller = __builtin_return_address(0);\n\tdah_used += best->size;\n\tdah_used_max = max(dah_used, dah_used_max);\n\tif (bestprev)\n\t\tbestprev->next = h_offset;\n\telse\n\t\tdah_first = h_offset;\n\tp = (char *)best + dah_overhead;\n\tmemset(p, POISON_INUSE, best->size - 1);\n\t*((char *)p + best->size - 1) = POISON_END;\nout:\n\tspin_unlock(&dap_lock);\n\treturn p;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic int copy_module_elf(struct module *mod, struct load_info *info)\n{\n\tunsigned int size, symndx;\n\tint ret;\n\n\tsize = sizeof(*mod->klp_info);\n\tmod->klp_info = kmalloc(size, GFP_KERNEL);\n\tif (mod->klp_info == NULL)\n\t\treturn -ENOMEM;\n\n\t/* Elf header */\n\tsize = sizeof(mod->klp_info->hdr);\n\tmemcpy(&mod->klp_info->hdr, info->hdr, size);\n\n\t/* Elf section header table */\n\tsize = sizeof(*info->sechdrs) * info->hdr->e_shnum;\n\tmod->klp_info->sechdrs = kmemdup(info->sechdrs, size, GFP_KERNEL);\n\tif (mod->klp_info->sechdrs == NULL) {\n\t\tret = -ENOMEM;\n\t\tgoto free_info;\n\t}\n\n\t/* Elf section name string table */\n\tsize = info->sechdrs[info->hdr->e_shstrndx].sh_size;\n\tmod->klp_info->secstrings = kmemdup(info->secstrings, size, GFP_KERNEL);\n\tif (mod->klp_info->secstrings == NULL) {\n\t\tret = -ENOMEM;\n\t\tgoto free_sechdrs;\n\t}\n\n\t/* Elf symbol section index */\n\tsymndx = info->index.sym;\n\tmod->klp_info->symndx = symndx;\n\n\t/*\n\t * For livepatch modules, core_kallsyms.symtab is a complete\n\t * copy of the original symbol table. Adjust sh_addr to point\n\t * to core_kallsyms.symtab since the copy of the symtab in module\n\t * init memory is freed at the end of do_init_module().\n\t */\n\tmod->klp_info->sechdrs[symndx].sh_addr = \\\n\t\t(unsigned long) mod->core_kallsyms.symtab;\n\n\treturn 0;\n\nfree_sechdrs:\n\tkfree(mod->klp_info->sechdrs);\nfree_info:\n\tkfree(mod->klp_info);\n\treturn ret;\n}"
  },
  {
    "function_name": "module_disable_nx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2035-2035",
    "snippet": "static void module_disable_nx(const struct module *mod) { }",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_disable_nx(const struct module *mod) { }"
  },
  {
    "function_name": "module_enable_nx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2034-2034",
    "snippet": "static void module_enable_nx(const struct module *mod) { }",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_enable_nx(const struct module *mod) { }"
  },
  {
    "function_name": "disable_ro_nx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2033-2033",
    "snippet": "static void disable_ro_nx(const struct module_layout *layout) { }",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void disable_ro_nx(const struct module_layout *layout) { }"
  },
  {
    "function_name": "disable_ro_nx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "2020-2030",
    "snippet": "static void disable_ro_nx(const struct module_layout *layout)\n{\n\tif (rodata_enabled) {\n\t\tfrob_text(layout, set_memory_rw);\n\t\tfrob_rodata(layout, set_memory_rw);\n\t\tfrob_ro_after_init(layout, set_memory_rw);\n\t}\n\tfrob_rodata(layout, set_memory_x);\n\tfrob_ro_after_init(layout, set_memory_x);\n\tfrob_writable_data(layout, set_memory_x);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "frob_writable_data",
          "args": [
            "layout",
            "set_memory_x"
          ],
          "line": 2029
        },
        "resolved": true,
        "details": {
          "function_name": "frob_writable_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1921-1929",
          "snippet": "static void frob_writable_data(const struct module_layout *layout,\n\t\t\t       int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_after_init_size,\n\t\t   (layout->size - layout->ro_after_init_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_writable_data(const struct module_layout *layout,\n\t\t\t       int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_after_init_size,\n\t\t   (layout->size - layout->ro_after_init_size) >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_ro_after_init",
          "args": [
            "layout",
            "set_memory_x"
          ],
          "line": 2028
        },
        "resolved": true,
        "details": {
          "function_name": "frob_ro_after_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1911-1919",
          "snippet": "static void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_rodata",
          "args": [
            "layout",
            "set_memory_x"
          ],
          "line": 2027
        },
        "resolved": true,
        "details": {
          "function_name": "frob_rodata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1901-1909",
          "snippet": "static void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_text",
          "args": [
            "layout",
            "set_memory_rw"
          ],
          "line": 2023
        },
        "resolved": true,
        "details": {
          "function_name": "frob_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1892-1899",
          "snippet": "static void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void disable_ro_nx(const struct module_layout *layout)\n{\n\tif (rodata_enabled) {\n\t\tfrob_text(layout, set_memory_rw);\n\t\tfrob_rodata(layout, set_memory_rw);\n\t\tfrob_ro_after_init(layout, set_memory_rw);\n\t}\n\tfrob_rodata(layout, set_memory_x);\n\tfrob_ro_after_init(layout, set_memory_x);\n\tfrob_writable_data(layout, set_memory_x);\n}"
  },
  {
    "function_name": "set_all_modules_text_ro",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1996-2018",
    "snippet": "void set_all_modules_text_ro(void)\n{\n\tstruct module *mod;\n\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\t/*\n\t\t * Ignore going modules since it's possible that ro\n\t\t * protection has already been disabled, otherwise we'll\n\t\t * run into protection faults at module deallocation.\n\t\t */\n\t\tif (mod->state == MODULE_STATE_UNFORMED ||\n\t\t\tmod->state == MODULE_STATE_GOING)\n\t\t\tcontinue;\n\n\t\tfrob_text(&mod->core_layout, set_memory_ro);\n\t\tfrob_text(&mod->init_layout, set_memory_ro);\n\t}\n\tmutex_unlock(&module_mutex);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 2017
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_text",
          "args": [
            "&mod->init_layout",
            "set_memory_ro"
          ],
          "line": 2015
        },
        "resolved": true,
        "details": {
          "function_name": "frob_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1892-1899",
          "snippet": "static void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 2004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 2003
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nvoid set_all_modules_text_ro(void)\n{\n\tstruct module *mod;\n\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\t/*\n\t\t * Ignore going modules since it's possible that ro\n\t\t * protection has already been disabled, otherwise we'll\n\t\t * run into protection faults at module deallocation.\n\t\t */\n\t\tif (mod->state == MODULE_STATE_UNFORMED ||\n\t\t\tmod->state == MODULE_STATE_GOING)\n\t\t\tcontinue;\n\n\t\tfrob_text(&mod->core_layout, set_memory_ro);\n\t\tfrob_text(&mod->init_layout, set_memory_ro);\n\t}\n\tmutex_unlock(&module_mutex);\n}"
  },
  {
    "function_name": "set_all_modules_text_rw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1977-1993",
    "snippet": "void set_all_modules_text_rw(void)\n{\n\tstruct module *mod;\n\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\n\t\tfrob_text(&mod->core_layout, set_memory_rw);\n\t\tfrob_text(&mod->init_layout, set_memory_rw);\n\t}\n\tmutex_unlock(&module_mutex);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 1992
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_text",
          "args": [
            "&mod->init_layout",
            "set_memory_rw"
          ],
          "line": 1990
        },
        "resolved": true,
        "details": {
          "function_name": "frob_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1892-1899",
          "snippet": "static void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 1985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 1984
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nvoid set_all_modules_text_rw(void)\n{\n\tstruct module *mod;\n\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\n\t\tfrob_text(&mod->core_layout, set_memory_rw);\n\t\tfrob_text(&mod->init_layout, set_memory_rw);\n\t}\n\tmutex_unlock(&module_mutex);\n}"
  },
  {
    "function_name": "module_disable_nx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1967-1974",
    "snippet": "static void module_disable_nx(const struct module *mod)\n{\n\tfrob_rodata(&mod->core_layout, set_memory_x);\n\tfrob_ro_after_init(&mod->core_layout, set_memory_x);\n\tfrob_writable_data(&mod->core_layout, set_memory_x);\n\tfrob_rodata(&mod->init_layout, set_memory_x);\n\tfrob_writable_data(&mod->init_layout, set_memory_x);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "frob_writable_data",
          "args": [
            "&mod->init_layout",
            "set_memory_x"
          ],
          "line": 1973
        },
        "resolved": true,
        "details": {
          "function_name": "frob_writable_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1921-1929",
          "snippet": "static void frob_writable_data(const struct module_layout *layout,\n\t\t\t       int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_after_init_size,\n\t\t   (layout->size - layout->ro_after_init_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_writable_data(const struct module_layout *layout,\n\t\t\t       int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_after_init_size,\n\t\t   (layout->size - layout->ro_after_init_size) >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_rodata",
          "args": [
            "&mod->init_layout",
            "set_memory_x"
          ],
          "line": 1972
        },
        "resolved": true,
        "details": {
          "function_name": "frob_rodata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1901-1909",
          "snippet": "static void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_ro_after_init",
          "args": [
            "&mod->core_layout",
            "set_memory_x"
          ],
          "line": 1970
        },
        "resolved": true,
        "details": {
          "function_name": "frob_ro_after_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1911-1919",
          "snippet": "static void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_disable_nx(const struct module *mod)\n{\n\tfrob_rodata(&mod->core_layout, set_memory_x);\n\tfrob_ro_after_init(&mod->core_layout, set_memory_x);\n\tfrob_writable_data(&mod->core_layout, set_memory_x);\n\tfrob_rodata(&mod->init_layout, set_memory_x);\n\tfrob_writable_data(&mod->init_layout, set_memory_x);\n}"
  },
  {
    "function_name": "module_enable_nx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1958-1965",
    "snippet": "static void module_enable_nx(const struct module *mod)\n{\n\tfrob_rodata(&mod->core_layout, set_memory_nx);\n\tfrob_ro_after_init(&mod->core_layout, set_memory_nx);\n\tfrob_writable_data(&mod->core_layout, set_memory_nx);\n\tfrob_rodata(&mod->init_layout, set_memory_nx);\n\tfrob_writable_data(&mod->init_layout, set_memory_nx);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "frob_writable_data",
          "args": [
            "&mod->init_layout",
            "set_memory_nx"
          ],
          "line": 1964
        },
        "resolved": true,
        "details": {
          "function_name": "frob_writable_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1921-1929",
          "snippet": "static void frob_writable_data(const struct module_layout *layout,\n\t\t\t       int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_after_init_size,\n\t\t   (layout->size - layout->ro_after_init_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_writable_data(const struct module_layout *layout,\n\t\t\t       int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_after_init_size,\n\t\t   (layout->size - layout->ro_after_init_size) >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_rodata",
          "args": [
            "&mod->init_layout",
            "set_memory_nx"
          ],
          "line": 1963
        },
        "resolved": true,
        "details": {
          "function_name": "frob_rodata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1901-1909",
          "snippet": "static void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_ro_after_init",
          "args": [
            "&mod->core_layout",
            "set_memory_nx"
          ],
          "line": 1961
        },
        "resolved": true,
        "details": {
          "function_name": "frob_ro_after_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1911-1919",
          "snippet": "static void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_enable_nx(const struct module *mod)\n{\n\tfrob_rodata(&mod->core_layout, set_memory_nx);\n\tfrob_ro_after_init(&mod->core_layout, set_memory_nx);\n\tfrob_writable_data(&mod->core_layout, set_memory_nx);\n\tfrob_rodata(&mod->init_layout, set_memory_nx);\n\tfrob_writable_data(&mod->init_layout, set_memory_nx);\n}"
  },
  {
    "function_name": "module_enable_ro",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1944-1956",
    "snippet": "void module_enable_ro(const struct module *mod, bool after_init)\n{\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tfrob_text(&mod->core_layout, set_memory_ro);\n\tfrob_rodata(&mod->core_layout, set_memory_ro);\n\tfrob_text(&mod->init_layout, set_memory_ro);\n\tfrob_rodata(&mod->init_layout, set_memory_ro);\n\n\tif (after_init)\n\t\tfrob_ro_after_init(&mod->core_layout, set_memory_ro);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "frob_ro_after_init",
          "args": [
            "&mod->core_layout",
            "set_memory_ro"
          ],
          "line": 1955
        },
        "resolved": true,
        "details": {
          "function_name": "frob_ro_after_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1911-1919",
          "snippet": "static void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_rodata",
          "args": [
            "&mod->init_layout",
            "set_memory_ro"
          ],
          "line": 1952
        },
        "resolved": true,
        "details": {
          "function_name": "frob_rodata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1901-1909",
          "snippet": "static void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_text",
          "args": [
            "&mod->init_layout",
            "set_memory_ro"
          ],
          "line": 1951
        },
        "resolved": true,
        "details": {
          "function_name": "frob_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1892-1899",
          "snippet": "static void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_enable_ro(const struct module *mod, bool after_init)\n{\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tfrob_text(&mod->core_layout, set_memory_ro);\n\tfrob_rodata(&mod->core_layout, set_memory_ro);\n\tfrob_text(&mod->init_layout, set_memory_ro);\n\tfrob_rodata(&mod->init_layout, set_memory_ro);\n\n\tif (after_init)\n\t\tfrob_ro_after_init(&mod->core_layout, set_memory_ro);\n}"
  },
  {
    "function_name": "module_disable_ro",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1932-1942",
    "snippet": "void module_disable_ro(const struct module *mod)\n{\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tfrob_text(&mod->core_layout, set_memory_rw);\n\tfrob_rodata(&mod->core_layout, set_memory_rw);\n\tfrob_ro_after_init(&mod->core_layout, set_memory_rw);\n\tfrob_text(&mod->init_layout, set_memory_rw);\n\tfrob_rodata(&mod->init_layout, set_memory_rw);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "frob_rodata",
          "args": [
            "&mod->init_layout",
            "set_memory_rw"
          ],
          "line": 1941
        },
        "resolved": true,
        "details": {
          "function_name": "frob_rodata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1901-1909",
          "snippet": "static void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_text",
          "args": [
            "&mod->init_layout",
            "set_memory_rw"
          ],
          "line": 1940
        },
        "resolved": true,
        "details": {
          "function_name": "frob_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1892-1899",
          "snippet": "static void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "frob_ro_after_init",
          "args": [
            "&mod->core_layout",
            "set_memory_rw"
          ],
          "line": 1939
        },
        "resolved": true,
        "details": {
          "function_name": "frob_ro_after_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1911-1919",
          "snippet": "static void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_disable_ro(const struct module *mod)\n{\n\tif (!rodata_enabled)\n\t\treturn;\n\n\tfrob_text(&mod->core_layout, set_memory_rw);\n\tfrob_rodata(&mod->core_layout, set_memory_rw);\n\tfrob_ro_after_init(&mod->core_layout, set_memory_rw);\n\tfrob_text(&mod->init_layout, set_memory_rw);\n\tfrob_rodata(&mod->init_layout, set_memory_rw);\n}"
  },
  {
    "function_name": "frob_writable_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1921-1929",
    "snippet": "static void frob_writable_data(const struct module_layout *layout,\n\t\t\t       int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_after_init_size,\n\t\t   (layout->size - layout->ro_after_init_size) >> PAGE_SHIFT);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_memory",
          "args": [
            "(unsigned long)layout->base + layout->ro_after_init_size",
            "(layout->size - layout->ro_after_init_size) >> PAGE_SHIFT"
          ],
          "line": 1927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(unsigned long)layout->size & (PAGE_SIZE-1)"
          ],
          "line": 1926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1)"
          ],
          "line": 1925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(unsigned long)layout->base & (PAGE_SIZE-1)"
          ],
          "line": 1924
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_writable_data(const struct module_layout *layout,\n\t\t\t       int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_after_init_size,\n\t\t   (layout->size - layout->ro_after_init_size) >> PAGE_SHIFT);\n}"
  },
  {
    "function_name": "frob_ro_after_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1911-1919",
    "snippet": "static void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_memory",
          "args": [
            "(unsigned long)layout->base + layout->ro_size",
            "(layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT"
          ],
          "line": 1917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1)"
          ],
          "line": 1916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(unsigned long)layout->ro_size & (PAGE_SIZE-1)"
          ],
          "line": 1915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(unsigned long)layout->base & (PAGE_SIZE-1)"
          ],
          "line": 1914
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_ro_after_init(const struct module_layout *layout,\n\t\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_after_init_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->ro_size,\n\t\t   (layout->ro_after_init_size - layout->ro_size) >> PAGE_SHIFT);\n}"
  },
  {
    "function_name": "frob_rodata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1901-1909",
    "snippet": "static void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_memory",
          "args": [
            "(unsigned long)layout->base + layout->text_size",
            "(layout->ro_size - layout->text_size) >> PAGE_SHIFT"
          ],
          "line": 1907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(unsigned long)layout->ro_size & (PAGE_SIZE-1)"
          ],
          "line": 1906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(unsigned long)layout->text_size & (PAGE_SIZE-1)"
          ],
          "line": 1905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(unsigned long)layout->base & (PAGE_SIZE-1)"
          ],
          "line": 1904
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_rodata(const struct module_layout *layout,\n\t\t\tint (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->ro_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base + layout->text_size,\n\t\t   (layout->ro_size - layout->text_size) >> PAGE_SHIFT);\n}"
  },
  {
    "function_name": "frob_text",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1892-1899",
    "snippet": "static void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_memory",
          "args": [
            "(unsigned long)layout->base",
            "layout->text_size >> PAGE_SHIFT"
          ],
          "line": 1897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(unsigned long)layout->text_size & (PAGE_SIZE-1)"
          ],
          "line": 1896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "(unsigned long)layout->base & (PAGE_SIZE-1)"
          ],
          "line": 1895
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void frob_text(const struct module_layout *layout,\n\t\t      int (*set_memory)(unsigned long start, int num_pages))\n{\n\tBUG_ON((unsigned long)layout->base & (PAGE_SIZE-1));\n\tBUG_ON((unsigned long)layout->text_size & (PAGE_SIZE-1));\n\tset_memory((unsigned long)layout->base,\n\t\t   layout->text_size >> PAGE_SHIFT);\n}"
  },
  {
    "function_name": "mod_sysfs_teardown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1868-1876",
    "snippet": "static void mod_sysfs_teardown(struct module *mod)\n{\n\tdel_usage_links(mod);\n\tmodule_remove_modinfo_attrs(mod);\n\tmodule_param_sysfs_remove(mod);\n\tkobject_put(mod->mkobj.drivers_dir);\n\tkobject_put(mod->holders_dir);\n\tmod_sysfs_fini(mod);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mod_sysfs_fini",
          "args": [
            "mod"
          ],
          "line": 1875
        },
        "resolved": true,
        "details": {
          "function_name": "mod_sysfs_fini",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1851-1853",
          "snippet": "static void mod_sysfs_fini(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_sysfs_fini(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "mod->holders_dir"
          ],
          "line": 1874
        },
        "resolved": true,
        "details": {
          "function_name": "mod_kobject_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1742-1748",
          "snippet": "static void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_param_sysfs_remove",
          "args": [
            "mod"
          ],
          "line": 1872
        },
        "resolved": true,
        "details": {
          "function_name": "module_param_sysfs_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "723-731",
          "snippet": "void module_param_sysfs_remove(struct module *mod)\n{\n\tif (mod->mkobj.mp) {\n\t\tsysfs_remove_group(&mod->mkobj.kobj, &mod->mkobj.mp->grp);\n\t\t/* We are positive that no one is using any param\n\t\t * attrs at this point.  Deallocate immediately. */\n\t\tfree_module_param_attrs(&mod->mkobj);\n\t}\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nvoid module_param_sysfs_remove(struct module *mod)\n{\n\tif (mod->mkobj.mp) {\n\t\tsysfs_remove_group(&mod->mkobj.kobj, &mod->mkobj.mp->grp);\n\t\t/* We are positive that no one is using any param\n\t\t * attrs at this point.  Deallocate immediately. */\n\t\tfree_module_param_attrs(&mod->mkobj);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_remove_modinfo_attrs",
          "args": [
            "mod"
          ],
          "line": 1871
        },
        "resolved": true,
        "details": {
          "function_name": "module_remove_modinfo_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1855-1857",
          "snippet": "static void module_remove_modinfo_attrs(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_remove_modinfo_attrs(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "del_usage_links",
          "args": [
            "mod"
          ],
          "line": 1870
        },
        "resolved": true,
        "details": {
          "function_name": "del_usage_links",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1859-1861",
          "snippet": "static void del_usage_links(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void del_usage_links(struct module *mod)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_sysfs_teardown(struct module *mod)\n{\n\tdel_usage_links(mod);\n\tmodule_remove_modinfo_attrs(mod);\n\tmodule_param_sysfs_remove(mod);\n\tkobject_put(mod->mkobj.drivers_dir);\n\tkobject_put(mod->holders_dir);\n\tmod_sysfs_fini(mod);\n}"
  },
  {
    "function_name": "init_param_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1863-1865",
    "snippet": "static void init_param_lock(struct module *mod)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void init_param_lock(struct module *mod)\n{\n}"
  },
  {
    "function_name": "del_usage_links",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1859-1861",
    "snippet": "static void del_usage_links(struct module *mod)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void del_usage_links(struct module *mod)\n{\n}"
  },
  {
    "function_name": "module_remove_modinfo_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1855-1857",
    "snippet": "static void module_remove_modinfo_attrs(struct module *mod)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_remove_modinfo_attrs(struct module *mod)\n{\n}"
  },
  {
    "function_name": "mod_sysfs_fini",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1851-1853",
    "snippet": "static void mod_sysfs_fini(struct module *mod)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_sysfs_fini(struct module *mod)\n{\n}"
  },
  {
    "function_name": "mod_sysfs_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1843-1849",
    "snippet": "static int mod_sysfs_setup(struct module *mod,\n\t\t\t   const struct load_info *info,\n\t\t\t   struct kernel_param *kparam,\n\t\t\t   unsigned int num_params)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int mod_sysfs_setup(struct module *mod,\n\t\t\t   const struct load_info *info,\n\t\t\t   struct kernel_param *kparam,\n\t\t\t   unsigned int num_params)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "init_param_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1837-1840",
    "snippet": "static void init_param_lock(struct module *mod)\n{\n\tmutex_init(&mod->param_lock);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&mod->param_lock"
          ],
          "line": 1839
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_init_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/fork.c",
          "lines": "1604-1612",
          "snippet": "static void rt_mutex_init_task(struct task_struct *p)\n{\n\traw_spin_lock_init(&p->pi_lock);\n#ifdef CONFIG_RT_MUTEXES\n\tp->pi_waiters = RB_ROOT_CACHED;\n\tp->pi_top_task = NULL;\n\tp->pi_blocked_on = NULL;\n#endif\n}",
          "includes": [
            "#include <linux/init_task.h>",
            "#include <trace/events/task.h>",
            "#include <trace/events/sched.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/stackleak.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/kcov.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/compiler.h>",
            "#include <linux/aio.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/signalfd.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/oom.h>",
            "#include <linux/user-return-notifier.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/magic.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/tty.h>",
            "#include <linux/random.h>",
            "#include <linux/taskstats_kern.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/acct.h>",
            "#include <linux/ksm.h>",
            "#include <linux/rmap.h>",
            "#include <linux/profile.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/kthread.h>",
            "#include <linux/compat.h>",
            "#include <linux/futex.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swap.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/security.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hmm.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mman.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/key.h>",
            "#include <linux/iocontext.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/sem.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/personality.h>",
            "#include <linux/completion.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/module.h>",
            "#include <linux/unistd.h>",
            "#include <linux/init.h>",
            "#include <linux/rtmutex.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __latent_entropy struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/init_task.h>\n#include <trace/events/task.h>\n#include <trace/events/sched.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <asm/pgtable.h>\n#include <linux/stackleak.h>\n#include <linux/thread_info.h>\n#include <linux/livepatch.h>\n#include <linux/kcov.h>\n#include <linux/sysctl.h>\n#include <linux/compiler.h>\n#include <linux/aio.h>\n#include <linux/uprobes.h>\n#include <linux/signalfd.h>\n#include <linux/khugepaged.h>\n#include <linux/oom.h>\n#include <linux/user-return-notifier.h>\n#include <linux/posix-timers.h>\n#include <linux/perf_event.h>\n#include <linux/sched/mm.h>\n#include <linux/magic.h>\n#include <linux/fs_struct.h>\n#include <linux/blkdev.h>\n#include <linux/tty.h>\n#include <linux/random.h>\n#include <linux/taskstats_kern.h>\n#include <linux/delayacct.h>\n#include <linux/freezer.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/acct.h>\n#include <linux/ksm.h>\n#include <linux/rmap.h>\n#include <linux/profile.h>\n#include <linux/proc_fs.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/ptrace.h>\n#include <linux/rcupdate.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/kthread.h>\n#include <linux/compat.h>\n#include <linux/futex.h>\n#include <linux/jiffies.h>\n#include <linux/syscalls.h>\n#include <linux/swap.h>\n#include <linux/seccomp.h>\n#include <linux/hugetlb.h>\n#include <linux/security.h>\n#include <linux/cgroup.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/nsproxy.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hmm.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mman.h>\n#include <linux/binfmts.h>\n#include <linux/key.h>\n#include <linux/iocontext.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/sem.h>\n#include <linux/mempolicy.h>\n#include <linux/personality.h>\n#include <linux/completion.h>\n#include <linux/vmalloc.h>\n#include <linux/module.h>\n#include <linux/unistd.h>\n#include <linux/init.h>\n#include <linux/rtmutex.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/user.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/autogroup.h>\n#include <linux/slab.h>\n\nstatic __latent_entropy struct;\n\nstatic void rt_mutex_init_task(struct task_struct *p)\n{\n\traw_spin_lock_init(&p->pi_lock);\n#ifdef CONFIG_RT_MUTEXES\n\tp->pi_waiters = RB_ROOT_CACHED;\n\tp->pi_top_task = NULL;\n\tp->pi_blocked_on = NULL;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void init_param_lock(struct module *mod)\n{\n\tmutex_init(&mod->param_lock);\n}"
  },
  {
    "function_name": "mod_sysfs_fini",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1830-1835",
    "snippet": "static void mod_sysfs_fini(struct module *mod)\n{\n\tremove_notes_attrs(mod);\n\tremove_sect_attrs(mod);\n\tmod_kobject_put(mod);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mod_kobject_put",
          "args": [
            "mod"
          ],
          "line": 1834
        },
        "resolved": true,
        "details": {
          "function_name": "mod_kobject_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1742-1748",
          "snippet": "static void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_sect_attrs",
          "args": [
            "mod"
          ],
          "line": 1833
        },
        "resolved": true,
        "details": {
          "function_name": "remove_sect_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1654-1656",
          "snippet": "static inline void remove_sect_attrs(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void remove_sect_attrs(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_notes_attrs",
          "args": [
            "mod"
          ],
          "line": 1832
        },
        "resolved": true,
        "details": {
          "function_name": "remove_notes_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1663-1665",
          "snippet": "static inline void remove_notes_attrs(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void remove_notes_attrs(struct module *mod)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_sysfs_fini(struct module *mod)\n{\n\tremove_notes_attrs(mod);\n\tremove_sect_attrs(mod);\n\tmod_kobject_put(mod);\n}"
  },
  {
    "function_name": "mod_sysfs_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1783-1828",
    "snippet": "static int mod_sysfs_setup(struct module *mod,\n\t\t\t   const struct load_info *info,\n\t\t\t   struct kernel_param *kparam,\n\t\t\t   unsigned int num_params)\n{\n\tint err;\n\n\terr = mod_sysfs_init(mod);\n\tif (err)\n\t\tgoto out;\n\n\tmod->holders_dir = kobject_create_and_add(\"holders\", &mod->mkobj.kobj);\n\tif (!mod->holders_dir) {\n\t\terr = -ENOMEM;\n\t\tgoto out_unreg;\n\t}\n\n\terr = module_param_sysfs_setup(mod, kparam, num_params);\n\tif (err)\n\t\tgoto out_unreg_holders;\n\n\terr = module_add_modinfo_attrs(mod);\n\tif (err)\n\t\tgoto out_unreg_param;\n\n\terr = add_usage_links(mod);\n\tif (err)\n\t\tgoto out_unreg_modinfo_attrs;\n\n\tadd_sect_attrs(mod, info);\n\tadd_notes_attrs(mod, info);\n\n\tkobject_uevent(&mod->mkobj.kobj, KOBJ_ADD);\n\treturn 0;\n\nout_unreg_modinfo_attrs:\n\tmodule_remove_modinfo_attrs(mod);\nout_unreg_param:\n\tmodule_param_sysfs_remove(mod);\nout_unreg_holders:\n\tkobject_put(mod->holders_dir);\nout_unreg:\n\tmod_kobject_put(mod);\nout:\n\treturn err;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mod_kobject_put",
          "args": [
            "mod"
          ],
          "line": 1825
        },
        "resolved": true,
        "details": {
          "function_name": "mod_kobject_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1742-1748",
          "snippet": "static void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_param_sysfs_remove",
          "args": [
            "mod"
          ],
          "line": 1821
        },
        "resolved": true,
        "details": {
          "function_name": "module_param_sysfs_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "723-731",
          "snippet": "void module_param_sysfs_remove(struct module *mod)\n{\n\tif (mod->mkobj.mp) {\n\t\tsysfs_remove_group(&mod->mkobj.kobj, &mod->mkobj.mp->grp);\n\t\t/* We are positive that no one is using any param\n\t\t * attrs at this point.  Deallocate immediately. */\n\t\tfree_module_param_attrs(&mod->mkobj);\n\t}\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nvoid module_param_sysfs_remove(struct module *mod)\n{\n\tif (mod->mkobj.mp) {\n\t\tsysfs_remove_group(&mod->mkobj.kobj, &mod->mkobj.mp->grp);\n\t\t/* We are positive that no one is using any param\n\t\t * attrs at this point.  Deallocate immediately. */\n\t\tfree_module_param_attrs(&mod->mkobj);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_remove_modinfo_attrs",
          "args": [
            "mod"
          ],
          "line": 1819
        },
        "resolved": true,
        "details": {
          "function_name": "module_remove_modinfo_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1855-1857",
          "snippet": "static void module_remove_modinfo_attrs(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_remove_modinfo_attrs(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_uevent",
          "args": [
            "&mod->mkobj.kobj",
            "KOBJ_ADD"
          ],
          "line": 1815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_notes_attrs",
          "args": [
            "mod",
            "info"
          ],
          "line": 1813
        },
        "resolved": true,
        "details": {
          "function_name": "add_notes_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1658-1661",
          "snippet": "static inline void add_notes_attrs(struct module *mod,\n\t\t\t\t   const struct load_info *info)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void add_notes_attrs(struct module *mod,\n\t\t\t\t   const struct load_info *info)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_sect_attrs",
          "args": [
            "mod",
            "info"
          ],
          "line": 1812
        },
        "resolved": true,
        "details": {
          "function_name": "add_sect_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1649-1652",
          "snippet": "static inline void add_sect_attrs(struct module *mod,\n\t\t\t\t  const struct load_info *info)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void add_sect_attrs(struct module *mod,\n\t\t\t\t  const struct load_info *info)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_usage_links",
          "args": [
            "mod"
          ],
          "line": 1808
        },
        "resolved": true,
        "details": {
          "function_name": "add_usage_links",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1680-1698",
          "snippet": "static int add_usage_links(struct module *mod)\n{\n\tint ret = 0;\n#ifdef CONFIG_MODULE_UNLOAD\n\tstruct module_use *use;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry(use, &mod->target_list, target_list) {\n\t\tret = sysfs_create_link(use->target->holders_dir,\n\t\t\t\t\t&mod->mkobj.kobj, mod->name);\n\t\tif (ret)\n\t\t\tbreak;\n\t}\n\tmutex_unlock(&module_mutex);\n\tif (ret)\n\t\tdel_usage_links(mod);\n#endif\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int add_usage_links(struct module *mod)\n{\n\tint ret = 0;\n#ifdef CONFIG_MODULE_UNLOAD\n\tstruct module_use *use;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry(use, &mod->target_list, target_list) {\n\t\tret = sysfs_create_link(use->target->holders_dir,\n\t\t\t\t\t&mod->mkobj.kobj, mod->name);\n\t\tif (ret)\n\t\t\tbreak;\n\t}\n\tmutex_unlock(&module_mutex);\n\tif (ret)\n\t\tdel_usage_links(mod);\n#endif\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_add_modinfo_attrs",
          "args": [
            "mod"
          ],
          "line": 1804
        },
        "resolved": true,
        "details": {
          "function_name": "module_add_modinfo_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1700-1724",
          "snippet": "static int module_add_modinfo_attrs(struct module *mod)\n{\n\tstruct module_attribute *attr;\n\tstruct module_attribute *temp_attr;\n\tint error = 0;\n\tint i;\n\n\tmod->modinfo_attrs = kzalloc((sizeof(struct module_attribute) *\n\t\t\t\t\t(ARRAY_SIZE(modinfo_attrs) + 1)),\n\t\t\t\t\tGFP_KERNEL);\n\tif (!mod->modinfo_attrs)\n\t\treturn -ENOMEM;\n\n\ttemp_attr = mod->modinfo_attrs;\n\tfor (i = 0; (attr = modinfo_attrs[i]) && !error; i++) {\n\t\tif (!attr->test || attr->test(mod)) {\n\t\t\tmemcpy(temp_attr, attr, sizeof(*temp_attr));\n\t\t\tsysfs_attr_init(&temp_attr->attr);\n\t\t\terror = sysfs_create_file(&mod->mkobj.kobj,\n\t\t\t\t\t&temp_attr->attr);\n\t\t\t++temp_attr;\n\t\t}\n\t}\n\treturn error;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};\n\nstatic int module_add_modinfo_attrs(struct module *mod)\n{\n\tstruct module_attribute *attr;\n\tstruct module_attribute *temp_attr;\n\tint error = 0;\n\tint i;\n\n\tmod->modinfo_attrs = kzalloc((sizeof(struct module_attribute) *\n\t\t\t\t\t(ARRAY_SIZE(modinfo_attrs) + 1)),\n\t\t\t\t\tGFP_KERNEL);\n\tif (!mod->modinfo_attrs)\n\t\treturn -ENOMEM;\n\n\ttemp_attr = mod->modinfo_attrs;\n\tfor (i = 0; (attr = modinfo_attrs[i]) && !error; i++) {\n\t\tif (!attr->test || attr->test(mod)) {\n\t\t\tmemcpy(temp_attr, attr, sizeof(*temp_attr));\n\t\t\tsysfs_attr_init(&temp_attr->attr);\n\t\t\terror = sysfs_create_file(&mod->mkobj.kobj,\n\t\t\t\t\t&temp_attr->attr);\n\t\t\t++temp_attr;\n\t\t}\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_param_sysfs_setup",
          "args": [
            "mod",
            "kparam",
            "num_params"
          ],
          "line": 1800
        },
        "resolved": true,
        "details": {
          "function_name": "module_param_sysfs_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "688-714",
          "snippet": "int module_param_sysfs_setup(struct module *mod,\n\t\t\t     const struct kernel_param *kparam,\n\t\t\t     unsigned int num_params)\n{\n\tint i, err;\n\tbool params = false;\n\n\tfor (i = 0; i < num_params; i++) {\n\t\tif (kparam[i].perm == 0)\n\t\t\tcontinue;\n\t\terr = add_sysfs_param(&mod->mkobj, &kparam[i], kparam[i].name);\n\t\tif (err) {\n\t\t\tfree_module_param_attrs(&mod->mkobj);\n\t\t\treturn err;\n\t\t}\n\t\tparams = true;\n\t}\n\n\tif (!params)\n\t\treturn 0;\n\n\t/* Create the param group. */\n\terr = sysfs_create_group(&mod->mkobj.kobj, &mod->mkobj.mp->grp);\n\tif (err)\n\t\tfree_module_param_attrs(&mod->mkobj);\n\treturn err;\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nint module_param_sysfs_setup(struct module *mod,\n\t\t\t     const struct kernel_param *kparam,\n\t\t\t     unsigned int num_params)\n{\n\tint i, err;\n\tbool params = false;\n\n\tfor (i = 0; i < num_params; i++) {\n\t\tif (kparam[i].perm == 0)\n\t\t\tcontinue;\n\t\terr = add_sysfs_param(&mod->mkobj, &kparam[i], kparam[i].name);\n\t\tif (err) {\n\t\t\tfree_module_param_attrs(&mod->mkobj);\n\t\t\treturn err;\n\t\t}\n\t\tparams = true;\n\t}\n\n\tif (!params)\n\t\treturn 0;\n\n\t/* Create the param group. */\n\terr = sysfs_create_group(&mod->mkobj.kobj, &mod->mkobj.mp->grp);\n\tif (err)\n\t\tfree_module_param_attrs(&mod->mkobj);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_create_and_add",
          "args": [
            "\"holders\"",
            "&mod->mkobj.kobj"
          ],
          "line": 1794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mod_sysfs_init",
          "args": [
            "mod"
          ],
          "line": 1790
        },
        "resolved": true,
        "details": {
          "function_name": "mod_sysfs_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1750-1781",
          "snippet": "static int mod_sysfs_init(struct module *mod)\n{\n\tint err;\n\tstruct kobject *kobj;\n\n\tif (!module_sysfs_initialized) {\n\t\tpr_err(\"%s: module sysfs not initialized\\n\", mod->name);\n\t\terr = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tkobj = kset_find_obj(module_kset, mod->name);\n\tif (kobj) {\n\t\tpr_err(\"%s: module is already loaded\\n\", mod->name);\n\t\tkobject_put(kobj);\n\t\terr = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tmod->mkobj.mod = mod;\n\n\tmemset(&mod->mkobj.kobj, 0, sizeof(mod->mkobj.kobj));\n\tmod->mkobj.kobj.kset = module_kset;\n\terr = kobject_init_and_add(&mod->mkobj.kobj, &module_ktype, NULL,\n\t\t\t\t   \"%s\", mod->name);\n\tif (err)\n\t\tmod_kobject_put(mod);\n\n\t/* delay uevent until full sysfs population */\nout:\n\treturn err;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int mod_sysfs_init(struct module *mod)\n{\n\tint err;\n\tstruct kobject *kobj;\n\n\tif (!module_sysfs_initialized) {\n\t\tpr_err(\"%s: module sysfs not initialized\\n\", mod->name);\n\t\terr = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tkobj = kset_find_obj(module_kset, mod->name);\n\tif (kobj) {\n\t\tpr_err(\"%s: module is already loaded\\n\", mod->name);\n\t\tkobject_put(kobj);\n\t\terr = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tmod->mkobj.mod = mod;\n\n\tmemset(&mod->mkobj.kobj, 0, sizeof(mod->mkobj.kobj));\n\tmod->mkobj.kobj.kset = module_kset;\n\terr = kobject_init_and_add(&mod->mkobj.kobj, &module_ktype, NULL,\n\t\t\t\t   \"%s\", mod->name);\n\tif (err)\n\t\tmod_kobject_put(mod);\n\n\t/* delay uevent until full sysfs population */\nout:\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int mod_sysfs_setup(struct module *mod,\n\t\t\t   const struct load_info *info,\n\t\t\t   struct kernel_param *kparam,\n\t\t\t   unsigned int num_params)\n{\n\tint err;\n\n\terr = mod_sysfs_init(mod);\n\tif (err)\n\t\tgoto out;\n\n\tmod->holders_dir = kobject_create_and_add(\"holders\", &mod->mkobj.kobj);\n\tif (!mod->holders_dir) {\n\t\terr = -ENOMEM;\n\t\tgoto out_unreg;\n\t}\n\n\terr = module_param_sysfs_setup(mod, kparam, num_params);\n\tif (err)\n\t\tgoto out_unreg_holders;\n\n\terr = module_add_modinfo_attrs(mod);\n\tif (err)\n\t\tgoto out_unreg_param;\n\n\terr = add_usage_links(mod);\n\tif (err)\n\t\tgoto out_unreg_modinfo_attrs;\n\n\tadd_sect_attrs(mod, info);\n\tadd_notes_attrs(mod, info);\n\n\tkobject_uevent(&mod->mkobj.kobj, KOBJ_ADD);\n\treturn 0;\n\nout_unreg_modinfo_attrs:\n\tmodule_remove_modinfo_attrs(mod);\nout_unreg_param:\n\tmodule_param_sysfs_remove(mod);\nout_unreg_holders:\n\tkobject_put(mod->holders_dir);\nout_unreg:\n\tmod_kobject_put(mod);\nout:\n\treturn err;\n}"
  },
  {
    "function_name": "mod_sysfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1750-1781",
    "snippet": "static int mod_sysfs_init(struct module *mod)\n{\n\tint err;\n\tstruct kobject *kobj;\n\n\tif (!module_sysfs_initialized) {\n\t\tpr_err(\"%s: module sysfs not initialized\\n\", mod->name);\n\t\terr = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tkobj = kset_find_obj(module_kset, mod->name);\n\tif (kobj) {\n\t\tpr_err(\"%s: module is already loaded\\n\", mod->name);\n\t\tkobject_put(kobj);\n\t\terr = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tmod->mkobj.mod = mod;\n\n\tmemset(&mod->mkobj.kobj, 0, sizeof(mod->mkobj.kobj));\n\tmod->mkobj.kobj.kset = module_kset;\n\terr = kobject_init_and_add(&mod->mkobj.kobj, &module_ktype, NULL,\n\t\t\t\t   \"%s\", mod->name);\n\tif (err)\n\t\tmod_kobject_put(mod);\n\n\t/* delay uevent until full sysfs population */\nout:\n\treturn err;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mod_kobject_put",
          "args": [
            "mod"
          ],
          "line": 1776
        },
        "resolved": true,
        "details": {
          "function_name": "mod_kobject_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1742-1748",
          "snippet": "static void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_init_and_add",
          "args": [
            "&mod->mkobj.kobj",
            "&module_ktype",
            "NULL",
            "\"%s\"",
            "mod->name"
          ],
          "line": 1773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&mod->mkobj.kobj",
            "0",
            "sizeof(mod->mkobj.kobj)"
          ],
          "line": 1771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s: module is already loaded\\n\"",
            "mod->name"
          ],
          "line": 1763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kset_find_obj",
          "args": [
            "module_kset",
            "mod->name"
          ],
          "line": 1761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s: module sysfs not initialized\\n\"",
            "mod->name"
          ],
          "line": 1756
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int mod_sysfs_init(struct module *mod)\n{\n\tint err;\n\tstruct kobject *kobj;\n\n\tif (!module_sysfs_initialized) {\n\t\tpr_err(\"%s: module sysfs not initialized\\n\", mod->name);\n\t\terr = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tkobj = kset_find_obj(module_kset, mod->name);\n\tif (kobj) {\n\t\tpr_err(\"%s: module is already loaded\\n\", mod->name);\n\t\tkobject_put(kobj);\n\t\terr = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tmod->mkobj.mod = mod;\n\n\tmemset(&mod->mkobj.kobj, 0, sizeof(mod->mkobj.kobj));\n\tmod->mkobj.kobj.kset = module_kset;\n\terr = kobject_init_and_add(&mod->mkobj.kobj, &module_ktype, NULL,\n\t\t\t\t   \"%s\", mod->name);\n\tif (err)\n\t\tmod_kobject_put(mod);\n\n\t/* delay uevent until full sysfs population */\nout:\n\treturn err;\n}"
  },
  {
    "function_name": "mod_kobject_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1742-1748",
    "snippet": "static void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_for_completion",
          "args": [
            "&c"
          ],
          "line": 1747
        },
        "resolved": true,
        "details": {
          "function_name": "try_wait_for_completion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/completion.c",
          "lines": "280-301",
          "snippet": "bool try_wait_for_completion(struct completion *x)\n{\n\tunsigned long flags;\n\tbool ret = true;\n\n\t/*\n\t * Since x->done will need to be locked only\n\t * in the non-blocking case, we check x->done\n\t * first without taking the lock so we can\n\t * return early in the blocking case.\n\t */\n\tif (!READ_ONCE(x->done))\n\t\treturn false;\n\n\tspin_lock_irqsave(&x->wait.lock, flags);\n\tif (!x->done)\n\t\tret = false;\n\telse if (x->done != UINT_MAX)\n\t\tx->done--;\n\tspin_unlock_irqrestore(&x->wait.lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nbool try_wait_for_completion(struct completion *x)\n{\n\tunsigned long flags;\n\tbool ret = true;\n\n\t/*\n\t * Since x->done will need to be locked only\n\t * in the non-blocking case, we check x->done\n\t * first without taking the lock so we can\n\t * return early in the blocking case.\n\t */\n\tif (!READ_ONCE(x->done))\n\t\treturn false;\n\n\tspin_lock_irqsave(&x->wait.lock, flags);\n\tif (!x->done)\n\t\tret = false;\n\telse if (x->done != UINT_MAX)\n\t\tx->done--;\n\tspin_unlock_irqrestore(&x->wait.lock, flags);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&mod->mkobj.kobj"
          ],
          "line": 1746
        },
        "resolved": true,
        "details": {
          "function_name": "mod_kobject_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1742-1748",
          "snippet": "static void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "DECLARE_COMPLETION_ONSTACK",
          "args": [
            "c"
          ],
          "line": 1744
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}"
  },
  {
    "function_name": "module_remove_modinfo_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1726-1740",
    "snippet": "static void module_remove_modinfo_attrs(struct module *mod)\n{\n\tstruct module_attribute *attr;\n\tint i;\n\n\tfor (i = 0; (attr = &mod->modinfo_attrs[i]); i++) {\n\t\t/* pick a field to test for end of list */\n\t\tif (!attr->attr.name)\n\t\t\tbreak;\n\t\tsysfs_remove_file(&mod->mkobj.kobj, &attr->attr);\n\t\tif (attr->free)\n\t\t\tattr->free(mod);\n\t}\n\tkfree(mod->modinfo_attrs);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "mod->modinfo_attrs"
          ],
          "line": 1739
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr->free",
          "args": [
            "mod"
          ],
          "line": 1737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_remove_file",
          "args": [
            "&mod->mkobj.kobj",
            "&attr->attr"
          ],
          "line": 1735
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};\n\nstatic void module_remove_modinfo_attrs(struct module *mod)\n{\n\tstruct module_attribute *attr;\n\tint i;\n\n\tfor (i = 0; (attr = &mod->modinfo_attrs[i]); i++) {\n\t\t/* pick a field to test for end of list */\n\t\tif (!attr->attr.name)\n\t\t\tbreak;\n\t\tsysfs_remove_file(&mod->mkobj.kobj, &attr->attr);\n\t\tif (attr->free)\n\t\t\tattr->free(mod);\n\t}\n\tkfree(mod->modinfo_attrs);\n}"
  },
  {
    "function_name": "module_add_modinfo_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1700-1724",
    "snippet": "static int module_add_modinfo_attrs(struct module *mod)\n{\n\tstruct module_attribute *attr;\n\tstruct module_attribute *temp_attr;\n\tint error = 0;\n\tint i;\n\n\tmod->modinfo_attrs = kzalloc((sizeof(struct module_attribute) *\n\t\t\t\t\t(ARRAY_SIZE(modinfo_attrs) + 1)),\n\t\t\t\t\tGFP_KERNEL);\n\tif (!mod->modinfo_attrs)\n\t\treturn -ENOMEM;\n\n\ttemp_attr = mod->modinfo_attrs;\n\tfor (i = 0; (attr = modinfo_attrs[i]) && !error; i++) {\n\t\tif (!attr->test || attr->test(mod)) {\n\t\t\tmemcpy(temp_attr, attr, sizeof(*temp_attr));\n\t\t\tsysfs_attr_init(&temp_attr->attr);\n\t\t\terror = sysfs_create_file(&mod->mkobj.kobj,\n\t\t\t\t\t&temp_attr->attr);\n\t\t\t++temp_attr;\n\t\t}\n\t}\n\treturn error;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysfs_create_file",
          "args": [
            "&mod->mkobj.kobj",
            "&temp_attr->attr"
          ],
          "line": 1718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_attr_init",
          "args": [
            "&temp_attr->attr"
          ],
          "line": 1717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "temp_attr",
            "attr",
            "sizeof(*temp_attr)"
          ],
          "line": 1716
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy_skip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/events/internal.h",
          "lines": "178-182",
          "snippet": "static inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/hardirq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/hardirq.h>\n\nstatic inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "attr->test",
          "args": [
            "mod"
          ],
          "line": 1715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "(sizeof(struct module_attribute) *\n\t\t\t\t\t(ARRAY_SIZE(modinfo_attrs) + 1))",
            "GFP_KERNEL"
          ],
          "line": 1707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "modinfo_attrs"
          ],
          "line": 1708
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic struct module_attribute *modinfo_attrs[] = {\n\t&module_uevent,\n\t&modinfo_version,\n\t&modinfo_srcversion,\n\t&modinfo_initstate,\n\t&modinfo_coresize,\n\t&modinfo_initsize,\n\t&modinfo_taint,\n#ifdef CONFIG_MODULE_UNLOAD\n\t&modinfo_refcnt,\n#endif\n\tNULL,\n};\n\nstatic int module_add_modinfo_attrs(struct module *mod)\n{\n\tstruct module_attribute *attr;\n\tstruct module_attribute *temp_attr;\n\tint error = 0;\n\tint i;\n\n\tmod->modinfo_attrs = kzalloc((sizeof(struct module_attribute) *\n\t\t\t\t\t(ARRAY_SIZE(modinfo_attrs) + 1)),\n\t\t\t\t\tGFP_KERNEL);\n\tif (!mod->modinfo_attrs)\n\t\treturn -ENOMEM;\n\n\ttemp_attr = mod->modinfo_attrs;\n\tfor (i = 0; (attr = modinfo_attrs[i]) && !error; i++) {\n\t\tif (!attr->test || attr->test(mod)) {\n\t\t\tmemcpy(temp_attr, attr, sizeof(*temp_attr));\n\t\t\tsysfs_attr_init(&temp_attr->attr);\n\t\t\terror = sysfs_create_file(&mod->mkobj.kobj,\n\t\t\t\t\t&temp_attr->attr);\n\t\t\t++temp_attr;\n\t\t}\n\t}\n\treturn error;\n}"
  },
  {
    "function_name": "add_usage_links",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1680-1698",
    "snippet": "static int add_usage_links(struct module *mod)\n{\n\tint ret = 0;\n#ifdef CONFIG_MODULE_UNLOAD\n\tstruct module_use *use;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry(use, &mod->target_list, target_list) {\n\t\tret = sysfs_create_link(use->target->holders_dir,\n\t\t\t\t\t&mod->mkobj.kobj, mod->name);\n\t\tif (ret)\n\t\t\tbreak;\n\t}\n\tmutex_unlock(&module_mutex);\n\tif (ret)\n\t\tdel_usage_links(mod);\n#endif\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "del_usage_links",
          "args": [
            "mod"
          ],
          "line": 1695
        },
        "resolved": true,
        "details": {
          "function_name": "del_usage_links",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1859-1861",
          "snippet": "static void del_usage_links(struct module *mod)\n{\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void del_usage_links(struct module *mod)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 1693
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_create_link",
          "args": [
            "use->target->holders_dir",
            "&mod->mkobj.kobj",
            "mod->name"
          ],
          "line": 1688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "use",
            "&mod->target_list",
            "target_list"
          ],
          "line": 1687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 1686
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int add_usage_links(struct module *mod)\n{\n\tint ret = 0;\n#ifdef CONFIG_MODULE_UNLOAD\n\tstruct module_use *use;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry(use, &mod->target_list, target_list) {\n\t\tret = sysfs_create_link(use->target->holders_dir,\n\t\t\t\t\t&mod->mkobj.kobj, mod->name);\n\t\tif (ret)\n\t\t\tbreak;\n\t}\n\tmutex_unlock(&module_mutex);\n\tif (ret)\n\t\tdel_usage_links(mod);\n#endif\n\treturn ret;\n}"
  },
  {
    "function_name": "del_usage_links",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1668-1678",
    "snippet": "static void del_usage_links(struct module *mod)\n{\n#ifdef CONFIG_MODULE_UNLOAD\n\tstruct module_use *use;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry(use, &mod->target_list, target_list)\n\t\tsysfs_remove_link(use->target->holders_dir, mod->name);\n\tmutex_unlock(&module_mutex);\n#endif\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 1676
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_remove_link",
          "args": [
            "use->target->holders_dir",
            "mod->name"
          ],
          "line": 1675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "use",
            "&mod->target_list",
            "target_list"
          ],
          "line": 1674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 1673
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void del_usage_links(struct module *mod)\n{\n#ifdef CONFIG_MODULE_UNLOAD\n\tstruct module_use *use;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry(use, &mod->target_list, target_list)\n\t\tsysfs_remove_link(use->target->holders_dir, mod->name);\n\tmutex_unlock(&module_mutex);\n#endif\n}"
  },
  {
    "function_name": "remove_notes_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1663-1665",
    "snippet": "static inline void remove_notes_attrs(struct module *mod)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void remove_notes_attrs(struct module *mod)\n{\n}"
  },
  {
    "function_name": "add_notes_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1658-1661",
    "snippet": "static inline void add_notes_attrs(struct module *mod,\n\t\t\t\t   const struct load_info *info)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void add_notes_attrs(struct module *mod,\n\t\t\t\t   const struct load_info *info)\n{\n}"
  },
  {
    "function_name": "remove_sect_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1654-1656",
    "snippet": "static inline void remove_sect_attrs(struct module *mod)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void remove_sect_attrs(struct module *mod)\n{\n}"
  },
  {
    "function_name": "add_sect_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1649-1652",
    "snippet": "static inline void add_sect_attrs(struct module *mod,\n\t\t\t\t  const struct load_info *info)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void add_sect_attrs(struct module *mod,\n\t\t\t\t  const struct load_info *info)\n{\n}"
  },
  {
    "function_name": "remove_notes_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1641-1645",
    "snippet": "static void remove_notes_attrs(struct module *mod)\n{\n\tif (mod->notes_attrs)\n\t\tfree_notes_attrs(mod->notes_attrs, mod->notes_attrs->notes);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_notes_attrs",
          "args": [
            "mod->notes_attrs",
            "mod->notes_attrs->notes"
          ],
          "line": 1644
        },
        "resolved": true,
        "details": {
          "function_name": "free_notes_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1571-1581",
          "snippet": "static void free_notes_attrs(struct module_notes_attrs *notes_attrs,\n\t\t\t     unsigned int i)\n{\n\tif (notes_attrs->dir) {\n\t\twhile (i-- > 0)\n\t\t\tsysfs_remove_bin_file(notes_attrs->dir,\n\t\t\t\t\t      &notes_attrs->attrs[i]);\n\t\tkobject_put(notes_attrs->dir);\n\t}\n\tkfree(notes_attrs);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_notes_attrs(struct module_notes_attrs *notes_attrs,\n\t\t\t     unsigned int i)\n{\n\tif (notes_attrs->dir) {\n\t\twhile (i-- > 0)\n\t\t\tsysfs_remove_bin_file(notes_attrs->dir,\n\t\t\t\t\t      &notes_attrs->attrs[i]);\n\t\tkobject_put(notes_attrs->dir);\n\t}\n\tkfree(notes_attrs);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void remove_notes_attrs(struct module *mod)\n{\n\tif (mod->notes_attrs)\n\t\tfree_notes_attrs(mod->notes_attrs, mod->notes_attrs->notes);\n}"
  },
  {
    "function_name": "add_notes_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1583-1639",
    "snippet": "static void add_notes_attrs(struct module *mod, const struct load_info *info)\n{\n\tunsigned int notes, loaded, i;\n\tstruct module_notes_attrs *notes_attrs;\n\tstruct bin_attribute *nattr;\n\n\t/* failed to create section attributes, so can't create notes */\n\tif (!mod->sect_attrs)\n\t\treturn;\n\n\t/* Count notes sections and allocate structures.  */\n\tnotes = 0;\n\tfor (i = 0; i < info->hdr->e_shnum; i++)\n\t\tif (!sect_empty(&info->sechdrs[i]) &&\n\t\t    (info->sechdrs[i].sh_type == SHT_NOTE))\n\t\t\t++notes;\n\n\tif (notes == 0)\n\t\treturn;\n\n\tnotes_attrs = kzalloc(struct_size(notes_attrs, attrs, notes),\n\t\t\t      GFP_KERNEL);\n\tif (notes_attrs == NULL)\n\t\treturn;\n\n\tnotes_attrs->notes = notes;\n\tnattr = &notes_attrs->attrs[0];\n\tfor (loaded = i = 0; i < info->hdr->e_shnum; ++i) {\n\t\tif (sect_empty(&info->sechdrs[i]))\n\t\t\tcontinue;\n\t\tif (info->sechdrs[i].sh_type == SHT_NOTE) {\n\t\t\tsysfs_bin_attr_init(nattr);\n\t\t\tnattr->attr.name = mod->sect_attrs->attrs[loaded].name;\n\t\t\tnattr->attr.mode = S_IRUGO;\n\t\t\tnattr->size = info->sechdrs[i].sh_size;\n\t\t\tnattr->private = (void *) info->sechdrs[i].sh_addr;\n\t\t\tnattr->read = module_notes_read;\n\t\t\t++nattr;\n\t\t}\n\t\t++loaded;\n\t}\n\n\tnotes_attrs->dir = kobject_create_and_add(\"notes\", &mod->mkobj.kobj);\n\tif (!notes_attrs->dir)\n\t\tgoto out;\n\n\tfor (i = 0; i < notes; ++i)\n\t\tif (sysfs_create_bin_file(notes_attrs->dir,\n\t\t\t\t\t  &notes_attrs->attrs[i]))\n\t\t\tgoto out;\n\n\tmod->notes_attrs = notes_attrs;\n\treturn;\n\n  out:\n\tfree_notes_attrs(notes_attrs, i);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_notes_attrs",
          "args": [
            "notes_attrs",
            "i"
          ],
          "line": 1638
        },
        "resolved": true,
        "details": {
          "function_name": "free_notes_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1571-1581",
          "snippet": "static void free_notes_attrs(struct module_notes_attrs *notes_attrs,\n\t\t\t     unsigned int i)\n{\n\tif (notes_attrs->dir) {\n\t\twhile (i-- > 0)\n\t\t\tsysfs_remove_bin_file(notes_attrs->dir,\n\t\t\t\t\t      &notes_attrs->attrs[i]);\n\t\tkobject_put(notes_attrs->dir);\n\t}\n\tkfree(notes_attrs);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_notes_attrs(struct module_notes_attrs *notes_attrs,\n\t\t\t     unsigned int i)\n{\n\tif (notes_attrs->dir) {\n\t\twhile (i-- > 0)\n\t\t\tsysfs_remove_bin_file(notes_attrs->dir,\n\t\t\t\t\t      &notes_attrs->attrs[i]);\n\t\tkobject_put(notes_attrs->dir);\n\t}\n\tkfree(notes_attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_create_bin_file",
          "args": [
            "notes_attrs->dir",
            "&notes_attrs->attrs[i]"
          ],
          "line": 1630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_create_and_add",
          "args": [
            "\"notes\"",
            "&mod->mkobj.kobj"
          ],
          "line": 1625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_bin_attr_init",
          "args": [
            "nattr"
          ],
          "line": 1614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sect_empty",
          "args": [
            "&info->sechdrs[i]"
          ],
          "line": 1611
        },
        "resolved": true,
        "details": {
          "function_name": "sect_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1449-1452",
          "snippet": "static inline bool sect_empty(const Elf_Shdr *sect)\n{\n\treturn !(sect->sh_flags & SHF_ALLOC) || sect->sh_size == 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline bool sect_empty(const Elf_Shdr *sect)\n{\n\treturn !(sect->sh_flags & SHF_ALLOC) || sect->sh_size == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "struct_size(notes_attrs, attrs, notes)",
            "GFP_KERNEL"
          ],
          "line": 1603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "struct_size",
          "args": [
            "notes_attrs",
            "attrs",
            "notes"
          ],
          "line": 1603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void add_notes_attrs(struct module *mod, const struct load_info *info)\n{\n\tunsigned int notes, loaded, i;\n\tstruct module_notes_attrs *notes_attrs;\n\tstruct bin_attribute *nattr;\n\n\t/* failed to create section attributes, so can't create notes */\n\tif (!mod->sect_attrs)\n\t\treturn;\n\n\t/* Count notes sections and allocate structures.  */\n\tnotes = 0;\n\tfor (i = 0; i < info->hdr->e_shnum; i++)\n\t\tif (!sect_empty(&info->sechdrs[i]) &&\n\t\t    (info->sechdrs[i].sh_type == SHT_NOTE))\n\t\t\t++notes;\n\n\tif (notes == 0)\n\t\treturn;\n\n\tnotes_attrs = kzalloc(struct_size(notes_attrs, attrs, notes),\n\t\t\t      GFP_KERNEL);\n\tif (notes_attrs == NULL)\n\t\treturn;\n\n\tnotes_attrs->notes = notes;\n\tnattr = &notes_attrs->attrs[0];\n\tfor (loaded = i = 0; i < info->hdr->e_shnum; ++i) {\n\t\tif (sect_empty(&info->sechdrs[i]))\n\t\t\tcontinue;\n\t\tif (info->sechdrs[i].sh_type == SHT_NOTE) {\n\t\t\tsysfs_bin_attr_init(nattr);\n\t\t\tnattr->attr.name = mod->sect_attrs->attrs[loaded].name;\n\t\t\tnattr->attr.mode = S_IRUGO;\n\t\t\tnattr->size = info->sechdrs[i].sh_size;\n\t\t\tnattr->private = (void *) info->sechdrs[i].sh_addr;\n\t\t\tnattr->read = module_notes_read;\n\t\t\t++nattr;\n\t\t}\n\t\t++loaded;\n\t}\n\n\tnotes_attrs->dir = kobject_create_and_add(\"notes\", &mod->mkobj.kobj);\n\tif (!notes_attrs->dir)\n\t\tgoto out;\n\n\tfor (i = 0; i < notes; ++i)\n\t\tif (sysfs_create_bin_file(notes_attrs->dir,\n\t\t\t\t\t  &notes_attrs->attrs[i]))\n\t\t\tgoto out;\n\n\tmod->notes_attrs = notes_attrs;\n\treturn;\n\n  out:\n\tfree_notes_attrs(notes_attrs, i);\n}"
  },
  {
    "function_name": "free_notes_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1571-1581",
    "snippet": "static void free_notes_attrs(struct module_notes_attrs *notes_attrs,\n\t\t\t     unsigned int i)\n{\n\tif (notes_attrs->dir) {\n\t\twhile (i-- > 0)\n\t\t\tsysfs_remove_bin_file(notes_attrs->dir,\n\t\t\t\t\t      &notes_attrs->attrs[i]);\n\t\tkobject_put(notes_attrs->dir);\n\t}\n\tkfree(notes_attrs);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "notes_attrs"
          ],
          "line": 1580
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "notes_attrs->dir"
          ],
          "line": 1578
        },
        "resolved": true,
        "details": {
          "function_name": "mod_kobject_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1742-1748",
          "snippet": "static void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_remove_bin_file",
          "args": [
            "notes_attrs->dir",
            "&notes_attrs->attrs[i]"
          ],
          "line": 1576
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_notes_attrs(struct module_notes_attrs *notes_attrs,\n\t\t\t     unsigned int i)\n{\n\tif (notes_attrs->dir) {\n\t\twhile (i-- > 0)\n\t\t\tsysfs_remove_bin_file(notes_attrs->dir,\n\t\t\t\t\t      &notes_attrs->attrs[i]);\n\t\tkobject_put(notes_attrs->dir);\n\t}\n\tkfree(notes_attrs);\n}"
  },
  {
    "function_name": "module_notes_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1560-1569",
    "snippet": "static ssize_t module_notes_read(struct file *filp, struct kobject *kobj,\n\t\t\t\t struct bin_attribute *bin_attr,\n\t\t\t\t char *buf, loff_t pos, size_t count)\n{\n\t/*\n\t * The caller checked the pos and count against our size.\n\t */\n\tmemcpy(buf, bin_attr->private + pos, count);\n\treturn count;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "bin_attr->private + pos",
            "count"
          ],
          "line": 1567
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy_skip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/events/internal.h",
          "lines": "178-182",
          "snippet": "static inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/hardirq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/hardirq.h>\n\nstatic inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic ssize_t module_notes_read(struct file *filp, struct kobject *kobj,\n\t\t\t\t struct bin_attribute *bin_attr,\n\t\t\t\t char *buf, loff_t pos, size_t count)\n{\n\t/*\n\t * The caller checked the pos and count against our size.\n\t */\n\tmemcpy(buf, bin_attr->private + pos, count);\n\treturn count;\n}"
  },
  {
    "function_name": "remove_sect_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1538-1548",
    "snippet": "static void remove_sect_attrs(struct module *mod)\n{\n\tif (mod->sect_attrs) {\n\t\tsysfs_remove_group(&mod->mkobj.kobj,\n\t\t\t\t   &mod->sect_attrs->grp);\n\t\t/* We are positive that no one is using any sect attrs\n\t\t * at this point.  Deallocate immediately. */\n\t\tfree_sect_attrs(mod->sect_attrs);\n\t\tmod->sect_attrs = NULL;\n\t}\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_sect_attrs",
          "args": [
            "mod->sect_attrs"
          ],
          "line": 1545
        },
        "resolved": true,
        "details": {
          "function_name": "free_sect_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1475-1482",
          "snippet": "static void free_sect_attrs(struct module_sect_attrs *sect_attrs)\n{\n\tunsigned int section;\n\n\tfor (section = 0; section < sect_attrs->nsections; section++)\n\t\tkfree(sect_attrs->attrs[section].name);\n\tkfree(sect_attrs);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_sect_attrs(struct module_sect_attrs *sect_attrs)\n{\n\tunsigned int section;\n\n\tfor (section = 0; section < sect_attrs->nsections; section++)\n\t\tkfree(sect_attrs->attrs[section].name);\n\tkfree(sect_attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_remove_group",
          "args": [
            "&mod->mkobj.kobj",
            "&mod->sect_attrs->grp"
          ],
          "line": 1541
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void remove_sect_attrs(struct module *mod)\n{\n\tif (mod->sect_attrs) {\n\t\tsysfs_remove_group(&mod->mkobj.kobj,\n\t\t\t\t   &mod->sect_attrs->grp);\n\t\t/* We are positive that no one is using any sect attrs\n\t\t * at this point.  Deallocate immediately. */\n\t\tfree_sect_attrs(mod->sect_attrs);\n\t\tmod->sect_attrs = NULL;\n\t}\n}"
  },
  {
    "function_name": "add_sect_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1484-1536",
    "snippet": "static void add_sect_attrs(struct module *mod, const struct load_info *info)\n{\n\tunsigned int nloaded = 0, i, size[2];\n\tstruct module_sect_attrs *sect_attrs;\n\tstruct module_sect_attr *sattr;\n\tstruct attribute **gattr;\n\n\t/* Count loaded sections and allocate structures */\n\tfor (i = 0; i < info->hdr->e_shnum; i++)\n\t\tif (!sect_empty(&info->sechdrs[i]))\n\t\t\tnloaded++;\n\tsize[0] = ALIGN(sizeof(*sect_attrs)\n\t\t\t+ nloaded * sizeof(sect_attrs->attrs[0]),\n\t\t\tsizeof(sect_attrs->grp.attrs[0]));\n\tsize[1] = (nloaded + 1) * sizeof(sect_attrs->grp.attrs[0]);\n\tsect_attrs = kzalloc(size[0] + size[1], GFP_KERNEL);\n\tif (sect_attrs == NULL)\n\t\treturn;\n\n\t/* Setup section attributes. */\n\tsect_attrs->grp.name = \"sections\";\n\tsect_attrs->grp.attrs = (void *)sect_attrs + size[0];\n\n\tsect_attrs->nsections = 0;\n\tsattr = &sect_attrs->attrs[0];\n\tgattr = &sect_attrs->grp.attrs[0];\n\tfor (i = 0; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *sec = &info->sechdrs[i];\n\t\tif (sect_empty(sec))\n\t\t\tcontinue;\n\t\tsattr->address = sec->sh_addr;\n\t\tsattr->name = kstrdup(info->secstrings + sec->sh_name,\n\t\t\t\t\tGFP_KERNEL);\n\t\tif (sattr->name == NULL)\n\t\t\tgoto out;\n\t\tsect_attrs->nsections++;\n\t\tsysfs_attr_init(&sattr->mattr.attr);\n\t\tsattr->mattr.show = module_sect_show;\n\t\tsattr->mattr.store = NULL;\n\t\tsattr->mattr.attr.name = sattr->name;\n\t\tsattr->mattr.attr.mode = S_IRUSR;\n\t\t*(gattr++) = &(sattr++)->mattr.attr;\n\t}\n\t*gattr = NULL;\n\n\tif (sysfs_create_group(&mod->mkobj.kobj, &sect_attrs->grp))\n\t\tgoto out;\n\n\tmod->sect_attrs = sect_attrs;\n\treturn;\n  out:\n\tfree_sect_attrs(sect_attrs);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_sect_attrs",
          "args": [
            "sect_attrs"
          ],
          "line": 1535
        },
        "resolved": true,
        "details": {
          "function_name": "free_sect_attrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1475-1482",
          "snippet": "static void free_sect_attrs(struct module_sect_attrs *sect_attrs)\n{\n\tunsigned int section;\n\n\tfor (section = 0; section < sect_attrs->nsections; section++)\n\t\tkfree(sect_attrs->attrs[section].name);\n\tkfree(sect_attrs);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_sect_attrs(struct module_sect_attrs *sect_attrs)\n{\n\tunsigned int section;\n\n\tfor (section = 0; section < sect_attrs->nsections; section++)\n\t\tkfree(sect_attrs->attrs[section].name);\n\tkfree(sect_attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_create_group",
          "args": [
            "&mod->mkobj.kobj",
            "&sect_attrs->grp"
          ],
          "line": 1529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_attr_init",
          "args": [
            "&sattr->mattr.attr"
          ],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrdup",
          "args": [
            "info->secstrings + sec->sh_name",
            "GFP_KERNEL"
          ],
          "line": 1515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sect_empty",
          "args": [
            "sec"
          ],
          "line": 1512
        },
        "resolved": true,
        "details": {
          "function_name": "sect_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1449-1452",
          "snippet": "static inline bool sect_empty(const Elf_Shdr *sect)\n{\n\treturn !(sect->sh_flags & SHF_ALLOC) || sect->sh_size == 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline bool sect_empty(const Elf_Shdr *sect)\n{\n\treturn !(sect->sh_flags & SHF_ALLOC) || sect->sh_size == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "size[0] + size[1]",
            "GFP_KERNEL"
          ],
          "line": 1499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ALIGN",
          "args": [
            "sizeof(*sect_attrs)\n\t\t\t+ nloaded * sizeof(sect_attrs->attrs[0])",
            "sizeof(sect_attrs->grp.attrs[0])"
          ],
          "line": 1495
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void add_sect_attrs(struct module *mod, const struct load_info *info)\n{\n\tunsigned int nloaded = 0, i, size[2];\n\tstruct module_sect_attrs *sect_attrs;\n\tstruct module_sect_attr *sattr;\n\tstruct attribute **gattr;\n\n\t/* Count loaded sections and allocate structures */\n\tfor (i = 0; i < info->hdr->e_shnum; i++)\n\t\tif (!sect_empty(&info->sechdrs[i]))\n\t\t\tnloaded++;\n\tsize[0] = ALIGN(sizeof(*sect_attrs)\n\t\t\t+ nloaded * sizeof(sect_attrs->attrs[0]),\n\t\t\tsizeof(sect_attrs->grp.attrs[0]));\n\tsize[1] = (nloaded + 1) * sizeof(sect_attrs->grp.attrs[0]);\n\tsect_attrs = kzalloc(size[0] + size[1], GFP_KERNEL);\n\tif (sect_attrs == NULL)\n\t\treturn;\n\n\t/* Setup section attributes. */\n\tsect_attrs->grp.name = \"sections\";\n\tsect_attrs->grp.attrs = (void *)sect_attrs + size[0];\n\n\tsect_attrs->nsections = 0;\n\tsattr = &sect_attrs->attrs[0];\n\tgattr = &sect_attrs->grp.attrs[0];\n\tfor (i = 0; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *sec = &info->sechdrs[i];\n\t\tif (sect_empty(sec))\n\t\t\tcontinue;\n\t\tsattr->address = sec->sh_addr;\n\t\tsattr->name = kstrdup(info->secstrings + sec->sh_name,\n\t\t\t\t\tGFP_KERNEL);\n\t\tif (sattr->name == NULL)\n\t\t\tgoto out;\n\t\tsect_attrs->nsections++;\n\t\tsysfs_attr_init(&sattr->mattr.attr);\n\t\tsattr->mattr.show = module_sect_show;\n\t\tsattr->mattr.store = NULL;\n\t\tsattr->mattr.attr.name = sattr->name;\n\t\tsattr->mattr.attr.mode = S_IRUSR;\n\t\t*(gattr++) = &(sattr++)->mattr.attr;\n\t}\n\t*gattr = NULL;\n\n\tif (sysfs_create_group(&mod->mkobj.kobj, &sect_attrs->grp))\n\t\tgoto out;\n\n\tmod->sect_attrs = sect_attrs;\n\treturn;\n  out:\n\tfree_sect_attrs(sect_attrs);\n}"
  },
  {
    "function_name": "free_sect_attrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1475-1482",
    "snippet": "static void free_sect_attrs(struct module_sect_attrs *sect_attrs)\n{\n\tunsigned int section;\n\n\tfor (section = 0; section < sect_attrs->nsections; section++)\n\t\tkfree(sect_attrs->attrs[section].name);\n\tkfree(sect_attrs);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sect_attrs"
          ],
          "line": 1481
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void free_sect_attrs(struct module_sect_attrs *sect_attrs)\n{\n\tunsigned int section;\n\n\tfor (section = 0; section < sect_attrs->nsections; section++)\n\t\tkfree(sect_attrs->attrs[section].name);\n\tkfree(sect_attrs);\n}"
  },
  {
    "function_name": "module_sect_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1466-1473",
    "snippet": "static ssize_t module_sect_show(struct module_attribute *mattr,\n\t\t\t\tstruct module_kobject *mk, char *buf)\n{\n\tstruct module_sect_attr *sattr =\n\t\tcontainer_of(mattr, struct module_sect_attr, mattr);\n\treturn sprintf(buf, \"0x%px\\n\", kptr_restrict < 2 ?\n\t\t       (void *)sattr->address : NULL);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"0x%px\\n\"",
            "kptr_restrict < 2 ?\n\t\t       (void *)sattr->address : NULL"
          ],
          "line": 1471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "mattr",
            "structmodule_sect_attr",
            "mattr"
          ],
          "line": 1470
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic ssize_t module_sect_show(struct module_attribute *mattr,\n\t\t\t\tstruct module_kobject *mk, char *buf)\n{\n\tstruct module_sect_attr *sattr =\n\t\tcontainer_of(mattr, struct module_sect_attr, mattr);\n\treturn sprintf(buf, \"0x%px\\n\", kptr_restrict < 2 ?\n\t\t       (void *)sattr->address : NULL);\n}"
  },
  {
    "function_name": "sect_empty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1449-1452",
    "snippet": "static inline bool sect_empty(const Elf_Shdr *sect)\n{\n\treturn !(sect->sh_flags & SHF_ALLOC) || sect->sh_size == 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline bool sect_empty(const Elf_Shdr *sect)\n{\n\treturn !(sect->sh_flags & SHF_ALLOC) || sect->sh_size == 0;\n}"
  },
  {
    "function_name": "resolve_symbol_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1424-1440",
    "snippet": "static const struct kernel_symbol *\nresolve_symbol_wait(struct module *mod,\n\t\t    const struct load_info *info,\n\t\t    const char *name)\n{\n\tconst struct kernel_symbol *ksym;\n\tchar owner[MODULE_NAME_LEN];\n\n\tif (wait_event_interruptible_timeout(module_wq,\n\t\t\t!IS_ERR(ksym = resolve_symbol(mod, info, name, owner))\n\t\t\t|| PTR_ERR(ksym) != -EBUSY,\n\t\t\t\t\t     30 * HZ) <= 0) {\n\t\tpr_warn(\"%s: gave up waiting for init of module %s.\\n\",\n\t\t\tmod->name, owner);\n\t}\n\treturn ksym;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_WAIT_QUEUE_HEAD(module_wq);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: gave up waiting for init of module %s.\\n\"",
            "mod->name",
            "owner"
          ],
          "line": 1436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wait_event_interruptible_timeout",
          "args": [
            "module_wq",
            "!IS_ERR(ksym = resolve_symbol(mod, info, name, owner))\n\t\t\t|| PTR_ERR(ksym) != -EBUSY",
            "30 * HZ"
          ],
          "line": 1432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "ksym"
          ],
          "line": 1434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "ksym = resolve_symbol(mod, info, name, owner)"
          ],
          "line": 1433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resolve_symbol",
          "args": [
            "mod",
            "info",
            "name",
            "owner"
          ],
          "line": 1433
        },
        "resolved": true,
        "details": {
          "function_name": "resolve_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1383-1422",
          "snippet": "static const struct kernel_symbol *resolve_symbol(struct module *mod,\n\t\t\t\t\t\t  const struct load_info *info,\n\t\t\t\t\t\t  const char *name,\n\t\t\t\t\t\t  char ownername[])\n{\n\tstruct module *owner;\n\tconst struct kernel_symbol *sym;\n\tconst s32 *crc;\n\tint err;\n\n\t/*\n\t * The module_mutex should not be a heavily contended lock;\n\t * if we get the occasional sleep here, we'll go an extra iteration\n\t * in the wait_event_interruptible(), which is harmless.\n\t */\n\tsched_annotate_sleep();\n\tmutex_lock(&module_mutex);\n\tsym = find_symbol(name, &owner, &crc,\n\t\t\t  !(mod->taints & (1 << TAINT_PROPRIETARY_MODULE)), true);\n\tif (!sym)\n\t\tgoto unlock;\n\n\tif (!check_version(info, name, mod, crc)) {\n\t\tsym = ERR_PTR(-EINVAL);\n\t\tgoto getname;\n\t}\n\n\terr = ref_module(mod, owner);\n\tif (err) {\n\t\tsym = ERR_PTR(err);\n\t\tgoto getname;\n\t}\n\ngetname:\n\t/* We must make copy under the lock if we failed to get ref. */\n\tstrncpy(ownername, module_name(owner), MODULE_NAME_LEN);\nunlock:\n\tmutex_unlock(&module_mutex);\n\treturn sym;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const struct kernel_symbol *resolve_symbol(struct module *mod,\n\t\t\t\t\t\t  const struct load_info *info,\n\t\t\t\t\t\t  const char *name,\n\t\t\t\t\t\t  char ownername[])\n{\n\tstruct module *owner;\n\tconst struct kernel_symbol *sym;\n\tconst s32 *crc;\n\tint err;\n\n\t/*\n\t * The module_mutex should not be a heavily contended lock;\n\t * if we get the occasional sleep here, we'll go an extra iteration\n\t * in the wait_event_interruptible(), which is harmless.\n\t */\n\tsched_annotate_sleep();\n\tmutex_lock(&module_mutex);\n\tsym = find_symbol(name, &owner, &crc,\n\t\t\t  !(mod->taints & (1 << TAINT_PROPRIETARY_MODULE)), true);\n\tif (!sym)\n\t\tgoto unlock;\n\n\tif (!check_version(info, name, mod, crc)) {\n\t\tsym = ERR_PTR(-EINVAL);\n\t\tgoto getname;\n\t}\n\n\terr = ref_module(mod, owner);\n\tif (err) {\n\t\tsym = ERR_PTR(err);\n\t\tgoto getname;\n\t}\n\ngetname:\n\t/* We must make copy under the lock if we failed to get ref. */\n\tstrncpy(ownername, module_name(owner), MODULE_NAME_LEN);\nunlock:\n\tmutex_unlock(&module_mutex);\n\treturn sym;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic DECLARE_WAIT_QUEUE_HEAD(module_wq);\n\nstatic const struct kernel_symbol *\nresolve_symbol_wait(struct module *mod,\n\t\t    const struct load_info *info,\n\t\t    const char *name)\n{\n\tconst struct kernel_symbol *ksym;\n\tchar owner[MODULE_NAME_LEN];\n\n\tif (wait_event_interruptible_timeout(module_wq,\n\t\t\t!IS_ERR(ksym = resolve_symbol(mod, info, name, owner))\n\t\t\t|| PTR_ERR(ksym) != -EBUSY,\n\t\t\t\t\t     30 * HZ) <= 0) {\n\t\tpr_warn(\"%s: gave up waiting for init of module %s.\\n\",\n\t\t\tmod->name, owner);\n\t}\n\treturn ksym;\n}"
  },
  {
    "function_name": "resolve_symbol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1383-1422",
    "snippet": "static const struct kernel_symbol *resolve_symbol(struct module *mod,\n\t\t\t\t\t\t  const struct load_info *info,\n\t\t\t\t\t\t  const char *name,\n\t\t\t\t\t\t  char ownername[])\n{\n\tstruct module *owner;\n\tconst struct kernel_symbol *sym;\n\tconst s32 *crc;\n\tint err;\n\n\t/*\n\t * The module_mutex should not be a heavily contended lock;\n\t * if we get the occasional sleep here, we'll go an extra iteration\n\t * in the wait_event_interruptible(), which is harmless.\n\t */\n\tsched_annotate_sleep();\n\tmutex_lock(&module_mutex);\n\tsym = find_symbol(name, &owner, &crc,\n\t\t\t  !(mod->taints & (1 << TAINT_PROPRIETARY_MODULE)), true);\n\tif (!sym)\n\t\tgoto unlock;\n\n\tif (!check_version(info, name, mod, crc)) {\n\t\tsym = ERR_PTR(-EINVAL);\n\t\tgoto getname;\n\t}\n\n\terr = ref_module(mod, owner);\n\tif (err) {\n\t\tsym = ERR_PTR(err);\n\t\tgoto getname;\n\t}\n\ngetname:\n\t/* We must make copy under the lock if we failed to get ref. */\n\tstrncpy(ownername, module_name(owner), MODULE_NAME_LEN);\nunlock:\n\tmutex_unlock(&module_mutex);\n\treturn sym;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 1420
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "ownername",
            "module_name(owner)",
            "MODULE_NAME_LEN"
          ],
          "line": 1418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_name",
          "args": [
            "owner"
          ],
          "line": 1418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 1412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ref_module",
          "args": [
            "mod",
            "owner"
          ],
          "line": 1410
        },
        "resolved": true,
        "details": {
          "function_name": "ref_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1157-1160",
          "snippet": "int ref_module(struct module *a, struct module *b)\n{\n\treturn strong_try_module_get(b);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nint ref_module(struct module *a, struct module *b)\n{\n\treturn strong_try_module_get(b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 1406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_version",
          "args": [
            "info",
            "name",
            "mod",
            "crc"
          ],
          "line": 1405
        },
        "resolved": true,
        "details": {
          "function_name": "check_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1361-1367",
          "snippet": "static inline int check_version(const struct load_info *info,\n\t\t\t\tconst char *symname,\n\t\t\t\tstruct module *mod,\n\t\t\t\tconst s32 *crc)\n{\n\treturn 1;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int check_version(const struct load_info *info,\n\t\t\t\tconst char *symname,\n\t\t\t\tstruct module *mod,\n\t\t\t\tconst s32 *crc)\n{\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_symbol",
          "args": [
            "name",
            "&owner",
            "&crc",
            "!(mod->taints & (1 << TAINT_PROPRIETARY_MODULE))",
            "true"
          ],
          "line": 1400
        },
        "resolved": true,
        "details": {
          "function_name": "find_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "576-598",
          "snippet": "const struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nconst struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 1399
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sched_annotate_sleep",
          "args": [],
          "line": 1398
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const struct kernel_symbol *resolve_symbol(struct module *mod,\n\t\t\t\t\t\t  const struct load_info *info,\n\t\t\t\t\t\t  const char *name,\n\t\t\t\t\t\t  char ownername[])\n{\n\tstruct module *owner;\n\tconst struct kernel_symbol *sym;\n\tconst s32 *crc;\n\tint err;\n\n\t/*\n\t * The module_mutex should not be a heavily contended lock;\n\t * if we get the occasional sleep here, we'll go an extra iteration\n\t * in the wait_event_interruptible(), which is harmless.\n\t */\n\tsched_annotate_sleep();\n\tmutex_lock(&module_mutex);\n\tsym = find_symbol(name, &owner, &crc,\n\t\t\t  !(mod->taints & (1 << TAINT_PROPRIETARY_MODULE)), true);\n\tif (!sym)\n\t\tgoto unlock;\n\n\tif (!check_version(info, name, mod, crc)) {\n\t\tsym = ERR_PTR(-EINVAL);\n\t\tgoto getname;\n\t}\n\n\terr = ref_module(mod, owner);\n\tif (err) {\n\t\tsym = ERR_PTR(err);\n\t\tgoto getname;\n\t}\n\ngetname:\n\t/* We must make copy under the lock if we failed to get ref. */\n\tstrncpy(ownername, module_name(owner), MODULE_NAME_LEN);\nunlock:\n\tmutex_unlock(&module_mutex);\n\treturn sym;\n}"
  },
  {
    "function_name": "same_magic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1375-1379",
    "snippet": "static inline int same_magic(const char *amagic, const char *bmagic,\n\t\t\t     bool has_crcs)\n{\n\treturn strcmp(amagic, bmagic) == 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "amagic",
            "bmagic"
          ],
          "line": 1378
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int same_magic(const char *amagic, const char *bmagic,\n\t\t\t     bool has_crcs)\n{\n\treturn strcmp(amagic, bmagic) == 0;\n}"
  },
  {
    "function_name": "check_modstruct_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1369-1373",
    "snippet": "static inline int check_modstruct_version(const struct load_info *info,\n\t\t\t\t\t  struct module *mod)\n{\n\treturn 1;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int check_modstruct_version(const struct load_info *info,\n\t\t\t\t\t  struct module *mod)\n{\n\treturn 1;\n}"
  },
  {
    "function_name": "check_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1361-1367",
    "snippet": "static inline int check_version(const struct load_info *info,\n\t\t\t\tconst char *symname,\n\t\t\t\tstruct module *mod,\n\t\t\t\tconst s32 *crc)\n{\n\treturn 1;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int check_version(const struct load_info *info,\n\t\t\t\tconst char *symname,\n\t\t\t\tstruct module *mod,\n\t\t\t\tconst s32 *crc)\n{\n\treturn 1;\n}"
  },
  {
    "function_name": "same_magic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1351-1359",
    "snippet": "static inline int same_magic(const char *amagic, const char *bmagic,\n\t\t\t     bool has_crcs)\n{\n\tif (has_crcs) {\n\t\tamagic += strcspn(amagic, \" \");\n\t\tbmagic += strcspn(bmagic, \" \");\n\t}\n\treturn strcmp(amagic, bmagic) == 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "amagic",
            "bmagic"
          ],
          "line": 1358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcspn",
          "args": [
            "bmagic",
            "\" \""
          ],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcspn",
          "args": [
            "amagic",
            "\" \""
          ],
          "line": 1355
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int same_magic(const char *amagic, const char *bmagic,\n\t\t\t     bool has_crcs)\n{\n\tif (has_crcs) {\n\t\tamagic += strcspn(amagic, \" \");\n\t\tbmagic += strcspn(bmagic, \" \");\n\t}\n\treturn strcmp(amagic, bmagic) == 0;\n}"
  },
  {
    "function_name": "check_modstruct_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1332-1348",
    "snippet": "static inline int check_modstruct_version(const struct load_info *info,\n\t\t\t\t\t  struct module *mod)\n{\n\tconst s32 *crc;\n\n\t/*\n\t * Since this should be found in kernel (which can't be removed), no\n\t * locking is necessary -- use preempt_disable() to placate lockdep.\n\t */\n\tpreempt_disable();\n\tif (!find_symbol(\"module_layout\", NULL, &crc, true, false)) {\n\t\tpreempt_enable();\n\t\tBUG();\n\t}\n\tpreempt_enable();\n\treturn check_version(info, \"module_layout\", mod, crc);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "check_version",
          "args": [
            "info",
            "\"module_layout\"",
            "mod",
            "crc"
          ],
          "line": 1347
        },
        "resolved": true,
        "details": {
          "function_name": "check_version",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1361-1367",
          "snippet": "static inline int check_version(const struct load_info *info,\n\t\t\t\tconst char *symname,\n\t\t\t\tstruct module *mod,\n\t\t\t\tconst s32 *crc)\n{\n\treturn 1;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int check_version(const struct load_info *info,\n\t\t\t\tconst char *symname,\n\t\t\t\tstruct module *mod,\n\t\t\t\tconst s32 *crc)\n{\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 1346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 1344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 1343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_symbol",
          "args": [
            "\"module_layout\"",
            "NULL",
            "&crc",
            "true",
            "false"
          ],
          "line": 1342
        },
        "resolved": true,
        "details": {
          "function_name": "find_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "576-598",
          "snippet": "const struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nconst struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 1341
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int check_modstruct_version(const struct load_info *info,\n\t\t\t\t\t  struct module *mod)\n{\n\tconst s32 *crc;\n\n\t/*\n\t * Since this should be found in kernel (which can't be removed), no\n\t * locking is necessary -- use preempt_disable() to placate lockdep.\n\t */\n\tpreempt_disable();\n\tif (!find_symbol(\"module_layout\", NULL, &crc, true, false)) {\n\t\tpreempt_enable();\n\t\tBUG();\n\t}\n\tpreempt_enable();\n\treturn check_version(info, \"module_layout\", mod, crc);\n}"
  },
  {
    "function_name": "check_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1283-1330",
    "snippet": "static int check_version(const struct load_info *info,\n\t\t\t const char *symname,\n\t\t\t struct module *mod,\n\t\t\t const s32 *crc)\n{\n\tElf_Shdr *sechdrs = info->sechdrs;\n\tunsigned int versindex = info->index.vers;\n\tunsigned int i, num_versions;\n\tstruct modversion_info *versions;\n\n\t/* Exporting module didn't supply crcs?  OK, we're already tainted. */\n\tif (!crc)\n\t\treturn 1;\n\n\t/* No versions at all?  modprobe --force does this. */\n\tif (versindex == 0)\n\t\treturn try_to_force_load(mod, symname) == 0;\n\n\tversions = (void *) sechdrs[versindex].sh_addr;\n\tnum_versions = sechdrs[versindex].sh_size\n\t\t/ sizeof(struct modversion_info);\n\n\tfor (i = 0; i < num_versions; i++) {\n\t\tu32 crcval;\n\n\t\tif (strcmp(versions[i].name, symname) != 0)\n\t\t\tcontinue;\n\n\t\tif (IS_ENABLED(CONFIG_MODULE_REL_CRCS))\n\t\t\tcrcval = resolve_rel_crc(crc);\n\t\telse\n\t\t\tcrcval = *crc;\n\t\tif (versions[i].crc == crcval)\n\t\t\treturn 1;\n\t\tpr_debug(\"Found checksum %X vs module %lX\\n\",\n\t\t\t crcval, versions[i].crc);\n\t\tgoto bad_version;\n\t}\n\n\t/* Broken toolchain. Warn once, then let it go.. */\n\tpr_warn_once(\"%s: no symbol version for %s\\n\", info->name, symname);\n\treturn 1;\n\nbad_version:\n\tpr_warn(\"%s: disagrees about version of symbol %s\\n\",\n\t       info->name, symname);\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: disagrees about version of symbol %s\\n\"",
            "info->name",
            "symname"
          ],
          "line": 1327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn_once",
          "args": [
            "\"%s: no symbol version for %s\\n\"",
            "info->name",
            "symname"
          ],
          "line": 1323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"Found checksum %X vs module %lX\\n\"",
            "crcval",
            "versions[i].crc"
          ],
          "line": 1317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resolve_rel_crc",
          "args": [
            "crc"
          ],
          "line": 1312
        },
        "resolved": true,
        "details": {
          "function_name": "resolve_rel_crc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1278-1281",
          "snippet": "static u32 resolve_rel_crc(const s32 *crc)\n{\n\treturn *(u32 *)((void *)crc + *crc);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic u32 resolve_rel_crc(const s32 *crc)\n{\n\treturn *(u32 *)((void *)crc + *crc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_MODULE_REL_CRCS"
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "versions[i].name",
            "symname"
          ],
          "line": 1308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "try_to_force_load",
          "args": [
            "mod",
            "symname"
          ],
          "line": 1299
        },
        "resolved": true,
        "details": {
          "function_name": "try_to_force_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1264-1274",
          "snippet": "static int try_to_force_load(struct module *mod, const char *reason)\n{\n#ifdef CONFIG_MODULE_FORCE_LOAD\n\tif (!test_taint(TAINT_FORCED_MODULE))\n\t\tpr_warn(\"%s: %s: kernel tainted.\\n\", mod->name, reason);\n\tadd_taint_module(mod, TAINT_FORCED_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\treturn 0;\n#else\n\treturn -ENOEXEC;\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int try_to_force_load(struct module *mod, const char *reason)\n{\n#ifdef CONFIG_MODULE_FORCE_LOAD\n\tif (!test_taint(TAINT_FORCED_MODULE))\n\t\tpr_warn(\"%s: %s: kernel tainted.\\n\", mod->name, reason);\n\tadd_taint_module(mod, TAINT_FORCED_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\treturn 0;\n#else\n\treturn -ENOEXEC;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int check_version(const struct load_info *info,\n\t\t\t const char *symname,\n\t\t\t struct module *mod,\n\t\t\t const s32 *crc)\n{\n\tElf_Shdr *sechdrs = info->sechdrs;\n\tunsigned int versindex = info->index.vers;\n\tunsigned int i, num_versions;\n\tstruct modversion_info *versions;\n\n\t/* Exporting module didn't supply crcs?  OK, we're already tainted. */\n\tif (!crc)\n\t\treturn 1;\n\n\t/* No versions at all?  modprobe --force does this. */\n\tif (versindex == 0)\n\t\treturn try_to_force_load(mod, symname) == 0;\n\n\tversions = (void *) sechdrs[versindex].sh_addr;\n\tnum_versions = sechdrs[versindex].sh_size\n\t\t/ sizeof(struct modversion_info);\n\n\tfor (i = 0; i < num_versions; i++) {\n\t\tu32 crcval;\n\n\t\tif (strcmp(versions[i].name, symname) != 0)\n\t\t\tcontinue;\n\n\t\tif (IS_ENABLED(CONFIG_MODULE_REL_CRCS))\n\t\t\tcrcval = resolve_rel_crc(crc);\n\t\telse\n\t\t\tcrcval = *crc;\n\t\tif (versions[i].crc == crcval)\n\t\t\treturn 1;\n\t\tpr_debug(\"Found checksum %X vs module %lX\\n\",\n\t\t\t crcval, versions[i].crc);\n\t\tgoto bad_version;\n\t}\n\n\t/* Broken toolchain. Warn once, then let it go.. */\n\tpr_warn_once(\"%s: no symbol version for %s\\n\", info->name, symname);\n\treturn 1;\n\nbad_version:\n\tpr_warn(\"%s: disagrees about version of symbol %s\\n\",\n\t       info->name, symname);\n\treturn 0;\n}"
  },
  {
    "function_name": "resolve_rel_crc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1278-1281",
    "snippet": "static u32 resolve_rel_crc(const s32 *crc)\n{\n\treturn *(u32 *)((void *)crc + *crc);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic u32 resolve_rel_crc(const s32 *crc)\n{\n\treturn *(u32 *)((void *)crc + *crc);\n}"
  },
  {
    "function_name": "try_to_force_load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1264-1274",
    "snippet": "static int try_to_force_load(struct module *mod, const char *reason)\n{\n#ifdef CONFIG_MODULE_FORCE_LOAD\n\tif (!test_taint(TAINT_FORCED_MODULE))\n\t\tpr_warn(\"%s: %s: kernel tainted.\\n\", mod->name, reason);\n\tadd_taint_module(mod, TAINT_FORCED_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\treturn 0;\n#else\n\treturn -ENOEXEC;\n#endif\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_taint_module",
          "args": [
            "mod",
            "TAINT_FORCED_MODULE",
            "LOCKDEP_NOW_UNRELIABLE"
          ],
          "line": 1269
        },
        "resolved": true,
        "details": {
          "function_name": "add_taint_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "326-331",
          "snippet": "static inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: %s: kernel tainted.\\n\"",
            "mod->name",
            "reason"
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_taint",
          "args": [
            "TAINT_FORCED_MODULE"
          ],
          "line": 1267
        },
        "resolved": true,
        "details": {
          "function_name": "test_taint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/panic.c",
          "lines": "367-370",
          "snippet": "int test_taint(unsigned flag)\n{\n\treturn test_bit(flag, &tainted_mask);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nstatic unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;\n\nint test_taint(unsigned flag)\n{\n\treturn test_bit(flag, &tainted_mask);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int try_to_force_load(struct module *mod, const char *reason)\n{\n#ifdef CONFIG_MODULE_FORCE_LOAD\n\tif (!test_taint(TAINT_FORCED_MODULE))\n\t\tpr_warn(\"%s: %s: kernel tainted.\\n\", mod->name, reason);\n\tadd_taint_module(mod, TAINT_FORCED_MODULE, LOCKDEP_NOW_UNRELIABLE);\n\treturn 0;\n#else\n\treturn -ENOEXEC;\n#endif\n}"
  },
  {
    "function_name": "show_taint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1235-1243",
    "snippet": "static ssize_t show_taint(struct module_attribute *mattr,\n\t\t\t  struct module_kobject *mk, char *buffer)\n{\n\tsize_t l;\n\n\tl = module_flags_taint(mk->mod, buffer);\n\tbuffer[l++] = '\\n';\n\treturn l;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_flags_taint",
          "args": [
            "mk->mod",
            "buffer"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "module_flags_taint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1169-1180",
          "snippet": "static size_t module_flags_taint(struct module *mod, char *buf)\n{\n\tsize_t l = 0;\n\tint i;\n\n\tfor (i = 0; i < TAINT_FLAGS_COUNT; i++) {\n\t\tif (taint_flags[i].module && test_bit(i, &mod->taints))\n\t\t\tbuf[l++] = taint_flags[i].c_true;\n\t}\n\n\treturn l;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic size_t module_flags_taint(struct module *mod, char *buf)\n{\n\tsize_t l = 0;\n\tint i;\n\n\tfor (i = 0; i < TAINT_FLAGS_COUNT; i++) {\n\t\tif (taint_flags[i].module && test_bit(i, &mod->taints))\n\t\t\tbuf[l++] = taint_flags[i].c_true;\n\t}\n\n\treturn l;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic ssize_t show_taint(struct module_attribute *mattr,\n\t\t\t  struct module_kobject *mk, char *buffer)\n{\n\tsize_t l;\n\n\tl = module_flags_taint(mk->mod, buffer);\n\tbuffer[l++] = '\\n';\n\treturn l;\n}"
  },
  {
    "function_name": "show_initsize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1226-1230",
    "snippet": "static ssize_t show_initsize(struct module_attribute *mattr,\n\t\t\t     struct module_kobject *mk, char *buffer)\n{\n\treturn sprintf(buffer, \"%u\\n\", mk->mod->init_layout.size);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buffer",
            "\"%u\\n\"",
            "mk->mod->init_layout.size"
          ],
          "line": 1229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic ssize_t show_initsize(struct module_attribute *mattr,\n\t\t\t     struct module_kobject *mk, char *buffer)\n{\n\treturn sprintf(buffer, \"%u\\n\", mk->mod->init_layout.size);\n}"
  },
  {
    "function_name": "show_coresize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1217-1221",
    "snippet": "static ssize_t show_coresize(struct module_attribute *mattr,\n\t\t\t     struct module_kobject *mk, char *buffer)\n{\n\treturn sprintf(buffer, \"%u\\n\", mk->mod->core_layout.size);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buffer",
            "\"%u\\n\"",
            "mk->mod->core_layout.size"
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic ssize_t show_coresize(struct module_attribute *mattr,\n\t\t\t     struct module_kobject *mk, char *buffer)\n{\n\treturn sprintf(buffer, \"%u\\n\", mk->mod->core_layout.size);\n}"
  },
  {
    "function_name": "store_uevent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1206-1212",
    "snippet": "static ssize_t store_uevent(struct module_attribute *mattr,\n\t\t\t    struct module_kobject *mk,\n\t\t\t    const char *buffer, size_t count)\n{\n\tkobject_synth_uevent(&mk->kobj, buffer, count);\n\treturn count;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_synth_uevent",
          "args": [
            "&mk->kobj",
            "buffer",
            "count"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic ssize_t store_uevent(struct module_attribute *mattr,\n\t\t\t    struct module_kobject *mk,\n\t\t\t    const char *buffer, size_t count)\n{\n\tkobject_synth_uevent(&mk->kobj, buffer, count);\n\treturn count;\n}"
  },
  {
    "function_name": "show_initstate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1182-1201",
    "snippet": "static ssize_t show_initstate(struct module_attribute *mattr,\n\t\t\t      struct module_kobject *mk, char *buffer)\n{\n\tconst char *state = \"unknown\";\n\n\tswitch (mk->mod->state) {\n\tcase MODULE_STATE_LIVE:\n\t\tstate = \"live\";\n\t\tbreak;\n\tcase MODULE_STATE_COMING:\n\t\tstate = \"coming\";\n\t\tbreak;\n\tcase MODULE_STATE_GOING:\n\t\tstate = \"going\";\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n\treturn sprintf(buffer, \"%s\\n\", state);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buffer",
            "\"%s\\n\"",
            "state"
          ],
          "line": 1200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 1198
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic ssize_t show_initstate(struct module_attribute *mattr,\n\t\t\t      struct module_kobject *mk, char *buffer)\n{\n\tconst char *state = \"unknown\";\n\n\tswitch (mk->mod->state) {\n\tcase MODULE_STATE_LIVE:\n\t\tstate = \"live\";\n\t\tbreak;\n\tcase MODULE_STATE_COMING:\n\t\tstate = \"coming\";\n\t\tbreak;\n\tcase MODULE_STATE_GOING:\n\t\tstate = \"going\";\n\t\tbreak;\n\tdefault:\n\t\tBUG();\n\t}\n\treturn sprintf(buffer, \"%s\\n\", state);\n}"
  },
  {
    "function_name": "module_flags_taint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1169-1180",
    "snippet": "static size_t module_flags_taint(struct module *mod, char *buf)\n{\n\tsize_t l = 0;\n\tint i;\n\n\tfor (i = 0; i < TAINT_FLAGS_COUNT; i++) {\n\t\tif (taint_flags[i].module && test_bit(i, &mod->taints))\n\t\t\tbuf[l++] = taint_flags[i].c_true;\n\t}\n\n\treturn l;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "i",
            "&mod->taints"
          ],
          "line": 1175
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_test_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/snapshot.c",
          "lines": "811-820",
          "snippet": "static int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic size_t module_flags_taint(struct module *mod, char *buf)\n{\n\tsize_t l = 0;\n\tint i;\n\n\tfor (i = 0; i < TAINT_FLAGS_COUNT; i++) {\n\t\tif (taint_flags[i].module && test_bit(i, &mod->taints))\n\t\t\tbuf[l++] = taint_flags[i].c_true;\n\t}\n\n\treturn l;\n}"
  },
  {
    "function_name": "module_unload_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1163-1166",
    "snippet": "static inline int module_unload_init(struct module *mod)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int module_unload_init(struct module *mod)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "ref_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1157-1160",
    "snippet": "int ref_module(struct module *a, struct module *b)\n{\n\treturn strong_try_module_get(b);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strong_try_module_get",
          "args": [
            "b"
          ],
          "line": 1159
        },
        "resolved": true,
        "details": {
          "function_name": "strong_try_module_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "315-324",
          "snippet": "static inline int strong_try_module_get(struct module *mod)\n{\n\tBUG_ON(mod && mod->state == MODULE_STATE_UNFORMED);\n\tif (mod && mod->state == MODULE_STATE_COMING)\n\t\treturn -EBUSY;\n\tif (try_module_get(mod))\n\t\treturn 0;\n\telse\n\t\treturn -ENOENT;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int strong_try_module_get(struct module *mod)\n{\n\tBUG_ON(mod && mod->state == MODULE_STATE_UNFORMED);\n\tif (mod && mod->state == MODULE_STATE_COMING)\n\t\treturn -EBUSY;\n\tif (try_module_get(mod))\n\t\treturn 0;\n\telse\n\t\treturn -ENOENT;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nint ref_module(struct module *a, struct module *b)\n{\n\treturn strong_try_module_get(b);\n}"
  },
  {
    "function_name": "module_unload_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1153-1155",
    "snippet": "static inline void module_unload_free(struct module *mod)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void module_unload_free(struct module *mod)\n{\n}"
  },
  {
    "function_name": "print_unload_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1147-1151",
    "snippet": "static inline void print_unload_info(struct seq_file *m, struct module *mod)\n{\n\t/* We don't know the usage count, or what modules are using. */\n\tseq_puts(m, \" - -\");\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\" - -\""
          ],
          "line": 1150
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_seq.c",
          "lines": "208-223",
          "snippet": "void trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic inline void print_unload_info(struct seq_file *m, struct module *mod)\n{\n\t/* We don't know the usage count, or what modules are using. */\n\tseq_puts(m, \" - -\");\n}"
  },
  {
    "function_name": "module_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1132-1143",
    "snippet": "void module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_module_put",
          "args": [
            "module",
            "_RET_IP_"
          ],
          "line": 1140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ret < 0"
          ],
          "line": 1139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec_if_positive",
          "args": [
            "&module->refcnt"
          ],
          "line": 1138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 1137
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}"
  },
  {
    "function_name": "try_module_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1113-1129",
    "snippet": "bool try_module_get(struct module *module)\n{\n\tbool ret = true;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\t/* Note: here, we can fail to get a reference */\n\t\tif (likely(module_is_live(module) &&\n\t\t\t   atomic_inc_not_zero(&module->refcnt) != 0))\n\t\t\ttrace_module_get(module, _RET_IP_);\n\t\telse\n\t\t\tret = false;\n\n\t\tpreempt_enable();\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_module_get",
          "args": [
            "module",
            "_RET_IP_"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "module_is_live(module) &&\n\t\t\t   atomic_inc_not_zero(&module->refcnt) != 0"
          ],
          "line": 1120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc_not_zero",
          "args": [
            "&module->refcnt"
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_is_live",
          "args": [
            "module"
          ],
          "line": 1120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 1118
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nbool try_module_get(struct module *module)\n{\n\tbool ret = true;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\t/* Note: here, we can fail to get a reference */\n\t\tif (likely(module_is_live(module) &&\n\t\t\t   atomic_inc_not_zero(&module->refcnt) != 0))\n\t\t\ttrace_module_get(module, _RET_IP_);\n\t\telse\n\t\t\tret = false;\n\n\t\tpreempt_enable();\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "__module_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1102-1110",
    "snippet": "void __module_get(struct module *module)\n{\n\tif (module) {\n\t\tpreempt_disable();\n\t\tatomic_inc(&module->refcnt);\n\t\ttrace_module_get(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 1108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_module_get",
          "args": [
            "module",
            "_RET_IP_"
          ],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&module->refcnt"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 1105
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __module_get(struct module *module)\n{\n\tif (module) {\n\t\tpreempt_disable();\n\t\tatomic_inc(&module->refcnt);\n\t\ttrace_module_get(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}"
  },
  {
    "function_name": "show_refcnt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1093-1097",
    "snippet": "static ssize_t show_refcnt(struct module_attribute *mattr,\n\t\t\t   struct module_kobject *mk, char *buffer)\n{\n\treturn sprintf(buffer, \"%i\\n\", module_refcount(mk->mod));\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buffer",
            "\"%i\\n\"",
            "module_refcount(mk->mod)"
          ],
          "line": 1096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_refcount",
          "args": [
            "mk->mod"
          ],
          "line": 1096
        },
        "resolved": true,
        "details": {
          "function_name": "module_refcount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "951-954",
          "snippet": "int module_refcount(struct module *mod)\n{\n\treturn atomic_read(&mod->refcnt) - MODULE_REF_BASE;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define MODULE_REF_BASE\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define MODULE_REF_BASE\t1\n\nint module_refcount(struct module *mod)\n{\n\treturn atomic_read(&mod->refcnt) - MODULE_REF_BASE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic ssize_t show_refcnt(struct module_attribute *mattr,\n\t\t\t   struct module_kobject *mk, char *buffer)\n{\n\treturn sprintf(buffer, \"%i\\n\", module_refcount(mk->mod));\n}"
  },
  {
    "function_name": "symbol_put_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1073-1090",
    "snippet": "void symbol_put_addr(void *addr)\n{\n\tstruct module *modaddr;\n\tunsigned long a = (unsigned long)dereference_function_descriptor(addr);\n\n\tif (core_kernel_text(a))\n\t\treturn;\n\n\t/*\n\t * Even though we hold a reference on the module; we still need to\n\t * disable preemption in order to safely traverse the data structure.\n\t */\n\tpreempt_disable();\n\tmodaddr = __module_text_address(a);\n\tBUG_ON(!modaddr);\n\tmodule_put(modaddr);\n\tpreempt_enable();\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 1089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "modaddr"
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "module_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1132-1143",
          "snippet": "void module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!modaddr"
          ],
          "line": 1087
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__module_text_address",
          "args": [
            "a"
          ],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "__module_text_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "4363-4373",
          "snippet": "struct module *__module_text_address(unsigned long addr)\n{\n\tstruct module *mod = __module_address(addr);\n\tif (mod) {\n\t\t/* Make sure it's within the text section. */\n\t\tif (!within(addr, mod->init_layout.base, mod->init_layout.text_size)\n\t\t    && !within(addr, mod->core_layout.base, mod->core_layout.text_size))\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstruct module *__module_text_address(unsigned long addr)\n{\n\tstruct module *mod = __module_address(addr);\n\tif (mod) {\n\t\t/* Make sure it's within the text section. */\n\t\tif (!within(addr, mod->init_layout.base, mod->init_layout.text_size)\n\t\t    && !within(addr, mod->core_layout.base, mod->core_layout.text_size))\n\t\t\tmod = NULL;\n\t}\n\treturn mod;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "core_kernel_text",
          "args": [
            "a"
          ],
          "line": 1078
        },
        "resolved": true,
        "details": {
          "function_name": "core_kernel_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/extable.c",
          "lines": "75-85",
          "snippet": "int notrace core_kernel_text(unsigned long addr)\n{\n\tif (addr >= (unsigned long)_stext &&\n\t    addr < (unsigned long)_etext)\n\t\treturn 1;\n\n\tif (system_state < SYSTEM_RUNNING &&\n\t    init_kernel_text(addr))\n\t\treturn 1;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <asm/sections.h>",
            "#include <linux/filter.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/extable.h>",
            "#include <linux/memory.h>",
            "#include <linux/ftrace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nint notrace core_kernel_text(unsigned long addr)\n{\n\tif (addr >= (unsigned long)_stext &&\n\t    addr < (unsigned long)_etext)\n\t\treturn 1;\n\n\tif (system_state < SYSTEM_RUNNING &&\n\t    init_kernel_text(addr))\n\t\treturn 1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dereference_function_descriptor",
          "args": [
            "addr"
          ],
          "line": 1076
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid symbol_put_addr(void *addr)\n{\n\tstruct module *modaddr;\n\tunsigned long a = (unsigned long)dereference_function_descriptor(addr);\n\n\tif (core_kernel_text(a))\n\t\treturn;\n\n\t/*\n\t * Even though we hold a reference on the module; we still need to\n\t * disable preemption in order to safely traverse the data structure.\n\t */\n\tpreempt_disable();\n\tmodaddr = __module_text_address(a);\n\tBUG_ON(!modaddr);\n\tmodule_put(modaddr);\n\tpreempt_enable();\n}"
  },
  {
    "function_name": "__symbol_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1060-1069",
    "snippet": "void __symbol_put(const char *symbol)\n{\n\tstruct module *owner;\n\n\tpreempt_disable();\n\tif (!find_symbol(symbol, &owner, NULL, true, false))\n\t\tBUG();\n\tmodule_put(owner);\n\tpreempt_enable();\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "owner"
          ],
          "line": 1067
        },
        "resolved": true,
        "details": {
          "function_name": "module_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1132-1143",
          "snippet": "void module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_symbol",
          "args": [
            "symbol",
            "&owner",
            "NULL",
            "true",
            "false"
          ],
          "line": 1065
        },
        "resolved": true,
        "details": {
          "function_name": "find_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "576-598",
          "snippet": "const struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nconst struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __symbol_put(const char *symbol)\n{\n\tstruct module *owner;\n\n\tpreempt_disable();\n\tif (!find_symbol(symbol, &owner, NULL, true, false))\n\t\tBUG();\n\tmodule_put(owner);\n\tpreempt_enable();\n}"
  },
  {
    "function_name": "print_unload_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "1035-1058",
    "snippet": "static inline void print_unload_info(struct seq_file *m, struct module *mod)\n{\n\tstruct module_use *use;\n\tint printed_something = 0;\n\n\tseq_printf(m, \" %i \", module_refcount(mod));\n\n\t/*\n\t * Always include a trailing , so userspace can differentiate\n\t * between this and the old multi-field proc format.\n\t */\n\tlist_for_each_entry(use, &mod->source_list, source_list) {\n\t\tprinted_something = 1;\n\t\tseq_printf(m, \"%s,\", use->source->name);\n\t}\n\n\tif (mod->init != NULL && mod->exit == NULL) {\n\t\tprinted_something = 1;\n\t\tseq_puts(m, \"[permanent],\");\n\t}\n\n\tif (!printed_something)\n\t\tseq_puts(m, \"-\");\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"-\""
          ],
          "line": 1057
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_seq.c",
          "lines": "208-223",
          "snippet": "void trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%s,\"",
            "use->source->name"
          ],
          "line": 1048
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_seq.c",
          "lines": "84-103",
          "snippet": "void trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "use",
            "&mod->source_list",
            "source_list"
          ],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_refcount",
          "args": [
            "mod"
          ],
          "line": 1040
        },
        "resolved": true,
        "details": {
          "function_name": "module_refcount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "951-954",
          "snippet": "int module_refcount(struct module *mod)\n{\n\treturn atomic_read(&mod->refcnt) - MODULE_REF_BASE;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define MODULE_REF_BASE\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define MODULE_REF_BASE\t1\n\nint module_refcount(struct module *mod)\n{\n\treturn atomic_read(&mod->refcnt) - MODULE_REF_BASE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void print_unload_info(struct seq_file *m, struct module *mod)\n{\n\tstruct module_use *use;\n\tint printed_something = 0;\n\n\tseq_printf(m, \" %i \", module_refcount(mod));\n\n\t/*\n\t * Always include a trailing , so userspace can differentiate\n\t * between this and the old multi-field proc format.\n\t */\n\tlist_for_each_entry(use, &mod->source_list, source_list) {\n\t\tprinted_something = 1;\n\t\tseq_printf(m, \"%s,\", use->source->name);\n\t}\n\n\tif (mod->init != NULL && mod->exit == NULL) {\n\t\tprinted_something = 1;\n\t\tseq_puts(m, \"[permanent],\");\n\t}\n\n\tif (!printed_something)\n\t\tseq_puts(m, \"-\");\n}"
  },
  {
    "function_name": "module_refcount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "951-954",
    "snippet": "int module_refcount(struct module *mod)\n{\n\treturn atomic_read(&mod->refcnt) - MODULE_REF_BASE;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define MODULE_REF_BASE\t1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&mod->refcnt"
          ],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define MODULE_REF_BASE\t1\n\nint module_refcount(struct module *mod)\n{\n\treturn atomic_read(&mod->refcnt) - MODULE_REF_BASE;\n}"
  },
  {
    "function_name": "try_stop_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "927-940",
    "snippet": "static int try_stop_module(struct module *mod, int flags, int *forced)\n{\n\t/* If it's not unused, quit unless we're forcing. */\n\tif (try_release_module_ref(mod) != 0) {\n\t\t*forced = try_force_unload(flags);\n\t\tif (!(*forced))\n\t\t\treturn -EWOULDBLOCK;\n\t}\n\n\t/* Mark it as dying. */\n\tmod->state = MODULE_STATE_GOING;\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "try_force_unload",
          "args": [
            "flags"
          ],
          "line": 931
        },
        "resolved": true,
        "details": {
          "function_name": "try_force_unload",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "906-909",
          "snippet": "static inline int try_force_unload(unsigned int flags)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int try_force_unload(unsigned int flags)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "try_release_module_ref",
          "args": [
            "mod"
          ],
          "line": 930
        },
        "resolved": true,
        "details": {
          "function_name": "try_release_module_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "913-925",
          "snippet": "static int try_release_module_ref(struct module *mod)\n{\n\tint ret;\n\n\t/* Try to decrement refcnt which we set at loading */\n\tret = atomic_sub_return(MODULE_REF_BASE, &mod->refcnt);\n\tBUG_ON(ret < 0);\n\tif (ret)\n\t\t/* Someone can put this right now, recover with checking */\n\t\tret = atomic_add_unless(&mod->refcnt, MODULE_REF_BASE, 0);\n\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define MODULE_REF_BASE\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define MODULE_REF_BASE\t1\n\nstatic int try_release_module_ref(struct module *mod)\n{\n\tint ret;\n\n\t/* Try to decrement refcnt which we set at loading */\n\tret = atomic_sub_return(MODULE_REF_BASE, &mod->refcnt);\n\tBUG_ON(ret < 0);\n\tif (ret)\n\t\t/* Someone can put this right now, recover with checking */\n\t\tret = atomic_add_unless(&mod->refcnt, MODULE_REF_BASE, 0);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int try_stop_module(struct module *mod, int flags, int *forced)\n{\n\t/* If it's not unused, quit unless we're forcing. */\n\tif (try_release_module_ref(mod) != 0) {\n\t\t*forced = try_force_unload(flags);\n\t\tif (!(*forced))\n\t\t\treturn -EWOULDBLOCK;\n\t}\n\n\t/* Mark it as dying. */\n\tmod->state = MODULE_STATE_GOING;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "try_release_module_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "913-925",
    "snippet": "static int try_release_module_ref(struct module *mod)\n{\n\tint ret;\n\n\t/* Try to decrement refcnt which we set at loading */\n\tret = atomic_sub_return(MODULE_REF_BASE, &mod->refcnt);\n\tBUG_ON(ret < 0);\n\tif (ret)\n\t\t/* Someone can put this right now, recover with checking */\n\t\tret = atomic_add_unless(&mod->refcnt, MODULE_REF_BASE, 0);\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define MODULE_REF_BASE\t1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_add_unless",
          "args": [
            "&mod->refcnt",
            "MODULE_REF_BASE",
            "0"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "ret < 0"
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_sub_return",
          "args": [
            "MODULE_REF_BASE",
            "&mod->refcnt"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define MODULE_REF_BASE\t1\n\nstatic int try_release_module_ref(struct module *mod)\n{\n\tint ret;\n\n\t/* Try to decrement refcnt which we set at loading */\n\tret = atomic_sub_return(MODULE_REF_BASE, &mod->refcnt);\n\tBUG_ON(ret < 0);\n\tif (ret)\n\t\t/* Someone can put this right now, recover with checking */\n\t\tret = atomic_add_unless(&mod->refcnt, MODULE_REF_BASE, 0);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "try_force_unload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "906-909",
    "snippet": "static inline int try_force_unload(unsigned int flags)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int try_force_unload(unsigned int flags)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "try_force_unload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "898-904",
    "snippet": "static inline int try_force_unload(unsigned int flags)\n{\n\tint ret = (flags & O_TRUNC);\n\tif (ret)\n\t\tadd_taint(TAINT_FORCED_RMMOD, LOCKDEP_NOW_UNRELIABLE);\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_taint",
          "args": [
            "TAINT_FORCED_RMMOD",
            "LOCKDEP_NOW_UNRELIABLE"
          ],
          "line": 902
        },
        "resolved": true,
        "details": {
          "function_name": "add_taint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/panic.c",
          "lines": "386-392",
          "snippet": "void add_taint(unsigned flag, enum lockdep_ok lockdep_ok)\n{\n\tif (lockdep_ok == LOCKDEP_NOW_UNRELIABLE && __debug_locks_off())\n\t\tpr_warn(\"Disabling lock debugging due to kernel taint\\n\");\n\n\tset_bit(flag, &tainted_mask);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nstatic unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;\n\nvoid add_taint(unsigned flag, enum lockdep_ok lockdep_ok)\n{\n\tif (lockdep_ok == LOCKDEP_NOW_UNRELIABLE && __debug_locks_off())\n\t\tpr_warn(\"Disabling lock debugging due to kernel taint\\n\");\n\n\tset_bit(flag, &tainted_mask);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int try_force_unload(unsigned int flags)\n{\n\tint ret = (flags & O_TRUNC);\n\tif (ret)\n\t\tadd_taint(TAINT_FORCED_RMMOD, LOCKDEP_NOW_UNRELIABLE);\n\treturn ret;\n}"
  },
  {
    "function_name": "module_unload_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "881-895",
    "snippet": "static void module_unload_free(struct module *mod)\n{\n\tstruct module_use *use, *tmp;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry_safe(use, tmp, &mod->target_list, target_list) {\n\t\tstruct module *i = use->target;\n\t\tpr_debug(\"%s unusing %s\\n\", mod->name, i->name);\n\t\tmodule_put(i);\n\t\tlist_del(&use->source_list);\n\t\tlist_del(&use->target_list);\n\t\tkfree(use);\n\t}\n\tmutex_unlock(&module_mutex);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&module_mutex"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "use"
          ],
          "line": 892
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&use->target_list"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "list_del_leaf_cfs_rq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/fair.c",
          "lines": "446-448",
          "snippet": "static inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}",
          "includes": [
            "#include \"sched-pelt.h\"",
            "#include \"pelt.h\"",
            "#include <trace/events/sched.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_enqueue_throttle(struct cfs_rq *cfs_rq);",
            "static __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);",
            "static bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sched-pelt.h\"\n#include \"pelt.h\"\n#include <trace/events/sched.h>\n#include \"sched.h\"\n\nstatic void check_enqueue_throttle(struct cfs_rq *cfs_rq);\nstatic __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);\nstatic bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);\n\nstatic inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "i"
          ],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "module_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1132-1143",
          "snippet": "void module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"%s unusing %s\\n\"",
            "mod->name",
            "i->name"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "use",
            "tmp",
            "&mod->target_list",
            "target_list"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&module_mutex"
          ],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_unload_free(struct module *mod)\n{\n\tstruct module_use *use, *tmp;\n\n\tmutex_lock(&module_mutex);\n\tlist_for_each_entry_safe(use, tmp, &mod->target_list, target_list) {\n\t\tstruct module *i = use->target;\n\t\tpr_debug(\"%s unusing %s\\n\", mod->name, i->name);\n\t\tmodule_put(i);\n\t\tlist_del(&use->source_list);\n\t\tlist_del(&use->target_list);\n\t\tkfree(use);\n\t}\n\tmutex_unlock(&module_mutex);\n}"
  },
  {
    "function_name": "ref_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "859-877",
    "snippet": "int ref_module(struct module *a, struct module *b)\n{\n\tint err;\n\n\tif (b == NULL || already_uses(a, b))\n\t\treturn 0;\n\n\t/* If module isn't available, we fail. */\n\terr = strong_try_module_get(b);\n\tif (err)\n\t\treturn err;\n\n\terr = add_module_usage(a, b);\n\tif (err) {\n\t\tmodule_put(b);\n\t\treturn err;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "b"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "module_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1132-1143",
          "snippet": "void module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_module_usage",
          "args": [
            "a",
            "b"
          ],
          "line": 871
        },
        "resolved": true,
        "details": {
          "function_name": "add_module_usage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "842-856",
          "snippet": "static int add_module_usage(struct module *a, struct module *b)\n{\n\tstruct module_use *use;\n\n\tpr_debug(\"Allocating new usage for %s.\\n\", a->name);\n\tuse = kmalloc(sizeof(*use), GFP_ATOMIC);\n\tif (!use)\n\t\treturn -ENOMEM;\n\n\tuse->source = a;\n\tuse->target = b;\n\tlist_add(&use->source_list, &b->source_list);\n\tlist_add(&use->target_list, &a->target_list);\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int add_module_usage(struct module *a, struct module *b)\n{\n\tstruct module_use *use;\n\n\tpr_debug(\"Allocating new usage for %s.\\n\", a->name);\n\tuse = kmalloc(sizeof(*use), GFP_ATOMIC);\n\tif (!use)\n\t\treturn -ENOMEM;\n\n\tuse->source = a;\n\tuse->target = b;\n\tlist_add(&use->source_list, &b->source_list);\n\tlist_add(&use->target_list, &a->target_list);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strong_try_module_get",
          "args": [
            "b"
          ],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "strong_try_module_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "315-324",
          "snippet": "static inline int strong_try_module_get(struct module *mod)\n{\n\tBUG_ON(mod && mod->state == MODULE_STATE_UNFORMED);\n\tif (mod && mod->state == MODULE_STATE_COMING)\n\t\treturn -EBUSY;\n\tif (try_module_get(mod))\n\t\treturn 0;\n\telse\n\t\treturn -ENOENT;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int strong_try_module_get(struct module *mod)\n{\n\tBUG_ON(mod && mod->state == MODULE_STATE_UNFORMED);\n\tif (mod && mod->state == MODULE_STATE_COMING)\n\t\treturn -EBUSY;\n\tif (try_module_get(mod))\n\t\treturn 0;\n\telse\n\t\treturn -ENOENT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "already_uses",
          "args": [
            "a",
            "b"
          ],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "already_uses",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "821-833",
          "snippet": "static int already_uses(struct module *a, struct module *b)\n{\n\tstruct module_use *use;\n\n\tlist_for_each_entry(use, &b->source_list, source_list) {\n\t\tif (use->source == a) {\n\t\t\tpr_debug(\"%s uses %s!\\n\", a->name, b->name);\n\t\t\treturn 1;\n\t\t}\n\t}\n\tpr_debug(\"%s does not use %s!\\n\", a->name, b->name);\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int already_uses(struct module *a, struct module *b)\n{\n\tstruct module_use *use;\n\n\tlist_for_each_entry(use, &b->source_list, source_list) {\n\t\tif (use->source == a) {\n\t\t\tpr_debug(\"%s uses %s!\\n\", a->name, b->name);\n\t\t\treturn 1;\n\t\t}\n\t}\n\tpr_debug(\"%s does not use %s!\\n\", a->name, b->name);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nint ref_module(struct module *a, struct module *b)\n{\n\tint err;\n\n\tif (b == NULL || already_uses(a, b))\n\t\treturn 0;\n\n\t/* If module isn't available, we fail. */\n\terr = strong_try_module_get(b);\n\tif (err)\n\t\treturn err;\n\n\terr = add_module_usage(a, b);\n\tif (err) {\n\t\tmodule_put(b);\n\t\treturn err;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "add_module_usage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "842-856",
    "snippet": "static int add_module_usage(struct module *a, struct module *b)\n{\n\tstruct module_use *use;\n\n\tpr_debug(\"Allocating new usage for %s.\\n\", a->name);\n\tuse = kmalloc(sizeof(*use), GFP_ATOMIC);\n\tif (!use)\n\t\treturn -ENOMEM;\n\n\tuse->source = a;\n\tuse->target = b;\n\tlist_add(&use->source_list, &b->source_list);\n\tlist_add(&use->target_list, &a->target_list);\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&use->target_list",
            "&a->target_list"
          ],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "list_add_event",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/events/core.c",
          "lines": "1662-1690",
          "snippet": "static void\nlist_add_event(struct perf_event *event, struct perf_event_context *ctx)\n{\n\tlockdep_assert_held(&ctx->lock);\n\n\tWARN_ON_ONCE(event->attach_state & PERF_ATTACH_CONTEXT);\n\tevent->attach_state |= PERF_ATTACH_CONTEXT;\n\n\tevent->tstamp = perf_event_time(event);\n\n\t/*\n\t * If we're a stand alone event or group leader, we go to the context\n\t * list, group events are kept attached to the group so that\n\t * perf_group_detach can, at all times, locate all siblings.\n\t */\n\tif (event->group_leader == event) {\n\t\tevent->group_caps = event->event_caps;\n\t\tadd_event_to_groups(event, ctx);\n\t}\n\n\tlist_update_cgroup_event(event, ctx, true);\n\n\tlist_add_rcu(&event->event_entry, &ctx->event_list);\n\tctx->nr_events++;\n\tif (event->attr.inherit_stat)\n\t\tctx->nr_stat++;\n\n\tctx->generation++;\n}",
          "includes": [
            "#include <asm/irq_regs.h>",
            "#include \"internal.h\"",
            "#include <linux/mount.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/parser.h>",
            "#include <linux/namei.h>",
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/compat.h>",
            "#include <linux/mman.h>",
            "#include <linux/module.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/export.h>",
            "#include <linux/device.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/percpu.h>",
            "#include <linux/dcache.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/tick.h>",
            "#include <linux/hash.h>",
            "#include <linux/slab.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/idr.h>",
            "#include <linux/smp.h>",
            "#include <linux/cpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void update_context_time(struct perf_event_context *ctx);",
            "static u64 perf_event_time(struct perf_event *event);",
            "static __must_check struct",
            "static void perf_log_itrace_start(struct perf_event *event);",
            "static void perf_event_free_filter(struct perf_event *event);",
            "static void perf_event_free_bpf_prog(struct perf_event *event);",
            "static int perf_copy_attr(struct perf_event_attr __user *uattr,\n\t\t\t  struct perf_event_attr *attr);",
            "static void perf_pmu_output_stop(struct perf_event *event);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/irq_regs.h>\n#include \"internal.h\"\n#include <linux/mount.h>\n#include <linux/proc_ns.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/clock.h>\n#include <linux/parser.h>\n#include <linux/namei.h>\n#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/compat.h>\n#include <linux/mman.h>\n#include <linux/module.h>\n#include <linux/mm_types.h>\n#include <linux/hw_breakpoint.h>\n#include <linux/trace_events.h>\n#include <linux/perf_event.h>\n#include <linux/cgroup.h>\n#include <linux/kernel_stat.h>\n#include <linux/anon_inodes.h>\n#include <linux/syscalls.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/hardirq.h>\n#include <linux/vmalloc.h>\n#include <linux/export.h>\n#include <linux/device.h>\n#include <linux/vmstat.h>\n#include <linux/reboot.h>\n#include <linux/ptrace.h>\n#include <linux/percpu.h>\n#include <linux/dcache.h>\n#include <linux/sysfs.h>\n#include <linux/tick.h>\n#include <linux/hash.h>\n#include <linux/slab.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/idr.h>\n#include <linux/smp.h>\n#include <linux/cpu.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n\nstatic void update_context_time(struct perf_event_context *ctx);\nstatic u64 perf_event_time(struct perf_event *event);\nstatic __must_check struct;\nstatic void perf_log_itrace_start(struct perf_event *event);\nstatic void perf_event_free_filter(struct perf_event *event);\nstatic void perf_event_free_bpf_prog(struct perf_event *event);\nstatic int perf_copy_attr(struct perf_event_attr __user *uattr,\n\t\t\t  struct perf_event_attr *attr);\nstatic void perf_pmu_output_stop(struct perf_event *event);\n\nstatic void\nlist_add_event(struct perf_event *event, struct perf_event_context *ctx)\n{\n\tlockdep_assert_held(&ctx->lock);\n\n\tWARN_ON_ONCE(event->attach_state & PERF_ATTACH_CONTEXT);\n\tevent->attach_state |= PERF_ATTACH_CONTEXT;\n\n\tevent->tstamp = perf_event_time(event);\n\n\t/*\n\t * If we're a stand alone event or group leader, we go to the context\n\t * list, group events are kept attached to the group so that\n\t * perf_group_detach can, at all times, locate all siblings.\n\t */\n\tif (event->group_leader == event) {\n\t\tevent->group_caps = event->event_caps;\n\t\tadd_event_to_groups(event, ctx);\n\t}\n\n\tlist_update_cgroup_event(event, ctx, true);\n\n\tlist_add_rcu(&event->event_entry, &ctx->event_list);\n\tctx->nr_events++;\n\tif (event->attr.inherit_stat)\n\t\tctx->nr_stat++;\n\n\tctx->generation++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*use)",
            "GFP_ATOMIC"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "debug_kmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/debug/kdb/kdb_support.c",
          "lines": "745-801",
          "snippet": "void *debug_kmalloc(size_t size, gfp_t flags)\n{\n\tunsigned int rem, h_offset;\n\tstruct debug_alloc_header *best, *bestprev, *prev, *h;\n\tvoid *p = NULL;\n\tif (!get_dap_lock()) {\n\t\t__release(dap_lock);\t/* we never actually got it */\n\t\treturn NULL;\n\t}\n\th = (struct debug_alloc_header *)(debug_alloc_pool + dah_first);\n\tif (dah_first_call) {\n\t\th->size = sizeof(debug_alloc_pool_aligned) - dah_overhead;\n\t\tdah_first_call = 0;\n\t}\n\tsize = ALIGN(size, dah_align);\n\tprev = best = bestprev = NULL;\n\twhile (1) {\n\t\tif (h->size >= size && (!best || h->size < best->size)) {\n\t\t\tbest = h;\n\t\t\tbestprev = prev;\n\t\t\tif (h->size == size)\n\t\t\t\tbreak;\n\t\t}\n\t\tif (!h->next)\n\t\t\tbreak;\n\t\tprev = h;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h->next);\n\t}\n\tif (!best)\n\t\tgoto out;\n\trem = best->size - size;\n\t/* The pool must always contain at least one header */\n\tif (best->next == 0 && bestprev == NULL && rem < dah_overhead)\n\t\tgoto out;\n\tif (rem >= dah_overhead) {\n\t\tbest->size = size;\n\t\th_offset = ((char *)best - debug_alloc_pool) +\n\t\t\t   dah_overhead + best->size;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h_offset);\n\t\th->size = rem - dah_overhead;\n\t\th->next = best->next;\n\t} else\n\t\th_offset = best->next;\n\tbest->caller = __builtin_return_address(0);\n\tdah_used += best->size;\n\tdah_used_max = max(dah_used, dah_used_max);\n\tif (bestprev)\n\t\tbestprev->next = h_offset;\n\telse\n\t\tdah_first = h_offset;\n\tp = (char *)best + dah_overhead;\n\tmemset(p, POISON_INUSE, best->size - 1);\n\t*((char *)p + best->size - 1) = POISON_END;\nout:\n\tspin_unlock(&dap_lock);\n\treturn p;\n}",
          "includes": [
            "#include \"kdb_private.h\"",
            "#include <linux/slab.h>",
            "#include <linux/kdb.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/highmem.h>",
            "#include <linux/module.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/stddef.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/types.h>",
            "#include <stdarg.h>"
          ],
          "macros_used": [
            "#define dah_overhead ALIGN(sizeof(struct debug_alloc_header), dah_align)",
            "#define dah_align 8"
          ],
          "globals_used": [
            "static u64 debug_alloc_pool_aligned[256*1024/dah_align];",
            "static char *debug_alloc_pool = (char *)debug_alloc_pool_aligned;",
            "static u32 dah_first, dah_first_call = 1, dah_used, dah_used_max;",
            "static DEFINE_SPINLOCK(dap_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kdb_private.h\"\n#include <linux/slab.h>\n#include <linux/kdb.h>\n#include <linux/uaccess.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/highmem.h>\n#include <linux/module.h>\n#include <linux/ptrace.h>\n#include <linux/vmalloc.h>\n#include <linux/stddef.h>\n#include <linux/kallsyms.h>\n#include <linux/mm.h>\n#include <linux/sched.h>\n#include <linux/types.h>\n#include <stdarg.h>\n\n#define dah_overhead ALIGN(sizeof(struct debug_alloc_header), dah_align)\n#define dah_align 8\n\nstatic u64 debug_alloc_pool_aligned[256*1024/dah_align];\nstatic char *debug_alloc_pool = (char *)debug_alloc_pool_aligned;\nstatic u32 dah_first, dah_first_call = 1, dah_used, dah_used_max;\nstatic DEFINE_SPINLOCK(dap_lock);\n\nvoid *debug_kmalloc(size_t size, gfp_t flags)\n{\n\tunsigned int rem, h_offset;\n\tstruct debug_alloc_header *best, *bestprev, *prev, *h;\n\tvoid *p = NULL;\n\tif (!get_dap_lock()) {\n\t\t__release(dap_lock);\t/* we never actually got it */\n\t\treturn NULL;\n\t}\n\th = (struct debug_alloc_header *)(debug_alloc_pool + dah_first);\n\tif (dah_first_call) {\n\t\th->size = sizeof(debug_alloc_pool_aligned) - dah_overhead;\n\t\tdah_first_call = 0;\n\t}\n\tsize = ALIGN(size, dah_align);\n\tprev = best = bestprev = NULL;\n\twhile (1) {\n\t\tif (h->size >= size && (!best || h->size < best->size)) {\n\t\t\tbest = h;\n\t\t\tbestprev = prev;\n\t\t\tif (h->size == size)\n\t\t\t\tbreak;\n\t\t}\n\t\tif (!h->next)\n\t\t\tbreak;\n\t\tprev = h;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h->next);\n\t}\n\tif (!best)\n\t\tgoto out;\n\trem = best->size - size;\n\t/* The pool must always contain at least one header */\n\tif (best->next == 0 && bestprev == NULL && rem < dah_overhead)\n\t\tgoto out;\n\tif (rem >= dah_overhead) {\n\t\tbest->size = size;\n\t\th_offset = ((char *)best - debug_alloc_pool) +\n\t\t\t   dah_overhead + best->size;\n\t\th = (struct debug_alloc_header *)(debug_alloc_pool + h_offset);\n\t\th->size = rem - dah_overhead;\n\t\th->next = best->next;\n\t} else\n\t\th_offset = best->next;\n\tbest->caller = __builtin_return_address(0);\n\tdah_used += best->size;\n\tdah_used_max = max(dah_used, dah_used_max);\n\tif (bestprev)\n\t\tbestprev->next = h_offset;\n\telse\n\t\tdah_first = h_offset;\n\tp = (char *)best + dah_overhead;\n\tmemset(p, POISON_INUSE, best->size - 1);\n\t*((char *)p + best->size - 1) = POISON_END;\nout:\n\tspin_unlock(&dap_lock);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"Allocating new usage for %s.\\n\"",
            "a->name"
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int add_module_usage(struct module *a, struct module *b)\n{\n\tstruct module_use *use;\n\n\tpr_debug(\"Allocating new usage for %s.\\n\", a->name);\n\tuse = kmalloc(sizeof(*use), GFP_ATOMIC);\n\tif (!use)\n\t\treturn -ENOMEM;\n\n\tuse->source = a;\n\tuse->target = b;\n\tlist_add(&use->source_list, &b->source_list);\n\tlist_add(&use->target_list, &a->target_list);\n\treturn 0;\n}"
  },
  {
    "function_name": "already_uses",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "821-833",
    "snippet": "static int already_uses(struct module *a, struct module *b)\n{\n\tstruct module_use *use;\n\n\tlist_for_each_entry(use, &b->source_list, source_list) {\n\t\tif (use->source == a) {\n\t\t\tpr_debug(\"%s uses %s!\\n\", a->name, b->name);\n\t\t\treturn 1;\n\t\t}\n\t}\n\tpr_debug(\"%s does not use %s!\\n\", a->name, b->name);\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"%s does not use %s!\\n\"",
            "a->name",
            "b->name"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"%s uses %s!\\n\"",
            "a->name",
            "b->name"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "use",
            "&b->source_list",
            "source_list"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int already_uses(struct module *a, struct module *b)\n{\n\tstruct module_use *use;\n\n\tlist_for_each_entry(use, &b->source_list, source_list) {\n\t\tif (use->source == a) {\n\t\t\tpr_debug(\"%s uses %s!\\n\", a->name, b->name);\n\t\t\treturn 1;\n\t\t}\n\t}\n\tpr_debug(\"%s does not use %s!\\n\", a->name, b->name);\n\treturn 0;\n}"
  },
  {
    "function_name": "module_unload_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "803-818",
    "snippet": "static int module_unload_init(struct module *mod)\n{\n\t/*\n\t * Initialize reference counter to MODULE_REF_BASE.\n\t * refcnt == 0 means module is going.\n\t */\n\tatomic_set(&mod->refcnt, MODULE_REF_BASE);\n\n\tINIT_LIST_HEAD(&mod->source_list);\n\tINIT_LIST_HEAD(&mod->target_list);\n\n\t/* Hold reference count during initialization. */\n\tatomic_inc(&mod->refcnt);\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define MODULE_REF_BASE\t1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&mod->refcnt"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&mod->target_list"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&mod->source_list"
          ],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&mod->refcnt",
            "MODULE_REF_BASE"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define MODULE_REF_BASE\t1\n\nstatic int module_unload_init(struct module *mod)\n{\n\t/*\n\t * Initialize reference counter to MODULE_REF_BASE.\n\t * refcnt == 0 means module is going.\n\t */\n\tatomic_set(&mod->refcnt, MODULE_REF_BASE);\n\n\tINIT_LIST_HEAD(&mod->source_list);\n\tINIT_LIST_HEAD(&mod->target_list);\n\n\t/* Hold reference count during initialization. */\n\tatomic_inc(&mod->refcnt);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "__is_module_percpu_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "756-759",
    "snippet": "bool __is_module_percpu_address(unsigned long addr, unsigned long *can_addr)\n{\n\treturn false;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nbool __is_module_percpu_address(unsigned long addr, unsigned long *can_addr)\n{\n\treturn false;\n}"
  },
  {
    "function_name": "is_module_percpu_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "751-754",
    "snippet": "bool is_module_percpu_address(unsigned long addr)\n{\n\treturn false;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nbool is_module_percpu_address(unsigned long addr)\n{\n\treturn false;\n}"
  },
  {
    "function_name": "percpu_modcopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "745-750",
    "snippet": "static inline void percpu_modcopy(struct module *mod,\n\t\t\t\t  const void *from, unsigned long size)\n{\n\t/* pcpusec should be 0, and size of that section should be 0. */\n\tBUG_ON(size != 0);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "size != 0"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void percpu_modcopy(struct module *mod,\n\t\t\t\t  const void *from, unsigned long size)\n{\n\t/* pcpusec should be 0, and size of that section should be 0. */\n\tBUG_ON(size != 0);\n}"
  },
  {
    "function_name": "find_pcpusec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "741-744",
    "snippet": "static unsigned int find_pcpusec(struct load_info *info)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned int find_pcpusec(struct load_info *info)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "percpu_modfree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "738-740",
    "snippet": "static inline void percpu_modfree(struct module *mod)\n{\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void percpu_modfree(struct module *mod)\n{\n}"
  },
  {
    "function_name": "percpu_modalloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "731-737",
    "snippet": "static int percpu_modalloc(struct module *mod, struct load_info *info)\n{\n\t/* UP modules shouldn't have this section: ENOMEM isn't quite right */\n\tif (info->sechdrs[info->index.pcpu].sh_size != 0)\n\t\treturn -ENOMEM;\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic int percpu_modalloc(struct module *mod, struct load_info *info)\n{\n\t/* UP modules shouldn't have this section: ENOMEM isn't quite right */\n\tif (info->sechdrs[info->index.pcpu].sh_size != 0)\n\t\treturn -ENOMEM;\n\treturn 0;\n}"
  },
  {
    "function_name": "mod_percpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "727-730",
    "snippet": "static inline void __percpu *mod_percpu(struct module *mod)\n{\n\treturn NULL;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void __percpu *mod_percpu(struct module *mod)\n{\n\treturn NULL;\n}"
  },
  {
    "function_name": "is_module_percpu_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "720-723",
    "snippet": "bool is_module_percpu_address(unsigned long addr)\n{\n\treturn __is_module_percpu_address(addr, NULL);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__is_module_percpu_address",
          "args": [
            "addr",
            "NULL"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "__is_module_percpu_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "756-759",
          "snippet": "bool __is_module_percpu_address(unsigned long addr, unsigned long *can_addr)\n{\n\treturn false;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nbool __is_module_percpu_address(unsigned long addr, unsigned long *can_addr)\n{\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nbool is_module_percpu_address(unsigned long addr)\n{\n\treturn __is_module_percpu_address(addr, NULL);\n}"
  },
  {
    "function_name": "__is_module_percpu_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "678-709",
    "snippet": "bool __is_module_percpu_address(unsigned long addr, unsigned long *can_addr)\n{\n\tstruct module *mod;\n\tunsigned int cpu;\n\n\tpreempt_disable();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (!mod->percpu_size)\n\t\t\tcontinue;\n\t\tfor_each_possible_cpu(cpu) {\n\t\t\tvoid *start = per_cpu_ptr(mod->percpu, cpu);\n\t\t\tvoid *va = (void *)addr;\n\n\t\t\tif (va >= start && va < start + mod->percpu_size) {\n\t\t\t\tif (can_addr) {\n\t\t\t\t\t*can_addr = (unsigned long) (va - start);\n\t\t\t\t\t*can_addr += (unsigned long)\n\t\t\t\t\t\tper_cpu_ptr(mod->percpu,\n\t\t\t\t\t\t\t    get_boot_cpu_id());\n\t\t\t\t}\n\t\t\t\tpreempt_enable();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tpreempt_enable();\n\treturn false;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu_ptr",
          "args": [
            "mod->percpu",
            "get_boot_cpu_id()"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_boot_cpu_id",
          "args": [],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu_ptr",
          "args": [
            "mod->percpu",
            "cpu"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "3571-3576",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nbool __is_module_percpu_address(unsigned long addr, unsigned long *can_addr)\n{\n\tstruct module *mod;\n\tunsigned int cpu;\n\n\tpreempt_disable();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (!mod->percpu_size)\n\t\t\tcontinue;\n\t\tfor_each_possible_cpu(cpu) {\n\t\t\tvoid *start = per_cpu_ptr(mod->percpu, cpu);\n\t\t\tvoid *va = (void *)addr;\n\n\t\t\tif (va >= start && va < start + mod->percpu_size) {\n\t\t\t\tif (can_addr) {\n\t\t\t\t\t*can_addr = (unsigned long) (va - start);\n\t\t\t\t\t*can_addr += (unsigned long)\n\t\t\t\t\t\tper_cpu_ptr(mod->percpu,\n\t\t\t\t\t\t\t    get_boot_cpu_id());\n\t\t\t\t}\n\t\t\t\tpreempt_enable();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tpreempt_enable();\n\treturn false;\n}"
  },
  {
    "function_name": "percpu_modcopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "669-676",
    "snippet": "static void percpu_modcopy(struct module *mod,\n\t\t\t   const void *from, unsigned long size)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu)\n\t\tmemcpy(per_cpu_ptr(mod->percpu, cpu), from, size);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void percpu_modcopy(struct module *mod,\n\t\t\t   const void *from, unsigned long size)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu)\n\t\tmemcpy(per_cpu_ptr(mod->percpu, cpu), from, size);\n}"
  },
  {
    "function_name": "find_pcpusec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "664-667",
    "snippet": "static unsigned int find_pcpusec(struct load_info *info)\n{\n\treturn find_sec(info, \".data..percpu\");\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "find_sec",
          "args": [
            "info",
            "\".data..percpu\""
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "find_sec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "345-357",
          "snippet": "static unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned int find_pcpusec(struct load_info *info)\n{\n\treturn find_sec(info, \".data..percpu\");\n}"
  },
  {
    "function_name": "percpu_modfree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "659-662",
    "snippet": "static void percpu_modfree(struct module *mod)\n{\n\tfree_percpu(mod->percpu);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_percpu",
          "args": [
            "mod->percpu"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_array_free_percpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/arraymap.c",
          "lines": "27-35",
          "snippet": "static void bpf_array_free_percpu(struct bpf_array *array)\n{\n\tint i;\n\n\tfor (i = 0; i < array->map.max_entries; i++) {\n\t\tfree_percpu(array->pptrs[i]);\n\t\tcond_resched();\n\t}\n}",
          "includes": [
            "#include \"map_in_map.h\"",
            "#include <uapi/linux/btf.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/filter.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map_in_map.h\"\n#include <uapi/linux/btf.h>\n#include <linux/perf_event.h>\n#include <linux/filter.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n\nstatic void bpf_array_free_percpu(struct bpf_array *array)\n{\n\tint i;\n\n\tfor (i = 0; i < array->map.max_entries; i++) {\n\t\tfree_percpu(array->pptrs[i]);\n\t\tcond_resched();\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void percpu_modfree(struct module *mod)\n{\n\tfree_percpu(mod->percpu);\n}"
  },
  {
    "function_name": "percpu_modalloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "635-657",
    "snippet": "static int percpu_modalloc(struct module *mod, struct load_info *info)\n{\n\tElf_Shdr *pcpusec = &info->sechdrs[info->index.pcpu];\n\tunsigned long align = pcpusec->sh_addralign;\n\n\tif (!pcpusec->sh_size)\n\t\treturn 0;\n\n\tif (align > PAGE_SIZE) {\n\t\tpr_warn(\"%s: per-cpu alignment %li > %li\\n\",\n\t\t\tmod->name, align, PAGE_SIZE);\n\t\talign = PAGE_SIZE;\n\t}\n\n\tmod->percpu = __alloc_reserved_percpu(pcpusec->sh_size, align);\n\tif (!mod->percpu) {\n\t\tpr_warn(\"%s: Could not allocate %lu bytes percpu data\\n\",\n\t\t\tmod->name, (unsigned long)pcpusec->sh_size);\n\t\treturn -ENOMEM;\n\t}\n\tmod->percpu_size = pcpusec->sh_size;\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: Could not allocate %lu bytes percpu data\\n\"",
            "mod->name",
            "(unsigned long)pcpusec->sh_size"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__alloc_reserved_percpu",
          "args": [
            "pcpusec->sh_size",
            "align"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: per-cpu alignment %li > %li\\n\"",
            "mod->name",
            "align",
            "PAGE_SIZE"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int percpu_modalloc(struct module *mod, struct load_info *info)\n{\n\tElf_Shdr *pcpusec = &info->sechdrs[info->index.pcpu];\n\tunsigned long align = pcpusec->sh_addralign;\n\n\tif (!pcpusec->sh_size)\n\t\treturn 0;\n\n\tif (align > PAGE_SIZE) {\n\t\tpr_warn(\"%s: per-cpu alignment %li > %li\\n\",\n\t\t\tmod->name, align, PAGE_SIZE);\n\t\talign = PAGE_SIZE;\n\t}\n\n\tmod->percpu = __alloc_reserved_percpu(pcpusec->sh_size, align);\n\tif (!mod->percpu) {\n\t\tpr_warn(\"%s: Could not allocate %lu bytes percpu data\\n\",\n\t\t\tmod->name, (unsigned long)pcpusec->sh_size);\n\t\treturn -ENOMEM;\n\t}\n\tmod->percpu_size = pcpusec->sh_size;\n\treturn 0;\n}"
  },
  {
    "function_name": "mod_percpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "630-633",
    "snippet": "static inline void __percpu *mod_percpu(struct module *mod)\n{\n\treturn mod->percpu;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void __percpu *mod_percpu(struct module *mod)\n{\n\treturn mod->percpu;\n}"
  },
  {
    "function_name": "find_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "621-625",
    "snippet": "struct module *find_module(const char *name)\n{\n\tmodule_assert_mutex();\n\treturn find_module_all(name, strlen(name), false);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "find_module_all",
          "args": [
            "name",
            "strlen(name)",
            "false"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "find_module_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "605-619",
          "snippet": "static struct module *find_module_all(const char *name, size_t len,\n\t\t\t\t      bool even_unformed)\n{\n\tstruct module *mod;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (!even_unformed && mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (strlen(mod->name) == len && !memcmp(mod->name, name, len))\n\t\t\treturn mod;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(modules);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic struct module *find_module_all(const char *name, size_t len,\n\t\t\t\t      bool even_unformed)\n{\n\tstruct module *mod;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (!even_unformed && mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (strlen(mod->name) == len && !memcmp(mod->name, name, len))\n\t\t\treturn mod;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "fetch_store_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_uprobe.c",
          "lines": "137-146",
          "snippet": "static nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/string.h>",
            "#include <linux/namei.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include <linux/rculist.h>\n#include <linux/string.h>\n#include <linux/namei.h>\n#include <linux/uprobes.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n\nstatic nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_assert_mutex",
          "args": [],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "module_assert_mutex_or_preempt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "265-274",
          "snippet": "static void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstruct module *find_module(const char *name)\n{\n\tmodule_assert_mutex();\n\treturn find_module_all(name, strlen(name), false);\n}"
  },
  {
    "function_name": "find_module_all",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "605-619",
    "snippet": "static struct module *find_module_all(const char *name, size_t len,\n\t\t\t\t      bool even_unformed)\n{\n\tstruct module *mod;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (!even_unformed && mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (strlen(mod->name) == len && !memcmp(mod->name, name, len))\n\t\t\treturn mod;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "mod->name",
            "name",
            "len"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "mod->name"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "fetch_store_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_uprobe.c",
          "lines": "137-146",
          "snippet": "static nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/string.h>",
            "#include <linux/namei.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include <linux/rculist.h>\n#include <linux/string.h>\n#include <linux/namei.h>\n#include <linux/uprobes.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n\nstatic nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint len;\n\tvoid __user *vaddr = (void __force __user *) addr;\n\n\tlen = strnlen_user(vaddr, MAX_STRING_SIZE);\n\n\treturn (len > MAX_STRING_SIZE) ? 0 : len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_assert_mutex_or_preempt",
          "args": [],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "module_assert_mutex_or_preempt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "265-274",
          "snippet": "static void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic struct module *find_module_all(const char *name, size_t len,\n\t\t\t\t      bool even_unformed)\n{\n\tstruct module *mod;\n\n\tmodule_assert_mutex_or_preempt();\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (!even_unformed && mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\t\tif (strlen(mod->name) == len && !memcmp(mod->name, name, len))\n\t\t\treturn mod;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "find_symbol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "576-598",
    "snippet": "const struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"Failed to find symbol %s\\n\"",
            "name"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "each_symbol_section",
          "args": [
            "find_symbol_in_section",
            "&fsa"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "each_symbol_section",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "423-483",
          "snippet": "bool each_symbol_section(bool (*fn)(const struct symsearch *arr,\n\t\t\t\t    struct module *owner,\n\t\t\t\t    void *data),\n\t\t\t void *data)\n{\n\tstruct module *mod;\n\tstatic const struct symsearch arr[] = {\n\t\t{ __start___ksymtab, __stop___ksymtab, __start___kcrctab,\n\t\t  NOT_GPL_ONLY, false },\n\t\t{ __start___ksymtab_gpl, __stop___ksymtab_gpl,\n\t\t  __start___kcrctab_gpl,\n\t\t  GPL_ONLY, false },\n\t\t{ __start___ksymtab_gpl_future, __stop___ksymtab_gpl_future,\n\t\t  __start___kcrctab_gpl_future,\n\t\t  WILL_BE_GPL_ONLY, false },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t{ __start___ksymtab_unused, __stop___ksymtab_unused,\n\t\t  __start___kcrctab_unused,\n\t\t  NOT_GPL_ONLY, true },\n\t\t{ __start___ksymtab_unused_gpl, __stop___ksymtab_unused_gpl,\n\t\t  __start___kcrctab_unused_gpl,\n\t\t  GPL_ONLY, true },\n#endif\n\t};\n\n\tmodule_assert_mutex_or_preempt();\n\n\tif (each_symbol_in_section(arr, ARRAY_SIZE(arr), NULL, fn, data))\n\t\treturn true;\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tstruct symsearch arr[] = {\n\t\t\t{ mod->syms, mod->syms + mod->num_syms, mod->crcs,\n\t\t\t  NOT_GPL_ONLY, false },\n\t\t\t{ mod->gpl_syms, mod->gpl_syms + mod->num_gpl_syms,\n\t\t\t  mod->gpl_crcs,\n\t\t\t  GPL_ONLY, false },\n\t\t\t{ mod->gpl_future_syms,\n\t\t\t  mod->gpl_future_syms + mod->num_gpl_future_syms,\n\t\t\t  mod->gpl_future_crcs,\n\t\t\t  WILL_BE_GPL_ONLY, false },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t\t{ mod->unused_syms,\n\t\t\t  mod->unused_syms + mod->num_unused_syms,\n\t\t\t  mod->unused_crcs,\n\t\t\t  NOT_GPL_ONLY, true },\n\t\t\t{ mod->unused_gpl_syms,\n\t\t\t  mod->unused_gpl_syms + mod->num_unused_gpl_syms,\n\t\t\t  mod->unused_gpl_crcs,\n\t\t\t  GPL_ONLY, true },\n#endif\n\t\t};\n\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\n\t\tif (each_symbol_in_section(arr, ARRAY_SIZE(arr), mod, fn, data))\n\t\t\treturn true;\n\t}\n\treturn false;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(modules);",
            "extern const struct kernel_symbol __start___ksymtab[];",
            "extern const struct kernel_symbol __stop___ksymtab[];",
            "extern const struct kernel_symbol __start___ksymtab_gpl[];",
            "extern const struct kernel_symbol __stop___ksymtab_gpl[];",
            "extern const struct kernel_symbol __start___ksymtab_gpl_future[];",
            "extern const struct kernel_symbol __stop___ksymtab_gpl_future[];",
            "extern const s32 __start___kcrctab[];",
            "extern const s32 __start___kcrctab_gpl[];",
            "extern const s32 __start___kcrctab_gpl_future[];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\nextern const struct kernel_symbol __start___ksymtab[];\nextern const struct kernel_symbol __stop___ksymtab[];\nextern const struct kernel_symbol __start___ksymtab_gpl[];\nextern const struct kernel_symbol __stop___ksymtab_gpl[];\nextern const struct kernel_symbol __start___ksymtab_gpl_future[];\nextern const struct kernel_symbol __stop___ksymtab_gpl_future[];\nextern const s32 __start___kcrctab[];\nextern const s32 __start___kcrctab_gpl[];\nextern const s32 __start___kcrctab_gpl_future[];\n\nbool each_symbol_section(bool (*fn)(const struct symsearch *arr,\n\t\t\t\t    struct module *owner,\n\t\t\t\t    void *data),\n\t\t\t void *data)\n{\n\tstruct module *mod;\n\tstatic const struct symsearch arr[] = {\n\t\t{ __start___ksymtab, __stop___ksymtab, __start___kcrctab,\n\t\t  NOT_GPL_ONLY, false },\n\t\t{ __start___ksymtab_gpl, __stop___ksymtab_gpl,\n\t\t  __start___kcrctab_gpl,\n\t\t  GPL_ONLY, false },\n\t\t{ __start___ksymtab_gpl_future, __stop___ksymtab_gpl_future,\n\t\t  __start___kcrctab_gpl_future,\n\t\t  WILL_BE_GPL_ONLY, false },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t{ __start___ksymtab_unused, __stop___ksymtab_unused,\n\t\t  __start___kcrctab_unused,\n\t\t  NOT_GPL_ONLY, true },\n\t\t{ __start___ksymtab_unused_gpl, __stop___ksymtab_unused_gpl,\n\t\t  __start___kcrctab_unused_gpl,\n\t\t  GPL_ONLY, true },\n#endif\n\t};\n\n\tmodule_assert_mutex_or_preempt();\n\n\tif (each_symbol_in_section(arr, ARRAY_SIZE(arr), NULL, fn, data))\n\t\treturn true;\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tstruct symsearch arr[] = {\n\t\t\t{ mod->syms, mod->syms + mod->num_syms, mod->crcs,\n\t\t\t  NOT_GPL_ONLY, false },\n\t\t\t{ mod->gpl_syms, mod->gpl_syms + mod->num_gpl_syms,\n\t\t\t  mod->gpl_crcs,\n\t\t\t  GPL_ONLY, false },\n\t\t\t{ mod->gpl_future_syms,\n\t\t\t  mod->gpl_future_syms + mod->num_gpl_future_syms,\n\t\t\t  mod->gpl_future_crcs,\n\t\t\t  WILL_BE_GPL_ONLY, false },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t\t{ mod->unused_syms,\n\t\t\t  mod->unused_syms + mod->num_unused_syms,\n\t\t\t  mod->unused_crcs,\n\t\t\t  NOT_GPL_ONLY, true },\n\t\t\t{ mod->unused_gpl_syms,\n\t\t\t  mod->unused_gpl_syms + mod->num_unused_gpl_syms,\n\t\t\t  mod->unused_gpl_crcs,\n\t\t\t  GPL_ONLY, true },\n#endif\n\t\t};\n\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\n\t\tif (each_symbol_in_section(arr, ARRAY_SIZE(arr), mod, fn, data))\n\t\t\treturn true;\n\t}\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nconst struct kernel_symbol *find_symbol(const char *name,\n\t\t\t\t\tstruct module **owner,\n\t\t\t\t\tconst s32 **crc,\n\t\t\t\t\tbool gplok,\n\t\t\t\t\tbool warn)\n{\n\tstruct find_symbol_arg fsa;\n\n\tfsa.name = name;\n\tfsa.gplok = gplok;\n\tfsa.warn = warn;\n\n\tif (each_symbol_section(find_symbol_in_section, &fsa)) {\n\t\tif (owner)\n\t\t\t*owner = fsa.owner;\n\t\tif (crc)\n\t\t\t*crc = fsa.crc;\n\t\treturn fsa.sym;\n\t}\n\n\tpr_debug(\"Failed to find symbol %s\\n\", name);\n\treturn NULL;\n}"
  },
  {
    "function_name": "find_symbol_in_section",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "558-572",
    "snippet": "static bool find_symbol_in_section(const struct symsearch *syms,\n\t\t\t\t   struct module *owner,\n\t\t\t\t   void *data)\n{\n\tstruct find_symbol_arg *fsa = data;\n\tstruct kernel_symbol *sym;\n\n\tsym = bsearch(fsa->name, syms->start, syms->stop - syms->start,\n\t\t\tsizeof(struct kernel_symbol), cmp_name);\n\n\tif (sym != NULL && check_symbol(syms, owner, sym - syms->start, data))\n\t\treturn true;\n\n\treturn false;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "check_symbol",
          "args": [
            "syms",
            "owner",
            "sym - syms->start",
            "data"
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "check_symbol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "498-530",
          "snippet": "static bool check_symbol(const struct symsearch *syms,\n\t\t\t\t struct module *owner,\n\t\t\t\t unsigned int symnum, void *data)\n{\n\tstruct find_symbol_arg *fsa = data;\n\n\tif (!fsa->gplok) {\n\t\tif (syms->licence == GPL_ONLY)\n\t\t\treturn false;\n\t\tif (syms->licence == WILL_BE_GPL_ONLY && fsa->warn) {\n\t\t\tpr_warn(\"Symbol %s is being used by a non-GPL module, \"\n\t\t\t\t\"which will not be allowed in the future\\n\",\n\t\t\t\tfsa->name);\n\t\t}\n\t}\n\n#ifdef CONFIG_UNUSED_SYMBOLS\n\tif (syms->unused && fsa->warn) {\n\t\tpr_warn(\"Symbol %s is marked as UNUSED, however this module is \"\n\t\t\t\"using it.\\n\", fsa->name);\n\t\tpr_warn(\"This symbol will go away in the future.\\n\");\n\t\tpr_warn(\"Please evaluate if this is the right api to use and \"\n\t\t\t\"if it really is, submit a report to the linux kernel \"\n\t\t\t\"mailing list together with submitting your code for \"\n\t\t\t\"inclusion.\\n\");\n\t}\n#endif\n\n\tfsa->owner = owner;\n\tfsa->crc = symversion(syms->crcs, symnum);\n\tfsa->sym = &syms->start[symnum];\n\treturn true;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic bool check_symbol(const struct symsearch *syms,\n\t\t\t\t struct module *owner,\n\t\t\t\t unsigned int symnum, void *data)\n{\n\tstruct find_symbol_arg *fsa = data;\n\n\tif (!fsa->gplok) {\n\t\tif (syms->licence == GPL_ONLY)\n\t\t\treturn false;\n\t\tif (syms->licence == WILL_BE_GPL_ONLY && fsa->warn) {\n\t\t\tpr_warn(\"Symbol %s is being used by a non-GPL module, \"\n\t\t\t\t\"which will not be allowed in the future\\n\",\n\t\t\t\tfsa->name);\n\t\t}\n\t}\n\n#ifdef CONFIG_UNUSED_SYMBOLS\n\tif (syms->unused && fsa->warn) {\n\t\tpr_warn(\"Symbol %s is marked as UNUSED, however this module is \"\n\t\t\t\"using it.\\n\", fsa->name);\n\t\tpr_warn(\"This symbol will go away in the future.\\n\");\n\t\tpr_warn(\"Please evaluate if this is the right api to use and \"\n\t\t\t\"if it really is, submit a report to the linux kernel \"\n\t\t\t\"mailing list together with submitting your code for \"\n\t\t\t\"inclusion.\\n\");\n\t}\n#endif\n\n\tfsa->owner = owner;\n\tfsa->crc = symversion(syms->crcs, symnum);\n\tfsa->sym = &syms->start[symnum];\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bsearch",
          "args": [
            "fsa->name",
            "syms->start",
            "syms->stop - syms->start",
            "sizeof(struct kernel_symbol)",
            "cmp_name"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic bool find_symbol_in_section(const struct symsearch *syms,\n\t\t\t\t   struct module *owner,\n\t\t\t\t   void *data)\n{\n\tstruct find_symbol_arg *fsa = data;\n\tstruct kernel_symbol *sym;\n\n\tsym = bsearch(fsa->name, syms->start, syms->stop - syms->start,\n\t\t\tsizeof(struct kernel_symbol), cmp_name);\n\n\tif (sym != NULL && check_symbol(syms, owner, sym - syms->start, data))\n\t\treturn true;\n\n\treturn false;\n}"
  },
  {
    "function_name": "cmp_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "550-556",
    "snippet": "static int cmp_name(const void *va, const void *vb)\n{\n\tconst char *a;\n\tconst struct kernel_symbol *b;\n\ta = va; b = vb;\n\treturn strcmp(a, kernel_symbol_name(b));\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "a",
            "kernel_symbol_name(b)"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kernel_symbol_name",
          "args": [
            "b"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "kernel_symbol_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "541-548",
          "snippet": "static const char *kernel_symbol_name(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn offset_to_ptr(&sym->name_offset);\n#else\n\treturn sym->name;\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const char *kernel_symbol_name(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn offset_to_ptr(&sym->name_offset);\n#else\n\treturn sym->name;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic int cmp_name(const void *va, const void *vb)\n{\n\tconst char *a;\n\tconst struct kernel_symbol *b;\n\ta = va; b = vb;\n\treturn strcmp(a, kernel_symbol_name(b));\n}"
  },
  {
    "function_name": "kernel_symbol_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "541-548",
    "snippet": "static const char *kernel_symbol_name(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn offset_to_ptr(&sym->name_offset);\n#else\n\treturn sym->name;\n#endif\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "offset_to_ptr",
          "args": [
            "&sym->name_offset"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic const char *kernel_symbol_name(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn offset_to_ptr(&sym->name_offset);\n#else\n\treturn sym->name;\n#endif\n}"
  },
  {
    "function_name": "kernel_symbol_value",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "532-539",
    "snippet": "static unsigned long kernel_symbol_value(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn (unsigned long)offset_to_ptr(&sym->value_offset);\n#else\n\treturn sym->value;\n#endif\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "offset_to_ptr",
          "args": [
            "&sym->value_offset"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned long kernel_symbol_value(const struct kernel_symbol *sym)\n{\n#ifdef CONFIG_HAVE_ARCH_PREL32_RELOCATIONS\n\treturn (unsigned long)offset_to_ptr(&sym->value_offset);\n#else\n\treturn sym->value;\n#endif\n}"
  },
  {
    "function_name": "check_symbol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "498-530",
    "snippet": "static bool check_symbol(const struct symsearch *syms,\n\t\t\t\t struct module *owner,\n\t\t\t\t unsigned int symnum, void *data)\n{\n\tstruct find_symbol_arg *fsa = data;\n\n\tif (!fsa->gplok) {\n\t\tif (syms->licence == GPL_ONLY)\n\t\t\treturn false;\n\t\tif (syms->licence == WILL_BE_GPL_ONLY && fsa->warn) {\n\t\t\tpr_warn(\"Symbol %s is being used by a non-GPL module, \"\n\t\t\t\t\"which will not be allowed in the future\\n\",\n\t\t\t\tfsa->name);\n\t\t}\n\t}\n\n#ifdef CONFIG_UNUSED_SYMBOLS\n\tif (syms->unused && fsa->warn) {\n\t\tpr_warn(\"Symbol %s is marked as UNUSED, however this module is \"\n\t\t\t\"using it.\\n\", fsa->name);\n\t\tpr_warn(\"This symbol will go away in the future.\\n\");\n\t\tpr_warn(\"Please evaluate if this is the right api to use and \"\n\t\t\t\"if it really is, submit a report to the linux kernel \"\n\t\t\t\"mailing list together with submitting your code for \"\n\t\t\t\"inclusion.\\n\");\n\t}\n#endif\n\n\tfsa->owner = owner;\n\tfsa->crc = symversion(syms->crcs, symnum);\n\tfsa->sym = &syms->start[symnum];\n\treturn true;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "symversion",
          "args": [
            "syms->crcs",
            "symnum"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Please evaluate if this is the right api to use and \"\n\t\t\t\"if it really is, submit a report to the linux kernel \"\n\t\t\t\"mailing list together with submitting your code for \"\n\t\t\t\"inclusion.\\n\""
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"This symbol will go away in the future.\\n\""
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Symbol %s is marked as UNUSED, however this module is \"\n\t\t\t\"using it.\\n\"",
            "fsa->name"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Symbol %s is being used by a non-GPL module, \"\n\t\t\t\t\"which will not be allowed in the future\\n\"",
            "fsa->name"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic bool check_symbol(const struct symsearch *syms,\n\t\t\t\t struct module *owner,\n\t\t\t\t unsigned int symnum, void *data)\n{\n\tstruct find_symbol_arg *fsa = data;\n\n\tif (!fsa->gplok) {\n\t\tif (syms->licence == GPL_ONLY)\n\t\t\treturn false;\n\t\tif (syms->licence == WILL_BE_GPL_ONLY && fsa->warn) {\n\t\t\tpr_warn(\"Symbol %s is being used by a non-GPL module, \"\n\t\t\t\t\"which will not be allowed in the future\\n\",\n\t\t\t\tfsa->name);\n\t\t}\n\t}\n\n#ifdef CONFIG_UNUSED_SYMBOLS\n\tif (syms->unused && fsa->warn) {\n\t\tpr_warn(\"Symbol %s is marked as UNUSED, however this module is \"\n\t\t\t\"using it.\\n\", fsa->name);\n\t\tpr_warn(\"This symbol will go away in the future.\\n\");\n\t\tpr_warn(\"Please evaluate if this is the right api to use and \"\n\t\t\t\"if it really is, submit a report to the linux kernel \"\n\t\t\t\"mailing list together with submitting your code for \"\n\t\t\t\"inclusion.\\n\");\n\t}\n#endif\n\n\tfsa->owner = owner;\n\tfsa->crc = symversion(syms->crcs, symnum);\n\tfsa->sym = &syms->start[symnum];\n\treturn true;\n}"
  },
  {
    "function_name": "each_symbol_section",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "423-483",
    "snippet": "bool each_symbol_section(bool (*fn)(const struct symsearch *arr,\n\t\t\t\t    struct module *owner,\n\t\t\t\t    void *data),\n\t\t\t void *data)\n{\n\tstruct module *mod;\n\tstatic const struct symsearch arr[] = {\n\t\t{ __start___ksymtab, __stop___ksymtab, __start___kcrctab,\n\t\t  NOT_GPL_ONLY, false },\n\t\t{ __start___ksymtab_gpl, __stop___ksymtab_gpl,\n\t\t  __start___kcrctab_gpl,\n\t\t  GPL_ONLY, false },\n\t\t{ __start___ksymtab_gpl_future, __stop___ksymtab_gpl_future,\n\t\t  __start___kcrctab_gpl_future,\n\t\t  WILL_BE_GPL_ONLY, false },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t{ __start___ksymtab_unused, __stop___ksymtab_unused,\n\t\t  __start___kcrctab_unused,\n\t\t  NOT_GPL_ONLY, true },\n\t\t{ __start___ksymtab_unused_gpl, __stop___ksymtab_unused_gpl,\n\t\t  __start___kcrctab_unused_gpl,\n\t\t  GPL_ONLY, true },\n#endif\n\t};\n\n\tmodule_assert_mutex_or_preempt();\n\n\tif (each_symbol_in_section(arr, ARRAY_SIZE(arr), NULL, fn, data))\n\t\treturn true;\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tstruct symsearch arr[] = {\n\t\t\t{ mod->syms, mod->syms + mod->num_syms, mod->crcs,\n\t\t\t  NOT_GPL_ONLY, false },\n\t\t\t{ mod->gpl_syms, mod->gpl_syms + mod->num_gpl_syms,\n\t\t\t  mod->gpl_crcs,\n\t\t\t  GPL_ONLY, false },\n\t\t\t{ mod->gpl_future_syms,\n\t\t\t  mod->gpl_future_syms + mod->num_gpl_future_syms,\n\t\t\t  mod->gpl_future_crcs,\n\t\t\t  WILL_BE_GPL_ONLY, false },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t\t{ mod->unused_syms,\n\t\t\t  mod->unused_syms + mod->num_unused_syms,\n\t\t\t  mod->unused_crcs,\n\t\t\t  NOT_GPL_ONLY, true },\n\t\t\t{ mod->unused_gpl_syms,\n\t\t\t  mod->unused_gpl_syms + mod->num_unused_gpl_syms,\n\t\t\t  mod->unused_gpl_crcs,\n\t\t\t  GPL_ONLY, true },\n#endif\n\t\t};\n\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\n\t\tif (each_symbol_in_section(arr, ARRAY_SIZE(arr), mod, fn, data))\n\t\t\treturn true;\n\t}\n\treturn false;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);",
      "extern const struct kernel_symbol __start___ksymtab[];",
      "extern const struct kernel_symbol __stop___ksymtab[];",
      "extern const struct kernel_symbol __start___ksymtab_gpl[];",
      "extern const struct kernel_symbol __stop___ksymtab_gpl[];",
      "extern const struct kernel_symbol __start___ksymtab_gpl_future[];",
      "extern const struct kernel_symbol __stop___ksymtab_gpl_future[];",
      "extern const s32 __start___kcrctab[];",
      "extern const s32 __start___kcrctab_gpl[];",
      "extern const s32 __start___kcrctab_gpl_future[];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "each_symbol_in_section",
          "args": [
            "arr",
            "ARRAY_SIZE(arr)",
            "mod",
            "fn",
            "data"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "each_symbol_in_section",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "404-420",
          "snippet": "static bool each_symbol_in_section(const struct symsearch *arr,\n\t\t\t\t   unsigned int arrsize,\n\t\t\t\t   struct module *owner,\n\t\t\t\t   bool (*fn)(const struct symsearch *syms,\n\t\t\t\t\t      struct module *owner,\n\t\t\t\t\t      void *data),\n\t\t\t\t   void *data)\n{\n\tunsigned int j;\n\n\tfor (j = 0; j < arrsize; j++) {\n\t\tif (fn(&arr[j], owner, data))\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic bool each_symbol_in_section(const struct symsearch *arr,\n\t\t\t\t   unsigned int arrsize,\n\t\t\t\t   struct module *owner,\n\t\t\t\t   bool (*fn)(const struct symsearch *syms,\n\t\t\t\t\t      struct module *owner,\n\t\t\t\t\t      void *data),\n\t\t\t\t   void *data)\n{\n\tunsigned int j;\n\n\tfor (j = 0; j < arrsize; j++) {\n\t\tif (fn(&arr[j], owner, data))\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "arr"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "arr"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module_assert_mutex_or_preempt",
          "args": [],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "module_assert_mutex_or_preempt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "265-274",
          "snippet": "static void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\nextern const struct kernel_symbol __start___ksymtab[];\nextern const struct kernel_symbol __stop___ksymtab[];\nextern const struct kernel_symbol __start___ksymtab_gpl[];\nextern const struct kernel_symbol __stop___ksymtab_gpl[];\nextern const struct kernel_symbol __start___ksymtab_gpl_future[];\nextern const struct kernel_symbol __stop___ksymtab_gpl_future[];\nextern const s32 __start___kcrctab[];\nextern const s32 __start___kcrctab_gpl[];\nextern const s32 __start___kcrctab_gpl_future[];\n\nbool each_symbol_section(bool (*fn)(const struct symsearch *arr,\n\t\t\t\t    struct module *owner,\n\t\t\t\t    void *data),\n\t\t\t void *data)\n{\n\tstruct module *mod;\n\tstatic const struct symsearch arr[] = {\n\t\t{ __start___ksymtab, __stop___ksymtab, __start___kcrctab,\n\t\t  NOT_GPL_ONLY, false },\n\t\t{ __start___ksymtab_gpl, __stop___ksymtab_gpl,\n\t\t  __start___kcrctab_gpl,\n\t\t  GPL_ONLY, false },\n\t\t{ __start___ksymtab_gpl_future, __stop___ksymtab_gpl_future,\n\t\t  __start___kcrctab_gpl_future,\n\t\t  WILL_BE_GPL_ONLY, false },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t{ __start___ksymtab_unused, __stop___ksymtab_unused,\n\t\t  __start___kcrctab_unused,\n\t\t  NOT_GPL_ONLY, true },\n\t\t{ __start___ksymtab_unused_gpl, __stop___ksymtab_unused_gpl,\n\t\t  __start___kcrctab_unused_gpl,\n\t\t  GPL_ONLY, true },\n#endif\n\t};\n\n\tmodule_assert_mutex_or_preempt();\n\n\tif (each_symbol_in_section(arr, ARRAY_SIZE(arr), NULL, fn, data))\n\t\treturn true;\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tstruct symsearch arr[] = {\n\t\t\t{ mod->syms, mod->syms + mod->num_syms, mod->crcs,\n\t\t\t  NOT_GPL_ONLY, false },\n\t\t\t{ mod->gpl_syms, mod->gpl_syms + mod->num_gpl_syms,\n\t\t\t  mod->gpl_crcs,\n\t\t\t  GPL_ONLY, false },\n\t\t\t{ mod->gpl_future_syms,\n\t\t\t  mod->gpl_future_syms + mod->num_gpl_future_syms,\n\t\t\t  mod->gpl_future_crcs,\n\t\t\t  WILL_BE_GPL_ONLY, false },\n#ifdef CONFIG_UNUSED_SYMBOLS\n\t\t\t{ mod->unused_syms,\n\t\t\t  mod->unused_syms + mod->num_unused_syms,\n\t\t\t  mod->unused_crcs,\n\t\t\t  NOT_GPL_ONLY, true },\n\t\t\t{ mod->unused_gpl_syms,\n\t\t\t  mod->unused_gpl_syms + mod->num_unused_gpl_syms,\n\t\t\t  mod->unused_gpl_crcs,\n\t\t\t  GPL_ONLY, true },\n#endif\n\t\t};\n\n\t\tif (mod->state == MODULE_STATE_UNFORMED)\n\t\t\tcontinue;\n\n\t\tif (each_symbol_in_section(arr, ARRAY_SIZE(arr), mod, fn, data))\n\t\t\treturn true;\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "each_symbol_in_section",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "404-420",
    "snippet": "static bool each_symbol_in_section(const struct symsearch *arr,\n\t\t\t\t   unsigned int arrsize,\n\t\t\t\t   struct module *owner,\n\t\t\t\t   bool (*fn)(const struct symsearch *syms,\n\t\t\t\t\t      struct module *owner,\n\t\t\t\t\t      void *data),\n\t\t\t\t   void *data)\n{\n\tunsigned int j;\n\n\tfor (j = 0; j < arrsize; j++) {\n\t\tif (fn(&arr[j], owner, data))\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fn",
          "args": [
            "&arr[j]",
            "owner",
            "data"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "trace_fn_bin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_output.c",
          "lines": "889-901",
          "snippet": "static enum print_line_t trace_fn_bin(struct trace_iterator *iter, int flags,\n\t\t\t\t      struct trace_event *event)\n{\n\tstruct ftrace_entry *field;\n\tstruct trace_seq *s = &iter->seq;\n\n\ttrace_assign_type(field, iter->ent);\n\n\tSEQ_PUT_FIELD(s, field->ip);\n\tSEQ_PUT_FIELD(s, field->parent_ip);\n\n\treturn trace_handle_return(s);\n}",
          "includes": [
            "#include \"trace_output.h\"",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_output.h\"\n#include <linux/sched/mm.h>\n#include <linux/sched/clock.h>\n#include <linux/ftrace.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n\nstatic enum print_line_t trace_fn_bin(struct trace_iterator *iter, int flags,\n\t\t\t\t      struct trace_event *event)\n{\n\tstruct ftrace_entry *field;\n\tstruct trace_seq *s = &iter->seq;\n\n\ttrace_assign_type(field, iter->ent);\n\n\tSEQ_PUT_FIELD(s, field->ip);\n\tSEQ_PUT_FIELD(s, field->parent_ip);\n\n\treturn trace_handle_return(s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic bool each_symbol_in_section(const struct symsearch *arr,\n\t\t\t\t   unsigned int arrsize,\n\t\t\t\t   struct module *owner,\n\t\t\t\t   bool (*fn)(const struct symsearch *syms,\n\t\t\t\t\t      struct module *owner,\n\t\t\t\t\t      void *data),\n\t\t\t\t   void *data)\n{\n\tunsigned int j;\n\n\tfor (j = 0; j < arrsize; j++) {\n\t\tif (fn(&arr[j], owner, data))\n\t\t\treturn true;\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "section_objs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "367-377",
    "snippet": "static void *section_objs(const struct load_info *info,\n\t\t\t  const char *name,\n\t\t\t  size_t object_size,\n\t\t\t  unsigned int *num)\n{\n\tunsigned int sec = find_sec(info, name);\n\n\t/* Section 0 has sh_addr 0 and sh_size 0. */\n\t*num = info->sechdrs[sec].sh_size / object_size;\n\treturn (void *)info->sechdrs[sec].sh_addr;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "find_sec",
          "args": [
            "info",
            "name"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "find_sec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "345-357",
          "snippet": "static unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void *section_objs(const struct load_info *info,\n\t\t\t  const char *name,\n\t\t\t  size_t object_size,\n\t\t\t  unsigned int *num)\n{\n\tunsigned int sec = find_sec(info, name);\n\n\t/* Section 0 has sh_addr 0 and sh_size 0. */\n\t*num = info->sechdrs[sec].sh_size / object_size;\n\treturn (void *)info->sechdrs[sec].sh_addr;\n}"
  },
  {
    "function_name": "section_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "360-364",
    "snippet": "static void *section_addr(const struct load_info *info, const char *name)\n{\n\t/* Section 0 has sh_addr 0. */\n\treturn (void *)info->sechdrs[find_sec(info, name)].sh_addr;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "find_sec",
          "args": [
            "info",
            "name"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "find_sec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "345-357",
          "snippet": "static unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void *section_addr(const struct load_info *info, const char *name)\n{\n\t/* Section 0 has sh_addr 0. */\n\treturn (void *)info->sechdrs[find_sec(info, name)].sh_addr;\n}"
  },
  {
    "function_name": "find_sec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "345-357",
    "snippet": "static unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "info->secstrings + shdr->sh_name",
            "name"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic unsigned int find_sec(const struct load_info *info, const char *name)\n{\n\tunsigned int i;\n\n\tfor (i = 1; i < info->hdr->e_shnum; i++) {\n\t\tElf_Shdr *shdr = &info->sechdrs[i];\n\t\t/* Alloc bit cleared means \"ignore it.\" */\n\t\tif ((shdr->sh_flags & SHF_ALLOC)\n\t\t    && strcmp(info->secstrings + shdr->sh_name, name) == 0)\n\t\t\treturn i;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "__module_put_and_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "337-341",
    "snippet": "void __noreturn __module_put_and_exit(struct module *mod, long code)\n{\n\tmodule_put(mod);\n\tdo_exit(code);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_exit",
          "args": [
            "code"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "do_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/exit.c",
          "lines": "765-925",
          "snippet": "void __noreturn do_exit(long code)\n{\n\tstruct task_struct *tsk = current;\n\tint group_dead;\n\n\tprofile_task_exit(tsk);\n\tkcov_task_exit(tsk);\n\n\tWARN_ON(blk_needs_flush_plug(tsk));\n\n\tif (unlikely(in_interrupt()))\n\t\tpanic(\"Aiee, killing interrupt handler!\");\n\tif (unlikely(!tsk->pid))\n\t\tpanic(\"Attempted to kill the idle task!\");\n\n\t/*\n\t * If do_exit is called because this processes oopsed, it's possible\n\t * that get_fs() was left as KERNEL_DS, so reset it to USER_DS before\n\t * continuing. Amongst other possible reasons, this is to prevent\n\t * mm_release()->clear_child_tid() from writing to a user-controlled\n\t * kernel address.\n\t */\n\tset_fs(USER_DS);\n\n\tptrace_event(PTRACE_EVENT_EXIT, code);\n\n\tvalidate_creds_for_do_exit(tsk);\n\n\t/*\n\t * We're taking recursive faults here in do_exit. Safest is to just\n\t * leave this task alone and wait for reboot.\n\t */\n\tif (unlikely(tsk->flags & PF_EXITING)) {\n\t\tpr_alert(\"Fixing recursive fault but reboot is needed!\\n\");\n\t\t/*\n\t\t * We can do this unlocked here. The futex code uses\n\t\t * this flag just to verify whether the pi state\n\t\t * cleanup has been done or not. In the worst case it\n\t\t * loops once more. We pretend that the cleanup was\n\t\t * done as there is no way to return. Either the\n\t\t * OWNER_DIED bit is set by now or we push the blocked\n\t\t * task into the wait for ever nirwana as well.\n\t\t */\n\t\ttsk->flags |= PF_EXITPIDONE;\n\t\tset_current_state(TASK_UNINTERRUPTIBLE);\n\t\tschedule();\n\t}\n\n\texit_signals(tsk);  /* sets PF_EXITING */\n\t/*\n\t * Ensure that all new tsk->pi_lock acquisitions must observe\n\t * PF_EXITING. Serializes against futex.c:attach_to_pi_owner().\n\t */\n\tsmp_mb();\n\t/*\n\t * Ensure that we must observe the pi_state in exit_mm() ->\n\t * mm_release() -> exit_pi_state_list().\n\t */\n\traw_spin_lock_irq(&tsk->pi_lock);\n\traw_spin_unlock_irq(&tsk->pi_lock);\n\n\tif (unlikely(in_atomic())) {\n\t\tpr_info(\"note: %s[%d] exited with preempt_count %d\\n\",\n\t\t\tcurrent->comm, task_pid_nr(current),\n\t\t\tpreempt_count());\n\t\tpreempt_count_set(PREEMPT_ENABLED);\n\t}\n\n\t/* sync mm's RSS info before statistics gathering */\n\tif (tsk->mm)\n\t\tsync_mm_rss(tsk->mm);\n\tacct_update_integrals(tsk);\n\tgroup_dead = atomic_dec_and_test(&tsk->signal->live);\n\tif (group_dead) {\n#ifdef CONFIG_POSIX_TIMERS\n\t\thrtimer_cancel(&tsk->signal->real_timer);\n\t\texit_itimers(tsk->signal);\n#endif\n\t\tif (tsk->mm)\n\t\t\tsetmax_mm_hiwater_rss(&tsk->signal->maxrss, tsk->mm);\n\t}\n\tacct_collect(code, group_dead);\n\tif (group_dead)\n\t\ttty_audit_exit();\n\taudit_free(tsk);\n\n\ttsk->exit_code = code;\n\ttaskstats_exit(tsk, group_dead);\n\n\texit_mm();\n\n\tif (group_dead)\n\t\tacct_process();\n\ttrace_sched_process_exit(tsk);\n\n\texit_sem(tsk);\n\texit_shm(tsk);\n\texit_files(tsk);\n\texit_fs(tsk);\n\tif (group_dead)\n\t\tdisassociate_ctty(1);\n\texit_task_namespaces(tsk);\n\texit_task_work(tsk);\n\texit_thread(tsk);\n\n\t/*\n\t * Flush inherited counters to the parent - before the parent\n\t * gets woken up by child-exit notifications.\n\t *\n\t * because of cgroup mode, must be called before cgroup_exit()\n\t */\n\tperf_event_exit_task(tsk);\n\n\tsched_autogroup_exit_task(tsk);\n\tcgroup_exit(tsk);\n\n\t/*\n\t * FIXME: do that only when needed, using sched_exit tracepoint\n\t */\n\tflush_ptrace_hw_breakpoint(tsk);\n\n\texit_tasks_rcu_start();\n\texit_notify(tsk, group_dead);\n\tproc_exit_connector(tsk);\n\tmpol_put_task_policy(tsk);\n#ifdef CONFIG_FUTEX\n\tif (unlikely(current->pi_state_cache))\n\t\tkfree(current->pi_state_cache);\n#endif\n\t/*\n\t * Make sure we are holding no locks:\n\t */\n\tdebug_check_no_locks_held();\n\t/*\n\t * We can do this unlocked here. The futex code uses this flag\n\t * just to verify whether the pi state cleanup has been done\n\t * or not. In the worst case it loops once more.\n\t */\n\ttsk->flags |= PF_EXITPIDONE;\n\n\tif (tsk->io_context)\n\t\texit_io_context(tsk);\n\n\tif (tsk->splice_pipe)\n\t\tfree_pipe_info(tsk->splice_pipe);\n\n\tif (tsk->task_frag.page)\n\t\tput_page(tsk->task_frag.page);\n\n\tvalidate_creds_for_do_exit(tsk);\n\n\tcheck_stack_usage();\n\tpreempt_disable();\n\tif (tsk->nr_dirtied)\n\t\t__this_cpu_add(dirty_throttle_leaks, tsk->nr_dirtied);\n\texit_rcu();\n\texit_tasks_rcu_finish();\n\n\tlockdep_free_task(tsk);\n\tdo_task_dead();\n}",
          "includes": [
            "#include <asm/mmu_context.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/unistd.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/rcuwait.h>",
            "#include <linux/random.h>",
            "#include <linux/kcov.h>",
            "#include <linux/shm.h>",
            "#include <linux/writeback.h>",
            "#include <linux/oom.h>",
            "#include <linux/hw_breakpoint.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/init_task.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/resource.h>",
            "#include <linux/audit.h> /* for audit_free() */",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/futex.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/signal.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/taskstats_kern.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/kthread.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/mount.h>",
            "#include <linux/profile.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/freezer.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/acct.h>",
            "#include <linux/cpu.h>",
            "#include <linux/key.h>",
            "#include <linux/iocontext.h>",
            "#include <linux/tty.h>",
            "#include <linux/personality.h>",
            "#include <linux/completion.h>",
            "#include <linux/capability.h>",
            "#include <linux/module.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/mmu_context.h>\n#include <asm/pgtable.h>\n#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/rcuwait.h>\n#include <linux/random.h>\n#include <linux/kcov.h>\n#include <linux/shm.h>\n#include <linux/writeback.h>\n#include <linux/oom.h>\n#include <linux/hw_breakpoint.h>\n#include <trace/events/sched.h>\n#include <linux/perf_event.h>\n#include <linux/init_task.h>\n#include <linux/fs_struct.h>\n#include <linux/tracehook.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/blkdev.h>\n#include <linux/resource.h>\n#include <linux/audit.h> /* for audit_free() */\n#include <linux/pipe_fs_i.h>\n#include <linux/futex.h>\n#include <linux/mutex.h>\n#include <linux/cn_proc.h>\n#include <linux/posix-timers.h>\n#include <linux/signal.h>\n#include <linux/syscalls.h>\n#include <linux/cgroup.h>\n#include <linux/delayacct.h>\n#include <linux/taskstats_kern.h>\n#include <linux/mempolicy.h>\n#include <linux/kthread.h>\n#include <linux/proc_fs.h>\n#include <linux/mount.h>\n#include <linux/profile.h>\n#include <linux/ptrace.h>\n#include <linux/pid_namespace.h>\n#include <linux/nsproxy.h>\n#include <linux/binfmts.h>\n#include <linux/freezer.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/tsacct_kern.h>\n#include <linux/acct.h>\n#include <linux/cpu.h>\n#include <linux/key.h>\n#include <linux/iocontext.h>\n#include <linux/tty.h>\n#include <linux/personality.h>\n#include <linux/completion.h>\n#include <linux/capability.h>\n#include <linux/module.h>\n#include <linux/interrupt.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/autogroup.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n\nvoid __noreturn do_exit(long code)\n{\n\tstruct task_struct *tsk = current;\n\tint group_dead;\n\n\tprofile_task_exit(tsk);\n\tkcov_task_exit(tsk);\n\n\tWARN_ON(blk_needs_flush_plug(tsk));\n\n\tif (unlikely(in_interrupt()))\n\t\tpanic(\"Aiee, killing interrupt handler!\");\n\tif (unlikely(!tsk->pid))\n\t\tpanic(\"Attempted to kill the idle task!\");\n\n\t/*\n\t * If do_exit is called because this processes oopsed, it's possible\n\t * that get_fs() was left as KERNEL_DS, so reset it to USER_DS before\n\t * continuing. Amongst other possible reasons, this is to prevent\n\t * mm_release()->clear_child_tid() from writing to a user-controlled\n\t * kernel address.\n\t */\n\tset_fs(USER_DS);\n\n\tptrace_event(PTRACE_EVENT_EXIT, code);\n\n\tvalidate_creds_for_do_exit(tsk);\n\n\t/*\n\t * We're taking recursive faults here in do_exit. Safest is to just\n\t * leave this task alone and wait for reboot.\n\t */\n\tif (unlikely(tsk->flags & PF_EXITING)) {\n\t\tpr_alert(\"Fixing recursive fault but reboot is needed!\\n\");\n\t\t/*\n\t\t * We can do this unlocked here. The futex code uses\n\t\t * this flag just to verify whether the pi state\n\t\t * cleanup has been done or not. In the worst case it\n\t\t * loops once more. We pretend that the cleanup was\n\t\t * done as there is no way to return. Either the\n\t\t * OWNER_DIED bit is set by now or we push the blocked\n\t\t * task into the wait for ever nirwana as well.\n\t\t */\n\t\ttsk->flags |= PF_EXITPIDONE;\n\t\tset_current_state(TASK_UNINTERRUPTIBLE);\n\t\tschedule();\n\t}\n\n\texit_signals(tsk);  /* sets PF_EXITING */\n\t/*\n\t * Ensure that all new tsk->pi_lock acquisitions must observe\n\t * PF_EXITING. Serializes against futex.c:attach_to_pi_owner().\n\t */\n\tsmp_mb();\n\t/*\n\t * Ensure that we must observe the pi_state in exit_mm() ->\n\t * mm_release() -> exit_pi_state_list().\n\t */\n\traw_spin_lock_irq(&tsk->pi_lock);\n\traw_spin_unlock_irq(&tsk->pi_lock);\n\n\tif (unlikely(in_atomic())) {\n\t\tpr_info(\"note: %s[%d] exited with preempt_count %d\\n\",\n\t\t\tcurrent->comm, task_pid_nr(current),\n\t\t\tpreempt_count());\n\t\tpreempt_count_set(PREEMPT_ENABLED);\n\t}\n\n\t/* sync mm's RSS info before statistics gathering */\n\tif (tsk->mm)\n\t\tsync_mm_rss(tsk->mm);\n\tacct_update_integrals(tsk);\n\tgroup_dead = atomic_dec_and_test(&tsk->signal->live);\n\tif (group_dead) {\n#ifdef CONFIG_POSIX_TIMERS\n\t\thrtimer_cancel(&tsk->signal->real_timer);\n\t\texit_itimers(tsk->signal);\n#endif\n\t\tif (tsk->mm)\n\t\t\tsetmax_mm_hiwater_rss(&tsk->signal->maxrss, tsk->mm);\n\t}\n\tacct_collect(code, group_dead);\n\tif (group_dead)\n\t\ttty_audit_exit();\n\taudit_free(tsk);\n\n\ttsk->exit_code = code;\n\ttaskstats_exit(tsk, group_dead);\n\n\texit_mm();\n\n\tif (group_dead)\n\t\tacct_process();\n\ttrace_sched_process_exit(tsk);\n\n\texit_sem(tsk);\n\texit_shm(tsk);\n\texit_files(tsk);\n\texit_fs(tsk);\n\tif (group_dead)\n\t\tdisassociate_ctty(1);\n\texit_task_namespaces(tsk);\n\texit_task_work(tsk);\n\texit_thread(tsk);\n\n\t/*\n\t * Flush inherited counters to the parent - before the parent\n\t * gets woken up by child-exit notifications.\n\t *\n\t * because of cgroup mode, must be called before cgroup_exit()\n\t */\n\tperf_event_exit_task(tsk);\n\n\tsched_autogroup_exit_task(tsk);\n\tcgroup_exit(tsk);\n\n\t/*\n\t * FIXME: do that only when needed, using sched_exit tracepoint\n\t */\n\tflush_ptrace_hw_breakpoint(tsk);\n\n\texit_tasks_rcu_start();\n\texit_notify(tsk, group_dead);\n\tproc_exit_connector(tsk);\n\tmpol_put_task_policy(tsk);\n#ifdef CONFIG_FUTEX\n\tif (unlikely(current->pi_state_cache))\n\t\tkfree(current->pi_state_cache);\n#endif\n\t/*\n\t * Make sure we are holding no locks:\n\t */\n\tdebug_check_no_locks_held();\n\t/*\n\t * We can do this unlocked here. The futex code uses this flag\n\t * just to verify whether the pi state cleanup has been done\n\t * or not. In the worst case it loops once more.\n\t */\n\ttsk->flags |= PF_EXITPIDONE;\n\n\tif (tsk->io_context)\n\t\texit_io_context(tsk);\n\n\tif (tsk->splice_pipe)\n\t\tfree_pipe_info(tsk->splice_pipe);\n\n\tif (tsk->task_frag.page)\n\t\tput_page(tsk->task_frag.page);\n\n\tvalidate_creds_for_do_exit(tsk);\n\n\tcheck_stack_usage();\n\tpreempt_disable();\n\tif (tsk->nr_dirtied)\n\t\t__this_cpu_add(dirty_throttle_leaks, tsk->nr_dirtied);\n\texit_rcu();\n\texit_tasks_rcu_finish();\n\n\tlockdep_free_task(tsk);\n\tdo_task_dead();\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "mod"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "module_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1132-1143",
          "snippet": "void module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid module_put(struct module *module)\n{\n\tint ret;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\tret = atomic_dec_if_positive(&module->refcnt);\n\t\tWARN_ON(ret < 0);\t/* Failed to put refcount */\n\t\ttrace_module_put(module, _RET_IP_);\n\t\tpreempt_enable();\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nvoid __noreturn __module_put_and_exit(struct module *mod, long code)\n{\n\tmodule_put(mod);\n\tdo_exit(code);\n}"
  },
  {
    "function_name": "add_taint_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "326-331",
    "snippet": "static inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "flag",
            "&mod->taints"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "mem_bm_set_bit_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/snapshot.c",
          "lines": "779-790",
          "snippet": "static int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_taint",
          "args": [
            "flag",
            "lockdep_ok"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "add_taint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/panic.c",
          "lines": "386-392",
          "snippet": "void add_taint(unsigned flag, enum lockdep_ok lockdep_ok)\n{\n\tif (lockdep_ok == LOCKDEP_NOW_UNRELIABLE && __debug_locks_off())\n\t\tpr_warn(\"Disabling lock debugging due to kernel taint\\n\");\n\n\tset_bit(flag, &tainted_mask);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nstatic unsigned long tainted_mask =\n\tIS_ENABLED(CONFIG_GCC_PLUGIN_RANDSTRUCT) ? (1 << TAINT_RANDSTRUCT) : 0;\n\nvoid add_taint(unsigned flag, enum lockdep_ok lockdep_ok)\n{\n\tif (lockdep_ok == LOCKDEP_NOW_UNRELIABLE && __debug_locks_off())\n\t\tpr_warn(\"Disabling lock debugging due to kernel taint\\n\");\n\n\tset_bit(flag, &tainted_mask);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline void add_taint_module(struct module *mod, unsigned flag,\n\t\t\t\t    enum lockdep_ok lockdep_ok)\n{\n\tadd_taint(flag, lockdep_ok);\n\tset_bit(flag, &mod->taints);\n}"
  },
  {
    "function_name": "strong_try_module_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "315-324",
    "snippet": "static inline int strong_try_module_get(struct module *mod)\n{\n\tBUG_ON(mod && mod->state == MODULE_STATE_UNFORMED);\n\tif (mod && mod->state == MODULE_STATE_COMING)\n\t\treturn -EBUSY;\n\tif (try_module_get(mod))\n\t\treturn 0;\n\telse\n\t\treturn -ENOENT;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "try_module_get",
          "args": [
            "mod"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "try_module_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1113-1129",
          "snippet": "bool try_module_get(struct module *module)\n{\n\tbool ret = true;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\t/* Note: here, we can fail to get a reference */\n\t\tif (likely(module_is_live(module) &&\n\t\t\t   atomic_inc_not_zero(&module->refcnt) != 0))\n\t\t\ttrace_module_get(module, _RET_IP_);\n\t\telse\n\t\t\tret = false;\n\n\t\tpreempt_enable();\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nbool try_module_get(struct module *module)\n{\n\tbool ret = true;\n\n\tif (module) {\n\t\tpreempt_disable();\n\t\t/* Note: here, we can fail to get a reference */\n\t\tif (likely(module_is_live(module) &&\n\t\t\t   atomic_inc_not_zero(&module->refcnt) != 0))\n\t\t\ttrace_module_get(module, _RET_IP_);\n\t\telse\n\t\t\tret = false;\n\n\t\tpreempt_enable();\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "mod && mod->state == MODULE_STATE_UNFORMED"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic inline int strong_try_module_get(struct module *mod)\n{\n\tBUG_ON(mod && mod->state == MODULE_STATE_UNFORMED);\n\tif (mod && mod->state == MODULE_STATE_COMING)\n\t\treturn -EBUSY;\n\tif (try_module_get(mod))\n\t\treturn 0;\n\telse\n\t\treturn -ENOENT;\n}"
  },
  {
    "function_name": "unregister_module_notifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "304-307",
    "snippet": "int unregister_module_notifier(struct notifier_block *nb)\n{\n\treturn blocking_notifier_chain_unregister(&module_notify_list, nb);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static BLOCKING_NOTIFIER_HEAD(module_notify_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "blocking_notifier_chain_unregister",
          "args": [
            "&module_notify_list",
            "nb"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "blocking_notifier_chain_unregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/notifier.c",
          "lines": "266-283",
          "snippet": "int blocking_notifier_chain_unregister(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_unregister(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_unregister(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint blocking_notifier_chain_unregister(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_unregister(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_unregister(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic BLOCKING_NOTIFIER_HEAD(module_notify_list);\n\nint unregister_module_notifier(struct notifier_block *nb)\n{\n\treturn blocking_notifier_chain_unregister(&module_notify_list, nb);\n}"
  },
  {
    "function_name": "register_module_notifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "298-301",
    "snippet": "int register_module_notifier(struct notifier_block *nb)\n{\n\treturn blocking_notifier_chain_register(&module_notify_list, nb);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static BLOCKING_NOTIFIER_HEAD(module_notify_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "blocking_notifier_chain_register",
          "args": [
            "&module_notify_list",
            "nb"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "blocking_notifier_chain_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/notifier.c",
          "lines": "213-230",
          "snippet": "int blocking_notifier_chain_register(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_register(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_register(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint blocking_notifier_chain_register(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_register(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_register(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic BLOCKING_NOTIFIER_HEAD(module_notify_list);\n\nint register_module_notifier(struct notifier_block *nb)\n{\n\treturn blocking_notifier_chain_register(&module_notify_list, nb);\n}"
  },
  {
    "function_name": "is_module_sig_enforced",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "283-286",
    "snippet": "bool is_module_sig_enforced(void)\n{\n\treturn sig_enforce;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool sig_enforce = IS_ENABLED(CONFIG_MODULE_SIG_FORCE);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic bool sig_enforce = IS_ENABLED(CONFIG_MODULE_SIG_FORCE);\n\nbool is_module_sig_enforced(void)\n{\n\treturn sig_enforce;\n}"
  },
  {
    "function_name": "module_assert_mutex_or_preempt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "265-274",
    "snippet": "static void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex)"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockdep_is_held",
          "args": [
            "&module_mutex"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock_sched_held",
          "args": [],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_read_lock_sched_held",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/update.c",
          "lines": "106-119",
          "snippet": "int rcu_read_lock_sched_held(void)\n{\n\tint lockdep_opinion = 0;\n\n\tif (!debug_lockdep_rcu_enabled())\n\t\treturn 1;\n\tif (!rcu_is_watching())\n\t\treturn 0;\n\tif (!rcu_lockdep_current_cpu_online())\n\t\treturn 0;\n\tif (debug_locks)\n\t\tlockdep_opinion = lock_is_held(&rcu_sched_lock_map);\n\treturn lockdep_opinion || !preemptible();\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include <linux/sched/isolation.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/tick.h>",
            "#include <linux/kthread.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/export.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include <linux/sched/isolation.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/tick.h>\n#include <linux/kthread.h>\n#include <linux/moduleparam.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/export.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nint rcu_read_lock_sched_held(void)\n{\n\tint lockdep_opinion = 0;\n\n\tif (!debug_lockdep_rcu_enabled())\n\t\treturn 1;\n\tif (!rcu_is_watching())\n\t\treturn 0;\n\tif (!rcu_lockdep_current_cpu_online())\n\t\treturn 0;\n\tif (debug_locks)\n\t\tlockdep_opinion = lock_is_held(&rcu_sched_lock_map);\n\treturn lockdep_opinion || !preemptible();\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!debug_locks"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_assert_mutex_or_preempt(void)\n{\n#ifdef CONFIG_LOCKDEP\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\tWARN_ON_ONCE(!rcu_read_lock_sched_held() &&\n\t\t!lockdep_is_held(&module_mutex));\n#endif\n}"
  },
  {
    "function_name": "module_assert_mutex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "260-263",
    "snippet": "static void module_assert_mutex(void)\n{\n\tlockdep_assert_held(&module_mutex);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lockdep_assert_held",
          "args": [
            "&module_mutex"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void module_assert_mutex(void)\n{\n\tlockdep_assert_held(&module_mutex);\n}"
  },
  {
    "function_name": "mod_update_bounds",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "249-254",
    "snippet": "static void mod_update_bounds(struct module *mod)\n{\n\t__mod_update_bounds(mod->core_layout.base, mod->core_layout.size);\n\tif (mod->init_layout.size)\n\t\t__mod_update_bounds(mod->init_layout.base, mod->init_layout.size);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mod_update_bounds",
          "args": [
            "mod->init_layout.base",
            "mod->init_layout.size"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "__mod_update_bounds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "238-247",
          "snippet": "static void __mod_update_bounds(void *base, unsigned int size)\n{\n\tunsigned long min = (unsigned long)base;\n\tunsigned long max = min + size;\n\n\tif (min < module_addr_min)\n\t\tmodule_addr_min = min;\n\tif (max > module_addr_max)\n\t\tmodule_addr_max = max;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [
            "#define module_addr_max mod_tree.addr_max",
            "#define module_addr_min mod_tree.addr_min"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define module_addr_max mod_tree.addr_max\n#define module_addr_min mod_tree.addr_min\n\nstatic void __mod_update_bounds(void *base, unsigned int size)\n{\n\tunsigned long min = (unsigned long)base;\n\tunsigned long max = min + size;\n\n\tif (min < module_addr_min)\n\t\tmodule_addr_min = min;\n\tif (max > module_addr_max)\n\t\tmodule_addr_max = max;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_update_bounds(struct module *mod)\n{\n\t__mod_update_bounds(mod->core_layout.base, mod->core_layout.size);\n\tif (mod->init_layout.size)\n\t\t__mod_update_bounds(mod->init_layout.base, mod->init_layout.size);\n}"
  },
  {
    "function_name": "__mod_update_bounds",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "238-247",
    "snippet": "static void __mod_update_bounds(void *base, unsigned int size)\n{\n\tunsigned long min = (unsigned long)base;\n\tunsigned long max = min + size;\n\n\tif (min < module_addr_min)\n\t\tmodule_addr_min = min;\n\tif (max > module_addr_max)\n\t\tmodule_addr_max = max;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [
      "#define module_addr_max mod_tree.addr_max",
      "#define module_addr_min mod_tree.addr_min"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\n#define module_addr_max mod_tree.addr_max\n#define module_addr_min mod_tree.addr_min\n\nstatic void __mod_update_bounds(void *base, unsigned int size)\n{\n\tunsigned long min = (unsigned long)base;\n\tunsigned long max = min + size;\n\n\tif (min < module_addr_min)\n\t\tmodule_addr_min = min;\n\tif (max > module_addr_max)\n\t\tmodule_addr_max = max;\n}"
  },
  {
    "function_name": "mod_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "220-230",
    "snippet": "static struct module *mod_find(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (within_module(addr, mod))\n\t\t\treturn mod;\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "within_module",
          "args": [
            "addr",
            "mod"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "trace_kprobe_within_module",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_kprobe.c",
          "lines": "57-63",
          "snippet": "static nokprobe_inline bool trace_kprobe_within_module(struct trace_kprobe *tk,\n\t\t\t\t\t\t struct module *mod)\n{\n\tint len = strlen(mod->name);\n\tconst char *name = trace_kprobe_symbol(tk);\n\treturn strncmp(mod->name, name, len) == 0 && name[len] == ':';\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include \"trace_kprobe_selftest.h\"",
            "#include <linux/error-injection.h>",
            "#include <linux/rculist.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int register_kprobe_event(struct trace_kprobe *tk);",
            "static int unregister_kprobe_event(struct trace_kprobe *tk);",
            "NOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Kprobe handler */\nstatic nokprobe_inline"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include \"trace_kprobe_selftest.h\"\n#include <linux/error-injection.h>\n#include <linux/rculist.h>\n#include <linux/uaccess.h>\n#include <linux/module.h>\n\nstatic int register_kprobe_event(struct trace_kprobe *tk);\nstatic int unregister_kprobe_event(struct trace_kprobe *tk);\nNOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Kprobe handler */\nstatic nokprobe_inline;\n\nstatic nokprobe_inline bool trace_kprobe_within_module(struct trace_kprobe *tk,\n\t\t\t\t\t\t struct module *mod)\n{\n\tint len = strlen(mod->name);\n\tconst char *name = trace_kprobe_symbol(tk);\n\treturn strncmp(mod->name, name, len) == 0 && name[len] == ':';\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "mod",
            "&modules",
            "list"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\n\nstatic struct module *mod_find(unsigned long addr)\n{\n\tstruct module *mod;\n\n\tlist_for_each_entry_rcu(mod, &modules, list) {\n\t\tif (within_module(addr, mod))\n\t\t\treturn mod;\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "mod_tree_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "218-218",
    "snippet": "static void mod_tree_remove(struct module *mod) { }",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_tree_remove(struct module *mod) { }"
  },
  {
    "function_name": "mod_tree_remove_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "217-217",
    "snippet": "static void mod_tree_remove_init(struct module *mod) { }",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_tree_remove_init(struct module *mod) { }"
  },
  {
    "function_name": "mod_tree_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "216-216",
    "snippet": "static void mod_tree_insert(struct module *mod) { }",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_tree_insert(struct module *mod) { }"
  },
  {
    "function_name": "mod_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "201-210",
    "snippet": "static struct module *mod_find(unsigned long addr)\n{\n\tstruct latch_tree_node *ltn;\n\n\tltn = latch_tree_find((void *)addr, &mod_tree.root, &mod_tree_ops);\n\tif (!ltn)\n\t\treturn NULL;\n\n\treturn container_of(ltn, struct mod_tree_node, node)->mod;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ltn",
            "structmod_tree_node",
            "node"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "latch_tree_find",
          "args": [
            "(void *)addr",
            "&mod_tree.root",
            "&mod_tree_ops"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic struct module *mod_find(unsigned long addr)\n{\n\tstruct latch_tree_node *ltn;\n\n\tltn = latch_tree_find((void *)addr, &mod_tree.root, &mod_tree_ops);\n\tif (!ltn)\n\t\treturn NULL;\n\n\treturn container_of(ltn, struct mod_tree_node, node)->mod;\n}"
  },
  {
    "function_name": "mod_tree_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "195-199",
    "snippet": "static void mod_tree_remove(struct module *mod)\n{\n\t__mod_tree_remove(&mod->core_layout.mtn);\n\tmod_tree_remove_init(mod);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mod_tree_remove_init",
          "args": [
            "mod"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "mod_tree_remove_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "217-217",
          "snippet": "static void mod_tree_remove_init(struct module *mod) { }",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_tree_remove_init(struct module *mod) { }"
        }
      },
      {
        "call_info": {
          "callee": "__mod_tree_remove",
          "args": [
            "&mod->core_layout.mtn"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "__mod_tree_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "170-173",
          "snippet": "static void __mod_tree_remove(struct mod_tree_node *node)\n{\n\tlatch_tree_erase(&node->node, &mod_tree.root, &mod_tree_ops);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void __mod_tree_remove(struct mod_tree_node *node)\n{\n\tlatch_tree_erase(&node->node, &mod_tree.root, &mod_tree_ops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_tree_remove(struct module *mod)\n{\n\t__mod_tree_remove(&mod->core_layout.mtn);\n\tmod_tree_remove_init(mod);\n}"
  },
  {
    "function_name": "mod_tree_remove_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "189-193",
    "snippet": "static void mod_tree_remove_init(struct module *mod)\n{\n\tif (mod->init_layout.size)\n\t\t__mod_tree_remove(&mod->init_layout.mtn);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mod_tree_remove",
          "args": [
            "&mod->init_layout.mtn"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "__mod_tree_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "170-173",
          "snippet": "static void __mod_tree_remove(struct mod_tree_node *node)\n{\n\tlatch_tree_erase(&node->node, &mod_tree.root, &mod_tree_ops);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void __mod_tree_remove(struct mod_tree_node *node)\n{\n\tlatch_tree_erase(&node->node, &mod_tree.root, &mod_tree_ops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_tree_remove_init(struct module *mod)\n{\n\tif (mod->init_layout.size)\n\t\t__mod_tree_remove(&mod->init_layout.mtn);\n}"
  },
  {
    "function_name": "mod_tree_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "179-187",
    "snippet": "static void mod_tree_insert(struct module *mod)\n{\n\tmod->core_layout.mtn.mod = mod;\n\tmod->init_layout.mtn.mod = mod;\n\n\t__mod_tree_insert(&mod->core_layout.mtn);\n\tif (mod->init_layout.size)\n\t\t__mod_tree_insert(&mod->init_layout.mtn);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mod_tree_insert",
          "args": [
            "&mod->init_layout.mtn"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "__mod_tree_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "165-168",
          "snippet": "static noinline void __mod_tree_insert(struct mod_tree_node *node)\n{\n\tlatch_tree_insert(&node->node, &mod_tree.root, &mod_tree_ops);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic noinline void __mod_tree_insert(struct mod_tree_node *node)\n{\n\tlatch_tree_insert(&node->node, &mod_tree.root, &mod_tree_ops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_tree_insert(struct module *mod)\n{\n\tmod->core_layout.mtn.mod = mod;\n\tmod->init_layout.mtn.mod = mod;\n\n\t__mod_tree_insert(&mod->core_layout.mtn);\n\tif (mod->init_layout.size)\n\t\t__mod_tree_insert(&mod->init_layout.mtn);\n}"
  },
  {
    "function_name": "__mod_tree_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "170-173",
    "snippet": "static void __mod_tree_remove(struct mod_tree_node *node)\n{\n\tlatch_tree_erase(&node->node, &mod_tree.root, &mod_tree_ops);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "latch_tree_erase",
          "args": [
            "&node->node",
            "&mod_tree.root",
            "&mod_tree_ops"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void __mod_tree_remove(struct mod_tree_node *node)\n{\n\tlatch_tree_erase(&node->node, &mod_tree.root, &mod_tree_ops);\n}"
  },
  {
    "function_name": "__mod_tree_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "165-168",
    "snippet": "static noinline void __mod_tree_insert(struct mod_tree_node *node)\n{\n\tlatch_tree_insert(&node->node, &mod_tree.root, &mod_tree_ops);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "latch_tree_insert",
          "args": [
            "&node->node",
            "&mod_tree.root",
            "&mod_tree_ops"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic noinline void __mod_tree_insert(struct mod_tree_node *node)\n{\n\tlatch_tree_insert(&node->node, &mod_tree.root, &mod_tree_ops);\n}"
  },
  {
    "function_name": "mod_tree_comp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "132-147",
    "snippet": "static __always_inline int\nmod_tree_comp(void *key, struct latch_tree_node *n)\n{\n\tunsigned long val = (unsigned long)key;\n\tunsigned long start, end;\n\n\tstart = __mod_tree_val(n);\n\tif (val < start)\n\t\treturn -1;\n\n\tend = start + __mod_tree_size(n);\n\tif (val >= end)\n\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mod_tree_size",
          "args": [
            "n"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "__mod_tree_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "119-124",
          "snippet": "static __always_inline unsigned long __mod_tree_size(struct latch_tree_node *n)\n{\n\tstruct module_layout *layout = container_of(n, struct module_layout, mtn.node);\n\n\treturn (unsigned long)layout->size;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic __always_inline unsigned long __mod_tree_size(struct latch_tree_node *n)\n{\n\tstruct module_layout *layout = container_of(n, struct module_layout, mtn.node);\n\n\treturn (unsigned long)layout->size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__mod_tree_val",
          "args": [
            "n"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "__mod_tree_val",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "112-117",
          "snippet": "static __always_inline unsigned long __mod_tree_val(struct latch_tree_node *n)\n{\n\tstruct module_layout *layout = container_of(n, struct module_layout, mtn.node);\n\n\treturn (unsigned long)layout->base;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic __always_inline unsigned long __mod_tree_val(struct latch_tree_node *n)\n{\n\tstruct module_layout *layout = container_of(n, struct module_layout, mtn.node);\n\n\treturn (unsigned long)layout->base;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic __always_inline int\nmod_tree_comp(void *key, struct latch_tree_node *n)\n{\n\tunsigned long val = (unsigned long)key;\n\tunsigned long start, end;\n\n\tstart = __mod_tree_val(n);\n\tif (val < start)\n\t\treturn -1;\n\n\tend = start + __mod_tree_size(n);\n\tif (val >= end)\n\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "mod_tree_less",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "126-130",
    "snippet": "static __always_inline bool\nmod_tree_less(struct latch_tree_node *a, struct latch_tree_node *b)\n{\n\treturn __mod_tree_val(a) < __mod_tree_val(b);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__mod_tree_val",
          "args": [
            "b"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "__mod_tree_val",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "112-117",
          "snippet": "static __always_inline unsigned long __mod_tree_val(struct latch_tree_node *n)\n{\n\tstruct module_layout *layout = container_of(n, struct module_layout, mtn.node);\n\n\treturn (unsigned long)layout->base;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic __always_inline unsigned long __mod_tree_val(struct latch_tree_node *n)\n{\n\tstruct module_layout *layout = container_of(n, struct module_layout, mtn.node);\n\n\treturn (unsigned long)layout->base;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic __always_inline bool\nmod_tree_less(struct latch_tree_node *a, struct latch_tree_node *b)\n{\n\treturn __mod_tree_val(a) < __mod_tree_val(b);\n}"
  },
  {
    "function_name": "__mod_tree_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "119-124",
    "snippet": "static __always_inline unsigned long __mod_tree_size(struct latch_tree_node *n)\n{\n\tstruct module_layout *layout = container_of(n, struct module_layout, mtn.node);\n\n\treturn (unsigned long)layout->size;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "n",
            "structmodule_layout",
            "mtn.node"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic __always_inline unsigned long __mod_tree_size(struct latch_tree_node *n)\n{\n\tstruct module_layout *layout = container_of(n, struct module_layout, mtn.node);\n\n\treturn (unsigned long)layout->size;\n}"
  },
  {
    "function_name": "__mod_tree_val",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "112-117",
    "snippet": "static __always_inline unsigned long __mod_tree_val(struct latch_tree_node *n)\n{\n\tstruct module_layout *layout = container_of(n, struct module_layout, mtn.node);\n\n\treturn (unsigned long)layout->base;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "n",
            "structmodule_layout",
            "mtn.node"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic __always_inline unsigned long __mod_tree_val(struct latch_tree_node *n)\n{\n\tstruct module_layout *layout = container_of(n, struct module_layout, mtn.node);\n\n\treturn (unsigned long)layout->base;\n}"
  },
  {
    "function_name": "delete_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "960-1033",
    "snippet": "SYSCALL_DEFINE2(delete_module, const char __user *, name_user,\n\t\tunsigned int, flags)\n{\n\tstruct module *mod;\n\tchar name[MODULE_NAME_LEN];\n\tint ret, forced = 0;\n\n\tif (!capable(CAP_SYS_MODULE) || modules_disabled)\n\t\treturn -EPERM;\n\n\tif (strncpy_from_user(name, name_user, MODULE_NAME_LEN-1) < 0)\n\t\treturn -EFAULT;\n\tname[MODULE_NAME_LEN-1] = '\\0';\n\n\taudit_log_kern_module(name);\n\n\tif (mutex_lock_interruptible(&module_mutex) != 0)\n\t\treturn -EINTR;\n\n\tmod = find_module(name);\n\tif (!mod) {\n\t\tret = -ENOENT;\n\t\tgoto out;\n\t}\n\n\tif (!list_empty(&mod->source_list)) {\n\t\t/* Other modules depend on us: get rid of them first. */\n\t\tret = -EWOULDBLOCK;\n\t\tgoto out;\n\t}\n\n\t/* Doing init or already dying? */\n\tif (mod->state != MODULE_STATE_LIVE) {\n\t\t/* FIXME: if (force), slam module count damn the torpedoes */\n\t\tpr_debug(\"%s already dying\\n\", mod->name);\n\t\tret = -EBUSY;\n\t\tgoto out;\n\t}\n\n\t/* If it has an init func, it must have an exit func to unload */\n\tif (mod->init && !mod->exit) {\n\t\tforced = try_force_unload(flags);\n\t\tif (!forced) {\n\t\t\t/* This module can't be removed */\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\t/* Stop the machine so refcounts can't move and disable module. */\n\tret = try_stop_module(mod, flags, &forced);\n\tif (ret != 0)\n\t\tgoto out;\n\n\tmutex_unlock(&module_mutex);\n\t/* Final destruction now no one is using it. */\n\tif (mod->exit != NULL)\n\t\tmod->exit();\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_GOING, mod);\n\tklp_module_going(mod);\n\tftrace_release_mod(mod);\n\n\tasync_synchronize_full();\n\n\t/* Store the name of the last unloaded module for diagnostic purposes */\n\tstrlcpy(last_unloaded_module, mod->name, sizeof(last_unloaded_module));\n\n\tfree_module(mod);\n\treturn 0;\nout:\n\tmutex_unlock(&module_mutex);\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(modules);",
      "int modules_disabled = 0;",
      "static BLOCKING_NOTIFIER_HEAD(module_notify_list);",
      "static char last_unloaded_module[MODULE_NAME_LEN+1];"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(modules);\nint modules_disabled = 0;\nstatic BLOCKING_NOTIFIER_HEAD(module_notify_list);\nstatic char last_unloaded_module[MODULE_NAME_LEN+1];\n\nSYSCALL_DEFINE2(delete_module, const char __user *, name_user,\n\t\tunsigned int, flags)\n{\n\tstruct module *mod;\n\tchar name[MODULE_NAME_LEN];\n\tint ret, forced = 0;\n\n\tif (!capable(CAP_SYS_MODULE) || modules_disabled)\n\t\treturn -EPERM;\n\n\tif (strncpy_from_user(name, name_user, MODULE_NAME_LEN-1) < 0)\n\t\treturn -EFAULT;\n\tname[MODULE_NAME_LEN-1] = '\\0';\n\n\taudit_log_kern_module(name);\n\n\tif (mutex_lock_interruptible(&module_mutex) != 0)\n\t\treturn -EINTR;\n\n\tmod = find_module(name);\n\tif (!mod) {\n\t\tret = -ENOENT;\n\t\tgoto out;\n\t}\n\n\tif (!list_empty(&mod->source_list)) {\n\t\t/* Other modules depend on us: get rid of them first. */\n\t\tret = -EWOULDBLOCK;\n\t\tgoto out;\n\t}\n\n\t/* Doing init or already dying? */\n\tif (mod->state != MODULE_STATE_LIVE) {\n\t\t/* FIXME: if (force), slam module count damn the torpedoes */\n\t\tpr_debug(\"%s already dying\\n\", mod->name);\n\t\tret = -EBUSY;\n\t\tgoto out;\n\t}\n\n\t/* If it has an init func, it must have an exit func to unload */\n\tif (mod->init && !mod->exit) {\n\t\tforced = try_force_unload(flags);\n\t\tif (!forced) {\n\t\t\t/* This module can't be removed */\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\t/* Stop the machine so refcounts can't move and disable module. */\n\tret = try_stop_module(mod, flags, &forced);\n\tif (ret != 0)\n\t\tgoto out;\n\n\tmutex_unlock(&module_mutex);\n\t/* Final destruction now no one is using it. */\n\tif (mod->exit != NULL)\n\t\tmod->exit();\n\tblocking_notifier_call_chain(&module_notify_list,\n\t\t\t\t     MODULE_STATE_GOING, mod);\n\tklp_module_going(mod);\n\tftrace_release_mod(mod);\n\n\tasync_synchronize_full();\n\n\t/* Store the name of the last unloaded module for diagnostic purposes */\n\tstrlcpy(last_unloaded_module, mod->name, sizeof(last_unloaded_module));\n\n\tfree_module(mod);\n\treturn 0;\nout:\n\tmutex_unlock(&module_mutex);\n\treturn ret;\n}"
  },
  {
    "function_name": "init_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3849-3867",
    "snippet": "SYSCALL_DEFINE3(init_module, void __user *, umod,\n\t\tunsigned long, len, const char __user *, uargs)\n{\n\tint err;\n\tstruct load_info info = { };\n\n\terr = may_init_module();\n\tif (err)\n\t\treturn err;\n\n\tpr_debug(\"init_module: umod=%p, len=%lu, uargs=%p\\n\",\n\t       umod, len, uargs);\n\n\terr = copy_module_from_user(umod, len, &info);\n\tif (err)\n\t\treturn err;\n\n\treturn load_module(&info, uargs, 0);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE3(init_module, void __user *, umod,\n\t\tunsigned long, len, const char __user *, uargs)\n{\n\tint err;\n\tstruct load_info info = { };\n\n\terr = may_init_module();\n\tif (err)\n\t\treturn err;\n\n\tpr_debug(\"init_module: umod=%p, len=%lu, uargs=%p\\n\",\n\t       umod, len, uargs);\n\n\terr = copy_module_from_user(umod, len, &info);\n\tif (err)\n\t\treturn err;\n\n\treturn load_module(&info, uargs, 0);\n}"
  },
  {
    "function_name": "finit_module",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
    "lines": "3869-3894",
    "snippet": "SYSCALL_DEFINE3(finit_module, int, fd, const char __user *, uargs, int, flags)\n{\n\tstruct load_info info = { };\n\tloff_t size;\n\tvoid *hdr;\n\tint err;\n\n\terr = may_init_module();\n\tif (err)\n\t\treturn err;\n\n\tpr_debug(\"finit_module: fd=%d, uargs=%p, flags=%i\\n\", fd, uargs, flags);\n\n\tif (flags & ~(MODULE_INIT_IGNORE_MODVERSIONS\n\t\t      |MODULE_INIT_IGNORE_VERMAGIC))\n\t\treturn -EINVAL;\n\n\terr = kernel_read_file_from_fd(fd, &hdr, &size, INT_MAX,\n\t\t\t\t       READING_MODULE);\n\tif (err)\n\t\treturn err;\n\tinfo.hdr = hdr;\n\tinfo.len = size;\n\n\treturn load_module(&info, uargs, flags);\n}",
    "includes": [
      "#include <trace/events/module.h>",
      "#include \"module-internal.h\"",
      "#include <uapi/linux/module.h>",
      "#include <linux/audit.h>",
      "#include <linux/dynamic_debug.h>",
      "#include <linux/bsearch.h>",
      "#include <linux/pfn.h>",
      "#include <linux/jump_label.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/percpu.h>",
      "#include <linux/async.h>",
      "#include <linux/livepatch.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/tracepoint.h>",
      "#include <asm/sections.h>",
      "#include <linux/license.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/set_memory.h>",
      "#include <asm/cacheflush.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/rculist.h>",
      "#include <linux/mutex.h>",
      "#include <linux/string.h>",
      "#include <linux/device.h>",
      "#include <linux/sched.h>",
      "#include <linux/notifier.h>",
      "#include <linux/vermagic.h>",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/cpu.h>",
      "#include <linux/capability.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/security.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/elf.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/fs.h>",
      "#include <linux/file.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/init.h>",
      "#include <linux/trace_events.h>",
      "#include <linux/moduleloader.h>",
      "#include <linux/extable.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE3(finit_module, int, fd, const char __user *, uargs, int, flags)\n{\n\tstruct load_info info = { };\n\tloff_t size;\n\tvoid *hdr;\n\tint err;\n\n\terr = may_init_module();\n\tif (err)\n\t\treturn err;\n\n\tpr_debug(\"finit_module: fd=%d, uargs=%p, flags=%i\\n\", fd, uargs, flags);\n\n\tif (flags & ~(MODULE_INIT_IGNORE_MODVERSIONS\n\t\t      |MODULE_INIT_IGNORE_VERMAGIC))\n\t\treturn -EINVAL;\n\n\terr = kernel_read_file_from_fd(fd, &hdr, &size, INT_MAX,\n\t\t\t\t       READING_MODULE);\n\tif (err)\n\t\treturn err;\n\tinfo.hdr = hdr;\n\tinfo.len = size;\n\n\treturn load_module(&info, uargs, flags);\n}"
  }
]