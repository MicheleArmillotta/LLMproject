[
  {
    "function_name": "housekeeping_isolcpus_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/isolation.c",
    "lines": "126-152",
    "snippet": "static int __init housekeeping_isolcpus_setup(char *str)\n{\n\tunsigned int flags = 0;\n\n\twhile (isalpha(*str)) {\n\t\tif (!strncmp(str, \"nohz,\", 5)) {\n\t\t\tstr += 5;\n\t\t\tflags |= HK_FLAG_TICK;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!strncmp(str, \"domain,\", 7)) {\n\t\t\tstr += 7;\n\t\t\tflags |= HK_FLAG_DOMAIN;\n\t\t\tcontinue;\n\t\t}\n\n\t\tpr_warn(\"isolcpus: Error, unknown flag\\n\");\n\t\treturn 0;\n\t}\n\n\t/* Default behaviour for isolcpus without flags */\n\tif (!flags)\n\t\tflags |= HK_FLAG_DOMAIN;\n\n\treturn housekeeping_setup(str, flags);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "housekeeping_setup",
          "args": [
            "str",
            "flags"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "housekeeping_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/isolation.c",
          "lines": "65-114",
          "snippet": "static int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tint err;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\terr = cpulist_parse(str, non_housekeeping_mask);\n\tif (err < 0 || cpumask_last(non_housekeeping_mask) >= nr_cpu_ids) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(housekeeping_mask))\n\t\t\tcpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t} else {\n\t\tcpumask_var_t tmp;\n\n\t\talloc_bootmem_cpumask_var(&tmp);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t\tfree_bootmem_cpumask_var(tmp);\n\t}\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static cpumask_var_t housekeeping_mask;",
            "static unsigned int housekeeping_flags;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nstatic int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tint err;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\terr = cpulist_parse(str, non_housekeeping_mask);\n\tif (err < 0 || cpumask_last(non_housekeeping_mask) >= nr_cpu_ids) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(housekeeping_mask))\n\t\t\tcpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t} else {\n\t\tcpumask_var_t tmp;\n\n\t\talloc_bootmem_cpumask_var(&tmp);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t\tfree_bootmem_cpumask_var(tmp);\n\t}\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"isolcpus: Error, unknown flag\\n\""
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "str",
            "\"domain,\"",
            "7"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "str",
            "\"nohz,\"",
            "5"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "*str"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic int __init housekeeping_isolcpus_setup(char *str)\n{\n\tunsigned int flags = 0;\n\n\twhile (isalpha(*str)) {\n\t\tif (!strncmp(str, \"nohz,\", 5)) {\n\t\t\tstr += 5;\n\t\t\tflags |= HK_FLAG_TICK;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!strncmp(str, \"domain,\", 7)) {\n\t\t\tstr += 7;\n\t\t\tflags |= HK_FLAG_DOMAIN;\n\t\t\tcontinue;\n\t\t}\n\n\t\tpr_warn(\"isolcpus: Error, unknown flag\\n\");\n\t\treturn 0;\n\t}\n\n\t/* Default behaviour for isolcpus without flags */\n\tif (!flags)\n\t\tflags |= HK_FLAG_DOMAIN;\n\n\treturn housekeeping_setup(str, flags);\n}"
  },
  {
    "function_name": "housekeeping_nohz_full_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/isolation.c",
    "lines": "116-123",
    "snippet": "static int __init housekeeping_nohz_full_setup(char *str)\n{\n\tunsigned int flags;\n\n\tflags = HK_FLAG_TICK | HK_FLAG_WQ | HK_FLAG_TIMER | HK_FLAG_RCU | HK_FLAG_MISC;\n\n\treturn housekeeping_setup(str, flags);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "housekeeping_setup",
          "args": [
            "str",
            "flags"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "housekeeping_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/isolation.c",
          "lines": "65-114",
          "snippet": "static int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tint err;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\terr = cpulist_parse(str, non_housekeeping_mask);\n\tif (err < 0 || cpumask_last(non_housekeeping_mask) >= nr_cpu_ids) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(housekeeping_mask))\n\t\t\tcpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t} else {\n\t\tcpumask_var_t tmp;\n\n\t\talloc_bootmem_cpumask_var(&tmp);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t\tfree_bootmem_cpumask_var(tmp);\n\t}\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static cpumask_var_t housekeeping_mask;",
            "static unsigned int housekeeping_flags;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nstatic int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tint err;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\terr = cpulist_parse(str, non_housekeeping_mask);\n\tif (err < 0 || cpumask_last(non_housekeeping_mask) >= nr_cpu_ids) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(housekeeping_mask))\n\t\t\tcpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t} else {\n\t\tcpumask_var_t tmp;\n\n\t\talloc_bootmem_cpumask_var(&tmp);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t\tfree_bootmem_cpumask_var(tmp);\n\t}\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic int __init housekeeping_nohz_full_setup(char *str)\n{\n\tunsigned int flags;\n\n\tflags = HK_FLAG_TICK | HK_FLAG_WQ | HK_FLAG_TIMER | HK_FLAG_RCU | HK_FLAG_MISC;\n\n\treturn housekeeping_setup(str, flags);\n}"
  },
  {
    "function_name": "housekeeping_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/isolation.c",
    "lines": "65-114",
    "snippet": "static int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tint err;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\terr = cpulist_parse(str, non_housekeeping_mask);\n\tif (err < 0 || cpumask_last(non_housekeeping_mask) >= nr_cpu_ids) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(housekeeping_mask))\n\t\t\tcpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t} else {\n\t\tcpumask_var_t tmp;\n\n\t\talloc_bootmem_cpumask_var(&tmp);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t\tfree_bootmem_cpumask_var(tmp);\n\t}\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "non_housekeeping_mask"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "non_housekeeping_mask"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\""
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tick_nohz_full_setup",
          "args": [
            "non_housekeeping_mask"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "tick_nohz_full_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/tick-sched.c",
          "lines": "391-396",
          "snippet": "void __init tick_nohz_full_setup(cpumask_var_t cpumask)\n{\n\talloc_bootmem_cpumask_var(&tick_nohz_full_mask);\n\tcpumask_copy(tick_nohz_full_mask, cpumask);\n\ttick_nohz_full_running = true;\n}",
          "includes": [
            "#include <trace/events/timer.h>",
            "#include \"tick-internal.h\"",
            "#include <asm/irq_regs.h>",
            "#include <linux/mm.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/module.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/profile.h>",
            "#include <linux/nmi.h>",
            "#include <linux/percpu.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/err.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/timer.h>\n#include \"tick-internal.h\"\n#include <asm/irq_regs.h>\n#include <linux/mm.h>\n#include <linux/context_tracking.h>\n#include <linux/posix-timers.h>\n#include <linux/irq_work.h>\n#include <linux/module.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/signal.h>\n#include <linux/profile.h>\n#include <linux/nmi.h>\n#include <linux/percpu.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/hrtimer.h>\n#include <linux/err.h>\n#include <linux/cpu.h>\n\nvoid __init tick_nohz_full_setup(cpumask_var_t cpumask)\n{\n\talloc_bootmem_cpumask_var(&tick_nohz_full_mask);\n\tcpumask_copy(tick_nohz_full_mask, cpumask);\n\ttick_nohz_full_running = true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_NO_HZ_FULL"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "tmp"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "non_housekeeping_mask"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "tmp"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Housekeeping: nohz_full= must match isolcpus=\\n\""
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_equal",
          "args": [
            "tmp",
            "housekeeping_mask"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "tmp",
            "cpu_possible_mask",
            "non_housekeeping_mask"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_bootmem_cpumask_var",
          "args": [
            "&tmp"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "smp_processor_id()",
            "housekeeping_mask"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "housekeeping_mask"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "housekeeping_mask",
            "cpu_possible_mask",
            "non_housekeeping_mask"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_bootmem_cpumask_var",
          "args": [
            "&housekeeping_mask"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "non_housekeeping_mask"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\""
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_last",
          "args": [
            "non_housekeeping_mask"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpulist_parse",
          "args": [
            "str",
            "non_housekeeping_mask"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_bootmem_cpumask_var",
          "args": [
            "&non_housekeeping_mask"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nstatic int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tint err;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\terr = cpulist_parse(str, non_housekeeping_mask);\n\tif (err < 0 || cpumask_last(non_housekeeping_mask) >= nr_cpu_ids) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(housekeeping_mask))\n\t\t\tcpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t} else {\n\t\tcpumask_var_t tmp;\n\n\t\talloc_bootmem_cpumask_var(&tmp);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t\tfree_bootmem_cpumask_var(tmp);\n\t}\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "housekeeping_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/isolation.c",
    "lines": "51-63",
    "snippet": "void __init housekeeping_init(void)\n{\n\tif (!housekeeping_flags)\n\t\treturn;\n\n\tstatic_branch_enable(&housekeeping_overriden);\n\n\tif (housekeeping_flags & HK_FLAG_TICK)\n\t\tsched_tick_offload_init();\n\n\t/* We need at least one CPU to handle housekeeping work */\n\tWARN_ON_ONCE(cpumask_empty(housekeeping_mask));\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "cpumask_empty(housekeeping_mask)"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "housekeeping_mask"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sched_tick_offload_init",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "sched_tick_offload_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/sched.h",
          "lines": "1789-1789",
          "snippet": "static inline int sched_tick_offload_init(void) { return 0; }",
          "includes": [
            "#include \"features.h\"",
            "#include \"features.h\"",
            "# include <linux/static_key.h>",
            "#include \"autogroup.h\"",
            "#include \"stats.h\"",
            "#include <linux/psi.h>",
            "#include <linux/cgroup.h>",
            "#include \"cpudeadline.h\"",
            "#include \"cpupri.h\"",
            "# include <asm/paravirt.h>",
            "#include <asm/tlb.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/task_work.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swait.h>",
            "#include <linux/suspend.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/security.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/psi.h>",
            "#include <linux/profile.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/migrate.h>",
            "#include <linux/membarrier.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init_task.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpufreq.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/compat.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/binfmts.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/xacct.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/prio.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/jobctl.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/init.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/cpufreq.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include \"features.h\"\n# include <linux/static_key.h>\n#include \"autogroup.h\"\n#include \"stats.h\"\n#include <linux/psi.h>\n#include <linux/cgroup.h>\n#include \"cpudeadline.h\"\n#include \"cpupri.h\"\n# include <asm/paravirt.h>\n#include <asm/tlb.h>\n#include <linux/tsacct_kern.h>\n#include <linux/task_work.h>\n#include <linux/syscalls.h>\n#include <linux/swait.h>\n#include <linux/suspend.h>\n#include <linux/stop_machine.h>\n#include <linux/security.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/psi.h>\n#include <linux/profile.h>\n#include <linux/prefetch.h>\n#include <linux/proc_fs.h>\n#include <linux/nmi.h>\n#include <linux/mmu_context.h>\n#include <linux/migrate.h>\n#include <linux/membarrier.h>\n#include <linux/kthread.h>\n#include <linux/kprobes.h>\n#include <linux/init_task.h>\n#include <linux/delayacct.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/cpuset.h>\n#include <linux/cpuidle.h>\n#include <linux/cpufreq.h>\n#include <linux/context_tracking.h>\n#include <linux/compat.h>\n#include <linux/blkdev.h>\n#include <linux/binfmts.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/xacct.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/user.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/sysctl.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/prio.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/jobctl.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/init.h>\n#include <linux/sched/idle.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/cpufreq.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n\nstatic inline int sched_tick_offload_init(void) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "static_branch_enable",
          "args": [
            "&housekeeping_overriden"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nvoid __init housekeeping_init(void)\n{\n\tif (!housekeeping_flags)\n\t\treturn;\n\n\tstatic_branch_enable(&housekeeping_overriden);\n\n\tif (housekeeping_flags & HK_FLAG_TICK)\n\t\tsched_tick_offload_init();\n\n\t/* We need at least one CPU to handle housekeeping work */\n\tWARN_ON_ONCE(cpumask_empty(housekeeping_mask));\n}"
  },
  {
    "function_name": "housekeeping_test_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/isolation.c",
    "lines": "42-48",
    "snippet": "bool housekeeping_test_cpu(int cpu, enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overriden))\n\t\tif (housekeeping_flags & flags)\n\t\t\treturn cpumask_test_cpu(cpu, housekeeping_mask);\n\treturn true;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_test_cpu",
          "args": [
            "cpu",
            "housekeeping_mask"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_branch_unlikely",
          "args": [
            "&housekeeping_overriden"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nbool housekeeping_test_cpu(int cpu, enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overriden))\n\t\tif (housekeeping_flags & flags)\n\t\t\treturn cpumask_test_cpu(cpu, housekeeping_mask);\n\treturn true;\n}"
  },
  {
    "function_name": "housekeeping_affine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/isolation.c",
    "lines": "34-39",
    "snippet": "void housekeeping_affine(struct task_struct *t, enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overriden))\n\t\tif (housekeeping_flags & flags)\n\t\t\tset_cpus_allowed_ptr(t, housekeeping_mask);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_cpus_allowed_ptr",
          "args": [
            "t",
            "housekeeping_mask"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpus_allowed_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "1126-1129",
          "snippet": "int set_cpus_allowed_ptr(struct task_struct *p, const struct cpumask *new_mask)\n{\n\treturn __set_cpus_allowed_ptr(p, new_mask, false);\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic __always_inline struct;\n\nint set_cpus_allowed_ptr(struct task_struct *p, const struct cpumask *new_mask)\n{\n\treturn __set_cpus_allowed_ptr(p, new_mask, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_branch_unlikely",
          "args": [
            "&housekeeping_overriden"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nvoid housekeeping_affine(struct task_struct *t, enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overriden))\n\t\tif (housekeeping_flags & flags)\n\t\t\tset_cpus_allowed_ptr(t, housekeeping_mask);\n}"
  },
  {
    "function_name": "housekeeping_cpumask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/isolation.c",
    "lines": "25-31",
    "snippet": "const struct cpumask *housekeeping_cpumask(enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overriden))\n\t\tif (housekeeping_flags & flags)\n\t\t\treturn housekeeping_mask;\n\treturn cpu_possible_mask;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_branch_unlikely",
          "args": [
            "&housekeeping_overriden"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nconst struct cpumask *housekeeping_cpumask(enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overriden))\n\t\tif (housekeeping_flags & flags)\n\t\t\treturn housekeeping_mask;\n\treturn cpu_possible_mask;\n}"
  },
  {
    "function_name": "housekeeping_any_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/isolation.c",
    "lines": "16-22",
    "snippet": "int housekeeping_any_cpu(enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overriden))\n\t\tif (housekeeping_flags & flags)\n\t\t\treturn cpumask_any_and(housekeeping_mask, cpu_online_mask);\n\treturn smp_processor_id();\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_any_and",
          "args": [
            "housekeeping_mask",
            "cpu_online_mask"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_branch_unlikely",
          "args": [
            "&housekeeping_overriden"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nint housekeeping_any_cpu(enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overriden))\n\t\tif (housekeeping_flags & flags)\n\t\t\treturn cpumask_any_and(housekeeping_mask, cpu_online_mask);\n\treturn smp_processor_id();\n}"
  }
]