[
  {
    "function_name": "up_read_non_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "217-221",
    "snippet": "void up_read_non_owner(struct rw_semaphore *sem)\n{\n\tDEBUG_RWSEMS_WARN_ON(!((unsigned long)sem->owner & RWSEM_READER_OWNED));\n\t__up_read(sem);\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__up_read",
          "args": [
            "sem"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "__up_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem-spinlock.c",
          "lines": "295-305",
          "snippet": "void __up_read(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tif (--sem->count == 0 && !list_empty(&sem->wait_list))\n\t\tsem = __rwsem_wake_one_writer(sem);\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/rwsem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/rwsem.h>\n\nvoid __up_read(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tif (--sem->count == 0 && !list_empty(&sem->wait_list))\n\t\tsem = __rwsem_wake_one_writer(sem);\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DEBUG_RWSEMS_WARN_ON",
          "args": [
            "!((unsigned long)sem->owner & RWSEM_READER_OWNED)"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid up_read_non_owner(struct rw_semaphore *sem)\n{\n\tDEBUG_RWSEMS_WARN_ON(!((unsigned long)sem->owner & RWSEM_READER_OWNED));\n\t__up_read(sem);\n}"
  },
  {
    "function_name": "down_write_killable_nested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "201-213",
    "snippet": "int __sched down_write_killable_nested(struct rw_semaphore *sem, int subclass)\n{\n\tmight_sleep();\n\trwsem_acquire(&sem->dep_map, subclass, 0, _RET_IP_);\n\n\tif (LOCK_CONTENDED_RETURN(sem, __down_write_trylock, __down_write_killable)) {\n\t\trwsem_release(&sem->dep_map, 1, _RET_IP_);\n\t\treturn -EINTR;\n\t}\n\n\trwsem_set_owner(sem);\n\treturn 0;\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rwsem_set_owner",
          "args": [
            "sem"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_set_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "112-114",
          "snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "rwsem_release",
          "args": [
            "&sem->dep_map",
            "1",
            "_RET_IP_"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK_CONTENDED_RETURN",
          "args": [
            "sem",
            "__down_write_trylock",
            "__down_write_killable"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rwsem_acquire",
          "args": [
            "&sem->dep_map",
            "subclass",
            "0",
            "_RET_IP_"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nint __sched down_write_killable_nested(struct rw_semaphore *sem, int subclass)\n{\n\tmight_sleep();\n\trwsem_acquire(&sem->dep_map, subclass, 0, _RET_IP_);\n\n\tif (LOCK_CONTENDED_RETURN(sem, __down_write_trylock, __down_write_killable)) {\n\t\trwsem_release(&sem->dep_map, 1, _RET_IP_);\n\t\treturn -EINTR;\n\t}\n\n\trwsem_set_owner(sem);\n\treturn 0;\n}"
  },
  {
    "function_name": "down_write_nested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "190-197",
    "snippet": "void down_write_nested(struct rw_semaphore *sem, int subclass)\n{\n\tmight_sleep();\n\trwsem_acquire(&sem->dep_map, subclass, 0, _RET_IP_);\n\n\tLOCK_CONTENDED(sem, __down_write_trylock, __down_write);\n\trwsem_set_owner(sem);\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rwsem_set_owner",
          "args": [
            "sem"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_set_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "112-114",
          "snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK_CONTENDED",
          "args": [
            "sem",
            "__down_write_trylock",
            "__down_write"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rwsem_acquire",
          "args": [
            "&sem->dep_map",
            "subclass",
            "0",
            "_RET_IP_"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid down_write_nested(struct rw_semaphore *sem, int subclass)\n{\n\tmight_sleep();\n\trwsem_acquire(&sem->dep_map, subclass, 0, _RET_IP_);\n\n\tLOCK_CONTENDED(sem, __down_write_trylock, __down_write);\n\trwsem_set_owner(sem);\n}"
  },
  {
    "function_name": "down_read_non_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "180-186",
    "snippet": "void down_read_non_owner(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\n\t__down_read(sem);\n\t__rwsem_set_reader_owned(sem, NULL);\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__rwsem_set_reader_owned",
          "args": [
            "sem",
            "NULL"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "__rwsem_set_reader_owned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "120-123",
          "snippet": "static inline void __rwsem_set_reader_owned(struct rw_semaphore *sem,\n\t\t\t\t\t   struct task_struct *owner)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void __rwsem_set_reader_owned(struct rw_semaphore *sem,\n\t\t\t\t\t   struct task_struct *owner)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "__down_read",
          "args": [
            "sem"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "__down_read_trylock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem-spinlock.c",
          "lines": "191-208",
          "snippet": "int __down_read_trylock(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\tint ret = 0;\n\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tif (sem->count >= 0 && list_empty(&sem->wait_list)) {\n\t\t/* granted */\n\t\tsem->count++;\n\t\tret = 1;\n\t}\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/rwsem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/rwsem.h>\n\nint __down_read_trylock(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\tint ret = 0;\n\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tif (sem->count >= 0 && list_empty(&sem->wait_list)) {\n\t\t/* granted */\n\t\tsem->count++;\n\t\tret = 1;\n\t}\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid down_read_non_owner(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\n\t__down_read(sem);\n\t__rwsem_set_reader_owned(sem, NULL);\n}"
  },
  {
    "function_name": "_down_write_nest_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "169-176",
    "snippet": "void _down_write_nest_lock(struct rw_semaphore *sem, struct lockdep_map *nest)\n{\n\tmight_sleep();\n\trwsem_acquire_nest(&sem->dep_map, 0, 0, nest, _RET_IP_);\n\n\tLOCK_CONTENDED(sem, __down_write_trylock, __down_write);\n\trwsem_set_owner(sem);\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rwsem_set_owner",
          "args": [
            "sem"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_set_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "112-114",
          "snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK_CONTENDED",
          "args": [
            "sem",
            "__down_write_trylock",
            "__down_write"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rwsem_acquire_nest",
          "args": [
            "&sem->dep_map",
            "0",
            "0",
            "nest",
            "_RET_IP_"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid _down_write_nest_lock(struct rw_semaphore *sem, struct lockdep_map *nest)\n{\n\tmight_sleep();\n\trwsem_acquire_nest(&sem->dep_map, 0, 0, nest, _RET_IP_);\n\n\tLOCK_CONTENDED(sem, __down_write_trylock, __down_write);\n\trwsem_set_owner(sem);\n}"
  },
  {
    "function_name": "down_read_nested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "158-165",
    "snippet": "void down_read_nested(struct rw_semaphore *sem, int subclass)\n{\n\tmight_sleep();\n\trwsem_acquire_read(&sem->dep_map, subclass, 0, _RET_IP_);\n\n\tLOCK_CONTENDED(sem, __down_read_trylock, __down_read);\n\trwsem_set_reader_owned(sem);\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rwsem_set_reader_owned",
          "args": [
            "sem"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_set_reader_owned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "125-127",
          "snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK_CONTENDED",
          "args": [
            "sem",
            "__down_read_trylock",
            "__down_read"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rwsem_acquire_read",
          "args": [
            "&sem->dep_map",
            "subclass",
            "0",
            "_RET_IP_"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid down_read_nested(struct rw_semaphore *sem, int subclass)\n{\n\tmight_sleep();\n\trwsem_acquire_read(&sem->dep_map, subclass, 0, _RET_IP_);\n\n\tLOCK_CONTENDED(sem, __down_read_trylock, __down_read);\n\trwsem_set_reader_owned(sem);\n}"
  },
  {
    "function_name": "downgrade_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "145-152",
    "snippet": "void downgrade_write(struct rw_semaphore *sem)\n{\n\tlock_downgrade(&sem->dep_map, _RET_IP_);\n\tDEBUG_RWSEMS_WARN_ON(sem->owner != current);\n\n\trwsem_set_reader_owned(sem);\n\t__downgrade_write(sem);\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__downgrade_write",
          "args": [
            "sem"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "__downgrade_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem-spinlock.c",
          "lines": "327-338",
          "snippet": "void __downgrade_write(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tsem->count = 1;\n\tif (!list_empty(&sem->wait_list))\n\t\tsem = __rwsem_do_wake(sem, 0);\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/rwsem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/rwsem.h>\n\nvoid __downgrade_write(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tsem->count = 1;\n\tif (!list_empty(&sem->wait_list))\n\t\tsem = __rwsem_do_wake(sem, 0);\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rwsem_set_reader_owned",
          "args": [
            "sem"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_set_reader_owned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "125-127",
          "snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "DEBUG_RWSEMS_WARN_ON",
          "args": [
            "sem->owner != current"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lock_downgrade",
          "args": [
            "&sem->dep_map",
            "_RET_IP_"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "lock_downgrade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/lockdep.c",
          "lines": "3809-3823",
          "snippet": "void lock_downgrade(struct lockdep_map *lock, unsigned long ip)\n{\n\tunsigned long flags;\n\n\tif (unlikely(current->lockdep_recursion))\n\t\treturn;\n\n\traw_local_irq_save(flags);\n\tcurrent->lockdep_recursion = 1;\n\tcheck_flags(flags);\n\tif (__lock_downgrade(lock, ip))\n\t\tcheck_chain_key(current);\n\tcurrent->lockdep_recursion = 0;\n\traw_local_irq_restore(flags);\n}",
          "includes": [
            "#include \"lockdep_states.h\"",
            "#include \"lockdep_states.h\"",
            "#include \"lockdep_states.h\"",
            "#include \"lockdep_states.h\"",
            "#include <trace/events/lock.h>",
            "#include \"lockdep_internals.h\"",
            "#include <asm/sections.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jhash.h>",
            "#include <linux/random.h>",
            "#include <linux/gfp.h>",
            "#include <linux/bitops.h>",
            "#include <linux/stringify.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/hash.h>",
            "#include <linux/utsname.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/mutex.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lockdep_states.h\"\n#include \"lockdep_states.h\"\n#include \"lockdep_states.h\"\n#include \"lockdep_states.h\"\n#include <trace/events/lock.h>\n#include \"lockdep_internals.h\"\n#include <asm/sections.h>\n#include <linux/nmi.h>\n#include <linux/jhash.h>\n#include <linux/random.h>\n#include <linux/gfp.h>\n#include <linux/bitops.h>\n#include <linux/stringify.h>\n#include <linux/ftrace.h>\n#include <linux/hash.h>\n#include <linux/utsname.h>\n#include <linux/irqflags.h>\n#include <linux/debug_locks.h>\n#include <linux/stacktrace.h>\n#include <linux/interrupt.h>\n#include <linux/kallsyms.h>\n#include <linux/spinlock.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/delay.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/task.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n\nvoid lock_downgrade(struct lockdep_map *lock, unsigned long ip)\n{\n\tunsigned long flags;\n\n\tif (unlikely(current->lockdep_recursion))\n\t\treturn;\n\n\traw_local_irq_save(flags);\n\tcurrent->lockdep_recursion = 1;\n\tcheck_flags(flags);\n\tif (__lock_downgrade(lock, ip))\n\t\tcheck_chain_key(current);\n\tcurrent->lockdep_recursion = 0;\n\traw_local_irq_restore(flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid downgrade_write(struct rw_semaphore *sem)\n{\n\tlock_downgrade(&sem->dep_map, _RET_IP_);\n\tDEBUG_RWSEMS_WARN_ON(sem->owner != current);\n\n\trwsem_set_reader_owned(sem);\n\t__downgrade_write(sem);\n}"
  },
  {
    "function_name": "up_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "131-138",
    "snippet": "void up_write(struct rw_semaphore *sem)\n{\n\trwsem_release(&sem->dep_map, 1, _RET_IP_);\n\tDEBUG_RWSEMS_WARN_ON(sem->owner != current);\n\n\trwsem_clear_owner(sem);\n\t__up_write(sem);\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__up_write",
          "args": [
            "sem"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "__up_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem-spinlock.c",
          "lines": "310-321",
          "snippet": "void __up_write(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tsem->count = 0;\n\tif (!list_empty(&sem->wait_list))\n\t\tsem = __rwsem_do_wake(sem, 1);\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/rwsem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/rwsem.h>\n\nvoid __up_write(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tsem->count = 0;\n\tif (!list_empty(&sem->wait_list))\n\t\tsem = __rwsem_do_wake(sem, 1);\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rwsem_clear_owner",
          "args": [
            "sem"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_clear_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "116-118",
          "snippet": "static inline void rwsem_clear_owner(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_clear_owner(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "DEBUG_RWSEMS_WARN_ON",
          "args": [
            "sem->owner != current"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rwsem_release",
          "args": [
            "&sem->dep_map",
            "1",
            "_RET_IP_"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid up_write(struct rw_semaphore *sem)\n{\n\trwsem_release(&sem->dep_map, 1, _RET_IP_);\n\tDEBUG_RWSEMS_WARN_ON(sem->owner != current);\n\n\trwsem_clear_owner(sem);\n\t__up_write(sem);\n}"
  },
  {
    "function_name": "up_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "117-124",
    "snippet": "void up_read(struct rw_semaphore *sem)\n{\n\trwsem_release(&sem->dep_map, 1, _RET_IP_);\n\tDEBUG_RWSEMS_WARN_ON(!((unsigned long)sem->owner & RWSEM_READER_OWNED));\n\n\trwsem_clear_reader_owned(sem);\n\t__up_read(sem);\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__up_read",
          "args": [
            "sem"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "__up_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem-spinlock.c",
          "lines": "295-305",
          "snippet": "void __up_read(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tif (--sem->count == 0 && !list_empty(&sem->wait_list))\n\t\tsem = __rwsem_wake_one_writer(sem);\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/rwsem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/rwsem.h>\n\nvoid __up_read(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tif (--sem->count == 0 && !list_empty(&sem->wait_list))\n\t\tsem = __rwsem_wake_one_writer(sem);\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rwsem_clear_reader_owned",
          "args": [
            "sem"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_clear_reader_owned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "131-133",
          "snippet": "static inline void rwsem_clear_reader_owned(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [
            "#define rwsem_clear_reader_owned rwsem_clear_reader_owned"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#define rwsem_clear_reader_owned rwsem_clear_reader_owned\n\nstatic inline void rwsem_clear_reader_owned(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "DEBUG_RWSEMS_WARN_ON",
          "args": [
            "!((unsigned long)sem->owner & RWSEM_READER_OWNED)"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rwsem_release",
          "args": [
            "&sem->dep_map",
            "1",
            "_RET_IP_"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid up_read(struct rw_semaphore *sem)\n{\n\trwsem_release(&sem->dep_map, 1, _RET_IP_);\n\tDEBUG_RWSEMS_WARN_ON(!((unsigned long)sem->owner & RWSEM_READER_OWNED));\n\n\trwsem_clear_reader_owned(sem);\n\t__up_read(sem);\n}"
  },
  {
    "function_name": "down_write_trylock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "100-110",
    "snippet": "int down_write_trylock(struct rw_semaphore *sem)\n{\n\tint ret = __down_write_trylock(sem);\n\n\tif (ret == 1) {\n\t\trwsem_acquire(&sem->dep_map, 0, 1, _RET_IP_);\n\t\trwsem_set_owner(sem);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rwsem_set_owner",
          "args": [
            "sem"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_set_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "112-114",
          "snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "rwsem_acquire",
          "args": [
            "&sem->dep_map",
            "0",
            "1",
            "_RET_IP_"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__down_write_trylock",
          "args": [
            "sem"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "__down_write_trylock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem-spinlock.c",
          "lines": "274-290",
          "snippet": "int __down_write_trylock(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\tint ret = 0;\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tif (sem->count == 0) {\n\t\t/* got the lock */\n\t\tsem->count = -1;\n\t\tret = 1;\n\t}\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/rwsem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/rwsem.h>\n\nint __down_write_trylock(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\tint ret = 0;\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tif (sem->count == 0) {\n\t\t/* got the lock */\n\t\tsem->count = -1;\n\t\tret = 1;\n\t}\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nint down_write_trylock(struct rw_semaphore *sem)\n{\n\tint ret = __down_write_trylock(sem);\n\n\tif (ret == 1) {\n\t\trwsem_acquire(&sem->dep_map, 0, 1, _RET_IP_);\n\t\trwsem_set_owner(sem);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "down_write_killable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "81-93",
    "snippet": "int __sched down_write_killable(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\trwsem_acquire(&sem->dep_map, 0, 0, _RET_IP_);\n\n\tif (LOCK_CONTENDED_RETURN(sem, __down_write_trylock, __down_write_killable)) {\n\t\trwsem_release(&sem->dep_map, 1, _RET_IP_);\n\t\treturn -EINTR;\n\t}\n\n\trwsem_set_owner(sem);\n\treturn 0;\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rwsem_set_owner",
          "args": [
            "sem"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_set_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "112-114",
          "snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "rwsem_release",
          "args": [
            "&sem->dep_map",
            "1",
            "_RET_IP_"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK_CONTENDED_RETURN",
          "args": [
            "sem",
            "__down_write_trylock",
            "__down_write_killable"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rwsem_acquire",
          "args": [
            "&sem->dep_map",
            "0",
            "0",
            "_RET_IP_"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nint __sched down_write_killable(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\trwsem_acquire(&sem->dep_map, 0, 0, _RET_IP_);\n\n\tif (LOCK_CONTENDED_RETURN(sem, __down_write_trylock, __down_write_killable)) {\n\t\trwsem_release(&sem->dep_map, 1, _RET_IP_);\n\t\treturn -EINTR;\n\t}\n\n\trwsem_set_owner(sem);\n\treturn 0;\n}"
  },
  {
    "function_name": "down_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "67-74",
    "snippet": "void __sched down_write(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\trwsem_acquire(&sem->dep_map, 0, 0, _RET_IP_);\n\n\tLOCK_CONTENDED(sem, __down_write_trylock, __down_write);\n\trwsem_set_owner(sem);\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rwsem_set_owner",
          "args": [
            "sem"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_set_owner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "112-114",
          "snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK_CONTENDED",
          "args": [
            "sem",
            "__down_write_trylock",
            "__down_write"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rwsem_acquire",
          "args": [
            "&sem->dep_map",
            "0",
            "0",
            "_RET_IP_"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid __sched down_write(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\trwsem_acquire(&sem->dep_map, 0, 0, _RET_IP_);\n\n\tLOCK_CONTENDED(sem, __down_write_trylock, __down_write);\n\trwsem_set_owner(sem);\n}"
  },
  {
    "function_name": "down_read_trylock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "51-60",
    "snippet": "int down_read_trylock(struct rw_semaphore *sem)\n{\n\tint ret = __down_read_trylock(sem);\n\n\tif (ret == 1) {\n\t\trwsem_acquire_read(&sem->dep_map, 0, 1, _RET_IP_);\n\t\trwsem_set_reader_owned(sem);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rwsem_set_reader_owned",
          "args": [
            "sem"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_set_reader_owned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "125-127",
          "snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "rwsem_acquire_read",
          "args": [
            "&sem->dep_map",
            "0",
            "1",
            "_RET_IP_"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__down_read_trylock",
          "args": [
            "sem"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "__down_read_trylock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem-spinlock.c",
          "lines": "191-208",
          "snippet": "int __down_read_trylock(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\tint ret = 0;\n\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tif (sem->count >= 0 && list_empty(&sem->wait_list)) {\n\t\t/* granted */\n\t\tsem->count++;\n\t\tret = 1;\n\t}\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/rwsem.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/rwsem.h>\n\nint __down_read_trylock(struct rw_semaphore *sem)\n{\n\tunsigned long flags;\n\tint ret = 0;\n\n\n\traw_spin_lock_irqsave(&sem->wait_lock, flags);\n\n\tif (sem->count >= 0 && list_empty(&sem->wait_list)) {\n\t\t/* granted */\n\t\tsem->count++;\n\t\tret = 1;\n\t}\n\n\traw_spin_unlock_irqrestore(&sem->wait_lock, flags);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nint down_read_trylock(struct rw_semaphore *sem)\n{\n\tint ret = __down_read_trylock(sem);\n\n\tif (ret == 1) {\n\t\trwsem_acquire_read(&sem->dep_map, 0, 1, _RET_IP_);\n\t\trwsem_set_reader_owned(sem);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "down_read_killable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "32-44",
    "snippet": "int __sched down_read_killable(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\trwsem_acquire_read(&sem->dep_map, 0, 0, _RET_IP_);\n\n\tif (LOCK_CONTENDED_RETURN(sem, __down_read_trylock, __down_read_killable)) {\n\t\trwsem_release(&sem->dep_map, 1, _RET_IP_);\n\t\treturn -EINTR;\n\t}\n\n\trwsem_set_reader_owned(sem);\n\treturn 0;\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rwsem_set_reader_owned",
          "args": [
            "sem"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_set_reader_owned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "125-127",
          "snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "rwsem_release",
          "args": [
            "&sem->dep_map",
            "1",
            "_RET_IP_"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOCK_CONTENDED_RETURN",
          "args": [
            "sem",
            "__down_read_trylock",
            "__down_read_killable"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rwsem_acquire_read",
          "args": [
            "&sem->dep_map",
            "0",
            "0",
            "_RET_IP_"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nint __sched down_read_killable(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\trwsem_acquire_read(&sem->dep_map, 0, 0, _RET_IP_);\n\n\tif (LOCK_CONTENDED_RETURN(sem, __down_read_trylock, __down_read_killable)) {\n\t\trwsem_release(&sem->dep_map, 1, _RET_IP_);\n\t\treturn -EINTR;\n\t}\n\n\trwsem_set_reader_owned(sem);\n\treturn 0;\n}"
  },
  {
    "function_name": "down_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.c",
    "lines": "21-28",
    "snippet": "void __sched down_read(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\trwsem_acquire_read(&sem->dep_map, 0, 0, _RET_IP_);\n\n\tLOCK_CONTENDED(sem, __down_read_trylock, __down_read);\n\trwsem_set_reader_owned(sem);\n}",
    "includes": [
      "#include \"rwsem.h\"",
      "#include <linux/atomic.h>",
      "#include <linux/rwsem.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rwsem_set_reader_owned",
          "args": [
            "sem"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "rwsem_set_reader_owned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "125-127",
          "snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOCK_CONTENDED",
          "args": [
            "sem",
            "__down_read_trylock",
            "__down_read"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rwsem_acquire_read",
          "args": [
            "&sem->dep_map",
            "0",
            "0",
            "_RET_IP_"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rwsem.h\"\n#include <linux/atomic.h>\n#include <linux/rwsem.h>\n#include <linux/export.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid __sched down_read(struct rw_semaphore *sem)\n{\n\tmight_sleep();\n\trwsem_acquire_read(&sem->dep_map, 0, 0, _RET_IP_);\n\n\tLOCK_CONTENDED(sem, __down_read_trylock, __down_read);\n\trwsem_set_reader_owned(sem);\n}"
  }
]