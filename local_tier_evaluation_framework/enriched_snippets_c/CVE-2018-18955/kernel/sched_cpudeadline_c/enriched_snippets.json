[
  {
    "function_name": "cpudl_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "272-276",
    "snippet": "void cpudl_cleanup(struct cpudl *cp)\n{\n\tfree_cpumask_var(cp->free_cpus);\n\tkfree(cp->elements);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cp->elements"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_cpumask_var",
          "args": [
            "cp->free_cpus"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid cpudl_cleanup(struct cpudl *cp)\n{\n\tfree_cpumask_var(cp->free_cpus);\n\tkfree(cp->elements);\n}"
  },
  {
    "function_name": "cpudl_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "244-266",
    "snippet": "int cpudl_init(struct cpudl *cp)\n{\n\tint i;\n\n\traw_spin_lock_init(&cp->lock);\n\tcp->size = 0;\n\n\tcp->elements = kcalloc(nr_cpu_ids,\n\t\t\t       sizeof(struct cpudl_item),\n\t\t\t       GFP_KERNEL);\n\tif (!cp->elements)\n\t\treturn -ENOMEM;\n\n\tif (!zalloc_cpumask_var(&cp->free_cpus, GFP_KERNEL)) {\n\t\tkfree(cp->elements);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor_each_possible_cpu(i)\n\t\tcp->elements[i].idx = IDX_INVALID;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cp->elements"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var",
          "args": [
            "&cp->free_cpus",
            "GFP_KERNEL"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcalloc",
          "args": [
            "nr_cpu_ids",
            "sizeof(struct cpudl_item)",
            "GFP_KERNEL"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_init",
          "args": [
            "&cp->lock"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nint cpudl_init(struct cpudl *cp)\n{\n\tint i;\n\n\traw_spin_lock_init(&cp->lock);\n\tcp->size = 0;\n\n\tcp->elements = kcalloc(nr_cpu_ids,\n\t\t\t       sizeof(struct cpudl_item),\n\t\t\t       GFP_KERNEL);\n\tif (!cp->elements)\n\t\treturn -ENOMEM;\n\n\tif (!zalloc_cpumask_var(&cp->free_cpus, GFP_KERNEL)) {\n\t\tkfree(cp->elements);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor_each_possible_cpu(i)\n\t\tcp->elements[i].idx = IDX_INVALID;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cpudl_clear_freecpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "235-238",
    "snippet": "void cpudl_clear_freecpu(struct cpudl *cp, int cpu)\n{\n\tcpumask_clear_cpu(cpu, cp->free_cpus);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "cpu",
            "cp->free_cpus"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid cpudl_clear_freecpu(struct cpudl *cp, int cpu)\n{\n\tcpumask_clear_cpu(cpu, cp->free_cpus);\n}"
  },
  {
    "function_name": "cpudl_set_freecpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "225-228",
    "snippet": "void cpudl_set_freecpu(struct cpudl *cp, int cpu)\n{\n\tcpumask_set_cpu(cpu, cp->free_cpus);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "cp->free_cpus"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid cpudl_set_freecpu(struct cpudl *cp, int cpu)\n{\n\tcpumask_set_cpu(cpu, cp->free_cpus);\n}"
  },
  {
    "function_name": "cpudl_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "194-218",
    "snippet": "void cpudl_set(struct cpudl *cp, int cpu, u64 dl)\n{\n\tint old_idx;\n\tunsigned long flags;\n\n\tWARN_ON(!cpu_present(cpu));\n\n\traw_spin_lock_irqsave(&cp->lock, flags);\n\n\told_idx = cp->elements[cpu].idx;\n\tif (old_idx == IDX_INVALID) {\n\t\tint new_idx = cp->size++;\n\n\t\tcp->elements[new_idx].dl = dl;\n\t\tcp->elements[new_idx].cpu = cpu;\n\t\tcp->elements[cpu].idx = new_idx;\n\t\tcpudl_heapify_up(cp, new_idx);\n\t\tcpumask_clear_cpu(cpu, cp->free_cpus);\n\t} else {\n\t\tcp->elements[old_idx].dl = dl;\n\t\tcpudl_heapify(cp, old_idx);\n\t}\n\n\traw_spin_unlock_irqrestore(&cp->lock, flags);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&cp->lock",
            "flags"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpudl_heapify",
          "args": [
            "cp",
            "old_idx"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_heapify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
          "lines": "99-106",
          "snippet": "static void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "cpu",
            "cp->free_cpus"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpudl_heapify_up",
          "args": [
            "cp",
            "new_idx"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_heapify_up",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
          "lines": "73-97",
          "snippet": "static void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&cp->lock",
            "flags"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!cpu_present(cpu)"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_present",
          "args": [
            "cpu"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "init_cpu_present",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu.c",
          "lines": "2264-2267",
          "snippet": "void init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}",
          "includes": [
            "#include \"smpboot.h\"",
            "#include <trace/events/cpuhp.h>",
            "#include <trace/events/power.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/slab.h>",
            "#include <linux/relay.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/nmi.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/suspend.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/kthread.h>",
            "#include <linux/bug.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/unistd.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/notifier.h>",
            "#include <linux/init.h>",
            "#include <linux/smp.h>",
            "#include <linux/proc_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct cpumask __cpu_present_mask"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"smpboot.h\"\n#include <trace/events/cpuhp.h>\n#include <trace/events/power.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/slab.h>\n#include <linux/relay.h>\n#include <linux/smpboot.h>\n#include <linux/nmi.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/lockdep.h>\n#include <linux/suspend.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/stop_machine.h>\n#include <linux/kthread.h>\n#include <linux/bug.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/unistd.h>\n#include <linux/sched/task.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/signal.h>\n#include <linux/notifier.h>\n#include <linux/init.h>\n#include <linux/smp.h>\n#include <linux/proc_fs.h>\n\nstruct cpumask __cpu_present_mask;\n\nvoid init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid cpudl_set(struct cpudl *cp, int cpu, u64 dl)\n{\n\tint old_idx;\n\tunsigned long flags;\n\n\tWARN_ON(!cpu_present(cpu));\n\n\traw_spin_lock_irqsave(&cp->lock, flags);\n\n\told_idx = cp->elements[cpu].idx;\n\tif (old_idx == IDX_INVALID) {\n\t\tint new_idx = cp->size++;\n\n\t\tcp->elements[new_idx].dl = dl;\n\t\tcp->elements[new_idx].cpu = cpu;\n\t\tcp->elements[cpu].idx = new_idx;\n\t\tcpudl_heapify_up(cp, new_idx);\n\t\tcpumask_clear_cpu(cpu, cp->free_cpus);\n\t} else {\n\t\tcp->elements[old_idx].dl = dl;\n\t\tcpudl_heapify(cp, old_idx);\n\t}\n\n\traw_spin_unlock_irqrestore(&cp->lock, flags);\n}"
  },
  {
    "function_name": "cpudl_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "154-182",
    "snippet": "void cpudl_clear(struct cpudl *cp, int cpu)\n{\n\tint old_idx, new_cpu;\n\tunsigned long flags;\n\n\tWARN_ON(!cpu_present(cpu));\n\n\traw_spin_lock_irqsave(&cp->lock, flags);\n\n\told_idx = cp->elements[cpu].idx;\n\tif (old_idx == IDX_INVALID) {\n\t\t/*\n\t\t * Nothing to remove if old_idx was invalid.\n\t\t * This could happen if a rq_offline_dl is\n\t\t * called for a CPU without -dl tasks running.\n\t\t */\n\t} else {\n\t\tnew_cpu = cp->elements[cp->size - 1].cpu;\n\t\tcp->elements[old_idx].dl = cp->elements[cp->size - 1].dl;\n\t\tcp->elements[old_idx].cpu = new_cpu;\n\t\tcp->size--;\n\t\tcp->elements[new_cpu].idx = old_idx;\n\t\tcp->elements[cpu].idx = IDX_INVALID;\n\t\tcpudl_heapify(cp, old_idx);\n\n\t\tcpumask_set_cpu(cpu, cp->free_cpus);\n\t}\n\traw_spin_unlock_irqrestore(&cp->lock, flags);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&cp->lock",
            "flags"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "cp->free_cpus"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpudl_heapify",
          "args": [
            "cp",
            "old_idx"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_heapify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
          "lines": "99-106",
          "snippet": "static void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&cp->lock",
            "flags"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!cpu_present(cpu)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_present",
          "args": [
            "cpu"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "init_cpu_present",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu.c",
          "lines": "2264-2267",
          "snippet": "void init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}",
          "includes": [
            "#include \"smpboot.h\"",
            "#include <trace/events/cpuhp.h>",
            "#include <trace/events/power.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/slab.h>",
            "#include <linux/relay.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/nmi.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/suspend.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/kthread.h>",
            "#include <linux/bug.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/unistd.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/notifier.h>",
            "#include <linux/init.h>",
            "#include <linux/smp.h>",
            "#include <linux/proc_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct cpumask __cpu_present_mask"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"smpboot.h\"\n#include <trace/events/cpuhp.h>\n#include <trace/events/power.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/slab.h>\n#include <linux/relay.h>\n#include <linux/smpboot.h>\n#include <linux/nmi.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/lockdep.h>\n#include <linux/suspend.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/stop_machine.h>\n#include <linux/kthread.h>\n#include <linux/bug.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/unistd.h>\n#include <linux/sched/task.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/signal.h>\n#include <linux/notifier.h>\n#include <linux/init.h>\n#include <linux/smp.h>\n#include <linux/proc_fs.h>\n\nstruct cpumask __cpu_present_mask;\n\nvoid init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid cpudl_clear(struct cpudl *cp, int cpu)\n{\n\tint old_idx, new_cpu;\n\tunsigned long flags;\n\n\tWARN_ON(!cpu_present(cpu));\n\n\traw_spin_lock_irqsave(&cp->lock, flags);\n\n\told_idx = cp->elements[cpu].idx;\n\tif (old_idx == IDX_INVALID) {\n\t\t/*\n\t\t * Nothing to remove if old_idx was invalid.\n\t\t * This could happen if a rq_offline_dl is\n\t\t * called for a CPU without -dl tasks running.\n\t\t */\n\t} else {\n\t\tnew_cpu = cp->elements[cp->size - 1].cpu;\n\t\tcp->elements[old_idx].dl = cp->elements[cp->size - 1].dl;\n\t\tcp->elements[old_idx].cpu = new_cpu;\n\t\tcp->size--;\n\t\tcp->elements[new_cpu].idx = old_idx;\n\t\tcp->elements[cpu].idx = IDX_INVALID;\n\t\tcpudl_heapify(cp, old_idx);\n\n\t\tcpumask_set_cpu(cpu, cp->free_cpus);\n\t}\n\traw_spin_unlock_irqrestore(&cp->lock, flags);\n}"
  },
  {
    "function_name": "cpudl_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "121-143",
    "snippet": "int cpudl_find(struct cpudl *cp, struct task_struct *p,\n\t       struct cpumask *later_mask)\n{\n\tconst struct sched_dl_entity *dl_se = &p->dl;\n\n\tif (later_mask &&\n\t    cpumask_and(later_mask, cp->free_cpus, &p->cpus_allowed)) {\n\t\treturn 1;\n\t} else {\n\t\tint best_cpu = cpudl_maximum(cp);\n\n\t\tWARN_ON(best_cpu != -1 && !cpu_present(best_cpu));\n\n\t\tif (cpumask_test_cpu(best_cpu, &p->cpus_allowed) &&\n\t\t    dl_time_before(dl_se->deadline, cp->elements[0].dl)) {\n\t\t\tif (later_mask)\n\t\t\t\tcpumask_set_cpu(best_cpu, later_mask);\n\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "best_cpu",
            "later_mask"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dl_time_before",
          "args": [
            "dl_se->deadline",
            "cp->elements[0].dl"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_test_cpu",
          "args": [
            "best_cpu",
            "&p->cpus_allowed"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "best_cpu != -1 && !cpu_present(best_cpu)"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_present",
          "args": [
            "best_cpu"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "init_cpu_present",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu.c",
          "lines": "2264-2267",
          "snippet": "void init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}",
          "includes": [
            "#include \"smpboot.h\"",
            "#include <trace/events/cpuhp.h>",
            "#include <trace/events/power.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/slab.h>",
            "#include <linux/relay.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/nmi.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/suspend.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/kthread.h>",
            "#include <linux/bug.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/unistd.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/notifier.h>",
            "#include <linux/init.h>",
            "#include <linux/smp.h>",
            "#include <linux/proc_fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct cpumask __cpu_present_mask"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"smpboot.h\"\n#include <trace/events/cpuhp.h>\n#include <trace/events/power.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/slab.h>\n#include <linux/relay.h>\n#include <linux/smpboot.h>\n#include <linux/nmi.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/lockdep.h>\n#include <linux/suspend.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/stop_machine.h>\n#include <linux/kthread.h>\n#include <linux/bug.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/unistd.h>\n#include <linux/sched/task.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/signal.h>\n#include <linux/notifier.h>\n#include <linux/init.h>\n#include <linux/smp.h>\n#include <linux/proc_fs.h>\n\nstruct cpumask __cpu_present_mask;\n\nvoid init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpudl_maximum",
          "args": [
            "cp"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_maximum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
          "lines": "108-111",
          "snippet": "static inline int cpudl_maximum(struct cpudl *cp)\n{\n\treturn cp->elements[0].cpu;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int cpudl_maximum(struct cpudl *cp)\n{\n\treturn cp->elements[0].cpu;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_and",
          "args": [
            "later_mask",
            "cp->free_cpus",
            "&p->cpus_allowed"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nint cpudl_find(struct cpudl *cp, struct task_struct *p,\n\t       struct cpumask *later_mask)\n{\n\tconst struct sched_dl_entity *dl_se = &p->dl;\n\n\tif (later_mask &&\n\t    cpumask_and(later_mask, cp->free_cpus, &p->cpus_allowed)) {\n\t\treturn 1;\n\t} else {\n\t\tint best_cpu = cpudl_maximum(cp);\n\n\t\tWARN_ON(best_cpu != -1 && !cpu_present(best_cpu));\n\n\t\tif (cpumask_test_cpu(best_cpu, &p->cpus_allowed) &&\n\t\t    dl_time_before(dl_se->deadline, cp->elements[0].dl)) {\n\t\t\tif (later_mask)\n\t\t\t\tcpumask_set_cpu(best_cpu, later_mask);\n\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "cpudl_maximum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "108-111",
    "snippet": "static inline int cpudl_maximum(struct cpudl *cp)\n{\n\treturn cp->elements[0].cpu;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int cpudl_maximum(struct cpudl *cp)\n{\n\treturn cp->elements[0].cpu;\n}"
  },
  {
    "function_name": "cpudl_heapify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "99-106",
    "snippet": "static void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpudl_heapify_down",
          "args": [
            "cp",
            "idx"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_heapify_down",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
          "lines": "30-71",
          "snippet": "static void cpudl_heapify_down(struct cpudl *cp, int idx)\n{\n\tint l, r, largest;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (left_child(idx) >= cp->size)\n\t\treturn;\n\n\t/* adapted from lib/prio_heap.c */\n\twhile (1) {\n\t\tu64 largest_dl;\n\n\t\tl = left_child(idx);\n\t\tr = right_child(idx);\n\t\tlargest = idx;\n\t\tlargest_dl = orig_dl;\n\n\t\tif ((l < cp->size) && dl_time_before(orig_dl,\n\t\t\t\t\t\tcp->elements[l].dl)) {\n\t\t\tlargest = l;\n\t\t\tlargest_dl = cp->elements[l].dl;\n\t\t}\n\t\tif ((r < cp->size) && dl_time_before(largest_dl,\n\t\t\t\t\t\tcp->elements[r].dl))\n\t\t\tlargest = r;\n\n\t\tif (largest == idx)\n\t\t\tbreak;\n\n\t\t/* pull largest child onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[largest].cpu;\n\t\tcp->elements[idx].dl = cp->elements[largest].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = largest;\n\t}\n\t/* actual push down of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify_down(struct cpudl *cp, int idx)\n{\n\tint l, r, largest;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (left_child(idx) >= cp->size)\n\t\treturn;\n\n\t/* adapted from lib/prio_heap.c */\n\twhile (1) {\n\t\tu64 largest_dl;\n\n\t\tl = left_child(idx);\n\t\tr = right_child(idx);\n\t\tlargest = idx;\n\t\tlargest_dl = orig_dl;\n\n\t\tif ((l < cp->size) && dl_time_before(orig_dl,\n\t\t\t\t\t\tcp->elements[l].dl)) {\n\t\t\tlargest = l;\n\t\t\tlargest_dl = cp->elements[l].dl;\n\t\t}\n\t\tif ((r < cp->size) && dl_time_before(largest_dl,\n\t\t\t\t\t\tcp->elements[r].dl))\n\t\t\tlargest = r;\n\n\t\tif (largest == idx)\n\t\t\tbreak;\n\n\t\t/* pull largest child onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[largest].cpu;\n\t\tcp->elements[idx].dl = cp->elements[largest].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = largest;\n\t}\n\t/* actual push down of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpudl_heapify_up",
          "args": [
            "cp",
            "idx"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_heapify_up",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
          "lines": "73-97",
          "snippet": "static void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dl_time_before",
          "args": [
            "cp->elements[parent(idx)].dl",
            "cp->elements[idx].dl"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parent",
          "args": [
            "idx"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "parent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
          "lines": "15-18",
          "snippet": "static inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}"
  },
  {
    "function_name": "cpudl_heapify_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "73-97",
    "snippet": "static void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dl_time_before",
          "args": [
            "orig_dl",
            "cp->elements[p].dl"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parent",
          "args": [
            "idx"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "parent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
          "lines": "15-18",
          "snippet": "static inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}"
  },
  {
    "function_name": "cpudl_heapify_down",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "30-71",
    "snippet": "static void cpudl_heapify_down(struct cpudl *cp, int idx)\n{\n\tint l, r, largest;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (left_child(idx) >= cp->size)\n\t\treturn;\n\n\t/* adapted from lib/prio_heap.c */\n\twhile (1) {\n\t\tu64 largest_dl;\n\n\t\tl = left_child(idx);\n\t\tr = right_child(idx);\n\t\tlargest = idx;\n\t\tlargest_dl = orig_dl;\n\n\t\tif ((l < cp->size) && dl_time_before(orig_dl,\n\t\t\t\t\t\tcp->elements[l].dl)) {\n\t\t\tlargest = l;\n\t\t\tlargest_dl = cp->elements[l].dl;\n\t\t}\n\t\tif ((r < cp->size) && dl_time_before(largest_dl,\n\t\t\t\t\t\tcp->elements[r].dl))\n\t\t\tlargest = r;\n\n\t\tif (largest == idx)\n\t\t\tbreak;\n\n\t\t/* pull largest child onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[largest].cpu;\n\t\tcp->elements[idx].dl = cp->elements[largest].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = largest;\n\t}\n\t/* actual push down of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dl_time_before",
          "args": [
            "largest_dl",
            "cp->elements[r].dl"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dl_time_before",
          "args": [
            "orig_dl",
            "cp->elements[l].dl"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "right_child",
          "args": [
            "idx"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "right_child",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
          "lines": "25-28",
          "snippet": "static inline int right_child(int i)\n{\n\treturn (i << 1) + 2;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int right_child(int i)\n{\n\treturn (i << 1) + 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "left_child",
          "args": [
            "idx"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "left_child",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
          "lines": "20-23",
          "snippet": "static inline int left_child(int i)\n{\n\treturn (i << 1) + 1;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int left_child(int i)\n{\n\treturn (i << 1) + 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify_down(struct cpudl *cp, int idx)\n{\n\tint l, r, largest;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (left_child(idx) >= cp->size)\n\t\treturn;\n\n\t/* adapted from lib/prio_heap.c */\n\twhile (1) {\n\t\tu64 largest_dl;\n\n\t\tl = left_child(idx);\n\t\tr = right_child(idx);\n\t\tlargest = idx;\n\t\tlargest_dl = orig_dl;\n\n\t\tif ((l < cp->size) && dl_time_before(orig_dl,\n\t\t\t\t\t\tcp->elements[l].dl)) {\n\t\t\tlargest = l;\n\t\t\tlargest_dl = cp->elements[l].dl;\n\t\t}\n\t\tif ((r < cp->size) && dl_time_before(largest_dl,\n\t\t\t\t\t\tcp->elements[r].dl))\n\t\t\tlargest = r;\n\n\t\tif (largest == idx)\n\t\t\tbreak;\n\n\t\t/* pull largest child onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[largest].cpu;\n\t\tcp->elements[idx].dl = cp->elements[largest].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = largest;\n\t}\n\t/* actual push down of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}"
  },
  {
    "function_name": "right_child",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "25-28",
    "snippet": "static inline int right_child(int i)\n{\n\treturn (i << 1) + 2;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int right_child(int i)\n{\n\treturn (i << 1) + 2;\n}"
  },
  {
    "function_name": "left_child",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "20-23",
    "snippet": "static inline int left_child(int i)\n{\n\treturn (i << 1) + 1;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int left_child(int i)\n{\n\treturn (i << 1) + 1;\n}"
  },
  {
    "function_name": "parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/cpudeadline.c",
    "lines": "15-18",
    "snippet": "static inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}"
  }
]