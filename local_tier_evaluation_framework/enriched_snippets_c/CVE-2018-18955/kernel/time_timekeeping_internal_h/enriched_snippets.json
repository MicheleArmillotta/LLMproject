[
  {
    "function_name": "clocksource_delta",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timekeeping_internal.h",
    "lines": "28-31",
    "snippet": "static inline u64 clocksource_delta(u64 now, u64 last, u64 mask)\n{\n\treturn (now - last) & mask;\n}",
    "includes": [
      "#include <linux/time.h>",
      "#include <linux/clocksource.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/time.h>\n#include <linux/clocksource.h>\n\nstatic inline u64 clocksource_delta(u64 now, u64 last, u64 mask)\n{\n\treturn (now - last) & mask;\n}"
  },
  {
    "function_name": "clocksource_delta",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timekeeping_internal.h",
    "lines": "17-26",
    "snippet": "static inline u64 clocksource_delta(u64 now, u64 last, u64 mask)\n{\n\tu64 ret = (now - last) & mask;\n\n\t/*\n\t * Prevent time going backwards by checking the MSB of mask in\n\t * the result. If set, return 0.\n\t */\n\treturn ret & ~(mask >> 1) ? 0 : ret;\n}",
    "includes": [
      "#include <linux/time.h>",
      "#include <linux/clocksource.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/time.h>\n#include <linux/clocksource.h>\n\nstatic inline u64 clocksource_delta(u64 now, u64 last, u64 mask)\n{\n\tu64 ret = (now - last) & mask;\n\n\t/*\n\t * Prevent time going backwards by checking the MSB of mask in\n\t * the result. If set, return 0.\n\t */\n\treturn ret & ~(mask >> 1) ? 0 : ret;\n}"
  }
]