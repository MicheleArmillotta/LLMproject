[
  {
    "function_name": "kstat_irqs_usr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "937-945",
    "snippet": "unsigned int kstat_irqs_usr(unsigned int irq)\n{\n\tunsigned int sum;\n\n\trcu_read_lock();\n\tsum = kstat_irqs(irq);\n\trcu_read_unlock();\n\treturn sum;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "__rcu_read_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tree_plugin.h",
          "lines": "419-441",
          "snippet": "void __rcu_read_unlock(void)\n{\n\tstruct task_struct *t = current;\n\n\tif (t->rcu_read_lock_nesting != 1) {\n\t\t--t->rcu_read_lock_nesting;\n\t} else {\n\t\tbarrier();  /* critical section before exit code. */\n\t\tt->rcu_read_lock_nesting = INT_MIN;\n\t\tbarrier();  /* assign before ->rcu_read_unlock_special load */\n\t\tif (unlikely(READ_ONCE(t->rcu_read_unlock_special.s)))\n\t\t\trcu_read_unlock_special(t);\n\t\tbarrier();  /* ->rcu_read_unlock_special load before assign */\n\t\tt->rcu_read_lock_nesting = 0;\n\t}\n#ifdef CONFIG_PROVE_LOCKING\n\t{\n\t\tint rrln = READ_ONCE(t->rcu_read_lock_nesting);\n\n\t\tWARN_ON_ONCE(rrln < 0 && rrln > INT_MIN / 2);\n\t}\n#endif /* #ifdef CONFIG_PROVE_LOCKING */\n}",
          "includes": [
            "#include \"../locking/rtmutex_common.h\"",
            "#include \"../time/tick-internal.h\"",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/oom.h>",
            "#include <linux/gfp.h>",
            "#include <linux/delay.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../locking/rtmutex_common.h\"\n#include \"../time/tick-internal.h\"\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/isolation.h>\n#include <linux/smpboot.h>\n#include <linux/sched/debug.h>\n#include <linux/oom.h>\n#include <linux/gfp.h>\n#include <linux/delay.h>\n\nvoid __rcu_read_unlock(void)\n{\n\tstruct task_struct *t = current;\n\n\tif (t->rcu_read_lock_nesting != 1) {\n\t\t--t->rcu_read_lock_nesting;\n\t} else {\n\t\tbarrier();  /* critical section before exit code. */\n\t\tt->rcu_read_lock_nesting = INT_MIN;\n\t\tbarrier();  /* assign before ->rcu_read_unlock_special load */\n\t\tif (unlikely(READ_ONCE(t->rcu_read_unlock_special.s)))\n\t\t\trcu_read_unlock_special(t);\n\t\tbarrier();  /* ->rcu_read_unlock_special load before assign */\n\t\tt->rcu_read_lock_nesting = 0;\n\t}\n#ifdef CONFIG_PROVE_LOCKING\n\t{\n\t\tint rrln = READ_ONCE(t->rcu_read_lock_nesting);\n\n\t\tWARN_ON_ONCE(rrln < 0 && rrln > INT_MIN / 2);\n\t}\n#endif /* #ifdef CONFIG_PROVE_LOCKING */\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstat_irqs",
          "args": [
            "irq"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "kstat_irqs_usr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "937-945",
          "snippet": "unsigned int kstat_irqs_usr(unsigned int irq)\n{\n\tunsigned int sum;\n\n\trcu_read_lock();\n\tsum = kstat_irqs(irq);\n\trcu_read_unlock();\n\treturn sum;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 941
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_read_lock_bh_held",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/update.c",
          "lines": "300-309",
          "snippet": "int rcu_read_lock_bh_held(void)\n{\n\tif (!debug_lockdep_rcu_enabled())\n\t\treturn 1;\n\tif (!rcu_is_watching())\n\t\treturn 0;\n\tif (!rcu_lockdep_current_cpu_online())\n\t\treturn 0;\n\treturn in_softirq() || irqs_disabled();\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include <linux/sched/isolation.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/tick.h>",
            "#include <linux/kthread.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/export.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include <linux/sched/isolation.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/tick.h>\n#include <linux/kthread.h>\n#include <linux/moduleparam.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/export.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nint rcu_read_lock_bh_held(void)\n{\n\tif (!debug_lockdep_rcu_enabled())\n\t\treturn 1;\n\tif (!rcu_is_watching())\n\t\treturn 0;\n\tif (!rcu_lockdep_current_cpu_online())\n\t\treturn 0;\n\treturn in_softirq() || irqs_disabled();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nunsigned int kstat_irqs_usr(unsigned int irq)\n{\n\tunsigned int sum;\n\n\trcu_read_lock();\n\tsum = kstat_irqs(irq);\n\trcu_read_unlock();\n\treturn sum;\n}"
  },
  {
    "function_name": "kstat_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "915-926",
    "snippet": "unsigned int kstat_irqs(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\tint cpu;\n\tunsigned int sum = 0;\n\n\tif (!desc || !desc->kstat_irqs)\n\t\treturn 0;\n\tfor_each_possible_cpu(cpu)\n\t\tsum += *per_cpu_ptr(desc->kstat_irqs, cpu);\n\treturn sum;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_to_desc",
          "args": [
            "irq"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "irq_to_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "561-564",
          "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nunsigned int kstat_irqs(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\tint cpu;\n\tunsigned int sum = 0;\n\n\tif (!desc || !desc->kstat_irqs)\n\t\treturn 0;\n\tfor_each_possible_cpu(cpu)\n\t\tsum += *per_cpu_ptr(desc->kstat_irqs, cpu);\n\treturn sum;\n}"
  },
  {
    "function_name": "kstat_irqs_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "899-905",
    "snippet": "unsigned int kstat_irqs_cpu(unsigned int irq, int cpu)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\treturn desc && desc->kstat_irqs ?\n\t\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) : 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu_ptr",
          "args": [
            "desc->kstat_irqs",
            "cpu"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_to_desc",
          "args": [
            "irq"
          ],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "irq_to_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "561-564",
          "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nunsigned int kstat_irqs_cpu(unsigned int irq, int cpu)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\treturn desc && desc->kstat_irqs ?\n\t\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) : 0;\n}"
  },
  {
    "function_name": "kstat_incr_irq_this_cpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "885-888",
    "snippet": "void kstat_incr_irq_this_cpu(unsigned int irq)\n{\n\tkstat_incr_irqs_this_cpu(irq_to_desc(irq));\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstat_incr_irqs_this_cpu",
          "args": [
            "irq_to_desc(irq)"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "kstat_incr_irqs_this_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/internals.h",
          "lines": "245-249",
          "snippet": "static inline void kstat_incr_irqs_this_cpu(struct irq_desc *desc)\n{\n\t__this_cpu_inc(*desc->kstat_irqs);\n\t__this_cpu_inc(kstat.irqs_sum);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void __disable_irq(struct irq_desc *desc);",
            "extern void __enable_irq(struct irq_desc *desc);",
            "extern int irq_activate(struct irq_desc *desc);",
            "extern void irq_shutdown(struct irq_desc *desc);",
            "extern void irq_enable(struct irq_desc *desc);",
            "extern void irq_disable(struct irq_desc *desc);",
            "extern void mask_irq(struct irq_desc *desc);",
            "extern void unmask_irq(struct irq_desc *desc);",
            "extern void unmask_threaded_irq(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event(struct irq_desc *desc);",
            "void check_irq_resend(struct irq_desc *desc);",
            "bool irq_wait_for_poll(struct irq_desc *desc);",
            "extern void irq_set_thread_affinity(struct irq_desc *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nextern void __disable_irq(struct irq_desc *desc);\nextern void __enable_irq(struct irq_desc *desc);\nextern int irq_activate(struct irq_desc *desc);\nextern void irq_shutdown(struct irq_desc *desc);\nextern void irq_enable(struct irq_desc *desc);\nextern void irq_disable(struct irq_desc *desc);\nextern void mask_irq(struct irq_desc *desc);\nextern void unmask_irq(struct irq_desc *desc);\nextern void unmask_threaded_irq(struct irq_desc *desc);\nirqreturn_t handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event(struct irq_desc *desc);\nvoid check_irq_resend(struct irq_desc *desc);\nbool irq_wait_for_poll(struct irq_desc *desc);\nextern void irq_set_thread_affinity(struct irq_desc *desc);\n\nstatic inline void kstat_incr_irqs_this_cpu(struct irq_desc *desc)\n{\n\t__this_cpu_inc(*desc->kstat_irqs);\n\t__this_cpu_inc(kstat.irqs_sum);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_to_desc",
          "args": [
            "irq"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "irq_to_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "561-564",
          "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nvoid kstat_incr_irq_this_cpu(unsigned int irq)\n{\n\tkstat_incr_irqs_this_cpu(irq_to_desc(irq));\n}"
  },
  {
    "function_name": "irq_get_percpu_devid_partition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "871-882",
    "snippet": "int irq_get_percpu_devid_partition(unsigned int irq, struct cpumask *affinity)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (!desc || !desc->percpu_enabled)\n\t\treturn -EINVAL;\n\n\tif (affinity)\n\t\tcpumask_copy(affinity, desc->percpu_affinity);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_copy",
          "args": [
            "affinity",
            "desc->percpu_affinity"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_to_desc",
          "args": [
            "irq"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "irq_to_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "561-564",
          "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint irq_get_percpu_devid_partition(unsigned int irq, struct cpumask *affinity)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (!desc || !desc->percpu_enabled)\n\t\treturn -EINVAL;\n\n\tif (affinity)\n\t\tcpumask_copy(affinity, desc->percpu_affinity);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "irq_set_percpu_devid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "866-869",
    "snippet": "int irq_set_percpu_devid(unsigned int irq)\n{\n\treturn irq_set_percpu_devid_partition(irq, NULL);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_set_percpu_devid_partition",
          "args": [
            "irq",
            "NULL"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "irq_set_percpu_devid_partition",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "841-864",
          "snippet": "int irq_set_percpu_devid_partition(unsigned int irq,\n\t\t\t\t   const struct cpumask *affinity)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\n\tif (desc->percpu_enabled)\n\t\treturn -EINVAL;\n\n\tdesc->percpu_enabled = kzalloc(sizeof(*desc->percpu_enabled), GFP_KERNEL);\n\n\tif (!desc->percpu_enabled)\n\t\treturn -ENOMEM;\n\n\tif (affinity)\n\t\tdesc->percpu_affinity = affinity;\n\telse\n\t\tdesc->percpu_affinity = cpu_possible_mask;\n\n\tirq_set_percpu_devid_flags(irq);\n\treturn 0;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint irq_set_percpu_devid_partition(unsigned int irq,\n\t\t\t\t   const struct cpumask *affinity)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\n\tif (desc->percpu_enabled)\n\t\treturn -EINVAL;\n\n\tdesc->percpu_enabled = kzalloc(sizeof(*desc->percpu_enabled), GFP_KERNEL);\n\n\tif (!desc->percpu_enabled)\n\t\treturn -ENOMEM;\n\n\tif (affinity)\n\t\tdesc->percpu_affinity = affinity;\n\telse\n\t\tdesc->percpu_affinity = cpu_possible_mask;\n\n\tirq_set_percpu_devid_flags(irq);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint irq_set_percpu_devid(unsigned int irq)\n{\n\treturn irq_set_percpu_devid_partition(irq, NULL);\n}"
  },
  {
    "function_name": "irq_set_percpu_devid_partition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "841-864",
    "snippet": "int irq_set_percpu_devid_partition(unsigned int irq,\n\t\t\t\t   const struct cpumask *affinity)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\n\tif (desc->percpu_enabled)\n\t\treturn -EINVAL;\n\n\tdesc->percpu_enabled = kzalloc(sizeof(*desc->percpu_enabled), GFP_KERNEL);\n\n\tif (!desc->percpu_enabled)\n\t\treturn -ENOMEM;\n\n\tif (affinity)\n\t\tdesc->percpu_affinity = affinity;\n\telse\n\t\tdesc->percpu_affinity = cpu_possible_mask;\n\n\tirq_set_percpu_devid_flags(irq);\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_set_percpu_devid_flags",
          "args": [
            "irq"
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*desc->percpu_enabled)",
            "GFP_KERNEL"
          ],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_to_desc",
          "args": [
            "irq"
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "irq_to_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "561-564",
          "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint irq_set_percpu_devid_partition(unsigned int irq,\n\t\t\t\t   const struct cpumask *affinity)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\n\tif (desc->percpu_enabled)\n\t\treturn -EINVAL;\n\n\tdesc->percpu_enabled = kzalloc(sizeof(*desc->percpu_enabled), GFP_KERNEL);\n\n\tif (!desc->percpu_enabled)\n\t\treturn -ENOMEM;\n\n\tif (affinity)\n\t\tdesc->percpu_affinity = affinity;\n\telse\n\t\tdesc->percpu_affinity = cpu_possible_mask;\n\n\tirq_set_percpu_devid_flags(irq);\n\treturn 0;\n}"
  },
  {
    "function_name": "__irq_put_desc_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "834-839",
    "snippet": "void __irq_put_desc_unlock(struct irq_desc *desc, unsigned long flags, bool bus)\n{\n\traw_spin_unlock_irqrestore(&desc->lock, flags);\n\tif (bus)\n\t\tchip_bus_sync_unlock(desc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "chip_bus_sync_unlock",
          "args": [
            "desc"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "chip_bus_sync_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/internals.h",
          "lines": "144-148",
          "snippet": "static inline void chip_bus_sync_unlock(struct irq_desc *desc)\n{\n\tif (unlikely(desc->irq_data.chip->irq_bus_sync_unlock))\n\t\tdesc->irq_data.chip->irq_bus_sync_unlock(&desc->irq_data);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void __disable_irq(struct irq_desc *desc);",
            "extern void __enable_irq(struct irq_desc *desc);",
            "extern int irq_activate(struct irq_desc *desc);",
            "extern void irq_shutdown(struct irq_desc *desc);",
            "extern void irq_enable(struct irq_desc *desc);",
            "extern void irq_disable(struct irq_desc *desc);",
            "extern void mask_irq(struct irq_desc *desc);",
            "extern void unmask_irq(struct irq_desc *desc);",
            "extern void unmask_threaded_irq(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event(struct irq_desc *desc);",
            "void check_irq_resend(struct irq_desc *desc);",
            "bool irq_wait_for_poll(struct irq_desc *desc);",
            "extern void irq_set_thread_affinity(struct irq_desc *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nextern void __disable_irq(struct irq_desc *desc);\nextern void __enable_irq(struct irq_desc *desc);\nextern int irq_activate(struct irq_desc *desc);\nextern void irq_shutdown(struct irq_desc *desc);\nextern void irq_enable(struct irq_desc *desc);\nextern void irq_disable(struct irq_desc *desc);\nextern void mask_irq(struct irq_desc *desc);\nextern void unmask_irq(struct irq_desc *desc);\nextern void unmask_threaded_irq(struct irq_desc *desc);\nirqreturn_t handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event(struct irq_desc *desc);\nvoid check_irq_resend(struct irq_desc *desc);\nbool irq_wait_for_poll(struct irq_desc *desc);\nextern void irq_set_thread_affinity(struct irq_desc *desc);\n\nstatic inline void chip_bus_sync_unlock(struct irq_desc *desc)\n{\n\tif (unlikely(desc->irq_data.chip->irq_bus_sync_unlock))\n\t\tdesc->irq_data.chip->irq_bus_sync_unlock(&desc->irq_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&desc->lock",
            "flags"
          ],
          "line": 836
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nvoid __irq_put_desc_unlock(struct irq_desc *desc, unsigned long flags, bool bus)\n{\n\traw_spin_unlock_irqrestore(&desc->lock, flags);\n\tif (bus)\n\t\tchip_bus_sync_unlock(desc);\n}"
  },
  {
    "function_name": "__irq_get_desc_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "810-832",
    "snippet": "struct irq_desc *\n__irq_get_desc_lock(unsigned int irq, unsigned long *flags, bool bus,\n\t\t    unsigned int check)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (desc) {\n\t\tif (check & _IRQ_DESC_CHECK) {\n\t\t\tif ((check & _IRQ_DESC_PERCPU) &&\n\t\t\t    !irq_settings_is_per_cpu_devid(desc))\n\t\t\t\treturn NULL;\n\n\t\t\tif (!(check & _IRQ_DESC_PERCPU) &&\n\t\t\t    irq_settings_is_per_cpu_devid(desc))\n\t\t\t\treturn NULL;\n\t\t}\n\n\t\tif (bus)\n\t\t\tchip_bus_lock(desc);\n\t\traw_spin_lock_irqsave(&desc->lock, *flags);\n\t}\n\treturn desc;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&desc->lock",
            "*flags"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "chip_bus_lock",
          "args": [
            "desc"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "chip_bus_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/internals.h",
          "lines": "138-142",
          "snippet": "static inline void chip_bus_lock(struct irq_desc *desc)\n{\n\tif (unlikely(desc->irq_data.chip->irq_bus_lock))\n\t\tdesc->irq_data.chip->irq_bus_lock(&desc->irq_data);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void __disable_irq(struct irq_desc *desc);",
            "extern void __enable_irq(struct irq_desc *desc);",
            "extern int irq_activate(struct irq_desc *desc);",
            "extern void irq_shutdown(struct irq_desc *desc);",
            "extern void irq_enable(struct irq_desc *desc);",
            "extern void irq_disable(struct irq_desc *desc);",
            "extern void mask_irq(struct irq_desc *desc);",
            "extern void unmask_irq(struct irq_desc *desc);",
            "extern void unmask_threaded_irq(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event(struct irq_desc *desc);",
            "void check_irq_resend(struct irq_desc *desc);",
            "bool irq_wait_for_poll(struct irq_desc *desc);",
            "extern void irq_set_thread_affinity(struct irq_desc *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nextern void __disable_irq(struct irq_desc *desc);\nextern void __enable_irq(struct irq_desc *desc);\nextern int irq_activate(struct irq_desc *desc);\nextern void irq_shutdown(struct irq_desc *desc);\nextern void irq_enable(struct irq_desc *desc);\nextern void irq_disable(struct irq_desc *desc);\nextern void mask_irq(struct irq_desc *desc);\nextern void unmask_irq(struct irq_desc *desc);\nextern void unmask_threaded_irq(struct irq_desc *desc);\nirqreturn_t handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event(struct irq_desc *desc);\nvoid check_irq_resend(struct irq_desc *desc);\nbool irq_wait_for_poll(struct irq_desc *desc);\nextern void irq_set_thread_affinity(struct irq_desc *desc);\n\nstatic inline void chip_bus_lock(struct irq_desc *desc)\n{\n\tif (unlikely(desc->irq_data.chip->irq_bus_lock))\n\t\tdesc->irq_data.chip->irq_bus_lock(&desc->irq_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_settings_is_per_cpu_devid",
          "args": [
            "desc"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "irq_settings_is_per_cpu_devid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/settings.h",
          "lines": "49-52",
          "snippet": "static inline bool irq_settings_is_per_cpu_devid(struct irq_desc *desc)\n{\n\treturn desc->status_use_accessors & _IRQ_PER_CPU_DEVID;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline bool irq_settings_is_per_cpu_devid(struct irq_desc *desc)\n{\n\treturn desc->status_use_accessors & _IRQ_PER_CPU_DEVID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_to_desc",
          "args": [
            "irq"
          ],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "irq_to_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "561-564",
          "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *\n__irq_get_desc_lock(unsigned int irq, unsigned long *flags, bool bus,\n\t\t    unsigned int check)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (desc) {\n\t\tif (check & _IRQ_DESC_CHECK) {\n\t\t\tif ((check & _IRQ_DESC_PERCPU) &&\n\t\t\t    !irq_settings_is_per_cpu_devid(desc))\n\t\t\t\treturn NULL;\n\n\t\t\tif (!(check & _IRQ_DESC_PERCPU) &&\n\t\t\t    irq_settings_is_per_cpu_devid(desc))\n\t\t\t\treturn NULL;\n\t\t}\n\n\t\tif (bus)\n\t\t\tchip_bus_lock(desc);\n\t\traw_spin_lock_irqsave(&desc->lock, *flags);\n\t}\n\treturn desc;\n}"
  },
  {
    "function_name": "irq_get_next_irq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "805-808",
    "snippet": "unsigned int irq_get_next_irq(unsigned int offset)\n{\n\treturn find_next_bit(allocated_irqs, nr_irqs, offset);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int nr_irqs = NR_IRQS;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "find_next_bit",
          "args": [
            "allocated_irqs",
            "nr_irqs",
            "offset"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint nr_irqs = NR_IRQS;\n\nunsigned int irq_get_next_irq(unsigned int offset)\n{\n\treturn find_next_bit(allocated_irqs, nr_irqs, offset);\n}"
  },
  {
    "function_name": "irq_free_hwirqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "786-795",
    "snippet": "void irq_free_hwirqs(unsigned int from, int cnt)\n{\n\tint i, j;\n\n\tfor (i = from, j = cnt; j > 0; i++, j--) {\n\t\tirq_set_status_flags(i, _IRQ_NOREQUEST | _IRQ_NOPROBE);\n\t\tarch_teardown_hwirq(i);\n\t}\n\tirq_free_descs(from, cnt);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_free_descs",
          "args": [
            "from",
            "cnt"
          ],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "irq_free_descs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "677-690",
          "snippet": "void irq_free_descs(unsigned int from, unsigned int cnt)\n{\n\tint i;\n\n\tif (from >= nr_irqs || (from + cnt) > nr_irqs)\n\t\treturn;\n\n\tmutex_lock(&sparse_irq_lock);\n\tfor (i = 0; i < cnt; i++)\n\t\tfree_desc(from + i);\n\n\tbitmap_clear(allocated_irqs, from, cnt);\n\tmutex_unlock(&sparse_irq_lock);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int nr_irqs = NR_IRQS;",
            "static DEFINE_MUTEX(sparse_irq_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint nr_irqs = NR_IRQS;\nstatic DEFINE_MUTEX(sparse_irq_lock);\n\nvoid irq_free_descs(unsigned int from, unsigned int cnt)\n{\n\tint i;\n\n\tif (from >= nr_irqs || (from + cnt) > nr_irqs)\n\t\treturn;\n\n\tmutex_lock(&sparse_irq_lock);\n\tfor (i = 0; i < cnt; i++)\n\t\tfree_desc(from + i);\n\n\tbitmap_clear(allocated_irqs, from, cnt);\n\tmutex_unlock(&sparse_irq_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "arch_teardown_hwirq",
          "args": [
            "i"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_set_status_flags",
          "args": [
            "i",
            "_IRQ_NOREQUEST | _IRQ_NOPROBE"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nvoid irq_free_hwirqs(unsigned int from, int cnt)\n{\n\tint i, j;\n\n\tfor (i = from, j = cnt; j > 0; i++, j--) {\n\t\tirq_set_status_flags(i, _IRQ_NOREQUEST | _IRQ_NOPROBE);\n\t\tarch_teardown_hwirq(i);\n\t}\n\tirq_free_descs(from, cnt);\n}"
  },
  {
    "function_name": "irq_alloc_hwirqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "756-777",
    "snippet": "unsigned int irq_alloc_hwirqs(int cnt, int node)\n{\n\tint i, irq = __irq_alloc_descs(-1, 0, cnt, node, NULL, NULL);\n\n\tif (irq < 0)\n\t\treturn 0;\n\n\tfor (i = irq; cnt > 0; i++, cnt--) {\n\t\tif (arch_setup_hwirq(i, node))\n\t\t\tgoto err;\n\t\tirq_clear_status_flags(i, _IRQ_NOREQUEST);\n\t}\n\treturn irq;\n\nerr:\n\tfor (i--; i >= irq; i--) {\n\t\tirq_set_status_flags(i, _IRQ_NOREQUEST | _IRQ_NOPROBE);\n\t\tarch_teardown_hwirq(i);\n\t}\n\tirq_free_descs(irq, cnt);\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_free_descs",
          "args": [
            "irq",
            "cnt"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "irq_free_descs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "677-690",
          "snippet": "void irq_free_descs(unsigned int from, unsigned int cnt)\n{\n\tint i;\n\n\tif (from >= nr_irqs || (from + cnt) > nr_irqs)\n\t\treturn;\n\n\tmutex_lock(&sparse_irq_lock);\n\tfor (i = 0; i < cnt; i++)\n\t\tfree_desc(from + i);\n\n\tbitmap_clear(allocated_irqs, from, cnt);\n\tmutex_unlock(&sparse_irq_lock);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int nr_irqs = NR_IRQS;",
            "static DEFINE_MUTEX(sparse_irq_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint nr_irqs = NR_IRQS;\nstatic DEFINE_MUTEX(sparse_irq_lock);\n\nvoid irq_free_descs(unsigned int from, unsigned int cnt)\n{\n\tint i;\n\n\tif (from >= nr_irqs || (from + cnt) > nr_irqs)\n\t\treturn;\n\n\tmutex_lock(&sparse_irq_lock);\n\tfor (i = 0; i < cnt; i++)\n\t\tfree_desc(from + i);\n\n\tbitmap_clear(allocated_irqs, from, cnt);\n\tmutex_unlock(&sparse_irq_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "arch_teardown_hwirq",
          "args": [
            "i"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_set_status_flags",
          "args": [
            "i",
            "_IRQ_NOREQUEST | _IRQ_NOPROBE"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_clear_status_flags",
          "args": [
            "i",
            "_IRQ_NOREQUEST"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arch_setup_hwirq",
          "args": [
            "i",
            "node"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__irq_alloc_descs",
          "args": [
            "-1",
            "0",
            "cnt",
            "node",
            "NULL",
            "NULL"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "__irq_alloc_descs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "706-745",
          "snippet": "int __ref\n__irq_alloc_descs(int irq, unsigned int from, unsigned int cnt, int node,\n\t\t  struct module *owner, const struct cpumask *affinity)\n{\n\tint start, ret;\n\n\tif (!cnt)\n\t\treturn -EINVAL;\n\n\tif (irq >= 0) {\n\t\tif (from > irq)\n\t\t\treturn -EINVAL;\n\t\tfrom = irq;\n\t} else {\n\t\t/*\n\t\t * For interrupts which are freely allocated the\n\t\t * architecture can force a lower bound to the @from\n\t\t * argument. x86 uses this to exclude the GSI space.\n\t\t */\n\t\tfrom = arch_dynirq_lower_bound(from);\n\t}\n\n\tmutex_lock(&sparse_irq_lock);\n\n\tstart = bitmap_find_next_zero_area(allocated_irqs, IRQ_BITMAP_BITS,\n\t\t\t\t\t   from, cnt, 0);\n\tret = -EEXIST;\n\tif (irq >=0 && start != irq)\n\t\tgoto unlock;\n\n\tif (start + cnt > nr_irqs) {\n\t\tret = irq_expand_nr_irqs(start + cnt);\n\t\tif (ret)\n\t\t\tgoto unlock;\n\t}\n\tret = alloc_descs(start, cnt, node, affinity, owner);\nunlock:\n\tmutex_unlock(&sparse_irq_lock);\n\treturn ret;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int nr_irqs = NR_IRQS;",
            "static DEFINE_MUTEX(sparse_irq_lock);",
            "static DECLARE_BITMAP(allocated_irqs, IRQ_BITMAP_BITS);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint nr_irqs = NR_IRQS;\nstatic DEFINE_MUTEX(sparse_irq_lock);\nstatic DECLARE_BITMAP(allocated_irqs, IRQ_BITMAP_BITS);\n\nint __ref\n__irq_alloc_descs(int irq, unsigned int from, unsigned int cnt, int node,\n\t\t  struct module *owner, const struct cpumask *affinity)\n{\n\tint start, ret;\n\n\tif (!cnt)\n\t\treturn -EINVAL;\n\n\tif (irq >= 0) {\n\t\tif (from > irq)\n\t\t\treturn -EINVAL;\n\t\tfrom = irq;\n\t} else {\n\t\t/*\n\t\t * For interrupts which are freely allocated the\n\t\t * architecture can force a lower bound to the @from\n\t\t * argument. x86 uses this to exclude the GSI space.\n\t\t */\n\t\tfrom = arch_dynirq_lower_bound(from);\n\t}\n\n\tmutex_lock(&sparse_irq_lock);\n\n\tstart = bitmap_find_next_zero_area(allocated_irqs, IRQ_BITMAP_BITS,\n\t\t\t\t\t   from, cnt, 0);\n\tret = -EEXIST;\n\tif (irq >=0 && start != irq)\n\t\tgoto unlock;\n\n\tif (start + cnt > nr_irqs) {\n\t\tret = irq_expand_nr_irqs(start + cnt);\n\t\tif (ret)\n\t\t\tgoto unlock;\n\t}\n\tret = alloc_descs(start, cnt, node, affinity, owner);\nunlock:\n\tmutex_unlock(&sparse_irq_lock);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nunsigned int irq_alloc_hwirqs(int cnt, int node)\n{\n\tint i, irq = __irq_alloc_descs(-1, 0, cnt, node, NULL, NULL);\n\n\tif (irq < 0)\n\t\treturn 0;\n\n\tfor (i = irq; cnt > 0; i++, cnt--) {\n\t\tif (arch_setup_hwirq(i, node))\n\t\t\tgoto err;\n\t\tirq_clear_status_flags(i, _IRQ_NOREQUEST);\n\t}\n\treturn irq;\n\nerr:\n\tfor (i--; i >= irq; i--) {\n\t\tirq_set_status_flags(i, _IRQ_NOREQUEST | _IRQ_NOPROBE);\n\t\tarch_teardown_hwirq(i);\n\t}\n\tirq_free_descs(irq, cnt);\n\treturn 0;\n}"
  },
  {
    "function_name": "__irq_alloc_descs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "706-745",
    "snippet": "int __ref\n__irq_alloc_descs(int irq, unsigned int from, unsigned int cnt, int node,\n\t\t  struct module *owner, const struct cpumask *affinity)\n{\n\tint start, ret;\n\n\tif (!cnt)\n\t\treturn -EINVAL;\n\n\tif (irq >= 0) {\n\t\tif (from > irq)\n\t\t\treturn -EINVAL;\n\t\tfrom = irq;\n\t} else {\n\t\t/*\n\t\t * For interrupts which are freely allocated the\n\t\t * architecture can force a lower bound to the @from\n\t\t * argument. x86 uses this to exclude the GSI space.\n\t\t */\n\t\tfrom = arch_dynirq_lower_bound(from);\n\t}\n\n\tmutex_lock(&sparse_irq_lock);\n\n\tstart = bitmap_find_next_zero_area(allocated_irqs, IRQ_BITMAP_BITS,\n\t\t\t\t\t   from, cnt, 0);\n\tret = -EEXIST;\n\tif (irq >=0 && start != irq)\n\t\tgoto unlock;\n\n\tif (start + cnt > nr_irqs) {\n\t\tret = irq_expand_nr_irqs(start + cnt);\n\t\tif (ret)\n\t\t\tgoto unlock;\n\t}\n\tret = alloc_descs(start, cnt, node, affinity, owner);\nunlock:\n\tmutex_unlock(&sparse_irq_lock);\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int nr_irqs = NR_IRQS;",
      "static DEFINE_MUTEX(sparse_irq_lock);",
      "static DECLARE_BITMAP(allocated_irqs, IRQ_BITMAP_BITS);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sparse_irq_lock"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_descs",
          "args": [
            "start",
            "cnt",
            "node",
            "affinity",
            "owner"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_descs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "577-590",
          "snippet": "static inline int alloc_descs(unsigned int start, unsigned int cnt, int node,\n\t\t\t      const struct cpumask *affinity,\n\t\t\t      struct module *owner)\n{\n\tu32 i;\n\n\tfor (i = 0; i < cnt; i++) {\n\t\tstruct irq_desc *desc = irq_to_desc(start + i);\n\n\t\tdesc->owner = owner;\n\t}\n\tbitmap_set(allocated_irqs, start, cnt);\n\treturn start;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic inline int alloc_descs(unsigned int start, unsigned int cnt, int node,\n\t\t\t      const struct cpumask *affinity,\n\t\t\t      struct module *owner)\n{\n\tu32 i;\n\n\tfor (i = 0; i < cnt; i++) {\n\t\tstruct irq_desc *desc = irq_to_desc(start + i);\n\n\t\tdesc->owner = owner;\n\t}\n\tbitmap_set(allocated_irqs, start, cnt);\n\treturn start;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_expand_nr_irqs",
          "args": [
            "start + cnt"
          ],
          "line": 737
        },
        "resolved": true,
        "details": {
          "function_name": "irq_expand_nr_irqs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "592-595",
          "snippet": "static int irq_expand_nr_irqs(unsigned int nr)\n{\n\treturn -ENOMEM;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic int irq_expand_nr_irqs(unsigned int nr)\n{\n\treturn -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bitmap_find_next_zero_area",
          "args": [
            "allocated_irqs",
            "IRQ_BITMAP_BITS",
            "from",
            "cnt",
            "0"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sparse_irq_lock"
          ],
          "line": 728
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "arch_dynirq_lower_bound",
          "args": [
            "from"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "arch_dynirq_lower_bound",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/softirq.c",
          "lines": "761-764",
          "snippet": "unsigned int __weak arch_dynirq_lower_bound(unsigned int from)\n{\n\treturn from;\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\nunsigned int __weak arch_dynirq_lower_bound(unsigned int from)\n{\n\treturn from;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint nr_irqs = NR_IRQS;\nstatic DEFINE_MUTEX(sparse_irq_lock);\nstatic DECLARE_BITMAP(allocated_irqs, IRQ_BITMAP_BITS);\n\nint __ref\n__irq_alloc_descs(int irq, unsigned int from, unsigned int cnt, int node,\n\t\t  struct module *owner, const struct cpumask *affinity)\n{\n\tint start, ret;\n\n\tif (!cnt)\n\t\treturn -EINVAL;\n\n\tif (irq >= 0) {\n\t\tif (from > irq)\n\t\t\treturn -EINVAL;\n\t\tfrom = irq;\n\t} else {\n\t\t/*\n\t\t * For interrupts which are freely allocated the\n\t\t * architecture can force a lower bound to the @from\n\t\t * argument. x86 uses this to exclude the GSI space.\n\t\t */\n\t\tfrom = arch_dynirq_lower_bound(from);\n\t}\n\n\tmutex_lock(&sparse_irq_lock);\n\n\tstart = bitmap_find_next_zero_area(allocated_irqs, IRQ_BITMAP_BITS,\n\t\t\t\t\t   from, cnt, 0);\n\tret = -EEXIST;\n\tif (irq >=0 && start != irq)\n\t\tgoto unlock;\n\n\tif (start + cnt > nr_irqs) {\n\t\tret = irq_expand_nr_irqs(start + cnt);\n\t\tif (ret)\n\t\t\tgoto unlock;\n\t}\n\tret = alloc_descs(start, cnt, node, affinity, owner);\nunlock:\n\tmutex_unlock(&sparse_irq_lock);\n\treturn ret;\n}"
  },
  {
    "function_name": "irq_free_descs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "677-690",
    "snippet": "void irq_free_descs(unsigned int from, unsigned int cnt)\n{\n\tint i;\n\n\tif (from >= nr_irqs || (from + cnt) > nr_irqs)\n\t\treturn;\n\n\tmutex_lock(&sparse_irq_lock);\n\tfor (i = 0; i < cnt; i++)\n\t\tfree_desc(from + i);\n\n\tbitmap_clear(allocated_irqs, from, cnt);\n\tmutex_unlock(&sparse_irq_lock);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int nr_irqs = NR_IRQS;",
      "static DEFINE_MUTEX(sparse_irq_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sparse_irq_lock"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bitmap_clear",
          "args": [
            "allocated_irqs",
            "from",
            "cnt"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_desc",
          "args": [
            "from + i"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "free_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "567-575",
          "snippet": "static void free_desc(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&desc->lock, flags);\n\tdesc_set_defaults(irq, desc, irq_desc_get_node(desc), NULL, NULL);\n\traw_spin_unlock_irqrestore(&desc->lock, flags);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void free_desc(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&desc->lock, flags);\n\tdesc_set_defaults(irq, desc, irq_desc_get_node(desc), NULL, NULL);\n\traw_spin_unlock_irqrestore(&desc->lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sparse_irq_lock"
          ],
          "line": 684
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint nr_irqs = NR_IRQS;\nstatic DEFINE_MUTEX(sparse_irq_lock);\n\nvoid irq_free_descs(unsigned int from, unsigned int cnt)\n{\n\tint i;\n\n\tif (from >= nr_irqs || (from + cnt) > nr_irqs)\n\t\treturn;\n\n\tmutex_lock(&sparse_irq_lock);\n\tfor (i = 0; i < cnt; i++)\n\t\tfree_desc(from + i);\n\n\tbitmap_clear(allocated_irqs, from, cnt);\n\tmutex_unlock(&sparse_irq_lock);\n}"
  },
  {
    "function_name": "__handle_domain_irq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "639-667",
    "snippet": "int __handle_domain_irq(struct irq_domain *domain, unsigned int hwirq,\n\t\t\tbool lookup, struct pt_regs *regs)\n{\n\tstruct pt_regs *old_regs = set_irq_regs(regs);\n\tunsigned int irq = hwirq;\n\tint ret = 0;\n\n\tirq_enter();\n\n#ifdef CONFIG_IRQ_DOMAIN\n\tif (lookup)\n\t\tirq = irq_find_mapping(domain, hwirq);\n#endif\n\n\t/*\n\t * Some hardware gives randomly wrong interrupts.  Rather\n\t * than crashing, do something sensible.\n\t */\n\tif (unlikely(!irq || irq >= nr_irqs)) {\n\t\tack_bad_irq(irq);\n\t\tret = -EINVAL;\n\t} else {\n\t\tgeneric_handle_irq(irq);\n\t}\n\n\tirq_exit();\n\tset_irq_regs(old_regs);\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int nr_irqs = NR_IRQS;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_irq_regs",
          "args": [
            "old_regs"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_exit",
          "args": [],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "irq_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/softirq.c",
          "lines": "403-418",
          "snippet": "void irq_exit(void)\n{\n#ifndef __ARCH_IRQ_EXIT_IRQS_DISABLED\n\tlocal_irq_disable();\n#else\n\tlockdep_assert_irqs_disabled();\n#endif\n\taccount_irq_exit_time(current);\n\tpreempt_count_sub(HARDIRQ_OFFSET);\n\tif (!in_interrupt() && local_softirq_pending())\n\t\tinvoke_softirq();\n\n\ttick_irq_exit();\n\trcu_irq_exit();\n\ttrace_hardirq_exit(); /* must be last! */\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\nvoid irq_exit(void)\n{\n#ifndef __ARCH_IRQ_EXIT_IRQS_DISABLED\n\tlocal_irq_disable();\n#else\n\tlockdep_assert_irqs_disabled();\n#endif\n\taccount_irq_exit_time(current);\n\tpreempt_count_sub(HARDIRQ_OFFSET);\n\tif (!in_interrupt() && local_softirq_pending())\n\t\tinvoke_softirq();\n\n\ttick_irq_exit();\n\trcu_irq_exit();\n\ttrace_hardirq_exit(); /* must be last! */\n}"
        }
      },
      {
        "call_info": {
          "callee": "generic_handle_irq",
          "args": [
            "irq"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "generic_handle_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "618-626",
          "snippet": "int generic_handle_irq(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tgeneric_handle_irq_desc(desc);\n\treturn 0;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint generic_handle_irq(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tgeneric_handle_irq_desc(desc);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ack_bad_irq",
          "args": [
            "irq"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!irq || irq >= nr_irqs"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_find_mapping",
          "args": [
            "domain",
            "hwirq"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "irq_find_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdomain.c",
          "lines": "874-899",
          "snippet": "unsigned int irq_find_mapping(struct irq_domain *domain,\n\t\t\t      irq_hw_number_t hwirq)\n{\n\tstruct irq_data *data;\n\n\t/* Look for default domain if nececssary */\n\tif (domain == NULL)\n\t\tdomain = irq_default_domain;\n\tif (domain == NULL)\n\t\treturn 0;\n\n\tif (hwirq < domain->revmap_direct_max_irq) {\n\t\tdata = irq_domain_get_irq_data(domain, hwirq);\n\t\tif (data && data->hwirq == hwirq)\n\t\t\treturn hwirq;\n\t}\n\n\t/* Check if the hwirq is in the linear revmap. */\n\tif (hwirq < domain->revmap_size)\n\t\treturn domain->linear_revmap[hwirq];\n\n\trcu_read_lock();\n\tdata = radix_tree_lookup(&domain->revmap_tree, hwirq);\n\trcu_read_unlock();\n\treturn data ? data->irq : 0;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct irq_domain *irq_default_domain;",
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic struct irq_domain *irq_default_domain;\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nunsigned int irq_find_mapping(struct irq_domain *domain,\n\t\t\t      irq_hw_number_t hwirq)\n{\n\tstruct irq_data *data;\n\n\t/* Look for default domain if nececssary */\n\tif (domain == NULL)\n\t\tdomain = irq_default_domain;\n\tif (domain == NULL)\n\t\treturn 0;\n\n\tif (hwirq < domain->revmap_direct_max_irq) {\n\t\tdata = irq_domain_get_irq_data(domain, hwirq);\n\t\tif (data && data->hwirq == hwirq)\n\t\t\treturn hwirq;\n\t}\n\n\t/* Check if the hwirq is in the linear revmap. */\n\tif (hwirq < domain->revmap_size)\n\t\treturn domain->linear_revmap[hwirq];\n\n\trcu_read_lock();\n\tdata = radix_tree_lookup(&domain->revmap_tree, hwirq);\n\trcu_read_unlock();\n\treturn data ? data->irq : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_enter",
          "args": [],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "irq_enter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/softirq.c",
          "lines": "345-359",
          "snippet": "void irq_enter(void)\n{\n\trcu_irq_enter();\n\tif (is_idle_task(current) && !in_interrupt()) {\n\t\t/*\n\t\t * Prevent raise_softirq from needlessly waking up ksoftirqd\n\t\t * here, as softirq will be serviced on return from interrupt.\n\t\t */\n\t\tlocal_bh_disable();\n\t\ttick_irq_enter();\n\t\t_local_bh_enable();\n\t}\n\n\t__irq_enter();\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\nvoid irq_enter(void)\n{\n\trcu_irq_enter();\n\tif (is_idle_task(current) && !in_interrupt()) {\n\t\t/*\n\t\t * Prevent raise_softirq from needlessly waking up ksoftirqd\n\t\t * here, as softirq will be serviced on return from interrupt.\n\t\t */\n\t\tlocal_bh_disable();\n\t\ttick_irq_enter();\n\t\t_local_bh_enable();\n\t}\n\n\t__irq_enter();\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_irq_regs",
          "args": [
            "regs"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint nr_irqs = NR_IRQS;\n\nint __handle_domain_irq(struct irq_domain *domain, unsigned int hwirq,\n\t\t\tbool lookup, struct pt_regs *regs)\n{\n\tstruct pt_regs *old_regs = set_irq_regs(regs);\n\tunsigned int irq = hwirq;\n\tint ret = 0;\n\n\tirq_enter();\n\n#ifdef CONFIG_IRQ_DOMAIN\n\tif (lookup)\n\t\tirq = irq_find_mapping(domain, hwirq);\n#endif\n\n\t/*\n\t * Some hardware gives randomly wrong interrupts.  Rather\n\t * than crashing, do something sensible.\n\t */\n\tif (unlikely(!irq || irq >= nr_irqs)) {\n\t\tack_bad_irq(irq);\n\t\tret = -EINVAL;\n\t} else {\n\t\tgeneric_handle_irq(irq);\n\t}\n\n\tirq_exit();\n\tset_irq_regs(old_regs);\n\treturn ret;\n}"
  },
  {
    "function_name": "generic_handle_irq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "618-626",
    "snippet": "int generic_handle_irq(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tgeneric_handle_irq_desc(desc);\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "generic_handle_irq_desc",
          "args": [
            "desc"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_to_desc",
          "args": [
            "irq"
          ],
          "line": 620
        },
        "resolved": true,
        "details": {
          "function_name": "irq_to_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "561-564",
          "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint generic_handle_irq(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tgeneric_handle_irq_desc(desc);\n\treturn 0;\n}"
  },
  {
    "function_name": "irq_init_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "605-608",
    "snippet": "void irq_init_desc(unsigned int irq)\n{\n\tfree_desc(irq);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_desc",
          "args": [
            "irq"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "free_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "567-575",
          "snippet": "static void free_desc(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&desc->lock, flags);\n\tdesc_set_defaults(irq, desc, irq_desc_get_node(desc), NULL, NULL);\n\traw_spin_unlock_irqrestore(&desc->lock, flags);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void free_desc(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&desc->lock, flags);\n\tdesc_set_defaults(irq, desc, irq_desc_get_node(desc), NULL, NULL);\n\traw_spin_unlock_irqrestore(&desc->lock, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nvoid irq_init_desc(unsigned int irq)\n{\n\tfree_desc(irq);\n}"
  },
  {
    "function_name": "irq_mark_irq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "597-602",
    "snippet": "void irq_mark_irq(unsigned int irq)\n{\n\tmutex_lock(&sparse_irq_lock);\n\tbitmap_set(allocated_irqs, irq, 1);\n\tmutex_unlock(&sparse_irq_lock);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(sparse_irq_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sparse_irq_lock"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bitmap_set",
          "args": [
            "allocated_irqs",
            "irq",
            "1"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sparse_irq_lock"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic DEFINE_MUTEX(sparse_irq_lock);\n\nvoid irq_mark_irq(unsigned int irq)\n{\n\tmutex_lock(&sparse_irq_lock);\n\tbitmap_set(allocated_irqs, irq, 1);\n\tmutex_unlock(&sparse_irq_lock);\n}"
  },
  {
    "function_name": "irq_expand_nr_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "592-595",
    "snippet": "static int irq_expand_nr_irqs(unsigned int nr)\n{\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic int irq_expand_nr_irqs(unsigned int nr)\n{\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "alloc_descs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "577-590",
    "snippet": "static inline int alloc_descs(unsigned int start, unsigned int cnt, int node,\n\t\t\t      const struct cpumask *affinity,\n\t\t\t      struct module *owner)\n{\n\tu32 i;\n\n\tfor (i = 0; i < cnt; i++) {\n\t\tstruct irq_desc *desc = irq_to_desc(start + i);\n\n\t\tdesc->owner = owner;\n\t}\n\tbitmap_set(allocated_irqs, start, cnt);\n\treturn start;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bitmap_set",
          "args": [
            "allocated_irqs",
            "start",
            "cnt"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_to_desc",
          "args": [
            "start + i"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "irq_to_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "561-564",
          "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic inline int alloc_descs(unsigned int start, unsigned int cnt, int node,\n\t\t\t      const struct cpumask *affinity,\n\t\t\t      struct module *owner)\n{\n\tu32 i;\n\n\tfor (i = 0; i < cnt; i++) {\n\t\tstruct irq_desc *desc = irq_to_desc(start + i);\n\n\t\tdesc->owner = owner;\n\t}\n\tbitmap_set(allocated_irqs, start, cnt);\n\treturn start;\n}"
  },
  {
    "function_name": "free_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "567-575",
    "snippet": "static void free_desc(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&desc->lock, flags);\n\tdesc_set_defaults(irq, desc, irq_desc_get_node(desc), NULL, NULL);\n\traw_spin_unlock_irqrestore(&desc->lock, flags);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&desc->lock",
            "flags"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "desc_set_defaults",
          "args": [
            "irq",
            "desc",
            "irq_desc_get_node(desc)",
            "NULL",
            "NULL"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "desc_set_defaults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "103-127",
          "snippet": "static void desc_set_defaults(unsigned int irq, struct irq_desc *desc, int node,\n\t\t\t      const struct cpumask *affinity, struct module *owner)\n{\n\tint cpu;\n\n\tdesc->irq_common_data.handler_data = NULL;\n\tdesc->irq_common_data.msi_desc = NULL;\n\n\tdesc->irq_data.common = &desc->irq_common_data;\n\tdesc->irq_data.irq = irq;\n\tdesc->irq_data.chip = &no_irq_chip;\n\tdesc->irq_data.chip_data = NULL;\n\tirq_settings_clr_and_set(desc, ~0, _IRQ_DEFAULT_INIT_FLAGS);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_DISABLED);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_MASKED);\n\tdesc->handle_irq = handle_bad_irq;\n\tdesc->depth = 1;\n\tdesc->irq_count = 0;\n\tdesc->irqs_unhandled = 0;\n\tdesc->name = NULL;\n\tdesc->owner = owner;\n\tfor_each_possible_cpu(cpu)\n\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) = 0;\n\tdesc_smp_init(desc, node, affinity);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void desc_set_defaults(unsigned int irq, struct irq_desc *desc, int node,\n\t\t\t      const struct cpumask *affinity, struct module *owner)\n{\n\tint cpu;\n\n\tdesc->irq_common_data.handler_data = NULL;\n\tdesc->irq_common_data.msi_desc = NULL;\n\n\tdesc->irq_data.common = &desc->irq_common_data;\n\tdesc->irq_data.irq = irq;\n\tdesc->irq_data.chip = &no_irq_chip;\n\tdesc->irq_data.chip_data = NULL;\n\tirq_settings_clr_and_set(desc, ~0, _IRQ_DEFAULT_INIT_FLAGS);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_DISABLED);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_MASKED);\n\tdesc->handle_irq = handle_bad_irq;\n\tdesc->depth = 1;\n\tdesc->irq_count = 0;\n\tdesc->irqs_unhandled = 0;\n\tdesc->name = NULL;\n\tdesc->owner = owner;\n\tfor_each_possible_cpu(cpu)\n\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) = 0;\n\tdesc_smp_init(desc, node, affinity);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_desc_get_node",
          "args": [
            "desc"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "irq_desc_get_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/internals.h",
          "lines": "251-254",
          "snippet": "static inline int irq_desc_get_node(struct irq_desc *desc)\n{\n\treturn irq_common_data_get_node(&desc->irq_common_data);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void __disable_irq(struct irq_desc *desc);",
            "extern void __enable_irq(struct irq_desc *desc);",
            "extern int irq_activate(struct irq_desc *desc);",
            "extern void irq_shutdown(struct irq_desc *desc);",
            "extern void irq_enable(struct irq_desc *desc);",
            "extern void irq_disable(struct irq_desc *desc);",
            "extern void mask_irq(struct irq_desc *desc);",
            "extern void unmask_irq(struct irq_desc *desc);",
            "extern void unmask_threaded_irq(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event(struct irq_desc *desc);",
            "void check_irq_resend(struct irq_desc *desc);",
            "bool irq_wait_for_poll(struct irq_desc *desc);",
            "extern void irq_set_thread_affinity(struct irq_desc *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nextern void __disable_irq(struct irq_desc *desc);\nextern void __enable_irq(struct irq_desc *desc);\nextern int irq_activate(struct irq_desc *desc);\nextern void irq_shutdown(struct irq_desc *desc);\nextern void irq_enable(struct irq_desc *desc);\nextern void irq_disable(struct irq_desc *desc);\nextern void mask_irq(struct irq_desc *desc);\nextern void unmask_irq(struct irq_desc *desc);\nextern void unmask_threaded_irq(struct irq_desc *desc);\nirqreturn_t handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event(struct irq_desc *desc);\nvoid check_irq_resend(struct irq_desc *desc);\nbool irq_wait_for_poll(struct irq_desc *desc);\nextern void irq_set_thread_affinity(struct irq_desc *desc);\n\nstatic inline int irq_desc_get_node(struct irq_desc *desc)\n{\n\treturn irq_common_data_get_node(&desc->irq_common_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&desc->lock",
            "flags"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_to_desc",
          "args": [
            "irq"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "irq_to_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "561-564",
          "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void free_desc(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&desc->lock, flags);\n\tdesc_set_defaults(irq, desc, irq_desc_get_node(desc), NULL, NULL);\n\traw_spin_unlock_irqrestore(&desc->lock, flags);\n}"
  },
  {
    "function_name": "irq_to_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "561-564",
    "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}"
  },
  {
    "function_name": "early_irq_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "539-559",
    "snippet": "int __init early_irq_init(void)\n{\n\tint count, i, node = first_online_node;\n\tstruct irq_desc *desc;\n\n\tinit_irq_default_affinity();\n\n\tprintk(KERN_INFO \"NR_IRQS: %d\\n\", NR_IRQS);\n\n\tdesc = irq_desc;\n\tcount = ARRAY_SIZE(irq_desc);\n\n\tfor (i = 0; i < count; i++) {\n\t\tdesc[i].kstat_irqs = alloc_percpu(unsigned int);\n\t\talloc_masks(&desc[i], node);\n\t\traw_spin_lock_init(&desc[i].lock);\n\t\tlockdep_set_class(&desc[i].lock, &irq_desc_lock_class);\n\t\tdesc_set_defaults(i, &desc[i], node, NULL, NULL);\n\t}\n\treturn arch_early_irq_init();\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct lock_class_key irq_desc_lock_class;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "arch_early_irq_init",
          "args": [],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "arch_early_irq_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/softirq.c",
          "lines": "756-759",
          "snippet": "__weak arch_early_irq_init(void)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\n__weak arch_early_irq_init(void)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "desc_set_defaults",
          "args": [
            "i",
            "&desc[i]",
            "node",
            "NULL",
            "NULL"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "desc_set_defaults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "103-127",
          "snippet": "static void desc_set_defaults(unsigned int irq, struct irq_desc *desc, int node,\n\t\t\t      const struct cpumask *affinity, struct module *owner)\n{\n\tint cpu;\n\n\tdesc->irq_common_data.handler_data = NULL;\n\tdesc->irq_common_data.msi_desc = NULL;\n\n\tdesc->irq_data.common = &desc->irq_common_data;\n\tdesc->irq_data.irq = irq;\n\tdesc->irq_data.chip = &no_irq_chip;\n\tdesc->irq_data.chip_data = NULL;\n\tirq_settings_clr_and_set(desc, ~0, _IRQ_DEFAULT_INIT_FLAGS);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_DISABLED);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_MASKED);\n\tdesc->handle_irq = handle_bad_irq;\n\tdesc->depth = 1;\n\tdesc->irq_count = 0;\n\tdesc->irqs_unhandled = 0;\n\tdesc->name = NULL;\n\tdesc->owner = owner;\n\tfor_each_possible_cpu(cpu)\n\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) = 0;\n\tdesc_smp_init(desc, node, affinity);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void desc_set_defaults(unsigned int irq, struct irq_desc *desc, int node,\n\t\t\t      const struct cpumask *affinity, struct module *owner)\n{\n\tint cpu;\n\n\tdesc->irq_common_data.handler_data = NULL;\n\tdesc->irq_common_data.msi_desc = NULL;\n\n\tdesc->irq_data.common = &desc->irq_common_data;\n\tdesc->irq_data.irq = irq;\n\tdesc->irq_data.chip = &no_irq_chip;\n\tdesc->irq_data.chip_data = NULL;\n\tirq_settings_clr_and_set(desc, ~0, _IRQ_DEFAULT_INIT_FLAGS);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_DISABLED);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_MASKED);\n\tdesc->handle_irq = handle_bad_irq;\n\tdesc->depth = 1;\n\tdesc->irq_count = 0;\n\tdesc->irqs_unhandled = 0;\n\tdesc->name = NULL;\n\tdesc->owner = owner;\n\tfor_each_possible_cpu(cpu)\n\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) = 0;\n\tdesc_smp_init(desc, node, affinity);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_set_class",
          "args": [
            "&desc[i].lock",
            "&irq_desc_lock_class"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_init",
          "args": [
            "&desc[i].lock"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_masks",
          "args": [
            "&desc[i]",
            "node"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_masks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "97-98",
          "snippet": "static inline int\nalloc_masks(struct irq_desc *desc, int node) { return 0; }",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic inline int\nalloc_masks(struct irq_desc *desc, int node) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "alloc_percpu",
          "args": [
            "unsignedint"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_array_alloc_percpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/arraymap.c",
          "lines": "37-54",
          "snippet": "static int bpf_array_alloc_percpu(struct bpf_array *array)\n{\n\tvoid __percpu *ptr;\n\tint i;\n\n\tfor (i = 0; i < array->map.max_entries; i++) {\n\t\tptr = __alloc_percpu_gfp(array->elem_size, 8,\n\t\t\t\t\t GFP_USER | __GFP_NOWARN);\n\t\tif (!ptr) {\n\t\t\tbpf_array_free_percpu(array);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tarray->pptrs[i] = ptr;\n\t\tcond_resched();\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"map_in_map.h\"",
            "#include <uapi/linux/btf.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/filter.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map_in_map.h\"\n#include <uapi/linux/btf.h>\n#include <linux/perf_event.h>\n#include <linux/filter.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n\nstatic int bpf_array_alloc_percpu(struct bpf_array *array)\n{\n\tvoid __percpu *ptr;\n\tint i;\n\n\tfor (i = 0; i < array->map.max_entries; i++) {\n\t\tptr = __alloc_percpu_gfp(array->elem_size, 8,\n\t\t\t\t\t GFP_USER | __GFP_NOWARN);\n\t\tif (!ptr) {\n\t\t\tbpf_array_free_percpu(array);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tarray->pptrs[i] = ptr;\n\t\tcond_resched();\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "irq_desc"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"NR_IRQS: %d\\n\"",
            "NR_IRQS"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "__warn_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/panic.c",
          "lines": "590-599",
          "snippet": "void __warn_printk(const char *fmt, ...)\n{\n\tva_list args;\n\n\tpr_warn(CUT_HERE);\n\n\tva_start(args, fmt);\n\tvprintk(fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nvoid __warn_printk(const char *fmt, ...)\n{\n\tva_list args;\n\n\tpr_warn(CUT_HERE);\n\n\tva_start(args, fmt);\n\tvprintk(fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_irq_default_affinity",
          "args": [],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "init_irq_default_affinity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "49-51",
          "snippet": "static void __init init_irq_default_affinity(void)\n{\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void __init init_irq_default_affinity(void)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic struct lock_class_key irq_desc_lock_class;\n\nint __init early_irq_init(void)\n{\n\tint count, i, node = first_online_node;\n\tstruct irq_desc *desc;\n\n\tinit_irq_default_affinity();\n\n\tprintk(KERN_INFO \"NR_IRQS: %d\\n\", NR_IRQS);\n\n\tdesc = irq_desc;\n\tcount = ARRAY_SIZE(irq_desc);\n\n\tfor (i = 0; i < count; i++) {\n\t\tdesc[i].kstat_irqs = alloc_percpu(unsigned int);\n\t\talloc_masks(&desc[i], node);\n\t\traw_spin_lock_init(&desc[i].lock);\n\t\tlockdep_set_class(&desc[i].lock, &irq_desc_lock_class);\n\t\tdesc_set_defaults(i, &desc[i], node, NULL, NULL);\n\t}\n\treturn arch_early_irq_init();\n}"
  },
  {
    "function_name": "early_irq_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "500-527",
    "snippet": "int __init early_irq_init(void)\n{\n\tint i, initcnt, node = first_online_node;\n\tstruct irq_desc *desc;\n\n\tinit_irq_default_affinity();\n\n\t/* Let arch update nr_irqs and return the nr of preallocated irqs */\n\tinitcnt = arch_probe_nr_irqs();\n\tprintk(KERN_INFO \"NR_IRQS: %d, nr_irqs: %d, preallocated irqs: %d\\n\",\n\t       NR_IRQS, nr_irqs, initcnt);\n\n\tif (WARN_ON(nr_irqs > IRQ_BITMAP_BITS))\n\t\tnr_irqs = IRQ_BITMAP_BITS;\n\n\tif (WARN_ON(initcnt > IRQ_BITMAP_BITS))\n\t\tinitcnt = IRQ_BITMAP_BITS;\n\n\tif (initcnt > nr_irqs)\n\t\tnr_irqs = initcnt;\n\n\tfor (i = 0; i < initcnt; i++) {\n\t\tdesc = alloc_desc(i, node, 0, NULL, NULL);\n\t\tset_bit(i, allocated_irqs);\n\t\tirq_insert_desc(i, desc);\n\t}\n\treturn arch_early_irq_init();\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int nr_irqs = NR_IRQS;",
      "static DECLARE_BITMAP(allocated_irqs, IRQ_BITMAP_BITS);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "arch_early_irq_init",
          "args": [],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "arch_early_irq_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/softirq.c",
          "lines": "756-759",
          "snippet": "__weak arch_early_irq_init(void)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\n__weak arch_early_irq_init(void)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_insert_desc",
          "args": [
            "i",
            "desc"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "irq_insert_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "331-334",
          "snippet": "static void irq_insert_desc(unsigned int irq, struct irq_desc *desc)\n{\n\tradix_tree_insert(&irq_desc_tree, irq, desc);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void irq_insert_desc(unsigned int irq, struct irq_desc *desc)\n{\n\tradix_tree_insert(&irq_desc_tree, irq, desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "i",
            "allocated_irqs"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "mem_bm_set_bit_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/snapshot.c",
          "lines": "779-790",
          "snippet": "static int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_desc",
          "args": [
            "i",
            "node",
            "0",
            "NULL",
            "NULL"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_descs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "577-590",
          "snippet": "static inline int alloc_descs(unsigned int start, unsigned int cnt, int node,\n\t\t\t      const struct cpumask *affinity,\n\t\t\t      struct module *owner)\n{\n\tu32 i;\n\n\tfor (i = 0; i < cnt; i++) {\n\t\tstruct irq_desc *desc = irq_to_desc(start + i);\n\n\t\tdesc->owner = owner;\n\t}\n\tbitmap_set(allocated_irqs, start, cnt);\n\treturn start;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic inline int alloc_descs(unsigned int start, unsigned int cnt, int node,\n\t\t\t      const struct cpumask *affinity,\n\t\t\t      struct module *owner)\n{\n\tu32 i;\n\n\tfor (i = 0; i < cnt; i++) {\n\t\tstruct irq_desc *desc = irq_to_desc(start + i);\n\n\t\tdesc->owner = owner;\n\t}\n\tbitmap_set(allocated_irqs, start, cnt);\n\treturn start;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "initcnt > IRQ_BITMAP_BITS"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "nr_irqs > IRQ_BITMAP_BITS"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_INFO \"NR_IRQS: %d, nr_irqs: %d, preallocated irqs: %d\\n\"",
            "NR_IRQS",
            "nr_irqs",
            "initcnt"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "__warn_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/panic.c",
          "lines": "590-599",
          "snippet": "void __warn_printk(const char *fmt, ...)\n{\n\tva_list args;\n\n\tpr_warn(CUT_HERE);\n\n\tva_start(args, fmt);\n\tvprintk(fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nvoid __warn_printk(const char *fmt, ...)\n{\n\tva_list args;\n\n\tpr_warn(CUT_HERE);\n\n\tva_start(args, fmt);\n\tvprintk(fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "arch_probe_nr_irqs",
          "args": [],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "arch_probe_nr_irqs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/softirq.c",
          "lines": "751-754",
          "snippet": "__weak arch_probe_nr_irqs(void)\n{\n\treturn NR_IRQS_LEGACY;\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\n__weak arch_probe_nr_irqs(void)\n{\n\treturn NR_IRQS_LEGACY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_irq_default_affinity",
          "args": [],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "init_irq_default_affinity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "49-51",
          "snippet": "static void __init init_irq_default_affinity(void)\n{\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void __init init_irq_default_affinity(void)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint nr_irqs = NR_IRQS;\nstatic DECLARE_BITMAP(allocated_irqs, IRQ_BITMAP_BITS);\n\nint __init early_irq_init(void)\n{\n\tint i, initcnt, node = first_online_node;\n\tstruct irq_desc *desc;\n\n\tinit_irq_default_affinity();\n\n\t/* Let arch update nr_irqs and return the nr of preallocated irqs */\n\tinitcnt = arch_probe_nr_irqs();\n\tprintk(KERN_INFO \"NR_IRQS: %d, nr_irqs: %d, preallocated irqs: %d\\n\",\n\t       NR_IRQS, nr_irqs, initcnt);\n\n\tif (WARN_ON(nr_irqs > IRQ_BITMAP_BITS))\n\t\tnr_irqs = IRQ_BITMAP_BITS;\n\n\tif (WARN_ON(initcnt > IRQ_BITMAP_BITS))\n\t\tinitcnt = IRQ_BITMAP_BITS;\n\n\tif (initcnt > nr_irqs)\n\t\tnr_irqs = initcnt;\n\n\tfor (i = 0; i < initcnt; i++) {\n\t\tdesc = alloc_desc(i, node, 0, NULL, NULL);\n\t\tset_bit(i, allocated_irqs);\n\t\tirq_insert_desc(i, desc);\n\t}\n\treturn arch_early_irq_init();\n}"
  },
  {
    "function_name": "irq_expand_nr_irqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "492-498",
    "snippet": "static int irq_expand_nr_irqs(unsigned int nr)\n{\n\tif (nr > IRQ_BITMAP_BITS)\n\t\treturn -ENOMEM;\n\tnr_irqs = nr;\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int nr_irqs = NR_IRQS;",
      "static DECLARE_BITMAP(allocated_irqs, IRQ_BITMAP_BITS);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nint nr_irqs = NR_IRQS;\nstatic DECLARE_BITMAP(allocated_irqs, IRQ_BITMAP_BITS);\n\nstatic int irq_expand_nr_irqs(unsigned int nr)\n{\n\tif (nr > IRQ_BITMAP_BITS)\n\t\treturn -ENOMEM;\n\tnr_irqs = nr;\n\treturn 0;\n}"
  },
  {
    "function_name": "alloc_descs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "451-490",
    "snippet": "static int alloc_descs(unsigned int start, unsigned int cnt, int node,\n\t\t       const struct cpumask *affinity, struct module *owner)\n{\n\tconst struct cpumask *mask = NULL;\n\tstruct irq_desc *desc;\n\tunsigned int flags;\n\tint i;\n\n\t/* Validate affinity mask(s) */\n\tif (affinity) {\n\t\tfor (i = 0, mask = affinity; i < cnt; i++, mask++) {\n\t\t\tif (cpumask_empty(mask))\n\t\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\tflags = affinity ? IRQD_AFFINITY_MANAGED | IRQD_MANAGED_SHUTDOWN : 0;\n\tmask = NULL;\n\n\tfor (i = 0; i < cnt; i++) {\n\t\tif (affinity) {\n\t\t\tnode = cpu_to_node(cpumask_first(affinity));\n\t\t\tmask = affinity;\n\t\t\taffinity++;\n\t\t}\n\t\tdesc = alloc_desc(start + i, node, flags, mask, owner);\n\t\tif (!desc)\n\t\t\tgoto err;\n\t\tirq_insert_desc(start + i, desc);\n\t\tirq_sysfs_add(start + i, desc);\n\t\tirq_add_debugfs_entry(start + i, desc);\n\t}\n\tbitmap_set(allocated_irqs, start, cnt);\n\treturn start;\n\nerr:\n\tfor (i--; i >= 0; i--)\n\t\tfree_desc(start + i);\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_desc",
          "args": [
            "start + i"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "free_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "567-575",
          "snippet": "static void free_desc(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&desc->lock, flags);\n\tdesc_set_defaults(irq, desc, irq_desc_get_node(desc), NULL, NULL);\n\traw_spin_unlock_irqrestore(&desc->lock, flags);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void free_desc(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&desc->lock, flags);\n\tdesc_set_defaults(irq, desc, irq_desc_get_node(desc), NULL, NULL);\n\traw_spin_unlock_irqrestore(&desc->lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bitmap_set",
          "args": [
            "allocated_irqs",
            "start",
            "cnt"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_add_debugfs_entry",
          "args": [
            "start + i",
            "desc"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "irq_add_debugfs_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/internals.h",
          "lines": "472-474",
          "snippet": "static inline void irq_add_debugfs_entry(unsigned int irq, struct irq_desc *d)\n{\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern bool irq_can_set_affinity_usr(unsigned int irq);",
            "extern int irq_select_affinity_usr(unsigned int irq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nextern bool irq_can_set_affinity_usr(unsigned int irq);\nextern int irq_select_affinity_usr(unsigned int irq);\n\nstatic inline void irq_add_debugfs_entry(unsigned int irq, struct irq_desc *d)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_sysfs_add",
          "args": [
            "start + i",
            "desc"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "irq_sysfs_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "325-325",
          "snippet": "static void irq_sysfs_add(int irq, struct irq_desc *desc) {}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void irq_sysfs_add(int irq, struct irq_desc *desc) {}"
        }
      },
      {
        "call_info": {
          "callee": "irq_insert_desc",
          "args": [
            "start + i",
            "desc"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "irq_insert_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "331-334",
          "snippet": "static void irq_insert_desc(unsigned int irq, struct irq_desc *desc)\n{\n\tradix_tree_insert(&irq_desc_tree, irq, desc);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void irq_insert_desc(unsigned int irq, struct irq_desc *desc)\n{\n\tradix_tree_insert(&irq_desc_tree, irq, desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_desc",
          "args": [
            "start + i",
            "node",
            "flags",
            "mask",
            "owner"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_descs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "577-590",
          "snippet": "static inline int alloc_descs(unsigned int start, unsigned int cnt, int node,\n\t\t\t      const struct cpumask *affinity,\n\t\t\t      struct module *owner)\n{\n\tu32 i;\n\n\tfor (i = 0; i < cnt; i++) {\n\t\tstruct irq_desc *desc = irq_to_desc(start + i);\n\n\t\tdesc->owner = owner;\n\t}\n\tbitmap_set(allocated_irqs, start, cnt);\n\treturn start;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpumask_first(affinity)"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_first",
          "args": [
            "affinity"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "mask"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic int alloc_descs(unsigned int start, unsigned int cnt, int node,\n\t\t       const struct cpumask *affinity, struct module *owner)\n{\n\tconst struct cpumask *mask = NULL;\n\tstruct irq_desc *desc;\n\tunsigned int flags;\n\tint i;\n\n\t/* Validate affinity mask(s) */\n\tif (affinity) {\n\t\tfor (i = 0, mask = affinity; i < cnt; i++, mask++) {\n\t\t\tif (cpumask_empty(mask))\n\t\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\tflags = affinity ? IRQD_AFFINITY_MANAGED | IRQD_MANAGED_SHUTDOWN : 0;\n\tmask = NULL;\n\n\tfor (i = 0; i < cnt; i++) {\n\t\tif (affinity) {\n\t\t\tnode = cpu_to_node(cpumask_first(affinity));\n\t\t\tmask = affinity;\n\t\t\taffinity++;\n\t\t}\n\t\tdesc = alloc_desc(start + i, node, flags, mask, owner);\n\t\tif (!desc)\n\t\t\tgoto err;\n\t\tirq_insert_desc(start + i, desc);\n\t\tirq_sysfs_add(start + i, desc);\n\t\tirq_add_debugfs_entry(start + i, desc);\n\t}\n\tbitmap_set(allocated_irqs, start, cnt);\n\treturn start;\n\nerr:\n\tfor (i--; i >= 0; i--)\n\t\tfree_desc(start + i);\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "free_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "423-449",
    "snippet": "static void free_desc(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tirq_remove_debugfs_entry(desc);\n\tunregister_irq_proc(irq, desc);\n\n\t/*\n\t * sparse_irq_lock protects also show_interrupts() and\n\t * kstat_irq_usr(). Once we deleted the descriptor from the\n\t * sparse tree we can free it. Access in proc will fail to\n\t * lookup the descriptor.\n\t *\n\t * The sysfs entry must be serialized against a concurrent\n\t * irq_sysfs_init() as well.\n\t */\n\tkobject_del(&desc->kobj);\n\tdelete_irq_desc(irq);\n\n\t/*\n\t * We free the descriptor, masks and stat fields via RCU. That\n\t * allows demultiplex interrupts to do rcu based management of\n\t * the child interrupts.\n\t * This also allows us to use rcu in kstat_irqs_usr().\n\t */\n\tcall_rcu(&desc->rcu, delayed_free_desc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(sparse_irq_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_rcu",
          "args": [
            "&desc->rcu",
            "delayed_free_desc"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "call_rcu_tasks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/update.c",
          "lines": "552-567",
          "snippet": "void call_rcu_tasks(struct rcu_head *rhp, rcu_callback_t func)\n{\n\tunsigned long flags;\n\tbool needwake;\n\n\trhp->next = NULL;\n\trhp->func = func;\n\traw_spin_lock_irqsave(&rcu_tasks_cbs_lock, flags);\n\tneedwake = !rcu_tasks_cbs_head;\n\t*rcu_tasks_cbs_tail = rhp;\n\trcu_tasks_cbs_tail = &rhp->next;\n\traw_spin_unlock_irqrestore(&rcu_tasks_cbs_lock, flags);\n\t/* We can't create the thread unless interrupts are enabled. */\n\tif (needwake && READ_ONCE(rcu_tasks_kthread_ptr))\n\t\twake_up(&rcu_tasks_cbs_wq);\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include <linux/sched/isolation.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/tick.h>",
            "#include <linux/kthread.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/export.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include <linux/sched/isolation.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/tick.h>\n#include <linux/kthread.h>\n#include <linux/moduleparam.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/export.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid call_rcu_tasks(struct rcu_head *rhp, rcu_callback_t func)\n{\n\tunsigned long flags;\n\tbool needwake;\n\n\trhp->next = NULL;\n\trhp->func = func;\n\traw_spin_lock_irqsave(&rcu_tasks_cbs_lock, flags);\n\tneedwake = !rcu_tasks_cbs_head;\n\t*rcu_tasks_cbs_tail = rhp;\n\trcu_tasks_cbs_tail = &rhp->next;\n\traw_spin_unlock_irqrestore(&rcu_tasks_cbs_lock, flags);\n\t/* We can't create the thread unless interrupts are enabled. */\n\tif (needwake && READ_ONCE(rcu_tasks_kthread_ptr))\n\t\twake_up(&rcu_tasks_cbs_wq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "delete_irq_desc",
          "args": [
            "irq"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "delete_irq_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "342-345",
          "snippet": "static void delete_irq_desc(unsigned int irq)\n{\n\tradix_tree_delete(&irq_desc_tree, irq);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void delete_irq_desc(unsigned int irq)\n{\n\tradix_tree_delete(&irq_desc_tree, irq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_del",
          "args": [
            "&desc->kobj"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unregister_irq_proc",
          "args": [
            "irq",
            "desc"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_irq_proc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/internals.h",
          "lines": "115-115",
          "snippet": "static inline void unregister_irq_proc(unsigned int irq, struct irq_desc *desc) { }",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void __disable_irq(struct irq_desc *desc);",
            "extern void __enable_irq(struct irq_desc *desc);",
            "extern int irq_activate(struct irq_desc *desc);",
            "extern void irq_shutdown(struct irq_desc *desc);",
            "extern void irq_enable(struct irq_desc *desc);",
            "extern void irq_disable(struct irq_desc *desc);",
            "extern void mask_irq(struct irq_desc *desc);",
            "extern void unmask_irq(struct irq_desc *desc);",
            "extern void unmask_threaded_irq(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event(struct irq_desc *desc);",
            "void check_irq_resend(struct irq_desc *desc);",
            "bool irq_wait_for_poll(struct irq_desc *desc);",
            "extern bool irq_can_set_affinity_usr(unsigned int irq);",
            "extern int irq_select_affinity_usr(unsigned int irq);",
            "extern void irq_set_thread_affinity(struct irq_desc *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nextern void __disable_irq(struct irq_desc *desc);\nextern void __enable_irq(struct irq_desc *desc);\nextern int irq_activate(struct irq_desc *desc);\nextern void irq_shutdown(struct irq_desc *desc);\nextern void irq_enable(struct irq_desc *desc);\nextern void irq_disable(struct irq_desc *desc);\nextern void mask_irq(struct irq_desc *desc);\nextern void unmask_irq(struct irq_desc *desc);\nextern void unmask_threaded_irq(struct irq_desc *desc);\nirqreturn_t handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event(struct irq_desc *desc);\nvoid check_irq_resend(struct irq_desc *desc);\nbool irq_wait_for_poll(struct irq_desc *desc);\nextern bool irq_can_set_affinity_usr(unsigned int irq);\nextern int irq_select_affinity_usr(unsigned int irq);\nextern void irq_set_thread_affinity(struct irq_desc *desc);\n\nstatic inline void unregister_irq_proc(unsigned int irq, struct irq_desc *desc) { }"
        }
      },
      {
        "call_info": {
          "callee": "irq_remove_debugfs_entry",
          "args": [
            "desc"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "irq_remove_debugfs_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/internals.h",
          "lines": "475-477",
          "snippet": "static inline void irq_remove_debugfs_entry(struct irq_desc *d)\n{\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nstatic inline void irq_remove_debugfs_entry(struct irq_desc *d)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_to_desc",
          "args": [
            "irq"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "irq_to_desc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "561-564",
          "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn (irq < NR_IRQS) ? irq_desc + irq : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic DEFINE_MUTEX(sparse_irq_lock);\n\nstatic void free_desc(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tirq_remove_debugfs_entry(desc);\n\tunregister_irq_proc(irq, desc);\n\n\t/*\n\t * sparse_irq_lock protects also show_interrupts() and\n\t * kstat_irq_usr(). Once we deleted the descriptor from the\n\t * sparse tree we can free it. Access in proc will fail to\n\t * lookup the descriptor.\n\t *\n\t * The sysfs entry must be serialized against a concurrent\n\t * irq_sysfs_init() as well.\n\t */\n\tkobject_del(&desc->kobj);\n\tdelete_irq_desc(irq);\n\n\t/*\n\t * We free the descriptor, masks and stat fields via RCU. That\n\t * allows demultiplex interrupts to do rcu based management of\n\t * the child interrupts.\n\t * This also allows us to use rcu in kstat_irqs_usr().\n\t */\n\tcall_rcu(&desc->rcu, delayed_free_desc);\n}"
  },
  {
    "function_name": "delayed_free_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "416-421",
    "snippet": "static void delayed_free_desc(struct rcu_head *rhp)\n{\n\tstruct irq_desc *desc = container_of(rhp, struct irq_desc, rcu);\n\n\tkobject_put(&desc->kobj);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&desc->kobj"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "mod_kobject_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/module.c",
          "lines": "1742-1748",
          "snippet": "static void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "rhp",
            "structirq_desc",
            "rcu"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void delayed_free_desc(struct rcu_head *rhp)\n{\n\tstruct irq_desc *desc = container_of(rhp, struct irq_desc, rcu);\n\n\tkobject_put(&desc->kobj);\n}"
  },
  {
    "function_name": "irq_kobj_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "407-414",
    "snippet": "static void irq_kobj_release(struct kobject *kobj)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\n\tfree_masks(desc);\n\tfree_percpu(desc->kstat_irqs);\n\tkfree(desc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "desc"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_percpu",
          "args": [
            "desc->kstat_irqs"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_array_free_percpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/arraymap.c",
          "lines": "27-35",
          "snippet": "static void bpf_array_free_percpu(struct bpf_array *array)\n{\n\tint i;\n\n\tfor (i = 0; i < array->map.max_entries; i++) {\n\t\tfree_percpu(array->pptrs[i]);\n\t\tcond_resched();\n\t}\n}",
          "includes": [
            "#include \"map_in_map.h\"",
            "#include <uapi/linux/btf.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/filter.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map_in_map.h\"\n#include <uapi/linux/btf.h>\n#include <linux/perf_event.h>\n#include <linux/filter.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n\nstatic void bpf_array_free_percpu(struct bpf_array *array)\n{\n\tint i;\n\n\tfor (i = 0; i < array->map.max_entries; i++) {\n\t\tfree_percpu(array->pptrs[i]);\n\t\tcond_resched();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_masks",
          "args": [
            "desc"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "free_masks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "359-359",
          "snippet": "static inline void free_masks(struct irq_desc *desc) { }",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic inline void free_masks(struct irq_desc *desc) { }"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structirq_desc",
            "kobj"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void irq_kobj_release(struct kobject *kobj)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\n\tfree_masks(desc);\n\tfree_percpu(desc->kstat_irqs);\n\tkfree(desc);\n}"
  },
  {
    "function_name": "alloc_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "372-405",
    "snippet": "static struct irq_desc *alloc_desc(int irq, int node, unsigned int flags,\n\t\t\t\t   const struct cpumask *affinity,\n\t\t\t\t   struct module *owner)\n{\n\tstruct irq_desc *desc;\n\n\tdesc = kzalloc_node(sizeof(*desc), GFP_KERNEL, node);\n\tif (!desc)\n\t\treturn NULL;\n\t/* allocate based on nr_cpu_ids */\n\tdesc->kstat_irqs = alloc_percpu(unsigned int);\n\tif (!desc->kstat_irqs)\n\t\tgoto err_desc;\n\n\tif (alloc_masks(desc, node))\n\t\tgoto err_kstat;\n\n\traw_spin_lock_init(&desc->lock);\n\tlockdep_set_class(&desc->lock, &irq_desc_lock_class);\n\tmutex_init(&desc->request_mutex);\n\tinit_rcu_head(&desc->rcu);\n\n\tdesc_set_defaults(irq, desc, node, affinity, owner);\n\tirqd_set(&desc->irq_data, flags);\n\tkobject_init(&desc->kobj, &irq_kobj_type);\n\n\treturn desc;\n\nerr_kstat:\n\tfree_percpu(desc->kstat_irqs);\nerr_desc:\n\tkfree(desc);\n\treturn NULL;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct lock_class_key irq_desc_lock_class;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "desc"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_percpu",
          "args": [
            "desc->kstat_irqs"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_array_free_percpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/arraymap.c",
          "lines": "27-35",
          "snippet": "static void bpf_array_free_percpu(struct bpf_array *array)\n{\n\tint i;\n\n\tfor (i = 0; i < array->map.max_entries; i++) {\n\t\tfree_percpu(array->pptrs[i]);\n\t\tcond_resched();\n\t}\n}",
          "includes": [
            "#include \"map_in_map.h\"",
            "#include <uapi/linux/btf.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/filter.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map_in_map.h\"\n#include <uapi/linux/btf.h>\n#include <linux/perf_event.h>\n#include <linux/filter.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n\nstatic void bpf_array_free_percpu(struct bpf_array *array)\n{\n\tint i;\n\n\tfor (i = 0; i < array->map.max_entries; i++) {\n\t\tfree_percpu(array->pptrs[i]);\n\t\tcond_resched();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_init",
          "args": [
            "&desc->kobj",
            "&irq_kobj_type"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqd_set",
          "args": [
            "&desc->irq_data",
            "flags"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "irqd_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/internals.h",
          "lines": "223-226",
          "snippet": "static inline void irqd_set(struct irq_data *d, unsigned int mask)\n{\n\t__irqd_to_state(d) |= mask;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nstatic inline void irqd_set(struct irq_data *d, unsigned int mask)\n{\n\t__irqd_to_state(d) |= mask;\n}"
        }
      },
      {
        "call_info": {
          "callee": "desc_set_defaults",
          "args": [
            "irq",
            "desc",
            "node",
            "affinity",
            "owner"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "desc_set_defaults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "103-127",
          "snippet": "static void desc_set_defaults(unsigned int irq, struct irq_desc *desc, int node,\n\t\t\t      const struct cpumask *affinity, struct module *owner)\n{\n\tint cpu;\n\n\tdesc->irq_common_data.handler_data = NULL;\n\tdesc->irq_common_data.msi_desc = NULL;\n\n\tdesc->irq_data.common = &desc->irq_common_data;\n\tdesc->irq_data.irq = irq;\n\tdesc->irq_data.chip = &no_irq_chip;\n\tdesc->irq_data.chip_data = NULL;\n\tirq_settings_clr_and_set(desc, ~0, _IRQ_DEFAULT_INIT_FLAGS);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_DISABLED);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_MASKED);\n\tdesc->handle_irq = handle_bad_irq;\n\tdesc->depth = 1;\n\tdesc->irq_count = 0;\n\tdesc->irqs_unhandled = 0;\n\tdesc->name = NULL;\n\tdesc->owner = owner;\n\tfor_each_possible_cpu(cpu)\n\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) = 0;\n\tdesc_smp_init(desc, node, affinity);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void desc_set_defaults(unsigned int irq, struct irq_desc *desc, int node,\n\t\t\t      const struct cpumask *affinity, struct module *owner)\n{\n\tint cpu;\n\n\tdesc->irq_common_data.handler_data = NULL;\n\tdesc->irq_common_data.msi_desc = NULL;\n\n\tdesc->irq_data.common = &desc->irq_common_data;\n\tdesc->irq_data.irq = irq;\n\tdesc->irq_data.chip = &no_irq_chip;\n\tdesc->irq_data.chip_data = NULL;\n\tirq_settings_clr_and_set(desc, ~0, _IRQ_DEFAULT_INIT_FLAGS);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_DISABLED);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_MASKED);\n\tdesc->handle_irq = handle_bad_irq;\n\tdesc->depth = 1;\n\tdesc->irq_count = 0;\n\tdesc->irqs_unhandled = 0;\n\tdesc->name = NULL;\n\tdesc->owner = owner;\n\tfor_each_possible_cpu(cpu)\n\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) = 0;\n\tdesc_smp_init(desc, node, affinity);\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_rcu_head",
          "args": [
            "&desc->rcu"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "init_rcu_head_on_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/update.c",
          "lines": "396-399",
          "snippet": "void init_rcu_head_on_stack(struct rcu_head *head)\n{\n\tdebug_object_init_on_stack(head, &rcuhead_debug_descr);\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include <linux/sched/isolation.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/tick.h>",
            "#include <linux/kthread.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/export.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include <linux/sched/isolation.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/tick.h>\n#include <linux/kthread.h>\n#include <linux/moduleparam.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/export.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid init_rcu_head_on_stack(struct rcu_head *head)\n{\n\tdebug_object_init_on_stack(head, &rcuhead_debug_descr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&desc->request_mutex"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_init_task",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/fork.c",
          "lines": "1604-1612",
          "snippet": "static void rt_mutex_init_task(struct task_struct *p)\n{\n\traw_spin_lock_init(&p->pi_lock);\n#ifdef CONFIG_RT_MUTEXES\n\tp->pi_waiters = RB_ROOT_CACHED;\n\tp->pi_top_task = NULL;\n\tp->pi_blocked_on = NULL;\n#endif\n}",
          "includes": [
            "#include <linux/init_task.h>",
            "#include <trace/events/task.h>",
            "#include <trace/events/sched.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/stackleak.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/kcov.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/compiler.h>",
            "#include <linux/aio.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/signalfd.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/oom.h>",
            "#include <linux/user-return-notifier.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/magic.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/tty.h>",
            "#include <linux/random.h>",
            "#include <linux/taskstats_kern.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/acct.h>",
            "#include <linux/ksm.h>",
            "#include <linux/rmap.h>",
            "#include <linux/profile.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/kthread.h>",
            "#include <linux/compat.h>",
            "#include <linux/futex.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swap.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/security.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/hmm.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mman.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/key.h>",
            "#include <linux/iocontext.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/sem.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/personality.h>",
            "#include <linux/completion.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/module.h>",
            "#include <linux/unistd.h>",
            "#include <linux/init.h>",
            "#include <linux/rtmutex.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __latent_entropy struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/init_task.h>\n#include <trace/events/task.h>\n#include <trace/events/sched.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <asm/pgtable.h>\n#include <linux/stackleak.h>\n#include <linux/thread_info.h>\n#include <linux/livepatch.h>\n#include <linux/kcov.h>\n#include <linux/sysctl.h>\n#include <linux/compiler.h>\n#include <linux/aio.h>\n#include <linux/uprobes.h>\n#include <linux/signalfd.h>\n#include <linux/khugepaged.h>\n#include <linux/oom.h>\n#include <linux/user-return-notifier.h>\n#include <linux/posix-timers.h>\n#include <linux/perf_event.h>\n#include <linux/sched/mm.h>\n#include <linux/magic.h>\n#include <linux/fs_struct.h>\n#include <linux/blkdev.h>\n#include <linux/tty.h>\n#include <linux/random.h>\n#include <linux/taskstats_kern.h>\n#include <linux/delayacct.h>\n#include <linux/freezer.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/acct.h>\n#include <linux/ksm.h>\n#include <linux/rmap.h>\n#include <linux/profile.h>\n#include <linux/proc_fs.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/ptrace.h>\n#include <linux/rcupdate.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/kthread.h>\n#include <linux/compat.h>\n#include <linux/futex.h>\n#include <linux/jiffies.h>\n#include <linux/syscalls.h>\n#include <linux/swap.h>\n#include <linux/seccomp.h>\n#include <linux/hugetlb.h>\n#include <linux/security.h>\n#include <linux/cgroup.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/nsproxy.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/hmm.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mman.h>\n#include <linux/binfmts.h>\n#include <linux/key.h>\n#include <linux/iocontext.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/sem.h>\n#include <linux/mempolicy.h>\n#include <linux/personality.h>\n#include <linux/completion.h>\n#include <linux/vmalloc.h>\n#include <linux/module.h>\n#include <linux/unistd.h>\n#include <linux/init.h>\n#include <linux/rtmutex.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/user.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/autogroup.h>\n#include <linux/slab.h>\n\nstatic __latent_entropy struct;\n\nstatic void rt_mutex_init_task(struct task_struct *p)\n{\n\traw_spin_lock_init(&p->pi_lock);\n#ifdef CONFIG_RT_MUTEXES\n\tp->pi_waiters = RB_ROOT_CACHED;\n\tp->pi_top_task = NULL;\n\tp->pi_blocked_on = NULL;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_set_class",
          "args": [
            "&desc->lock",
            "&irq_desc_lock_class"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_init",
          "args": [
            "&desc->lock"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_masks",
          "args": [
            "desc",
            "node"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_masks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "97-98",
          "snippet": "static inline int\nalloc_masks(struct irq_desc *desc, int node) { return 0; }",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic inline int\nalloc_masks(struct irq_desc *desc, int node) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "alloc_percpu",
          "args": [
            "unsignedint"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_array_alloc_percpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/arraymap.c",
          "lines": "37-54",
          "snippet": "static int bpf_array_alloc_percpu(struct bpf_array *array)\n{\n\tvoid __percpu *ptr;\n\tint i;\n\n\tfor (i = 0; i < array->map.max_entries; i++) {\n\t\tptr = __alloc_percpu_gfp(array->elem_size, 8,\n\t\t\t\t\t GFP_USER | __GFP_NOWARN);\n\t\tif (!ptr) {\n\t\t\tbpf_array_free_percpu(array);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tarray->pptrs[i] = ptr;\n\t\tcond_resched();\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"map_in_map.h\"",
            "#include <uapi/linux/btf.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/filter.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"map_in_map.h\"\n#include <uapi/linux/btf.h>\n#include <linux/perf_event.h>\n#include <linux/filter.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n\nstatic int bpf_array_alloc_percpu(struct bpf_array *array)\n{\n\tvoid __percpu *ptr;\n\tint i;\n\n\tfor (i = 0; i < array->map.max_entries; i++) {\n\t\tptr = __alloc_percpu_gfp(array->elem_size, 8,\n\t\t\t\t\t GFP_USER | __GFP_NOWARN);\n\t\tif (!ptr) {\n\t\t\tbpf_array_free_percpu(array);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tarray->pptrs[i] = ptr;\n\t\tcond_resched();\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc_node",
          "args": [
            "sizeof(*desc)",
            "GFP_KERNEL",
            "node"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic struct lock_class_key irq_desc_lock_class;\n\nstatic struct irq_desc *alloc_desc(int irq, int node, unsigned int flags,\n\t\t\t\t   const struct cpumask *affinity,\n\t\t\t\t   struct module *owner)\n{\n\tstruct irq_desc *desc;\n\n\tdesc = kzalloc_node(sizeof(*desc), GFP_KERNEL, node);\n\tif (!desc)\n\t\treturn NULL;\n\t/* allocate based on nr_cpu_ids */\n\tdesc->kstat_irqs = alloc_percpu(unsigned int);\n\tif (!desc->kstat_irqs)\n\t\tgoto err_desc;\n\n\tif (alloc_masks(desc, node))\n\t\tgoto err_kstat;\n\n\traw_spin_lock_init(&desc->lock);\n\tlockdep_set_class(&desc->lock, &irq_desc_lock_class);\n\tmutex_init(&desc->request_mutex);\n\tinit_rcu_head(&desc->rcu);\n\n\tdesc_set_defaults(irq, desc, node, affinity, owner);\n\tirqd_set(&desc->irq_data, flags);\n\tkobject_init(&desc->kobj, &irq_kobj_type);\n\n\treturn desc;\n\nerr_kstat:\n\tfree_percpu(desc->kstat_irqs);\nerr_desc:\n\tkfree(desc);\n\treturn NULL;\n}"
  },
  {
    "function_name": "irq_unlock_sparse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "367-370",
    "snippet": "void irq_unlock_sparse(void)\n{\n\tmutex_unlock(&sparse_irq_lock);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(sparse_irq_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&sparse_irq_lock"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1602-1606",
          "snippet": "void __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched rt_mutex_unlock(struct rt_mutex *lock)\n{\n\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\trt_mutex_fastunlock(lock, rt_mutex_slowunlock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic DEFINE_MUTEX(sparse_irq_lock);\n\nvoid irq_unlock_sparse(void)\n{\n\tmutex_unlock(&sparse_irq_lock);\n}"
  },
  {
    "function_name": "irq_lock_sparse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "362-365",
    "snippet": "void irq_lock_sparse(void)\n{\n\tmutex_lock(&sparse_irq_lock);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(sparse_irq_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&sparse_irq_lock"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_lock_interruptible",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex.c",
          "lines": "1512-1524",
          "snippet": "int __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"rtmutex_common.h\"",
            "#include <linux/timer.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex_common.h\"\n#include <linux/timer.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched rt_mutex_lock_interruptible(struct rt_mutex *lock)\n{\n\tint ret;\n\n\tmight_sleep();\n\n\tmutex_acquire(&lock->dep_map, 0, 0, _RET_IP_);\n\tret = rt_mutex_fastlock(lock, TASK_INTERRUPTIBLE, rt_mutex_slowlock);\n\tif (ret)\n\t\tmutex_release(&lock->dep_map, 1, _RET_IP_);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic DEFINE_MUTEX(sparse_irq_lock);\n\nvoid irq_lock_sparse(void)\n{\n\tmutex_lock(&sparse_irq_lock);\n}"
  },
  {
    "function_name": "free_masks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "359-359",
    "snippet": "static inline void free_masks(struct irq_desc *desc) { }",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic inline void free_masks(struct irq_desc *desc) { }"
  },
  {
    "function_name": "free_masks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "348-357",
    "snippet": "static void free_masks(struct irq_desc *desc)\n{\n#ifdef CONFIG_GENERIC_PENDING_IRQ\n\tfree_cpumask_var(desc->pending_mask);\n#endif\n\tfree_cpumask_var(desc->irq_common_data.affinity);\n#ifdef CONFIG_GENERIC_IRQ_EFFECTIVE_AFF_MASK\n\tfree_cpumask_var(desc->irq_common_data.effective_affinity);\n#endif\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_cpumask_var",
          "args": [
            "desc->irq_common_data.effective_affinity"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_cpumask_var",
          "args": [
            "desc->irq_common_data.affinity"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_cpumask_var",
          "args": [
            "desc->pending_mask"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void free_masks(struct irq_desc *desc)\n{\n#ifdef CONFIG_GENERIC_PENDING_IRQ\n\tfree_cpumask_var(desc->pending_mask);\n#endif\n\tfree_cpumask_var(desc->irq_common_data.affinity);\n#ifdef CONFIG_GENERIC_IRQ_EFFECTIVE_AFF_MASK\n\tfree_cpumask_var(desc->irq_common_data.effective_affinity);\n#endif\n}"
  },
  {
    "function_name": "delete_irq_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "342-345",
    "snippet": "static void delete_irq_desc(unsigned int irq)\n{\n\tradix_tree_delete(&irq_desc_tree, irq);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "radix_tree_delete",
          "args": [
            "&irq_desc_tree",
            "irq"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void delete_irq_desc(unsigned int irq)\n{\n\tradix_tree_delete(&irq_desc_tree, irq);\n}"
  },
  {
    "function_name": "irq_to_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "336-339",
    "snippet": "struct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn radix_tree_lookup(&irq_desc_tree, irq);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "radix_tree_lookup",
          "args": [
            "&irq_desc_tree",
            "irq"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstruct irq_desc *irq_to_desc(unsigned int irq)\n{\n\treturn radix_tree_lookup(&irq_desc_tree, irq);\n}"
  },
  {
    "function_name": "irq_insert_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "331-334",
    "snippet": "static void irq_insert_desc(unsigned int irq, struct irq_desc *desc)\n{\n\tradix_tree_insert(&irq_desc_tree, irq, desc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "radix_tree_insert",
          "args": [
            "&irq_desc_tree",
            "irq",
            "desc"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void irq_insert_desc(unsigned int irq, struct irq_desc *desc)\n{\n\tradix_tree_insert(&irq_desc_tree, irq, desc);\n}"
  },
  {
    "function_name": "irq_sysfs_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "325-325",
    "snippet": "static void irq_sysfs_add(int irq, struct irq_desc *desc) {}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void irq_sysfs_add(int irq, struct irq_desc *desc) {}"
  },
  {
    "function_name": "irq_sysfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "296-316",
    "snippet": "static int __init irq_sysfs_init(void)\n{\n\tstruct irq_desc *desc;\n\tint irq;\n\n\t/* Prevent concurrent irq alloc/free */\n\tirq_lock_sparse();\n\n\tirq_kobj_base = kobject_create_and_add(\"irq\", kernel_kobj);\n\tif (!irq_kobj_base) {\n\t\tirq_unlock_sparse();\n\t\treturn -ENOMEM;\n\t}\n\n\t/* Add the already allocated interrupts */\n\tfor_each_irq_desc(irq, desc)\n\t\tirq_sysfs_add(irq, desc);\n\tirq_unlock_sparse();\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_unlock_sparse",
          "args": [],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "irq_unlock_sparse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "367-370",
          "snippet": "void irq_unlock_sparse(void)\n{\n\tmutex_unlock(&sparse_irq_lock);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(sparse_irq_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic DEFINE_MUTEX(sparse_irq_lock);\n\nvoid irq_unlock_sparse(void)\n{\n\tmutex_unlock(&sparse_irq_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_sysfs_add",
          "args": [
            "irq",
            "desc"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "irq_sysfs_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "325-325",
          "snippet": "static void irq_sysfs_add(int irq, struct irq_desc *desc) {}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void irq_sysfs_add(int irq, struct irq_desc *desc) {}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_irq_desc",
          "args": [
            "irq",
            "desc"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_create_and_add",
          "args": [
            "\"irq\"",
            "kernel_kobj"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_lock_sparse",
          "args": [],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "irq_lock_sparse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "362-365",
          "snippet": "void irq_lock_sparse(void)\n{\n\tmutex_lock(&sparse_irq_lock);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(sparse_irq_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic DEFINE_MUTEX(sparse_irq_lock);\n\nvoid irq_lock_sparse(void)\n{\n\tmutex_lock(&sparse_irq_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic int __init irq_sysfs_init(void)\n{\n\tstruct irq_desc *desc;\n\tint irq;\n\n\t/* Prevent concurrent irq alloc/free */\n\tirq_lock_sparse();\n\n\tirq_kobj_base = kobject_create_and_add(\"irq\", kernel_kobj);\n\tif (!irq_kobj_base) {\n\t\tirq_unlock_sparse();\n\t\treturn -ENOMEM;\n\t}\n\n\t/* Add the already allocated interrupts */\n\tfor_each_irq_desc(irq, desc)\n\t\tirq_sysfs_add(irq, desc);\n\tirq_unlock_sparse();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "irq_sysfs_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "284-294",
    "snippet": "static void irq_sysfs_add(int irq, struct irq_desc *desc)\n{\n\tif (irq_kobj_base) {\n\t\t/*\n\t\t * Continue even in case of failure as this is nothing\n\t\t * crucial.\n\t\t */\n\t\tif (kobject_add(&desc->kobj, irq_kobj_base, \"%d\", irq))\n\t\t\tpr_warn(\"Failed to add kobject for irq %d\\n\", irq);\n\t}\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Failed to add kobject for irq %d\\n\"",
            "irq"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_add",
          "args": [
            "&desc->kobj",
            "irq_kobj_base",
            "\"%d\"",
            "irq"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void irq_sysfs_add(int irq, struct irq_desc *desc)\n{\n\tif (irq_kobj_base) {\n\t\t/*\n\t\t * Continue even in case of failure as this is nothing\n\t\t * crucial.\n\t\t */\n\t\tif (kobject_add(&desc->kobj, irq_kobj_base, \"%d\", irq))\n\t\t\tpr_warn(\"Failed to add kobject for irq %d\\n\", irq);\n\t}\n}"
  },
  {
    "function_name": "actions_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "244-264",
    "snippet": "static ssize_t actions_show(struct kobject *kobj,\n\t\t\t    struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tstruct irqaction *action;\n\tssize_t ret = 0;\n\tchar *p = \"\";\n\n\traw_spin_lock_irq(&desc->lock);\n\tfor (action = desc->action; action != NULL; action = action->next) {\n\t\tret += scnprintf(buf + ret, PAGE_SIZE - ret, \"%s%s\",\n\t\t\t\t p, action->name);\n\t\tp = \",\";\n\t}\n\traw_spin_unlock_irq(&desc->lock);\n\n\tif (ret)\n\t\tret += scnprintf(buf + ret, PAGE_SIZE - ret, \"\\n\");\n\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scnprintf",
          "args": [
            "buf + ret",
            "PAGE_SIZE - ret",
            "\"\\n\""
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "190-193",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "scnprintf",
          "args": [
            "buf + ret",
            "PAGE_SIZE - ret",
            "\"%s%s\"",
            "p",
            "action->name"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "158-161",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structirq_desc",
            "kobj"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic ssize_t actions_show(struct kobject *kobj,\n\t\t\t    struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tstruct irqaction *action;\n\tssize_t ret = 0;\n\tchar *p = \"\";\n\n\traw_spin_lock_irq(&desc->lock);\n\tfor (action = desc->action; action != NULL; action = action->next) {\n\t\tret += scnprintf(buf + ret, PAGE_SIZE - ret, \"%s%s\",\n\t\t\t\t p, action->name);\n\t\tp = \",\";\n\t}\n\traw_spin_unlock_irq(&desc->lock);\n\n\tif (ret)\n\t\tret += scnprintf(buf + ret, PAGE_SIZE - ret, \"\\n\");\n\n\treturn ret;\n}"
  },
  {
    "function_name": "name_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "229-241",
    "snippet": "static ssize_t name_show(struct kobject *kobj,\n\t\t\t struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tssize_t ret = 0;\n\n\traw_spin_lock_irq(&desc->lock);\n\tif (desc->name)\n\t\tret = scnprintf(buf, PAGE_SIZE, \"%s\\n\", desc->name);\n\traw_spin_unlock_irq(&desc->lock);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "190-193",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "scnprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%s\\n\"",
            "desc->name"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "158-161",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structirq_desc",
            "kobj"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic ssize_t name_show(struct kobject *kobj,\n\t\t\t struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tssize_t ret = 0;\n\n\traw_spin_lock_irq(&desc->lock);\n\tif (desc->name)\n\t\tret = scnprintf(buf, PAGE_SIZE, \"%s\\n\", desc->name);\n\traw_spin_unlock_irq(&desc->lock);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "wakeup_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "213-226",
    "snippet": "static ssize_t wakeup_show(struct kobject *kobj,\n\t\t\t   struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tssize_t ret = 0;\n\n\traw_spin_lock_irq(&desc->lock);\n\tret = sprintf(buf, \"%s\\n\",\n\t\t      irqd_is_wakeup_set(&desc->irq_data) ? \"enabled\" : \"disabled\");\n\traw_spin_unlock_irq(&desc->lock);\n\n\treturn ret;\n\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "190-193",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%s\\n\"",
            "irqd_is_wakeup_set(&desc->irq_data) ? \"enabled\" : \"disabled\""
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqd_is_wakeup_set",
          "args": [
            "&desc->irq_data"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "158-161",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structirq_desc",
            "kobj"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic ssize_t wakeup_show(struct kobject *kobj,\n\t\t\t   struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tssize_t ret = 0;\n\n\traw_spin_lock_irq(&desc->lock);\n\tret = sprintf(buf, \"%s\\n\",\n\t\t      irqd_is_wakeup_set(&desc->irq_data) ? \"enabled\" : \"disabled\");\n\traw_spin_unlock_irq(&desc->lock);\n\n\treturn ret;\n\n}"
  },
  {
    "function_name": "type_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "197-210",
    "snippet": "static ssize_t type_show(struct kobject *kobj,\n\t\t\t struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tssize_t ret = 0;\n\n\traw_spin_lock_irq(&desc->lock);\n\tret = sprintf(buf, \"%s\\n\",\n\t\t      irqd_is_level_type(&desc->irq_data) ? \"level\" : \"edge\");\n\traw_spin_unlock_irq(&desc->lock);\n\n\treturn ret;\n\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "190-193",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%s\\n\"",
            "irqd_is_level_type(&desc->irq_data) ? \"level\" : \"edge\""
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqd_is_level_type",
          "args": [
            "&desc->irq_data"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "158-161",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structirq_desc",
            "kobj"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic ssize_t type_show(struct kobject *kobj,\n\t\t\t struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tssize_t ret = 0;\n\n\traw_spin_lock_irq(&desc->lock);\n\tret = sprintf(buf, \"%s\\n\",\n\t\t      irqd_is_level_type(&desc->irq_data) ? \"level\" : \"edge\");\n\traw_spin_unlock_irq(&desc->lock);\n\n\treturn ret;\n\n}"
  },
  {
    "function_name": "hwirq_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "182-194",
    "snippet": "static ssize_t hwirq_show(struct kobject *kobj,\n\t\t\t  struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tssize_t ret = 0;\n\n\traw_spin_lock_irq(&desc->lock);\n\tif (desc->irq_data.domain)\n\t\tret = sprintf(buf, \"%d\\n\", (int)desc->irq_data.hwirq);\n\traw_spin_unlock_irq(&desc->lock);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "190-193",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\\n\"",
            "(int)desc->irq_data.hwirq"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "158-161",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structirq_desc",
            "kobj"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic ssize_t hwirq_show(struct kobject *kobj,\n\t\t\t  struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tssize_t ret = 0;\n\n\traw_spin_lock_irq(&desc->lock);\n\tif (desc->irq_data.domain)\n\t\tret = sprintf(buf, \"%d\\n\", (int)desc->irq_data.hwirq);\n\traw_spin_unlock_irq(&desc->lock);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "chip_name_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "165-179",
    "snippet": "static ssize_t chip_name_show(struct kobject *kobj,\n\t\t\t      struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tssize_t ret = 0;\n\n\traw_spin_lock_irq(&desc->lock);\n\tif (desc->irq_data.chip && desc->irq_data.chip->name) {\n\t\tret = scnprintf(buf, PAGE_SIZE, \"%s\\n\",\n\t\t\t\tdesc->irq_data.chip->name);\n\t}\n\traw_spin_unlock_irq(&desc->lock);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "190-193",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "scnprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%s\\n\"",
            "desc->irq_data.chip->name"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irq",
          "args": [
            "&desc->lock"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "158-161",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structirq_desc",
            "kobj"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic ssize_t chip_name_show(struct kobject *kobj,\n\t\t\t      struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tssize_t ret = 0;\n\n\traw_spin_lock_irq(&desc->lock);\n\tif (desc->irq_data.chip && desc->irq_data.chip->name) {\n\t\tret = scnprintf(buf, PAGE_SIZE, \"%s\\n\",\n\t\t\t\tdesc->irq_data.chip->name);\n\t}\n\traw_spin_unlock_irq(&desc->lock);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "per_cpu_count_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "145-162",
    "snippet": "static ssize_t per_cpu_count_show(struct kobject *kobj,\n\t\t\t\t  struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tint cpu, irq = desc->irq_data.irq;\n\tssize_t ret = 0;\n\tchar *p = \"\";\n\n\tfor_each_possible_cpu(cpu) {\n\t\tunsigned int c = kstat_irqs_cpu(irq, cpu);\n\n\t\tret += scnprintf(buf + ret, PAGE_SIZE - ret, \"%s%u\", p, c);\n\t\tp = \",\";\n\t}\n\n\tret += scnprintf(buf + ret, PAGE_SIZE - ret, \"\\n\");\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scnprintf",
          "args": [
            "buf + ret",
            "PAGE_SIZE - ret",
            "\"\\n\""
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scnprintf",
          "args": [
            "buf + ret",
            "PAGE_SIZE - ret",
            "\"%s%u\"",
            "p",
            "c"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstat_irqs_cpu",
          "args": [
            "irq",
            "cpu"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "kstat_irqs_cpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "899-905",
          "snippet": "unsigned int kstat_irqs_cpu(unsigned int irq, int cpu)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\treturn desc && desc->kstat_irqs ?\n\t\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) : 0;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nunsigned int kstat_irqs_cpu(unsigned int irq, int cpu)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\treturn desc && desc->kstat_irqs ?\n\t\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structirq_desc",
            "kobj"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic ssize_t per_cpu_count_show(struct kobject *kobj,\n\t\t\t\t  struct kobj_attribute *attr, char *buf)\n{\n\tstruct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);\n\tint cpu, irq = desc->irq_data.irq;\n\tssize_t ret = 0;\n\tchar *p = \"\";\n\n\tfor_each_possible_cpu(cpu) {\n\t\tunsigned int c = kstat_irqs_cpu(irq, cpu);\n\n\t\tret += scnprintf(buf + ret, PAGE_SIZE - ret, \"%s%u\", p, c);\n\t\tp = \",\";\n\t}\n\n\tret += scnprintf(buf + ret, PAGE_SIZE - ret, \"\\n\");\n\treturn ret;\n}"
  },
  {
    "function_name": "desc_set_defaults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "103-127",
    "snippet": "static void desc_set_defaults(unsigned int irq, struct irq_desc *desc, int node,\n\t\t\t      const struct cpumask *affinity, struct module *owner)\n{\n\tint cpu;\n\n\tdesc->irq_common_data.handler_data = NULL;\n\tdesc->irq_common_data.msi_desc = NULL;\n\n\tdesc->irq_data.common = &desc->irq_common_data;\n\tdesc->irq_data.irq = irq;\n\tdesc->irq_data.chip = &no_irq_chip;\n\tdesc->irq_data.chip_data = NULL;\n\tirq_settings_clr_and_set(desc, ~0, _IRQ_DEFAULT_INIT_FLAGS);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_DISABLED);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_MASKED);\n\tdesc->handle_irq = handle_bad_irq;\n\tdesc->depth = 1;\n\tdesc->irq_count = 0;\n\tdesc->irqs_unhandled = 0;\n\tdesc->name = NULL;\n\tdesc->owner = owner;\n\tfor_each_possible_cpu(cpu)\n\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) = 0;\n\tdesc_smp_init(desc, node, affinity);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "desc_smp_init",
          "args": [
            "desc",
            "node",
            "affinity"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "desc_smp_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
          "lines": "99-100",
          "snippet": "static inline void\ndesc_smp_init(struct irq_desc *desc, int node, const struct cpumask *affinity) { }",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic inline void\ndesc_smp_init(struct irq_desc *desc, int node, const struct cpumask *affinity) { }"
        }
      },
      {
        "call_info": {
          "callee": "per_cpu_ptr",
          "args": [
            "desc->kstat_irqs",
            "cpu"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "for_each_possible_cpu",
          "args": [
            "cpu"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqd_set",
          "args": [
            "&desc->irq_data",
            "IRQD_IRQ_MASKED"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "irqd_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/internals.h",
          "lines": "223-226",
          "snippet": "static inline void irqd_set(struct irq_data *d, unsigned int mask)\n{\n\t__irqd_to_state(d) |= mask;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nstatic inline void irqd_set(struct irq_data *d, unsigned int mask)\n{\n\t__irqd_to_state(d) |= mask;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_settings_clr_and_set",
          "args": [
            "desc",
            "~0",
            "_IRQ_DEFAULT_INIT_FLAGS"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "irq_settings_clr_and_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/settings.h",
          "lines": "37-42",
          "snippet": "static inline void\nirq_settings_clr_and_set(struct irq_desc *desc, u32 clr, u32 set)\n{\n\tdesc->status_use_accessors &= ~(clr & _IRQF_MODIFY_MASK);\n\tdesc->status_use_accessors |= (set & _IRQF_MODIFY_MASK);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void\nirq_settings_clr_and_set(struct irq_desc *desc, u32 clr, u32 set)\n{\n\tdesc->status_use_accessors &= ~(clr & _IRQF_MODIFY_MASK);\n\tdesc->status_use_accessors |= (set & _IRQF_MODIFY_MASK);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void desc_set_defaults(unsigned int irq, struct irq_desc *desc, int node,\n\t\t\t      const struct cpumask *affinity, struct module *owner)\n{\n\tint cpu;\n\n\tdesc->irq_common_data.handler_data = NULL;\n\tdesc->irq_common_data.msi_desc = NULL;\n\n\tdesc->irq_data.common = &desc->irq_common_data;\n\tdesc->irq_data.irq = irq;\n\tdesc->irq_data.chip = &no_irq_chip;\n\tdesc->irq_data.chip_data = NULL;\n\tirq_settings_clr_and_set(desc, ~0, _IRQ_DEFAULT_INIT_FLAGS);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_DISABLED);\n\tirqd_set(&desc->irq_data, IRQD_IRQ_MASKED);\n\tdesc->handle_irq = handle_bad_irq;\n\tdesc->depth = 1;\n\tdesc->irq_count = 0;\n\tdesc->irqs_unhandled = 0;\n\tdesc->name = NULL;\n\tdesc->owner = owner;\n\tfor_each_possible_cpu(cpu)\n\t\t*per_cpu_ptr(desc->kstat_irqs, cpu) = 0;\n\tdesc_smp_init(desc, node, affinity);\n}"
  },
  {
    "function_name": "desc_smp_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "99-100",
    "snippet": "static inline void\ndesc_smp_init(struct irq_desc *desc, int node, const struct cpumask *affinity) { }",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic inline void\ndesc_smp_init(struct irq_desc *desc, int node, const struct cpumask *affinity) { }"
  },
  {
    "function_name": "alloc_masks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "97-98",
    "snippet": "static inline int\nalloc_masks(struct irq_desc *desc, int node) { return 0; }",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic inline int\nalloc_masks(struct irq_desc *desc, int node) { return 0; }"
  },
  {
    "function_name": "desc_smp_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "81-94",
    "snippet": "static void desc_smp_init(struct irq_desc *desc, int node,\n\t\t\t  const struct cpumask *affinity)\n{\n\tif (!affinity)\n\t\taffinity = irq_default_affinity;\n\tcpumask_copy(desc->irq_common_data.affinity, affinity);\n\n#ifdef CONFIG_GENERIC_PENDING_IRQ\n\tcpumask_clear(desc->pending_mask);\n#endif\n#ifdef CONFIG_NUMA\n\tdesc->irq_common_data.node = node;\n#endif\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_clear",
          "args": [
            "desc->pending_mask"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_copy",
          "args": [
            "desc->irq_common_data.affinity",
            "affinity"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void desc_smp_init(struct irq_desc *desc, int node,\n\t\t\t  const struct cpumask *affinity)\n{\n\tif (!affinity)\n\t\taffinity = irq_default_affinity;\n\tcpumask_copy(desc->irq_common_data.affinity, affinity);\n\n#ifdef CONFIG_GENERIC_PENDING_IRQ\n\tcpumask_clear(desc->pending_mask);\n#endif\n#ifdef CONFIG_NUMA\n\tdesc->irq_common_data.node = node;\n#endif\n}"
  },
  {
    "function_name": "alloc_masks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "55-79",
    "snippet": "static int alloc_masks(struct irq_desc *desc, int node)\n{\n\tif (!zalloc_cpumask_var_node(&desc->irq_common_data.affinity,\n\t\t\t\t     GFP_KERNEL, node))\n\t\treturn -ENOMEM;\n\n#ifdef CONFIG_GENERIC_IRQ_EFFECTIVE_AFF_MASK\n\tif (!zalloc_cpumask_var_node(&desc->irq_common_data.effective_affinity,\n\t\t\t\t     GFP_KERNEL, node)) {\n\t\tfree_cpumask_var(desc->irq_common_data.affinity);\n\t\treturn -ENOMEM;\n\t}\n#endif\n\n#ifdef CONFIG_GENERIC_PENDING_IRQ\n\tif (!zalloc_cpumask_var_node(&desc->pending_mask, GFP_KERNEL, node)) {\n#ifdef CONFIG_GENERIC_IRQ_EFFECTIVE_AFF_MASK\n\t\tfree_cpumask_var(desc->irq_common_data.effective_affinity);\n#endif\n\t\tfree_cpumask_var(desc->irq_common_data.affinity);\n\t\treturn -ENOMEM;\n\t}\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_cpumask_var",
          "args": [
            "desc->irq_common_data.affinity"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_cpumask_var",
          "args": [
            "desc->irq_common_data.effective_affinity"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var_node",
          "args": [
            "&desc->pending_mask",
            "GFP_KERNEL",
            "node"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_cpumask_var",
          "args": [
            "desc->irq_common_data.affinity"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var_node",
          "args": [
            "&desc->irq_common_data.effective_affinity",
            "GFP_KERNEL",
            "node"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var_node",
          "args": [
            "&desc->irq_common_data.affinity",
            "GFP_KERNEL",
            "node"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic int alloc_masks(struct irq_desc *desc, int node)\n{\n\tif (!zalloc_cpumask_var_node(&desc->irq_common_data.affinity,\n\t\t\t\t     GFP_KERNEL, node))\n\t\treturn -ENOMEM;\n\n#ifdef CONFIG_GENERIC_IRQ_EFFECTIVE_AFF_MASK\n\tif (!zalloc_cpumask_var_node(&desc->irq_common_data.effective_affinity,\n\t\t\t\t     GFP_KERNEL, node)) {\n\t\tfree_cpumask_var(desc->irq_common_data.affinity);\n\t\treturn -ENOMEM;\n\t}\n#endif\n\n#ifdef CONFIG_GENERIC_PENDING_IRQ\n\tif (!zalloc_cpumask_var_node(&desc->pending_mask, GFP_KERNEL, node)) {\n#ifdef CONFIG_GENERIC_IRQ_EFFECTIVE_AFF_MASK\n\t\tfree_cpumask_var(desc->irq_common_data.effective_affinity);\n#endif\n\t\tfree_cpumask_var(desc->irq_common_data.affinity);\n\t\treturn -ENOMEM;\n\t}\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "init_irq_default_affinity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "49-51",
    "snippet": "static void __init init_irq_default_affinity(void)\n{\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void __init init_irq_default_affinity(void)\n{\n}"
  },
  {
    "function_name": "init_irq_default_affinity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "41-47",
    "snippet": "static void __init init_irq_default_affinity(void)\n{\n\tif (!cpumask_available(irq_default_affinity))\n\t\tzalloc_cpumask_var(&irq_default_affinity, GFP_NOWAIT);\n\tif (cpumask_empty(irq_default_affinity))\n\t\tcpumask_setall(irq_default_affinity);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_setall",
          "args": [
            "irq_default_affinity"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "irq_default_affinity"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var",
          "args": [
            "&irq_default_affinity",
            "GFP_NOWAIT"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_available",
          "args": [
            "irq_default_affinity"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic void __init init_irq_default_affinity(void)\n{\n\tif (!cpumask_available(irq_default_affinity))\n\t\tzalloc_cpumask_var(&irq_default_affinity, GFP_NOWAIT);\n\tif (cpumask_empty(irq_default_affinity))\n\t\tcpumask_setall(irq_default_affinity);\n}"
  },
  {
    "function_name": "irq_affinity_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/irqdesc.c",
    "lines": "28-38",
    "snippet": "static int __init irq_affinity_setup(char *str)\n{\n\talloc_bootmem_cpumask_var(&irq_default_affinity);\n\tcpulist_parse(str, irq_default_affinity);\n\t/*\n\t * Set at least the boot cpu. We don't want to end up with\n\t * bugreports caused by random comandline masks\n\t */\n\tcpumask_set_cpu(smp_processor_id(), irq_default_affinity);\n\treturn 1;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/sysfs.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/bitmap.h>",
      "#include <linux/radix-tree.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "smp_processor_id()",
            "irq_default_affinity"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpulist_parse",
          "args": [
            "str",
            "irq_default_affinity"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_bootmem_cpumask_var",
          "args": [
            "&irq_default_affinity"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nstatic int __init irq_affinity_setup(char *str)\n{\n\talloc_bootmem_cpumask_var(&irq_default_affinity);\n\tcpulist_parse(str, irq_default_affinity);\n\t/*\n\t * Set at least the boot cpu. We don't want to end up with\n\t * bugreports caused by random comandline masks\n\t */\n\tcpumask_set_cpu(smp_processor_id(), irq_default_affinity);\n\treturn 1;\n}"
  }
]