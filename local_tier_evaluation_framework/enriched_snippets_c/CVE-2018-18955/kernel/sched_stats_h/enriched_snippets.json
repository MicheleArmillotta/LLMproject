[
  {
    "function_name": "sched_info_switch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "239-244",
    "snippet": "static inline void\nsched_info_switch(struct rq *rq, struct task_struct *prev, struct task_struct *next)\n{\n\tif (unlikely(sched_info_on()))\n\t\t__sched_info_switch(rq, prev, next);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__sched_info_switch",
          "args": [
            "rq",
            "prev",
            "next"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "__sched_info_switch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
          "lines": "224-237",
          "snippet": "static inline void\n__sched_info_switch(struct rq *rq, struct task_struct *prev, struct task_struct *next)\n{\n\t/*\n\t * prev now departs the CPU.  It's not interesting to record\n\t * stats about how efficient we were at scheduling the idle\n\t * process, however.\n\t */\n\tif (prev != rq->idle)\n\t\tsched_info_depart(rq, prev);\n\n\tif (next != rq->idle)\n\t\tsched_info_arrive(rq, next);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void\n__sched_info_switch(struct rq *rq, struct task_struct *prev, struct task_struct *next)\n{\n\t/*\n\t * prev now departs the CPU.  It's not interesting to record\n\t * stats about how efficient we were at scheduling the idle\n\t * process, however.\n\t */\n\tif (prev != rq->idle)\n\t\tsched_info_depart(rq, prev);\n\n\tif (next != rq->idle)\n\t\tsched_info_arrive(rq, next);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "sched_info_on()"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sched_info_on",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void\nsched_info_switch(struct rq *rq, struct task_struct *prev, struct task_struct *next)\n{\n\tif (unlikely(sched_info_on()))\n\t\t__sched_info_switch(rq, prev, next);\n}"
  },
  {
    "function_name": "__sched_info_switch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "224-237",
    "snippet": "static inline void\n__sched_info_switch(struct rq *rq, struct task_struct *prev, struct task_struct *next)\n{\n\t/*\n\t * prev now departs the CPU.  It's not interesting to record\n\t * stats about how efficient we were at scheduling the idle\n\t * process, however.\n\t */\n\tif (prev != rq->idle)\n\t\tsched_info_depart(rq, prev);\n\n\tif (next != rq->idle)\n\t\tsched_info_arrive(rq, next);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sched_info_arrive",
          "args": [
            "rq",
            "next"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "sched_info_arrive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
          "lines": "174-186",
          "snippet": "static void sched_info_arrive(struct rq *rq, struct task_struct *t)\n{\n\tunsigned long long now = rq_clock(rq), delta = 0;\n\n\tif (t->sched_info.last_queued)\n\t\tdelta = now - t->sched_info.last_queued;\n\tsched_info_reset_dequeued(t);\n\tt->sched_info.run_delay += delta;\n\tt->sched_info.last_arrival = now;\n\tt->sched_info.pcount++;\n\n\trq_sched_info_arrive(rq, delta);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static void sched_info_arrive(struct rq *rq, struct task_struct *t)\n{\n\tunsigned long long now = rq_clock(rq), delta = 0;\n\n\tif (t->sched_info.last_queued)\n\t\tdelta = now - t->sched_info.last_queued;\n\tsched_info_reset_dequeued(t);\n\tt->sched_info.run_delay += delta;\n\tt->sched_info.last_arrival = now;\n\tt->sched_info.pcount++;\n\n\trq_sched_info_arrive(rq, delta);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sched_info_depart",
          "args": [
            "rq",
            "prev"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "sched_info_depart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
          "lines": "209-217",
          "snippet": "static inline void sched_info_depart(struct rq *rq, struct task_struct *t)\n{\n\tunsigned long long delta = rq_clock(rq) - t->sched_info.last_arrival;\n\n\trq_sched_info_depart(rq, delta);\n\n\tif (t->state == TASK_RUNNING)\n\t\tsched_info_queued(rq, t);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void sched_info_depart(struct rq *rq, struct task_struct *t)\n{\n\tunsigned long long delta = rq_clock(rq) - t->sched_info.last_arrival;\n\n\trq_sched_info_depart(rq, delta);\n\n\tif (t->state == TASK_RUNNING)\n\t\tsched_info_queued(rq, t);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline void\n__sched_info_switch(struct rq *rq, struct task_struct *prev, struct task_struct *next)\n{\n\t/*\n\t * prev now departs the CPU.  It's not interesting to record\n\t * stats about how efficient we were at scheduling the idle\n\t * process, however.\n\t */\n\tif (prev != rq->idle)\n\t\tsched_info_depart(rq, prev);\n\n\tif (next != rq->idle)\n\t\tsched_info_arrive(rq, next);\n}"
  },
  {
    "function_name": "sched_info_depart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "209-217",
    "snippet": "static inline void sched_info_depart(struct rq *rq, struct task_struct *t)\n{\n\tunsigned long long delta = rq_clock(rq) - t->sched_info.last_arrival;\n\n\trq_sched_info_depart(rq, delta);\n\n\tif (t->state == TASK_RUNNING)\n\t\tsched_info_queued(rq, t);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sched_info_queued",
          "args": [
            "rq",
            "t"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "sched_info_queued",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
          "lines": "193-199",
          "snippet": "static inline void sched_info_queued(struct rq *rq, struct task_struct *t)\n{\n\tif (unlikely(sched_info_on())) {\n\t\tif (!t->sched_info.last_queued)\n\t\t\tt->sched_info.last_queued = rq_clock(rq);\n\t}\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void sched_info_queued(struct rq *rq, struct task_struct *t)\n{\n\tif (unlikely(sched_info_on())) {\n\t\tif (!t->sched_info.last_queued)\n\t\t\tt->sched_info.last_queued = rq_clock(rq);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "rq_sched_info_depart",
          "args": [
            "rq",
            "delta"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "rq_sched_info_depart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
          "lines": "46-46",
          "snippet": "static inline void rq_sched_info_depart  (struct rq *rq, unsigned long long delta) { }",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rq_sched_info_depart  (struct rq *rq, unsigned long long delta) { }"
        }
      },
      {
        "call_info": {
          "callee": "rq_clock",
          "args": [
            "rq"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "update_rq_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "185-205",
          "snippet": "void update_rq_clock(struct rq *rq)\n{\n\ts64 delta;\n\n\tlockdep_assert_held(&rq->lock);\n\n\tif (rq->clock_update_flags & RQCF_ACT_SKIP)\n\t\treturn;\n\n#ifdef CONFIG_SCHED_DEBUG\n\tif (sched_feat(WARN_DOUBLE_CLOCK))\n\t\tSCHED_WARN_ON(rq->clock_update_flags & RQCF_UPDATED);\n\trq->clock_update_flags |= RQCF_UPDATED;\n#endif\n\n\tdelta = sched_clock_cpu(cpu_of(rq)) - rq->clock;\n\tif (delta < 0)\n\t\treturn;\n\trq->clock += delta;\n\tupdate_rq_clock_task(rq, delta);\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic __always_inline struct;\n\nvoid update_rq_clock(struct rq *rq)\n{\n\ts64 delta;\n\n\tlockdep_assert_held(&rq->lock);\n\n\tif (rq->clock_update_flags & RQCF_ACT_SKIP)\n\t\treturn;\n\n#ifdef CONFIG_SCHED_DEBUG\n\tif (sched_feat(WARN_DOUBLE_CLOCK))\n\t\tSCHED_WARN_ON(rq->clock_update_flags & RQCF_UPDATED);\n\trq->clock_update_flags |= RQCF_UPDATED;\n#endif\n\n\tdelta = sched_clock_cpu(cpu_of(rq)) - rq->clock;\n\tif (delta < 0)\n\t\treturn;\n\trq->clock += delta;\n\tupdate_rq_clock_task(rq, delta);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline void sched_info_depart(struct rq *rq, struct task_struct *t)\n{\n\tunsigned long long delta = rq_clock(rq) - t->sched_info.last_arrival;\n\n\trq_sched_info_depart(rq, delta);\n\n\tif (t->state == TASK_RUNNING)\n\t\tsched_info_queued(rq, t);\n}"
  },
  {
    "function_name": "sched_info_queued",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "193-199",
    "snippet": "static inline void sched_info_queued(struct rq *rq, struct task_struct *t)\n{\n\tif (unlikely(sched_info_on())) {\n\t\tif (!t->sched_info.last_queued)\n\t\t\tt->sched_info.last_queued = rq_clock(rq);\n\t}\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rq_clock",
          "args": [
            "rq"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "update_rq_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "185-205",
          "snippet": "void update_rq_clock(struct rq *rq)\n{\n\ts64 delta;\n\n\tlockdep_assert_held(&rq->lock);\n\n\tif (rq->clock_update_flags & RQCF_ACT_SKIP)\n\t\treturn;\n\n#ifdef CONFIG_SCHED_DEBUG\n\tif (sched_feat(WARN_DOUBLE_CLOCK))\n\t\tSCHED_WARN_ON(rq->clock_update_flags & RQCF_UPDATED);\n\trq->clock_update_flags |= RQCF_UPDATED;\n#endif\n\n\tdelta = sched_clock_cpu(cpu_of(rq)) - rq->clock;\n\tif (delta < 0)\n\t\treturn;\n\trq->clock += delta;\n\tupdate_rq_clock_task(rq, delta);\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic __always_inline struct;\n\nvoid update_rq_clock(struct rq *rq)\n{\n\ts64 delta;\n\n\tlockdep_assert_held(&rq->lock);\n\n\tif (rq->clock_update_flags & RQCF_ACT_SKIP)\n\t\treturn;\n\n#ifdef CONFIG_SCHED_DEBUG\n\tif (sched_feat(WARN_DOUBLE_CLOCK))\n\t\tSCHED_WARN_ON(rq->clock_update_flags & RQCF_UPDATED);\n\trq->clock_update_flags |= RQCF_UPDATED;\n#endif\n\n\tdelta = sched_clock_cpu(cpu_of(rq)) - rq->clock;\n\tif (delta < 0)\n\t\treturn;\n\trq->clock += delta;\n\tupdate_rq_clock_task(rq, delta);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "sched_info_on()"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sched_info_on",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void sched_info_queued(struct rq *rq, struct task_struct *t)\n{\n\tif (unlikely(sched_info_on())) {\n\t\tif (!t->sched_info.last_queued)\n\t\t\tt->sched_info.last_queued = rq_clock(rq);\n\t}\n}"
  },
  {
    "function_name": "sched_info_arrive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "174-186",
    "snippet": "static void sched_info_arrive(struct rq *rq, struct task_struct *t)\n{\n\tunsigned long long now = rq_clock(rq), delta = 0;\n\n\tif (t->sched_info.last_queued)\n\t\tdelta = now - t->sched_info.last_queued;\n\tsched_info_reset_dequeued(t);\n\tt->sched_info.run_delay += delta;\n\tt->sched_info.last_arrival = now;\n\tt->sched_info.pcount++;\n\n\trq_sched_info_arrive(rq, delta);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rq_sched_info_arrive",
          "args": [
            "rq",
            "delta"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "rq_sched_info_arrive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
          "lines": "44-44",
          "snippet": "static inline void rq_sched_info_arrive  (struct rq *rq, unsigned long long delta) { }",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rq_sched_info_arrive  (struct rq *rq, unsigned long long delta) { }"
        }
      },
      {
        "call_info": {
          "callee": "sched_info_reset_dequeued",
          "args": [
            "t"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "sched_info_reset_dequeued",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
          "lines": "145-148",
          "snippet": "static inline void sched_info_reset_dequeued(struct task_struct *t)\n{\n\tt->sched_info.last_queued = 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void sched_info_reset_dequeued(struct task_struct *t)\n{\n\tt->sched_info.last_queued = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rq_clock",
          "args": [
            "rq"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "update_rq_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "185-205",
          "snippet": "void update_rq_clock(struct rq *rq)\n{\n\ts64 delta;\n\n\tlockdep_assert_held(&rq->lock);\n\n\tif (rq->clock_update_flags & RQCF_ACT_SKIP)\n\t\treturn;\n\n#ifdef CONFIG_SCHED_DEBUG\n\tif (sched_feat(WARN_DOUBLE_CLOCK))\n\t\tSCHED_WARN_ON(rq->clock_update_flags & RQCF_UPDATED);\n\trq->clock_update_flags |= RQCF_UPDATED;\n#endif\n\n\tdelta = sched_clock_cpu(cpu_of(rq)) - rq->clock;\n\tif (delta < 0)\n\t\treturn;\n\trq->clock += delta;\n\tupdate_rq_clock_task(rq, delta);\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic __always_inline struct;\n\nvoid update_rq_clock(struct rq *rq)\n{\n\ts64 delta;\n\n\tlockdep_assert_held(&rq->lock);\n\n\tif (rq->clock_update_flags & RQCF_ACT_SKIP)\n\t\treturn;\n\n#ifdef CONFIG_SCHED_DEBUG\n\tif (sched_feat(WARN_DOUBLE_CLOCK))\n\t\tSCHED_WARN_ON(rq->clock_update_flags & RQCF_UPDATED);\n\trq->clock_update_flags |= RQCF_UPDATED;\n#endif\n\n\tdelta = sched_clock_cpu(cpu_of(rq)) - rq->clock;\n\tif (delta < 0)\n\t\treturn;\n\trq->clock += delta;\n\tupdate_rq_clock_task(rq, delta);\n}"
        }
      }
    ],
    "contextual_snippet": "static void sched_info_arrive(struct rq *rq, struct task_struct *t)\n{\n\tunsigned long long now = rq_clock(rq), delta = 0;\n\n\tif (t->sched_info.last_queued)\n\t\tdelta = now - t->sched_info.last_queued;\n\tsched_info_reset_dequeued(t);\n\tt->sched_info.run_delay += delta;\n\tt->sched_info.last_arrival = now;\n\tt->sched_info.pcount++;\n\n\trq_sched_info_arrive(rq, delta);\n}"
  },
  {
    "function_name": "sched_info_dequeued",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "156-167",
    "snippet": "static inline void sched_info_dequeued(struct rq *rq, struct task_struct *t)\n{\n\tunsigned long long now = rq_clock(rq), delta = 0;\n\n\tif (unlikely(sched_info_on()))\n\t\tif (t->sched_info.last_queued)\n\t\t\tdelta = now - t->sched_info.last_queued;\n\tsched_info_reset_dequeued(t);\n\tt->sched_info.run_delay += delta;\n\n\trq_sched_info_dequeued(rq, delta);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rq_sched_info_dequeued",
          "args": [
            "rq",
            "delta"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "rq_sched_info_dequeued",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
          "lines": "45-45",
          "snippet": "static inline void rq_sched_info_dequeued(struct rq *rq, unsigned long long delta) { }",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void rq_sched_info_dequeued(struct rq *rq, unsigned long long delta) { }"
        }
      },
      {
        "call_info": {
          "callee": "sched_info_reset_dequeued",
          "args": [
            "t"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "sched_info_reset_dequeued",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
          "lines": "145-148",
          "snippet": "static inline void sched_info_reset_dequeued(struct task_struct *t)\n{\n\tt->sched_info.last_queued = 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void sched_info_reset_dequeued(struct task_struct *t)\n{\n\tt->sched_info.last_queued = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "sched_info_on()"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sched_info_on",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rq_clock",
          "args": [
            "rq"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "update_rq_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "185-205",
          "snippet": "void update_rq_clock(struct rq *rq)\n{\n\ts64 delta;\n\n\tlockdep_assert_held(&rq->lock);\n\n\tif (rq->clock_update_flags & RQCF_ACT_SKIP)\n\t\treturn;\n\n#ifdef CONFIG_SCHED_DEBUG\n\tif (sched_feat(WARN_DOUBLE_CLOCK))\n\t\tSCHED_WARN_ON(rq->clock_update_flags & RQCF_UPDATED);\n\trq->clock_update_flags |= RQCF_UPDATED;\n#endif\n\n\tdelta = sched_clock_cpu(cpu_of(rq)) - rq->clock;\n\tif (delta < 0)\n\t\treturn;\n\trq->clock += delta;\n\tupdate_rq_clock_task(rq, delta);\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic __always_inline struct;\n\nvoid update_rq_clock(struct rq *rq)\n{\n\ts64 delta;\n\n\tlockdep_assert_held(&rq->lock);\n\n\tif (rq->clock_update_flags & RQCF_ACT_SKIP)\n\t\treturn;\n\n#ifdef CONFIG_SCHED_DEBUG\n\tif (sched_feat(WARN_DOUBLE_CLOCK))\n\t\tSCHED_WARN_ON(rq->clock_update_flags & RQCF_UPDATED);\n\trq->clock_update_flags |= RQCF_UPDATED;\n#endif\n\n\tdelta = sched_clock_cpu(cpu_of(rq)) - rq->clock;\n\tif (delta < 0)\n\t\treturn;\n\trq->clock += delta;\n\tupdate_rq_clock_task(rq, delta);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline void sched_info_dequeued(struct rq *rq, struct task_struct *t)\n{\n\tunsigned long long now = rq_clock(rq), delta = 0;\n\n\tif (unlikely(sched_info_on()))\n\t\tif (t->sched_info.last_queued)\n\t\t\tdelta = now - t->sched_info.last_queued;\n\tsched_info_reset_dequeued(t);\n\tt->sched_info.run_delay += delta;\n\n\trq_sched_info_dequeued(rq, delta);\n}"
  },
  {
    "function_name": "sched_info_reset_dequeued",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "145-148",
    "snippet": "static inline void sched_info_reset_dequeued(struct task_struct *t)\n{\n\tt->sched_info.last_queued = 0;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void sched_info_reset_dequeued(struct task_struct *t)\n{\n\tt->sched_info.last_queued = 0;\n}"
  },
  {
    "function_name": "psi_task_tick",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "141-141",
    "snippet": "static inline void psi_task_tick(struct rq *rq) {}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void psi_task_tick(struct rq *rq) {}"
  },
  {
    "function_name": "psi_ttwu_dequeue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "140-140",
    "snippet": "static inline void psi_ttwu_dequeue(struct task_struct *p) {}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void psi_ttwu_dequeue(struct task_struct *p) {}"
  },
  {
    "function_name": "psi_dequeue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "139-139",
    "snippet": "static inline void psi_dequeue(struct task_struct *p, bool sleep) {}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void psi_dequeue(struct task_struct *p, bool sleep) {}"
  },
  {
    "function_name": "psi_enqueue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "138-138",
    "snippet": "static inline void psi_enqueue(struct task_struct *p, bool wakeup) {}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void psi_enqueue(struct task_struct *p, bool wakeup) {}"
  },
  {
    "function_name": "psi_task_tick",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "129-136",
    "snippet": "static inline void psi_task_tick(struct rq *rq)\n{\n\tif (psi_disabled)\n\t\treturn;\n\n\tif (unlikely(rq->curr->flags & PF_MEMSTALL))\n\t\tpsi_memstall_tick(rq->curr, cpu_of(rq));\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "psi_memstall_tick",
          "args": [
            "rq->curr",
            "cpu_of(rq)"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "psi_memstall_tick",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/psi.c",
          "lines": "525-538",
          "snippet": "void psi_memstall_tick(struct task_struct *task, int cpu)\n{\n\tstruct psi_group *group;\n\tvoid *iter = NULL;\n\n\twhile ((group = iterate_groups(task, &iter))) {\n\t\tstruct psi_group_cpu *groupc;\n\n\t\tgroupc = per_cpu_ptr(group->pcpu, cpu);\n\t\twrite_seqcount_begin(&groupc->seq);\n\t\trecord_times(groupc, cpu, true);\n\t\twrite_seqcount_end(&groupc->seq);\n\t}\n}",
          "includes": [
            "#include \"sched.h\"",
            "#include <linux/psi.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched/loadavg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n#include <linux/psi.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/cgroup.h>\n#include <linux/seqlock.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/sched/loadavg.h>\n\nvoid psi_memstall_tick(struct task_struct *task, int cpu)\n{\n\tstruct psi_group *group;\n\tvoid *iter = NULL;\n\n\twhile ((group = iterate_groups(task, &iter))) {\n\t\tstruct psi_group_cpu *groupc;\n\n\t\tgroupc = per_cpu_ptr(group->pcpu, cpu);\n\t\twrite_seqcount_begin(&groupc->seq);\n\t\trecord_times(groupc, cpu, true);\n\t\twrite_seqcount_end(&groupc->seq);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_of",
          "args": [
            "rq"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_of",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/sched.h",
          "lines": "928-935",
          "snippet": "static inline int cpu_of(struct rq *rq)\n{\n#ifdef CONFIG_SMP\n\treturn rq->cpu;\n#else\n\treturn 0;\n#endif\n}",
          "includes": [
            "#include \"features.h\"",
            "#include \"features.h\"",
            "# include <linux/static_key.h>",
            "#include \"autogroup.h\"",
            "#include \"stats.h\"",
            "#include <linux/psi.h>",
            "#include <linux/cgroup.h>",
            "#include \"cpudeadline.h\"",
            "#include \"cpupri.h\"",
            "# include <asm/paravirt.h>",
            "#include <asm/tlb.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/task_work.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swait.h>",
            "#include <linux/suspend.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/security.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/psi.h>",
            "#include <linux/profile.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/migrate.h>",
            "#include <linux/membarrier.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init_task.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpufreq.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/compat.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/binfmts.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/xacct.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/prio.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/jobctl.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/init.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/cpufreq.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern bool dl_cpu_busy(unsigned int cpu);",
            "extern void update_rq_clock(struct rq *rq);",
            "extern void resched_curr(struct rq *rq);",
            "extern void resched_cpu(int cpu);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include \"features.h\"\n# include <linux/static_key.h>\n#include \"autogroup.h\"\n#include \"stats.h\"\n#include <linux/psi.h>\n#include <linux/cgroup.h>\n#include \"cpudeadline.h\"\n#include \"cpupri.h\"\n# include <asm/paravirt.h>\n#include <asm/tlb.h>\n#include <linux/tsacct_kern.h>\n#include <linux/task_work.h>\n#include <linux/syscalls.h>\n#include <linux/swait.h>\n#include <linux/suspend.h>\n#include <linux/stop_machine.h>\n#include <linux/security.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/psi.h>\n#include <linux/profile.h>\n#include <linux/prefetch.h>\n#include <linux/proc_fs.h>\n#include <linux/nmi.h>\n#include <linux/mmu_context.h>\n#include <linux/migrate.h>\n#include <linux/membarrier.h>\n#include <linux/kthread.h>\n#include <linux/kprobes.h>\n#include <linux/init_task.h>\n#include <linux/delayacct.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/cpuset.h>\n#include <linux/cpuidle.h>\n#include <linux/cpufreq.h>\n#include <linux/context_tracking.h>\n#include <linux/compat.h>\n#include <linux/blkdev.h>\n#include <linux/binfmts.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/xacct.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/user.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/sysctl.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/prio.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/jobctl.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/init.h>\n#include <linux/sched/idle.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/cpufreq.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n\nextern bool dl_cpu_busy(unsigned int cpu);\nextern void update_rq_clock(struct rq *rq);\nextern void resched_curr(struct rq *rq);\nextern void resched_cpu(int cpu);\n\nstatic inline int cpu_of(struct rq *rq)\n{\n#ifdef CONFIG_SMP\n\treturn rq->cpu;\n#else\n\treturn 0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "rq->curr->flags & PF_MEMSTALL"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void psi_task_tick(struct rq *rq)\n{\n\tif (psi_disabled)\n\t\treturn;\n\n\tif (unlikely(rq->curr->flags & PF_MEMSTALL))\n\t\tpsi_memstall_tick(rq->curr, cpu_of(rq));\n}"
  },
  {
    "function_name": "psi_ttwu_dequeue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "103-127",
    "snippet": "static inline void psi_ttwu_dequeue(struct task_struct *p)\n{\n\tif (psi_disabled)\n\t\treturn;\n\t/*\n\t * Is the task being migrated during a wakeup? Make sure to\n\t * deregister its sleep-persistent psi states from the old\n\t * queue, and let psi_enqueue() know it has to requeue.\n\t */\n\tif (unlikely(p->in_iowait || (p->flags & PF_MEMSTALL))) {\n\t\tstruct rq_flags rf;\n\t\tstruct rq *rq;\n\t\tint clear = 0;\n\n\t\tif (p->in_iowait)\n\t\t\tclear |= TSK_IOWAIT;\n\t\tif (p->flags & PF_MEMSTALL)\n\t\t\tclear |= TSK_MEMSTALL;\n\n\t\trq = __task_rq_lock(p, &rf);\n\t\tpsi_task_change(p, clear, 0);\n\t\tp->sched_psi_wake_requeue = 1;\n\t\t__task_rq_unlock(rq, &rf);\n\t}\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__task_rq_unlock",
          "args": [
            "rq",
            "&rf"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "__task_rq_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/sched.h",
          "lines": "1089-1094",
          "snippet": "static inline void __task_rq_unlock(struct rq *rq, struct rq_flags *rf)\n\t__releases(rq->lock)\n{\n\trq_unpin_lock(rq, rf);\n\traw_spin_unlock(&rq->lock);\n}",
          "includes": [
            "#include \"features.h\"",
            "#include \"features.h\"",
            "# include <linux/static_key.h>",
            "#include \"autogroup.h\"",
            "#include \"stats.h\"",
            "#include <linux/psi.h>",
            "#include <linux/cgroup.h>",
            "#include \"cpudeadline.h\"",
            "#include \"cpupri.h\"",
            "# include <asm/paravirt.h>",
            "#include <asm/tlb.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/task_work.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swait.h>",
            "#include <linux/suspend.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/security.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/psi.h>",
            "#include <linux/profile.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/migrate.h>",
            "#include <linux/membarrier.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init_task.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpufreq.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/compat.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/binfmts.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/xacct.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/prio.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/jobctl.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/init.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/cpufreq.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void update_rq_clock(struct rq *rq);",
            "struct rq *__task_rq_lock(struct task_struct *p, struct rq_flags *rf)\n\t__acquires(rq->lock);",
            "struct rq *task_rq_lock(struct task_struct *p, struct rq_flags *rf)\n\t__acquires(p->pi_lock)\n\t__acquires(rq->lock);",
            "extern void resched_curr(struct rq *rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include \"features.h\"\n# include <linux/static_key.h>\n#include \"autogroup.h\"\n#include \"stats.h\"\n#include <linux/psi.h>\n#include <linux/cgroup.h>\n#include \"cpudeadline.h\"\n#include \"cpupri.h\"\n# include <asm/paravirt.h>\n#include <asm/tlb.h>\n#include <linux/tsacct_kern.h>\n#include <linux/task_work.h>\n#include <linux/syscalls.h>\n#include <linux/swait.h>\n#include <linux/suspend.h>\n#include <linux/stop_machine.h>\n#include <linux/security.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/psi.h>\n#include <linux/profile.h>\n#include <linux/prefetch.h>\n#include <linux/proc_fs.h>\n#include <linux/nmi.h>\n#include <linux/mmu_context.h>\n#include <linux/migrate.h>\n#include <linux/membarrier.h>\n#include <linux/kthread.h>\n#include <linux/kprobes.h>\n#include <linux/init_task.h>\n#include <linux/delayacct.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/cpuset.h>\n#include <linux/cpuidle.h>\n#include <linux/cpufreq.h>\n#include <linux/context_tracking.h>\n#include <linux/compat.h>\n#include <linux/blkdev.h>\n#include <linux/binfmts.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/xacct.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/user.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/sysctl.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/prio.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/jobctl.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/init.h>\n#include <linux/sched/idle.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/cpufreq.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n\nextern void update_rq_clock(struct rq *rq);\nstruct rq *__task_rq_lock(struct task_struct *p, struct rq_flags *rf)\n\t__acquires(rq->lock);\nstruct rq *task_rq_lock(struct task_struct *p, struct rq_flags *rf)\n\t__acquires(p->pi_lock)\n\t__acquires(rq->lock);\nextern void resched_curr(struct rq *rq);\n\nstatic inline void __task_rq_unlock(struct rq *rq, struct rq_flags *rf)\n\t__releases(rq->lock)\n{\n\trq_unpin_lock(rq, rf);\n\traw_spin_unlock(&rq->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "psi_task_change",
          "args": [
            "p",
            "clear",
            "0"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "psi_task_change",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/psi.c",
          "lines": "500-523",
          "snippet": "void psi_task_change(struct task_struct *task, int clear, int set)\n{\n\tint cpu = task_cpu(task);\n\tstruct psi_group *group;\n\tvoid *iter = NULL;\n\n\tif (!task->pid)\n\t\treturn;\n\n\tif (((task->psi_flags & set) ||\n\t     (task->psi_flags & clear) != clear) &&\n\t    !psi_bug) {\n\t\tprintk_deferred(KERN_ERR \"psi: inconsistent task state! task=%d:%s cpu=%d psi_flags=%x clear=%x set=%x\\n\",\n\t\t\t\ttask->pid, task->comm, cpu,\n\t\t\t\ttask->psi_flags, clear, set);\n\t\tpsi_bug = 1;\n\t}\n\n\ttask->psi_flags &= ~clear;\n\ttask->psi_flags |= set;\n\n\twhile ((group = iterate_groups(task, &iter)))\n\t\tpsi_group_change(group, cpu, clear, set);\n}",
          "includes": [
            "#include \"sched.h\"",
            "#include <linux/psi.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched/loadavg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n#include <linux/psi.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/cgroup.h>\n#include <linux/seqlock.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/sched/loadavg.h>\n\nvoid psi_task_change(struct task_struct *task, int clear, int set)\n{\n\tint cpu = task_cpu(task);\n\tstruct psi_group *group;\n\tvoid *iter = NULL;\n\n\tif (!task->pid)\n\t\treturn;\n\n\tif (((task->psi_flags & set) ||\n\t     (task->psi_flags & clear) != clear) &&\n\t    !psi_bug) {\n\t\tprintk_deferred(KERN_ERR \"psi: inconsistent task state! task=%d:%s cpu=%d psi_flags=%x clear=%x set=%x\\n\",\n\t\t\t\ttask->pid, task->comm, cpu,\n\t\t\t\ttask->psi_flags, clear, set);\n\t\tpsi_bug = 1;\n\t}\n\n\ttask->psi_flags &= ~clear;\n\ttask->psi_flags |= set;\n\n\twhile ((group = iterate_groups(task, &iter)))\n\t\tpsi_group_change(group, cpu, clear, set);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__task_rq_lock",
          "args": [
            "p",
            "&rf"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "__task_rq_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/core.c",
          "lines": "66-85",
          "snippet": "struct rq *__task_rq_lock(struct task_struct *p, struct rq_flags *rf)\n\t__acquires(rq->lock)\n{\n\tstruct rq *rq;\n\n\tlockdep_assert_held(&p->pi_lock);\n\n\tfor (;;) {\n\t\trq = task_rq(p);\n\t\traw_spin_lock(&rq->lock);\n\t\tif (likely(rq == task_rq(p) && !task_on_rq_migrating(p))) {\n\t\t\trq_pin_lock(rq, rf);\n\t\t\treturn rq;\n\t\t}\n\t\traw_spin_unlock(&rq->lock);\n\n\t\twhile (unlikely(task_on_rq_migrating(p)))\n\t\t\tcpu_relax();\n\t}\n}",
          "includes": [
            "#include \"features.h\"",
            "#include <trace/events/sched.h>",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/kcov.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include <trace/events/sched.h>\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/kcov.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n\nstatic __always_inline struct;\n\nstruct rq *__task_rq_lock(struct task_struct *p, struct rq_flags *rf)\n\t__acquires(rq->lock)\n{\n\tstruct rq *rq;\n\n\tlockdep_assert_held(&p->pi_lock);\n\n\tfor (;;) {\n\t\trq = task_rq(p);\n\t\traw_spin_lock(&rq->lock);\n\t\tif (likely(rq == task_rq(p) && !task_on_rq_migrating(p))) {\n\t\t\trq_pin_lock(rq, rf);\n\t\t\treturn rq;\n\t\t}\n\t\traw_spin_unlock(&rq->lock);\n\n\t\twhile (unlikely(task_on_rq_migrating(p)))\n\t\t\tcpu_relax();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "p->in_iowait || (p->flags & PF_MEMSTALL)"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void psi_ttwu_dequeue(struct task_struct *p)\n{\n\tif (psi_disabled)\n\t\treturn;\n\t/*\n\t * Is the task being migrated during a wakeup? Make sure to\n\t * deregister its sleep-persistent psi states from the old\n\t * queue, and let psi_enqueue() know it has to requeue.\n\t */\n\tif (unlikely(p->in_iowait || (p->flags & PF_MEMSTALL))) {\n\t\tstruct rq_flags rf;\n\t\tstruct rq *rq;\n\t\tint clear = 0;\n\n\t\tif (p->in_iowait)\n\t\t\tclear |= TSK_IOWAIT;\n\t\tif (p->flags & PF_MEMSTALL)\n\t\t\tclear |= TSK_MEMSTALL;\n\n\t\trq = __task_rq_lock(p, &rf);\n\t\tpsi_task_change(p, clear, 0);\n\t\tp->sched_psi_wake_requeue = 1;\n\t\t__task_rq_unlock(rq, &rf);\n\t}\n}"
  },
  {
    "function_name": "psi_dequeue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "85-101",
    "snippet": "static inline void psi_dequeue(struct task_struct *p, bool sleep)\n{\n\tint clear = TSK_RUNNING, set = 0;\n\n\tif (psi_disabled)\n\t\treturn;\n\n\tif (!sleep) {\n\t\tif (p->flags & PF_MEMSTALL)\n\t\t\tclear |= TSK_MEMSTALL;\n\t} else {\n\t\tif (p->in_iowait)\n\t\t\tset |= TSK_IOWAIT;\n\t}\n\n\tpsi_task_change(p, clear, set);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "psi_task_change",
          "args": [
            "p",
            "clear",
            "set"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "psi_task_change",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/psi.c",
          "lines": "500-523",
          "snippet": "void psi_task_change(struct task_struct *task, int clear, int set)\n{\n\tint cpu = task_cpu(task);\n\tstruct psi_group *group;\n\tvoid *iter = NULL;\n\n\tif (!task->pid)\n\t\treturn;\n\n\tif (((task->psi_flags & set) ||\n\t     (task->psi_flags & clear) != clear) &&\n\t    !psi_bug) {\n\t\tprintk_deferred(KERN_ERR \"psi: inconsistent task state! task=%d:%s cpu=%d psi_flags=%x clear=%x set=%x\\n\",\n\t\t\t\ttask->pid, task->comm, cpu,\n\t\t\t\ttask->psi_flags, clear, set);\n\t\tpsi_bug = 1;\n\t}\n\n\ttask->psi_flags &= ~clear;\n\ttask->psi_flags |= set;\n\n\twhile ((group = iterate_groups(task, &iter)))\n\t\tpsi_group_change(group, cpu, clear, set);\n}",
          "includes": [
            "#include \"sched.h\"",
            "#include <linux/psi.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched/loadavg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n#include <linux/psi.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/cgroup.h>\n#include <linux/seqlock.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/sched/loadavg.h>\n\nvoid psi_task_change(struct task_struct *task, int clear, int set)\n{\n\tint cpu = task_cpu(task);\n\tstruct psi_group *group;\n\tvoid *iter = NULL;\n\n\tif (!task->pid)\n\t\treturn;\n\n\tif (((task->psi_flags & set) ||\n\t     (task->psi_flags & clear) != clear) &&\n\t    !psi_bug) {\n\t\tprintk_deferred(KERN_ERR \"psi: inconsistent task state! task=%d:%s cpu=%d psi_flags=%x clear=%x set=%x\\n\",\n\t\t\t\ttask->pid, task->comm, cpu,\n\t\t\t\ttask->psi_flags, clear, set);\n\t\tpsi_bug = 1;\n\t}\n\n\ttask->psi_flags &= ~clear;\n\ttask->psi_flags |= set;\n\n\twhile ((group = iterate_groups(task, &iter)))\n\t\tpsi_group_change(group, cpu, clear, set);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline void psi_dequeue(struct task_struct *p, bool sleep)\n{\n\tint clear = TSK_RUNNING, set = 0;\n\n\tif (psi_disabled)\n\t\treturn;\n\n\tif (!sleep) {\n\t\tif (p->flags & PF_MEMSTALL)\n\t\t\tclear |= TSK_MEMSTALL;\n\t} else {\n\t\tif (p->in_iowait)\n\t\t\tset |= TSK_IOWAIT;\n\t}\n\n\tpsi_task_change(p, clear, set);\n}"
  },
  {
    "function_name": "psi_enqueue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "65-83",
    "snippet": "static inline void psi_enqueue(struct task_struct *p, bool wakeup)\n{\n\tint clear = 0, set = TSK_RUNNING;\n\n\tif (psi_disabled)\n\t\treturn;\n\n\tif (!wakeup || p->sched_psi_wake_requeue) {\n\t\tif (p->flags & PF_MEMSTALL)\n\t\t\tset |= TSK_MEMSTALL;\n\t\tif (p->sched_psi_wake_requeue)\n\t\t\tp->sched_psi_wake_requeue = 0;\n\t} else {\n\t\tif (p->in_iowait)\n\t\t\tclear |= TSK_IOWAIT;\n\t}\n\n\tpsi_task_change(p, clear, set);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "psi_task_change",
          "args": [
            "p",
            "clear",
            "set"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "psi_task_change",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/psi.c",
          "lines": "500-523",
          "snippet": "void psi_task_change(struct task_struct *task, int clear, int set)\n{\n\tint cpu = task_cpu(task);\n\tstruct psi_group *group;\n\tvoid *iter = NULL;\n\n\tif (!task->pid)\n\t\treturn;\n\n\tif (((task->psi_flags & set) ||\n\t     (task->psi_flags & clear) != clear) &&\n\t    !psi_bug) {\n\t\tprintk_deferred(KERN_ERR \"psi: inconsistent task state! task=%d:%s cpu=%d psi_flags=%x clear=%x set=%x\\n\",\n\t\t\t\ttask->pid, task->comm, cpu,\n\t\t\t\ttask->psi_flags, clear, set);\n\t\tpsi_bug = 1;\n\t}\n\n\ttask->psi_flags &= ~clear;\n\ttask->psi_flags |= set;\n\n\twhile ((group = iterate_groups(task, &iter)))\n\t\tpsi_group_change(group, cpu, clear, set);\n}",
          "includes": [
            "#include \"sched.h\"",
            "#include <linux/psi.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/seqlock.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched/loadavg.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n#include <linux/psi.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/cgroup.h>\n#include <linux/seqlock.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/sched/loadavg.h>\n\nvoid psi_task_change(struct task_struct *task, int clear, int set)\n{\n\tint cpu = task_cpu(task);\n\tstruct psi_group *group;\n\tvoid *iter = NULL;\n\n\tif (!task->pid)\n\t\treturn;\n\n\tif (((task->psi_flags & set) ||\n\t     (task->psi_flags & clear) != clear) &&\n\t    !psi_bug) {\n\t\tprintk_deferred(KERN_ERR \"psi: inconsistent task state! task=%d:%s cpu=%d psi_flags=%x clear=%x set=%x\\n\",\n\t\t\t\ttask->pid, task->comm, cpu,\n\t\t\t\ttask->psi_flags, clear, set);\n\t\tpsi_bug = 1;\n\t}\n\n\ttask->psi_flags &= ~clear;\n\ttask->psi_flags |= set;\n\n\twhile ((group = iterate_groups(task, &iter)))\n\t\tpsi_group_change(group, cpu, clear, set);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline void psi_enqueue(struct task_struct *p, bool wakeup)\n{\n\tint clear = 0, set = TSK_RUNNING;\n\n\tif (psi_disabled)\n\t\treturn;\n\n\tif (!wakeup || p->sched_psi_wake_requeue) {\n\t\tif (p->flags & PF_MEMSTALL)\n\t\t\tset |= TSK_MEMSTALL;\n\t\tif (p->sched_psi_wake_requeue)\n\t\t\tp->sched_psi_wake_requeue = 0;\n\t} else {\n\t\tif (p->in_iowait)\n\t\t\tclear |= TSK_IOWAIT;\n\t}\n\n\tpsi_task_change(p, clear, set);\n}"
  },
  {
    "function_name": "rq_sched_info_depart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "46-46",
    "snippet": "static inline void rq_sched_info_depart  (struct rq *rq, unsigned long long delta) { }",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void rq_sched_info_depart  (struct rq *rq, unsigned long long delta) { }"
  },
  {
    "function_name": "rq_sched_info_dequeued",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "45-45",
    "snippet": "static inline void rq_sched_info_dequeued(struct rq *rq, unsigned long long delta) { }",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void rq_sched_info_dequeued(struct rq *rq, unsigned long long delta) { }"
  },
  {
    "function_name": "rq_sched_info_arrive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "44-44",
    "snippet": "static inline void rq_sched_info_arrive  (struct rq *rq, unsigned long long delta) { }",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void rq_sched_info_arrive  (struct rq *rq, unsigned long long delta) { }"
  },
  {
    "function_name": "rq_sched_info_dequeued",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "27-32",
    "snippet": "static inline void\nrq_sched_info_dequeued(struct rq *rq, unsigned long long delta)\n{\n\tif (rq)\n\t\trq->rq_sched_info.run_delay += delta;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void\nrq_sched_info_dequeued(struct rq *rq, unsigned long long delta)\n{\n\tif (rq)\n\t\trq->rq_sched_info.run_delay += delta;\n}"
  },
  {
    "function_name": "rq_sched_info_depart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "20-25",
    "snippet": "static inline void\nrq_sched_info_depart(struct rq *rq, unsigned long long delta)\n{\n\tif (rq)\n\t\trq->rq_cpu_time += delta;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void\nrq_sched_info_depart(struct rq *rq, unsigned long long delta)\n{\n\tif (rq)\n\t\trq->rq_cpu_time += delta;\n}"
  },
  {
    "function_name": "rq_sched_info_arrive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/stats.h",
    "lines": "8-15",
    "snippet": "static inline void\nrq_sched_info_arrive(struct rq *rq, unsigned long long delta)\n{\n\tif (rq) {\n\t\trq->rq_sched_info.run_delay += delta;\n\t\trq->rq_sched_info.pcount++;\n\t}\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void\nrq_sched_info_arrive(struct rq *rq, unsigned long long delta)\n{\n\tif (rq) {\n\t\trq->rq_sched_info.run_delay += delta;\n\t\trq->rq_sched_info.pcount++;\n\t}\n}"
  }
]