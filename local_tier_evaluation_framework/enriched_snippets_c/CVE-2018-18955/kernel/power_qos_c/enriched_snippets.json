[
  {
    "function_name": "pm_qos_power_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "690-712",
    "snippet": "static int __init pm_qos_power_init(void)\n{\n\tint ret = 0;\n\tint i;\n\tstruct dentry *d;\n\n\tBUILD_BUG_ON(ARRAY_SIZE(pm_qos_array) != PM_QOS_NUM_CLASSES);\n\n\td = debugfs_create_dir(\"pm_qos\", NULL);\n\tif (IS_ERR_OR_NULL(d))\n\t\td = NULL;\n\n\tfor (i = PM_QOS_CPU_DMA_LATENCY; i < PM_QOS_NUM_CLASSES; i++) {\n\t\tret = register_pm_qos_misc(pm_qos_array[i], d);\n\t\tif (ret < 0) {\n\t\t\tpr_err(\"%s: %s setup failed\\n\",\n\t\t\t       __func__, pm_qos_array[i]->name);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s: %s setup failed\\n\"",
            "__func__",
            "pm_qos_array[i]->name"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_pm_qos_misc",
          "args": [
            "pm_qos_array[i]",
            "d"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "register_pm_qos_misc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "590-602",
          "snippet": "static int register_pm_qos_misc(struct pm_qos_object *qos, struct dentry *d)\n{\n\tqos->pm_qos_power_miscdev.minor = MISC_DYNAMIC_MINOR;\n\tqos->pm_qos_power_miscdev.name = qos->name;\n\tqos->pm_qos_power_miscdev.fops = &pm_qos_power_fops;\n\n\tif (d) {\n\t\t(void)debugfs_create_file(qos->name, S_IRUGO, d,\n\t\t\t\t\t  (void *)qos, &pm_qos_debug_fops);\n\t}\n\n\treturn misc_register(&qos->pm_qos_power_miscdev);\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations pm_qos_power_fops = {\n\t.write = pm_qos_power_write,\n\t.read = pm_qos_power_read,\n\t.open = pm_qos_power_open,\n\t.release = pm_qos_power_release,\n\t.llseek = noop_llseek,\n};",
            "static const struct file_operations pm_qos_debug_fops = {\n\t.open           = pm_qos_dbg_open,\n\t.read           = seq_read,\n\t.llseek         = seq_lseek,\n\t.release        = single_release,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic const struct file_operations pm_qos_power_fops = {\n\t.write = pm_qos_power_write,\n\t.read = pm_qos_power_read,\n\t.open = pm_qos_power_open,\n\t.release = pm_qos_power_release,\n\t.llseek = noop_llseek,\n};\nstatic const struct file_operations pm_qos_debug_fops = {\n\t.open           = pm_qos_dbg_open,\n\t.read           = seq_read,\n\t.llseek         = seq_lseek,\n\t.release        = single_release,\n};\n\nstatic int register_pm_qos_misc(struct pm_qos_object *qos, struct dentry *d)\n{\n\tqos->pm_qos_power_miscdev.minor = MISC_DYNAMIC_MINOR;\n\tqos->pm_qos_power_miscdev.name = qos->name;\n\tqos->pm_qos_power_miscdev.fops = &pm_qos_power_fops;\n\n\tif (d) {\n\t\t(void)debugfs_create_file(qos->name, S_IRUGO, d,\n\t\t\t\t\t  (void *)qos, &pm_qos_debug_fops);\n\t}\n\n\treturn misc_register(&qos->pm_qos_power_miscdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "d"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "\"pm_qos\"",
            "NULL"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "ARRAY_SIZE(pm_qos_array) != PM_QOS_NUM_CLASSES"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "pm_qos_array"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nstatic int __init pm_qos_power_init(void)\n{\n\tint ret = 0;\n\tint i;\n\tstruct dentry *d;\n\n\tBUILD_BUG_ON(ARRAY_SIZE(pm_qos_array) != PM_QOS_NUM_CLASSES);\n\n\td = debugfs_create_dir(\"pm_qos\", NULL);\n\tif (IS_ERR_OR_NULL(d))\n\t\td = NULL;\n\n\tfor (i = PM_QOS_CPU_DMA_LATENCY; i < PM_QOS_NUM_CLASSES; i++) {\n\t\tret = register_pm_qos_misc(pm_qos_array[i], d);\n\t\tif (ret < 0) {\n\t\t\tpr_err(\"%s: %s setup failed\\n\",\n\t\t\t       __func__, pm_qos_array[i]->name);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "pm_qos_power_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "666-687",
    "snippet": "static ssize_t pm_qos_power_write(struct file *filp, const char __user *buf,\n\t\tsize_t count, loff_t *f_pos)\n{\n\ts32 value;\n\tstruct pm_qos_request *req;\n\n\tif (count == sizeof(s32)) {\n\t\tif (copy_from_user(&value, buf, sizeof(s32)))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\tint ret;\n\n\t\tret = kstrtos32_from_user(buf, count, 16, &value);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\treq = filp->private_data;\n\tpm_qos_update_request(req, value);\n\n\treturn count;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ssize_t pm_qos_power_write(struct file *filp, const char __user *buf,\n\t\tsize_t count, loff_t *f_pos);",
      "static ssize_t pm_qos_power_read(struct file *filp, char __user *buf,\n\t\tsize_t count, loff_t *f_pos);",
      "static int pm_qos_power_open(struct inode *inode, struct file *filp);",
      "static int pm_qos_power_release(struct inode *inode, struct file *filp);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pm_qos_update_request",
          "args": [
            "req",
            "value"
          ],
          "line": 684
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_update_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "475-488",
          "snippet": "void pm_qos_update_request(struct pm_qos_request *req,\n\t\t\t   s32 new_value)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\n\tif (!pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_update_request() called for unknown object\\n\");\n\t\treturn;\n\t}\n\n\tcancel_delayed_work_sync(&req->work);\n\t__pm_qos_update_request(req, new_value);\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nvoid pm_qos_update_request(struct pm_qos_request *req,\n\t\t\t   s32 new_value)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\n\tif (!pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_update_request() called for unknown object\\n\");\n\t\treturn;\n\t}\n\n\tcancel_delayed_work_sync(&req->work);\n\t__pm_qos_update_request(req, new_value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrtos32_from_user",
          "args": [
            "buf",
            "count",
            "16",
            "&value"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&value",
            "buf",
            "sizeof(s32)"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic ssize_t pm_qos_power_write(struct file *filp, const char __user *buf,\n\t\tsize_t count, loff_t *f_pos);\nstatic ssize_t pm_qos_power_read(struct file *filp, char __user *buf,\n\t\tsize_t count, loff_t *f_pos);\nstatic int pm_qos_power_open(struct inode *inode, struct file *filp);\nstatic int pm_qos_power_release(struct inode *inode, struct file *filp);\n\nstatic ssize_t pm_qos_power_write(struct file *filp, const char __user *buf,\n\t\tsize_t count, loff_t *f_pos)\n{\n\ts32 value;\n\tstruct pm_qos_request *req;\n\n\tif (count == sizeof(s32)) {\n\t\tif (copy_from_user(&value, buf, sizeof(s32)))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\tint ret;\n\n\t\tret = kstrtos32_from_user(buf, count, 16, &value);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\treq = filp->private_data;\n\tpm_qos_update_request(req, value);\n\n\treturn count;\n}"
  },
  {
    "function_name": "pm_qos_power_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "647-664",
    "snippet": "static ssize_t pm_qos_power_read(struct file *filp, char __user *buf,\n\t\tsize_t count, loff_t *f_pos)\n{\n\ts32 value;\n\tunsigned long flags;\n\tstruct pm_qos_request *req = filp->private_data;\n\n\tif (!req)\n\t\treturn -EINVAL;\n\tif (!pm_qos_request_active(req))\n\t\treturn -EINVAL;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tvalue = pm_qos_get_value(pm_qos_array[req->pm_qos_class]->constraints);\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\treturn simple_read_from_buffer(buf, count, f_pos, &value, sizeof(s32));\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(pm_qos_lock);",
      "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};",
      "static ssize_t pm_qos_power_write(struct file *filp, const char __user *buf,\n\t\tsize_t count, loff_t *f_pos);",
      "static ssize_t pm_qos_power_read(struct file *filp, char __user *buf,\n\t\tsize_t count, loff_t *f_pos);",
      "static int pm_qos_power_open(struct inode *inode, struct file *filp);",
      "static int pm_qos_power_release(struct inode *inode, struct file *filp);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_read_from_buffer",
          "args": [
            "buf",
            "count",
            "f_pos",
            "&value",
            "sizeof(s32)"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&pm_qos_lock",
            "flags"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_qos_get_value",
          "args": [
            "pm_qos_array[req->pm_qos_class]->constraints"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_get_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "149-175",
          "snippet": "static inline int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tstruct plist_node *node;\n\tint total_value = 0;\n\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tcase PM_QOS_SUM:\n\t\tplist_for_each(node, &c->list)\n\t\t\ttotal_value += node->prio;\n\n\t\treturn total_value;\n\n\tdefault:\n\t\t/* runtime check for not using enum */\n\t\tBUG();\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic inline int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tstruct plist_node *node;\n\tint total_value = 0;\n\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tcase PM_QOS_SUM:\n\t\tplist_for_each(node, &c->list)\n\t\t\ttotal_value += node->prio;\n\n\t\treturn total_value;\n\n\tdefault:\n\t\t/* runtime check for not using enum */\n\t\tBUG();\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&pm_qos_lock",
            "flags"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_qos_request_active",
          "args": [
            "req"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_request_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "402-405",
          "snippet": "int pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\nstatic ssize_t pm_qos_power_write(struct file *filp, const char __user *buf,\n\t\tsize_t count, loff_t *f_pos);\nstatic ssize_t pm_qos_power_read(struct file *filp, char __user *buf,\n\t\tsize_t count, loff_t *f_pos);\nstatic int pm_qos_power_open(struct inode *inode, struct file *filp);\nstatic int pm_qos_power_release(struct inode *inode, struct file *filp);\n\nstatic ssize_t pm_qos_power_read(struct file *filp, char __user *buf,\n\t\tsize_t count, loff_t *f_pos)\n{\n\ts32 value;\n\tunsigned long flags;\n\tstruct pm_qos_request *req = filp->private_data;\n\n\tif (!req)\n\t\treturn -EINVAL;\n\tif (!pm_qos_request_active(req))\n\t\treturn -EINVAL;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tvalue = pm_qos_get_value(pm_qos_array[req->pm_qos_class]->constraints);\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\treturn simple_read_from_buffer(buf, count, f_pos, &value, sizeof(s32));\n}"
  },
  {
    "function_name": "pm_qos_power_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "635-644",
    "snippet": "static int pm_qos_power_release(struct inode *inode, struct file *filp)\n{\n\tstruct pm_qos_request *req;\n\n\treq = filp->private_data;\n\tpm_qos_remove_request(req);\n\tkfree(req);\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int pm_qos_power_open(struct inode *inode, struct file *filp);",
      "static int pm_qos_power_release(struct inode *inode, struct file *filp);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "req"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_qos_remove_request",
          "args": [
            "req"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_remove_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "528-546",
          "snippet": "void pm_qos_remove_request(struct pm_qos_request *req)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\t\t/* silent return to keep pcm code cleaner */\n\n\tif (!pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_remove_request() called for unknown object\\n\");\n\t\treturn;\n\t}\n\n\tcancel_delayed_work_sync(&req->work);\n\n\ttrace_pm_qos_remove_request(req->pm_qos_class, PM_QOS_DEFAULT_VALUE);\n\tpm_qos_update_target(pm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t     &req->node, PM_QOS_REMOVE_REQ,\n\t\t\t     PM_QOS_DEFAULT_VALUE);\n\tmemset(req, 0, sizeof(*req));\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nvoid pm_qos_remove_request(struct pm_qos_request *req)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\t\t/* silent return to keep pcm code cleaner */\n\n\tif (!pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_remove_request() called for unknown object\\n\");\n\t\treturn;\n\t}\n\n\tcancel_delayed_work_sync(&req->work);\n\n\ttrace_pm_qos_remove_request(req->pm_qos_class, PM_QOS_DEFAULT_VALUE);\n\tpm_qos_update_target(pm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t     &req->node, PM_QOS_REMOVE_REQ,\n\t\t\t     PM_QOS_DEFAULT_VALUE);\n\tmemset(req, 0, sizeof(*req));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic int pm_qos_power_open(struct inode *inode, struct file *filp);\nstatic int pm_qos_power_release(struct inode *inode, struct file *filp);\n\nstatic int pm_qos_power_release(struct inode *inode, struct file *filp)\n{\n\tstruct pm_qos_request *req;\n\n\treq = filp->private_data;\n\tpm_qos_remove_request(req);\n\tkfree(req);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "pm_qos_power_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "617-633",
    "snippet": "static int pm_qos_power_open(struct inode *inode, struct file *filp)\n{\n\tlong pm_qos_class;\n\n\tpm_qos_class = find_pm_qos_object_by_minor(iminor(inode));\n\tif (pm_qos_class >= PM_QOS_CPU_DMA_LATENCY) {\n\t\tstruct pm_qos_request *req = kzalloc(sizeof(*req), GFP_KERNEL);\n\t\tif (!req)\n\t\t\treturn -ENOMEM;\n\n\t\tpm_qos_add_request(req, pm_qos_class, PM_QOS_DEFAULT_VALUE);\n\t\tfilp->private_data = req;\n\n\t\treturn 0;\n\t}\n\treturn -EPERM;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int pm_qos_power_open(struct inode *inode, struct file *filp);",
      "static int pm_qos_power_release(struct inode *inode, struct file *filp);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pm_qos_add_request",
          "args": [
            "req",
            "pm_qos_class",
            "PM_QOS_DEFAULT_VALUE"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_add_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "447-462",
          "snippet": "void pm_qos_add_request(struct pm_qos_request *req,\n\t\t\tint pm_qos_class, s32 value)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\n\tif (pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_add_request() called for already added request\\n\");\n\t\treturn;\n\t}\n\treq->pm_qos_class = pm_qos_class;\n\tINIT_DELAYED_WORK(&req->work, pm_qos_work_fn);\n\ttrace_pm_qos_add_request(pm_qos_class, value);\n\tpm_qos_update_target(pm_qos_array[pm_qos_class]->constraints,\n\t\t\t     &req->node, PM_QOS_ADD_REQ, value);\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nvoid pm_qos_add_request(struct pm_qos_request *req,\n\t\t\tint pm_qos_class, s32 value)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\n\tif (pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_add_request() called for already added request\\n\");\n\t\treturn;\n\t}\n\treq->pm_qos_class = pm_qos_class;\n\tINIT_DELAYED_WORK(&req->work, pm_qos_work_fn);\n\ttrace_pm_qos_add_request(pm_qos_class, value);\n\tpm_qos_update_target(pm_qos_array[pm_qos_class]->constraints,\n\t\t\t     &req->node, PM_QOS_ADD_REQ, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*req)",
            "GFP_KERNEL"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_pm_qos_object_by_minor",
          "args": [
            "iminor(inode)"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "find_pm_qos_object_by_minor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "604-615",
          "snippet": "static int find_pm_qos_object_by_minor(int minor)\n{\n\tint pm_qos_class;\n\n\tfor (pm_qos_class = PM_QOS_CPU_DMA_LATENCY;\n\t\tpm_qos_class < PM_QOS_NUM_CLASSES; pm_qos_class++) {\n\t\tif (minor ==\n\t\t\tpm_qos_array[pm_qos_class]->pm_qos_power_miscdev.minor)\n\t\t\treturn pm_qos_class;\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nstatic int find_pm_qos_object_by_minor(int minor)\n{\n\tint pm_qos_class;\n\n\tfor (pm_qos_class = PM_QOS_CPU_DMA_LATENCY;\n\t\tpm_qos_class < PM_QOS_NUM_CLASSES; pm_qos_class++) {\n\t\tif (minor ==\n\t\t\tpm_qos_array[pm_qos_class]->pm_qos_power_miscdev.minor)\n\t\t\treturn pm_qos_class;\n\t}\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "iminor",
          "args": [
            "inode"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic int pm_qos_power_open(struct inode *inode, struct file *filp);\nstatic int pm_qos_power_release(struct inode *inode, struct file *filp);\n\nstatic int pm_qos_power_open(struct inode *inode, struct file *filp)\n{\n\tlong pm_qos_class;\n\n\tpm_qos_class = find_pm_qos_object_by_minor(iminor(inode));\n\tif (pm_qos_class >= PM_QOS_CPU_DMA_LATENCY) {\n\t\tstruct pm_qos_request *req = kzalloc(sizeof(*req), GFP_KERNEL);\n\t\tif (!req)\n\t\t\treturn -ENOMEM;\n\n\t\tpm_qos_add_request(req, pm_qos_class, PM_QOS_DEFAULT_VALUE);\n\t\tfilp->private_data = req;\n\n\t\treturn 0;\n\t}\n\treturn -EPERM;\n}"
  },
  {
    "function_name": "find_pm_qos_object_by_minor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "604-615",
    "snippet": "static int find_pm_qos_object_by_minor(int minor)\n{\n\tint pm_qos_class;\n\n\tfor (pm_qos_class = PM_QOS_CPU_DMA_LATENCY;\n\t\tpm_qos_class < PM_QOS_NUM_CLASSES; pm_qos_class++) {\n\t\tif (minor ==\n\t\t\tpm_qos_array[pm_qos_class]->pm_qos_power_miscdev.minor)\n\t\t\treturn pm_qos_class;\n\t}\n\treturn -1;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nstatic int find_pm_qos_object_by_minor(int minor)\n{\n\tint pm_qos_class;\n\n\tfor (pm_qos_class = PM_QOS_CPU_DMA_LATENCY;\n\t\tpm_qos_class < PM_QOS_NUM_CLASSES; pm_qos_class++) {\n\t\tif (minor ==\n\t\t\tpm_qos_array[pm_qos_class]->pm_qos_power_miscdev.minor)\n\t\t\treturn pm_qos_class;\n\t}\n\treturn -1;\n}"
  },
  {
    "function_name": "register_pm_qos_misc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "590-602",
    "snippet": "static int register_pm_qos_misc(struct pm_qos_object *qos, struct dentry *d)\n{\n\tqos->pm_qos_power_miscdev.minor = MISC_DYNAMIC_MINOR;\n\tqos->pm_qos_power_miscdev.name = qos->name;\n\tqos->pm_qos_power_miscdev.fops = &pm_qos_power_fops;\n\n\tif (d) {\n\t\t(void)debugfs_create_file(qos->name, S_IRUGO, d,\n\t\t\t\t\t  (void *)qos, &pm_qos_debug_fops);\n\t}\n\n\treturn misc_register(&qos->pm_qos_power_miscdev);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct file_operations pm_qos_power_fops = {\n\t.write = pm_qos_power_write,\n\t.read = pm_qos_power_read,\n\t.open = pm_qos_power_open,\n\t.release = pm_qos_power_release,\n\t.llseek = noop_llseek,\n};",
      "static const struct file_operations pm_qos_debug_fops = {\n\t.open           = pm_qos_dbg_open,\n\t.read           = seq_read,\n\t.llseek         = seq_lseek,\n\t.release        = single_release,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "misc_register",
          "args": [
            "&qos->pm_qos_power_miscdev"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "qos->name",
            "S_IRUGO",
            "d",
            "(void *)qos",
            "&pm_qos_debug_fops"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic const struct file_operations pm_qos_power_fops = {\n\t.write = pm_qos_power_write,\n\t.read = pm_qos_power_read,\n\t.open = pm_qos_power_open,\n\t.release = pm_qos_power_release,\n\t.llseek = noop_llseek,\n};\nstatic const struct file_operations pm_qos_debug_fops = {\n\t.open           = pm_qos_dbg_open,\n\t.read           = seq_read,\n\t.llseek         = seq_lseek,\n\t.release        = single_release,\n};\n\nstatic int register_pm_qos_misc(struct pm_qos_object *qos, struct dentry *d)\n{\n\tqos->pm_qos_power_miscdev.minor = MISC_DYNAMIC_MINOR;\n\tqos->pm_qos_power_miscdev.name = qos->name;\n\tqos->pm_qos_power_miscdev.fops = &pm_qos_power_fops;\n\n\tif (d) {\n\t\t(void)debugfs_create_file(qos->name, S_IRUGO, d,\n\t\t\t\t\t  (void *)qos, &pm_qos_debug_fops);\n\t}\n\n\treturn misc_register(&qos->pm_qos_power_miscdev);\n}"
  },
  {
    "function_name": "pm_qos_remove_notifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "577-586",
    "snippet": "int pm_qos_remove_notifier(int pm_qos_class, struct notifier_block *notifier)\n{\n\tint retval;\n\n\tretval = blocking_notifier_chain_unregister(\n\t\t\tpm_qos_array[pm_qos_class]->constraints->notifiers,\n\t\t\tnotifier);\n\n\treturn retval;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "blocking_notifier_chain_unregister",
          "args": [
            "pm_qos_array[pm_qos_class]->constraints->notifiers",
            "notifier"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "blocking_notifier_chain_unregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/notifier.c",
          "lines": "266-283",
          "snippet": "int blocking_notifier_chain_unregister(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_unregister(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_unregister(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint blocking_notifier_chain_unregister(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_unregister(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_unregister(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nint pm_qos_remove_notifier(int pm_qos_class, struct notifier_block *notifier)\n{\n\tint retval;\n\n\tretval = blocking_notifier_chain_unregister(\n\t\t\tpm_qos_array[pm_qos_class]->constraints->notifiers,\n\t\t\tnotifier);\n\n\treturn retval;\n}"
  },
  {
    "function_name": "pm_qos_add_notifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "557-566",
    "snippet": "int pm_qos_add_notifier(int pm_qos_class, struct notifier_block *notifier)\n{\n\tint retval;\n\n\tretval = blocking_notifier_chain_register(\n\t\t\tpm_qos_array[pm_qos_class]->constraints->notifiers,\n\t\t\tnotifier);\n\n\treturn retval;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "blocking_notifier_chain_register",
          "args": [
            "pm_qos_array[pm_qos_class]->constraints->notifiers",
            "notifier"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "blocking_notifier_chain_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/notifier.c",
          "lines": "213-230",
          "snippet": "int blocking_notifier_chain_register(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_register(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_register(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint blocking_notifier_chain_register(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_register(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_register(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nint pm_qos_add_notifier(int pm_qos_class, struct notifier_block *notifier)\n{\n\tint retval;\n\n\tretval = blocking_notifier_chain_register(\n\t\t\tpm_qos_array[pm_qos_class]->constraints->notifiers,\n\t\t\tnotifier);\n\n\treturn retval;\n}"
  },
  {
    "function_name": "pm_qos_remove_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "528-546",
    "snippet": "void pm_qos_remove_request(struct pm_qos_request *req)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\t\t/* silent return to keep pcm code cleaner */\n\n\tif (!pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_remove_request() called for unknown object\\n\");\n\t\treturn;\n\t}\n\n\tcancel_delayed_work_sync(&req->work);\n\n\ttrace_pm_qos_remove_request(req->pm_qos_class, PM_QOS_DEFAULT_VALUE);\n\tpm_qos_update_target(pm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t     &req->node, PM_QOS_REMOVE_REQ,\n\t\t\t     PM_QOS_DEFAULT_VALUE);\n\tmemset(req, 0, sizeof(*req));\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "req",
            "0",
            "sizeof(*req)"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_qos_update_target",
          "args": [
            "pm_qos_array[req->pm_qos_class]->constraints",
            "&req->node",
            "PM_QOS_REMOVE_REQ",
            "PM_QOS_DEFAULT_VALUE"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_update_target",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "272-323",
          "snippet": "int pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tunsigned long flags;\n\tint prev_value, curr_value, new_value;\n\tint ret;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * to change the list, we atomically remove, reinit\n\t\t * with new value and add, then see if the extremal\n\t\t * changed\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\tif (prev_value != curr_value) {\n\t\tret = 1;\n\t\tif (c->notifiers)\n\t\t\tblocking_notifier_call_chain(c->notifiers,\n\t\t\t\t\t\t     (unsigned long)curr_value,\n\t\t\t\t\t\t     NULL);\n\t} else {\n\t\tret = 0;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(pm_qos_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nint pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tunsigned long flags;\n\tint prev_value, curr_value, new_value;\n\tint ret;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * to change the list, we atomically remove, reinit\n\t\t * with new value and add, then see if the extremal\n\t\t * changed\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\tif (prev_value != curr_value) {\n\t\tret = 1;\n\t\tif (c->notifiers)\n\t\t\tblocking_notifier_call_chain(c->notifiers,\n\t\t\t\t\t\t     (unsigned long)curr_value,\n\t\t\t\t\t\t     NULL);\n\t} else {\n\t\tret = 0;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_pm_qos_remove_request",
          "args": [
            "req->pm_qos_class",
            "PM_QOS_DEFAULT_VALUE"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cancel_delayed_work_sync",
          "args": [
            "&req->work"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "cancel_delayed_work_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/workqueue.c",
          "lines": "3134-3137",
          "snippet": "bool cancel_delayed_work_sync(struct delayed_work *dwork)\n{\n\treturn __cancel_work_timer(&dwork->work, true);\n}",
          "includes": [
            "#include <trace/events/workqueue.h>",
            "#include \"workqueue_internal.h\"",
            "#include <linux/nmi.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/rculist.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/jhash.h>",
            "#include <linux/idr.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/freezer.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/kthread.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/completion.h>",
            "#include <linux/signal.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/workqueue.h>\n#include \"workqueue_internal.h\"\n#include <linux/nmi.h>\n#include <linux/sched/isolation.h>\n#include <linux/uaccess.h>\n#include <linux/moduleparam.h>\n#include <linux/nodemask.h>\n#include <linux/rculist.h>\n#include <linux/hashtable.h>\n#include <linux/jhash.h>\n#include <linux/idr.h>\n#include <linux/lockdep.h>\n#include <linux/debug_locks.h>\n#include <linux/freezer.h>\n#include <linux/mempolicy.h>\n#include <linux/hardirq.h>\n#include <linux/kthread.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/completion.h>\n#include <linux/signal.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nbool cancel_delayed_work_sync(struct delayed_work *dwork)\n{\n\treturn __cancel_work_timer(&dwork->work, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "KERN_ERR \"pm_qos_remove_request() called for unknown object\\n\""
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_qos_request_active",
          "args": [
            "req"
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_request_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "402-405",
          "snippet": "int pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nvoid pm_qos_remove_request(struct pm_qos_request *req)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\t\t/* silent return to keep pcm code cleaner */\n\n\tif (!pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_remove_request() called for unknown object\\n\");\n\t\treturn;\n\t}\n\n\tcancel_delayed_work_sync(&req->work);\n\n\ttrace_pm_qos_remove_request(req->pm_qos_class, PM_QOS_DEFAULT_VALUE);\n\tpm_qos_update_target(pm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t     &req->node, PM_QOS_REMOVE_REQ,\n\t\t\t     PM_QOS_DEFAULT_VALUE);\n\tmemset(req, 0, sizeof(*req));\n}"
  },
  {
    "function_name": "pm_qos_update_request_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "499-518",
    "snippet": "void pm_qos_update_request_timeout(struct pm_qos_request *req, s32 new_value,\n\t\t\t\t   unsigned long timeout_us)\n{\n\tif (!req)\n\t\treturn;\n\tif (WARN(!pm_qos_request_active(req),\n\t\t \"%s called for unknown object.\", __func__))\n\t\treturn;\n\n\tcancel_delayed_work_sync(&req->work);\n\n\ttrace_pm_qos_update_request_timeout(req->pm_qos_class,\n\t\t\t\t\t    new_value, timeout_us);\n\tif (new_value != req->node.prio)\n\t\tpm_qos_update_target(\n\t\t\tpm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t&req->node, PM_QOS_UPDATE_REQ, new_value);\n\n\tschedule_delayed_work(&req->work, usecs_to_jiffies(timeout_us));\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "schedule_delayed_work",
          "args": [
            "&req->work",
            "usecs_to_jiffies(timeout_us)"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "usecs_to_jiffies",
          "args": [
            "timeout_us"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "__usecs_to_jiffies",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "576-581",
          "snippet": "unsigned long __usecs_to_jiffies(const unsigned int u)\n{\n\tif (u > jiffies_to_usecs(MAX_JIFFY_OFFSET))\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _usecs_to_jiffies(u);\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned long __usecs_to_jiffies(const unsigned int u)\n{\n\tif (u > jiffies_to_usecs(MAX_JIFFY_OFFSET))\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _usecs_to_jiffies(u);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_qos_update_target",
          "args": [
            "pm_qos_array[req->pm_qos_class]->constraints",
            "&req->node",
            "PM_QOS_UPDATE_REQ",
            "new_value"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_update_target",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "272-323",
          "snippet": "int pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tunsigned long flags;\n\tint prev_value, curr_value, new_value;\n\tint ret;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * to change the list, we atomically remove, reinit\n\t\t * with new value and add, then see if the extremal\n\t\t * changed\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\tif (prev_value != curr_value) {\n\t\tret = 1;\n\t\tif (c->notifiers)\n\t\t\tblocking_notifier_call_chain(c->notifiers,\n\t\t\t\t\t\t     (unsigned long)curr_value,\n\t\t\t\t\t\t     NULL);\n\t} else {\n\t\tret = 0;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(pm_qos_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nint pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tunsigned long flags;\n\tint prev_value, curr_value, new_value;\n\tint ret;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * to change the list, we atomically remove, reinit\n\t\t * with new value and add, then see if the extremal\n\t\t * changed\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\tif (prev_value != curr_value) {\n\t\tret = 1;\n\t\tif (c->notifiers)\n\t\t\tblocking_notifier_call_chain(c->notifiers,\n\t\t\t\t\t\t     (unsigned long)curr_value,\n\t\t\t\t\t\t     NULL);\n\t} else {\n\t\tret = 0;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_pm_qos_update_request_timeout",
          "args": [
            "req->pm_qos_class",
            "new_value",
            "timeout_us"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cancel_delayed_work_sync",
          "args": [
            "&req->work"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "cancel_delayed_work_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/workqueue.c",
          "lines": "3134-3137",
          "snippet": "bool cancel_delayed_work_sync(struct delayed_work *dwork)\n{\n\treturn __cancel_work_timer(&dwork->work, true);\n}",
          "includes": [
            "#include <trace/events/workqueue.h>",
            "#include \"workqueue_internal.h\"",
            "#include <linux/nmi.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/rculist.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/jhash.h>",
            "#include <linux/idr.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/freezer.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/kthread.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/completion.h>",
            "#include <linux/signal.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/workqueue.h>\n#include \"workqueue_internal.h\"\n#include <linux/nmi.h>\n#include <linux/sched/isolation.h>\n#include <linux/uaccess.h>\n#include <linux/moduleparam.h>\n#include <linux/nodemask.h>\n#include <linux/rculist.h>\n#include <linux/hashtable.h>\n#include <linux/jhash.h>\n#include <linux/idr.h>\n#include <linux/lockdep.h>\n#include <linux/debug_locks.h>\n#include <linux/freezer.h>\n#include <linux/mempolicy.h>\n#include <linux/hardirq.h>\n#include <linux/kthread.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/completion.h>\n#include <linux/signal.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nbool cancel_delayed_work_sync(struct delayed_work *dwork)\n{\n\treturn __cancel_work_timer(&dwork->work, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "!pm_qos_request_active(req)",
            "\"%s called for unknown object.\"",
            "__func__"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_qos_request_active",
          "args": [
            "req"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_request_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "402-405",
          "snippet": "int pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nvoid pm_qos_update_request_timeout(struct pm_qos_request *req, s32 new_value,\n\t\t\t\t   unsigned long timeout_us)\n{\n\tif (!req)\n\t\treturn;\n\tif (WARN(!pm_qos_request_active(req),\n\t\t \"%s called for unknown object.\", __func__))\n\t\treturn;\n\n\tcancel_delayed_work_sync(&req->work);\n\n\ttrace_pm_qos_update_request_timeout(req->pm_qos_class,\n\t\t\t\t\t    new_value, timeout_us);\n\tif (new_value != req->node.prio)\n\t\tpm_qos_update_target(\n\t\t\tpm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t&req->node, PM_QOS_UPDATE_REQ, new_value);\n\n\tschedule_delayed_work(&req->work, usecs_to_jiffies(timeout_us));\n}"
  },
  {
    "function_name": "pm_qos_update_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "475-488",
    "snippet": "void pm_qos_update_request(struct pm_qos_request *req,\n\t\t\t   s32 new_value)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\n\tif (!pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_update_request() called for unknown object\\n\");\n\t\treturn;\n\t}\n\n\tcancel_delayed_work_sync(&req->work);\n\t__pm_qos_update_request(req, new_value);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__pm_qos_update_request",
          "args": [
            "req",
            "new_value"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "__pm_qos_update_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "408-417",
          "snippet": "static void __pm_qos_update_request(struct pm_qos_request *req,\n\t\t\t   s32 new_value)\n{\n\ttrace_pm_qos_update_request(req->pm_qos_class, new_value);\n\n\tif (new_value != req->node.prio)\n\t\tpm_qos_update_target(\n\t\t\tpm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t&req->node, PM_QOS_UPDATE_REQ, new_value);\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nstatic void __pm_qos_update_request(struct pm_qos_request *req,\n\t\t\t   s32 new_value)\n{\n\ttrace_pm_qos_update_request(req->pm_qos_class, new_value);\n\n\tif (new_value != req->node.prio)\n\t\tpm_qos_update_target(\n\t\t\tpm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t&req->node, PM_QOS_UPDATE_REQ, new_value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cancel_delayed_work_sync",
          "args": [
            "&req->work"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "cancel_delayed_work_sync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/workqueue.c",
          "lines": "3134-3137",
          "snippet": "bool cancel_delayed_work_sync(struct delayed_work *dwork)\n{\n\treturn __cancel_work_timer(&dwork->work, true);\n}",
          "includes": [
            "#include <trace/events/workqueue.h>",
            "#include \"workqueue_internal.h\"",
            "#include <linux/nmi.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/rculist.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/jhash.h>",
            "#include <linux/idr.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/freezer.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/kthread.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/completion.h>",
            "#include <linux/signal.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/workqueue.h>\n#include \"workqueue_internal.h\"\n#include <linux/nmi.h>\n#include <linux/sched/isolation.h>\n#include <linux/uaccess.h>\n#include <linux/moduleparam.h>\n#include <linux/nodemask.h>\n#include <linux/rculist.h>\n#include <linux/hashtable.h>\n#include <linux/jhash.h>\n#include <linux/idr.h>\n#include <linux/lockdep.h>\n#include <linux/debug_locks.h>\n#include <linux/freezer.h>\n#include <linux/mempolicy.h>\n#include <linux/hardirq.h>\n#include <linux/kthread.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/completion.h>\n#include <linux/signal.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nbool cancel_delayed_work_sync(struct delayed_work *dwork)\n{\n\treturn __cancel_work_timer(&dwork->work, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "KERN_ERR \"pm_qos_update_request() called for unknown object\\n\""
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_qos_request_active",
          "args": [
            "req"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_request_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "402-405",
          "snippet": "int pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nvoid pm_qos_update_request(struct pm_qos_request *req,\n\t\t\t   s32 new_value)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\n\tif (!pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_update_request() called for unknown object\\n\");\n\t\treturn;\n\t}\n\n\tcancel_delayed_work_sync(&req->work);\n\t__pm_qos_update_request(req, new_value);\n}"
  },
  {
    "function_name": "pm_qos_add_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "447-462",
    "snippet": "void pm_qos_add_request(struct pm_qos_request *req,\n\t\t\tint pm_qos_class, s32 value)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\n\tif (pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_add_request() called for already added request\\n\");\n\t\treturn;\n\t}\n\treq->pm_qos_class = pm_qos_class;\n\tINIT_DELAYED_WORK(&req->work, pm_qos_work_fn);\n\ttrace_pm_qos_add_request(pm_qos_class, value);\n\tpm_qos_update_target(pm_qos_array[pm_qos_class]->constraints,\n\t\t\t     &req->node, PM_QOS_ADD_REQ, value);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pm_qos_update_target",
          "args": [
            "pm_qos_array[pm_qos_class]->constraints",
            "&req->node",
            "PM_QOS_ADD_REQ",
            "value"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_update_target",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "272-323",
          "snippet": "int pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tunsigned long flags;\n\tint prev_value, curr_value, new_value;\n\tint ret;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * to change the list, we atomically remove, reinit\n\t\t * with new value and add, then see if the extremal\n\t\t * changed\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\tif (prev_value != curr_value) {\n\t\tret = 1;\n\t\tif (c->notifiers)\n\t\t\tblocking_notifier_call_chain(c->notifiers,\n\t\t\t\t\t\t     (unsigned long)curr_value,\n\t\t\t\t\t\t     NULL);\n\t} else {\n\t\tret = 0;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(pm_qos_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nint pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tunsigned long flags;\n\tint prev_value, curr_value, new_value;\n\tint ret;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * to change the list, we atomically remove, reinit\n\t\t * with new value and add, then see if the extremal\n\t\t * changed\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\tif (prev_value != curr_value) {\n\t\tret = 1;\n\t\tif (c->notifiers)\n\t\t\tblocking_notifier_call_chain(c->notifiers,\n\t\t\t\t\t\t     (unsigned long)curr_value,\n\t\t\t\t\t\t     NULL);\n\t} else {\n\t\tret = 0;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_pm_qos_add_request",
          "args": [
            "pm_qos_class",
            "value"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_DELAYED_WORK",
          "args": [
            "&req->work",
            "pm_qos_work_fn"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "KERN_ERR \"pm_qos_add_request() called for already added request\\n\""
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_qos_request_active",
          "args": [
            "req"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_request_active",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "402-405",
          "snippet": "int pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nvoid pm_qos_add_request(struct pm_qos_request *req,\n\t\t\tint pm_qos_class, s32 value)\n{\n\tif (!req) /*guard against callers passing in null */\n\t\treturn;\n\n\tif (pm_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"pm_qos_add_request() called for already added request\\n\");\n\t\treturn;\n\t}\n\treq->pm_qos_class = pm_qos_class;\n\tINIT_DELAYED_WORK(&req->work, pm_qos_work_fn);\n\ttrace_pm_qos_add_request(pm_qos_class, value);\n\tpm_qos_update_target(pm_qos_array[pm_qos_class]->constraints,\n\t\t\t     &req->node, PM_QOS_ADD_REQ, value);\n}"
  },
  {
    "function_name": "pm_qos_work_fn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "425-432",
    "snippet": "static void pm_qos_work_fn(struct work_struct *work)\n{\n\tstruct pm_qos_request *req = container_of(to_delayed_work(work),\n\t\t\t\t\t\t  struct pm_qos_request,\n\t\t\t\t\t\t  work);\n\n\t__pm_qos_update_request(req, PM_QOS_DEFAULT_VALUE);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__pm_qos_update_request",
          "args": [
            "req",
            "PM_QOS_DEFAULT_VALUE"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "__pm_qos_update_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "408-417",
          "snippet": "static void __pm_qos_update_request(struct pm_qos_request *req,\n\t\t\t   s32 new_value)\n{\n\ttrace_pm_qos_update_request(req->pm_qos_class, new_value);\n\n\tif (new_value != req->node.prio)\n\t\tpm_qos_update_target(\n\t\t\tpm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t&req->node, PM_QOS_UPDATE_REQ, new_value);\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nstatic void __pm_qos_update_request(struct pm_qos_request *req,\n\t\t\t   s32 new_value)\n{\n\ttrace_pm_qos_update_request(req->pm_qos_class, new_value);\n\n\tif (new_value != req->node.prio)\n\t\tpm_qos_update_target(\n\t\t\tpm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t&req->node, PM_QOS_UPDATE_REQ, new_value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "to_delayed_work(work)",
            "structpm_qos_request",
            "work"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_delayed_work",
          "args": [
            "work"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic void pm_qos_work_fn(struct work_struct *work)\n{\n\tstruct pm_qos_request *req = container_of(to_delayed_work(work),\n\t\t\t\t\t\t  struct pm_qos_request,\n\t\t\t\t\t\t  work);\n\n\t__pm_qos_update_request(req, PM_QOS_DEFAULT_VALUE);\n}"
  },
  {
    "function_name": "__pm_qos_update_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "408-417",
    "snippet": "static void __pm_qos_update_request(struct pm_qos_request *req,\n\t\t\t   s32 new_value)\n{\n\ttrace_pm_qos_update_request(req->pm_qos_class, new_value);\n\n\tif (new_value != req->node.prio)\n\t\tpm_qos_update_target(\n\t\t\tpm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t&req->node, PM_QOS_UPDATE_REQ, new_value);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pm_qos_update_target",
          "args": [
            "pm_qos_array[req->pm_qos_class]->constraints",
            "&req->node",
            "PM_QOS_UPDATE_REQ",
            "new_value"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_update_target",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "272-323",
          "snippet": "int pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tunsigned long flags;\n\tint prev_value, curr_value, new_value;\n\tint ret;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * to change the list, we atomically remove, reinit\n\t\t * with new value and add, then see if the extremal\n\t\t * changed\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\tif (prev_value != curr_value) {\n\t\tret = 1;\n\t\tif (c->notifiers)\n\t\t\tblocking_notifier_call_chain(c->notifiers,\n\t\t\t\t\t\t     (unsigned long)curr_value,\n\t\t\t\t\t\t     NULL);\n\t} else {\n\t\tret = 0;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(pm_qos_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nint pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tunsigned long flags;\n\tint prev_value, curr_value, new_value;\n\tint ret;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * to change the list, we atomically remove, reinit\n\t\t * with new value and add, then see if the extremal\n\t\t * changed\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\tif (prev_value != curr_value) {\n\t\tret = 1;\n\t\tif (c->notifiers)\n\t\t\tblocking_notifier_call_chain(c->notifiers,\n\t\t\t\t\t\t     (unsigned long)curr_value,\n\t\t\t\t\t\t     NULL);\n\t} else {\n\t\tret = 0;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_pm_qos_update_request",
          "args": [
            "req->pm_qos_class",
            "new_value"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nstatic void __pm_qos_update_request(struct pm_qos_request *req,\n\t\t\t   s32 new_value)\n{\n\ttrace_pm_qos_update_request(req->pm_qos_class, new_value);\n\n\tif (new_value != req->node.prio)\n\t\tpm_qos_update_target(\n\t\t\tpm_qos_array[req->pm_qos_class]->constraints,\n\t\t\t&req->node, PM_QOS_UPDATE_REQ, new_value);\n}"
  },
  {
    "function_name": "pm_qos_request_active",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "402-405",
    "snippet": "int pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint pm_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->pm_qos_class != 0;\n}"
  },
  {
    "function_name": "pm_qos_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "396-399",
    "snippet": "int pm_qos_request(int pm_qos_class)\n{\n\treturn pm_qos_read_value(pm_qos_array[pm_qos_class]->constraints);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pm_qos_read_value",
          "args": [
            "pm_qos_array[pm_qos_class]->constraints"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_read_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "177-180",
          "snippet": "s32 pm_qos_read_value(struct pm_qos_constraints *c)\n{\n\treturn c->target_value;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\ns32 pm_qos_read_value(struct pm_qos_constraints *c)\n{\n\treturn c->target_value;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic struct pm_qos_object *pm_qos_array[] = {\n\t&null_pm_qos,\n\t&cpu_dma_pm_qos,\n\t&network_lat_pm_qos,\n\t&network_throughput_pm_qos,\n\t&memory_bandwidth_pm_qos,\n};\n\nint pm_qos_request(int pm_qos_class)\n{\n\treturn pm_qos_read_value(pm_qos_array[pm_qos_class]->constraints);\n}"
  },
  {
    "function_name": "pm_qos_update_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "353-388",
    "snippet": "bool pm_qos_update_flags(struct pm_qos_flags *pqf,\n\t\t\t struct pm_qos_flags_request *req,\n\t\t\t enum pm_qos_req_action action, s32 val)\n{\n\tunsigned long irqflags;\n\ts32 prev_value, curr_value;\n\n\tspin_lock_irqsave(&pm_qos_lock, irqflags);\n\n\tprev_value = list_empty(&pqf->list) ? 0 : pqf->effective_flags;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tpm_qos_flags_remove_req(pqf, req);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\tpm_qos_flags_remove_req(pqf, req);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\treq->flags = val;\n\t\tINIT_LIST_HEAD(&req->node);\n\t\tlist_add_tail(&req->node, &pqf->list);\n\t\tpqf->effective_flags |= val;\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = list_empty(&pqf->list) ? 0 : pqf->effective_flags;\n\n\tspin_unlock_irqrestore(&pm_qos_lock, irqflags);\n\n\ttrace_pm_qos_update_flags(action, prev_value, curr_value);\n\treturn prev_value != curr_value;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(pm_qos_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_pm_qos_update_flags",
          "args": [
            "action",
            "prev_value",
            "curr_value"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&pm_qos_lock",
            "irqflags"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&pqf->list"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "50-53",
          "snippet": "static inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !rsclp->head;\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !rsclp->head;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&req->node",
            "&pqf->list"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&req->node"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_qos_flags_remove_req",
          "args": [
            "pqf",
            "req"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_flags_remove_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "330-340",
          "snippet": "static void pm_qos_flags_remove_req(struct pm_qos_flags *pqf,\n\t\t\t\t    struct pm_qos_flags_request *req)\n{\n\ts32 val = 0;\n\n\tlist_del(&req->node);\n\tlist_for_each_entry(req, &pqf->list, node)\n\t\tval |= req->flags;\n\n\tpqf->effective_flags = val;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic void pm_qos_flags_remove_req(struct pm_qos_flags *pqf,\n\t\t\t\t    struct pm_qos_flags_request *req)\n{\n\ts32 val = 0;\n\n\tlist_del(&req->node);\n\tlist_for_each_entry(req, &pqf->list, node)\n\t\tval |= req->flags;\n\n\tpqf->effective_flags = val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&pm_qos_lock",
            "irqflags"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nbool pm_qos_update_flags(struct pm_qos_flags *pqf,\n\t\t\t struct pm_qos_flags_request *req,\n\t\t\t enum pm_qos_req_action action, s32 val)\n{\n\tunsigned long irqflags;\n\ts32 prev_value, curr_value;\n\n\tspin_lock_irqsave(&pm_qos_lock, irqflags);\n\n\tprev_value = list_empty(&pqf->list) ? 0 : pqf->effective_flags;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tpm_qos_flags_remove_req(pqf, req);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\tpm_qos_flags_remove_req(pqf, req);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\treq->flags = val;\n\t\tINIT_LIST_HEAD(&req->node);\n\t\tlist_add_tail(&req->node, &pqf->list);\n\t\tpqf->effective_flags |= val;\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = list_empty(&pqf->list) ? 0 : pqf->effective_flags;\n\n\tspin_unlock_irqrestore(&pm_qos_lock, irqflags);\n\n\ttrace_pm_qos_update_flags(action, prev_value, curr_value);\n\treturn prev_value != curr_value;\n}"
  },
  {
    "function_name": "pm_qos_flags_remove_req",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "330-340",
    "snippet": "static void pm_qos_flags_remove_req(struct pm_qos_flags *pqf,\n\t\t\t\t    struct pm_qos_flags_request *req)\n{\n\ts32 val = 0;\n\n\tlist_del(&req->node);\n\tlist_for_each_entry(req, &pqf->list, node)\n\t\tval |= req->flags;\n\n\tpqf->effective_flags = val;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "req",
            "&pqf->list",
            "node"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&req->node"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "list_del_leaf_cfs_rq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/sched/fair.c",
          "lines": "446-448",
          "snippet": "static inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}",
          "includes": [
            "#include \"sched-pelt.h\"",
            "#include \"pelt.h\"",
            "#include <trace/events/sched.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void check_enqueue_throttle(struct cfs_rq *cfs_rq);",
            "static __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);",
            "static bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sched-pelt.h\"\n#include \"pelt.h\"\n#include <trace/events/sched.h>\n#include \"sched.h\"\n\nstatic void check_enqueue_throttle(struct cfs_rq *cfs_rq);\nstatic __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);\nstatic bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);\n\nstatic inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic void pm_qos_flags_remove_req(struct pm_qos_flags *pqf,\n\t\t\t\t    struct pm_qos_flags_request *req)\n{\n\ts32 val = 0;\n\n\tlist_del(&req->node);\n\tlist_for_each_entry(req, &pqf->list, node)\n\t\tval |= req->flags;\n\n\tpqf->effective_flags = val;\n}"
  },
  {
    "function_name": "pm_qos_update_target",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "272-323",
    "snippet": "int pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tunsigned long flags;\n\tint prev_value, curr_value, new_value;\n\tint ret;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * to change the list, we atomically remove, reinit\n\t\t * with new value and add, then see if the extremal\n\t\t * changed\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\tif (prev_value != curr_value) {\n\t\tret = 1;\n\t\tif (c->notifiers)\n\t\t\tblocking_notifier_call_chain(c->notifiers,\n\t\t\t\t\t\t     (unsigned long)curr_value,\n\t\t\t\t\t\t     NULL);\n\t} else {\n\t\tret = 0;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(pm_qos_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "blocking_notifier_call_chain",
          "args": [
            "c->notifiers",
            "(unsigned long)curr_value",
            "NULL"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "blocking_notifier_call_chain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/notifier.c",
          "lines": "325-329",
          "snippet": "int blocking_notifier_call_chain(struct blocking_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\treturn __blocking_notifier_call_chain(nh, val, v, -1, NULL);\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint blocking_notifier_call_chain(struct blocking_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\treturn __blocking_notifier_call_chain(nh, val, v, -1, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_pm_qos_update_target",
          "args": [
            "action",
            "prev_value",
            "curr_value"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&pm_qos_lock",
            "flags"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_qos_set_value",
          "args": [
            "c",
            "curr_value"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_set_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "182-185",
          "snippet": "static inline void pm_qos_set_value(struct pm_qos_constraints *c, s32 value)\n{\n\tc->target_value = value;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic inline void pm_qos_set_value(struct pm_qos_constraints *c, s32 value)\n{\n\tc->target_value = value;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_qos_get_value",
          "args": [
            "c"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_get_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "149-175",
          "snippet": "static inline int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tstruct plist_node *node;\n\tint total_value = 0;\n\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tcase PM_QOS_SUM:\n\t\tplist_for_each(node, &c->list)\n\t\t\ttotal_value += node->prio;\n\n\t\treturn total_value;\n\n\tdefault:\n\t\t/* runtime check for not using enum */\n\t\tBUG();\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic inline int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tstruct plist_node *node;\n\tint total_value = 0;\n\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tcase PM_QOS_SUM:\n\t\tplist_for_each(node, &c->list)\n\t\t\ttotal_value += node->prio;\n\n\t\treturn total_value;\n\n\tdefault:\n\t\t/* runtime check for not using enum */\n\t\tBUG();\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_add",
          "args": [
            "node",
            "&c->list"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_node_init",
          "args": [
            "node",
            "new_value"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_del",
          "args": [
            "node",
            "&c->list"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_del",
          "args": [
            "node",
            "&c->list"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&pm_qos_lock",
            "flags"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nint pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tunsigned long flags;\n\tint prev_value, curr_value, new_value;\n\tint ret;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * to change the list, we atomically remove, reinit\n\t\t * with new value and add, then see if the extremal\n\t\t * changed\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\t/* fall through */\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\tif (prev_value != curr_value) {\n\t\tret = 1;\n\t\tif (c->notifiers)\n\t\t\tblocking_notifier_call_chain(c->notifiers,\n\t\t\t\t\t\t     (unsigned long)curr_value,\n\t\t\t\t\t\t     NULL);\n\t} else {\n\t\tret = 0;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "pm_qos_dbg_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "248-252",
    "snippet": "static int pm_qos_dbg_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, pm_qos_dbg_show_requests,\n\t\t\t   inode->i_private);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "single_open",
          "args": [
            "file",
            "pm_qos_dbg_show_requests",
            "inode->i_private"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic int pm_qos_dbg_open(struct inode *inode, struct file *file)\n{\n\treturn single_open(file, pm_qos_dbg_show_requests,\n\t\t\t   inode->i_private);\n}"
  },
  {
    "function_name": "pm_qos_dbg_show_requests",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "187-246",
    "snippet": "static int pm_qos_dbg_show_requests(struct seq_file *s, void *unused)\n{\n\tstruct pm_qos_object *qos = (struct pm_qos_object *)s->private;\n\tstruct pm_qos_constraints *c;\n\tstruct pm_qos_request *req;\n\tchar *type;\n\tunsigned long flags;\n\tint tot_reqs = 0;\n\tint active_reqs = 0;\n\n\tif (IS_ERR_OR_NULL(qos)) {\n\t\tpr_err(\"%s: bad qos param!\\n\", __func__);\n\t\treturn -EINVAL;\n\t}\n\tc = qos->constraints;\n\tif (IS_ERR_OR_NULL(c)) {\n\t\tpr_err(\"%s: Bad constraints on qos?\\n\", __func__);\n\t\treturn -EINVAL;\n\t}\n\n\t/* Lock to ensure we have a snapshot */\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tif (plist_head_empty(&c->list)) {\n\t\tseq_puts(s, \"Empty!\\n\");\n\t\tgoto out;\n\t}\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\ttype = \"Minimum\";\n\t\tbreak;\n\tcase PM_QOS_MAX:\n\t\ttype = \"Maximum\";\n\t\tbreak;\n\tcase PM_QOS_SUM:\n\t\ttype = \"Sum\";\n\t\tbreak;\n\tdefault:\n\t\ttype = \"Unknown\";\n\t}\n\n\tplist_for_each_entry(req, &c->list, node) {\n\t\tchar *state = \"Default\";\n\n\t\tif ((req->node).prio != c->default_value) {\n\t\t\tactive_reqs++;\n\t\t\tstate = \"Active\";\n\t\t}\n\t\ttot_reqs++;\n\t\tseq_printf(s, \"%d: %d: %s\\n\", tot_reqs,\n\t\t\t   (req->node).prio, state);\n\t}\n\n\tseq_printf(s, \"Type=%s, Value=%d, Requests: active=%d / total=%d\\n\",\n\t\t   type, pm_qos_get_value(c), active_reqs, tot_reqs);\n\nout:\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(pm_qos_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&pm_qos_lock",
            "flags"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\"Type=%s, Value=%d, Requests: active=%d / total=%d\\n\"",
            "type",
            "pm_qos_get_value(c)",
            "active_reqs",
            "tot_reqs"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_seq.c",
          "lines": "84-103",
          "snippet": "void trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_qos_get_value",
          "args": [
            "c"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_get_value",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
          "lines": "149-175",
          "snippet": "static inline int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tstruct plist_node *node;\n\tint total_value = 0;\n\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tcase PM_QOS_SUM:\n\t\tplist_for_each(node, &c->list)\n\t\t\ttotal_value += node->prio;\n\n\t\treturn total_value;\n\n\tdefault:\n\t\t/* runtime check for not using enum */\n\t\tBUG();\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic inline int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tstruct plist_node *node;\n\tint total_value = 0;\n\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tcase PM_QOS_SUM:\n\t\tplist_for_each(node, &c->list)\n\t\t\ttotal_value += node->prio;\n\n\t\treturn total_value;\n\n\tdefault:\n\t\t/* runtime check for not using enum */\n\t\tBUG();\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_for_each_entry",
          "args": [
            "req",
            "&c->list",
            "node"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "s",
            "\"Empty!\\n\""
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_seq.c",
          "lines": "208-223",
          "snippet": "void trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_head_empty",
          "args": [
            "&c->list"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&pm_qos_lock",
            "flags"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s: Bad constraints on qos?\\n\"",
            "__func__"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "c"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s: bad qos param!\\n\"",
            "__func__"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "qos"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nstatic int pm_qos_dbg_show_requests(struct seq_file *s, void *unused)\n{\n\tstruct pm_qos_object *qos = (struct pm_qos_object *)s->private;\n\tstruct pm_qos_constraints *c;\n\tstruct pm_qos_request *req;\n\tchar *type;\n\tunsigned long flags;\n\tint tot_reqs = 0;\n\tint active_reqs = 0;\n\n\tif (IS_ERR_OR_NULL(qos)) {\n\t\tpr_err(\"%s: bad qos param!\\n\", __func__);\n\t\treturn -EINVAL;\n\t}\n\tc = qos->constraints;\n\tif (IS_ERR_OR_NULL(c)) {\n\t\tpr_err(\"%s: Bad constraints on qos?\\n\", __func__);\n\t\treturn -EINVAL;\n\t}\n\n\t/* Lock to ensure we have a snapshot */\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tif (plist_head_empty(&c->list)) {\n\t\tseq_puts(s, \"Empty!\\n\");\n\t\tgoto out;\n\t}\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\ttype = \"Minimum\";\n\t\tbreak;\n\tcase PM_QOS_MAX:\n\t\ttype = \"Maximum\";\n\t\tbreak;\n\tcase PM_QOS_SUM:\n\t\ttype = \"Sum\";\n\t\tbreak;\n\tdefault:\n\t\ttype = \"Unknown\";\n\t}\n\n\tplist_for_each_entry(req, &c->list, node) {\n\t\tchar *state = \"Default\";\n\n\t\tif ((req->node).prio != c->default_value) {\n\t\t\tactive_reqs++;\n\t\t\tstate = \"Active\";\n\t\t}\n\t\ttot_reqs++;\n\t\tseq_printf(s, \"%d: %d: %s\\n\", tot_reqs,\n\t\t\t   (req->node).prio, state);\n\t}\n\n\tseq_printf(s, \"Type=%s, Value=%d, Requests: active=%d / total=%d\\n\",\n\t\t   type, pm_qos_get_value(c), active_reqs, tot_reqs);\n\nout:\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\treturn 0;\n}"
  },
  {
    "function_name": "pm_qos_set_value",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "182-185",
    "snippet": "static inline void pm_qos_set_value(struct pm_qos_constraints *c, s32 value)\n{\n\tc->target_value = value;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic inline void pm_qos_set_value(struct pm_qos_constraints *c, s32 value)\n{\n\tc->target_value = value;\n}"
  },
  {
    "function_name": "pm_qos_read_value",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "177-180",
    "snippet": "s32 pm_qos_read_value(struct pm_qos_constraints *c)\n{\n\treturn c->target_value;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\ns32 pm_qos_read_value(struct pm_qos_constraints *c)\n{\n\treturn c->target_value;\n}"
  },
  {
    "function_name": "pm_qos_get_value",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/power/qos.c",
    "lines": "149-175",
    "snippet": "static inline int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tstruct plist_node *node;\n\tint total_value = 0;\n\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tcase PM_QOS_SUM:\n\t\tplist_for_each(node, &c->list)\n\t\t\ttotal_value += node->prio;\n\n\t\treturn total_value;\n\n\tdefault:\n\t\t/* runtime check for not using enum */\n\t\tBUG();\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_for_each",
          "args": [
            "node",
            "&c->list"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_last",
          "args": [
            "&c->list"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_first",
          "args": [
            "&c->list"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_head_empty",
          "args": [
            "&c->list"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic inline int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tstruct plist_node *node;\n\tint total_value = 0;\n\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tcase PM_QOS_SUM:\n\t\tplist_for_each(node, &c->list)\n\t\t\ttotal_value += node->prio;\n\n\t\treturn total_value;\n\n\tdefault:\n\t\t/* runtime check for not using enum */\n\t\tBUG();\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}"
  }
]