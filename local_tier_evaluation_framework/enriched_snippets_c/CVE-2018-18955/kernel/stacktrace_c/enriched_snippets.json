[
  {
    "function_name": "save_stack_trace_tsk_reliable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/stacktrace.c",
    "lines": "73-79",
    "snippet": "__weak int\nsave_stack_trace_tsk_reliable(struct task_struct *tsk,\n\t\t\t      struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_tsk_reliable() not implemented yet.\\n\");\n\treturn -ENOSYS;\n}",
    "includes": [
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "1",
            "KERN_INFO \"save_stack_tsk_reliable() not implemented yet.\\n\""
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\n__weak int\nsave_stack_trace_tsk_reliable(struct task_struct *tsk,\n\t\t\t      struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_tsk_reliable() not implemented yet.\\n\");\n\treturn -ENOSYS;\n}"
  },
  {
    "function_name": "save_stack_trace_regs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/stacktrace.c",
    "lines": "67-71",
    "snippet": "__weak void\nsave_stack_trace_regs(struct pt_regs *regs, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_regs() not implemented yet.\\n\");\n}",
    "includes": [
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "1",
            "KERN_INFO \"save_stack_trace_regs() not implemented yet.\\n\""
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\n__weak void\nsave_stack_trace_regs(struct pt_regs *regs, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_regs() not implemented yet.\\n\");\n}"
  },
  {
    "function_name": "save_stack_trace_tsk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/stacktrace.c",
    "lines": "61-65",
    "snippet": "__weak void\nsave_stack_trace_tsk(struct task_struct *tsk, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_tsk() not implemented yet.\\n\");\n}",
    "includes": [
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "1",
            "KERN_INFO \"save_stack_trace_tsk() not implemented yet.\\n\""
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\n__weak void\nsave_stack_trace_tsk(struct task_struct *tsk, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_tsk() not implemented yet.\\n\");\n}"
  },
  {
    "function_name": "snprint_stack_trace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/stacktrace.c",
    "lines": "26-53",
    "snippet": "int snprint_stack_trace(char *buf, size_t size,\n\t\t\tstruct stack_trace *trace, int spaces)\n{\n\tint i;\n\tint generated;\n\tint total = 0;\n\n\tif (WARN_ON(!trace->entries))\n\t\treturn 0;\n\n\tfor (i = 0; i < trace->nr_entries; i++) {\n\t\tgenerated = snprintf(buf, size, \"%*c%pS\\n\", 1 + spaces, ' ',\n\t\t\t\t     (void *)trace->entries[i]);\n\n\t\ttotal += generated;\n\n\t\t/* Assume that generated isn't a negative number */\n\t\tif (generated >= size) {\n\t\t\tbuf += size;\n\t\t\tsize = 0;\n\t\t} else {\n\t\t\tbuf += generated;\n\t\t\tsize -= generated;\n\t\t}\n\t}\n\n\treturn total;\n}",
    "includes": [
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "size",
            "\"%*c%pS\\n\"",
            "1 + spaces",
            "' '",
            "(void *)trace->entries[i]"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!trace->entries"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\nint snprint_stack_trace(char *buf, size_t size,\n\t\t\tstruct stack_trace *trace, int spaces)\n{\n\tint i;\n\tint generated;\n\tint total = 0;\n\n\tif (WARN_ON(!trace->entries))\n\t\treturn 0;\n\n\tfor (i = 0; i < trace->nr_entries; i++) {\n\t\tgenerated = snprintf(buf, size, \"%*c%pS\\n\", 1 + spaces, ' ',\n\t\t\t\t     (void *)trace->entries[i]);\n\n\t\ttotal += generated;\n\n\t\t/* Assume that generated isn't a negative number */\n\t\tif (generated >= size) {\n\t\t\tbuf += size;\n\t\t\tsize = 0;\n\t\t} else {\n\t\t\tbuf += generated;\n\t\t\tsize -= generated;\n\t\t}\n\t}\n\n\treturn total;\n}"
  },
  {
    "function_name": "print_stack_trace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/stacktrace.c",
    "lines": "14-23",
    "snippet": "void print_stack_trace(struct stack_trace *trace, int spaces)\n{\n\tint i;\n\n\tif (WARN_ON(!trace->entries))\n\t\treturn;\n\n\tfor (i = 0; i < trace->nr_entries; i++)\n\t\tprintk(\"%*c%pS\\n\", 1 + spaces, ' ', (void *)trace->entries[i]);\n}",
    "includes": [
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"%*c%pS\\n\"",
            "1 + spaces",
            "' '",
            "(void *)trace->entries[i]"
          ],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "__warn_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/panic.c",
          "lines": "590-599",
          "snippet": "void __warn_printk(const char *fmt, ...)\n{\n\tva_list args;\n\n\tpr_warn(CUT_HERE);\n\n\tva_start(args, fmt);\n\tvprintk(fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nvoid __warn_printk(const char *fmt, ...)\n{\n\tva_list args;\n\n\tpr_warn(CUT_HERE);\n\n\tva_start(args, fmt);\n\tvprintk(fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!trace->entries"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n\nvoid print_stack_trace(struct stack_trace *trace, int spaces)\n{\n\tint i;\n\n\tif (WARN_ON(!trace->entries))\n\t\treturn;\n\n\tfor (i = 0; i < trace->nr_entries; i++)\n\t\tprintk(\"%*c%pS\\n\", 1 + spaces, ' ', (void *)trace->entries[i]);\n}"
  }
]