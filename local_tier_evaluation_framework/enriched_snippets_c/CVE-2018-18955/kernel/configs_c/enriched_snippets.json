[
  {
    "function_name": "ikconfig_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/configs.c",
    "lines": "87-90",
    "snippet": "static void __exit ikconfig_cleanup(void)\n{\n\tremove_proc_entry(\"config.gz\", NULL);\n}",
    "includes": [
      "#include \"config_data.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/init.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "remove_proc_entry",
          "args": [
            "\"config.gz\"",
            "NULL"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config_data.h\"\n#include <linux/uaccess.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void __exit ikconfig_cleanup(void)\n{\n\tremove_proc_entry(\"config.gz\", NULL);\n}"
  },
  {
    "function_name": "ikconfig_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/configs.c",
    "lines": "72-85",
    "snippet": "static int __init ikconfig_init(void)\n{\n\tstruct proc_dir_entry *entry;\n\n\t/* create the current config file */\n\tentry = proc_create(\"config.gz\", S_IFREG | S_IRUGO, NULL,\n\t\t\t    &ikconfig_file_ops);\n\tif (!entry)\n\t\treturn -ENOMEM;\n\n\tproc_set_size(entry, kernel_config_data_size);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"config_data.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/init.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define kernel_config_data_size \\\n\t(sizeof(kernel_config_data) - 1 - MAGIC_SIZE * 2)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_set_size",
          "args": [
            "entry",
            "kernel_config_data_size"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_create",
          "args": [
            "\"config.gz\"",
            "S_IFREG | S_IRUGO",
            "NULL",
            "&ikconfig_file_ops"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config_data.h\"\n#include <linux/uaccess.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define kernel_config_data_size \\\n\t(sizeof(kernel_config_data) - 1 - MAGIC_SIZE * 2)\n\nstatic int __init ikconfig_init(void)\n{\n\tstruct proc_dir_entry *entry;\n\n\t/* create the current config file */\n\tentry = proc_create(\"config.gz\", S_IFREG | S_IRUGO, NULL,\n\t\t\t    &ikconfig_file_ops);\n\tif (!entry)\n\t\treturn -ENOMEM;\n\n\tproc_set_size(entry, kernel_config_data_size);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ikconfig_read_current",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/configs.c",
    "lines": "57-64",
    "snippet": "static ssize_t\nikconfig_read_current(struct file *file, char __user *buf,\n\t\t      size_t len, loff_t * offset)\n{\n\treturn simple_read_from_buffer(buf, len, offset,\n\t\t\t\t       kernel_config_data + MAGIC_SIZE,\n\t\t\t\t       kernel_config_data_size);\n}",
    "includes": [
      "#include \"config_data.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/init.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define kernel_config_data_size \\\n\t(sizeof(kernel_config_data) - 1 - MAGIC_SIZE * 2)",
      "#define MAGIC_SIZE (sizeof(MAGIC_START) - 1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_read_from_buffer",
          "args": [
            "buf",
            "len",
            "offset",
            "kernel_config_data + MAGIC_SIZE",
            "kernel_config_data_size"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config_data.h\"\n#include <linux/uaccess.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\n#define kernel_config_data_size \\\n\t(sizeof(kernel_config_data) - 1 - MAGIC_SIZE * 2)\n#define MAGIC_SIZE (sizeof(MAGIC_START) - 1)\n\nstatic ssize_t\nikconfig_read_current(struct file *file, char __user *buf,\n\t\t      size_t len, loff_t * offset)\n{\n\treturn simple_read_from_buffer(buf, len, offset,\n\t\t\t\t       kernel_config_data + MAGIC_SIZE,\n\t\t\t\t       kernel_config_data_size);\n}"
  }
]