[
  {
    "function_name": "bpf_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "670-683",
    "snippet": "static int __init bpf_init(void)\n{\n\tint ret;\n\n\tret = sysfs_create_mount_point(fs_kobj, \"bpf\");\n\tif (ret)\n\t\treturn ret;\n\n\tret = register_filesystem(&bpf_fs_type);\n\tif (ret)\n\t\tsysfs_remove_mount_point(fs_kobj, \"bpf\");\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct file_system_type bpf_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"bpf\",\n\t.mount\t\t= bpf_mount,\n\t.kill_sb\t= kill_litter_super,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysfs_remove_mount_point",
          "args": [
            "fs_kobj",
            "\"bpf\""
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_filesystem",
          "args": [
            "&bpf_fs_type"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_create_mount_point",
          "args": [
            "fs_kobj",
            "\"bpf\""
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct file_system_type bpf_fs_type = {\n\t.owner\t\t= THIS_MODULE,\n\t.name\t\t= \"bpf\",\n\t.mount\t\t= bpf_mount,\n\t.kill_sb\t= kill_litter_super,\n};\n\nstatic int __init bpf_init(void)\n{\n\tint ret;\n\n\tret = sysfs_create_mount_point(fs_kobj, \"bpf\");\n\tif (ret)\n\t\treturn ret;\n\n\tret = register_filesystem(&bpf_fs_type);\n\tif (ret)\n\t\tsysfs_remove_mount_point(fs_kobj, \"bpf\");\n\n\treturn ret;\n}"
  },
  {
    "function_name": "bpf_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "657-661",
    "snippet": "static struct dentry *bpf_mount(struct file_system_type *type, int flags,\n\t\t\t\tconst char *dev_name, void *data)\n{\n\treturn mount_nodev(type, flags, data, bpf_fill_super);\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mount_nodev",
          "args": [
            "type",
            "flags",
            "data",
            "bpf_fill_super"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct dentry *bpf_mount(struct file_system_type *type, int flags,\n\t\t\t\tconst char *dev_name, void *data)\n{\n\treturn mount_nodev(type, flags, data, bpf_fill_super);\n}"
  },
  {
    "function_name": "bpf_fill_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "632-655",
    "snippet": "static int bpf_fill_super(struct super_block *sb, void *data, int silent)\n{\n\tstatic const struct tree_descr bpf_rfiles[] = { { \"\" } };\n\tstruct bpf_mount_opts opts;\n\tstruct inode *inode;\n\tint ret;\n\n\tret = bpf_parse_options(data, &opts);\n\tif (ret)\n\t\treturn ret;\n\n\tret = simple_fill_super(sb, BPF_FS_MAGIC, bpf_rfiles);\n\tif (ret)\n\t\treturn ret;\n\n\tsb->s_op = &bpf_super_ops;\n\n\tinode = sb->s_root->d_inode;\n\tinode->i_op = &bpf_dir_iops;\n\tinode->i_mode &= ~S_IALLUGO;\n\tinode->i_mode |= S_ISVTX | opts.mode;\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct inode_operations bpf_dir_iops;",
      "static const struct inode_operations bpf_dir_iops = {\n\t.lookup\t\t= bpf_lookup,\n\t.mkdir\t\t= bpf_mkdir,\n\t.symlink\t= bpf_symlink,\n\t.rmdir\t\t= simple_rmdir,\n\t.rename\t\t= simple_rename,\n\t.link\t\t= simple_link,\n\t.unlink\t\t= simple_unlink,\n};",
      "static const struct super_operations bpf_super_ops = {\n\t.statfs\t\t= simple_statfs,\n\t.drop_inode\t= generic_delete_inode,\n\t.show_options\t= bpf_show_options,\n\t.evict_inode\t= bpf_evict_inode,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_fill_super",
          "args": [
            "sb",
            "BPF_FS_MAGIC",
            "bpf_rfiles"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_parse_options",
          "args": [
            "data",
            "&opts"
          ],
          "line": 639
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_parse_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "603-630",
          "snippet": "static int bpf_parse_options(char *data, struct bpf_mount_opts *opts)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\tint option, token;\n\tchar *ptr;\n\n\topts->mode = S_IRWXUGO;\n\n\twhile ((ptr = strsep(&data, \",\")) != NULL) {\n\t\tif (!*ptr)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(ptr, bpf_mount_tokens, args);\n\t\tswitch (token) {\n\t\tcase OPT_MODE:\n\t\t\tif (match_octal(&args[0], &option))\n\t\t\t\treturn -EINVAL;\n\t\t\topts->mode = option & S_IALLUGO;\n\t\t\tbreak;\n\t\t/* We might like to report bad mount options here, but\n\t\t * traditionally we've ignored all mount options, so we'd\n\t\t * better continue to ignore non-existing options for bpf.\n\t\t */\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const match_table_t bpf_mount_tokens = {\n\t{ OPT_MODE, \"mode=%o\" },\n\t{ OPT_ERR, NULL },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const match_table_t bpf_mount_tokens = {\n\t{ OPT_MODE, \"mode=%o\" },\n\t{ OPT_ERR, NULL },\n};\n\nstatic int bpf_parse_options(char *data, struct bpf_mount_opts *opts)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\tint option, token;\n\tchar *ptr;\n\n\topts->mode = S_IRWXUGO;\n\n\twhile ((ptr = strsep(&data, \",\")) != NULL) {\n\t\tif (!*ptr)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(ptr, bpf_mount_tokens, args);\n\t\tswitch (token) {\n\t\tcase OPT_MODE:\n\t\t\tif (match_octal(&args[0], &option))\n\t\t\t\treturn -EINVAL;\n\t\t\topts->mode = option & S_IALLUGO;\n\t\t\tbreak;\n\t\t/* We might like to report bad mount options here, but\n\t\t * traditionally we've ignored all mount options, so we'd\n\t\t * better continue to ignore non-existing options for bpf.\n\t\t */\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct inode_operations bpf_dir_iops;\nstatic const struct inode_operations bpf_dir_iops = {\n\t.lookup\t\t= bpf_lookup,\n\t.mkdir\t\t= bpf_mkdir,\n\t.symlink\t= bpf_symlink,\n\t.rmdir\t\t= simple_rmdir,\n\t.rename\t\t= simple_rename,\n\t.link\t\t= simple_link,\n\t.unlink\t\t= simple_unlink,\n};\nstatic const struct super_operations bpf_super_ops = {\n\t.statfs\t\t= simple_statfs,\n\t.drop_inode\t= generic_delete_inode,\n\t.show_options\t= bpf_show_options,\n\t.evict_inode\t= bpf_evict_inode,\n};\n\nstatic int bpf_fill_super(struct super_block *sb, void *data, int silent)\n{\n\tstatic const struct tree_descr bpf_rfiles[] = { { \"\" } };\n\tstruct bpf_mount_opts opts;\n\tstruct inode *inode;\n\tint ret;\n\n\tret = bpf_parse_options(data, &opts);\n\tif (ret)\n\t\treturn ret;\n\n\tret = simple_fill_super(sb, BPF_FS_MAGIC, bpf_rfiles);\n\tif (ret)\n\t\treturn ret;\n\n\tsb->s_op = &bpf_super_ops;\n\n\tinode = sb->s_root->d_inode;\n\tinode->i_op = &bpf_dir_iops;\n\tinode->i_mode &= ~S_IALLUGO;\n\tinode->i_mode |= S_ISVTX | opts.mode;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "bpf_parse_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "603-630",
    "snippet": "static int bpf_parse_options(char *data, struct bpf_mount_opts *opts)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\tint option, token;\n\tchar *ptr;\n\n\topts->mode = S_IRWXUGO;\n\n\twhile ((ptr = strsep(&data, \",\")) != NULL) {\n\t\tif (!*ptr)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(ptr, bpf_mount_tokens, args);\n\t\tswitch (token) {\n\t\tcase OPT_MODE:\n\t\t\tif (match_octal(&args[0], &option))\n\t\t\t\treturn -EINVAL;\n\t\t\topts->mode = option & S_IALLUGO;\n\t\t\tbreak;\n\t\t/* We might like to report bad mount options here, but\n\t\t * traditionally we've ignored all mount options, so we'd\n\t\t * better continue to ignore non-existing options for bpf.\n\t\t */\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const match_table_t bpf_mount_tokens = {\n\t{ OPT_MODE, \"mode=%o\" },\n\t{ OPT_ERR, NULL },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "match_octal",
          "args": [
            "&args[0]",
            "&option"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_token",
          "args": [
            "ptr",
            "bpf_mount_tokens",
            "args"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strsep",
          "args": [
            "&data",
            "\",\""
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const match_table_t bpf_mount_tokens = {\n\t{ OPT_MODE, \"mode=%o\" },\n\t{ OPT_ERR, NULL },\n};\n\nstatic int bpf_parse_options(char *data, struct bpf_mount_opts *opts)\n{\n\tsubstring_t args[MAX_OPT_ARGS];\n\tint option, token;\n\tchar *ptr;\n\n\topts->mode = S_IRWXUGO;\n\n\twhile ((ptr = strsep(&data, \",\")) != NULL) {\n\t\tif (!*ptr)\n\t\t\tcontinue;\n\n\t\ttoken = match_token(ptr, bpf_mount_tokens, args);\n\t\tswitch (token) {\n\t\tcase OPT_MODE:\n\t\t\tif (match_octal(&args[0], &option))\n\t\t\t\treturn -EINVAL;\n\t\t\topts->mode = option & S_IALLUGO;\n\t\t\tbreak;\n\t\t/* We might like to report bad mount options here, but\n\t\t * traditionally we've ignored all mount options, so we'd\n\t\t * better continue to ignore non-existing options for bpf.\n\t\t */\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "bpf_show_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "573-580",
    "snippet": "static int bpf_show_options(struct seq_file *m, struct dentry *root)\n{\n\tumode_t mode = d_inode(root)->i_mode & S_IALLUGO & ~S_ISVTX;\n\n\tif (mode != S_IRWXUGO)\n\t\tseq_printf(m, \",mode=%o\", mode);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\",mode=%o\"",
            "mode"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_seq.c",
          "lines": "84-103",
          "snippet": "void trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "root"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic int bpf_show_options(struct seq_file *m, struct dentry *root)\n{\n\tumode_t mode = d_inode(root)->i_mode & S_IALLUGO & ~S_ISVTX;\n\n\tif (mode != S_IRWXUGO)\n\t\tseq_printf(m, \",mode=%o\", mode);\n\treturn 0;\n}"
  },
  {
    "function_name": "bpf_evict_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "557-568",
    "snippet": "static void bpf_evict_inode(struct inode *inode)\n{\n\tenum bpf_type type;\n\n\ttruncate_inode_pages_final(&inode->i_data);\n\tclear_inode(inode);\n\n\tif (S_ISLNK(inode->i_mode))\n\t\tkfree(inode->i_link);\n\tif (!bpf_inode_type(inode, &type))\n\t\tbpf_any_put(inode->i_private, type);\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_any_put",
          "args": [
            "inode->i_private",
            "type"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_any_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "49-62",
          "snippet": "static void bpf_any_put(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tbpf_prog_put(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tbpf_map_put_with_uref(raw);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void bpf_any_put(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tbpf_prog_put(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tbpf_map_put_with_uref(raw);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_inode_type",
          "args": [
            "inode",
            "&type"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_inode_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "112-123",
          "snippet": "static int bpf_inode_type(const struct inode *inode, enum bpf_type *type)\n{\n\t*type = BPF_TYPE_UNSPEC;\n\tif (inode->i_op == &bpf_prog_iops)\n\t\t*type = BPF_TYPE_PROG;\n\telse if (inode->i_op == &bpf_map_iops)\n\t\t*type = BPF_TYPE_MAP;\n\telse\n\t\treturn -EACCES;\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct inode_operations bpf_prog_iops = { };",
            "static const struct inode_operations bpf_map_iops  = { };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct inode_operations bpf_prog_iops = { };\nstatic const struct inode_operations bpf_map_iops  = { };\n\nstatic int bpf_inode_type(const struct inode *inode, enum bpf_type *type)\n{\n\t*type = BPF_TYPE_UNSPEC;\n\tif (inode->i_op == &bpf_prog_iops)\n\t\t*type = BPF_TYPE_PROG;\n\telse if (inode->i_op == &bpf_map_iops)\n\t\t*type = BPF_TYPE_MAP;\n\telse\n\t\treturn -EACCES;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "inode->i_link"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "inode->i_mode"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_inode",
          "args": [
            "inode"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "truncate_inode_pages_final",
          "args": [
            "&inode->i_data"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void bpf_evict_inode(struct inode *inode)\n{\n\tenum bpf_type type;\n\n\ttruncate_inode_pages_final(&inode->i_data);\n\tclear_inode(inode);\n\n\tif (S_ISLNK(inode->i_mode))\n\t\tkfree(inode->i_link);\n\tif (!bpf_inode_type(inode, &type))\n\t\tbpf_any_put(inode->i_private, type);\n}"
  },
  {
    "function_name": "bpf_prog_get_type_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "542-554",
    "snippet": "struct bpf_prog *bpf_prog_get_type_path(const char *name, enum bpf_prog_type type)\n{\n\tstruct bpf_prog *prog;\n\tstruct path path;\n\tint ret = kern_path(name, LOOKUP_FOLLOW, &path);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\tprog = __get_prog_inode(d_backing_inode(path.dentry), type);\n\tif (!IS_ERR(prog))\n\t\ttouch_atime(&path);\n\tpath_put(&path);\n\treturn prog;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "path_put",
          "args": [
            "&path"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "touch_atime",
          "args": [
            "&path"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "prog"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__get_prog_inode",
          "args": [
            "d_backing_inode(path.dentry)",
            "type"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "__get_prog_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "518-540",
          "snippet": "static struct bpf_prog *__get_prog_inode(struct inode *inode, enum bpf_prog_type type)\n{\n\tstruct bpf_prog *prog;\n\tint ret = inode_permission(inode, MAY_READ | MAY_WRITE);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\n\tif (inode->i_op == &bpf_map_iops)\n\t\treturn ERR_PTR(-EINVAL);\n\tif (inode->i_op != &bpf_prog_iops)\n\t\treturn ERR_PTR(-EACCES);\n\n\tprog = inode->i_private;\n\n\tret = security_bpf_prog(prog);\n\tif (ret < 0)\n\t\treturn ERR_PTR(ret);\n\n\tif (!bpf_prog_get_ok(prog, &type, false))\n\t\treturn ERR_PTR(-EINVAL);\n\n\treturn bpf_prog_inc(prog);\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct inode_operations bpf_prog_iops = { };",
            "static const struct inode_operations bpf_map_iops  = { };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct inode_operations bpf_prog_iops = { };\nstatic const struct inode_operations bpf_map_iops  = { };\n\nstatic struct bpf_prog *__get_prog_inode(struct inode *inode, enum bpf_prog_type type)\n{\n\tstruct bpf_prog *prog;\n\tint ret = inode_permission(inode, MAY_READ | MAY_WRITE);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\n\tif (inode->i_op == &bpf_map_iops)\n\t\treturn ERR_PTR(-EINVAL);\n\tif (inode->i_op != &bpf_prog_iops)\n\t\treturn ERR_PTR(-EACCES);\n\n\tprog = inode->i_private;\n\n\tret = security_bpf_prog(prog);\n\tif (ret < 0)\n\t\treturn ERR_PTR(ret);\n\n\tif (!bpf_prog_get_ok(prog, &type, false))\n\t\treturn ERR_PTR(-EINVAL);\n\n\treturn bpf_prog_inc(prog);\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_backing_inode",
          "args": [
            "path.dentry"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "ret"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kern_path",
          "args": [
            "name",
            "LOOKUP_FOLLOW",
            "&path"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstruct bpf_prog *bpf_prog_get_type_path(const char *name, enum bpf_prog_type type)\n{\n\tstruct bpf_prog *prog;\n\tstruct path path;\n\tint ret = kern_path(name, LOOKUP_FOLLOW, &path);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\tprog = __get_prog_inode(d_backing_inode(path.dentry), type);\n\tif (!IS_ERR(prog))\n\t\ttouch_atime(&path);\n\tpath_put(&path);\n\treturn prog;\n}"
  },
  {
    "function_name": "__get_prog_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "518-540",
    "snippet": "static struct bpf_prog *__get_prog_inode(struct inode *inode, enum bpf_prog_type type)\n{\n\tstruct bpf_prog *prog;\n\tint ret = inode_permission(inode, MAY_READ | MAY_WRITE);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\n\tif (inode->i_op == &bpf_map_iops)\n\t\treturn ERR_PTR(-EINVAL);\n\tif (inode->i_op != &bpf_prog_iops)\n\t\treturn ERR_PTR(-EACCES);\n\n\tprog = inode->i_private;\n\n\tret = security_bpf_prog(prog);\n\tif (ret < 0)\n\t\treturn ERR_PTR(ret);\n\n\tif (!bpf_prog_get_ok(prog, &type, false))\n\t\treturn ERR_PTR(-EINVAL);\n\n\treturn bpf_prog_inc(prog);\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct inode_operations bpf_prog_iops = { };",
      "static const struct inode_operations bpf_map_iops  = { };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_prog_inc",
          "args": [
            "prog"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_prog_inc_not_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/syscall.c",
          "lines": "1317-1332",
          "snippet": "struct bpf_prog *bpf_prog_inc_not_zero(struct bpf_prog *prog)\n{\n\tint refold;\n\n\trefold = atomic_fetch_add_unless(&prog->aux->refcnt, 1, 0);\n\n\tif (refold >= BPF_MAX_REFCNT) {\n\t\t__bpf_prog_put(prog, false);\n\t\treturn ERR_PTR(-EBUSY);\n\t}\n\n\tif (!refold)\n\t\treturn ERR_PTR(-ENOENT);\n\n\treturn prog;\n}",
          "includes": [
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/version.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [
            "#define BPF_MAX_REFCNT 32768"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/version.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n\n#define BPF_MAX_REFCNT 32768\n\nstruct bpf_prog *bpf_prog_inc_not_zero(struct bpf_prog *prog)\n{\n\tint refold;\n\n\trefold = atomic_fetch_add_unless(&prog->aux->refcnt, 1, 0);\n\n\tif (refold >= BPF_MAX_REFCNT) {\n\t\t__bpf_prog_put(prog, false);\n\t\treturn ERR_PTR(-EBUSY);\n\t}\n\n\tif (!refold)\n\t\treturn ERR_PTR(-ENOENT);\n\n\treturn prog;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_prog_get_ok",
          "args": [
            "prog",
            "&type",
            "false"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_prog_get_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/syscall.c",
          "lines": "1335-1348",
          "snippet": "bool bpf_prog_get_ok(struct bpf_prog *prog,\n\t\t\t    enum bpf_prog_type *attach_type, bool attach_drv)\n{\n\t/* not an attachment, just a refcount inc, always allow */\n\tif (!attach_type)\n\t\treturn true;\n\n\tif (prog->type != *attach_type)\n\t\treturn false;\n\tif (bpf_prog_is_dev_bound(prog->aux) && !attach_drv)\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/version.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/version.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n\nbool bpf_prog_get_ok(struct bpf_prog *prog,\n\t\t\t    enum bpf_prog_type *attach_type, bool attach_drv)\n{\n\t/* not an attachment, just a refcount inc, always allow */\n\tif (!attach_type)\n\t\treturn true;\n\n\tif (prog->type != *attach_type)\n\t\treturn false;\n\tif (bpf_prog_is_dev_bound(prog->aux) && !attach_drv)\n\t\treturn false;\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "ret"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_bpf_prog",
          "args": [
            "prog"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EACCES"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "ret"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_permission",
          "args": [
            "inode",
            "MAY_READ | MAY_WRITE"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct inode_operations bpf_prog_iops = { };\nstatic const struct inode_operations bpf_map_iops  = { };\n\nstatic struct bpf_prog *__get_prog_inode(struct inode *inode, enum bpf_prog_type type)\n{\n\tstruct bpf_prog *prog;\n\tint ret = inode_permission(inode, MAY_READ | MAY_WRITE);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\n\tif (inode->i_op == &bpf_map_iops)\n\t\treturn ERR_PTR(-EINVAL);\n\tif (inode->i_op != &bpf_prog_iops)\n\t\treturn ERR_PTR(-EACCES);\n\n\tprog = inode->i_private;\n\n\tret = security_bpf_prog(prog);\n\tif (ret < 0)\n\t\treturn ERR_PTR(ret);\n\n\tif (!bpf_prog_get_ok(prog, &type, false))\n\t\treturn ERR_PTR(-EINVAL);\n\n\treturn bpf_prog_inc(prog);\n}"
  },
  {
    "function_name": "bpf_obj_get_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "482-516",
    "snippet": "int bpf_obj_get_user(const char __user *pathname, int flags)\n{\n\tenum bpf_type type = BPF_TYPE_UNSPEC;\n\tstruct filename *pname;\n\tint ret = -ENOENT;\n\tint f_flags;\n\tvoid *raw;\n\n\tf_flags = bpf_get_file_flag(flags);\n\tif (f_flags < 0)\n\t\treturn f_flags;\n\n\tpname = getname(pathname);\n\tif (IS_ERR(pname))\n\t\treturn PTR_ERR(pname);\n\n\traw = bpf_obj_do_get(pname, &type, f_flags);\n\tif (IS_ERR(raw)) {\n\t\tret = PTR_ERR(raw);\n\t\tgoto out;\n\t}\n\n\tif (type == BPF_TYPE_PROG)\n\t\tret = bpf_prog_new_fd(raw);\n\telse if (type == BPF_TYPE_MAP)\n\t\tret = bpf_map_new_fd(raw, f_flags);\n\telse\n\t\tgoto out;\n\n\tif (ret < 0)\n\t\tbpf_any_put(raw, type);\nout:\n\tputname(pname);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "putname",
          "args": [
            "pname"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_any_put",
          "args": [
            "raw",
            "type"
          ],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_any_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "49-62",
          "snippet": "static void bpf_any_put(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tbpf_prog_put(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tbpf_map_put_with_uref(raw);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void bpf_any_put(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tbpf_prog_put(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tbpf_map_put_with_uref(raw);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_map_new_fd",
          "args": [
            "raw",
            "f_flags"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_map_new_fd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/syscall.c",
          "lines": "404-414",
          "snippet": "int bpf_map_new_fd(struct bpf_map *map, int flags)\n{\n\tint ret;\n\n\tret = security_bpf_map(map, OPEN_FMODE(flags));\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn anon_inode_getfd(\"bpf-map\", &bpf_map_fops, map,\n\t\t\t\tflags | O_CLOEXEC);\n}",
          "includes": [
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/version.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "const struct file_operations bpf_map_fops = {\n#ifdef CONFIG_PROC_FS\n\t.show_fdinfo\t= bpf_map_show_fdinfo,\n#endif\n\t.release\t= bpf_map_release,\n\t.read\t\t= bpf_dummy_read,\n\t.write\t\t= bpf_dummy_write,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/version.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n\nconst struct file_operations bpf_map_fops = {\n#ifdef CONFIG_PROC_FS\n\t.show_fdinfo\t= bpf_map_show_fdinfo,\n#endif\n\t.release\t= bpf_map_release,\n\t.read\t\t= bpf_dummy_read,\n\t.write\t\t= bpf_dummy_write,\n};\n\nint bpf_map_new_fd(struct bpf_map *map, int flags)\n{\n\tint ret;\n\n\tret = security_bpf_map(map, OPEN_FMODE(flags));\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn anon_inode_getfd(\"bpf-map\", &bpf_map_fops, map,\n\t\t\t\tflags | O_CLOEXEC);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_prog_new_fd",
          "args": [
            "raw"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_prog_new_fd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/syscall.c",
          "lines": "1265-1275",
          "snippet": "int bpf_prog_new_fd(struct bpf_prog *prog)\n{\n\tint ret;\n\n\tret = security_bpf_prog(prog);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn anon_inode_getfd(\"bpf-prog\", &bpf_prog_fops, prog,\n\t\t\t\tO_RDWR | O_CLOEXEC);\n}",
          "includes": [
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/version.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "const struct file_operations bpf_prog_fops = {\n#ifdef CONFIG_PROC_FS\n\t.show_fdinfo\t= bpf_prog_show_fdinfo,\n#endif\n\t.release\t= bpf_prog_release,\n\t.read\t\t= bpf_dummy_read,\n\t.write\t\t= bpf_dummy_write,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/version.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n\nconst struct file_operations bpf_prog_fops = {\n#ifdef CONFIG_PROC_FS\n\t.show_fdinfo\t= bpf_prog_show_fdinfo,\n#endif\n\t.release\t= bpf_prog_release,\n\t.read\t\t= bpf_dummy_read,\n\t.write\t\t= bpf_dummy_write,\n};\n\nint bpf_prog_new_fd(struct bpf_prog *prog)\n{\n\tint ret;\n\n\tret = security_bpf_prog(prog);\n\tif (ret < 0)\n\t\treturn ret;\n\n\treturn anon_inode_getfd(\"bpf-prog\", &bpf_prog_fops, prog,\n\t\t\t\tO_RDWR | O_CLOEXEC);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "raw"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "raw"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_obj_do_get",
          "args": [
            "pname",
            "&type",
            "f_flags"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_obj_do_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "450-480",
          "snippet": "static void *bpf_obj_do_get(const struct filename *pathname,\n\t\t\t    enum bpf_type *type, int flags)\n{\n\tstruct inode *inode;\n\tstruct path path;\n\tvoid *raw;\n\tint ret;\n\n\tret = kern_path(pathname->name, LOOKUP_FOLLOW, &path);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\n\tinode = d_backing_inode(path.dentry);\n\tret = inode_permission(inode, ACC_MODE(flags));\n\tif (ret)\n\t\tgoto out;\n\n\tret = bpf_inode_type(inode, type);\n\tif (ret)\n\t\tgoto out;\n\n\traw = bpf_any_get(inode->i_private, *type);\n\tif (!IS_ERR(raw))\n\t\ttouch_atime(&path);\n\n\tpath_put(&path);\n\treturn raw;\nout:\n\tpath_put(&path);\n\treturn ERR_PTR(ret);\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void *bpf_obj_do_get(const struct filename *pathname,\n\t\t\t    enum bpf_type *type, int flags)\n{\n\tstruct inode *inode;\n\tstruct path path;\n\tvoid *raw;\n\tint ret;\n\n\tret = kern_path(pathname->name, LOOKUP_FOLLOW, &path);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\n\tinode = d_backing_inode(path.dentry);\n\tret = inode_permission(inode, ACC_MODE(flags));\n\tif (ret)\n\t\tgoto out;\n\n\tret = bpf_inode_type(inode, type);\n\tif (ret)\n\t\tgoto out;\n\n\traw = bpf_any_get(inode->i_private, *type);\n\tif (!IS_ERR(raw))\n\t\ttouch_atime(&path);\n\n\tpath_put(&path);\n\treturn raw;\nout:\n\tpath_put(&path);\n\treturn ERR_PTR(ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "pname"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "pname"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getname",
          "args": [
            "pathname"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "__audit_getname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/auditsc.c",
          "lines": "1746-1765",
          "snippet": "void __audit_getname(struct filename *name)\n{\n\tstruct audit_context *context = audit_context();\n\tstruct audit_names *n;\n\n\tif (!context->in_syscall)\n\t\treturn;\n\n\tn = audit_alloc_name(context, AUDIT_TYPE_UNKNOWN);\n\tif (!n)\n\t\treturn;\n\n\tn->name = name;\n\tn->name_len = AUDIT_NAME_FULL;\n\tname->aname = n;\n\tname->refcnt++;\n\n\tif (!context->pwd.dentry)\n\t\tget_fs_pwd(current->fs, &context->pwd);\n}",
          "includes": [
            "#include \"audit.h\"",
            "#include <uapi/linux/limits.h>",
            "#include <linux/fsnotify_backend.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/ctype.h>",
            "#include <linux/compat.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/capability.h>",
            "#include <asm/syscall.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/highmem.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/list.h>",
            "#include <linux/security.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compiler.h>",
            "#include <linux/netlink.h>",
            "#include <linux/time.h>",
            "#include <linux/personality.h>",
            "#include <linux/audit.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/socket.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/atomic.h>",
            "#include <asm/types.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"audit.h\"\n#include <uapi/linux/limits.h>\n#include <linux/fsnotify_backend.h>\n#include <linux/uaccess.h>\n#include <linux/string.h>\n#include <linux/ctype.h>\n#include <linux/compat.h>\n#include <linux/fs_struct.h>\n#include <linux/capability.h>\n#include <asm/syscall.h>\n#include <linux/syscalls.h>\n#include <linux/highmem.h>\n#include <linux/binfmts.h>\n#include <linux/list.h>\n#include <linux/security.h>\n#include <asm/unistd.h>\n#include <linux/compiler.h>\n#include <linux/netlink.h>\n#include <linux/time.h>\n#include <linux/personality.h>\n#include <linux/audit.h>\n#include <linux/mqueue.h>\n#include <linux/socket.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/atomic.h>\n#include <asm/types.h>\n#include <linux/init.h>\n\nvoid __audit_getname(struct filename *name)\n{\n\tstruct audit_context *context = audit_context();\n\tstruct audit_names *n;\n\n\tif (!context->in_syscall)\n\t\treturn;\n\n\tn = audit_alloc_name(context, AUDIT_TYPE_UNKNOWN);\n\tif (!n)\n\t\treturn;\n\n\tn->name = name;\n\tn->name_len = AUDIT_NAME_FULL;\n\tname->aname = n;\n\tname->refcnt++;\n\n\tif (!context->pwd.dentry)\n\t\tget_fs_pwd(current->fs, &context->pwd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_get_file_flag",
          "args": [
            "flags"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_get_file_flag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/syscall.c",
          "lines": "416-425",
          "snippet": "int bpf_get_file_flag(int flags)\n{\n\tif ((flags & BPF_F_RDONLY) && (flags & BPF_F_WRONLY))\n\t\treturn -EINVAL;\n\tif (flags & BPF_F_RDONLY)\n\t\treturn O_RDONLY;\n\tif (flags & BPF_F_WRONLY)\n\t\treturn O_WRONLY;\n\treturn O_RDWR;\n}",
          "includes": [
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/version.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/version.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n\nint bpf_get_file_flag(int flags)\n{\n\tif ((flags & BPF_F_RDONLY) && (flags & BPF_F_WRONLY))\n\t\treturn -EINVAL;\n\tif (flags & BPF_F_RDONLY)\n\t\treturn O_RDONLY;\n\tif (flags & BPF_F_WRONLY)\n\t\treturn O_WRONLY;\n\treturn O_RDWR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nint bpf_obj_get_user(const char __user *pathname, int flags)\n{\n\tenum bpf_type type = BPF_TYPE_UNSPEC;\n\tstruct filename *pname;\n\tint ret = -ENOENT;\n\tint f_flags;\n\tvoid *raw;\n\n\tf_flags = bpf_get_file_flag(flags);\n\tif (f_flags < 0)\n\t\treturn f_flags;\n\n\tpname = getname(pathname);\n\tif (IS_ERR(pname))\n\t\treturn PTR_ERR(pname);\n\n\traw = bpf_obj_do_get(pname, &type, f_flags);\n\tif (IS_ERR(raw)) {\n\t\tret = PTR_ERR(raw);\n\t\tgoto out;\n\t}\n\n\tif (type == BPF_TYPE_PROG)\n\t\tret = bpf_prog_new_fd(raw);\n\telse if (type == BPF_TYPE_MAP)\n\t\tret = bpf_map_new_fd(raw, f_flags);\n\telse\n\t\tgoto out;\n\n\tif (ret < 0)\n\t\tbpf_any_put(raw, type);\nout:\n\tputname(pname);\n\treturn ret;\n}"
  },
  {
    "function_name": "bpf_obj_do_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "450-480",
    "snippet": "static void *bpf_obj_do_get(const struct filename *pathname,\n\t\t\t    enum bpf_type *type, int flags)\n{\n\tstruct inode *inode;\n\tstruct path path;\n\tvoid *raw;\n\tint ret;\n\n\tret = kern_path(pathname->name, LOOKUP_FOLLOW, &path);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\n\tinode = d_backing_inode(path.dentry);\n\tret = inode_permission(inode, ACC_MODE(flags));\n\tif (ret)\n\t\tgoto out;\n\n\tret = bpf_inode_type(inode, type);\n\tif (ret)\n\t\tgoto out;\n\n\traw = bpf_any_get(inode->i_private, *type);\n\tif (!IS_ERR(raw))\n\t\ttouch_atime(&path);\n\n\tpath_put(&path);\n\treturn raw;\nout:\n\tpath_put(&path);\n\treturn ERR_PTR(ret);\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "ret"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path_put",
          "args": [
            "&path"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path_put",
          "args": [
            "&path"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "touch_atime",
          "args": [
            "&path"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "raw"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_any_get",
          "args": [
            "inode->i_private",
            "*type"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_any_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "32-47",
          "snippet": "static void *bpf_any_get(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\traw = bpf_prog_inc(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\traw = bpf_map_inc(raw, true);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n\n\treturn raw;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void *bpf_any_get(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\traw = bpf_prog_inc(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\traw = bpf_map_inc(raw, true);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n\n\treturn raw;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_inode_type",
          "args": [
            "inode",
            "type"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_inode_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "112-123",
          "snippet": "static int bpf_inode_type(const struct inode *inode, enum bpf_type *type)\n{\n\t*type = BPF_TYPE_UNSPEC;\n\tif (inode->i_op == &bpf_prog_iops)\n\t\t*type = BPF_TYPE_PROG;\n\telse if (inode->i_op == &bpf_map_iops)\n\t\t*type = BPF_TYPE_MAP;\n\telse\n\t\treturn -EACCES;\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct inode_operations bpf_prog_iops = { };",
            "static const struct inode_operations bpf_map_iops  = { };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct inode_operations bpf_prog_iops = { };\nstatic const struct inode_operations bpf_map_iops  = { };\n\nstatic int bpf_inode_type(const struct inode *inode, enum bpf_type *type)\n{\n\t*type = BPF_TYPE_UNSPEC;\n\tif (inode->i_op == &bpf_prog_iops)\n\t\t*type = BPF_TYPE_PROG;\n\telse if (inode->i_op == &bpf_map_iops)\n\t\t*type = BPF_TYPE_MAP;\n\telse\n\t\treturn -EACCES;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_permission",
          "args": [
            "inode",
            "ACC_MODE(flags)"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ACC_MODE",
          "args": [
            "flags"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_backing_inode",
          "args": [
            "path.dentry"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "ret"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kern_path",
          "args": [
            "pathname->name",
            "LOOKUP_FOLLOW",
            "&path"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void *bpf_obj_do_get(const struct filename *pathname,\n\t\t\t    enum bpf_type *type, int flags)\n{\n\tstruct inode *inode;\n\tstruct path path;\n\tvoid *raw;\n\tint ret;\n\n\tret = kern_path(pathname->name, LOOKUP_FOLLOW, &path);\n\tif (ret)\n\t\treturn ERR_PTR(ret);\n\n\tinode = d_backing_inode(path.dentry);\n\tret = inode_permission(inode, ACC_MODE(flags));\n\tif (ret)\n\t\tgoto out;\n\n\tret = bpf_inode_type(inode, type);\n\tif (ret)\n\t\tgoto out;\n\n\traw = bpf_any_get(inode->i_private, *type);\n\tif (!IS_ERR(raw))\n\t\ttouch_atime(&path);\n\n\tpath_put(&path);\n\treturn raw;\nout:\n\tpath_put(&path);\n\treturn ERR_PTR(ret);\n}"
  },
  {
    "function_name": "bpf_obj_pin_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "425-448",
    "snippet": "int bpf_obj_pin_user(u32 ufd, const char __user *pathname)\n{\n\tstruct filename *pname;\n\tenum bpf_type type;\n\tvoid *raw;\n\tint ret;\n\n\tpname = getname(pathname);\n\tif (IS_ERR(pname))\n\t\treturn PTR_ERR(pname);\n\n\traw = bpf_fd_probe_obj(ufd, &type);\n\tif (IS_ERR(raw)) {\n\t\tret = PTR_ERR(raw);\n\t\tgoto out;\n\t}\n\n\tret = bpf_obj_do_pin(pname, raw, type);\n\tif (ret != 0)\n\t\tbpf_any_put(raw, type);\nout:\n\tputname(pname);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "putname",
          "args": [
            "pname"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_any_put",
          "args": [
            "raw",
            "type"
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_any_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "49-62",
          "snippet": "static void bpf_any_put(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tbpf_prog_put(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tbpf_map_put_with_uref(raw);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void bpf_any_put(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tbpf_prog_put(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tbpf_map_put_with_uref(raw);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_obj_do_pin",
          "args": [
            "pname",
            "raw",
            "type"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_obj_do_pin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "385-423",
          "snippet": "static int bpf_obj_do_pin(const struct filename *pathname, void *raw,\n\t\t\t  enum bpf_type type)\n{\n\tstruct dentry *dentry;\n\tstruct inode *dir;\n\tstruct path path;\n\tumode_t mode;\n\tint ret;\n\n\tdentry = kern_path_create(AT_FDCWD, pathname->name, &path, 0);\n\tif (IS_ERR(dentry))\n\t\treturn PTR_ERR(dentry);\n\n\tmode = S_IFREG | ((S_IRUSR | S_IWUSR) & ~current_umask());\n\n\tret = security_path_mknod(&path, dentry, mode, 0);\n\tif (ret)\n\t\tgoto out;\n\n\tdir = d_inode(path.dentry);\n\tif (dir->i_op != &bpf_dir_iops) {\n\t\tret = -EPERM;\n\t\tgoto out;\n\t}\n\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tret = vfs_mkobj(dentry, mode, bpf_mkprog, raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tret = vfs_mkobj(dentry, mode, bpf_mkmap, raw);\n\t\tbreak;\n\tdefault:\n\t\tret = -EPERM;\n\t}\nout:\n\tdone_path_create(&path, dentry);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct inode_operations bpf_dir_iops;",
            "static const struct inode_operations bpf_dir_iops = {\n\t.lookup\t\t= bpf_lookup,\n\t.mkdir\t\t= bpf_mkdir,\n\t.symlink\t= bpf_symlink,\n\t.rmdir\t\t= simple_rmdir,\n\t.rename\t\t= simple_rename,\n\t.link\t\t= simple_link,\n\t.unlink\t\t= simple_unlink,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct inode_operations bpf_dir_iops;\nstatic const struct inode_operations bpf_dir_iops = {\n\t.lookup\t\t= bpf_lookup,\n\t.mkdir\t\t= bpf_mkdir,\n\t.symlink\t= bpf_symlink,\n\t.rmdir\t\t= simple_rmdir,\n\t.rename\t\t= simple_rename,\n\t.link\t\t= simple_link,\n\t.unlink\t\t= simple_unlink,\n};\n\nstatic int bpf_obj_do_pin(const struct filename *pathname, void *raw,\n\t\t\t  enum bpf_type type)\n{\n\tstruct dentry *dentry;\n\tstruct inode *dir;\n\tstruct path path;\n\tumode_t mode;\n\tint ret;\n\n\tdentry = kern_path_create(AT_FDCWD, pathname->name, &path, 0);\n\tif (IS_ERR(dentry))\n\t\treturn PTR_ERR(dentry);\n\n\tmode = S_IFREG | ((S_IRUSR | S_IWUSR) & ~current_umask());\n\n\tret = security_path_mknod(&path, dentry, mode, 0);\n\tif (ret)\n\t\tgoto out;\n\n\tdir = d_inode(path.dentry);\n\tif (dir->i_op != &bpf_dir_iops) {\n\t\tret = -EPERM;\n\t\tgoto out;\n\t}\n\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tret = vfs_mkobj(dentry, mode, bpf_mkprog, raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tret = vfs_mkobj(dentry, mode, bpf_mkmap, raw);\n\t\tbreak;\n\tdefault:\n\t\tret = -EPERM;\n\t}\nout:\n\tdone_path_create(&path, dentry);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "raw"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "raw"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_fd_probe_obj",
          "args": [
            "ufd",
            "&type"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_fd_probe_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "64-76",
          "snippet": "static void *bpf_fd_probe_obj(u32 ufd, enum bpf_type *type)\n{\n\tvoid *raw;\n\n\t*type = BPF_TYPE_MAP;\n\traw = bpf_map_get_with_uref(ufd);\n\tif (IS_ERR(raw)) {\n\t\t*type = BPF_TYPE_PROG;\n\t\traw = bpf_prog_get(ufd);\n\t}\n\n\treturn raw;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void *bpf_fd_probe_obj(u32 ufd, enum bpf_type *type)\n{\n\tvoid *raw;\n\n\t*type = BPF_TYPE_MAP;\n\traw = bpf_map_get_with_uref(ufd);\n\tif (IS_ERR(raw)) {\n\t\t*type = BPF_TYPE_PROG;\n\t\traw = bpf_prog_get(ufd);\n\t}\n\n\treturn raw;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "pname"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "pname"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getname",
          "args": [
            "pathname"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "__audit_getname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/auditsc.c",
          "lines": "1746-1765",
          "snippet": "void __audit_getname(struct filename *name)\n{\n\tstruct audit_context *context = audit_context();\n\tstruct audit_names *n;\n\n\tif (!context->in_syscall)\n\t\treturn;\n\n\tn = audit_alloc_name(context, AUDIT_TYPE_UNKNOWN);\n\tif (!n)\n\t\treturn;\n\n\tn->name = name;\n\tn->name_len = AUDIT_NAME_FULL;\n\tname->aname = n;\n\tname->refcnt++;\n\n\tif (!context->pwd.dentry)\n\t\tget_fs_pwd(current->fs, &context->pwd);\n}",
          "includes": [
            "#include \"audit.h\"",
            "#include <uapi/linux/limits.h>",
            "#include <linux/fsnotify_backend.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/string.h>",
            "#include <linux/ctype.h>",
            "#include <linux/compat.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/capability.h>",
            "#include <asm/syscall.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/highmem.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/list.h>",
            "#include <linux/security.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compiler.h>",
            "#include <linux/netlink.h>",
            "#include <linux/time.h>",
            "#include <linux/personality.h>",
            "#include <linux/audit.h>",
            "#include <linux/mqueue.h>",
            "#include <linux/socket.h>",
            "#include <linux/mount.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/atomic.h>",
            "#include <asm/types.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"audit.h\"\n#include <uapi/linux/limits.h>\n#include <linux/fsnotify_backend.h>\n#include <linux/uaccess.h>\n#include <linux/string.h>\n#include <linux/ctype.h>\n#include <linux/compat.h>\n#include <linux/fs_struct.h>\n#include <linux/capability.h>\n#include <asm/syscall.h>\n#include <linux/syscalls.h>\n#include <linux/highmem.h>\n#include <linux/binfmts.h>\n#include <linux/list.h>\n#include <linux/security.h>\n#include <asm/unistd.h>\n#include <linux/compiler.h>\n#include <linux/netlink.h>\n#include <linux/time.h>\n#include <linux/personality.h>\n#include <linux/audit.h>\n#include <linux/mqueue.h>\n#include <linux/socket.h>\n#include <linux/mount.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/atomic.h>\n#include <asm/types.h>\n#include <linux/init.h>\n\nvoid __audit_getname(struct filename *name)\n{\n\tstruct audit_context *context = audit_context();\n\tstruct audit_names *n;\n\n\tif (!context->in_syscall)\n\t\treturn;\n\n\tn = audit_alloc_name(context, AUDIT_TYPE_UNKNOWN);\n\tif (!n)\n\t\treturn;\n\n\tn->name = name;\n\tn->name_len = AUDIT_NAME_FULL;\n\tname->aname = n;\n\tname->refcnt++;\n\n\tif (!context->pwd.dentry)\n\t\tget_fs_pwd(current->fs, &context->pwd);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nint bpf_obj_pin_user(u32 ufd, const char __user *pathname)\n{\n\tstruct filename *pname;\n\tenum bpf_type type;\n\tvoid *raw;\n\tint ret;\n\n\tpname = getname(pathname);\n\tif (IS_ERR(pname))\n\t\treturn PTR_ERR(pname);\n\n\traw = bpf_fd_probe_obj(ufd, &type);\n\tif (IS_ERR(raw)) {\n\t\tret = PTR_ERR(raw);\n\t\tgoto out;\n\t}\n\n\tret = bpf_obj_do_pin(pname, raw, type);\n\tif (ret != 0)\n\t\tbpf_any_put(raw, type);\nout:\n\tputname(pname);\n\treturn ret;\n}"
  },
  {
    "function_name": "bpf_obj_do_pin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "385-423",
    "snippet": "static int bpf_obj_do_pin(const struct filename *pathname, void *raw,\n\t\t\t  enum bpf_type type)\n{\n\tstruct dentry *dentry;\n\tstruct inode *dir;\n\tstruct path path;\n\tumode_t mode;\n\tint ret;\n\n\tdentry = kern_path_create(AT_FDCWD, pathname->name, &path, 0);\n\tif (IS_ERR(dentry))\n\t\treturn PTR_ERR(dentry);\n\n\tmode = S_IFREG | ((S_IRUSR | S_IWUSR) & ~current_umask());\n\n\tret = security_path_mknod(&path, dentry, mode, 0);\n\tif (ret)\n\t\tgoto out;\n\n\tdir = d_inode(path.dentry);\n\tif (dir->i_op != &bpf_dir_iops) {\n\t\tret = -EPERM;\n\t\tgoto out;\n\t}\n\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tret = vfs_mkobj(dentry, mode, bpf_mkprog, raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tret = vfs_mkobj(dentry, mode, bpf_mkmap, raw);\n\t\tbreak;\n\tdefault:\n\t\tret = -EPERM;\n\t}\nout:\n\tdone_path_create(&path, dentry);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct inode_operations bpf_dir_iops;",
      "static const struct inode_operations bpf_dir_iops = {\n\t.lookup\t\t= bpf_lookup,\n\t.mkdir\t\t= bpf_mkdir,\n\t.symlink\t= bpf_symlink,\n\t.rmdir\t\t= simple_rmdir,\n\t.rename\t\t= simple_rename,\n\t.link\t\t= simple_link,\n\t.unlink\t\t= simple_unlink,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "done_path_create",
          "args": [
            "&path",
            "dentry"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vfs_mkobj",
          "args": [
            "dentry",
            "mode",
            "bpf_mkmap",
            "raw"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vfs_mkobj",
          "args": [
            "dentry",
            "mode",
            "bpf_mkprog",
            "raw"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "path.dentry"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_path_mknod",
          "args": [
            "&path",
            "dentry",
            "mode",
            "0"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_umask",
          "args": [],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "dentry"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "dentry"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kern_path_create",
          "args": [
            "AT_FDCWD",
            "pathname->name",
            "&path",
            "0"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct inode_operations bpf_dir_iops;\nstatic const struct inode_operations bpf_dir_iops = {\n\t.lookup\t\t= bpf_lookup,\n\t.mkdir\t\t= bpf_mkdir,\n\t.symlink\t= bpf_symlink,\n\t.rmdir\t\t= simple_rmdir,\n\t.rename\t\t= simple_rename,\n\t.link\t\t= simple_link,\n\t.unlink\t\t= simple_unlink,\n};\n\nstatic int bpf_obj_do_pin(const struct filename *pathname, void *raw,\n\t\t\t  enum bpf_type type)\n{\n\tstruct dentry *dentry;\n\tstruct inode *dir;\n\tstruct path path;\n\tumode_t mode;\n\tint ret;\n\n\tdentry = kern_path_create(AT_FDCWD, pathname->name, &path, 0);\n\tif (IS_ERR(dentry))\n\t\treturn PTR_ERR(dentry);\n\n\tmode = S_IFREG | ((S_IRUSR | S_IWUSR) & ~current_umask());\n\n\tret = security_path_mknod(&path, dentry, mode, 0);\n\tif (ret)\n\t\tgoto out;\n\n\tdir = d_inode(path.dentry);\n\tif (dir->i_op != &bpf_dir_iops) {\n\t\tret = -EPERM;\n\t\tgoto out;\n\t}\n\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tret = vfs_mkobj(dentry, mode, bpf_mkprog, raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tret = vfs_mkobj(dentry, mode, bpf_mkmap, raw);\n\t\tbreak;\n\tdefault:\n\t\tret = -EPERM;\n\t}\nout:\n\tdone_path_create(&path, dentry);\n\treturn ret;\n}"
  },
  {
    "function_name": "bpf_symlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "353-373",
    "snippet": "static int bpf_symlink(struct inode *dir, struct dentry *dentry,\n\t\t       const char *target)\n{\n\tchar *link = kstrdup(target, GFP_USER | __GFP_NOWARN);\n\tstruct inode *inode;\n\n\tif (!link)\n\t\treturn -ENOMEM;\n\n\tinode = bpf_get_inode(dir->i_sb, dir, S_IRWXUGO | S_IFLNK);\n\tif (IS_ERR(inode)) {\n\t\tkfree(link);\n\t\treturn PTR_ERR(inode);\n\t}\n\n\tinode->i_op = &simple_symlink_inode_operations;\n\tinode->i_link = link;\n\n\tbpf_dentry_finalize(dentry, inode, dir);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_dentry_finalize",
          "args": [
            "dentry",
            "inode",
            "dir"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_dentry_finalize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "125-133",
          "snippet": "static void bpf_dentry_finalize(struct dentry *dentry, struct inode *inode,\n\t\t\t\tstruct inode *dir)\n{\n\td_instantiate(dentry, inode);\n\tdget(dentry);\n\n\tdir->i_mtime = current_time(dir);\n\tdir->i_ctime = dir->i_mtime;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void bpf_dentry_finalize(struct dentry *dentry, struct inode *inode,\n\t\t\t\tstruct inode *dir)\n{\n\td_instantiate(dentry, inode);\n\tdget(dentry);\n\n\tdir->i_mtime = current_time(dir);\n\tdir->i_ctime = dir->i_mtime;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "inode"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "link"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "inode"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_get_inode",
          "args": [
            "dir->i_sb",
            "dir",
            "S_IRWXUGO | S_IFLNK"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_get_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "83-110",
          "snippet": "static struct inode *bpf_get_inode(struct super_block *sb,\n\t\t\t\t   const struct inode *dir,\n\t\t\t\t   umode_t mode)\n{\n\tstruct inode *inode;\n\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\n\tcase S_IFREG:\n\tcase S_IFLNK:\n\t\tbreak;\n\tdefault:\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\tinode = new_inode(sb);\n\tif (!inode)\n\t\treturn ERR_PTR(-ENOSPC);\n\n\tinode->i_ino = get_next_ino();\n\tinode->i_atime = current_time(inode);\n\tinode->i_mtime = inode->i_atime;\n\tinode->i_ctime = inode->i_atime;\n\n\tinode_init_owner(inode, dir, mode);\n\n\treturn inode;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct inode *bpf_get_inode(struct super_block *sb,\n\t\t\t\t   const struct inode *dir,\n\t\t\t\t   umode_t mode)\n{\n\tstruct inode *inode;\n\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\n\tcase S_IFREG:\n\tcase S_IFLNK:\n\t\tbreak;\n\tdefault:\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\tinode = new_inode(sb);\n\tif (!inode)\n\t\treturn ERR_PTR(-ENOSPC);\n\n\tinode->i_ino = get_next_ino();\n\tinode->i_atime = current_time(inode);\n\tinode->i_mtime = inode->i_atime;\n\tinode->i_ctime = inode->i_atime;\n\n\tinode_init_owner(inode, dir, mode);\n\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrdup",
          "args": [
            "target",
            "GFP_USER | __GFP_NOWARN"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic int bpf_symlink(struct inode *dir, struct dentry *dentry,\n\t\t       const char *target)\n{\n\tchar *link = kstrdup(target, GFP_USER | __GFP_NOWARN);\n\tstruct inode *inode;\n\n\tif (!link)\n\t\treturn -ENOMEM;\n\n\tinode = bpf_get_inode(dir->i_sb, dir, S_IRWXUGO | S_IFLNK);\n\tif (IS_ERR(inode)) {\n\t\tkfree(link);\n\t\treturn PTR_ERR(inode);\n\t}\n\n\tinode->i_op = &simple_symlink_inode_operations;\n\tinode->i_link = link;\n\n\tbpf_dentry_finalize(dentry, inode, dir);\n\treturn 0;\n}"
  },
  {
    "function_name": "bpf_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "341-351",
    "snippet": "static struct dentry *\nbpf_lookup(struct inode *dir, struct dentry *dentry, unsigned flags)\n{\n\t/* Dots in names (e.g. \"/sys/fs/bpf/foo.bar\") are reserved for future\n\t * extensions.\n\t */\n\tif (strchr(dentry->d_name.name, '.'))\n\t\treturn ERR_PTR(-EPERM);\n\n\treturn simple_lookup(dir, dentry, flags);\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_lookup",
          "args": [
            "dir",
            "dentry",
            "flags"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EPERM"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "dentry->d_name.name",
            "'.'"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct dentry *\nbpf_lookup(struct inode *dir, struct dentry *dentry, unsigned flags)\n{\n\t/* Dots in names (e.g. \"/sys/fs/bpf/foo.bar\") are reserved for future\n\t * extensions.\n\t */\n\tif (strchr(dentry->d_name.name, '.'))\n\t\treturn ERR_PTR(-EPERM);\n\n\treturn simple_lookup(dir, dentry, flags);\n}"
  },
  {
    "function_name": "bpf_mkmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "332-339",
    "snippet": "static int bpf_mkmap(struct dentry *dentry, umode_t mode, void *arg)\n{\n\tstruct bpf_map *map = arg;\n\n\treturn bpf_mkobj_ops(dentry, mode, arg, &bpf_map_iops,\n\t\t\t     bpf_map_support_seq_show(map) ?\n\t\t\t     &bpffs_map_fops : &bpffs_obj_fops);\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct inode_operations bpf_map_iops  = { };",
      "static const struct file_operations bpffs_map_fops = {\n\t.open\t\t= bpffs_map_open,\n\t.read\t\t= seq_read,\n\t.release\t= bpffs_map_release,\n};",
      "static const struct file_operations bpffs_obj_fops = {\n\t.open\t\t= bpffs_obj_open,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_mkobj_ops",
          "args": [
            "dentry",
            "mode",
            "arg",
            "&bpf_map_iops",
            "bpf_map_support_seq_show(map) ?\n\t\t\t     &bpffs_map_fops : &bpffs_obj_fops"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_mkobj_ops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "309-324",
          "snippet": "static int bpf_mkobj_ops(struct dentry *dentry, umode_t mode, void *raw,\n\t\t\t const struct inode_operations *iops,\n\t\t\t const struct file_operations *fops)\n{\n\tstruct inode *dir = dentry->d_parent->d_inode;\n\tstruct inode *inode = bpf_get_inode(dir->i_sb, dir, mode);\n\tif (IS_ERR(inode))\n\t\treturn PTR_ERR(inode);\n\n\tinode->i_op = iops;\n\tinode->i_fop = fops;\n\tinode->i_private = raw;\n\n\tbpf_dentry_finalize(dentry, inode, dir);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic int bpf_mkobj_ops(struct dentry *dentry, umode_t mode, void *raw,\n\t\t\t const struct inode_operations *iops,\n\t\t\t const struct file_operations *fops)\n{\n\tstruct inode *dir = dentry->d_parent->d_inode;\n\tstruct inode *inode = bpf_get_inode(dir->i_sb, dir, mode);\n\tif (IS_ERR(inode))\n\t\treturn PTR_ERR(inode);\n\n\tinode->i_op = iops;\n\tinode->i_fop = fops;\n\tinode->i_private = raw;\n\n\tbpf_dentry_finalize(dentry, inode, dir);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_map_support_seq_show",
          "args": [
            "map"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct inode_operations bpf_map_iops  = { };\nstatic const struct file_operations bpffs_map_fops = {\n\t.open\t\t= bpffs_map_open,\n\t.read\t\t= seq_read,\n\t.release\t= bpffs_map_release,\n};\nstatic const struct file_operations bpffs_obj_fops = {\n\t.open\t\t= bpffs_obj_open,\n};\n\nstatic int bpf_mkmap(struct dentry *dentry, umode_t mode, void *arg)\n{\n\tstruct bpf_map *map = arg;\n\n\treturn bpf_mkobj_ops(dentry, mode, arg, &bpf_map_iops,\n\t\t\t     bpf_map_support_seq_show(map) ?\n\t\t\t     &bpffs_map_fops : &bpffs_obj_fops);\n}"
  },
  {
    "function_name": "bpf_mkprog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "326-330",
    "snippet": "static int bpf_mkprog(struct dentry *dentry, umode_t mode, void *arg)\n{\n\treturn bpf_mkobj_ops(dentry, mode, arg, &bpf_prog_iops,\n\t\t\t     &bpffs_obj_fops);\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct inode_operations bpf_prog_iops = { };",
      "static const struct file_operations bpffs_obj_fops = {\n\t.open\t\t= bpffs_obj_open,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_mkobj_ops",
          "args": [
            "dentry",
            "mode",
            "arg",
            "&bpf_prog_iops",
            "&bpffs_obj_fops"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_mkobj_ops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "309-324",
          "snippet": "static int bpf_mkobj_ops(struct dentry *dentry, umode_t mode, void *raw,\n\t\t\t const struct inode_operations *iops,\n\t\t\t const struct file_operations *fops)\n{\n\tstruct inode *dir = dentry->d_parent->d_inode;\n\tstruct inode *inode = bpf_get_inode(dir->i_sb, dir, mode);\n\tif (IS_ERR(inode))\n\t\treturn PTR_ERR(inode);\n\n\tinode->i_op = iops;\n\tinode->i_fop = fops;\n\tinode->i_private = raw;\n\n\tbpf_dentry_finalize(dentry, inode, dir);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic int bpf_mkobj_ops(struct dentry *dentry, umode_t mode, void *raw,\n\t\t\t const struct inode_operations *iops,\n\t\t\t const struct file_operations *fops)\n{\n\tstruct inode *dir = dentry->d_parent->d_inode;\n\tstruct inode *inode = bpf_get_inode(dir->i_sb, dir, mode);\n\tif (IS_ERR(inode))\n\t\treturn PTR_ERR(inode);\n\n\tinode->i_op = iops;\n\tinode->i_fop = fops;\n\tinode->i_private = raw;\n\n\tbpf_dentry_finalize(dentry, inode, dir);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct inode_operations bpf_prog_iops = { };\nstatic const struct file_operations bpffs_obj_fops = {\n\t.open\t\t= bpffs_obj_open,\n};\n\nstatic int bpf_mkprog(struct dentry *dentry, umode_t mode, void *arg)\n{\n\treturn bpf_mkobj_ops(dentry, mode, arg, &bpf_prog_iops,\n\t\t\t     &bpffs_obj_fops);\n}"
  },
  {
    "function_name": "bpf_mkobj_ops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "309-324",
    "snippet": "static int bpf_mkobj_ops(struct dentry *dentry, umode_t mode, void *raw,\n\t\t\t const struct inode_operations *iops,\n\t\t\t const struct file_operations *fops)\n{\n\tstruct inode *dir = dentry->d_parent->d_inode;\n\tstruct inode *inode = bpf_get_inode(dir->i_sb, dir, mode);\n\tif (IS_ERR(inode))\n\t\treturn PTR_ERR(inode);\n\n\tinode->i_op = iops;\n\tinode->i_fop = fops;\n\tinode->i_private = raw;\n\n\tbpf_dentry_finalize(dentry, inode, dir);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_dentry_finalize",
          "args": [
            "dentry",
            "inode",
            "dir"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_dentry_finalize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "125-133",
          "snippet": "static void bpf_dentry_finalize(struct dentry *dentry, struct inode *inode,\n\t\t\t\tstruct inode *dir)\n{\n\td_instantiate(dentry, inode);\n\tdget(dentry);\n\n\tdir->i_mtime = current_time(dir);\n\tdir->i_ctime = dir->i_mtime;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void bpf_dentry_finalize(struct dentry *dentry, struct inode *inode,\n\t\t\t\tstruct inode *dir)\n{\n\td_instantiate(dentry, inode);\n\tdget(dentry);\n\n\tdir->i_mtime = current_time(dir);\n\tdir->i_ctime = dir->i_mtime;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "inode"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "inode"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_get_inode",
          "args": [
            "dir->i_sb",
            "dir",
            "mode"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_get_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "83-110",
          "snippet": "static struct inode *bpf_get_inode(struct super_block *sb,\n\t\t\t\t   const struct inode *dir,\n\t\t\t\t   umode_t mode)\n{\n\tstruct inode *inode;\n\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\n\tcase S_IFREG:\n\tcase S_IFLNK:\n\t\tbreak;\n\tdefault:\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\tinode = new_inode(sb);\n\tif (!inode)\n\t\treturn ERR_PTR(-ENOSPC);\n\n\tinode->i_ino = get_next_ino();\n\tinode->i_atime = current_time(inode);\n\tinode->i_mtime = inode->i_atime;\n\tinode->i_ctime = inode->i_atime;\n\n\tinode_init_owner(inode, dir, mode);\n\n\treturn inode;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct inode *bpf_get_inode(struct super_block *sb,\n\t\t\t\t   const struct inode *dir,\n\t\t\t\t   umode_t mode)\n{\n\tstruct inode *inode;\n\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\n\tcase S_IFREG:\n\tcase S_IFLNK:\n\t\tbreak;\n\tdefault:\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\tinode = new_inode(sb);\n\tif (!inode)\n\t\treturn ERR_PTR(-ENOSPC);\n\n\tinode->i_ino = get_next_ino();\n\tinode->i_atime = current_time(inode);\n\tinode->i_mtime = inode->i_atime;\n\tinode->i_ctime = inode->i_atime;\n\n\tinode_init_owner(inode, dir, mode);\n\n\treturn inode;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic int bpf_mkobj_ops(struct dentry *dentry, umode_t mode, void *raw,\n\t\t\t const struct inode_operations *iops,\n\t\t\t const struct file_operations *fops)\n{\n\tstruct inode *dir = dentry->d_parent->d_inode;\n\tstruct inode *inode = bpf_get_inode(dir->i_sb, dir, mode);\n\tif (IS_ERR(inode))\n\t\treturn PTR_ERR(inode);\n\n\tinode->i_op = iops;\n\tinode->i_fop = fops;\n\tinode->i_private = raw;\n\n\tbpf_dentry_finalize(dentry, inode, dir);\n\treturn 0;\n}"
  },
  {
    "function_name": "bpffs_obj_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "300-303",
    "snippet": "static int bpffs_obj_open(struct inode *inode, struct file *file)\n{\n\treturn -EIO;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic int bpffs_obj_open(struct inode *inode, struct file *file)\n{\n\treturn -EIO;\n}"
  },
  {
    "function_name": "bpffs_map_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "275-282",
    "snippet": "static int bpffs_map_release(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *m = file->private_data;\n\n\tmap_iter_free(map_iter(m));\n\n\treturn seq_release(inode, file);\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_release",
          "args": [
            "inode",
            "file"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "gcov_seq_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/gcov/fs.c",
          "lines": "219-233",
          "snippet": "static int gcov_seq_release(struct inode *inode, struct file *file)\n{\n\tstruct gcov_iterator *iter;\n\tstruct gcov_info *info;\n\tstruct seq_file *seq;\n\n\tseq = file->private_data;\n\titer = seq->private;\n\tinfo = gcov_iter_get_info(iter);\n\tgcov_iter_free(iter);\n\tgcov_info_free(info);\n\tseq_release(inode, file);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"gcov.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/mutex.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/list.h>",
            "#include <linux/fs.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gcov.h\"\n#include <linux/seq_file.h>\n#include <linux/mutex.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/list.h>\n#include <linux/fs.h>\n#include <linux/debugfs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic int gcov_seq_release(struct inode *inode, struct file *file)\n{\n\tstruct gcov_iterator *iter;\n\tstruct gcov_info *info;\n\tstruct seq_file *seq;\n\n\tseq = file->private_data;\n\titer = seq->private;\n\tinfo = gcov_iter_get_info(iter);\n\tgcov_iter_free(iter);\n\tgcov_info_free(info);\n\tseq_release(inode, file);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "map_iter_free",
          "args": [
            "map_iter(m)"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "map_iter_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "168-174",
          "snippet": "static void map_iter_free(struct map_iter *iter)\n{\n\tif (iter) {\n\t\tkfree(iter->key);\n\t\tkfree(iter);\n\t}\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void map_iter_free(struct map_iter *iter)\n{\n\tif (iter) {\n\t\tkfree(iter->key);\n\t\tkfree(iter);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "map_iter",
          "args": [
            "m"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "map_iter_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "176-193",
          "snippet": "static struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic int bpffs_map_release(struct inode *inode, struct file *file)\n{\n\tstruct seq_file *m = file->private_data;\n\n\tmap_iter_free(map_iter(m));\n\n\treturn seq_release(inode, file);\n}"
  },
  {
    "function_name": "bpffs_map_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "252-273",
    "snippet": "static int bpffs_map_open(struct inode *inode, struct file *file)\n{\n\tstruct bpf_map *map = inode->i_private;\n\tstruct map_iter *iter;\n\tstruct seq_file *m;\n\tint err;\n\n\titer = map_iter_alloc(map);\n\tif (!iter)\n\t\treturn -ENOMEM;\n\n\terr = seq_open(file, &bpffs_map_seq_ops);\n\tif (err) {\n\t\tmap_iter_free(iter);\n\t\treturn err;\n\t}\n\n\tm = file->private_data;\n\tm->private = iter;\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct seq_operations bpffs_map_seq_ops = {\n\t.start\t= map_seq_start,\n\t.next\t= map_seq_next,\n\t.show\t= map_seq_show,\n\t.stop\t= map_seq_stop,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "map_iter_free",
          "args": [
            "iter"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "map_iter_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "168-174",
          "snippet": "static void map_iter_free(struct map_iter *iter)\n{\n\tif (iter) {\n\t\tkfree(iter->key);\n\t\tkfree(iter);\n\t}\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void map_iter_free(struct map_iter *iter)\n{\n\tif (iter) {\n\t\tkfree(iter->key);\n\t\tkfree(iter);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_open",
          "args": [
            "file",
            "&bpffs_map_seq_ops"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "gcov_seq_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/gcov/fs.c",
          "lines": "179-213",
          "snippet": "static int gcov_seq_open(struct inode *inode, struct file *file)\n{\n\tstruct gcov_node *node = inode->i_private;\n\tstruct gcov_iterator *iter;\n\tstruct seq_file *seq;\n\tstruct gcov_info *info;\n\tint rc = -ENOMEM;\n\n\tmutex_lock(&node_lock);\n\t/*\n\t * Read from a profiling data copy to minimize reference tracking\n\t * complexity and concurrent access and to keep accumulating multiple\n\t * profiling data sets associated with one node simple.\n\t */\n\tinfo = get_accumulated_info(node);\n\tif (!info)\n\t\tgoto out_unlock;\n\titer = gcov_iter_new(info);\n\tif (!iter)\n\t\tgoto err_free_info;\n\trc = seq_open(file, &gcov_seq_ops);\n\tif (rc)\n\t\tgoto err_free_iter_info;\n\tseq = file->private_data;\n\tseq->private = iter;\nout_unlock:\n\tmutex_unlock(&node_lock);\n\treturn rc;\n\nerr_free_iter_info:\n\tgcov_iter_free(iter);\nerr_free_info:\n\tgcov_info_free(info);\n\tgoto out_unlock;\n}",
          "includes": [
            "#include \"gcov.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/mutex.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/list.h>",
            "#include <linux/fs.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(node_lock);",
            "static const struct seq_operations gcov_seq_ops = {\n\t.start\t= gcov_seq_start,\n\t.next\t= gcov_seq_next,\n\t.show\t= gcov_seq_show,\n\t.stop\t= gcov_seq_stop,\n};",
            "static void remove_node(struct gcov_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"gcov.h\"\n#include <linux/seq_file.h>\n#include <linux/mutex.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/list.h>\n#include <linux/fs.h>\n#include <linux/debugfs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(node_lock);\nstatic const struct seq_operations gcov_seq_ops = {\n\t.start\t= gcov_seq_start,\n\t.next\t= gcov_seq_next,\n\t.show\t= gcov_seq_show,\n\t.stop\t= gcov_seq_stop,\n};\nstatic void remove_node(struct gcov_node *node);\n\nstatic int gcov_seq_open(struct inode *inode, struct file *file)\n{\n\tstruct gcov_node *node = inode->i_private;\n\tstruct gcov_iterator *iter;\n\tstruct seq_file *seq;\n\tstruct gcov_info *info;\n\tint rc = -ENOMEM;\n\n\tmutex_lock(&node_lock);\n\t/*\n\t * Read from a profiling data copy to minimize reference tracking\n\t * complexity and concurrent access and to keep accumulating multiple\n\t * profiling data sets associated with one node simple.\n\t */\n\tinfo = get_accumulated_info(node);\n\tif (!info)\n\t\tgoto out_unlock;\n\titer = gcov_iter_new(info);\n\tif (!iter)\n\t\tgoto err_free_info;\n\trc = seq_open(file, &gcov_seq_ops);\n\tif (rc)\n\t\tgoto err_free_iter_info;\n\tseq = file->private_data;\n\tseq->private = iter;\nout_unlock:\n\tmutex_unlock(&node_lock);\n\treturn rc;\n\nerr_free_iter_info:\n\tgcov_iter_free(iter);\nerr_free_info:\n\tgcov_info_free(info);\n\tgoto out_unlock;\n}"
        }
      },
      {
        "call_info": {
          "callee": "map_iter_alloc",
          "args": [
            "map"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "map_iter_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "176-193",
          "snippet": "static struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct seq_operations bpffs_map_seq_ops = {\n\t.start\t= map_seq_start,\n\t.next\t= map_seq_next,\n\t.show\t= map_seq_show,\n\t.stop\t= map_seq_stop,\n};\n\nstatic int bpffs_map_open(struct inode *inode, struct file *file)\n{\n\tstruct bpf_map *map = inode->i_private;\n\tstruct map_iter *iter;\n\tstruct seq_file *m;\n\tint err;\n\n\titer = map_iter_alloc(map);\n\tif (!iter)\n\t\treturn -ENOMEM;\n\n\terr = seq_open(file, &bpffs_map_seq_ops);\n\tif (err) {\n\t\tmap_iter_free(iter);\n\t\treturn err;\n\t}\n\n\tm = file->private_data;\n\tm->private = iter;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "map_seq_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "230-243",
    "snippet": "static int map_seq_show(struct seq_file *m, void *v)\n{\n\tstruct bpf_map *map = seq_file_to_map(m);\n\tvoid *key = map_iter(m)->key;\n\n\tif (unlikely(v == SEQ_START_TOKEN)) {\n\t\tseq_puts(m, \"# WARNING!! The output is for debug purpose only\\n\");\n\t\tseq_puts(m, \"# WARNING!! The output format will change\\n\");\n\t} else {\n\t\tmap->ops->map_seq_show_elem(map, key, m);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "map->ops->map_seq_show_elem",
          "args": [
            "map",
            "key",
            "m"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"# WARNING!! The output format will change\\n\""
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_puts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_seq.c",
          "lines": "208-223",
          "snippet": "void trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "v == SEQ_START_TOKEN"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map_iter",
          "args": [
            "m"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "map_iter_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "176-193",
          "snippet": "static struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_file_to_map",
          "args": [
            "m"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "seq_file_to_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "163-166",
          "snippet": "static struct bpf_map *seq_file_to_map(struct seq_file *m)\n{\n\treturn file_inode(m->file)->i_private;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct bpf_map *seq_file_to_map(struct seq_file *m)\n{\n\treturn file_inode(m->file)->i_private;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic int map_seq_show(struct seq_file *m, void *v)\n{\n\tstruct bpf_map *map = seq_file_to_map(m);\n\tvoid *key = map_iter(m)->key;\n\n\tif (unlikely(v == SEQ_START_TOKEN)) {\n\t\tseq_puts(m, \"# WARNING!! The output is for debug purpose only\\n\");\n\t\tseq_puts(m, \"# WARNING!! The output format will change\\n\");\n\t} else {\n\t\tmap->ops->map_seq_show_elem(map, key, m);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "map_seq_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "226-228",
    "snippet": "static void map_seq_stop(struct seq_file *m, void *v)\n{\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void map_seq_stop(struct seq_file *m, void *v)\n{\n}"
  },
  {
    "function_name": "map_seq_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "218-224",
    "snippet": "static void *map_seq_start(struct seq_file *m, loff_t *pos)\n{\n\tif (map_iter(m)->done)\n\t\treturn NULL;\n\n\treturn *pos ? map_iter(m)->key : SEQ_START_TOKEN;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "map_iter",
          "args": [
            "m"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "map_iter_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "176-193",
          "snippet": "static struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void *map_seq_start(struct seq_file *m, loff_t *pos)\n{\n\tif (map_iter(m)->done)\n\t\treturn NULL;\n\n\treturn *pos ? map_iter(m)->key : SEQ_START_TOKEN;\n}"
  },
  {
    "function_name": "map_seq_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "195-216",
    "snippet": "static void *map_seq_next(struct seq_file *m, void *v, loff_t *pos)\n{\n\tstruct bpf_map *map = seq_file_to_map(m);\n\tvoid *key = map_iter(m)->key;\n\tvoid *prev_key;\n\n\tif (map_iter(m)->done)\n\t\treturn NULL;\n\n\tif (unlikely(v == SEQ_START_TOKEN))\n\t\tprev_key = NULL;\n\telse\n\t\tprev_key = key;\n\n\tif (map->ops->map_get_next_key(map, prev_key, key)) {\n\t\tmap_iter(m)->done = true;\n\t\treturn NULL;\n\t}\n\n\t++(*pos);\n\treturn key;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "map_iter",
          "args": [
            "m"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "map_iter_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "176-193",
          "snippet": "static struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "map->ops->map_get_next_key",
          "args": [
            "map",
            "prev_key",
            "key"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "v == SEQ_START_TOKEN"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_file_to_map",
          "args": [
            "m"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "seq_file_to_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "163-166",
          "snippet": "static struct bpf_map *seq_file_to_map(struct seq_file *m)\n{\n\treturn file_inode(m->file)->i_private;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct bpf_map *seq_file_to_map(struct seq_file *m)\n{\n\treturn file_inode(m->file)->i_private;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void *map_seq_next(struct seq_file *m, void *v, loff_t *pos)\n{\n\tstruct bpf_map *map = seq_file_to_map(m);\n\tvoid *key = map_iter(m)->key;\n\tvoid *prev_key;\n\n\tif (map_iter(m)->done)\n\t\treturn NULL;\n\n\tif (unlikely(v == SEQ_START_TOKEN))\n\t\tprev_key = NULL;\n\telse\n\t\tprev_key = key;\n\n\tif (map->ops->map_get_next_key(map, prev_key, key)) {\n\t\tmap_iter(m)->done = true;\n\t\treturn NULL;\n\t}\n\n\t++(*pos);\n\treturn key;\n}"
  },
  {
    "function_name": "map_iter_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "176-193",
    "snippet": "static struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "map_iter_free",
          "args": [
            "iter"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "map_iter_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "168-174",
          "snippet": "static void map_iter_free(struct map_iter *iter)\n{\n\tif (iter) {\n\t\tkfree(iter->key);\n\t\tkfree(iter);\n\t}\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void map_iter_free(struct map_iter *iter)\n{\n\tif (iter) {\n\t\tkfree(iter->key);\n\t\tkfree(iter);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "map->key_size",
            "GFP_KERNEL | __GFP_NOWARN"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*iter)",
            "GFP_KERNEL | __GFP_NOWARN"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct map_iter *map_iter_alloc(struct bpf_map *map)\n{\n\tstruct map_iter *iter;\n\n\titer = kzalloc(sizeof(*iter), GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter)\n\t\tgoto error;\n\n\titer->key = kzalloc(map->key_size, GFP_KERNEL | __GFP_NOWARN);\n\tif (!iter->key)\n\t\tgoto error;\n\n\treturn iter;\n\nerror:\n\tmap_iter_free(iter);\n\treturn NULL;\n}"
  },
  {
    "function_name": "map_iter_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "168-174",
    "snippet": "static void map_iter_free(struct map_iter *iter)\n{\n\tif (iter) {\n\t\tkfree(iter->key);\n\t\tkfree(iter);\n\t}\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "iter"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/params.c",
          "lines": "73-86",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void map_iter_free(struct map_iter *iter)\n{\n\tif (iter) {\n\t\tkfree(iter->key);\n\t\tkfree(iter);\n\t}\n}"
  },
  {
    "function_name": "seq_file_to_map",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "163-166",
    "snippet": "static struct bpf_map *seq_file_to_map(struct seq_file *m)\n{\n\treturn file_inode(m->file)->i_private;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "m->file"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct bpf_map *seq_file_to_map(struct seq_file *m)\n{\n\treturn file_inode(m->file)->i_private;\n}"
  },
  {
    "function_name": "map_iter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "158-161",
    "snippet": "static struct map_iter *map_iter(struct seq_file *m)\n{\n\treturn m->private;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct map_iter *map_iter(struct seq_file *m)\n{\n\treturn m->private;\n}"
  },
  {
    "function_name": "bpf_mkdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "135-151",
    "snippet": "static int bpf_mkdir(struct inode *dir, struct dentry *dentry, umode_t mode)\n{\n\tstruct inode *inode;\n\n\tinode = bpf_get_inode(dir->i_sb, dir, mode | S_IFDIR);\n\tif (IS_ERR(inode))\n\t\treturn PTR_ERR(inode);\n\n\tinode->i_op = &bpf_dir_iops;\n\tinode->i_fop = &simple_dir_operations;\n\n\tinc_nlink(inode);\n\tinc_nlink(dir);\n\n\tbpf_dentry_finalize(dentry, inode, dir);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct inode_operations bpf_dir_iops;",
      "static const struct inode_operations bpf_dir_iops = {\n\t.lookup\t\t= bpf_lookup,\n\t.mkdir\t\t= bpf_mkdir,\n\t.symlink\t= bpf_symlink,\n\t.rmdir\t\t= simple_rmdir,\n\t.rename\t\t= simple_rename,\n\t.link\t\t= simple_link,\n\t.unlink\t\t= simple_unlink,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_dentry_finalize",
          "args": [
            "dentry",
            "inode",
            "dir"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_dentry_finalize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "125-133",
          "snippet": "static void bpf_dentry_finalize(struct dentry *dentry, struct inode *inode,\n\t\t\t\tstruct inode *dir)\n{\n\td_instantiate(dentry, inode);\n\tdget(dentry);\n\n\tdir->i_mtime = current_time(dir);\n\tdir->i_ctime = dir->i_mtime;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void bpf_dentry_finalize(struct dentry *dentry, struct inode *inode,\n\t\t\t\tstruct inode *dir)\n{\n\td_instantiate(dentry, inode);\n\tdget(dentry);\n\n\tdir->i_mtime = current_time(dir);\n\tdir->i_ctime = dir->i_mtime;\n}"
        }
      },
      {
        "call_info": {
          "callee": "inc_nlink",
          "args": [
            "dir"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inc_nlink",
          "args": [
            "inode"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "inode"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "inode"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_get_inode",
          "args": [
            "dir->i_sb",
            "dir",
            "mode | S_IFDIR"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_get_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
          "lines": "83-110",
          "snippet": "static struct inode *bpf_get_inode(struct super_block *sb,\n\t\t\t\t   const struct inode *dir,\n\t\t\t\t   umode_t mode)\n{\n\tstruct inode *inode;\n\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\n\tcase S_IFREG:\n\tcase S_IFLNK:\n\t\tbreak;\n\tdefault:\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\tinode = new_inode(sb);\n\tif (!inode)\n\t\treturn ERR_PTR(-ENOSPC);\n\n\tinode->i_ino = get_next_ino();\n\tinode->i_atime = current_time(inode);\n\tinode->i_mtime = inode->i_atime;\n\tinode->i_ctime = inode->i_atime;\n\n\tinode_init_owner(inode, dir, mode);\n\n\treturn inode;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>",
            "#include <linux/filter.h>",
            "#include <linux/parser.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/major.h>",
            "#include <linux/magic.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct inode *bpf_get_inode(struct super_block *sb,\n\t\t\t\t   const struct inode *dir,\n\t\t\t\t   umode_t mode)\n{\n\tstruct inode *inode;\n\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\n\tcase S_IFREG:\n\tcase S_IFLNK:\n\t\tbreak;\n\tdefault:\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\tinode = new_inode(sb);\n\tif (!inode)\n\t\treturn ERR_PTR(-ENOSPC);\n\n\tinode->i_ino = get_next_ino();\n\tinode->i_atime = current_time(inode);\n\tinode->i_mtime = inode->i_atime;\n\tinode->i_ctime = inode->i_atime;\n\n\tinode_init_owner(inode, dir, mode);\n\n\treturn inode;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct inode_operations bpf_dir_iops;\nstatic const struct inode_operations bpf_dir_iops = {\n\t.lookup\t\t= bpf_lookup,\n\t.mkdir\t\t= bpf_mkdir,\n\t.symlink\t= bpf_symlink,\n\t.rmdir\t\t= simple_rmdir,\n\t.rename\t\t= simple_rename,\n\t.link\t\t= simple_link,\n\t.unlink\t\t= simple_unlink,\n};\n\nstatic int bpf_mkdir(struct inode *dir, struct dentry *dentry, umode_t mode)\n{\n\tstruct inode *inode;\n\n\tinode = bpf_get_inode(dir->i_sb, dir, mode | S_IFDIR);\n\tif (IS_ERR(inode))\n\t\treturn PTR_ERR(inode);\n\n\tinode->i_op = &bpf_dir_iops;\n\tinode->i_fop = &simple_dir_operations;\n\n\tinc_nlink(inode);\n\tinc_nlink(dir);\n\n\tbpf_dentry_finalize(dentry, inode, dir);\n\treturn 0;\n}"
  },
  {
    "function_name": "bpf_dentry_finalize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "125-133",
    "snippet": "static void bpf_dentry_finalize(struct dentry *dentry, struct inode *inode,\n\t\t\t\tstruct inode *dir)\n{\n\td_instantiate(dentry, inode);\n\tdget(dentry);\n\n\tdir->i_mtime = current_time(dir);\n\tdir->i_ctime = dir->i_mtime;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "dir"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dget",
          "args": [
            "dentry"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_instantiate",
          "args": [
            "dentry",
            "inode"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void bpf_dentry_finalize(struct dentry *dentry, struct inode *inode,\n\t\t\t\tstruct inode *dir)\n{\n\td_instantiate(dentry, inode);\n\tdget(dentry);\n\n\tdir->i_mtime = current_time(dir);\n\tdir->i_ctime = dir->i_mtime;\n}"
  },
  {
    "function_name": "bpf_inode_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "112-123",
    "snippet": "static int bpf_inode_type(const struct inode *inode, enum bpf_type *type)\n{\n\t*type = BPF_TYPE_UNSPEC;\n\tif (inode->i_op == &bpf_prog_iops)\n\t\t*type = BPF_TYPE_PROG;\n\telse if (inode->i_op == &bpf_map_iops)\n\t\t*type = BPF_TYPE_MAP;\n\telse\n\t\treturn -EACCES;\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct inode_operations bpf_prog_iops = { };",
      "static const struct inode_operations bpf_map_iops  = { };"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic const struct inode_operations bpf_prog_iops = { };\nstatic const struct inode_operations bpf_map_iops  = { };\n\nstatic int bpf_inode_type(const struct inode *inode, enum bpf_type *type)\n{\n\t*type = BPF_TYPE_UNSPEC;\n\tif (inode->i_op == &bpf_prog_iops)\n\t\t*type = BPF_TYPE_PROG;\n\telse if (inode->i_op == &bpf_map_iops)\n\t\t*type = BPF_TYPE_MAP;\n\telse\n\t\treturn -EACCES;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "bpf_get_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "83-110",
    "snippet": "static struct inode *bpf_get_inode(struct super_block *sb,\n\t\t\t\t   const struct inode *dir,\n\t\t\t\t   umode_t mode)\n{\n\tstruct inode *inode;\n\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\n\tcase S_IFREG:\n\tcase S_IFLNK:\n\t\tbreak;\n\tdefault:\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\tinode = new_inode(sb);\n\tif (!inode)\n\t\treturn ERR_PTR(-ENOSPC);\n\n\tinode->i_ino = get_next_ino();\n\tinode->i_atime = current_time(inode);\n\tinode->i_mtime = inode->i_atime;\n\tinode->i_ctime = inode->i_atime;\n\n\tinode_init_owner(inode, dir, mode);\n\n\treturn inode;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "inode_init_owner",
          "args": [
            "inode",
            "dir",
            "mode"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "inode"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_next_ino",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOSPC"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_inode",
          "args": [
            "sb"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic struct inode *bpf_get_inode(struct super_block *sb,\n\t\t\t\t   const struct inode *dir,\n\t\t\t\t   umode_t mode)\n{\n\tstruct inode *inode;\n\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\n\tcase S_IFREG:\n\tcase S_IFLNK:\n\t\tbreak;\n\tdefault:\n\t\treturn ERR_PTR(-EINVAL);\n\t}\n\n\tinode = new_inode(sb);\n\tif (!inode)\n\t\treturn ERR_PTR(-ENOSPC);\n\n\tinode->i_ino = get_next_ino();\n\tinode->i_atime = current_time(inode);\n\tinode->i_mtime = inode->i_atime;\n\tinode->i_ctime = inode->i_atime;\n\n\tinode_init_owner(inode, dir, mode);\n\n\treturn inode;\n}"
  },
  {
    "function_name": "bpf_fd_probe_obj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "64-76",
    "snippet": "static void *bpf_fd_probe_obj(u32 ufd, enum bpf_type *type)\n{\n\tvoid *raw;\n\n\t*type = BPF_TYPE_MAP;\n\traw = bpf_map_get_with_uref(ufd);\n\tif (IS_ERR(raw)) {\n\t\t*type = BPF_TYPE_PROG;\n\t\traw = bpf_prog_get(ufd);\n\t}\n\n\treturn raw;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_prog_get",
          "args": [
            "ufd"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_prog_get_fd_by_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/syscall.c",
          "lines": "1906-1934",
          "snippet": "static int bpf_prog_get_fd_by_id(const union bpf_attr *attr)\n{\n\tstruct bpf_prog *prog;\n\tu32 id = attr->prog_id;\n\tint fd;\n\n\tif (CHECK_ATTR(BPF_PROG_GET_FD_BY_ID))\n\t\treturn -EINVAL;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tspin_lock_bh(&prog_idr_lock);\n\tprog = idr_find(&prog_idr, id);\n\tif (prog)\n\t\tprog = bpf_prog_inc_not_zero(prog);\n\telse\n\t\tprog = ERR_PTR(-ENOENT);\n\tspin_unlock_bh(&prog_idr_lock);\n\n\tif (IS_ERR(prog))\n\t\treturn PTR_ERR(prog);\n\n\tfd = bpf_prog_new_fd(prog);\n\tif (fd < 0)\n\t\tbpf_prog_put(prog);\n\n\treturn fd;\n}",
          "includes": [
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/version.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_IDR(prog_idr);",
            "static DEFINE_SPINLOCK(prog_idr_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/version.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n\nstatic DEFINE_IDR(prog_idr);\nstatic DEFINE_SPINLOCK(prog_idr_lock);\n\nstatic int bpf_prog_get_fd_by_id(const union bpf_attr *attr)\n{\n\tstruct bpf_prog *prog;\n\tu32 id = attr->prog_id;\n\tint fd;\n\n\tif (CHECK_ATTR(BPF_PROG_GET_FD_BY_ID))\n\t\treturn -EINVAL;\n\n\tif (!capable(CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tspin_lock_bh(&prog_idr_lock);\n\tprog = idr_find(&prog_idr, id);\n\tif (prog)\n\t\tprog = bpf_prog_inc_not_zero(prog);\n\telse\n\t\tprog = ERR_PTR(-ENOENT);\n\tspin_unlock_bh(&prog_idr_lock);\n\n\tif (IS_ERR(prog))\n\t\treturn PTR_ERR(prog);\n\n\tfd = bpf_prog_new_fd(prog);\n\tif (fd < 0)\n\t\tbpf_prog_put(prog);\n\n\treturn fd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "raw"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_map_get_with_uref",
          "args": [
            "ufd"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_map_get_with_uref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/syscall.c",
          "lines": "612-625",
          "snippet": "struct bpf_map *bpf_map_get_with_uref(u32 ufd)\n{\n\tstruct fd f = fdget(ufd);\n\tstruct bpf_map *map;\n\n\tmap = __bpf_map_get(f);\n\tif (IS_ERR(map))\n\t\treturn map;\n\n\tmap = bpf_map_inc(map, true);\n\tfdput(f);\n\n\treturn map;\n}",
          "includes": [
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/version.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/version.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n\nstruct bpf_map *bpf_map_get_with_uref(u32 ufd)\n{\n\tstruct fd f = fdget(ufd);\n\tstruct bpf_map *map;\n\n\tmap = __bpf_map_get(f);\n\tif (IS_ERR(map))\n\t\treturn map;\n\n\tmap = bpf_map_inc(map, true);\n\tfdput(f);\n\n\treturn map;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void *bpf_fd_probe_obj(u32 ufd, enum bpf_type *type)\n{\n\tvoid *raw;\n\n\t*type = BPF_TYPE_MAP;\n\traw = bpf_map_get_with_uref(ufd);\n\tif (IS_ERR(raw)) {\n\t\t*type = BPF_TYPE_PROG;\n\t\traw = bpf_prog_get(ufd);\n\t}\n\n\treturn raw;\n}"
  },
  {
    "function_name": "bpf_any_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "49-62",
    "snippet": "static void bpf_any_put(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tbpf_prog_put(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tbpf_map_put_with_uref(raw);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_map_put_with_uref",
          "args": [
            "raw"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_map_put_with_uref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/syscall.c",
          "lines": "321-325",
          "snippet": "void bpf_map_put_with_uref(struct bpf_map *map)\n{\n\tbpf_map_put_uref(map);\n\tbpf_map_put(map);\n}",
          "includes": [
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/version.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/version.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n\nvoid bpf_map_put_with_uref(struct bpf_map *map)\n{\n\tbpf_map_put_uref(map);\n\tbpf_map_put(map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_prog_put",
          "args": [
            "raw"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_prog_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/syscall.c",
          "lines": "1221-1224",
          "snippet": "void bpf_prog_put(struct bpf_prog *prog)\n{\n\t__bpf_prog_put(prog, true);\n}",
          "includes": [
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/version.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/version.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n\nvoid bpf_prog_put(struct bpf_prog *prog)\n{\n\t__bpf_prog_put(prog, true);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void bpf_any_put(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\tbpf_prog_put(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\tbpf_map_put_with_uref(raw);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "bpf_any_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/inode.c",
    "lines": "32-47",
    "snippet": "static void *bpf_any_get(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\traw = bpf_prog_inc(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\traw = bpf_map_inc(raw, true);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n\n\treturn raw;\n}",
    "includes": [
      "#include <linux/bpf_trace.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>",
      "#include <linux/parser.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/namei.h>",
      "#include <linux/mount.h>",
      "#include <linux/major.h>",
      "#include <linux/magic.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_map_inc",
          "args": [
            "raw",
            "true"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_map_inc_not_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/syscall.c",
          "lines": "628-647",
          "snippet": "static struct bpf_map *bpf_map_inc_not_zero(struct bpf_map *map,\n\t\t\t\t\t    bool uref)\n{\n\tint refold;\n\n\trefold = atomic_fetch_add_unless(&map->refcnt, 1, 0);\n\n\tif (refold >= BPF_MAX_REFCNT) {\n\t\t__bpf_map_put(map, false);\n\t\treturn ERR_PTR(-EBUSY);\n\t}\n\n\tif (!refold)\n\t\treturn ERR_PTR(-ENOENT);\n\n\tif (uref)\n\t\tatomic_inc(&map->usercnt);\n\n\treturn map;\n}",
          "includes": [
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/version.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [
            "#define BPF_MAX_REFCNT 32768"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/version.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n\n#define BPF_MAX_REFCNT 32768\n\nstatic struct bpf_map *bpf_map_inc_not_zero(struct bpf_map *map,\n\t\t\t\t\t    bool uref)\n{\n\tint refold;\n\n\trefold = atomic_fetch_add_unless(&map->refcnt, 1, 0);\n\n\tif (refold >= BPF_MAX_REFCNT) {\n\t\t__bpf_map_put(map, false);\n\t\treturn ERR_PTR(-EBUSY);\n\t}\n\n\tif (!refold)\n\t\treturn ERR_PTR(-ENOENT);\n\n\tif (uref)\n\t\tatomic_inc(&map->usercnt);\n\n\treturn map;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_prog_inc",
          "args": [
            "raw"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_prog_inc_not_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/syscall.c",
          "lines": "1317-1332",
          "snippet": "struct bpf_prog *bpf_prog_inc_not_zero(struct bpf_prog *prog)\n{\n\tint refold;\n\n\trefold = atomic_fetch_add_unless(&prog->aux->refcnt, 1, 0);\n\n\tif (refold >= BPF_MAX_REFCNT) {\n\t\t__bpf_prog_put(prog, false);\n\t\treturn ERR_PTR(-EBUSY);\n\t}\n\n\tif (!refold)\n\t\treturn ERR_PTR(-ENOENT);\n\n\treturn prog;\n}",
          "includes": [
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/version.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [
            "#define BPF_MAX_REFCNT 32768"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/version.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n\n#define BPF_MAX_REFCNT 32768\n\nstruct bpf_prog *bpf_prog_inc_not_zero(struct bpf_prog *prog)\n{\n\tint refold;\n\n\trefold = atomic_fetch_add_unless(&prog->aux->refcnt, 1, 0);\n\n\tif (refold >= BPF_MAX_REFCNT) {\n\t\t__bpf_prog_put(prog, false);\n\t\treturn ERR_PTR(-EBUSY);\n\t}\n\n\tif (!refold)\n\t\treturn ERR_PTR(-ENOENT);\n\n\treturn prog;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n#include <linux/parser.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/major.h>\n#include <linux/magic.h>\n#include <linux/init.h>\n\nstatic void *bpf_any_get(void *raw, enum bpf_type type)\n{\n\tswitch (type) {\n\tcase BPF_TYPE_PROG:\n\t\traw = bpf_prog_inc(raw);\n\t\tbreak;\n\tcase BPF_TYPE_MAP:\n\t\traw = bpf_map_inc(raw, true);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tbreak;\n\t}\n\n\treturn raw;\n}"
  }
]