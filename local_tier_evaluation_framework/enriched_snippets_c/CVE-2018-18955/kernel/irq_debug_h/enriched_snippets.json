[
  {
    "function_name": "print_irq_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/irq/debug.h",
    "lines": "11-45",
    "snippet": "static inline void print_irq_desc(unsigned int irq, struct irq_desc *desc)\n{\n\tstatic DEFINE_RATELIMIT_STATE(ratelimit, 5 * HZ, 5);\n\n\tif (!__ratelimit(&ratelimit))\n\t\treturn;\n\n\tprintk(\"irq %d, desc: %p, depth: %d, count: %d, unhandled: %d\\n\",\n\t\tirq, desc, desc->depth, desc->irq_count, desc->irqs_unhandled);\n\tprintk(\"->handle_irq():  %p, %pS\\n\",\n\t\tdesc->handle_irq, desc->handle_irq);\n\tprintk(\"->irq_data.chip(): %p, %pS\\n\",\n\t\tdesc->irq_data.chip, desc->irq_data.chip);\n\tprintk(\"->action(): %p\\n\", desc->action);\n\tif (desc->action) {\n\t\tprintk(\"->action->handler(): %p, %pS\\n\",\n\t\t\tdesc->action->handler, desc->action->handler);\n\t}\n\n\t___P(IRQ_LEVEL);\n\t___P(IRQ_PER_CPU);\n\t___P(IRQ_NOPROBE);\n\t___P(IRQ_NOREQUEST);\n\t___P(IRQ_NOTHREAD);\n\t___P(IRQ_NOAUTOEN);\n\n\t___PS(IRQS_AUTODETECT);\n\t___PS(IRQS_REPLAY);\n\t___PS(IRQS_WAITING);\n\t___PS(IRQS_PENDING);\n\n\t___PD(IRQS_INPROGRESS);\n\t___PD(IRQS_DISABLED);\n\t___PD(IRQS_MASKED);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "___PD",
          "args": [
            "IRQS_MASKED"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___PD",
          "args": [
            "IRQS_DISABLED"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___PD",
          "args": [
            "IRQS_INPROGRESS"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___PS",
          "args": [
            "IRQS_PENDING"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___PS",
          "args": [
            "IRQS_WAITING"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___PS",
          "args": [
            "IRQS_REPLAY"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___PS",
          "args": [
            "IRQS_AUTODETECT"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___P",
          "args": [
            "IRQ_NOAUTOEN"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___P",
          "args": [
            "IRQ_NOTHREAD"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___P",
          "args": [
            "IRQ_NOREQUEST"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___P",
          "args": [
            "IRQ_NOPROBE"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___P",
          "args": [
            "IRQ_PER_CPU"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___P",
          "args": [
            "IRQ_LEVEL"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"->action->handler(): %p, %pS\\n\"",
            "desc->action->handler",
            "desc->action->handler"
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "__warn_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/panic.c",
          "lines": "590-599",
          "snippet": "void __warn_printk(const char *fmt, ...)\n{\n\tva_list args;\n\n\tpr_warn(CUT_HERE);\n\n\tva_start(args, fmt);\n\tvprintk(fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nvoid __warn_printk(const char *fmt, ...)\n{\n\tva_list args;\n\n\tpr_warn(CUT_HERE);\n\n\tva_start(args, fmt);\n\tvprintk(fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__ratelimit",
          "args": [
            "&ratelimit"
          ],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void print_irq_desc(unsigned int irq, struct irq_desc *desc)\n{\n\tstatic DEFINE_RATELIMIT_STATE(ratelimit, 5 * HZ, 5);\n\n\tif (!__ratelimit(&ratelimit))\n\t\treturn;\n\n\tprintk(\"irq %d, desc: %p, depth: %d, count: %d, unhandled: %d\\n\",\n\t\tirq, desc, desc->depth, desc->irq_count, desc->irqs_unhandled);\n\tprintk(\"->handle_irq():  %p, %pS\\n\",\n\t\tdesc->handle_irq, desc->handle_irq);\n\tprintk(\"->irq_data.chip(): %p, %pS\\n\",\n\t\tdesc->irq_data.chip, desc->irq_data.chip);\n\tprintk(\"->action(): %p\\n\", desc->action);\n\tif (desc->action) {\n\t\tprintk(\"->action->handler(): %p, %pS\\n\",\n\t\t\tdesc->action->handler, desc->action->handler);\n\t}\n\n\t___P(IRQ_LEVEL);\n\t___P(IRQ_PER_CPU);\n\t___P(IRQ_NOPROBE);\n\t___P(IRQ_NOREQUEST);\n\t___P(IRQ_NOTHREAD);\n\t___P(IRQ_NOAUTOEN);\n\n\t___PS(IRQS_AUTODETECT);\n\t___PS(IRQS_REPLAY);\n\t___PS(IRQS_WAITING);\n\t___PS(IRQS_PENDING);\n\n\t___PD(IRQS_INPROGRESS);\n\t___PD(IRQS_DISABLED);\n\t___PD(IRQS_MASKED);\n}"
  }
]