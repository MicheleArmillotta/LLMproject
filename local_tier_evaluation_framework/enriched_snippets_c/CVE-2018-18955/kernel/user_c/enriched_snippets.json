[
  {
    "function_name": "uid_cache_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
    "lines": "218-234",
    "snippet": "static int __init uid_cache_init(void)\n{\n\tint n;\n\n\tuid_cachep = kmem_cache_create(\"uid_cache\", sizeof(struct user_struct),\n\t\t\t0, SLAB_HWCACHE_ALIGN|SLAB_PANIC, NULL);\n\n\tfor(n = 0; n < UIDHASH_SZ; ++n)\n\t\tINIT_HLIST_HEAD(uidhash_table + n);\n\n\t/* Insert the root user immediately (init already runs as root) */\n\tspin_lock_irq(&uidhash_lock);\n\tuid_hash_insert(&root_user, uidhashentry(GLOBAL_ROOT_UID));\n\tspin_unlock_irq(&uidhash_lock);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/proc_ns.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/export.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/sched/user.h>",
      "#include <linux/key.h>",
      "#include <linux/bitops.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define UIDHASH_SZ\t(1 << UIDHASH_BITS)"
    ],
    "globals_used": [
      "static struct kmem_cache *uid_cachep;",
      "struct hlist_head uidhash_table[UIDHASH_SZ];",
      "static DEFINE_SPINLOCK(uidhash_lock);",
      "struct user_struct root_user = {\n\t.__count\t= REFCOUNT_INIT(1),\n\t.processes\t= ATOMIC_INIT(1),\n\t.sigpending\t= ATOMIC_INIT(0),\n\t.locked_shm     = 0,\n\t.uid\t\t= GLOBAL_ROOT_UID,\n\t.ratelimit\t= RATELIMIT_STATE_INIT(root_user.ratelimit, 0, 0),\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&uidhash_lock"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "190-193",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_hash_insert",
          "args": [
            "&root_user",
            "uidhashentry(GLOBAL_ROOT_UID)"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "uid_hash_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
          "lines": "110-113",
          "snippet": "static void uid_hash_insert(struct user_struct *up, struct hlist_head *hashent)\n{\n\thlist_add_head(&up->uidhash_node, hashent);\n}",
          "includes": [
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/key.h>",
            "#include <linux/bitops.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic void uid_hash_insert(struct user_struct *up, struct hlist_head *hashent)\n{\n\thlist_add_head(&up->uidhash_node, hashent);\n}"
        }
      },
      {
        "call_info": {
          "callee": "uidhashentry",
          "args": [
            "GLOBAL_ROOT_UID"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&uidhash_lock"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "158-161",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "INIT_HLIST_HEAD",
          "args": [
            "uidhash_table + n"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"uid_cache\"",
            "sizeof(struct user_struct)",
            "0",
            "SLAB_HWCACHE_ALIGN|SLAB_PANIC",
            "NULL"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\n#define UIDHASH_SZ\t(1 << UIDHASH_BITS)\n\nstatic struct kmem_cache *uid_cachep;\nstruct hlist_head uidhash_table[UIDHASH_SZ];\nstatic DEFINE_SPINLOCK(uidhash_lock);\nstruct user_struct root_user = {\n\t.__count\t= REFCOUNT_INIT(1),\n\t.processes\t= ATOMIC_INIT(1),\n\t.sigpending\t= ATOMIC_INIT(0),\n\t.locked_shm     = 0,\n\t.uid\t\t= GLOBAL_ROOT_UID,\n\t.ratelimit\t= RATELIMIT_STATE_INIT(root_user.ratelimit, 0, 0),\n};\n\nstatic int __init uid_cache_init(void)\n{\n\tint n;\n\n\tuid_cachep = kmem_cache_create(\"uid_cache\", sizeof(struct user_struct),\n\t\t\t0, SLAB_HWCACHE_ALIGN|SLAB_PANIC, NULL);\n\n\tfor(n = 0; n < UIDHASH_SZ; ++n)\n\t\tINIT_HLIST_HEAD(uidhash_table + n);\n\n\t/* Insert the root user immediately (init already runs as root) */\n\tspin_lock_irq(&uidhash_lock);\n\tuid_hash_insert(&root_user, uidhashentry(GLOBAL_ROOT_UID));\n\tspin_unlock_irq(&uidhash_lock);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "alloc_uid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
    "lines": "176-216",
    "snippet": "struct user_struct *alloc_uid(kuid_t uid)\n{\n\tstruct hlist_head *hashent = uidhashentry(uid);\n\tstruct user_struct *up, *new;\n\n\tspin_lock_irq(&uidhash_lock);\n\tup = uid_hash_find(uid, hashent);\n\tspin_unlock_irq(&uidhash_lock);\n\n\tif (!up) {\n\t\tnew = kmem_cache_zalloc(uid_cachep, GFP_KERNEL);\n\t\tif (!new)\n\t\t\tgoto out_unlock;\n\n\t\tnew->uid = uid;\n\t\trefcount_set(&new->__count, 1);\n\t\tratelimit_state_init(&new->ratelimit, HZ, 100);\n\t\tratelimit_set_flags(&new->ratelimit, RATELIMIT_MSG_ON_RELEASE);\n\n\t\t/*\n\t\t * Before adding this, check whether we raced\n\t\t * on adding the same user already..\n\t\t */\n\t\tspin_lock_irq(&uidhash_lock);\n\t\tup = uid_hash_find(uid, hashent);\n\t\tif (up) {\n\t\t\tkey_put(new->uid_keyring);\n\t\t\tkey_put(new->session_keyring);\n\t\t\tkmem_cache_free(uid_cachep, new);\n\t\t} else {\n\t\t\tuid_hash_insert(new, hashent);\n\t\t\tup = new;\n\t\t}\n\t\tspin_unlock_irq(&uidhash_lock);\n\t}\n\n\treturn up;\n\nout_unlock:\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/proc_ns.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/export.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/sched/user.h>",
      "#include <linux/key.h>",
      "#include <linux/bitops.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *uid_cachep;",
      "static DEFINE_SPINLOCK(uidhash_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&uidhash_lock"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "190-193",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_hash_insert",
          "args": [
            "new",
            "hashent"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "uid_hash_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
          "lines": "110-113",
          "snippet": "static void uid_hash_insert(struct user_struct *up, struct hlist_head *hashent)\n{\n\thlist_add_head(&up->uidhash_node, hashent);\n}",
          "includes": [
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/key.h>",
            "#include <linux/bitops.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic void uid_hash_insert(struct user_struct *up, struct hlist_head *hashent)\n{\n\thlist_add_head(&up->uidhash_node, hashent);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "uid_cachep",
            "new"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key_put",
          "args": [
            "new->session_keyring"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key_put",
          "args": [
            "new->uid_keyring"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_hash_find",
          "args": [
            "uid",
            "hashent"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "uid_hash_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
          "lines": "120-132",
          "snippet": "static struct user_struct *uid_hash_find(kuid_t uid, struct hlist_head *hashent)\n{\n\tstruct user_struct *user;\n\n\thlist_for_each_entry(user, hashent, uidhash_node) {\n\t\tif (uid_eq(user->uid, uid)) {\n\t\t\trefcount_inc(&user->__count);\n\t\t\treturn user;\n\t\t}\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/key.h>",
            "#include <linux/bitops.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic struct user_struct *uid_hash_find(kuid_t uid, struct hlist_head *hashent)\n{\n\tstruct user_struct *user;\n\n\thlist_for_each_entry(user, hashent, uidhash_node) {\n\t\tif (uid_eq(user->uid, uid)) {\n\t\t\trefcount_inc(&user->__count);\n\t\t\treturn user;\n\t\t}\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&uidhash_lock"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "158-161",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ratelimit_set_flags",
          "args": [
            "&new->ratelimit",
            "RATELIMIT_MSG_ON_RELEASE"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ratelimit_state_init",
          "args": [
            "&new->ratelimit",
            "HZ",
            "100"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "refcount_set",
          "args": [
            "&new->__count",
            "1"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_zalloc",
          "args": [
            "uid_cachep",
            "GFP_KERNEL"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uidhashentry",
          "args": [
            "uid"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic struct kmem_cache *uid_cachep;\nstatic DEFINE_SPINLOCK(uidhash_lock);\n\nstruct user_struct *alloc_uid(kuid_t uid)\n{\n\tstruct hlist_head *hashent = uidhashentry(uid);\n\tstruct user_struct *up, *new;\n\n\tspin_lock_irq(&uidhash_lock);\n\tup = uid_hash_find(uid, hashent);\n\tspin_unlock_irq(&uidhash_lock);\n\n\tif (!up) {\n\t\tnew = kmem_cache_zalloc(uid_cachep, GFP_KERNEL);\n\t\tif (!new)\n\t\t\tgoto out_unlock;\n\n\t\tnew->uid = uid;\n\t\trefcount_set(&new->__count, 1);\n\t\tratelimit_state_init(&new->ratelimit, HZ, 100);\n\t\tratelimit_set_flags(&new->ratelimit, RATELIMIT_MSG_ON_RELEASE);\n\n\t\t/*\n\t\t * Before adding this, check whether we raced\n\t\t * on adding the same user already..\n\t\t */\n\t\tspin_lock_irq(&uidhash_lock);\n\t\tup = uid_hash_find(uid, hashent);\n\t\tif (up) {\n\t\t\tkey_put(new->uid_keyring);\n\t\t\tkey_put(new->session_keyring);\n\t\t\tkmem_cache_free(uid_cachep, new);\n\t\t} else {\n\t\t\tuid_hash_insert(new, hashent);\n\t\t\tup = new;\n\t\t}\n\t\tspin_unlock_irq(&uidhash_lock);\n\t}\n\n\treturn up;\n\nout_unlock:\n\treturn NULL;\n}"
  },
  {
    "function_name": "free_uid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
    "lines": "165-174",
    "snippet": "void free_uid(struct user_struct *up)\n{\n\tunsigned long flags;\n\n\tif (!up)\n\t\treturn;\n\n\tif (refcount_dec_and_lock_irqsave(&up->__count, &uidhash_lock, &flags))\n\t\tfree_user(up, flags);\n}",
    "includes": [
      "#include <linux/proc_ns.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/export.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/sched/user.h>",
      "#include <linux/key.h>",
      "#include <linux/bitops.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(uidhash_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_user",
          "args": [
            "up",
            "flags"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "free_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
          "lines": "138-146",
          "snippet": "static void free_user(struct user_struct *up, unsigned long flags)\n\t__releases(&uidhash_lock)\n{\n\tuid_hash_remove(up);\n\tspin_unlock_irqrestore(&uidhash_lock, flags);\n\tkey_put(up->uid_keyring);\n\tkey_put(up->session_keyring);\n\tkmem_cache_free(uid_cachep, up);\n}",
          "includes": [
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/key.h>",
            "#include <linux/bitops.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *uid_cachep;",
            "static DEFINE_SPINLOCK(uidhash_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic struct kmem_cache *uid_cachep;\nstatic DEFINE_SPINLOCK(uidhash_lock);\n\nstatic void free_user(struct user_struct *up, unsigned long flags)\n\t__releases(&uidhash_lock)\n{\n\tuid_hash_remove(up);\n\tspin_unlock_irqrestore(&uidhash_lock, flags);\n\tkey_put(up->uid_keyring);\n\tkey_put(up->session_keyring);\n\tkmem_cache_free(uid_cachep, up);\n}"
        }
      },
      {
        "call_info": {
          "callee": "refcount_dec_and_lock_irqsave",
          "args": [
            "&up->__count",
            "&uidhash_lock",
            "&flags"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(uidhash_lock);\n\nvoid free_uid(struct user_struct *up)\n{\n\tunsigned long flags;\n\n\tif (!up)\n\t\treturn;\n\n\tif (refcount_dec_and_lock_irqsave(&up->__count, &uidhash_lock, &flags))\n\t\tfree_user(up, flags);\n}"
  },
  {
    "function_name": "find_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
    "lines": "154-163",
    "snippet": "struct user_struct *find_user(kuid_t uid)\n{\n\tstruct user_struct *ret;\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&uidhash_lock, flags);\n\tret = uid_hash_find(uid, uidhashentry(uid));\n\tspin_unlock_irqrestore(&uidhash_lock, flags);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/proc_ns.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/export.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/sched/user.h>",
      "#include <linux/key.h>",
      "#include <linux/bitops.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(uidhash_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&uidhash_lock",
            "flags"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_hash_find",
          "args": [
            "uid",
            "uidhashentry(uid)"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "uid_hash_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
          "lines": "120-132",
          "snippet": "static struct user_struct *uid_hash_find(kuid_t uid, struct hlist_head *hashent)\n{\n\tstruct user_struct *user;\n\n\thlist_for_each_entry(user, hashent, uidhash_node) {\n\t\tif (uid_eq(user->uid, uid)) {\n\t\t\trefcount_inc(&user->__count);\n\t\t\treturn user;\n\t\t}\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/key.h>",
            "#include <linux/bitops.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic struct user_struct *uid_hash_find(kuid_t uid, struct hlist_head *hashent)\n{\n\tstruct user_struct *user;\n\n\thlist_for_each_entry(user, hashent, uidhash_node) {\n\t\tif (uid_eq(user->uid, uid)) {\n\t\t\trefcount_inc(&user->__count);\n\t\t\treturn user;\n\t\t}\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uidhashentry",
          "args": [
            "uid"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&uidhash_lock",
            "flags"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "359-370",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED_FLAGS(lock, do_raw_spin_trylock, do_raw_spin_lock,\n\t\t\t\tdo_raw_spin_lock_flags, &flags);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(uidhash_lock);\n\nstruct user_struct *find_user(kuid_t uid)\n{\n\tstruct user_struct *ret;\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&uidhash_lock, flags);\n\tret = uid_hash_find(uid, uidhashentry(uid));\n\tspin_unlock_irqrestore(&uidhash_lock, flags);\n\treturn ret;\n}"
  },
  {
    "function_name": "free_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
    "lines": "138-146",
    "snippet": "static void free_user(struct user_struct *up, unsigned long flags)\n\t__releases(&uidhash_lock)\n{\n\tuid_hash_remove(up);\n\tspin_unlock_irqrestore(&uidhash_lock, flags);\n\tkey_put(up->uid_keyring);\n\tkey_put(up->session_keyring);\n\tkmem_cache_free(uid_cachep, up);\n}",
    "includes": [
      "#include <linux/proc_ns.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/export.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/sched/user.h>",
      "#include <linux/key.h>",
      "#include <linux/bitops.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *uid_cachep;",
      "static DEFINE_SPINLOCK(uidhash_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "uid_cachep",
            "up"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key_put",
          "args": [
            "up->session_keyring"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key_put",
          "args": [
            "up->uid_keyring"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&uidhash_lock",
            "flags"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/spinlock.c",
          "lines": "182-185",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_hash_remove",
          "args": [
            "up"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "uid_hash_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
          "lines": "115-118",
          "snippet": "static void uid_hash_remove(struct user_struct *up)\n{\n\thlist_del_init(&up->uidhash_node);\n}",
          "includes": [
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/key.h>",
            "#include <linux/bitops.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic void uid_hash_remove(struct user_struct *up)\n{\n\thlist_del_init(&up->uidhash_node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__releases",
          "args": [
            "&uidhash_lock"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic struct kmem_cache *uid_cachep;\nstatic DEFINE_SPINLOCK(uidhash_lock);\n\nstatic void free_user(struct user_struct *up, unsigned long flags)\n\t__releases(&uidhash_lock)\n{\n\tuid_hash_remove(up);\n\tspin_unlock_irqrestore(&uidhash_lock, flags);\n\tkey_put(up->uid_keyring);\n\tkey_put(up->session_keyring);\n\tkmem_cache_free(uid_cachep, up);\n}"
  },
  {
    "function_name": "uid_hash_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
    "lines": "120-132",
    "snippet": "static struct user_struct *uid_hash_find(kuid_t uid, struct hlist_head *hashent)\n{\n\tstruct user_struct *user;\n\n\thlist_for_each_entry(user, hashent, uidhash_node) {\n\t\tif (uid_eq(user->uid, uid)) {\n\t\t\trefcount_inc(&user->__count);\n\t\t\treturn user;\n\t\t}\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/proc_ns.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/export.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/sched/user.h>",
      "#include <linux/key.h>",
      "#include <linux/bitops.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "refcount_inc",
          "args": [
            "&user->__count"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "system_refcount_inc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_events.c",
          "lines": "50-53",
          "snippet": "static int system_refcount_inc(struct event_subsystem *system)\n{\n\treturn system->ref_count++;\n}",
          "includes": [
            "#include \"trace_output.h\"",
            "#include <asm/setup.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/delay.h>",
            "#include <linux/slab.h>",
            "#include <linux/sort.h>",
            "#include <linux/ctype.h>",
            "#include <linux/module.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/tracefs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/workqueue.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_output.h\"\n#include <asm/setup.h>\n#include <trace/events/sched.h>\n#include <linux/delay.h>\n#include <linux/slab.h>\n#include <linux/sort.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/uaccess.h>\n#include <linux/tracefs.h>\n#include <linux/kthread.h>\n#include <linux/spinlock.h>\n#include <linux/workqueue.h>\n\nstatic int system_refcount_inc(struct event_subsystem *system)\n{\n\treturn system->ref_count++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "user->uid",
            "uid"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_for_each_entry",
          "args": [
            "user",
            "hashent",
            "uidhash_node"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic struct user_struct *uid_hash_find(kuid_t uid, struct hlist_head *hashent)\n{\n\tstruct user_struct *user;\n\n\thlist_for_each_entry(user, hashent, uidhash_node) {\n\t\tif (uid_eq(user->uid, uid)) {\n\t\t\trefcount_inc(&user->__count);\n\t\t\treturn user;\n\t\t}\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "uid_hash_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
    "lines": "115-118",
    "snippet": "static void uid_hash_remove(struct user_struct *up)\n{\n\thlist_del_init(&up->uidhash_node);\n}",
    "includes": [
      "#include <linux/proc_ns.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/export.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/sched/user.h>",
      "#include <linux/key.h>",
      "#include <linux/bitops.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_del_init",
          "args": [
            "&up->uidhash_node"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic void uid_hash_remove(struct user_struct *up)\n{\n\thlist_del_init(&up->uidhash_node);\n}"
  },
  {
    "function_name": "uid_hash_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/user.c",
    "lines": "110-113",
    "snippet": "static void uid_hash_insert(struct user_struct *up, struct hlist_head *hashent)\n{\n\thlist_add_head(&up->uidhash_node, hashent);\n}",
    "includes": [
      "#include <linux/proc_ns.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/export.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/sched/user.h>",
      "#include <linux/key.h>",
      "#include <linux/bitops.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_add_head",
          "args": [
            "&up->uidhash_node",
            "hashent"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic void uid_hash_insert(struct user_struct *up, struct hlist_head *hashent)\n{\n\thlist_add_head(&up->uidhash_node, hashent);\n}"
  }
]