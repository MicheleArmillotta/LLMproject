[
  {
    "function_name": "init_test_probes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "280-322",
    "snippet": "int init_test_probes(void)\n{\n\tint ret;\n\n\ttarget = kprobe_target;\n\ttarget2 = kprobe_target2;\n\n\tdo {\n\t\trand1 = prandom_u32();\n\t} while (rand1 <= div_factor);\n\n\tpr_info(\"started\\n\");\n\tnum_tests++;\n\tret = test_kprobe();\n\tif (ret < 0)\n\t\terrors++;\n\n\tnum_tests++;\n\tret = test_kprobes();\n\tif (ret < 0)\n\t\terrors++;\n\n#ifdef CONFIG_KRETPROBES\n\tnum_tests++;\n\tret = test_kretprobe();\n\tif (ret < 0)\n\t\terrors++;\n\n\tnum_tests++;\n\tret = test_kretprobes();\n\tif (ret < 0)\n\t\terrors++;\n#endif /* CONFIG_KRETPROBES */\n\n\tif (errors)\n\t\tpr_err(\"BUG: %d out of %d tests failed\\n\", errors, num_tests);\n\telse if (handler_errors)\n\t\tpr_err(\"BUG: %d error(s) running handlers\\n\", handler_errors);\n\telse\n\t\tpr_info(\"passed successfully\\n\");\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define div_factor 3"
    ],
    "globals_used": [
      "static int errors, handler_errors, num_tests;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"passed successfully\\n\""
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"BUG: %d error(s) running handlers\\n\"",
            "handler_errors"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"BUG: %d out of %d tests failed\\n\"",
            "errors",
            "num_tests"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_kretprobes",
          "args": [],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "test_kretprobes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
          "lines": "248-277",
          "snippet": "static int test_kretprobes(void)\n{\n\tint ret;\n\tstruct kretprobe *rps[2] = {&rp, &rp2};\n\n\t/* addr and flags should be cleard for reusing kprobe. */\n\trp.kp.addr = NULL;\n\trp.kp.flags = 0;\n\tret = register_kretprobes(rps, 2);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kretprobe returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tkrph_val = 0;\n\tret = target(rand1);\n\tif (krph_val != rand1) {\n\t\tpr_err(\"kretprobe handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tkrph_val = 0;\n\tret = target2(rand1);\n\tif (krph_val != rand1) {\n\t\tpr_err(\"kretprobe handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\tunregister_kretprobes(rps, 2);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/random.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kprobe kp = {\n\t.symbol_name = \"kprobe_target\",\n\t.pre_handler = kp_pre_handler,\n\t.post_handler = kp_post_handler\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\nstatic struct kprobe kp = {\n\t.symbol_name = \"kprobe_target\",\n\t.pre_handler = kp_pre_handler,\n\t.post_handler = kp_post_handler\n};\n\nstatic int test_kretprobes(void)\n{\n\tint ret;\n\tstruct kretprobe *rps[2] = {&rp, &rp2};\n\n\t/* addr and flags should be cleard for reusing kprobe. */\n\trp.kp.addr = NULL;\n\trp.kp.flags = 0;\n\tret = register_kretprobes(rps, 2);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kretprobe returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tkrph_val = 0;\n\tret = target(rand1);\n\tif (krph_val != rand1) {\n\t\tpr_err(\"kretprobe handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tkrph_val = 0;\n\tret = target2(rand1);\n\tif (krph_val != rand1) {\n\t\tpr_err(\"kretprobe handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\tunregister_kretprobes(rps, 2);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_kprobes",
          "args": [],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "test_kprobes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
          "lines": "118-163",
          "snippet": "static int test_kprobes(void)\n{\n\tint ret;\n\tstruct kprobe *kps[2] = {&kp, &kp2};\n\n\t/* addr and flags should be cleard for reusing kprobe. */\n\tkp.addr = NULL;\n\tkp.flags = 0;\n\tret = register_kprobes(kps, 2);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kprobes returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tpreh_val = 0;\n\tposth_val = 0;\n\tret = target(rand1);\n\n\tif (preh_val == 0) {\n\t\tpr_err(\"kprobe pre_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tif (posth_val == 0) {\n\t\tpr_err(\"kprobe post_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tpreh_val = 0;\n\tposth_val = 0;\n\tret = target2(rand1);\n\n\tif (preh_val == 0) {\n\t\tpr_err(\"kprobe pre_handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tif (posth_val == 0) {\n\t\tpr_err(\"kprobe post_handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tunregister_kprobes(kps, 2);\n\treturn 0;\n\n}",
          "includes": [
            "#include <linux/random.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u32 rand1, preh_val, posth_val;",
            "static struct kprobe kp = {\n\t.symbol_name = \"kprobe_target\",\n\t.pre_handler = kp_pre_handler,\n\t.post_handler = kp_post_handler\n};",
            "static struct kprobe kp2 = {\n\t.symbol_name = \"kprobe_target2\",\n\t.pre_handler = kp_pre_handler2,\n\t.post_handler = kp_post_handler2\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\nstatic u32 rand1, preh_val, posth_val;\nstatic struct kprobe kp = {\n\t.symbol_name = \"kprobe_target\",\n\t.pre_handler = kp_pre_handler,\n\t.post_handler = kp_post_handler\n};\nstatic struct kprobe kp2 = {\n\t.symbol_name = \"kprobe_target2\",\n\t.pre_handler = kp_pre_handler2,\n\t.post_handler = kp_post_handler2\n};\n\nstatic int test_kprobes(void)\n{\n\tint ret;\n\tstruct kprobe *kps[2] = {&kp, &kp2};\n\n\t/* addr and flags should be cleard for reusing kprobe. */\n\tkp.addr = NULL;\n\tkp.flags = 0;\n\tret = register_kprobes(kps, 2);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kprobes returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tpreh_val = 0;\n\tposth_val = 0;\n\tret = target(rand1);\n\n\tif (preh_val == 0) {\n\t\tpr_err(\"kprobe pre_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tif (posth_val == 0) {\n\t\tpr_err(\"kprobe post_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tpreh_val = 0;\n\tposth_val = 0;\n\tret = target2(rand1);\n\n\tif (preh_val == 0) {\n\t\tpr_err(\"kprobe pre_handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tif (posth_val == 0) {\n\t\tpr_err(\"kprobe post_handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tunregister_kprobes(kps, 2);\n\treturn 0;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"started\\n\""
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prandom_u32",
          "args": [],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic int errors, handler_errors, num_tests;\n\nint init_test_probes(void)\n{\n\tint ret;\n\n\ttarget = kprobe_target;\n\ttarget2 = kprobe_target2;\n\n\tdo {\n\t\trand1 = prandom_u32();\n\t} while (rand1 <= div_factor);\n\n\tpr_info(\"started\\n\");\n\tnum_tests++;\n\tret = test_kprobe();\n\tif (ret < 0)\n\t\terrors++;\n\n\tnum_tests++;\n\tret = test_kprobes();\n\tif (ret < 0)\n\t\terrors++;\n\n#ifdef CONFIG_KRETPROBES\n\tnum_tests++;\n\tret = test_kretprobe();\n\tif (ret < 0)\n\t\terrors++;\n\n\tnum_tests++;\n\tret = test_kretprobes();\n\tif (ret < 0)\n\t\terrors++;\n#endif /* CONFIG_KRETPROBES */\n\n\tif (errors)\n\t\tpr_err(\"BUG: %d out of %d tests failed\\n\", errors, num_tests);\n\telse if (handler_errors)\n\t\tpr_err(\"BUG: %d error(s) running handlers\\n\", handler_errors);\n\telse\n\t\tpr_info(\"passed successfully\\n\");\n\n\treturn 0;\n}"
  },
  {
    "function_name": "test_kretprobes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "248-277",
    "snippet": "static int test_kretprobes(void)\n{\n\tint ret;\n\tstruct kretprobe *rps[2] = {&rp, &rp2};\n\n\t/* addr and flags should be cleard for reusing kprobe. */\n\trp.kp.addr = NULL;\n\trp.kp.flags = 0;\n\tret = register_kretprobes(rps, 2);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kretprobe returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tkrph_val = 0;\n\tret = target(rand1);\n\tif (krph_val != rand1) {\n\t\tpr_err(\"kretprobe handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tkrph_val = 0;\n\tret = target2(rand1);\n\tif (krph_val != rand1) {\n\t\tpr_err(\"kretprobe handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\tunregister_kretprobes(rps, 2);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kprobe kp = {\n\t.symbol_name = \"kprobe_target\",\n\t.pre_handler = kp_pre_handler,\n\t.post_handler = kp_post_handler\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_kretprobes",
          "args": [
            "rps",
            "2"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_kretprobes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/kprobes.c",
          "lines": "1997-1999",
          "snippet": "void unregister_kretprobes(struct kretprobe **rps, int num)\n{\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <asm/errno.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/cpu.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memory.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/export.h>",
            "#include <linux/stddef.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/hash.h>",
            "#include <linux/kprobes.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/errno.h>\n#include <asm/cacheflush.h>\n#include <asm/sections.h>\n#include <linux/jump_label.h>\n#include <linux/cpu.h>\n#include <linux/ftrace.h>\n#include <linux/memory.h>\n#include <linux/kdebug.h>\n#include <linux/sysctl.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/freezer.h>\n#include <linux/kallsyms.h>\n#include <linux/moduleloader.h>\n#include <linux/export.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/hash.h>\n#include <linux/kprobes.h>\n\nvoid unregister_kretprobes(struct kretprobe **rps, int num)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"kretprobe handler2 not called\\n\""
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "target2",
          "args": [
            "rand1"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "kprobe_target2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
          "lines": "91-94",
          "snippet": "static noinline u32 kprobe_target2(u32 value)\n{\n\treturn (value / div_factor) + 1;\n}",
          "includes": [
            "#include <linux/random.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define div_factor 3"
          ],
          "globals_used": [
            "static u32 (*target)(u32 value);",
            "static u32 (*target2)(u32 value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic u32 (*target)(u32 value);\nstatic u32 (*target2)(u32 value);\n\nstatic noinline u32 kprobe_target2(u32 value)\n{\n\treturn (value / div_factor) + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"kretprobe handler not called\\n\""
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"register_kretprobe returned %d\\n\"",
            "ret"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\nstatic struct kprobe kp = {\n\t.symbol_name = \"kprobe_target\",\n\t.pre_handler = kp_pre_handler,\n\t.post_handler = kp_post_handler\n};\n\nstatic int test_kretprobes(void)\n{\n\tint ret;\n\tstruct kretprobe *rps[2] = {&rp, &rp2};\n\n\t/* addr and flags should be cleard for reusing kprobe. */\n\trp.kp.addr = NULL;\n\trp.kp.flags = 0;\n\tret = register_kretprobes(rps, 2);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kretprobe returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tkrph_val = 0;\n\tret = target(rand1);\n\tif (krph_val != rand1) {\n\t\tpr_err(\"kretprobe handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tkrph_val = 0;\n\tret = target2(rand1);\n\tif (krph_val != rand1) {\n\t\tpr_err(\"kretprobe handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\tunregister_kretprobes(rps, 2);\n\treturn 0;\n}"
  },
  {
    "function_name": "return_handler2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "225-240",
    "snippet": "static int return_handler2(struct kretprobe_instance *ri, struct pt_regs *regs)\n{\n\tunsigned long ret = regs_return_value(regs);\n\n\tif (ret != (rand1 / div_factor) + 1) {\n\t\thandler_errors++;\n\t\tpr_err(\"incorrect value in kretprobe handler2\\n\");\n\t}\n\tif (krph_val == 0) {\n\t\thandler_errors++;\n\t\tpr_err(\"call to kretprobe entry handler failed\\n\");\n\t}\n\n\tkrph_val = rand1;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define div_factor 3"
    ],
    "globals_used": [
      "static u32 (*target)(u32 value);",
      "static u32 (*target2)(u32 value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"call to kretprobe entry handler failed\\n\""
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"incorrect value in kretprobe handler2\\n\""
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "regs_return_value",
          "args": [
            "regs"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic u32 (*target)(u32 value);\nstatic u32 (*target2)(u32 value);\n\nstatic int return_handler2(struct kretprobe_instance *ri, struct pt_regs *regs)\n{\n\tunsigned long ret = regs_return_value(regs);\n\n\tif (ret != (rand1 / div_factor) + 1) {\n\t\thandler_errors++;\n\t\tpr_err(\"incorrect value in kretprobe handler2\\n\");\n\t}\n\tif (krph_val == 0) {\n\t\thandler_errors++;\n\t\tpr_err(\"call to kretprobe entry handler failed\\n\");\n\t}\n\n\tkrph_val = rand1;\n\treturn 0;\n}"
  },
  {
    "function_name": "test_kretprobe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "205-223",
    "snippet": "static int test_kretprobe(void)\n{\n\tint ret;\n\n\tret = register_kretprobe(&rp);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kretprobe returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tret = target(rand1);\n\tunregister_kretprobe(&rp);\n\tif (krph_val != rand1) {\n\t\tpr_err(\"kretprobe handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"kretprobe handler not called\\n\""
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unregister_kretprobe",
          "args": [
            "&rp"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_kretprobe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/kprobes.c",
          "lines": "1992-1994",
          "snippet": "void unregister_kretprobe(struct kretprobe *rp)\n{\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <asm/errno.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/cpu.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memory.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/export.h>",
            "#include <linux/stddef.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/hash.h>",
            "#include <linux/kprobes.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/errno.h>\n#include <asm/cacheflush.h>\n#include <asm/sections.h>\n#include <linux/jump_label.h>\n#include <linux/cpu.h>\n#include <linux/ftrace.h>\n#include <linux/memory.h>\n#include <linux/kdebug.h>\n#include <linux/sysctl.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/freezer.h>\n#include <linux/kallsyms.h>\n#include <linux/moduleloader.h>\n#include <linux/export.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/hash.h>\n#include <linux/kprobes.h>\n\nvoid unregister_kretprobe(struct kretprobe *rp)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "target",
          "args": [
            "rand1"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "kprobe_target2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
          "lines": "91-94",
          "snippet": "static noinline u32 kprobe_target2(u32 value)\n{\n\treturn (value / div_factor) + 1;\n}",
          "includes": [
            "#include <linux/random.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define div_factor 3"
          ],
          "globals_used": [
            "static u32 (*target)(u32 value);",
            "static u32 (*target2)(u32 value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic u32 (*target)(u32 value);\nstatic u32 (*target2)(u32 value);\n\nstatic noinline u32 kprobe_target2(u32 value)\n{\n\treturn (value / div_factor) + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"register_kretprobe returned %d\\n\"",
            "ret"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\nstatic int test_kretprobe(void)\n{\n\tint ret;\n\n\tret = register_kretprobe(&rp);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kretprobe returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tret = target(rand1);\n\tunregister_kretprobe(&rp);\n\tif (krph_val != rand1) {\n\t\tpr_err(\"kretprobe handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "return_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "178-197",
    "snippet": "static int return_handler(struct kretprobe_instance *ri, struct pt_regs *regs)\n{\n\tunsigned long ret = regs_return_value(regs);\n\n\tif (preemptible()) {\n\t\thandler_errors++;\n\t\tpr_err(\"kretprobe return handler is preemptible\\n\");\n\t}\n\tif (ret != (rand1 / div_factor)) {\n\t\thandler_errors++;\n\t\tpr_err(\"incorrect value in kretprobe handler\\n\");\n\t}\n\tif (krph_val == 0) {\n\t\thandler_errors++;\n\t\tpr_err(\"call to kretprobe entry handler failed\\n\");\n\t}\n\n\tkrph_val = rand1;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define div_factor 3"
    ],
    "globals_used": [
      "static u32 (*target)(u32 value);",
      "static u32 (*target2)(u32 value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"call to kretprobe entry handler failed\\n\""
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"incorrect value in kretprobe handler\\n\""
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"kretprobe return handler is preemptible\\n\""
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preemptible",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "regs_return_value",
          "args": [
            "regs"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic u32 (*target)(u32 value);\nstatic u32 (*target2)(u32 value);\n\nstatic int return_handler(struct kretprobe_instance *ri, struct pt_regs *regs)\n{\n\tunsigned long ret = regs_return_value(regs);\n\n\tif (preemptible()) {\n\t\thandler_errors++;\n\t\tpr_err(\"kretprobe return handler is preemptible\\n\");\n\t}\n\tif (ret != (rand1 / div_factor)) {\n\t\thandler_errors++;\n\t\tpr_err(\"incorrect value in kretprobe handler\\n\");\n\t}\n\tif (krph_val == 0) {\n\t\thandler_errors++;\n\t\tpr_err(\"call to kretprobe entry handler failed\\n\");\n\t}\n\n\tkrph_val = rand1;\n\treturn 0;\n}"
  },
  {
    "function_name": "entry_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "168-176",
    "snippet": "static int entry_handler(struct kretprobe_instance *ri, struct pt_regs *regs)\n{\n\tif (preemptible()) {\n\t\thandler_errors++;\n\t\tpr_err(\"kretprobe entry handler is preemptible\\n\");\n\t}\n\tkrph_val = (rand1 / div_factor);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define div_factor 3"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"kretprobe entry handler is preemptible\\n\""
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preemptible",
          "args": [],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic int entry_handler(struct kretprobe_instance *ri, struct pt_regs *regs)\n{\n\tif (preemptible()) {\n\t\thandler_errors++;\n\t\tpr_err(\"kretprobe entry handler is preemptible\\n\");\n\t}\n\tkrph_val = (rand1 / div_factor);\n\treturn 0;\n}"
  },
  {
    "function_name": "test_kprobes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "118-163",
    "snippet": "static int test_kprobes(void)\n{\n\tint ret;\n\tstruct kprobe *kps[2] = {&kp, &kp2};\n\n\t/* addr and flags should be cleard for reusing kprobe. */\n\tkp.addr = NULL;\n\tkp.flags = 0;\n\tret = register_kprobes(kps, 2);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kprobes returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tpreh_val = 0;\n\tposth_val = 0;\n\tret = target(rand1);\n\n\tif (preh_val == 0) {\n\t\tpr_err(\"kprobe pre_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tif (posth_val == 0) {\n\t\tpr_err(\"kprobe post_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tpreh_val = 0;\n\tposth_val = 0;\n\tret = target2(rand1);\n\n\tif (preh_val == 0) {\n\t\tpr_err(\"kprobe pre_handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tif (posth_val == 0) {\n\t\tpr_err(\"kprobe post_handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tunregister_kprobes(kps, 2);\n\treturn 0;\n\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u32 rand1, preh_val, posth_val;",
      "static struct kprobe kp = {\n\t.symbol_name = \"kprobe_target\",\n\t.pre_handler = kp_pre_handler,\n\t.post_handler = kp_post_handler\n};",
      "static struct kprobe kp2 = {\n\t.symbol_name = \"kprobe_target2\",\n\t.pre_handler = kp_pre_handler2,\n\t.post_handler = kp_post_handler2\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_kprobes",
          "args": [
            "kps",
            "2"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_kprobes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/kprobes.c",
          "lines": "1767-1783",
          "snippet": "void unregister_kprobes(struct kprobe **kps, int num)\n{\n\tint i;\n\n\tif (num <= 0)\n\t\treturn;\n\tmutex_lock(&kprobe_mutex);\n\tfor (i = 0; i < num; i++)\n\t\tif (__unregister_kprobe_top(kps[i]) < 0)\n\t\t\tkps[i]->addr = NULL;\n\tmutex_unlock(&kprobe_mutex);\n\n\tsynchronize_sched();\n\tfor (i = 0; i < num; i++)\n\t\tif (kps[i]->addr)\n\t\t\t__unregister_kprobe_bottom(kps[i]);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <asm/errno.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/cpu.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memory.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/export.h>",
            "#include <linux/stddef.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/hash.h>",
            "#include <linux/kprobes.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(kprobe_mutex);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/errno.h>\n#include <asm/cacheflush.h>\n#include <asm/sections.h>\n#include <linux/jump_label.h>\n#include <linux/cpu.h>\n#include <linux/ftrace.h>\n#include <linux/memory.h>\n#include <linux/kdebug.h>\n#include <linux/sysctl.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/freezer.h>\n#include <linux/kallsyms.h>\n#include <linux/moduleloader.h>\n#include <linux/export.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/hash.h>\n#include <linux/kprobes.h>\n\nstatic DEFINE_MUTEX(kprobe_mutex);\n\nvoid unregister_kprobes(struct kprobe **kps, int num)\n{\n\tint i;\n\n\tif (num <= 0)\n\t\treturn;\n\tmutex_lock(&kprobe_mutex);\n\tfor (i = 0; i < num; i++)\n\t\tif (__unregister_kprobe_top(kps[i]) < 0)\n\t\t\tkps[i]->addr = NULL;\n\tmutex_unlock(&kprobe_mutex);\n\n\tsynchronize_sched();\n\tfor (i = 0; i < num; i++)\n\t\tif (kps[i]->addr)\n\t\t\t__unregister_kprobe_bottom(kps[i]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"kprobe post_handler2 not called\\n\""
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"kprobe pre_handler2 not called\\n\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "target2",
          "args": [
            "rand1"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "kprobe_target2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
          "lines": "91-94",
          "snippet": "static noinline u32 kprobe_target2(u32 value)\n{\n\treturn (value / div_factor) + 1;\n}",
          "includes": [
            "#include <linux/random.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define div_factor 3"
          ],
          "globals_used": [
            "static u32 (*target)(u32 value);",
            "static u32 (*target2)(u32 value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic u32 (*target)(u32 value);\nstatic u32 (*target2)(u32 value);\n\nstatic noinline u32 kprobe_target2(u32 value)\n{\n\treturn (value / div_factor) + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"kprobe post_handler not called\\n\""
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"kprobe pre_handler not called\\n\""
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"register_kprobes returned %d\\n\"",
            "ret"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\nstatic u32 rand1, preh_val, posth_val;\nstatic struct kprobe kp = {\n\t.symbol_name = \"kprobe_target\",\n\t.pre_handler = kp_pre_handler,\n\t.post_handler = kp_post_handler\n};\nstatic struct kprobe kp2 = {\n\t.symbol_name = \"kprobe_target2\",\n\t.pre_handler = kp_pre_handler2,\n\t.post_handler = kp_post_handler2\n};\n\nstatic int test_kprobes(void)\n{\n\tint ret;\n\tstruct kprobe *kps[2] = {&kp, &kp2};\n\n\t/* addr and flags should be cleard for reusing kprobe. */\n\tkp.addr = NULL;\n\tkp.flags = 0;\n\tret = register_kprobes(kps, 2);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kprobes returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tpreh_val = 0;\n\tposth_val = 0;\n\tret = target(rand1);\n\n\tif (preh_val == 0) {\n\t\tpr_err(\"kprobe pre_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tif (posth_val == 0) {\n\t\tpr_err(\"kprobe post_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tpreh_val = 0;\n\tposth_val = 0;\n\tret = target2(rand1);\n\n\tif (preh_val == 0) {\n\t\tpr_err(\"kprobe pre_handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tif (posth_val == 0) {\n\t\tpr_err(\"kprobe post_handler2 not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tunregister_kprobes(kps, 2);\n\treturn 0;\n\n}"
  },
  {
    "function_name": "kp_post_handler2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "102-110",
    "snippet": "static void kp_post_handler2(struct kprobe *p, struct pt_regs *regs,\n\t\tunsigned long flags)\n{\n\tif (preh_val != (rand1 / div_factor) + 1) {\n\t\thandler_errors++;\n\t\tpr_err(\"incorrect value in post_handler2\\n\");\n\t}\n\tposth_val = preh_val + div_factor;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define div_factor 3"
    ],
    "globals_used": [
      "static u32 rand1, preh_val, posth_val;",
      "static u32 (*target)(u32 value);",
      "static u32 (*target2)(u32 value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"incorrect value in post_handler2\\n\""
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic u32 rand1, preh_val, posth_val;\nstatic u32 (*target)(u32 value);\nstatic u32 (*target2)(u32 value);\n\nstatic void kp_post_handler2(struct kprobe *p, struct pt_regs *regs,\n\t\tunsigned long flags)\n{\n\tif (preh_val != (rand1 / div_factor) + 1) {\n\t\thandler_errors++;\n\t\tpr_err(\"incorrect value in post_handler2\\n\");\n\t}\n\tposth_val = preh_val + div_factor;\n}"
  },
  {
    "function_name": "kp_pre_handler2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "96-100",
    "snippet": "static int kp_pre_handler2(struct kprobe *p, struct pt_regs *regs)\n{\n\tpreh_val = (rand1 / div_factor) + 1;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define div_factor 3"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic int kp_pre_handler2(struct kprobe *p, struct pt_regs *regs)\n{\n\tpreh_val = (rand1 / div_factor) + 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "kprobe_target2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "91-94",
    "snippet": "static noinline u32 kprobe_target2(u32 value)\n{\n\treturn (value / div_factor) + 1;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define div_factor 3"
    ],
    "globals_used": [
      "static u32 (*target)(u32 value);",
      "static u32 (*target2)(u32 value);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic u32 (*target)(u32 value);\nstatic u32 (*target2)(u32 value);\n\nstatic noinline u32 kprobe_target2(u32 value)\n{\n\treturn (value / div_factor) + 1;\n}"
  },
  {
    "function_name": "test_kprobe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "65-89",
    "snippet": "static int test_kprobe(void)\n{\n\tint ret;\n\n\tret = register_kprobe(&kp);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kprobe returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tret = target(rand1);\n\tunregister_kprobe(&kp);\n\n\tif (preh_val == 0) {\n\t\tpr_err(\"kprobe pre_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tif (posth_val == 0) {\n\t\tpr_err(\"kprobe post_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u32 rand1, preh_val, posth_val;",
      "static struct kprobe kp = {\n\t.symbol_name = \"kprobe_target\",\n\t.pre_handler = kp_pre_handler,\n\t.post_handler = kp_post_handler\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"kprobe post_handler not called\\n\""
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"kprobe pre_handler not called\\n\""
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unregister_kprobe",
          "args": [
            "&kp"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_kprobe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/kprobes.c",
          "lines": "1761-1764",
          "snippet": "void unregister_kprobe(struct kprobe *p)\n{\n\tunregister_kprobes(&p, 1);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <asm/errno.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/cpu.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memory.h>",
            "#include <linux/kdebug.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/export.h>",
            "#include <linux/stddef.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>",
            "#include <linux/hash.h>",
            "#include <linux/kprobes.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/errno.h>\n#include <asm/cacheflush.h>\n#include <asm/sections.h>\n#include <linux/jump_label.h>\n#include <linux/cpu.h>\n#include <linux/ftrace.h>\n#include <linux/memory.h>\n#include <linux/kdebug.h>\n#include <linux/sysctl.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/freezer.h>\n#include <linux/kallsyms.h>\n#include <linux/moduleloader.h>\n#include <linux/export.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n#include <linux/hash.h>\n#include <linux/kprobes.h>\n\nvoid unregister_kprobe(struct kprobe *p)\n{\n\tunregister_kprobes(&p, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "target",
          "args": [
            "rand1"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "kprobe_target2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
          "lines": "91-94",
          "snippet": "static noinline u32 kprobe_target2(u32 value)\n{\n\treturn (value / div_factor) + 1;\n}",
          "includes": [
            "#include <linux/random.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define div_factor 3"
          ],
          "globals_used": [
            "static u32 (*target)(u32 value);",
            "static u32 (*target2)(u32 value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic u32 (*target)(u32 value);\nstatic u32 (*target2)(u32 value);\n\nstatic noinline u32 kprobe_target2(u32 value)\n{\n\treturn (value / div_factor) + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"register_kprobe returned %d\\n\"",
            "ret"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\nstatic u32 rand1, preh_val, posth_val;\nstatic struct kprobe kp = {\n\t.symbol_name = \"kprobe_target\",\n\t.pre_handler = kp_pre_handler,\n\t.post_handler = kp_post_handler\n};\n\nstatic int test_kprobe(void)\n{\n\tint ret;\n\n\tret = register_kprobe(&kp);\n\tif (ret < 0) {\n\t\tpr_err(\"register_kprobe returned %d\\n\", ret);\n\t\treturn ret;\n\t}\n\n\tret = target(rand1);\n\tunregister_kprobe(&kp);\n\n\tif (preh_val == 0) {\n\t\tpr_err(\"kprobe pre_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\tif (posth_val == 0) {\n\t\tpr_err(\"kprobe post_handler not called\\n\");\n\t\thandler_errors++;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "kp_post_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "45-57",
    "snippet": "static void kp_post_handler(struct kprobe *p, struct pt_regs *regs,\n\t\tunsigned long flags)\n{\n\tif (preemptible()) {\n\t\thandler_errors++;\n\t\tpr_err(\"post-handler is preemptible\\n\");\n\t}\n\tif (preh_val != (rand1 / div_factor)) {\n\t\thandler_errors++;\n\t\tpr_err(\"incorrect value in post_handler\\n\");\n\t}\n\tposth_val = preh_val + div_factor;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define div_factor 3"
    ],
    "globals_used": [
      "static u32 rand1, preh_val, posth_val;",
      "static u32 (*target)(u32 value);",
      "static u32 (*target2)(u32 value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"incorrect value in post_handler\\n\""
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"post-handler is preemptible\\n\""
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preemptible",
          "args": [],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic u32 rand1, preh_val, posth_val;\nstatic u32 (*target)(u32 value);\nstatic u32 (*target2)(u32 value);\n\nstatic void kp_post_handler(struct kprobe *p, struct pt_regs *regs,\n\t\tunsigned long flags)\n{\n\tif (preemptible()) {\n\t\thandler_errors++;\n\t\tpr_err(\"post-handler is preemptible\\n\");\n\t}\n\tif (preh_val != (rand1 / div_factor)) {\n\t\thandler_errors++;\n\t\tpr_err(\"incorrect value in post_handler\\n\");\n\t}\n\tposth_val = preh_val + div_factor;\n}"
  },
  {
    "function_name": "kp_pre_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "35-43",
    "snippet": "static int kp_pre_handler(struct kprobe *p, struct pt_regs *regs)\n{\n\tif (preemptible()) {\n\t\thandler_errors++;\n\t\tpr_err(\"pre-handler is preemptible\\n\");\n\t}\n\tpreh_val = (rand1 / div_factor);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define div_factor 3"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"pre-handler is preemptible\\n\""
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preemptible",
          "args": [],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic int kp_pre_handler(struct kprobe *p, struct pt_regs *regs)\n{\n\tif (preemptible()) {\n\t\thandler_errors++;\n\t\tpr_err(\"pre-handler is preemptible\\n\");\n\t}\n\tpreh_val = (rand1 / div_factor);\n\treturn 0;\n}"
  },
  {
    "function_name": "kprobe_target",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/test_kprobes.c",
    "lines": "30-33",
    "snippet": "static noinline u32 kprobe_target(u32 value)\n{\n\treturn (value / div_factor);\n}",
    "includes": [
      "#include <linux/random.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define div_factor 3"
    ],
    "globals_used": [
      "static u32 (*target)(u32 value);",
      "static u32 (*target2)(u32 value);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/random.h>\n#include <linux/kprobes.h>\n#include <linux/kernel.h>\n\n#define div_factor 3\n\nstatic u32 (*target)(u32 value);\nstatic u32 (*target2)(u32 value);\n\nstatic noinline u32 kprobe_target(u32 value)\n{\n\treturn (value / div_factor);\n}"
  }
]