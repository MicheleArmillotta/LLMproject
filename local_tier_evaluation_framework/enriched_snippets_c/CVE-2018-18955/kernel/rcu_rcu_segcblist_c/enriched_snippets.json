[
  {
    "function_name": "rcu_segcblist_merge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "413-428",
    "snippet": "void rcu_segcblist_merge(struct rcu_segcblist *dst_rsclp,\n\t\t\t struct rcu_segcblist *src_rsclp)\n{\n\tstruct rcu_cblist donecbs;\n\tstruct rcu_cblist pendcbs;\n\n\trcu_cblist_init(&donecbs);\n\trcu_cblist_init(&pendcbs);\n\trcu_segcblist_extract_count(src_rsclp, &donecbs);\n\trcu_segcblist_extract_done_cbs(src_rsclp, &donecbs);\n\trcu_segcblist_extract_pend_cbs(src_rsclp, &pendcbs);\n\trcu_segcblist_insert_count(dst_rsclp, &donecbs);\n\trcu_segcblist_insert_done_cbs(dst_rsclp, &donecbs);\n\trcu_segcblist_insert_pend_cbs(dst_rsclp, &pendcbs);\n\trcu_segcblist_init(src_rsclp);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_init",
          "args": [
            "src_rsclp"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "63-74",
          "snippet": "void rcu_segcblist_init(struct rcu_segcblist *rsclp)\n{\n\tint i;\n\n\tBUILD_BUG_ON(RCU_NEXT_TAIL + 1 != ARRAY_SIZE(rsclp->gp_seq));\n\tBUILD_BUG_ON(ARRAY_SIZE(rsclp->tails) != ARRAY_SIZE(rsclp->gp_seq));\n\trsclp->head = NULL;\n\tfor (i = 0; i < RCU_CBLIST_NSEGS; i++)\n\t\trsclp->tails[i] = &rsclp->head;\n\trsclp->len = 0;\n\trsclp->len_lazy = 0;\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcupdate.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp)\n{\n\tint i;\n\n\tBUILD_BUG_ON(RCU_NEXT_TAIL + 1 != ARRAY_SIZE(rsclp->gp_seq));\n\tBUILD_BUG_ON(ARRAY_SIZE(rsclp->tails) != ARRAY_SIZE(rsclp->gp_seq));\n\trsclp->head = NULL;\n\tfor (i = 0; i < RCU_CBLIST_NSEGS; i++)\n\t\trsclp->tails[i] = &rsclp->head;\n\trsclp->len = 0;\n\trsclp->len_lazy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_insert_pend_cbs",
          "args": [
            "dst_rsclp",
            "&pendcbs"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_insert_pend_cbs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "285-294",
          "snippet": "void rcu_segcblist_insert_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tif (!rclp->head)\n\t\treturn; /* Nothing to do. */\n\t*rsclp->tails[RCU_NEXT_TAIL] = rclp->head;\n\trsclp->tails[RCU_NEXT_TAIL] = rclp->tail;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcupdate.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_insert_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tif (!rclp->head)\n\t\treturn; /* Nothing to do. */\n\t*rsclp->tails[RCU_NEXT_TAIL] = rclp->head;\n\trsclp->tails[RCU_NEXT_TAIL] = rclp->tail;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_insert_done_cbs",
          "args": [
            "dst_rsclp",
            "&donecbs"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_insert_done_cbs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "263-279",
          "snippet": "void rcu_segcblist_insert_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rclp->head)\n\t\treturn; /* No callbacks to move. */\n\t*rclp->tail = rsclp->head;\n\trsclp->head = rclp->head;\n\tfor (i = RCU_DONE_TAIL; i < RCU_CBLIST_NSEGS; i++)\n\t\tif (&rsclp->head == rsclp->tails[i])\n\t\t\trsclp->tails[i] = rclp->tail;\n\t\telse\n\t\t\tbreak;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcupdate.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_insert_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rclp->head)\n\t\treturn; /* No callbacks to move. */\n\t*rclp->tail = rsclp->head;\n\trsclp->head = rclp->head;\n\tfor (i = RCU_DONE_TAIL; i < RCU_CBLIST_NSEGS; i++)\n\t\tif (&rsclp->head == rsclp->tails[i])\n\t\t\trsclp->tails[i] = rclp->tail;\n\t\telse\n\t\t\tbreak;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_insert_count",
          "args": [
            "dst_rsclp",
            "&donecbs"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_insert_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "249-257",
          "snippet": "void rcu_segcblist_insert_count(struct rcu_segcblist *rsclp,\n\t\t\t\tstruct rcu_cblist *rclp)\n{\n\trsclp->len_lazy += rclp->len_lazy;\n\t/* ->len sampled locklessly. */\n\tWRITE_ONCE(rsclp->len, rsclp->len + rclp->len);\n\trclp->len_lazy = 0;\n\trclp->len = 0;\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcupdate.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_insert_count(struct rcu_segcblist *rsclp,\n\t\t\t\tstruct rcu_cblist *rclp)\n{\n\trsclp->len_lazy += rclp->len_lazy;\n\t/* ->len sampled locklessly. */\n\tWRITE_ONCE(rsclp->len, rsclp->len + rclp->len);\n\trclp->len_lazy = 0;\n\trclp->len = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_extract_pend_cbs",
          "args": [
            "src_rsclp",
            "&pendcbs"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_extract_pend_cbs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "231-243",
          "snippet": "void rcu_segcblist_extract_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_pend_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\t*rclp->tail = *rsclp->tails[RCU_DONE_TAIL];\n\trclp->tail = rsclp->tails[RCU_NEXT_TAIL];\n\t*rsclp->tails[RCU_DONE_TAIL] = NULL;\n\tfor (i = RCU_DONE_TAIL + 1; i < RCU_CBLIST_NSEGS; i++)\n\t\trsclp->tails[i] = rsclp->tails[RCU_DONE_TAIL];\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcupdate.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_extract_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_pend_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\t*rclp->tail = *rsclp->tails[RCU_DONE_TAIL];\n\trclp->tail = rsclp->tails[RCU_NEXT_TAIL];\n\t*rsclp->tails[RCU_DONE_TAIL] = NULL;\n\tfor (i = RCU_DONE_TAIL + 1; i < RCU_CBLIST_NSEGS; i++)\n\t\trsclp->tails[i] = rsclp->tails[RCU_DONE_TAIL];\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_extract_done_cbs",
          "args": [
            "src_rsclp",
            "&donecbs"
          ],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_extract_done_cbs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "208-222",
          "snippet": "void rcu_segcblist_extract_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_ready_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\t*rclp->tail = rsclp->head;\n\trsclp->head = *rsclp->tails[RCU_DONE_TAIL];\n\t*rsclp->tails[RCU_DONE_TAIL] = NULL;\n\trclp->tail = rsclp->tails[RCU_DONE_TAIL];\n\tfor (i = RCU_CBLIST_NSEGS - 1; i >= RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] == rsclp->tails[RCU_DONE_TAIL])\n\t\t\trsclp->tails[i] = &rsclp->head;\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcupdate.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_extract_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_ready_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\t*rclp->tail = rsclp->head;\n\trsclp->head = *rsclp->tails[RCU_DONE_TAIL];\n\t*rsclp->tails[RCU_DONE_TAIL] = NULL;\n\trclp->tail = rsclp->tails[RCU_DONE_TAIL];\n\tfor (i = RCU_CBLIST_NSEGS - 1; i >= RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] == rsclp->tails[RCU_DONE_TAIL])\n\t\t\trsclp->tails[i] = &rsclp->head;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_extract_count",
          "args": [
            "src_rsclp",
            "&donecbs"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_extract_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "194-201",
          "snippet": "void rcu_segcblist_extract_count(struct rcu_segcblist *rsclp,\n\t\t\t\t\t       struct rcu_cblist *rclp)\n{\n\trclp->len_lazy += rsclp->len_lazy;\n\trclp->len += rsclp->len;\n\trsclp->len_lazy = 0;\n\tWRITE_ONCE(rsclp->len, 0); /* ->len sampled locklessly. */\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcupdate.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_extract_count(struct rcu_segcblist *rsclp,\n\t\t\t\t\t       struct rcu_cblist *rclp)\n{\n\trclp->len_lazy += rsclp->len_lazy;\n\trclp->len += rsclp->len;\n\trsclp->len_lazy = 0;\n\tWRITE_ONCE(rsclp->len, 0); /* ->len sampled locklessly. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_cblist_init",
          "args": [
            "&pendcbs"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_cblist_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "31-37",
          "snippet": "void rcu_cblist_init(struct rcu_cblist *rclp)\n{\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n\trclp->len = 0;\n\trclp->len_lazy = 0;\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcupdate.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_cblist_init(struct rcu_cblist *rclp)\n{\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n\trclp->len = 0;\n\trclp->len_lazy = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_merge(struct rcu_segcblist *dst_rsclp,\n\t\t\t struct rcu_segcblist *src_rsclp)\n{\n\tstruct rcu_cblist donecbs;\n\tstruct rcu_cblist pendcbs;\n\n\trcu_cblist_init(&donecbs);\n\trcu_cblist_init(&pendcbs);\n\trcu_segcblist_extract_count(src_rsclp, &donecbs);\n\trcu_segcblist_extract_done_cbs(src_rsclp, &donecbs);\n\trcu_segcblist_extract_pend_cbs(src_rsclp, &pendcbs);\n\trcu_segcblist_insert_count(dst_rsclp, &donecbs);\n\trcu_segcblist_insert_done_cbs(dst_rsclp, &donecbs);\n\trcu_segcblist_insert_pend_cbs(dst_rsclp, &pendcbs);\n\trcu_segcblist_init(src_rsclp);\n}"
  },
  {
    "function_name": "rcu_segcblist_accelerate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "355-404",
    "snippet": "bool rcu_segcblist_accelerate(struct rcu_segcblist *rsclp, unsigned long seq)\n{\n\tint i;\n\n\tWARN_ON_ONCE(!rcu_segcblist_is_enabled(rsclp));\n\tif (rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL))\n\t\treturn false;\n\n\t/*\n\t * Find the segment preceding the oldest segment of callbacks\n\t * whose ->gp_seq[] completion is at or after that passed in via\n\t * \"seq\", skipping any empty segments.  This oldest segment, along\n\t * with any later segments, can be merged in with any newly arrived\n\t * callbacks in the RCU_NEXT_TAIL segment, and assigned \"seq\"\n\t * as their ->gp_seq[] grace-period completion sequence number.\n\t */\n\tfor (i = RCU_NEXT_READY_TAIL; i > RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] != rsclp->tails[i - 1] &&\n\t\t    ULONG_CMP_LT(rsclp->gp_seq[i], seq))\n\t\t\tbreak;\n\n\t/*\n\t * If all the segments contain callbacks that correspond to\n\t * earlier grace-period sequence numbers than \"seq\", leave.\n\t * Assuming that the rcu_segcblist structure has enough\n\t * segments in its arrays, this can only happen if some of\n\t * the non-done segments contain callbacks that really are\n\t * ready to invoke.  This situation will get straightened\n\t * out by the next call to rcu_segcblist_advance().\n\t *\n\t * Also advance to the oldest segment of callbacks whose\n\t * ->gp_seq[] completion is at or after that passed in via \"seq\",\n\t * skipping any empty segments.\n\t */\n\tif (++i >= RCU_NEXT_TAIL)\n\t\treturn false;\n\n\t/*\n\t * Merge all later callbacks, including newly arrived callbacks,\n\t * into the segment located by the for-loop above.  Assign \"seq\"\n\t * as the ->gp_seq[] value in order to correctly handle the case\n\t * where there were no pending callbacks in the rcu_segcblist\n\t * structure other than in the RCU_NEXT_TAIL segment.\n\t */\n\tfor (; i < RCU_NEXT_TAIL; i++) {\n\t\trsclp->tails[i] = rsclp->tails[RCU_NEXT_TAIL];\n\t\trsclp->gp_seq[i] = seq;\n\t}\n\treturn true;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ULONG_CMP_LT",
          "args": [
            "rsclp->gp_seq[i]",
            "seq"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_restempty",
          "args": [
            "rsclp",
            "RCU_DONE_TAIL"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_restempty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "87-90",
          "snippet": "static inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !*rsclp->tails[seg];\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !*rsclp->tails[seg];\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!rcu_segcblist_is_enabled(rsclp)"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "77-80",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nbool rcu_segcblist_accelerate(struct rcu_segcblist *rsclp, unsigned long seq)\n{\n\tint i;\n\n\tWARN_ON_ONCE(!rcu_segcblist_is_enabled(rsclp));\n\tif (rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL))\n\t\treturn false;\n\n\t/*\n\t * Find the segment preceding the oldest segment of callbacks\n\t * whose ->gp_seq[] completion is at or after that passed in via\n\t * \"seq\", skipping any empty segments.  This oldest segment, along\n\t * with any later segments, can be merged in with any newly arrived\n\t * callbacks in the RCU_NEXT_TAIL segment, and assigned \"seq\"\n\t * as their ->gp_seq[] grace-period completion sequence number.\n\t */\n\tfor (i = RCU_NEXT_READY_TAIL; i > RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] != rsclp->tails[i - 1] &&\n\t\t    ULONG_CMP_LT(rsclp->gp_seq[i], seq))\n\t\t\tbreak;\n\n\t/*\n\t * If all the segments contain callbacks that correspond to\n\t * earlier grace-period sequence numbers than \"seq\", leave.\n\t * Assuming that the rcu_segcblist structure has enough\n\t * segments in its arrays, this can only happen if some of\n\t * the non-done segments contain callbacks that really are\n\t * ready to invoke.  This situation will get straightened\n\t * out by the next call to rcu_segcblist_advance().\n\t *\n\t * Also advance to the oldest segment of callbacks whose\n\t * ->gp_seq[] completion is at or after that passed in via \"seq\",\n\t * skipping any empty segments.\n\t */\n\tif (++i >= RCU_NEXT_TAIL)\n\t\treturn false;\n\n\t/*\n\t * Merge all later callbacks, including newly arrived callbacks,\n\t * into the segment located by the for-loop above.  Assign \"seq\"\n\t * as the ->gp_seq[] value in order to correctly handle the case\n\t * where there were no pending callbacks in the rcu_segcblist\n\t * structure other than in the RCU_NEXT_TAIL segment.\n\t */\n\tfor (; i < RCU_NEXT_TAIL; i++) {\n\t\trsclp->tails[i] = rsclp->tails[RCU_NEXT_TAIL];\n\t\trsclp->gp_seq[i] = seq;\n\t}\n\treturn true;\n}"
  },
  {
    "function_name": "rcu_segcblist_advance",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "300-338",
    "snippet": "void rcu_segcblist_advance(struct rcu_segcblist *rsclp, unsigned long seq)\n{\n\tint i, j;\n\n\tWARN_ON_ONCE(!rcu_segcblist_is_enabled(rsclp));\n\tif (rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL))\n\t\treturn;\n\n\t/*\n\t * Find all callbacks whose ->gp_seq numbers indicate that they\n\t * are ready to invoke, and put them into the RCU_DONE_TAIL segment.\n\t */\n\tfor (i = RCU_WAIT_TAIL; i < RCU_NEXT_TAIL; i++) {\n\t\tif (ULONG_CMP_LT(seq, rsclp->gp_seq[i]))\n\t\t\tbreak;\n\t\trsclp->tails[RCU_DONE_TAIL] = rsclp->tails[i];\n\t}\n\n\t/* If no callbacks moved, nothing more need be done. */\n\tif (i == RCU_WAIT_TAIL)\n\t\treturn;\n\n\t/* Clean up tail pointers that might have been misordered above. */\n\tfor (j = RCU_WAIT_TAIL; j < i; j++)\n\t\trsclp->tails[j] = rsclp->tails[RCU_DONE_TAIL];\n\n\t/*\n\t * Callbacks moved, so clean up the misordered ->tails[] pointers\n\t * that now point into the middle of the list of ready-to-invoke\n\t * callbacks.  The overall effect is to copy down the later pointers\n\t * into the gap that was created by the now-ready segments.\n\t */\n\tfor (j = RCU_WAIT_TAIL; i < RCU_NEXT_TAIL; i++, j++) {\n\t\tif (rsclp->tails[j] == rsclp->tails[RCU_NEXT_TAIL])\n\t\t\tbreak;  /* No more callbacks. */\n\t\trsclp->tails[j] = rsclp->tails[i];\n\t\trsclp->gp_seq[j] = rsclp->gp_seq[i];\n\t}\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ULONG_CMP_LT",
          "args": [
            "seq",
            "rsclp->gp_seq[i]"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_restempty",
          "args": [
            "rsclp",
            "RCU_DONE_TAIL"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_restempty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "87-90",
          "snippet": "static inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !*rsclp->tails[seg];\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !*rsclp->tails[seg];\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!rcu_segcblist_is_enabled(rsclp)"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "77-80",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_advance(struct rcu_segcblist *rsclp, unsigned long seq)\n{\n\tint i, j;\n\n\tWARN_ON_ONCE(!rcu_segcblist_is_enabled(rsclp));\n\tif (rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL))\n\t\treturn;\n\n\t/*\n\t * Find all callbacks whose ->gp_seq numbers indicate that they\n\t * are ready to invoke, and put them into the RCU_DONE_TAIL segment.\n\t */\n\tfor (i = RCU_WAIT_TAIL; i < RCU_NEXT_TAIL; i++) {\n\t\tif (ULONG_CMP_LT(seq, rsclp->gp_seq[i]))\n\t\t\tbreak;\n\t\trsclp->tails[RCU_DONE_TAIL] = rsclp->tails[i];\n\t}\n\n\t/* If no callbacks moved, nothing more need be done. */\n\tif (i == RCU_WAIT_TAIL)\n\t\treturn;\n\n\t/* Clean up tail pointers that might have been misordered above. */\n\tfor (j = RCU_WAIT_TAIL; j < i; j++)\n\t\trsclp->tails[j] = rsclp->tails[RCU_DONE_TAIL];\n\n\t/*\n\t * Callbacks moved, so clean up the misordered ->tails[] pointers\n\t * that now point into the middle of the list of ready-to-invoke\n\t * callbacks.  The overall effect is to copy down the later pointers\n\t * into the gap that was created by the now-ready segments.\n\t */\n\tfor (j = RCU_WAIT_TAIL; i < RCU_NEXT_TAIL; i++, j++) {\n\t\tif (rsclp->tails[j] == rsclp->tails[RCU_NEXT_TAIL])\n\t\t\tbreak;  /* No more callbacks. */\n\t\trsclp->tails[j] = rsclp->tails[i];\n\t\trsclp->gp_seq[j] = rsclp->gp_seq[i];\n\t}\n}"
  },
  {
    "function_name": "rcu_segcblist_insert_pend_cbs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "285-294",
    "snippet": "void rcu_segcblist_insert_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tif (!rclp->head)\n\t\treturn; /* Nothing to do. */\n\t*rsclp->tails[RCU_NEXT_TAIL] = rclp->head;\n\trsclp->tails[RCU_NEXT_TAIL] = rclp->tail;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_insert_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tif (!rclp->head)\n\t\treturn; /* Nothing to do. */\n\t*rsclp->tails[RCU_NEXT_TAIL] = rclp->head;\n\trsclp->tails[RCU_NEXT_TAIL] = rclp->tail;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}"
  },
  {
    "function_name": "rcu_segcblist_insert_done_cbs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "263-279",
    "snippet": "void rcu_segcblist_insert_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rclp->head)\n\t\treturn; /* No callbacks to move. */\n\t*rclp->tail = rsclp->head;\n\trsclp->head = rclp->head;\n\tfor (i = RCU_DONE_TAIL; i < RCU_CBLIST_NSEGS; i++)\n\t\tif (&rsclp->head == rsclp->tails[i])\n\t\t\trsclp->tails[i] = rclp->tail;\n\t\telse\n\t\t\tbreak;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_insert_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rclp->head)\n\t\treturn; /* No callbacks to move. */\n\t*rclp->tail = rsclp->head;\n\trsclp->head = rclp->head;\n\tfor (i = RCU_DONE_TAIL; i < RCU_CBLIST_NSEGS; i++)\n\t\tif (&rsclp->head == rsclp->tails[i])\n\t\t\trsclp->tails[i] = rclp->tail;\n\t\telse\n\t\t\tbreak;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}"
  },
  {
    "function_name": "rcu_segcblist_insert_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "249-257",
    "snippet": "void rcu_segcblist_insert_count(struct rcu_segcblist *rsclp,\n\t\t\t\tstruct rcu_cblist *rclp)\n{\n\trsclp->len_lazy += rclp->len_lazy;\n\t/* ->len sampled locklessly. */\n\tWRITE_ONCE(rsclp->len, rsclp->len + rclp->len);\n\trclp->len_lazy = 0;\n\trclp->len = 0;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->len",
            "rsclp->len + rclp->len"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_insert_count(struct rcu_segcblist *rsclp,\n\t\t\t\tstruct rcu_cblist *rclp)\n{\n\trsclp->len_lazy += rclp->len_lazy;\n\t/* ->len sampled locklessly. */\n\tWRITE_ONCE(rsclp->len, rsclp->len + rclp->len);\n\trclp->len_lazy = 0;\n\trclp->len = 0;\n}"
  },
  {
    "function_name": "rcu_segcblist_extract_pend_cbs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "231-243",
    "snippet": "void rcu_segcblist_extract_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_pend_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\t*rclp->tail = *rsclp->tails[RCU_DONE_TAIL];\n\trclp->tail = rsclp->tails[RCU_NEXT_TAIL];\n\t*rsclp->tails[RCU_DONE_TAIL] = NULL;\n\tfor (i = RCU_DONE_TAIL + 1; i < RCU_CBLIST_NSEGS; i++)\n\t\trsclp->tails[i] = rsclp->tails[RCU_DONE_TAIL];\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_pend_cbs",
          "args": [
            "rsclp"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_pend_cbs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "102-106",
          "snippet": "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       !rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcupdate.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       !rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_extract_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_pend_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\t*rclp->tail = *rsclp->tails[RCU_DONE_TAIL];\n\trclp->tail = rsclp->tails[RCU_NEXT_TAIL];\n\t*rsclp->tails[RCU_DONE_TAIL] = NULL;\n\tfor (i = RCU_DONE_TAIL + 1; i < RCU_CBLIST_NSEGS; i++)\n\t\trsclp->tails[i] = rsclp->tails[RCU_DONE_TAIL];\n}"
  },
  {
    "function_name": "rcu_segcblist_extract_done_cbs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "208-222",
    "snippet": "void rcu_segcblist_extract_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_ready_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\t*rclp->tail = rsclp->head;\n\trsclp->head = *rsclp->tails[RCU_DONE_TAIL];\n\t*rsclp->tails[RCU_DONE_TAIL] = NULL;\n\trclp->tail = rsclp->tails[RCU_DONE_TAIL];\n\tfor (i = RCU_CBLIST_NSEGS - 1; i >= RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] == rsclp->tails[RCU_DONE_TAIL])\n\t\t\trsclp->tails[i] = &rsclp->head;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_ready_cbs",
          "args": [
            "rsclp"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_ready_cbs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "92-96",
          "snippet": "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       &rsclp->head != rsclp->tails[RCU_DONE_TAIL];\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcupdate.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       &rsclp->head != rsclp->tails[RCU_DONE_TAIL];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_extract_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_ready_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\t*rclp->tail = rsclp->head;\n\trsclp->head = *rsclp->tails[RCU_DONE_TAIL];\n\t*rsclp->tails[RCU_DONE_TAIL] = NULL;\n\trclp->tail = rsclp->tails[RCU_DONE_TAIL];\n\tfor (i = RCU_CBLIST_NSEGS - 1; i >= RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] == rsclp->tails[RCU_DONE_TAIL])\n\t\t\trsclp->tails[i] = &rsclp->head;\n}"
  },
  {
    "function_name": "rcu_segcblist_extract_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "194-201",
    "snippet": "void rcu_segcblist_extract_count(struct rcu_segcblist *rsclp,\n\t\t\t\t\t       struct rcu_cblist *rclp)\n{\n\trclp->len_lazy += rsclp->len_lazy;\n\trclp->len += rsclp->len;\n\trsclp->len_lazy = 0;\n\tWRITE_ONCE(rsclp->len, 0); /* ->len sampled locklessly. */\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->len",
            "0"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_extract_count(struct rcu_segcblist *rsclp,\n\t\t\t\t\t       struct rcu_cblist *rclp)\n{\n\trclp->len_lazy += rsclp->len_lazy;\n\trclp->len += rsclp->len;\n\trsclp->len_lazy = 0;\n\tWRITE_ONCE(rsclp->len, 0); /* ->len sampled locklessly. */\n}"
  },
  {
    "function_name": "rcu_segcblist_entrain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "164-183",
    "snippet": "bool rcu_segcblist_entrain(struct rcu_segcblist *rsclp,\n\t\t\t   struct rcu_head *rhp, bool lazy)\n{\n\tint i;\n\n\tif (rcu_segcblist_n_cbs(rsclp) == 0)\n\t\treturn false;\n\tWRITE_ONCE(rsclp->len, rsclp->len + 1);\n\tif (lazy)\n\t\trsclp->len_lazy++;\n\tsmp_mb(); /* Ensure counts are updated before callback is entrained. */\n\trhp->next = NULL;\n\tfor (i = RCU_NEXT_TAIL; i > RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] != rsclp->tails[i - 1])\n\t\t\tbreak;\n\t*rsclp->tails[i] = rhp;\n\tfor (; i <= RCU_NEXT_TAIL; i++)\n\t\trsclp->tails[i] = &rhp->next;\n\treturn true;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->len",
            "rsclp->len + 1"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_n_cbs",
          "args": [
            "rsclp"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_n_cbs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "56-59",
          "snippet": "static inline long rcu_segcblist_n_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn READ_ONCE(rsclp->len);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline long rcu_segcblist_n_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn READ_ONCE(rsclp->len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nbool rcu_segcblist_entrain(struct rcu_segcblist *rsclp,\n\t\t\t   struct rcu_head *rhp, bool lazy)\n{\n\tint i;\n\n\tif (rcu_segcblist_n_cbs(rsclp) == 0)\n\t\treturn false;\n\tWRITE_ONCE(rsclp->len, rsclp->len + 1);\n\tif (lazy)\n\t\trsclp->len_lazy++;\n\tsmp_mb(); /* Ensure counts are updated before callback is entrained. */\n\trhp->next = NULL;\n\tfor (i = RCU_NEXT_TAIL; i > RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] != rsclp->tails[i - 1])\n\t\t\tbreak;\n\t*rsclp->tails[i] = rhp;\n\tfor (; i <= RCU_NEXT_TAIL; i++)\n\t\trsclp->tails[i] = &rhp->next;\n\treturn true;\n}"
  },
  {
    "function_name": "rcu_segcblist_enqueue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "142-152",
    "snippet": "void rcu_segcblist_enqueue(struct rcu_segcblist *rsclp,\n\t\t\t   struct rcu_head *rhp, bool lazy)\n{\n\tWRITE_ONCE(rsclp->len, rsclp->len + 1); /* ->len sampled locklessly. */\n\tif (lazy)\n\t\trsclp->len_lazy++;\n\tsmp_mb(); /* Ensure counts are updated before callback is enqueued. */\n\trhp->next = NULL;\n\t*rsclp->tails[RCU_NEXT_TAIL] = rhp;\n\trsclp->tails[RCU_NEXT_TAIL] = &rhp->next;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->len",
            "rsclp->len + 1"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_enqueue(struct rcu_segcblist *rsclp,\n\t\t\t   struct rcu_head *rhp, bool lazy)\n{\n\tWRITE_ONCE(rsclp->len, rsclp->len + 1); /* ->len sampled locklessly. */\n\tif (lazy)\n\t\trsclp->len_lazy++;\n\tsmp_mb(); /* Ensure counts are updated before callback is enqueued. */\n\trhp->next = NULL;\n\t*rsclp->tails[RCU_NEXT_TAIL] = rhp;\n\trsclp->tails[RCU_NEXT_TAIL] = &rhp->next;\n}"
  },
  {
    "function_name": "rcu_segcblist_first_pend_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "126-131",
    "snippet": "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp)\n{\n\tif (rcu_segcblist_is_enabled(rsclp))\n\t\treturn *rsclp->tails[RCU_DONE_TAIL];\n\treturn NULL;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "77-80",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp)\n{\n\tif (rcu_segcblist_is_enabled(rsclp))\n\t\treturn *rsclp->tails[RCU_DONE_TAIL];\n\treturn NULL;\n}"
  },
  {
    "function_name": "rcu_segcblist_first_cb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "112-117",
    "snippet": "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp)\n{\n\tif (rcu_segcblist_is_enabled(rsclp))\n\t\treturn rsclp->head;\n\treturn NULL;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "77-80",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp)\n{\n\tif (rcu_segcblist_is_enabled(rsclp))\n\t\treturn rsclp->head;\n\treturn NULL;\n}"
  },
  {
    "function_name": "rcu_segcblist_pend_cbs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "102-106",
    "snippet": "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       !rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_restempty",
          "args": [
            "rsclp",
            "RCU_DONE_TAIL"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_restempty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "87-90",
          "snippet": "static inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !*rsclp->tails[seg];\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !*rsclp->tails[seg];\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "77-80",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       !rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL);\n}"
  },
  {
    "function_name": "rcu_segcblist_ready_cbs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "92-96",
    "snippet": "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       &rsclp->head != rsclp->tails[RCU_DONE_TAIL];\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "77-80",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn !!rsclp->tails[RCU_NEXT_TAIL];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       &rsclp->head != rsclp->tails[RCU_DONE_TAIL];\n}"
  },
  {
    "function_name": "rcu_segcblist_disable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "80-86",
    "snippet": "void rcu_segcblist_disable(struct rcu_segcblist *rsclp)\n{\n\tWARN_ON_ONCE(!rcu_segcblist_empty(rsclp));\n\tWARN_ON_ONCE(rcu_segcblist_n_cbs(rsclp));\n\tWARN_ON_ONCE(rcu_segcblist_n_lazy_cbs(rsclp));\n\trsclp->tails[RCU_NEXT_TAIL] = NULL;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "rcu_segcblist_n_lazy_cbs(rsclp)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_n_lazy_cbs",
          "args": [
            "rsclp"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_n_lazy_cbs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "62-65",
          "snippet": "static inline long rcu_segcblist_n_lazy_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rsclp->len_lazy;\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline long rcu_segcblist_n_lazy_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rsclp->len_lazy;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "rcu_segcblist_n_cbs(rsclp)"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_n_cbs",
          "args": [
            "rsclp"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_n_cbs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "56-59",
          "snippet": "static inline long rcu_segcblist_n_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn READ_ONCE(rsclp->len);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline long rcu_segcblist_n_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn READ_ONCE(rsclp->len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!rcu_segcblist_empty(rsclp)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_empty",
          "args": [
            "rsclp"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "50-53",
          "snippet": "static inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !rsclp->head;\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !rsclp->head;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp)\n{\n\tWARN_ON_ONCE(!rcu_segcblist_empty(rsclp));\n\tWARN_ON_ONCE(rcu_segcblist_n_cbs(rsclp));\n\tWARN_ON_ONCE(rcu_segcblist_n_lazy_cbs(rsclp));\n\trsclp->tails[RCU_NEXT_TAIL] = NULL;\n}"
  },
  {
    "function_name": "rcu_segcblist_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "63-74",
    "snippet": "void rcu_segcblist_init(struct rcu_segcblist *rsclp)\n{\n\tint i;\n\n\tBUILD_BUG_ON(RCU_NEXT_TAIL + 1 != ARRAY_SIZE(rsclp->gp_seq));\n\tBUILD_BUG_ON(ARRAY_SIZE(rsclp->tails) != ARRAY_SIZE(rsclp->gp_seq));\n\trsclp->head = NULL;\n\tfor (i = 0; i < RCU_CBLIST_NSEGS; i++)\n\t\trsclp->tails[i] = &rsclp->head;\n\trsclp->len = 0;\n\trsclp->len_lazy = 0;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "ARRAY_SIZE(rsclp->tails) != ARRAY_SIZE(rsclp->gp_seq)"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "rsclp->gp_seq"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "rsclp->tails"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "RCU_NEXT_TAIL + 1 != ARRAY_SIZE(rsclp->gp_seq)"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "rsclp->gp_seq"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp)\n{\n\tint i;\n\n\tBUILD_BUG_ON(RCU_NEXT_TAIL + 1 != ARRAY_SIZE(rsclp->gp_seq));\n\tBUILD_BUG_ON(ARRAY_SIZE(rsclp->tails) != ARRAY_SIZE(rsclp->gp_seq));\n\trsclp->head = NULL;\n\tfor (i = 0; i < RCU_CBLIST_NSEGS; i++)\n\t\trsclp->tails[i] = &rsclp->head;\n\trsclp->len = 0;\n\trsclp->len_lazy = 0;\n}"
  },
  {
    "function_name": "rcu_cblist_dequeue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "46-58",
    "snippet": "struct rcu_head *rcu_cblist_dequeue(struct rcu_cblist *rclp)\n{\n\tstruct rcu_head *rhp;\n\n\trhp = rclp->head;\n\tif (!rhp)\n\t\treturn NULL;\n\trclp->len--;\n\trclp->head = rhp->next;\n\tif (!rclp->head)\n\t\trclp->tail = &rclp->head;\n\treturn rhp;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstruct rcu_head *rcu_cblist_dequeue(struct rcu_cblist *rclp)\n{\n\tstruct rcu_head *rhp;\n\n\trhp = rclp->head;\n\tif (!rhp)\n\t\treturn NULL;\n\trclp->len--;\n\trclp->head = rhp->next;\n\tif (!rclp->head)\n\t\trclp->tail = &rclp->head;\n\treturn rhp;\n}"
  },
  {
    "function_name": "rcu_cblist_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "31-37",
    "snippet": "void rcu_cblist_init(struct rcu_cblist *rclp)\n{\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n\trclp->len = 0;\n\trclp->len_lazy = 0;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcupdate.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/kernel.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/rcupdate.h>\n#include <linux/interrupt.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_cblist_init(struct rcu_cblist *rclp)\n{\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n\trclp->len = 0;\n\trclp->len_lazy = 0;\n}"
  }
]