[
  {
    "function_name": "rwsem_clear_reader_owned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "131-133",
    "snippet": "static inline void rwsem_clear_reader_owned(struct rw_semaphore *sem)\n{\n}",
    "includes": [],
    "macros_used": [
      "#define rwsem_clear_reader_owned rwsem_clear_reader_owned"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#define rwsem_clear_reader_owned rwsem_clear_reader_owned\n\nstatic inline void rwsem_clear_reader_owned(struct rw_semaphore *sem)\n{\n}"
  },
  {
    "function_name": "rwsem_set_reader_owned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "125-127",
    "snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n}"
  },
  {
    "function_name": "__rwsem_set_reader_owned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "120-123",
    "snippet": "static inline void __rwsem_set_reader_owned(struct rw_semaphore *sem,\n\t\t\t\t\t   struct task_struct *owner)\n{\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void __rwsem_set_reader_owned(struct rw_semaphore *sem,\n\t\t\t\t\t   struct task_struct *owner)\n{\n}"
  },
  {
    "function_name": "rwsem_clear_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "116-118",
    "snippet": "static inline void rwsem_clear_owner(struct rw_semaphore *sem)\n{\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void rwsem_clear_owner(struct rw_semaphore *sem)\n{\n}"
  },
  {
    "function_name": "rwsem_set_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "112-114",
    "snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n}"
  },
  {
    "function_name": "rwsem_clear_reader_owned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "101-108",
    "snippet": "static inline void rwsem_clear_reader_owned(struct rw_semaphore *sem)\n{\n\tunsigned long val = (unsigned long)current | RWSEM_READER_OWNED\n\t\t\t\t\t\t   | RWSEM_ANONYMOUSLY_OWNED;\n\tif (READ_ONCE(sem->owner) == (struct task_struct *)val)\n\t\tcmpxchg_relaxed((unsigned long *)&sem->owner, val,\n\t\t\t\tRWSEM_READER_OWNED | RWSEM_ANONYMOUSLY_OWNED);\n}",
    "includes": [],
    "macros_used": [
      "#define rwsem_clear_reader_owned rwsem_clear_reader_owned",
      "#define RWSEM_ANONYMOUSLY_OWNED\t(1UL << 1)",
      "#define RWSEM_READER_OWNED\t(1UL << 0)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmpxchg_relaxed",
          "args": [
            "(unsigned long *)&sem->owner",
            "val",
            "RWSEM_READER_OWNED | RWSEM_ANONYMOUSLY_OWNED"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "sem->owner"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#define rwsem_clear_reader_owned rwsem_clear_reader_owned\n#define RWSEM_ANONYMOUSLY_OWNED\t(1UL << 1)\n#define RWSEM_READER_OWNED\t(1UL << 0)\n\nstatic inline void rwsem_clear_reader_owned(struct rw_semaphore *sem)\n{\n\tunsigned long val = (unsigned long)current | RWSEM_READER_OWNED\n\t\t\t\t\t\t   | RWSEM_ANONYMOUSLY_OWNED;\n\tif (READ_ONCE(sem->owner) == (struct task_struct *)val)\n\t\tcmpxchg_relaxed((unsigned long *)&sem->owner, val,\n\t\t\t\tRWSEM_READER_OWNED | RWSEM_ANONYMOUSLY_OWNED);\n}"
  },
  {
    "function_name": "rwsem_has_anonymous_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "88-91",
    "snippet": "static inline bool rwsem_has_anonymous_owner(struct task_struct *owner)\n{\n\treturn (unsigned long)owner & RWSEM_ANONYMOUSLY_OWNED;\n}",
    "includes": [],
    "macros_used": [
      "#define RWSEM_ANONYMOUSLY_OWNED\t(1UL << 1)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#define RWSEM_ANONYMOUSLY_OWNED\t(1UL << 1)\n\nstatic inline bool rwsem_has_anonymous_owner(struct task_struct *owner)\n{\n\treturn (unsigned long)owner & RWSEM_ANONYMOUSLY_OWNED;\n}"
  },
  {
    "function_name": "is_rwsem_owner_spinnable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "80-83",
    "snippet": "static inline bool is_rwsem_owner_spinnable(struct task_struct *owner)\n{\n\treturn !((unsigned long)owner & RWSEM_ANONYMOUSLY_OWNED);\n}",
    "includes": [],
    "macros_used": [
      "#define RWSEM_ANONYMOUSLY_OWNED\t(1UL << 1)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#define RWSEM_ANONYMOUSLY_OWNED\t(1UL << 1)\n\nstatic inline bool is_rwsem_owner_spinnable(struct task_struct *owner)\n{\n\treturn !((unsigned long)owner & RWSEM_ANONYMOUSLY_OWNED);\n}"
  },
  {
    "function_name": "rwsem_set_reader_owned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "70-73",
    "snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n\t__rwsem_set_reader_owned(sem, current);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__rwsem_set_reader_owned",
          "args": [
            "sem",
            "current"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "__rwsem_set_reader_owned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
          "lines": "120-123",
          "snippet": "static inline void __rwsem_set_reader_owned(struct rw_semaphore *sem,\n\t\t\t\t\t   struct task_struct *owner)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void __rwsem_set_reader_owned(struct rw_semaphore *sem,\n\t\t\t\t\t   struct task_struct *owner)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "static inline void rwsem_set_reader_owned(struct rw_semaphore *sem)\n{\n\t__rwsem_set_reader_owned(sem, current);\n}"
  },
  {
    "function_name": "__rwsem_set_reader_owned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "61-68",
    "snippet": "static inline void __rwsem_set_reader_owned(struct rw_semaphore *sem,\n\t\t\t\t\t    struct task_struct *owner)\n{\n\tunsigned long val = (unsigned long)owner | RWSEM_READER_OWNED\n\t\t\t\t\t\t | RWSEM_ANONYMOUSLY_OWNED;\n\n\tWRITE_ONCE(sem->owner, (struct task_struct *)val);\n}",
    "includes": [],
    "macros_used": [
      "#define RWSEM_ANONYMOUSLY_OWNED\t(1UL << 1)",
      "#define RWSEM_READER_OWNED\t(1UL << 0)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "sem->owner",
            "(struct task_struct *)val"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#define RWSEM_ANONYMOUSLY_OWNED\t(1UL << 1)\n#define RWSEM_READER_OWNED\t(1UL << 0)\n\nstatic inline void __rwsem_set_reader_owned(struct rw_semaphore *sem,\n\t\t\t\t\t    struct task_struct *owner)\n{\n\tunsigned long val = (unsigned long)owner | RWSEM_READER_OWNED\n\t\t\t\t\t\t | RWSEM_ANONYMOUSLY_OWNED;\n\n\tWRITE_ONCE(sem->owner, (struct task_struct *)val);\n}"
  },
  {
    "function_name": "rwsem_clear_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "48-51",
    "snippet": "static inline void rwsem_clear_owner(struct rw_semaphore *sem)\n{\n\tWRITE_ONCE(sem->owner, NULL);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "sem->owner",
            "NULL"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void rwsem_clear_owner(struct rw_semaphore *sem)\n{\n\tWRITE_ONCE(sem->owner, NULL);\n}"
  },
  {
    "function_name": "rwsem_set_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rwsem.h",
    "lines": "43-46",
    "snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n\tWRITE_ONCE(sem->owner, current);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "sem->owner",
            "current"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void rwsem_set_owner(struct rw_semaphore *sem)\n{\n\tWRITE_ONCE(sem->owner, current);\n}"
  }
]