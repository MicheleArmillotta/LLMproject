[
  {
    "function_name": "put_old_itimerspec32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "951-958",
    "snippet": "int put_old_itimerspec32(const struct itimerspec64 *its,\n\t\t\tstruct old_itimerspec32 __user *uits)\n{\n\tif (__put_old_timespec32(&its->it_interval, &uits->it_interval) ||\n\t    __put_old_timespec32(&its->it_value, &uits->it_value))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_old_timespec32",
          "args": [
            "&its->it_value",
            "&uits->it_value"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "__put_old_timespec32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "882-890",
          "snippet": "static int __put_old_timespec32(const struct timespec64 *ts64,\n\t\t\t\t   struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts = {\n\t\t.tv_sec = ts64->tv_sec,\n\t\t.tv_nsec = ts64->tv_nsec\n\t};\n\treturn copy_to_user(cts, &ts, sizeof(ts)) ? -EFAULT : 0;\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic int __put_old_timespec32(const struct timespec64 *ts64,\n\t\t\t\t   struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts = {\n\t\t.tv_sec = ts64->tv_sec,\n\t\t.tv_nsec = ts64->tv_nsec\n\t};\n\treturn copy_to_user(cts, &ts, sizeof(ts)) ? -EFAULT : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nint put_old_itimerspec32(const struct itimerspec64 *its,\n\t\t\tstruct old_itimerspec32 __user *uits)\n{\n\tif (__put_old_timespec32(&its->it_interval, &uits->it_interval) ||\n\t    __put_old_timespec32(&its->it_value, &uits->it_value))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "get_old_itimerspec32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "940-948",
    "snippet": "int get_old_itimerspec32(struct itimerspec64 *its,\n\t\t\tconst struct old_itimerspec32 __user *uits)\n{\n\n\tif (__get_old_timespec32(&its->it_interval, &uits->it_interval) ||\n\t    __get_old_timespec32(&its->it_value, &uits->it_value))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__get_old_timespec32",
          "args": [
            "&its->it_value",
            "&uits->it_value"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "__get_old_timespec32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "866-880",
          "snippet": "static int __get_old_timespec32(struct timespec64 *ts64,\n\t\t\t\t   const struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts;\n\tint ret;\n\n\tret = copy_from_user(&ts, cts, sizeof(ts));\n\tif (ret)\n\t\treturn -EFAULT;\n\n\tts64->tv_sec = ts.tv_sec;\n\tts64->tv_nsec = ts.tv_nsec;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic int __get_old_timespec32(struct timespec64 *ts64,\n\t\t\t\t   const struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts;\n\tint ret;\n\n\tret = copy_from_user(&ts, cts, sizeof(ts));\n\tif (ret)\n\t\treturn -EFAULT;\n\n\tts64->tv_sec = ts.tv_sec;\n\tts64->tv_nsec = ts.tv_nsec;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nint get_old_itimerspec32(struct itimerspec64 *its,\n\t\t\tconst struct old_itimerspec32 __user *uits)\n{\n\n\tif (__get_old_timespec32(&its->it_interval, &uits->it_interval) ||\n\t    __get_old_timespec32(&its->it_value, &uits->it_value))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "put_itimerspec64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "925-937",
    "snippet": "int put_itimerspec64(const struct itimerspec64 *it,\n\t\t\tstruct __kernel_itimerspec __user *uit)\n{\n\tint ret;\n\n\tret = put_timespec64(&it->it_interval, &uit->it_interval);\n\tif (ret)\n\t\treturn ret;\n\n\tret = put_timespec64(&it->it_value, &uit->it_value);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_timespec64",
          "args": [
            "&it->it_value",
            "&uit->it_value"
          ],
          "line": 934
        },
        "resolved": true,
        "details": {
          "function_name": "put_timespec64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "854-863",
          "snippet": "int put_timespec64(const struct timespec64 *ts,\n\t\t   struct __kernel_timespec __user *uts)\n{\n\tstruct __kernel_timespec kts = {\n\t\t.tv_sec = ts->tv_sec,\n\t\t.tv_nsec = ts->tv_nsec\n\t};\n\n\treturn copy_to_user(uts, &kts, sizeof(kts)) ? -EFAULT : 0;\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nint put_timespec64(const struct timespec64 *ts,\n\t\t   struct __kernel_timespec __user *uts)\n{\n\tstruct __kernel_timespec kts = {\n\t\t.tv_sec = ts->tv_sec,\n\t\t.tv_nsec = ts->tv_nsec\n\t};\n\n\treturn copy_to_user(uts, &kts, sizeof(kts)) ? -EFAULT : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nint put_itimerspec64(const struct itimerspec64 *it,\n\t\t\tstruct __kernel_itimerspec __user *uit)\n{\n\tint ret;\n\n\tret = put_timespec64(&it->it_interval, &uit->it_interval);\n\tif (ret)\n\t\treturn ret;\n\n\tret = put_timespec64(&it->it_value, &uit->it_value);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "get_itimerspec64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "910-922",
    "snippet": "int get_itimerspec64(struct itimerspec64 *it,\n\t\t\tconst struct __kernel_itimerspec __user *uit)\n{\n\tint ret;\n\n\tret = get_timespec64(&it->it_interval, &uit->it_interval);\n\tif (ret)\n\t\treturn ret;\n\n\tret = get_timespec64(&it->it_value, &uit->it_value);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_timespec64",
          "args": [
            "&it->it_value",
            "&uit->it_value"
          ],
          "line": 919
        },
        "resolved": true,
        "details": {
          "function_name": "get_timespec64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "832-851",
          "snippet": "int get_timespec64(struct timespec64 *ts,\n\t\t   const struct __kernel_timespec __user *uts)\n{\n\tstruct __kernel_timespec kts;\n\tint ret;\n\n\tret = copy_from_user(&kts, uts, sizeof(kts));\n\tif (ret)\n\t\treturn -EFAULT;\n\n\tts->tv_sec = kts.tv_sec;\n\n\t/* Zero out the padding for 32 bit systems or in compat mode */\n\tif (IS_ENABLED(CONFIG_64BIT_TIME) && in_compat_syscall())\n\t\tkts.tv_nsec &= 0xFFFFFFFFUL;\n\n\tts->tv_nsec = kts.tv_nsec;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nint get_timespec64(struct timespec64 *ts,\n\t\t   const struct __kernel_timespec __user *uts)\n{\n\tstruct __kernel_timespec kts;\n\tint ret;\n\n\tret = copy_from_user(&kts, uts, sizeof(kts));\n\tif (ret)\n\t\treturn -EFAULT;\n\n\tts->tv_sec = kts.tv_sec;\n\n\t/* Zero out the padding for 32 bit systems or in compat mode */\n\tif (IS_ENABLED(CONFIG_64BIT_TIME) && in_compat_syscall())\n\t\tkts.tv_nsec &= 0xFFFFFFFFUL;\n\n\tts->tv_nsec = kts.tv_nsec;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nint get_itimerspec64(struct itimerspec64 *it,\n\t\t\tconst struct __kernel_itimerspec __user *uit)\n{\n\tint ret;\n\n\tret = get_timespec64(&it->it_interval, &uit->it_interval);\n\tif (ret)\n\t\treturn ret;\n\n\tret = get_timespec64(&it->it_value, &uit->it_value);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "put_old_timespec32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "901-907",
    "snippet": "int put_old_timespec32(const struct timespec64 *ts, void __user *uts)\n{\n\tif (COMPAT_USE_64BIT_TIME)\n\t\treturn copy_to_user(uts, ts, sizeof(*ts)) ? -EFAULT : 0;\n\telse\n\t\treturn __put_old_timespec32(ts, uts);\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__put_old_timespec32",
          "args": [
            "ts",
            "uts"
          ],
          "line": 906
        },
        "resolved": true,
        "details": {
          "function_name": "__put_old_timespec32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "882-890",
          "snippet": "static int __put_old_timespec32(const struct timespec64 *ts64,\n\t\t\t\t   struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts = {\n\t\t.tv_sec = ts64->tv_sec,\n\t\t.tv_nsec = ts64->tv_nsec\n\t};\n\treturn copy_to_user(cts, &ts, sizeof(ts)) ? -EFAULT : 0;\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic int __put_old_timespec32(const struct timespec64 *ts64,\n\t\t\t\t   struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts = {\n\t\t.tv_sec = ts64->tv_sec,\n\t\t.tv_nsec = ts64->tv_nsec\n\t};\n\treturn copy_to_user(cts, &ts, sizeof(ts)) ? -EFAULT : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "uts",
            "ts",
            "sizeof(*ts)"
          ],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_prog_array_copy_to_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/core.c",
          "lines": "1639-1669",
          "snippet": "int bpf_prog_array_copy_to_user(struct bpf_prog_array __rcu *array,\n\t\t\t\t__u32 __user *prog_ids, u32 cnt)\n{\n\tunsigned long err = 0;\n\tbool nospc;\n\tu32 *ids;\n\n\t/* users of this function are doing:\n\t * cnt = bpf_prog_array_length();\n\t * if (cnt > 0)\n\t *     bpf_prog_array_copy_to_user(..., cnt);\n\t * so below kcalloc doesn't need extra cnt > 0 check, but\n\t * bpf_prog_array_length() releases rcu lock and\n\t * prog array could have been swapped with empty or larger array,\n\t * so always copy 'cnt' prog_ids to the user.\n\t * In a rare race the user will see zero prog_ids\n\t */\n\tids = kcalloc(cnt, sizeof(u32), GFP_USER | __GFP_NOWARN);\n\tif (!ids)\n\t\treturn -ENOMEM;\n\trcu_read_lock();\n\tnospc = bpf_prog_array_copy_core(array, ids, cnt);\n\trcu_read_unlock();\n\terr = copy_to_user(prog_ids, ids, cnt * sizeof(u32));\n\tkfree(ids);\n\tif (err)\n\t\treturn -EFAULT;\n\tif (nospc)\n\t\treturn -ENOSPC;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/rbtree_latch.h>",
            "#include <linux/frame.h>",
            "#include <linux/bpf.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/random.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/filter.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <asm/unaligned.h>\n#include <linux/perf_event.h>\n#include <linux/rcupdate.h>\n#include <linux/kallsyms.h>\n#include <linux/rbtree_latch.h>\n#include <linux/frame.h>\n#include <linux/bpf.h>\n#include <linux/moduleloader.h>\n#include <linux/random.h>\n#include <linux/vmalloc.h>\n#include <linux/skbuff.h>\n#include <linux/filter.h>\n\nint bpf_prog_array_copy_to_user(struct bpf_prog_array __rcu *array,\n\t\t\t\t__u32 __user *prog_ids, u32 cnt)\n{\n\tunsigned long err = 0;\n\tbool nospc;\n\tu32 *ids;\n\n\t/* users of this function are doing:\n\t * cnt = bpf_prog_array_length();\n\t * if (cnt > 0)\n\t *     bpf_prog_array_copy_to_user(..., cnt);\n\t * so below kcalloc doesn't need extra cnt > 0 check, but\n\t * bpf_prog_array_length() releases rcu lock and\n\t * prog array could have been swapped with empty or larger array,\n\t * so always copy 'cnt' prog_ids to the user.\n\t * In a rare race the user will see zero prog_ids\n\t */\n\tids = kcalloc(cnt, sizeof(u32), GFP_USER | __GFP_NOWARN);\n\tif (!ids)\n\t\treturn -ENOMEM;\n\trcu_read_lock();\n\tnospc = bpf_prog_array_copy_core(array, ids, cnt);\n\trcu_read_unlock();\n\terr = copy_to_user(prog_ids, ids, cnt * sizeof(u32));\n\tkfree(ids);\n\tif (err)\n\t\treturn -EFAULT;\n\tif (nospc)\n\t\treturn -ENOSPC;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nint put_old_timespec32(const struct timespec64 *ts, void __user *uts)\n{\n\tif (COMPAT_USE_64BIT_TIME)\n\t\treturn copy_to_user(uts, ts, sizeof(*ts)) ? -EFAULT : 0;\n\telse\n\t\treturn __put_old_timespec32(ts, uts);\n}"
  },
  {
    "function_name": "get_old_timespec32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "892-898",
    "snippet": "int get_old_timespec32(struct timespec64 *ts, const void __user *uts)\n{\n\tif (COMPAT_USE_64BIT_TIME)\n\t\treturn copy_from_user(ts, uts, sizeof(*ts)) ? -EFAULT : 0;\n\telse\n\t\treturn __get_old_timespec32(ts, uts);\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__get_old_timespec32",
          "args": [
            "ts",
            "uts"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "__get_old_timespec32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "866-880",
          "snippet": "static int __get_old_timespec32(struct timespec64 *ts64,\n\t\t\t\t   const struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts;\n\tint ret;\n\n\tret = copy_from_user(&ts, cts, sizeof(ts));\n\tif (ret)\n\t\treturn -EFAULT;\n\n\tts64->tv_sec = ts.tv_sec;\n\tts64->tv_nsec = ts.tv_nsec;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic int __get_old_timespec32(struct timespec64 *ts64,\n\t\t\t\t   const struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts;\n\tint ret;\n\n\tret = copy_from_user(&ts, cts, sizeof(ts));\n\tif (ret)\n\t\treturn -EFAULT;\n\n\tts64->tv_sec = ts.tv_sec;\n\tts64->tv_nsec = ts.tv_nsec;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "ts",
            "uts",
            "sizeof(*ts)"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nint get_old_timespec32(struct timespec64 *ts, const void __user *uts)\n{\n\tif (COMPAT_USE_64BIT_TIME)\n\t\treturn copy_from_user(ts, uts, sizeof(*ts)) ? -EFAULT : 0;\n\telse\n\t\treturn __get_old_timespec32(ts, uts);\n}"
  },
  {
    "function_name": "__put_old_timespec32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "882-890",
    "snippet": "static int __put_old_timespec32(const struct timespec64 *ts64,\n\t\t\t\t   struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts = {\n\t\t.tv_sec = ts64->tv_sec,\n\t\t.tv_nsec = ts64->tv_nsec\n\t};\n\treturn copy_to_user(cts, &ts, sizeof(ts)) ? -EFAULT : 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "cts",
            "&ts",
            "sizeof(ts)"
          ],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_prog_array_copy_to_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/core.c",
          "lines": "1639-1669",
          "snippet": "int bpf_prog_array_copy_to_user(struct bpf_prog_array __rcu *array,\n\t\t\t\t__u32 __user *prog_ids, u32 cnt)\n{\n\tunsigned long err = 0;\n\tbool nospc;\n\tu32 *ids;\n\n\t/* users of this function are doing:\n\t * cnt = bpf_prog_array_length();\n\t * if (cnt > 0)\n\t *     bpf_prog_array_copy_to_user(..., cnt);\n\t * so below kcalloc doesn't need extra cnt > 0 check, but\n\t * bpf_prog_array_length() releases rcu lock and\n\t * prog array could have been swapped with empty or larger array,\n\t * so always copy 'cnt' prog_ids to the user.\n\t * In a rare race the user will see zero prog_ids\n\t */\n\tids = kcalloc(cnt, sizeof(u32), GFP_USER | __GFP_NOWARN);\n\tif (!ids)\n\t\treturn -ENOMEM;\n\trcu_read_lock();\n\tnospc = bpf_prog_array_copy_core(array, ids, cnt);\n\trcu_read_unlock();\n\terr = copy_to_user(prog_ids, ids, cnt * sizeof(u32));\n\tkfree(ids);\n\tif (err)\n\t\treturn -EFAULT;\n\tif (nospc)\n\t\treturn -ENOSPC;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/rbtree_latch.h>",
            "#include <linux/frame.h>",
            "#include <linux/bpf.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/random.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/filter.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <asm/unaligned.h>\n#include <linux/perf_event.h>\n#include <linux/rcupdate.h>\n#include <linux/kallsyms.h>\n#include <linux/rbtree_latch.h>\n#include <linux/frame.h>\n#include <linux/bpf.h>\n#include <linux/moduleloader.h>\n#include <linux/random.h>\n#include <linux/vmalloc.h>\n#include <linux/skbuff.h>\n#include <linux/filter.h>\n\nint bpf_prog_array_copy_to_user(struct bpf_prog_array __rcu *array,\n\t\t\t\t__u32 __user *prog_ids, u32 cnt)\n{\n\tunsigned long err = 0;\n\tbool nospc;\n\tu32 *ids;\n\n\t/* users of this function are doing:\n\t * cnt = bpf_prog_array_length();\n\t * if (cnt > 0)\n\t *     bpf_prog_array_copy_to_user(..., cnt);\n\t * so below kcalloc doesn't need extra cnt > 0 check, but\n\t * bpf_prog_array_length() releases rcu lock and\n\t * prog array could have been swapped with empty or larger array,\n\t * so always copy 'cnt' prog_ids to the user.\n\t * In a rare race the user will see zero prog_ids\n\t */\n\tids = kcalloc(cnt, sizeof(u32), GFP_USER | __GFP_NOWARN);\n\tif (!ids)\n\t\treturn -ENOMEM;\n\trcu_read_lock();\n\tnospc = bpf_prog_array_copy_core(array, ids, cnt);\n\trcu_read_unlock();\n\terr = copy_to_user(prog_ids, ids, cnt * sizeof(u32));\n\tkfree(ids);\n\tif (err)\n\t\treturn -EFAULT;\n\tif (nospc)\n\t\treturn -ENOSPC;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic int __put_old_timespec32(const struct timespec64 *ts64,\n\t\t\t\t   struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts = {\n\t\t.tv_sec = ts64->tv_sec,\n\t\t.tv_nsec = ts64->tv_nsec\n\t};\n\treturn copy_to_user(cts, &ts, sizeof(ts)) ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "__get_old_timespec32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "866-880",
    "snippet": "static int __get_old_timespec32(struct timespec64 *ts64,\n\t\t\t\t   const struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts;\n\tint ret;\n\n\tret = copy_from_user(&ts, cts, sizeof(ts));\n\tif (ret)\n\t\treturn -EFAULT;\n\n\tts64->tv_sec = ts.tv_sec;\n\tts64->tv_nsec = ts.tv_nsec;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&ts",
            "cts",
            "sizeof(ts)"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic int __get_old_timespec32(struct timespec64 *ts64,\n\t\t\t\t   const struct old_timespec32 __user *cts)\n{\n\tstruct old_timespec32 ts;\n\tint ret;\n\n\tret = copy_from_user(&ts, cts, sizeof(ts));\n\tif (ret)\n\t\treturn -EFAULT;\n\n\tts64->tv_sec = ts.tv_sec;\n\tts64->tv_nsec = ts.tv_nsec;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "put_timespec64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "854-863",
    "snippet": "int put_timespec64(const struct timespec64 *ts,\n\t\t   struct __kernel_timespec __user *uts)\n{\n\tstruct __kernel_timespec kts = {\n\t\t.tv_sec = ts->tv_sec,\n\t\t.tv_nsec = ts->tv_nsec\n\t};\n\n\treturn copy_to_user(uts, &kts, sizeof(kts)) ? -EFAULT : 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "uts",
            "&kts",
            "sizeof(kts)"
          ],
          "line": 862
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_prog_array_copy_to_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/bpf/core.c",
          "lines": "1639-1669",
          "snippet": "int bpf_prog_array_copy_to_user(struct bpf_prog_array __rcu *array,\n\t\t\t\t__u32 __user *prog_ids, u32 cnt)\n{\n\tunsigned long err = 0;\n\tbool nospc;\n\tu32 *ids;\n\n\t/* users of this function are doing:\n\t * cnt = bpf_prog_array_length();\n\t * if (cnt > 0)\n\t *     bpf_prog_array_copy_to_user(..., cnt);\n\t * so below kcalloc doesn't need extra cnt > 0 check, but\n\t * bpf_prog_array_length() releases rcu lock and\n\t * prog array could have been swapped with empty or larger array,\n\t * so always copy 'cnt' prog_ids to the user.\n\t * In a rare race the user will see zero prog_ids\n\t */\n\tids = kcalloc(cnt, sizeof(u32), GFP_USER | __GFP_NOWARN);\n\tif (!ids)\n\t\treturn -ENOMEM;\n\trcu_read_lock();\n\tnospc = bpf_prog_array_copy_core(array, ids, cnt);\n\trcu_read_unlock();\n\terr = copy_to_user(prog_ids, ids, cnt * sizeof(u32));\n\tkfree(ids);\n\tif (err)\n\t\treturn -EFAULT;\n\tif (nospc)\n\t\treturn -ENOSPC;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <asm/unaligned.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/rbtree_latch.h>",
            "#include <linux/frame.h>",
            "#include <linux/bpf.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/random.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/filter.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <asm/unaligned.h>\n#include <linux/perf_event.h>\n#include <linux/rcupdate.h>\n#include <linux/kallsyms.h>\n#include <linux/rbtree_latch.h>\n#include <linux/frame.h>\n#include <linux/bpf.h>\n#include <linux/moduleloader.h>\n#include <linux/random.h>\n#include <linux/vmalloc.h>\n#include <linux/skbuff.h>\n#include <linux/filter.h>\n\nint bpf_prog_array_copy_to_user(struct bpf_prog_array __rcu *array,\n\t\t\t\t__u32 __user *prog_ids, u32 cnt)\n{\n\tunsigned long err = 0;\n\tbool nospc;\n\tu32 *ids;\n\n\t/* users of this function are doing:\n\t * cnt = bpf_prog_array_length();\n\t * if (cnt > 0)\n\t *     bpf_prog_array_copy_to_user(..., cnt);\n\t * so below kcalloc doesn't need extra cnt > 0 check, but\n\t * bpf_prog_array_length() releases rcu lock and\n\t * prog array could have been swapped with empty or larger array,\n\t * so always copy 'cnt' prog_ids to the user.\n\t * In a rare race the user will see zero prog_ids\n\t */\n\tids = kcalloc(cnt, sizeof(u32), GFP_USER | __GFP_NOWARN);\n\tif (!ids)\n\t\treturn -ENOMEM;\n\trcu_read_lock();\n\tnospc = bpf_prog_array_copy_core(array, ids, cnt);\n\trcu_read_unlock();\n\terr = copy_to_user(prog_ids, ids, cnt * sizeof(u32));\n\tkfree(ids);\n\tif (err)\n\t\treturn -EFAULT;\n\tif (nospc)\n\t\treturn -ENOSPC;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nint put_timespec64(const struct timespec64 *ts,\n\t\t   struct __kernel_timespec __user *uts)\n{\n\tstruct __kernel_timespec kts = {\n\t\t.tv_sec = ts->tv_sec,\n\t\t.tv_nsec = ts->tv_nsec\n\t};\n\n\treturn copy_to_user(uts, &kts, sizeof(kts)) ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "get_timespec64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "832-851",
    "snippet": "int get_timespec64(struct timespec64 *ts,\n\t\t   const struct __kernel_timespec __user *uts)\n{\n\tstruct __kernel_timespec kts;\n\tint ret;\n\n\tret = copy_from_user(&kts, uts, sizeof(kts));\n\tif (ret)\n\t\treturn -EFAULT;\n\n\tts->tv_sec = kts.tv_sec;\n\n\t/* Zero out the padding for 32 bit systems or in compat mode */\n\tif (IS_ENABLED(CONFIG_64BIT_TIME) && in_compat_syscall())\n\t\tkts.tv_nsec &= 0xFFFFFFFFUL;\n\n\tts->tv_nsec = kts.tv_nsec;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_compat_syscall",
          "args": [],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_64BIT_TIME"
          ],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&kts",
            "uts",
            "sizeof(kts)"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nint get_timespec64(struct timespec64 *ts,\n\t\t   const struct __kernel_timespec __user *uts)\n{\n\tstruct __kernel_timespec kts;\n\tint ret;\n\n\tret = copy_from_user(&kts, uts, sizeof(kts));\n\tif (ret)\n\t\treturn -EFAULT;\n\n\tts->tv_sec = kts.tv_sec;\n\n\t/* Zero out the padding for 32 bit systems or in compat mode */\n\tif (IS_ENABLED(CONFIG_64BIT_TIME) && in_compat_syscall())\n\t\tkts.tv_nsec &= 0xFFFFFFFFUL;\n\n\tts->tv_nsec = kts.tv_nsec;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "timespec64_add_safe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "816-830",
    "snippet": "struct timespec64 timespec64_add_safe(const struct timespec64 lhs,\n\t\t\t\tconst struct timespec64 rhs)\n{\n\tstruct timespec64 res;\n\n\tset_normalized_timespec64(&res, (timeu64_t) lhs.tv_sec + rhs.tv_sec,\n\t\t\tlhs.tv_nsec + rhs.tv_nsec);\n\n\tif (unlikely(res.tv_sec < lhs.tv_sec || res.tv_sec < rhs.tv_sec)) {\n\t\tres.tv_sec = TIME64_MAX;\n\t\tres.tv_nsec = 0;\n\t}\n\n\treturn res;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "res.tv_sec < lhs.tv_sec || res.tv_sec < rhs.tv_sec"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_normalized_timespec64",
          "args": [
            "&res",
            "(timeu64_t) lhs.tv_sec + rhs.tv_sec",
            "lhs.tv_nsec + rhs.tv_nsec"
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "set_normalized_timespec64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "494-513",
          "snippet": "void set_normalized_timespec64(struct timespec64 *ts, time64_t sec, s64 nsec)\n{\n\twhile (nsec >= NSEC_PER_SEC) {\n\t\t/*\n\t\t * The following asm() prevents the compiler from\n\t\t * optimising this loop into a modulo operation. See\n\t\t * also __iter_div_u64_rem() in include/linux/time.h\n\t\t */\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec -= NSEC_PER_SEC;\n\t\t++sec;\n\t}\n\twhile (nsec < 0) {\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec += NSEC_PER_SEC;\n\t\t--sec;\n\t}\n\tts->tv_sec = sec;\n\tts->tv_nsec = nsec;\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nvoid set_normalized_timespec64(struct timespec64 *ts, time64_t sec, s64 nsec)\n{\n\twhile (nsec >= NSEC_PER_SEC) {\n\t\t/*\n\t\t * The following asm() prevents the compiler from\n\t\t * optimising this loop into a modulo operation. See\n\t\t * also __iter_div_u64_rem() in include/linux/time.h\n\t\t */\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec -= NSEC_PER_SEC;\n\t\t++sec;\n\t}\n\twhile (nsec < 0) {\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec += NSEC_PER_SEC;\n\t\t--sec;\n\t}\n\tts->tv_sec = sec;\n\tts->tv_nsec = nsec;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstruct timespec64 timespec64_add_safe(const struct timespec64 lhs,\n\t\t\t\tconst struct timespec64 rhs)\n{\n\tstruct timespec64 res;\n\n\tset_normalized_timespec64(&res, (timeu64_t) lhs.tv_sec + rhs.tv_sec,\n\t\t\tlhs.tv_nsec + rhs.tv_nsec);\n\n\tif (unlikely(res.tv_sec < lhs.tv_sec || res.tv_sec < rhs.tv_sec)) {\n\t\tres.tv_sec = TIME64_MAX;\n\t\tres.tv_nsec = 0;\n\t}\n\n\treturn res;\n}"
  },
  {
    "function_name": "nsecs_to_jiffies",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "805-808",
    "snippet": "unsigned long nsecs_to_jiffies(u64 n)\n{\n\treturn (unsigned long)nsecs_to_jiffies64(n);\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nsecs_to_jiffies64",
          "args": [
            "n"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "nsecs_to_jiffies64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "774-789",
          "snippet": "u64 nsecs_to_jiffies64(u64 n)\n{\n#if (NSEC_PER_SEC % HZ) == 0\n\t/* Common case, HZ = 100, 128, 200, 250, 256, 500, 512, 1000 etc. */\n\treturn div_u64(n, NSEC_PER_SEC / HZ);\n#elif (HZ % 512) == 0\n\t/* overflow after 292 years if HZ = 1024 */\n\treturn div_u64(n * HZ / 512, NSEC_PER_SEC / 512);\n#else\n\t/*\n\t * Generic case - optimized for cases where HZ is a multiple of 3.\n\t * overflow after 64.99 years, exact for HZ = 60, 72, 90, 120 etc.\n\t */\n\treturn div_u64(n * 9, (9ull * NSEC_PER_SEC + HZ / 2) / HZ);\n#endif\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nu64 nsecs_to_jiffies64(u64 n)\n{\n#if (NSEC_PER_SEC % HZ) == 0\n\t/* Common case, HZ = 100, 128, 200, 250, 256, 500, 512, 1000 etc. */\n\treturn div_u64(n, NSEC_PER_SEC / HZ);\n#elif (HZ % 512) == 0\n\t/* overflow after 292 years if HZ = 1024 */\n\treturn div_u64(n * HZ / 512, NSEC_PER_SEC / 512);\n#else\n\t/*\n\t * Generic case - optimized for cases where HZ is a multiple of 3.\n\t * overflow after 64.99 years, exact for HZ = 60, 72, 90, 120 etc.\n\t */\n\treturn div_u64(n * 9, (9ull * NSEC_PER_SEC + HZ / 2) / HZ);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned long nsecs_to_jiffies(u64 n)\n{\n\treturn (unsigned long)nsecs_to_jiffies64(n);\n}"
  },
  {
    "function_name": "nsecs_to_jiffies64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "774-789",
    "snippet": "u64 nsecs_to_jiffies64(u64 n)\n{\n#if (NSEC_PER_SEC % HZ) == 0\n\t/* Common case, HZ = 100, 128, 200, 250, 256, 500, 512, 1000 etc. */\n\treturn div_u64(n, NSEC_PER_SEC / HZ);\n#elif (HZ % 512) == 0\n\t/* overflow after 292 years if HZ = 1024 */\n\treturn div_u64(n * HZ / 512, NSEC_PER_SEC / 512);\n#else\n\t/*\n\t * Generic case - optimized for cases where HZ is a multiple of 3.\n\t * overflow after 64.99 years, exact for HZ = 60, 72, 90, 120 etc.\n\t */\n\treturn div_u64(n * 9, (9ull * NSEC_PER_SEC + HZ / 2) / HZ);\n#endif\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "n * 9",
            "(9ull * NSEC_PER_SEC + HZ / 2) / HZ"
          ],
          "line": 787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "n * HZ / 512",
            "NSEC_PER_SEC / 512"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "n",
            "NSEC_PER_SEC / HZ"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nu64 nsecs_to_jiffies64(u64 n)\n{\n#if (NSEC_PER_SEC % HZ) == 0\n\t/* Common case, HZ = 100, 128, 200, 250, 256, 500, 512, 1000 etc. */\n\treturn div_u64(n, NSEC_PER_SEC / HZ);\n#elif (HZ % 512) == 0\n\t/* overflow after 292 years if HZ = 1024 */\n\treturn div_u64(n * HZ / 512, NSEC_PER_SEC / 512);\n#else\n\t/*\n\t * Generic case - optimized for cases where HZ is a multiple of 3.\n\t * overflow after 64.99 years, exact for HZ = 60, 72, 90, 120 etc.\n\t */\n\treturn div_u64(n * 9, (9ull * NSEC_PER_SEC + HZ / 2) / HZ);\n#endif\n}"
  },
  {
    "function_name": "jiffies64_to_nsecs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "751-758",
    "snippet": "u64 jiffies64_to_nsecs(u64 j)\n{\n#if !(NSEC_PER_SEC % HZ)\n\treturn (NSEC_PER_SEC / HZ) * j;\n# else\n\treturn div_u64(j * HZ_TO_NSEC_NUM, HZ_TO_NSEC_DEN);\n#endif\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "j * HZ_TO_NSEC_NUM",
            "HZ_TO_NSEC_DEN"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nu64 jiffies64_to_nsecs(u64 j)\n{\n#if !(NSEC_PER_SEC % HZ)\n\treturn (NSEC_PER_SEC / HZ) * j;\n# else\n\treturn div_u64(j * HZ_TO_NSEC_NUM, HZ_TO_NSEC_DEN);\n#endif\n}"
  },
  {
    "function_name": "nsec_to_clock_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "735-749",
    "snippet": "u64 nsec_to_clock_t(u64 x)\n{\n#if (NSEC_PER_SEC % USER_HZ) == 0\n\treturn div_u64(x, NSEC_PER_SEC / USER_HZ);\n#elif (USER_HZ % 512) == 0\n\treturn div_u64(x * USER_HZ / 512, NSEC_PER_SEC / 512);\n#else\n\t/*\n         * max relative error 5.7e-8 (1.8s per year) for USER_HZ <= 1024,\n         * overflow after 64.99 years.\n         * exact for HZ=60, 72, 90, 120, 144, 180, 300, 600, 900, ...\n         */\n\treturn div_u64(x * 9, (9ull * NSEC_PER_SEC + (USER_HZ / 2)) / USER_HZ);\n#endif\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "x * 9",
            "(9ull * NSEC_PER_SEC + (USER_HZ / 2)) / USER_HZ"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "x * USER_HZ / 512",
            "NSEC_PER_SEC / 512"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "x",
            "NSEC_PER_SEC / USER_HZ"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nu64 nsec_to_clock_t(u64 x)\n{\n#if (NSEC_PER_SEC % USER_HZ) == 0\n\treturn div_u64(x, NSEC_PER_SEC / USER_HZ);\n#elif (USER_HZ % 512) == 0\n\treturn div_u64(x * USER_HZ / 512, NSEC_PER_SEC / 512);\n#else\n\t/*\n         * max relative error 5.7e-8 (1.8s per year) for USER_HZ <= 1024,\n         * overflow after 64.99 years.\n         * exact for HZ=60, 72, 90, 120, 144, 180, 300, 600, 900, ...\n         */\n\treturn div_u64(x * 9, (9ull * NSEC_PER_SEC + (USER_HZ / 2)) / USER_HZ);\n#endif\n}"
  },
  {
    "function_name": "jiffies_64_to_clock_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "713-732",
    "snippet": "u64 jiffies_64_to_clock_t(u64 x)\n{\n#if (TICK_NSEC % (NSEC_PER_SEC / USER_HZ)) == 0\n# if HZ < USER_HZ\n\tx = div_u64(x * USER_HZ, HZ);\n# elif HZ > USER_HZ\n\tx = div_u64(x, HZ / USER_HZ);\n# else\n\t/* Nothing to do */\n# endif\n#else\n\t/*\n\t * There are better ways that don't overflow early,\n\t * but even this doesn't overflow in hundreds of years\n\t * in 64 bits, so..\n\t */\n\tx = div_u64(x * TICK_NSEC, (NSEC_PER_SEC / USER_HZ));\n#endif\n\treturn x;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "x * TICK_NSEC",
            "(NSEC_PER_SEC / USER_HZ)"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "x",
            "HZ / USER_HZ"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "x * USER_HZ",
            "HZ"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nu64 jiffies_64_to_clock_t(u64 x)\n{\n#if (TICK_NSEC % (NSEC_PER_SEC / USER_HZ)) == 0\n# if HZ < USER_HZ\n\tx = div_u64(x * USER_HZ, HZ);\n# elif HZ > USER_HZ\n\tx = div_u64(x, HZ / USER_HZ);\n# else\n\t/* Nothing to do */\n# endif\n#else\n\t/*\n\t * There are better ways that don't overflow early,\n\t * but even this doesn't overflow in hundreds of years\n\t * in 64 bits, so..\n\t */\n\tx = div_u64(x * TICK_NSEC, (NSEC_PER_SEC / USER_HZ));\n#endif\n\treturn x;\n}"
  },
  {
    "function_name": "clock_t_to_jiffies",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "696-710",
    "snippet": "unsigned long clock_t_to_jiffies(unsigned long x)\n{\n#if (HZ % USER_HZ)==0\n\tif (x >= ~0UL / (HZ / USER_HZ))\n\t\treturn ~0UL;\n\treturn x * (HZ / USER_HZ);\n#else\n\t/* Don't worry about loss of precision here .. */\n\tif (x >= ~0UL / HZ * USER_HZ)\n\t\treturn ~0UL;\n\n\t/* .. but do try to contain it here */\n\treturn div_u64((u64)x * HZ, USER_HZ);\n#endif\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "(u64)x * HZ",
            "USER_HZ"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned long clock_t_to_jiffies(unsigned long x)\n{\n#if (HZ % USER_HZ)==0\n\tif (x >= ~0UL / (HZ / USER_HZ))\n\t\treturn ~0UL;\n\treturn x * (HZ / USER_HZ);\n#else\n\t/* Don't worry about loss of precision here .. */\n\tif (x >= ~0UL / HZ * USER_HZ)\n\t\treturn ~0UL;\n\n\t/* .. but do try to contain it here */\n\treturn div_u64((u64)x * HZ, USER_HZ);\n#endif\n}"
  },
  {
    "function_name": "jiffies_to_clock_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "682-693",
    "snippet": "clock_t jiffies_to_clock_t(unsigned long x)\n{\n#if (TICK_NSEC % (NSEC_PER_SEC / USER_HZ)) == 0\n# if HZ < USER_HZ\n\treturn x * (USER_HZ / HZ);\n# else\n\treturn x / (HZ / USER_HZ);\n# endif\n#else\n\treturn div_u64((u64)x * TICK_NSEC, NSEC_PER_SEC / USER_HZ);\n#endif\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "div_u64",
          "args": [
            "(u64)x * TICK_NSEC",
            "NSEC_PER_SEC / USER_HZ"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nclock_t jiffies_to_clock_t(unsigned long x)\n{\n#if (TICK_NSEC % (NSEC_PER_SEC / USER_HZ)) == 0\n# if HZ < USER_HZ\n\treturn x * (USER_HZ / HZ);\n# else\n\treturn x / (HZ / USER_HZ);\n# endif\n#else\n\treturn div_u64((u64)x * TICK_NSEC, NSEC_PER_SEC / USER_HZ);\n#endif\n}"
  },
  {
    "function_name": "jiffies_to_timeval",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "665-676",
    "snippet": "void jiffies_to_timeval(const unsigned long jiffies, struct timeval *value)\n{\n\t/*\n\t * Convert jiffies to nanoseconds and separate with\n\t * one divide.\n\t */\n\tu32 rem;\n\n\tvalue->tv_sec = div_u64_rem((u64)jiffies * TICK_NSEC,\n\t\t\t\t    NSEC_PER_SEC, &rem);\n\tvalue->tv_usec = rem / NSEC_PER_USEC;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "div_u64_rem",
          "args": [
            "(u64)jiffies * TICK_NSEC",
            "NSEC_PER_SEC",
            "&rem"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nvoid jiffies_to_timeval(const unsigned long jiffies, struct timeval *value)\n{\n\t/*\n\t * Convert jiffies to nanoseconds and separate with\n\t * one divide.\n\t */\n\tu32 rem;\n\n\tvalue->tv_sec = div_u64_rem((u64)jiffies * TICK_NSEC,\n\t\t\t\t    NSEC_PER_SEC, &rem);\n\tvalue->tv_usec = rem / NSEC_PER_USEC;\n}"
  },
  {
    "function_name": "timeval_to_jiffies",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "657-662",
    "snippet": "unsigned long\ntimeval_to_jiffies(const struct timeval *value)\n{\n\treturn __timespec_to_jiffies(value->tv_sec,\n\t\t\t\t     value->tv_usec * NSEC_PER_USEC);\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__timespec_to_jiffies",
          "args": [
            "value->tv_sec",
            "value->tv_usec * NSEC_PER_USEC"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "__timespec_to_jiffies",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "614-618",
          "snippet": "static unsigned long\n__timespec_to_jiffies(unsigned long sec, long nsec)\n{\n\treturn __timespec64_to_jiffies((u64)sec, nsec);\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic unsigned long\n__timespec_to_jiffies(unsigned long sec, long nsec)\n{\n\treturn __timespec64_to_jiffies((u64)sec, nsec);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned long\ntimeval_to_jiffies(const struct timeval *value)\n{\n\treturn __timespec_to_jiffies(value->tv_sec,\n\t\t\t\t     value->tv_usec * NSEC_PER_USEC);\n}"
  },
  {
    "function_name": "jiffies_to_timespec64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "627-638",
    "snippet": "void\njiffies_to_timespec64(const unsigned long jiffies, struct timespec64 *value)\n{\n\t/*\n\t * Convert jiffies to nanoseconds and separate with\n\t * one divide.\n\t */\n\tu32 rem;\n\tvalue->tv_sec = div_u64_rem((u64)jiffies * TICK_NSEC,\n\t\t\t\t    NSEC_PER_SEC, &rem);\n\tvalue->tv_nsec = rem;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "div_u64_rem",
          "args": [
            "(u64)jiffies * TICK_NSEC",
            "NSEC_PER_SEC",
            "&rem"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nvoid\njiffies_to_timespec64(const unsigned long jiffies, struct timespec64 *value)\n{\n\t/*\n\t * Convert jiffies to nanoseconds and separate with\n\t * one divide.\n\t */\n\tu32 rem;\n\tvalue->tv_sec = div_u64_rem((u64)jiffies * TICK_NSEC,\n\t\t\t\t    NSEC_PER_SEC, &rem);\n\tvalue->tv_nsec = rem;\n}"
  },
  {
    "function_name": "timespec64_to_jiffies",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "620-624",
    "snippet": "unsigned long\ntimespec64_to_jiffies(const struct timespec64 *value)\n{\n\treturn __timespec64_to_jiffies(value->tv_sec, value->tv_nsec);\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__timespec64_to_jiffies",
          "args": [
            "value->tv_sec",
            "value->tv_nsec"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "__timespec64_to_jiffies",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "599-612",
          "snippet": "static unsigned long\n__timespec64_to_jiffies(u64 sec, long nsec)\n{\n\tnsec = nsec + TICK_NSEC - 1;\n\n\tif (sec >= MAX_SEC_IN_JIFFIES){\n\t\tsec = MAX_SEC_IN_JIFFIES;\n\t\tnsec = 0;\n\t}\n\treturn ((sec * SEC_CONVERSION) +\n\t\t(((u64)nsec * NSEC_CONVERSION) >>\n\t\t (NSEC_JIFFIE_SC - SEC_JIFFIE_SC))) >> SEC_JIFFIE_SC;\n\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic unsigned long\n__timespec64_to_jiffies(u64 sec, long nsec)\n{\n\tnsec = nsec + TICK_NSEC - 1;\n\n\tif (sec >= MAX_SEC_IN_JIFFIES){\n\t\tsec = MAX_SEC_IN_JIFFIES;\n\t\tnsec = 0;\n\t}\n\treturn ((sec * SEC_CONVERSION) +\n\t\t(((u64)nsec * NSEC_CONVERSION) >>\n\t\t (NSEC_JIFFIE_SC - SEC_JIFFIE_SC))) >> SEC_JIFFIE_SC;\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned long\ntimespec64_to_jiffies(const struct timespec64 *value)\n{\n\treturn __timespec64_to_jiffies(value->tv_sec, value->tv_nsec);\n}"
  },
  {
    "function_name": "__timespec_to_jiffies",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "614-618",
    "snippet": "static unsigned long\n__timespec_to_jiffies(unsigned long sec, long nsec)\n{\n\treturn __timespec64_to_jiffies((u64)sec, nsec);\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__timespec64_to_jiffies",
          "args": [
            "(u64)sec",
            "nsec"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "__timespec64_to_jiffies",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "599-612",
          "snippet": "static unsigned long\n__timespec64_to_jiffies(u64 sec, long nsec)\n{\n\tnsec = nsec + TICK_NSEC - 1;\n\n\tif (sec >= MAX_SEC_IN_JIFFIES){\n\t\tsec = MAX_SEC_IN_JIFFIES;\n\t\tnsec = 0;\n\t}\n\treturn ((sec * SEC_CONVERSION) +\n\t\t(((u64)nsec * NSEC_CONVERSION) >>\n\t\t (NSEC_JIFFIE_SC - SEC_JIFFIE_SC))) >> SEC_JIFFIE_SC;\n\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic unsigned long\n__timespec64_to_jiffies(u64 sec, long nsec)\n{\n\tnsec = nsec + TICK_NSEC - 1;\n\n\tif (sec >= MAX_SEC_IN_JIFFIES){\n\t\tsec = MAX_SEC_IN_JIFFIES;\n\t\tnsec = 0;\n\t}\n\treturn ((sec * SEC_CONVERSION) +\n\t\t(((u64)nsec * NSEC_CONVERSION) >>\n\t\t (NSEC_JIFFIE_SC - SEC_JIFFIE_SC))) >> SEC_JIFFIE_SC;\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic unsigned long\n__timespec_to_jiffies(unsigned long sec, long nsec)\n{\n\treturn __timespec64_to_jiffies((u64)sec, nsec);\n}"
  },
  {
    "function_name": "__timespec64_to_jiffies",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "599-612",
    "snippet": "static unsigned long\n__timespec64_to_jiffies(u64 sec, long nsec)\n{\n\tnsec = nsec + TICK_NSEC - 1;\n\n\tif (sec >= MAX_SEC_IN_JIFFIES){\n\t\tsec = MAX_SEC_IN_JIFFIES;\n\t\tnsec = 0;\n\t}\n\treturn ((sec * SEC_CONVERSION) +\n\t\t(((u64)nsec * NSEC_CONVERSION) >>\n\t\t (NSEC_JIFFIE_SC - SEC_JIFFIE_SC))) >> SEC_JIFFIE_SC;\n\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstatic unsigned long\n__timespec64_to_jiffies(u64 sec, long nsec)\n{\n\tnsec = nsec + TICK_NSEC - 1;\n\n\tif (sec >= MAX_SEC_IN_JIFFIES){\n\t\tsec = MAX_SEC_IN_JIFFIES;\n\t\tnsec = 0;\n\t}\n\treturn ((sec * SEC_CONVERSION) +\n\t\t(((u64)nsec * NSEC_CONVERSION) >>\n\t\t (NSEC_JIFFIE_SC - SEC_JIFFIE_SC))) >> SEC_JIFFIE_SC;\n\n}"
  },
  {
    "function_name": "__usecs_to_jiffies",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "576-581",
    "snippet": "unsigned long __usecs_to_jiffies(const unsigned int u)\n{\n\tif (u > jiffies_to_usecs(MAX_JIFFY_OFFSET))\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _usecs_to_jiffies(u);\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_usecs_to_jiffies",
          "args": [
            "u"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "__usecs_to_jiffies",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "576-581",
          "snippet": "unsigned long __usecs_to_jiffies(const unsigned int u)\n{\n\tif (u > jiffies_to_usecs(MAX_JIFFY_OFFSET))\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _usecs_to_jiffies(u);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "jiffies_to_usecs",
          "args": [
            "MAX_JIFFY_OFFSET"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "jiffies_to_usecs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "328-345",
          "snippet": "unsigned int jiffies_to_usecs(const unsigned long j)\n{\n\t/*\n\t * Hz usually doesn't go much further MSEC_PER_SEC.\n\t * jiffies_to_usecs() and usecs_to_jiffies() depend on that.\n\t */\n\tBUILD_BUG_ON(HZ > USEC_PER_SEC);\n\n#if !(USEC_PER_SEC % HZ)\n\treturn (USEC_PER_SEC / HZ) * j;\n#else\n# if BITS_PER_LONG == 32\n\treturn (HZ_TO_USEC_MUL32 * j) >> HZ_TO_USEC_SHR32;\n# else\n\treturn (j * HZ_TO_USEC_NUM) / HZ_TO_USEC_DEN;\n# endif\n#endif\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned int jiffies_to_usecs(const unsigned long j)\n{\n\t/*\n\t * Hz usually doesn't go much further MSEC_PER_SEC.\n\t * jiffies_to_usecs() and usecs_to_jiffies() depend on that.\n\t */\n\tBUILD_BUG_ON(HZ > USEC_PER_SEC);\n\n#if !(USEC_PER_SEC % HZ)\n\treturn (USEC_PER_SEC / HZ) * j;\n#else\n# if BITS_PER_LONG == 32\n\treturn (HZ_TO_USEC_MUL32 * j) >> HZ_TO_USEC_SHR32;\n# else\n\treturn (j * HZ_TO_USEC_NUM) / HZ_TO_USEC_DEN;\n# endif\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned long __usecs_to_jiffies(const unsigned int u)\n{\n\tif (u > jiffies_to_usecs(MAX_JIFFY_OFFSET))\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _usecs_to_jiffies(u);\n}"
  },
  {
    "function_name": "__msecs_to_jiffies",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "565-573",
    "snippet": "unsigned long __msecs_to_jiffies(const unsigned int m)\n{\n\t/*\n\t * Negative value, means infinite timeout:\n\t */\n\tif ((int)m < 0)\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _msecs_to_jiffies(m);\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_msecs_to_jiffies",
          "args": [
            "m"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "__msecs_to_jiffies",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "565-573",
          "snippet": "unsigned long __msecs_to_jiffies(const unsigned int m)\n{\n\t/*\n\t * Negative value, means infinite timeout:\n\t */\n\tif ((int)m < 0)\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _msecs_to_jiffies(m);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned long __msecs_to_jiffies(const unsigned int m)\n{\n\t/*\n\t * Negative value, means infinite timeout:\n\t */\n\tif ((int)m < 0)\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _msecs_to_jiffies(m);\n}"
  },
  {
    "function_name": "ns_to_timespec64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "522-538",
    "snippet": "struct timespec64 ns_to_timespec64(const s64 nsec)\n{\n\tstruct timespec64 ts;\n\ts32 rem;\n\n\tif (!nsec)\n\t\treturn (struct timespec64) {0, 0};\n\n\tts.tv_sec = div_s64_rem(nsec, NSEC_PER_SEC, &rem);\n\tif (unlikely(rem < 0)) {\n\t\tts.tv_sec--;\n\t\trem += NSEC_PER_SEC;\n\t}\n\tts.tv_nsec = rem;\n\n\treturn ts;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "rem < 0"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_s64_rem",
          "args": [
            "nsec",
            "NSEC_PER_SEC",
            "&rem"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstruct timespec64 ns_to_timespec64(const s64 nsec)\n{\n\tstruct timespec64 ts;\n\ts32 rem;\n\n\tif (!nsec)\n\t\treturn (struct timespec64) {0, 0};\n\n\tts.tv_sec = div_s64_rem(nsec, NSEC_PER_SEC, &rem);\n\tif (unlikely(rem < 0)) {\n\t\tts.tv_sec--;\n\t\trem += NSEC_PER_SEC;\n\t}\n\tts.tv_nsec = rem;\n\n\treturn ts;\n}"
  },
  {
    "function_name": "set_normalized_timespec64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "494-513",
    "snippet": "void set_normalized_timespec64(struct timespec64 *ts, time64_t sec, s64 nsec)\n{\n\twhile (nsec >= NSEC_PER_SEC) {\n\t\t/*\n\t\t * The following asm() prevents the compiler from\n\t\t * optimising this loop into a modulo operation. See\n\t\t * also __iter_div_u64_rem() in include/linux/time.h\n\t\t */\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec -= NSEC_PER_SEC;\n\t\t++sec;\n\t}\n\twhile (nsec < 0) {\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec += NSEC_PER_SEC;\n\t\t--sec;\n\t}\n\tts->tv_sec = sec;\n\tts->tv_nsec = nsec;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nvoid set_normalized_timespec64(struct timespec64 *ts, time64_t sec, s64 nsec)\n{\n\twhile (nsec >= NSEC_PER_SEC) {\n\t\t/*\n\t\t * The following asm() prevents the compiler from\n\t\t * optimising this loop into a modulo operation. See\n\t\t * also __iter_div_u64_rem() in include/linux/time.h\n\t\t */\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec -= NSEC_PER_SEC;\n\t\t++sec;\n\t}\n\twhile (nsec < 0) {\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec += NSEC_PER_SEC;\n\t\t--sec;\n\t}\n\tts->tv_sec = sec;\n\tts->tv_nsec = nsec;\n}"
  },
  {
    "function_name": "ns_to_kernel_old_timeval",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "468-477",
    "snippet": "struct __kernel_old_timeval ns_to_kernel_old_timeval(const s64 nsec)\n{\n\tstruct timespec64 ts = ns_to_timespec64(nsec);\n\tstruct __kernel_old_timeval tv;\n\n\ttv.tv_sec = ts.tv_sec;\n\ttv.tv_usec = (suseconds_t)ts.tv_nsec / 1000;\n\n\treturn tv;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ns_to_timespec64",
          "args": [
            "nsec"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "ns_to_timespec64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "522-538",
          "snippet": "struct timespec64 ns_to_timespec64(const s64 nsec)\n{\n\tstruct timespec64 ts;\n\ts32 rem;\n\n\tif (!nsec)\n\t\treturn (struct timespec64) {0, 0};\n\n\tts.tv_sec = div_s64_rem(nsec, NSEC_PER_SEC, &rem);\n\tif (unlikely(rem < 0)) {\n\t\tts.tv_sec--;\n\t\trem += NSEC_PER_SEC;\n\t}\n\tts.tv_nsec = rem;\n\n\treturn ts;\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstruct timespec64 ns_to_timespec64(const s64 nsec)\n{\n\tstruct timespec64 ts;\n\ts32 rem;\n\n\tif (!nsec)\n\t\treturn (struct timespec64) {0, 0};\n\n\tts.tv_sec = div_s64_rem(nsec, NSEC_PER_SEC, &rem);\n\tif (unlikely(rem < 0)) {\n\t\tts.tv_sec--;\n\t\trem += NSEC_PER_SEC;\n\t}\n\tts.tv_nsec = rem;\n\n\treturn ts;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstruct __kernel_old_timeval ns_to_kernel_old_timeval(const s64 nsec)\n{\n\tstruct timespec64 ts = ns_to_timespec64(nsec);\n\tstruct __kernel_old_timeval tv;\n\n\ttv.tv_sec = ts.tv_sec;\n\ttv.tv_usec = (suseconds_t)ts.tv_nsec / 1000;\n\n\treturn tv;\n}"
  },
  {
    "function_name": "ns_to_timeval",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "456-465",
    "snippet": "struct timeval ns_to_timeval(const s64 nsec)\n{\n\tstruct timespec ts = ns_to_timespec(nsec);\n\tstruct timeval tv;\n\n\ttv.tv_sec = ts.tv_sec;\n\ttv.tv_usec = (suseconds_t) ts.tv_nsec / 1000;\n\n\treturn tv;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ns_to_timespec",
          "args": [
            "nsec"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "ns_to_timespec64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
          "lines": "522-538",
          "snippet": "struct timespec64 ns_to_timespec64(const s64 nsec)\n{\n\tstruct timespec64 ts;\n\ts32 rem;\n\n\tif (!nsec)\n\t\treturn (struct timespec64) {0, 0};\n\n\tts.tv_sec = div_s64_rem(nsec, NSEC_PER_SEC, &rem);\n\tif (unlikely(rem < 0)) {\n\t\tts.tv_sec--;\n\t\trem += NSEC_PER_SEC;\n\t}\n\tts.tv_nsec = rem;\n\n\treturn ts;\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstruct timespec64 ns_to_timespec64(const s64 nsec)\n{\n\tstruct timespec64 ts;\n\ts32 rem;\n\n\tif (!nsec)\n\t\treturn (struct timespec64) {0, 0};\n\n\tts.tv_sec = div_s64_rem(nsec, NSEC_PER_SEC, &rem);\n\tif (unlikely(rem < 0)) {\n\t\tts.tv_sec--;\n\t\trem += NSEC_PER_SEC;\n\t}\n\tts.tv_nsec = rem;\n\n\treturn ts;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstruct timeval ns_to_timeval(const s64 nsec)\n{\n\tstruct timespec ts = ns_to_timespec(nsec);\n\tstruct timeval tv;\n\n\ttv.tv_sec = ts.tv_sec;\n\ttv.tv_usec = (suseconds_t) ts.tv_nsec / 1000;\n\n\treturn tv;\n}"
  },
  {
    "function_name": "ns_to_timespec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "431-447",
    "snippet": "struct timespec ns_to_timespec(const s64 nsec)\n{\n\tstruct timespec ts;\n\ts32 rem;\n\n\tif (!nsec)\n\t\treturn (struct timespec) {0, 0};\n\n\tts.tv_sec = div_s64_rem(nsec, NSEC_PER_SEC, &rem);\n\tif (unlikely(rem < 0)) {\n\t\tts.tv_sec--;\n\t\trem += NSEC_PER_SEC;\n\t}\n\tts.tv_nsec = rem;\n\n\treturn ts;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "rem < 0"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "div_s64_rem",
          "args": [
            "nsec",
            "NSEC_PER_SEC",
            "&rem"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstruct timespec ns_to_timespec(const s64 nsec)\n{\n\tstruct timespec ts;\n\ts32 rem;\n\n\tif (!nsec)\n\t\treturn (struct timespec) {0, 0};\n\n\tts.tv_sec = div_s64_rem(nsec, NSEC_PER_SEC, &rem);\n\tif (unlikely(rem < 0)) {\n\t\tts.tv_sec--;\n\t\trem += NSEC_PER_SEC;\n\t}\n\tts.tv_nsec = rem;\n\n\treturn ts;\n}"
  },
  {
    "function_name": "set_normalized_timespec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "403-422",
    "snippet": "void set_normalized_timespec(struct timespec *ts, time_t sec, s64 nsec)\n{\n\twhile (nsec >= NSEC_PER_SEC) {\n\t\t/*\n\t\t * The following asm() prevents the compiler from\n\t\t * optimising this loop into a modulo operation. See\n\t\t * also __iter_div_u64_rem() in include/linux/time.h\n\t\t */\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec -= NSEC_PER_SEC;\n\t\t++sec;\n\t}\n\twhile (nsec < 0) {\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec += NSEC_PER_SEC;\n\t\t--sec;\n\t}\n\tts->tv_sec = sec;\n\tts->tv_nsec = nsec;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nvoid set_normalized_timespec(struct timespec *ts, time_t sec, s64 nsec)\n{\n\twhile (nsec >= NSEC_PER_SEC) {\n\t\t/*\n\t\t * The following asm() prevents the compiler from\n\t\t * optimising this loop into a modulo operation. See\n\t\t * also __iter_div_u64_rem() in include/linux/time.h\n\t\t */\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec -= NSEC_PER_SEC;\n\t\t++sec;\n\t}\n\twhile (nsec < 0) {\n\t\tasm(\"\" : \"+rm\"(nsec));\n\t\tnsec += NSEC_PER_SEC;\n\t\t--sec;\n\t}\n\tts->tv_sec = sec;\n\tts->tv_nsec = nsec;\n}"
  },
  {
    "function_name": "mktime64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "368-386",
    "snippet": "time64_t mktime64(const unsigned int year0, const unsigned int mon0,\n\t\tconst unsigned int day, const unsigned int hour,\n\t\tconst unsigned int min, const unsigned int sec)\n{\n\tunsigned int mon = mon0, year = year0;\n\n\t/* 1..12 -> 11,12,1..10 */\n\tif (0 >= (int) (mon -= 2)) {\n\t\tmon += 12;\t/* Puts Feb last since it has leap day */\n\t\tyear -= 1;\n\t}\n\n\treturn ((((time64_t)\n\t\t  (year/4 - year/100 + year/400 + 367*mon/12 + day) +\n\t\t  year*365 - 719499\n\t    )*24 + hour /* now have hours - midnight tomorrow handled here */\n\t  )*60 + min /* now have minutes */\n\t)*60 + sec; /* finally seconds */\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "year/4 - year/100 + year/400 + 367*mon/12 + day"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\ntime64_t mktime64(const unsigned int year0, const unsigned int mon0,\n\t\tconst unsigned int day, const unsigned int hour,\n\t\tconst unsigned int min, const unsigned int sec)\n{\n\tunsigned int mon = mon0, year = year0;\n\n\t/* 1..12 -> 11,12,1..10 */\n\tif (0 >= (int) (mon -= 2)) {\n\t\tmon += 12;\t/* Puts Feb last since it has leap day */\n\t\tyear -= 1;\n\t}\n\n\treturn ((((time64_t)\n\t\t  (year/4 - year/100 + year/400 + 367*mon/12 + day) +\n\t\t  year*365 - 719499\n\t    )*24 + hour /* now have hours - midnight tomorrow handled here */\n\t  )*60 + min /* now have minutes */\n\t)*60 + sec; /* finally seconds */\n}"
  },
  {
    "function_name": "jiffies_to_usecs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "328-345",
    "snippet": "unsigned int jiffies_to_usecs(const unsigned long j)\n{\n\t/*\n\t * Hz usually doesn't go much further MSEC_PER_SEC.\n\t * jiffies_to_usecs() and usecs_to_jiffies() depend on that.\n\t */\n\tBUILD_BUG_ON(HZ > USEC_PER_SEC);\n\n#if !(USEC_PER_SEC % HZ)\n\treturn (USEC_PER_SEC / HZ) * j;\n#else\n# if BITS_PER_LONG == 32\n\treturn (HZ_TO_USEC_MUL32 * j) >> HZ_TO_USEC_SHR32;\n# else\n\treturn (j * HZ_TO_USEC_NUM) / HZ_TO_USEC_DEN;\n# endif\n#endif\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "HZ > USEC_PER_SEC"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned int jiffies_to_usecs(const unsigned long j)\n{\n\t/*\n\t * Hz usually doesn't go much further MSEC_PER_SEC.\n\t * jiffies_to_usecs() and usecs_to_jiffies() depend on that.\n\t */\n\tBUILD_BUG_ON(HZ > USEC_PER_SEC);\n\n#if !(USEC_PER_SEC % HZ)\n\treturn (USEC_PER_SEC / HZ) * j;\n#else\n# if BITS_PER_LONG == 32\n\treturn (HZ_TO_USEC_MUL32 * j) >> HZ_TO_USEC_SHR32;\n# else\n\treturn (j * HZ_TO_USEC_NUM) / HZ_TO_USEC_DEN;\n# endif\n#endif\n}"
  },
  {
    "function_name": "jiffies_to_msecs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "311-325",
    "snippet": "unsigned int jiffies_to_msecs(const unsigned long j)\n{\n#if HZ <= MSEC_PER_SEC && !(MSEC_PER_SEC % HZ)\n\treturn (MSEC_PER_SEC / HZ) * j;\n#elif HZ > MSEC_PER_SEC && !(HZ % MSEC_PER_SEC)\n\treturn (j + (HZ / MSEC_PER_SEC) - 1)/(HZ / MSEC_PER_SEC);\n#else\n# if BITS_PER_LONG == 32\n\treturn (HZ_TO_MSEC_MUL32 * j + (1ULL << HZ_TO_MSEC_SHR32) - 1) >>\n\t       HZ_TO_MSEC_SHR32;\n# else\n\treturn DIV_ROUND_UP(j * HZ_TO_MSEC_NUM, HZ_TO_MSEC_DEN);\n# endif\n#endif\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "j * HZ_TO_MSEC_NUM",
            "HZ_TO_MSEC_DEN"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned int jiffies_to_msecs(const unsigned long j)\n{\n#if HZ <= MSEC_PER_SEC && !(MSEC_PER_SEC % HZ)\n\treturn (MSEC_PER_SEC / HZ) * j;\n#elif HZ > MSEC_PER_SEC && !(HZ % MSEC_PER_SEC)\n\treturn (j + (HZ / MSEC_PER_SEC) - 1)/(HZ / MSEC_PER_SEC);\n#else\n# if BITS_PER_LONG == 32\n\treturn (HZ_TO_MSEC_MUL32 * j + (1ULL << HZ_TO_MSEC_SHR32) - 1) >>\n\t       HZ_TO_MSEC_SHR32;\n# else\n\treturn DIV_ROUND_UP(j * HZ_TO_MSEC_NUM, HZ_TO_MSEC_DEN);\n# endif\n#endif\n}"
  },
  {
    "function_name": "do_sys_settimeofday64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "172-200",
    "snippet": "int do_sys_settimeofday64(const struct timespec64 *tv, const struct timezone *tz)\n{\n\tstatic int firsttime = 1;\n\tint error = 0;\n\n\tif (tv && !timespec64_valid(tv))\n\t\treturn -EINVAL;\n\n\terror = security_settime64(tv, tz);\n\tif (error)\n\t\treturn error;\n\n\tif (tz) {\n\t\t/* Verify we're witin the +-15 hrs range */\n\t\tif (tz->tz_minuteswest > 15*60 || tz->tz_minuteswest < -15*60)\n\t\t\treturn -EINVAL;\n\n\t\tsys_tz = *tz;\n\t\tupdate_vsyscall_tz();\n\t\tif (firsttime) {\n\t\t\tfirsttime = 0;\n\t\t\tif (!tv)\n\t\t\t\ttimekeeping_warp_clock();\n\t\t}\n\t}\n\tif (tv)\n\t\treturn do_settimeofday64(tv);\n\treturn 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct timezone sys_tz;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_settimeofday64",
          "args": [
            "tv"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "do_settimeofday64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timekeeping.c",
          "lines": "1220-1257",
          "snippet": "int do_settimeofday64(const struct timespec64 *ts)\n{\n\tstruct timekeeper *tk = &tk_core.timekeeper;\n\tstruct timespec64 ts_delta, xt;\n\tunsigned long flags;\n\tint ret = 0;\n\n\tif (!timespec64_valid_strict(ts))\n\t\treturn -EINVAL;\n\n\traw_spin_lock_irqsave(&timekeeper_lock, flags);\n\twrite_seqcount_begin(&tk_core.seq);\n\n\ttimekeeping_forward_now(tk);\n\n\txt = tk_xtime(tk);\n\tts_delta.tv_sec = ts->tv_sec - xt.tv_sec;\n\tts_delta.tv_nsec = ts->tv_nsec - xt.tv_nsec;\n\n\tif (timespec64_compare(&tk->wall_to_monotonic, &ts_delta) > 0) {\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\ttk_set_wall_to_mono(tk, timespec64_sub(tk->wall_to_monotonic, ts_delta));\n\n\ttk_set_xtime(tk, ts);\nout:\n\ttimekeeping_update(tk, TK_CLEAR_NTP | TK_MIRROR | TK_CLOCK_WAS_SET);\n\n\twrite_seqcount_end(&tk_core.seq);\n\traw_spin_unlock_irqrestore(&timekeeper_lock, flags);\n\n\t/* signal hrtimers about time change */\n\tclock_was_set();\n\n\treturn ret;\n}",
          "includes": [
            "#include \"timekeeping_internal.h\"",
            "#include \"ntp_internal.h\"",
            "#include \"tick-internal.h\"",
            "#include <linux/compiler.h>",
            "#include <linux/pvclock_gtod.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/tick.h>",
            "#include <linux/time.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/timekeeper_internal.h>"
          ],
          "macros_used": [
            "#define TK_CLOCK_WAS_SET\t(1 << 2)",
            "#define TK_MIRROR\t\t(1 << 1)",
            "#define TK_CLEAR_NTP\t\t(1 << 0)"
          ],
          "globals_used": [
            "static DEFINE_RAW_SPINLOCK(timekeeper_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping_internal.h\"\n#include \"ntp_internal.h\"\n#include \"tick-internal.h\"\n#include <linux/compiler.h>\n#include <linux/pvclock_gtod.h>\n#include <linux/stop_machine.h>\n#include <linux/tick.h>\n#include <linux/time.h>\n#include <linux/jiffies.h>\n#include <linux/clocksource.h>\n#include <linux/syscore_ops.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched.h>\n#include <linux/nmi.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/timekeeper_internal.h>\n\n#define TK_CLOCK_WAS_SET\t(1 << 2)\n#define TK_MIRROR\t\t(1 << 1)\n#define TK_CLEAR_NTP\t\t(1 << 0)\n\nstatic DEFINE_RAW_SPINLOCK(timekeeper_lock);\n\nint do_settimeofday64(const struct timespec64 *ts)\n{\n\tstruct timekeeper *tk = &tk_core.timekeeper;\n\tstruct timespec64 ts_delta, xt;\n\tunsigned long flags;\n\tint ret = 0;\n\n\tif (!timespec64_valid_strict(ts))\n\t\treturn -EINVAL;\n\n\traw_spin_lock_irqsave(&timekeeper_lock, flags);\n\twrite_seqcount_begin(&tk_core.seq);\n\n\ttimekeeping_forward_now(tk);\n\n\txt = tk_xtime(tk);\n\tts_delta.tv_sec = ts->tv_sec - xt.tv_sec;\n\tts_delta.tv_nsec = ts->tv_nsec - xt.tv_nsec;\n\n\tif (timespec64_compare(&tk->wall_to_monotonic, &ts_delta) > 0) {\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\ttk_set_wall_to_mono(tk, timespec64_sub(tk->wall_to_monotonic, ts_delta));\n\n\ttk_set_xtime(tk, ts);\nout:\n\ttimekeeping_update(tk, TK_CLEAR_NTP | TK_MIRROR | TK_CLOCK_WAS_SET);\n\n\twrite_seqcount_end(&tk_core.seq);\n\traw_spin_unlock_irqrestore(&timekeeper_lock, flags);\n\n\t/* signal hrtimers about time change */\n\tclock_was_set();\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "timekeeping_warp_clock",
          "args": [],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "timekeeping_warp_clock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timekeeping.c",
          "lines": "1326-1336",
          "snippet": "void timekeeping_warp_clock(void)\n{\n\tif (sys_tz.tz_minuteswest != 0) {\n\t\tstruct timespec64 adjust;\n\n\t\tpersistent_clock_is_local = 1;\n\t\tadjust.tv_sec = sys_tz.tz_minuteswest * 60;\n\t\tadjust.tv_nsec = 0;\n\t\ttimekeeping_inject_offset(&adjust);\n\t}\n}",
          "includes": [
            "#include \"timekeeping_internal.h\"",
            "#include \"ntp_internal.h\"",
            "#include \"tick-internal.h\"",
            "#include <linux/compiler.h>",
            "#include <linux/pvclock_gtod.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/tick.h>",
            "#include <linux/time.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/timekeeper_internal.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int persistent_clock_is_local;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping_internal.h\"\n#include \"ntp_internal.h\"\n#include \"tick-internal.h\"\n#include <linux/compiler.h>\n#include <linux/pvclock_gtod.h>\n#include <linux/stop_machine.h>\n#include <linux/tick.h>\n#include <linux/time.h>\n#include <linux/jiffies.h>\n#include <linux/clocksource.h>\n#include <linux/syscore_ops.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched.h>\n#include <linux/nmi.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/timekeeper_internal.h>\n\nint persistent_clock_is_local;\n\nvoid timekeeping_warp_clock(void)\n{\n\tif (sys_tz.tz_minuteswest != 0) {\n\t\tstruct timespec64 adjust;\n\n\t\tpersistent_clock_is_local = 1;\n\t\tadjust.tv_sec = sys_tz.tz_minuteswest * 60;\n\t\tadjust.tv_nsec = 0;\n\t\ttimekeeping_inject_offset(&adjust);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "update_vsyscall_tz",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_settime64",
          "args": [
            "tv",
            "tz"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec64_valid",
          "args": [
            "tv"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstruct timezone sys_tz;\n\nint do_sys_settimeofday64(const struct timespec64 *tv, const struct timezone *tz)\n{\n\tstatic int firsttime = 1;\n\tint error = 0;\n\n\tif (tv && !timespec64_valid(tv))\n\t\treturn -EINVAL;\n\n\terror = security_settime64(tv, tz);\n\tif (error)\n\t\treturn error;\n\n\tif (tz) {\n\t\t/* Verify we're witin the +-15 hrs range */\n\t\tif (tz->tz_minuteswest > 15*60 || tz->tz_minuteswest < -15*60)\n\t\t\treturn -EINVAL;\n\n\t\tsys_tz = *tz;\n\t\tupdate_vsyscall_tz();\n\t\tif (firsttime) {\n\t\t\tfirsttime = 0;\n\t\t\tif (!tv)\n\t\t\t\ttimekeeping_warp_clock();\n\t\t}\n\t}\n\tif (tv)\n\t\treturn do_settimeofday64(tv);\n\treturn 0;\n}"
  },
  {
    "function_name": "time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "65-75",
    "snippet": "SYSCALL_DEFINE1(time, time_t __user *, tloc)\n{\n\ttime_t i = (time_t)ktime_get_real_seconds();\n\n\tif (tloc) {\n\t\tif (put_user(i,tloc))\n\t\t\treturn -EFAULT;\n\t}\n\tforce_successful_syscall_return();\n\treturn i;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(time, time_t __user *, tloc)\n{\n\ttime_t i = (time_t)ktime_get_real_seconds();\n\n\tif (tloc) {\n\t\tif (put_user(i,tloc))\n\t\t\treturn -EFAULT;\n\t}\n\tforce_successful_syscall_return();\n\treturn i;\n}"
  },
  {
    "function_name": "stime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "84-100",
    "snippet": "SYSCALL_DEFINE1(stime, time_t __user *, tptr)\n{\n\tstruct timespec64 tv;\n\tint err;\n\n\tif (get_user(tv.tv_sec, tptr))\n\t\treturn -EFAULT;\n\n\ttv.tv_nsec = 0;\n\n\terr = security_settime64(&tv, NULL);\n\tif (err)\n\t\treturn err;\n\n\tdo_settimeofday64(&tv);\n\treturn 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(stime, time_t __user *, tptr)\n{\n\tstruct timespec64 tv;\n\tint err;\n\n\tif (get_user(tv.tv_sec, tptr))\n\t\treturn -EFAULT;\n\n\ttv.tv_nsec = 0;\n\n\terr = security_settime64(&tv, NULL);\n\tif (err)\n\t\treturn err;\n\n\tdo_settimeofday64(&tv);\n\treturn 0;\n}"
  },
  {
    "function_name": "time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "108-120",
    "snippet": "SYSCALL_DEFINE1(time, old_time32_t __user *, tloc)\n{\n\told_time32_t i;\n\n\ti = (old_time32_t)ktime_get_real_seconds();\n\n\tif (tloc) {\n\t\tif (put_user(i,tloc))\n\t\t\treturn -EFAULT;\n\t}\n\tforce_successful_syscall_return();\n\treturn i;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(time, old_time32_t __user *, tloc)\n{\n\told_time32_t i;\n\n\ti = (old_time32_t)ktime_get_real_seconds();\n\n\tif (tloc) {\n\t\tif (put_user(i,tloc))\n\t\t\treturn -EFAULT;\n\t}\n\tforce_successful_syscall_return();\n\treturn i;\n}"
  },
  {
    "function_name": "stime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "122-138",
    "snippet": "SYSCALL_DEFINE1(stime, old_time32_t __user *, tptr)\n{\n\tstruct timespec64 tv;\n\tint err;\n\n\tif (get_user(tv.tv_sec, tptr))\n\t\treturn -EFAULT;\n\n\ttv.tv_nsec = 0;\n\n\terr = security_settime64(&tv, NULL);\n\tif (err)\n\t\treturn err;\n\n\tdo_settimeofday64(&tv);\n\treturn 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(stime, old_time32_t __user *, tptr)\n{\n\tstruct timespec64 tv;\n\tint err;\n\n\tif (get_user(tv.tv_sec, tptr))\n\t\treturn -EFAULT;\n\n\ttv.tv_nsec = 0;\n\n\terr = security_settime64(&tv, NULL);\n\tif (err)\n\t\treturn err;\n\n\tdo_settimeofday64(&tv);\n\treturn 0;\n}"
  },
  {
    "function_name": "gettimeofday",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "143-159",
    "snippet": "SYSCALL_DEFINE2(gettimeofday, struct timeval __user *, tv,\n\t\tstruct timezone __user *, tz)\n{\n\tif (likely(tv != NULL)) {\n\t\tstruct timespec64 ts;\n\n\t\tktime_get_real_ts64(&ts);\n\t\tif (put_user(ts.tv_sec, &tv->tv_sec) ||\n\t\t    put_user(ts.tv_nsec / 1000, &tv->tv_usec))\n\t\t\treturn -EFAULT;\n\t}\n\tif (unlikely(tz != NULL)) {\n\t\tif (copy_to_user(tz, &sys_tz, sizeof(sys_tz)))\n\t\t\treturn -EFAULT;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct timezone sys_tz;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstruct timezone sys_tz;\n\nSYSCALL_DEFINE2(gettimeofday, struct timeval __user *, tv,\n\t\tstruct timezone __user *, tz)\n{\n\tif (likely(tv != NULL)) {\n\t\tstruct timespec64 ts;\n\n\t\tktime_get_real_ts64(&ts);\n\t\tif (put_user(ts.tv_sec, &tv->tv_sec) ||\n\t\t    put_user(ts.tv_nsec / 1000, &tv->tv_usec))\n\t\t\treturn -EFAULT;\n\t}\n\tif (unlikely(tz != NULL)) {\n\t\tif (copy_to_user(tz, &sys_tz, sizeof(sys_tz)))\n\t\t\treturn -EFAULT;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "settimeofday",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "202-225",
    "snippet": "SYSCALL_DEFINE2(settimeofday, struct timeval __user *, tv,\n\t\tstruct timezone __user *, tz)\n{\n\tstruct timespec64 new_ts;\n\tstruct timeval user_tv;\n\tstruct timezone new_tz;\n\n\tif (tv) {\n\t\tif (copy_from_user(&user_tv, tv, sizeof(*tv)))\n\t\t\treturn -EFAULT;\n\n\t\tif (!timeval_valid(&user_tv))\n\t\t\treturn -EINVAL;\n\n\t\tnew_ts.tv_sec = user_tv.tv_sec;\n\t\tnew_ts.tv_nsec = user_tv.tv_usec * NSEC_PER_USEC;\n\t}\n\tif (tz) {\n\t\tif (copy_from_user(&new_tz, tz, sizeof(*tz)))\n\t\t\treturn -EFAULT;\n\t}\n\n\treturn do_sys_settimeofday64(tv ? &new_ts : NULL, tz ? &new_tz : NULL);\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(settimeofday, struct timeval __user *, tv,\n\t\tstruct timezone __user *, tz)\n{\n\tstruct timespec64 new_ts;\n\tstruct timeval user_tv;\n\tstruct timezone new_tz;\n\n\tif (tv) {\n\t\tif (copy_from_user(&user_tv, tv, sizeof(*tv)))\n\t\t\treturn -EFAULT;\n\n\t\tif (!timeval_valid(&user_tv))\n\t\t\treturn -EINVAL;\n\n\t\tnew_ts.tv_sec = user_tv.tv_sec;\n\t\tnew_ts.tv_nsec = user_tv.tv_usec * NSEC_PER_USEC;\n\t}\n\tif (tz) {\n\t\tif (copy_from_user(&new_tz, tz, sizeof(*tz)))\n\t\t\treturn -EFAULT;\n\t}\n\n\treturn do_sys_settimeofday64(tv ? &new_ts : NULL, tz ? &new_tz : NULL);\n}"
  },
  {
    "function_name": "gettimeofday",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "228-245",
    "snippet": "SYSCALL_DEFINE2(gettimeofday, struct old_timeval32 __user *, tv,\n\t\t       struct timezone __user *, tz)\n{\n\tif (tv) {\n\t\tstruct timespec64 ts;\n\n\t\tktime_get_real_ts64(&ts);\n\t\tif (put_user(ts.tv_sec, &tv->tv_sec) ||\n\t\t    put_user(ts.tv_nsec / 1000, &tv->tv_usec))\n\t\t\treturn -EFAULT;\n\t}\n\tif (tz) {\n\t\tif (copy_to_user(tz, &sys_tz, sizeof(sys_tz)))\n\t\t\treturn -EFAULT;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct timezone sys_tz;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstruct timezone sys_tz;\n\nSYSCALL_DEFINE2(gettimeofday, struct old_timeval32 __user *, tv,\n\t\t       struct timezone __user *, tz)\n{\n\tif (tv) {\n\t\tstruct timespec64 ts;\n\n\t\tktime_get_real_ts64(&ts);\n\t\tif (put_user(ts.tv_sec, &tv->tv_sec) ||\n\t\t    put_user(ts.tv_nsec / 1000, &tv->tv_usec))\n\t\t\treturn -EFAULT;\n\t}\n\tif (tz) {\n\t\tif (copy_to_user(tz, &sys_tz, sizeof(sys_tz)))\n\t\t\treturn -EFAULT;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "settimeofday",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "247-266",
    "snippet": "SYSCALL_DEFINE2(settimeofday, struct old_timeval32 __user *, tv,\n\t\t       struct timezone __user *, tz)\n{\n\tstruct timespec64 new_ts;\n\tstruct timeval user_tv;\n\tstruct timezone new_tz;\n\n\tif (tv) {\n\t\tif (compat_get_timeval(&user_tv, tv))\n\t\t\treturn -EFAULT;\n\t\tnew_ts.tv_sec = user_tv.tv_sec;\n\t\tnew_ts.tv_nsec = user_tv.tv_usec * NSEC_PER_USEC;\n\t}\n\tif (tz) {\n\t\tif (copy_from_user(&new_tz, tz, sizeof(*tz)))\n\t\t\treturn -EFAULT;\n\t}\n\n\treturn do_sys_settimeofday64(tv ? &new_ts : NULL, tz ? &new_tz : NULL);\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(settimeofday, struct old_timeval32 __user *, tv,\n\t\t       struct timezone __user *, tz)\n{\n\tstruct timespec64 new_ts;\n\tstruct timeval user_tv;\n\tstruct timezone new_tz;\n\n\tif (tv) {\n\t\tif (compat_get_timeval(&user_tv, tv))\n\t\t\treturn -EFAULT;\n\t\tnew_ts.tv_sec = user_tv.tv_sec;\n\t\tnew_ts.tv_nsec = user_tv.tv_usec * NSEC_PER_USEC;\n\t}\n\tif (tz) {\n\t\tif (copy_from_user(&new_tz, tz, sizeof(*tz)))\n\t\t\treturn -EFAULT;\n\t}\n\n\treturn do_sys_settimeofday64(tv ? &new_ts : NULL, tz ? &new_tz : NULL);\n}"
  },
  {
    "function_name": "adjtimex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "269-282",
    "snippet": "SYSCALL_DEFINE1(adjtimex, struct timex __user *, txc_p)\n{\n\tstruct timex txc;\t\t/* Local copy of parameter */\n\tint ret;\n\n\t/* Copy the user data space into the kernel copy\n\t * structure. But bear in mind that the structures\n\t * may change\n\t */\n\tif (copy_from_user(&txc, txc_p, sizeof(struct timex)))\n\t\treturn -EFAULT;\n\tret = do_adjtimex(&txc);\n\treturn copy_to_user(txc_p, &txc, sizeof(struct timex)) ? -EFAULT : ret;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(adjtimex, struct timex __user *, txc_p)\n{\n\tstruct timex txc;\t\t/* Local copy of parameter */\n\tint ret;\n\n\t/* Copy the user data space into the kernel copy\n\t * structure. But bear in mind that the structures\n\t * may change\n\t */\n\tif (copy_from_user(&txc, txc_p, sizeof(struct timex)))\n\t\treturn -EFAULT;\n\tret = do_adjtimex(&txc);\n\treturn copy_to_user(txc_p, &txc, sizeof(struct timex)) ? -EFAULT : ret;\n}"
  },
  {
    "function_name": "adjtimex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/time.c",
    "lines": "286-302",
    "snippet": "SYSCALL_DEFINE1(adjtimex, struct compat_timex __user *, utp)\n{\n\tstruct timex txc;\n\tint err, ret;\n\n\terr = compat_get_timex(&txc, utp);\n\tif (err)\n\t\treturn err;\n\n\tret = do_adjtimex(&txc);\n\n\terr = compat_put_timex(utp, &txc);\n\tif (err)\n\t\treturn err;\n\n\treturn ret;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <generated/timeconst.h>",
      "#include <asm/unistd.h>",
      "#include <linux/compat.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/math64.h>",
      "#include <linux/fs.h>",
      "#include <linux/security.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/errno.h>",
      "#include <linux/timekeeper_internal.h>",
      "#include <linux/capability.h>",
      "#include <linux/timex.h>",
      "#include <linux/kernel.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(adjtimex, struct compat_timex __user *, utp)\n{\n\tstruct timex txc;\n\tint err, ret;\n\n\terr = compat_get_timex(&txc, utp);\n\tif (err)\n\t\treturn err;\n\n\tret = do_adjtimex(&txc);\n\n\terr = compat_put_timex(utp, &txc);\n\tif (err)\n\t\treturn err;\n\n\treturn ret;\n}"
  }
]