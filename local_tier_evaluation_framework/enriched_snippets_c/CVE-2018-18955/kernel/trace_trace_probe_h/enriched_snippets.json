[
  {
    "function_name": "find_event_file_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_probe.h",
    "lines": "258-268",
    "snippet": "static inline struct event_file_link *\nfind_event_file_link(struct trace_probe *tp, struct trace_event_file *file)\n{\n\tstruct event_file_link *link;\n\n\tlist_for_each_entry(link, &tp->files, list)\n\t\tif (link->file == file)\n\t\t\treturn link;\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"trace_output.h\"",
      "#include \"trace.h\"",
      "#include <asm/bitsperlong.h>",
      "#include <linux/bitops.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/limits.h>",
      "#include <linux/stringify.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/tracefs.h>",
      "#include <linux/smp.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern int traceprobe_define_arg_fields(struct trace_event_call *event_call,\n\t\t\t\t\tsize_t offset, struct trace_probe *tp);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "link",
            "&tp->files",
            "list"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_output.h\"\n#include \"trace.h\"\n#include <asm/bitsperlong.h>\n#include <linux/bitops.h>\n#include <linux/uaccess.h>\n#include <linux/limits.h>\n#include <linux/stringify.h>\n#include <linux/kprobes.h>\n#include <linux/perf_event.h>\n#include <linux/ptrace.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/tracefs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n\nextern int traceprobe_define_arg_fields(struct trace_event_call *event_call,\n\t\t\t\t\tsize_t offset, struct trace_probe *tp);\n\nstatic inline struct event_file_link *\nfind_event_file_link(struct trace_probe *tp, struct trace_event_file *file)\n{\n\tstruct event_file_link *link;\n\n\tlist_for_each_entry(link, &tp->files, list)\n\t\tif (link->file == file)\n\t\t\treturn link;\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "is_good_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_probe.h",
    "lines": "247-256",
    "snippet": "static inline bool is_good_name(const char *name)\n{\n\tif (!isalpha(*name) && *name != '_')\n\t\treturn false;\n\twhile (*++name != '\\0') {\n\t\tif (!isalpha(*name) && !isdigit(*name) && *name != '_')\n\t\t\treturn false;\n\t}\n\treturn true;\n}",
    "includes": [
      "#include \"trace_output.h\"",
      "#include \"trace.h\"",
      "#include <asm/bitsperlong.h>",
      "#include <linux/bitops.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/limits.h>",
      "#include <linux/stringify.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/tracefs.h>",
      "#include <linux/smp.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*name"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "*name"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "*name"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_output.h\"\n#include \"trace.h\"\n#include <asm/bitsperlong.h>\n#include <linux/bitops.h>\n#include <linux/uaccess.h>\n#include <linux/limits.h>\n#include <linux/stringify.h>\n#include <linux/kprobes.h>\n#include <linux/perf_event.h>\n#include <linux/ptrace.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/tracefs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n\nstatic inline bool is_good_name(const char *name)\n{\n\tif (!isalpha(*name) && *name != '_')\n\t\treturn false;\n\twhile (*++name != '\\0') {\n\t\tif (!isalpha(*name) && !isdigit(*name) && *name != '_')\n\t\t\treturn false;\n\t}\n\treturn true;\n}"
  },
  {
    "function_name": "trace_probe_is_registered",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_probe.h",
    "lines": "241-244",
    "snippet": "static inline bool trace_probe_is_registered(struct trace_probe *tp)\n{\n\treturn !!(tp->flags & TP_FLAG_REGISTERED);\n}",
    "includes": [
      "#include \"trace_output.h\"",
      "#include \"trace.h\"",
      "#include <asm/bitsperlong.h>",
      "#include <linux/bitops.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/limits.h>",
      "#include <linux/stringify.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/tracefs.h>",
      "#include <linux/smp.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [
      "#define TP_FLAG_REGISTERED\t4"
    ],
    "globals_used": [
      "extern int traceprobe_parse_probe_arg(char *arg, ssize_t *size,\n\t\t   struct probe_arg *parg, unsigned int flags);",
      "extern int traceprobe_define_arg_fields(struct trace_event_call *event_call,\n\t\t\t\t\tsize_t offset, struct trace_probe *tp);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"trace_output.h\"\n#include \"trace.h\"\n#include <asm/bitsperlong.h>\n#include <linux/bitops.h>\n#include <linux/uaccess.h>\n#include <linux/limits.h>\n#include <linux/stringify.h>\n#include <linux/kprobes.h>\n#include <linux/perf_event.h>\n#include <linux/ptrace.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/tracefs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n\n#define TP_FLAG_REGISTERED\t4\n\nextern int traceprobe_parse_probe_arg(char *arg, ssize_t *size,\n\t\t   struct probe_arg *parg, unsigned int flags);\nextern int traceprobe_define_arg_fields(struct trace_event_call *event_call,\n\t\t\t\t\tsize_t offset, struct trace_probe *tp);\n\nstatic inline bool trace_probe_is_registered(struct trace_probe *tp)\n{\n\treturn !!(tp->flags & TP_FLAG_REGISTERED);\n}"
  },
  {
    "function_name": "trace_probe_is_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_probe.h",
    "lines": "236-239",
    "snippet": "static inline bool trace_probe_is_enabled(struct trace_probe *tp)\n{\n\treturn !!(tp->flags & (TP_FLAG_TRACE | TP_FLAG_PROFILE));\n}",
    "includes": [
      "#include \"trace_output.h\"",
      "#include \"trace.h\"",
      "#include <asm/bitsperlong.h>",
      "#include <linux/bitops.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/limits.h>",
      "#include <linux/stringify.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/tracefs.h>",
      "#include <linux/smp.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [
      "#define TP_FLAG_PROFILE\t\t2",
      "#define TP_FLAG_TRACE\t\t1"
    ],
    "globals_used": [
      "extern int traceprobe_parse_probe_arg(char *arg, ssize_t *size,\n\t\t   struct probe_arg *parg, unsigned int flags);",
      "extern int traceprobe_define_arg_fields(struct trace_event_call *event_call,\n\t\t\t\t\tsize_t offset, struct trace_probe *tp);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"trace_output.h\"\n#include \"trace.h\"\n#include <asm/bitsperlong.h>\n#include <linux/bitops.h>\n#include <linux/uaccess.h>\n#include <linux/limits.h>\n#include <linux/stringify.h>\n#include <linux/kprobes.h>\n#include <linux/perf_event.h>\n#include <linux/ptrace.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/tracefs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n\n#define TP_FLAG_PROFILE\t\t2\n#define TP_FLAG_TRACE\t\t1\n\nextern int traceprobe_parse_probe_arg(char *arg, ssize_t *size,\n\t\t   struct probe_arg *parg, unsigned int flags);\nextern int traceprobe_define_arg_fields(struct trace_event_call *event_call,\n\t\t\t\t\tsize_t offset, struct trace_probe *tp);\n\nstatic inline bool trace_probe_is_enabled(struct trace_probe *tp)\n{\n\treturn !!(tp->flags & (TP_FLAG_TRACE | TP_FLAG_PROFILE));\n}"
  },
  {
    "function_name": "trace_kprobe_error_injectable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_probe.h",
    "lines": "204-207",
    "snippet": "static inline bool trace_kprobe_error_injectable(struct trace_event_call *call)\n{\n\treturn false;\n}",
    "includes": [
      "#include \"trace_output.h\"",
      "#include \"trace.h\"",
      "#include <asm/bitsperlong.h>",
      "#include <linux/bitops.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/limits.h>",
      "#include <linux/stringify.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/tracefs.h>",
      "#include <linux/smp.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"trace_output.h\"\n#include \"trace.h\"\n#include <asm/bitsperlong.h>\n#include <linux/bitops.h>\n#include <linux/uaccess.h>\n#include <linux/limits.h>\n#include <linux/stringify.h>\n#include <linux/kprobes.h>\n#include <linux/perf_event.h>\n#include <linux/ptrace.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/tracefs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n\nstatic inline bool trace_kprobe_error_injectable(struct trace_event_call *call)\n{\n\treturn false;\n}"
  },
  {
    "function_name": "trace_kprobe_on_func_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_probe.h",
    "lines": "199-202",
    "snippet": "static inline bool trace_kprobe_on_func_entry(struct trace_event_call *call)\n{\n\treturn false;\n}",
    "includes": [
      "#include \"trace_output.h\"",
      "#include \"trace.h\"",
      "#include <asm/bitsperlong.h>",
      "#include <linux/bitops.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/limits.h>",
      "#include <linux/stringify.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/tracefs.h>",
      "#include <linux/smp.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"trace_output.h\"\n#include \"trace.h\"\n#include <asm/bitsperlong.h>\n#include <linux/bitops.h>\n#include <linux/uaccess.h>\n#include <linux/limits.h>\n#include <linux/stringify.h>\n#include <linux/kprobes.h>\n#include <linux/perf_event.h>\n#include <linux/ptrace.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/tracefs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n\nstatic inline bool trace_kprobe_on_func_entry(struct trace_event_call *call)\n{\n\treturn false;\n}"
  },
  {
    "function_name": "update_data_loc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_probe.h",
    "lines": "70-76",
    "snippet": "static nokprobe_inline u32 update_data_loc(u32 loc, int consumed)\n{\n\tu32 maxlen = get_loc_len(loc);\n\tu32 offset = get_loc_offs(loc);\n\n\treturn make_data_loc(maxlen - consumed, offset + consumed);\n}",
    "includes": [
      "#include \"trace_output.h\"",
      "#include \"trace.h\"",
      "#include <asm/bitsperlong.h>",
      "#include <linux/bitops.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/limits.h>",
      "#include <linux/stringify.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/tracefs.h>",
      "#include <linux/smp.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern int traceprobe_split_symbol_offset(char *symbol, long *offset);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "make_data_loc",
          "args": [
            "maxlen - consumed",
            "offset + consumed"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_loc_offs",
          "args": [
            "loc"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_loc_len",
          "args": [
            "loc"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_output.h\"\n#include \"trace.h\"\n#include <asm/bitsperlong.h>\n#include <linux/bitops.h>\n#include <linux/uaccess.h>\n#include <linux/limits.h>\n#include <linux/stringify.h>\n#include <linux/kprobes.h>\n#include <linux/perf_event.h>\n#include <linux/ptrace.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/tracefs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n\nextern int traceprobe_split_symbol_offset(char *symbol, long *offset);\n\nstatic nokprobe_inline u32 update_data_loc(u32 loc, int consumed)\n{\n\tu32 maxlen = get_loc_len(loc);\n\tu32 offset = get_loc_offs(loc);\n\n\treturn make_data_loc(maxlen - consumed, offset + consumed);\n}"
  },
  {
    "function_name": "get_loc_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/trace/trace_probe.h",
    "lines": "65-68",
    "snippet": "static nokprobe_inline void *get_loc_data(u32 *dl, void *ent)\n{\n\treturn (u8 *)ent + get_loc_offs(*dl);\n}",
    "includes": [
      "#include \"trace_output.h\"",
      "#include \"trace.h\"",
      "#include <asm/bitsperlong.h>",
      "#include <linux/bitops.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/limits.h>",
      "#include <linux/stringify.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/ctype.h>",
      "#include <linux/string.h>",
      "#include <linux/types.h>",
      "#include <linux/tracefs.h>",
      "#include <linux/smp.h>",
      "#include <linux/slab.h>",
      "#include <linux/seq_file.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_loc_offs",
          "args": [
            "*dl"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"trace_output.h\"\n#include \"trace.h\"\n#include <asm/bitsperlong.h>\n#include <linux/bitops.h>\n#include <linux/uaccess.h>\n#include <linux/limits.h>\n#include <linux/stringify.h>\n#include <linux/kprobes.h>\n#include <linux/perf_event.h>\n#include <linux/ptrace.h>\n#include <linux/ctype.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/tracefs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n\nstatic nokprobe_inline void *get_loc_data(u32 *dl, void *ent)\n{\n\treturn (u8 *)ent + get_loc_offs(*dl);\n}"
  }
]