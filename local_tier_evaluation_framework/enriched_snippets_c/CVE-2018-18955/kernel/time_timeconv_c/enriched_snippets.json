[
  {
    "function_name": "time64_to_tm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timeconv.c",
    "lines": "77-127",
    "snippet": "void time64_to_tm(time64_t totalsecs, int offset, struct tm *result)\n{\n\tlong days, rem, y;\n\tint remainder;\n\tconst unsigned short *ip;\n\n\tdays = div_s64_rem(totalsecs, SECS_PER_DAY, &remainder);\n\trem = remainder;\n\trem += offset;\n\twhile (rem < 0) {\n\t\trem += SECS_PER_DAY;\n\t\t--days;\n\t}\n\twhile (rem >= SECS_PER_DAY) {\n\t\trem -= SECS_PER_DAY;\n\t\t++days;\n\t}\n\n\tresult->tm_hour = rem / SECS_PER_HOUR;\n\trem %= SECS_PER_HOUR;\n\tresult->tm_min = rem / 60;\n\tresult->tm_sec = rem % 60;\n\n\t/* January 1, 1970 was a Thursday. */\n\tresult->tm_wday = (4 + days) % 7;\n\tif (result->tm_wday < 0)\n\t\tresult->tm_wday += 7;\n\n\ty = 1970;\n\n\twhile (days < 0 || days >= (__isleap(y) ? 366 : 365)) {\n\t\t/* Guess a corrected year, assuming 365 days per year. */\n\t\tlong yg = y + math_div(days, 365);\n\n\t\t/* Adjust DAYS and Y to match the guessed year. */\n\t\tdays -= (yg - y) * 365 + leaps_between(y, yg);\n\t\ty = yg;\n\t}\n\n\tresult->tm_year = y - 1900;\n\n\tresult->tm_yday = days;\n\n\tip = __mon_yday[__isleap(y)];\n\tfor (y = 11; days < ip[y]; y--)\n\t\tcontinue;\n\tdays -= ip[y];\n\n\tresult->tm_mon = y;\n\tresult->tm_mday = days + 1;\n}",
    "includes": [
      "#include <linux/module.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [
      "#define SECS_PER_DAY\t(SECS_PER_HOUR * 24)",
      "#define SECS_PER_HOUR\t(60 * 60)"
    ],
    "globals_used": [
      "static const unsigned short __mon_yday[2][13] = {\n\t/* Normal years. */\n\t{0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365},\n\t/* Leap years. */\n\t{0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__isleap",
          "args": [
            "y"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "__isleap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timeconv.c",
          "lines": "37-40",
          "snippet": "static int __isleap(long year)\n{\n\treturn (year) % 4 == 0 && ((year) % 100 != 0 || (year) % 400 == 0);\n}",
          "includes": [
            "#include <linux/module.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/module.h>\n#include <linux/time.h>\n\nstatic int __isleap(long year)\n{\n\treturn (year) % 4 == 0 && ((year) % 100 != 0 || (year) % 400 == 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "leaps_between",
          "args": [
            "y",
            "yg"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "leaps_between",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timeconv.c",
          "lines": "49-56",
          "snippet": "static long leaps_between(long y1, long y2)\n{\n\tlong leaps1 = math_div(y1 - 1, 4) - math_div(y1 - 1, 100)\n\t\t+ math_div(y1 - 1, 400);\n\tlong leaps2 = math_div(y2 - 1, 4) - math_div(y2 - 1, 100)\n\t\t+ math_div(y2 - 1, 400);\n\treturn leaps2 - leaps1;\n}",
          "includes": [
            "#include <linux/module.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/module.h>\n#include <linux/time.h>\n\nstatic long leaps_between(long y1, long y2)\n{\n\tlong leaps1 = math_div(y1 - 1, 4) - math_div(y1 - 1, 100)\n\t\t+ math_div(y1 - 1, 400);\n\tlong leaps2 = math_div(y2 - 1, 4) - math_div(y2 - 1, 100)\n\t\t+ math_div(y2 - 1, 400);\n\treturn leaps2 - leaps1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "math_div",
          "args": [
            "days",
            "365"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "math_div",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timeconv.c",
          "lines": "43-46",
          "snippet": "static long math_div(long a, long b)\n{\n\treturn a / b - (a % b < 0);\n}",
          "includes": [
            "#include <linux/module.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/module.h>\n#include <linux/time.h>\n\nstatic long math_div(long a, long b)\n{\n\treturn a / b - (a % b < 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "div_s64_rem",
          "args": [
            "totalsecs",
            "SECS_PER_DAY",
            "&remainder"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/module.h>\n#include <linux/time.h>\n\n#define SECS_PER_DAY\t(SECS_PER_HOUR * 24)\n#define SECS_PER_HOUR\t(60 * 60)\n\nstatic const unsigned short __mon_yday[2][13] = {\n\t/* Normal years. */\n\t{0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365},\n\t/* Leap years. */\n\t{0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366}\n};\n\nvoid time64_to_tm(time64_t totalsecs, int offset, struct tm *result)\n{\n\tlong days, rem, y;\n\tint remainder;\n\tconst unsigned short *ip;\n\n\tdays = div_s64_rem(totalsecs, SECS_PER_DAY, &remainder);\n\trem = remainder;\n\trem += offset;\n\twhile (rem < 0) {\n\t\trem += SECS_PER_DAY;\n\t\t--days;\n\t}\n\twhile (rem >= SECS_PER_DAY) {\n\t\trem -= SECS_PER_DAY;\n\t\t++days;\n\t}\n\n\tresult->tm_hour = rem / SECS_PER_HOUR;\n\trem %= SECS_PER_HOUR;\n\tresult->tm_min = rem / 60;\n\tresult->tm_sec = rem % 60;\n\n\t/* January 1, 1970 was a Thursday. */\n\tresult->tm_wday = (4 + days) % 7;\n\tif (result->tm_wday < 0)\n\t\tresult->tm_wday += 7;\n\n\ty = 1970;\n\n\twhile (days < 0 || days >= (__isleap(y) ? 366 : 365)) {\n\t\t/* Guess a corrected year, assuming 365 days per year. */\n\t\tlong yg = y + math_div(days, 365);\n\n\t\t/* Adjust DAYS and Y to match the guessed year. */\n\t\tdays -= (yg - y) * 365 + leaps_between(y, yg);\n\t\ty = yg;\n\t}\n\n\tresult->tm_year = y - 1900;\n\n\tresult->tm_yday = days;\n\n\tip = __mon_yday[__isleap(y)];\n\tfor (y = 11; days < ip[y]; y--)\n\t\tcontinue;\n\tdays -= ip[y];\n\n\tresult->tm_mon = y;\n\tresult->tm_mday = days + 1;\n}"
  },
  {
    "function_name": "leaps_between",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timeconv.c",
    "lines": "49-56",
    "snippet": "static long leaps_between(long y1, long y2)\n{\n\tlong leaps1 = math_div(y1 - 1, 4) - math_div(y1 - 1, 100)\n\t\t+ math_div(y1 - 1, 400);\n\tlong leaps2 = math_div(y2 - 1, 4) - math_div(y2 - 1, 100)\n\t\t+ math_div(y2 - 1, 400);\n\treturn leaps2 - leaps1;\n}",
    "includes": [
      "#include <linux/module.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "math_div",
          "args": [
            "y2 - 1",
            "400"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "math_div",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timeconv.c",
          "lines": "43-46",
          "snippet": "static long math_div(long a, long b)\n{\n\treturn a / b - (a % b < 0);\n}",
          "includes": [
            "#include <linux/module.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/module.h>\n#include <linux/time.h>\n\nstatic long math_div(long a, long b)\n{\n\treturn a / b - (a % b < 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/module.h>\n#include <linux/time.h>\n\nstatic long leaps_between(long y1, long y2)\n{\n\tlong leaps1 = math_div(y1 - 1, 4) - math_div(y1 - 1, 100)\n\t\t+ math_div(y1 - 1, 400);\n\tlong leaps2 = math_div(y2 - 1, 4) - math_div(y2 - 1, 100)\n\t\t+ math_div(y2 - 1, 400);\n\treturn leaps2 - leaps1;\n}"
  },
  {
    "function_name": "math_div",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timeconv.c",
    "lines": "43-46",
    "snippet": "static long math_div(long a, long b)\n{\n\treturn a / b - (a % b < 0);\n}",
    "includes": [
      "#include <linux/module.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/module.h>\n#include <linux/time.h>\n\nstatic long math_div(long a, long b)\n{\n\treturn a / b - (a % b < 0);\n}"
  },
  {
    "function_name": "__isleap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/timeconv.c",
    "lines": "37-40",
    "snippet": "static int __isleap(long year)\n{\n\treturn (year) % 4 == 0 && ((year) % 100 != 0 || (year) % 400 == 0);\n}",
    "includes": [
      "#include <linux/module.h>",
      "#include <linux/time.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/module.h>\n#include <linux/time.h>\n\nstatic int __isleap(long year)\n{\n\treturn (year) % 4 == 0 && ((year) % 100 != 0 || (year) % 400 == 0);\n}"
  }
]