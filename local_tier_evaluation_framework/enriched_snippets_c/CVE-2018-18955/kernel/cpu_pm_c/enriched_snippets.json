[
  {
    "function_name": "cpu_pm_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
    "lines": "203-207",
    "snippet": "static int cpu_pm_init(void)\n{\n\tregister_syscore_ops(&cpu_pm_syscore_ops);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_syscore_ops",
          "args": [
            "&cpu_pm_syscore_ops"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic int cpu_pm_init(void)\n{\n\tregister_syscore_ops(&cpu_pm_syscore_ops);\n\treturn 0;\n}"
  },
  {
    "function_name": "cpu_pm_resume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
    "lines": "192-196",
    "snippet": "static void cpu_pm_resume(void)\n{\n\tcpu_cluster_pm_exit();\n\tcpu_pm_exit();\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_pm_exit",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
          "lines": "119-122",
          "snippet": "int cpu_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_PM_EXIT, -1, NULL);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_PM_EXIT, -1, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_cluster_pm_exit",
          "args": [],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_cluster_pm_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
          "lines": "173-176",
          "snippet": "int cpu_cluster_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_CLUSTER_PM_EXIT, -1, NULL);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_cluster_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_CLUSTER_PM_EXIT, -1, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic void cpu_pm_resume(void)\n{\n\tcpu_cluster_pm_exit();\n\tcpu_pm_exit();\n}"
  },
  {
    "function_name": "cpu_pm_suspend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
    "lines": "180-190",
    "snippet": "static int cpu_pm_suspend(void)\n{\n\tint ret;\n\n\tret = cpu_pm_enter();\n\tif (ret)\n\t\treturn ret;\n\n\tret = cpu_cluster_pm_enter();\n\treturn ret;\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_cluster_pm_enter",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_cluster_pm_enter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
          "lines": "141-155",
          "snippet": "int cpu_cluster_pm_enter(void)\n{\n\tint nr_calls;\n\tint ret = 0;\n\n\tret = cpu_pm_notify(CPU_CLUSTER_PM_ENTER, -1, &nr_calls);\n\tif (ret)\n\t\t/*\n\t\t * Inform listeners (nr_calls - 1) about failure of CPU cluster\n\t\t * PM entry who are notified earlier to prepare for it.\n\t\t */\n\t\tcpu_pm_notify(CPU_CLUSTER_PM_ENTER_FAILED, nr_calls - 1, NULL);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_cluster_pm_enter(void)\n{\n\tint nr_calls;\n\tint ret = 0;\n\n\tret = cpu_pm_notify(CPU_CLUSTER_PM_ENTER, -1, &nr_calls);\n\tif (ret)\n\t\t/*\n\t\t * Inform listeners (nr_calls - 1) about failure of CPU cluster\n\t\t * PM entry who are notified earlier to prepare for it.\n\t\t */\n\t\tcpu_pm_notify(CPU_CLUSTER_PM_ENTER_FAILED, nr_calls - 1, NULL);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_pm_enter",
          "args": [],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_enter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
          "lines": "90-104",
          "snippet": "int cpu_pm_enter(void)\n{\n\tint nr_calls;\n\tint ret = 0;\n\n\tret = cpu_pm_notify(CPU_PM_ENTER, -1, &nr_calls);\n\tif (ret)\n\t\t/*\n\t\t * Inform listeners (nr_calls - 1) about failure of CPU PM\n\t\t * PM entry who are notified earlier to prepare for it.\n\t\t */\n\t\tcpu_pm_notify(CPU_PM_ENTER_FAILED, nr_calls - 1, NULL);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_pm_enter(void)\n{\n\tint nr_calls;\n\tint ret = 0;\n\n\tret = cpu_pm_notify(CPU_PM_ENTER, -1, &nr_calls);\n\tif (ret)\n\t\t/*\n\t\t * Inform listeners (nr_calls - 1) about failure of CPU PM\n\t\t * PM entry who are notified earlier to prepare for it.\n\t\t */\n\t\tcpu_pm_notify(CPU_PM_ENTER_FAILED, nr_calls - 1, NULL);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic int cpu_pm_suspend(void)\n{\n\tint ret;\n\n\tret = cpu_pm_enter();\n\tif (ret)\n\t\treturn ret;\n\n\tret = cpu_cluster_pm_enter();\n\treturn ret;\n}"
  },
  {
    "function_name": "cpu_cluster_pm_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
    "lines": "173-176",
    "snippet": "int cpu_cluster_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_CLUSTER_PM_EXIT, -1, NULL);\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_pm_notify",
          "args": [
            "CPU_CLUSTER_PM_EXIT",
            "-1",
            "NULL"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_notify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
          "lines": "27-42",
          "snippet": "static int cpu_pm_notify(enum cpu_pm_event event, int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\t/*\n\t * __atomic_notifier_call_chain has a RCU read critical section, which\n\t * could be disfunctional in cpu idle. Copy RCU_NONIDLE code to let\n\t * RCU know this.\n\t */\n\trcu_irq_enter_irqson();\n\tret = __atomic_notifier_call_chain(&cpu_pm_notifier_chain, event, NULL,\n\t\tnr_to_call, nr_calls);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);\n\nstatic int cpu_pm_notify(enum cpu_pm_event event, int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\t/*\n\t * __atomic_notifier_call_chain has a RCU read critical section, which\n\t * could be disfunctional in cpu idle. Copy RCU_NONIDLE code to let\n\t * RCU know this.\n\t */\n\trcu_irq_enter_irqson();\n\tret = __atomic_notifier_call_chain(&cpu_pm_notifier_chain, event, NULL,\n\t\tnr_to_call, nr_calls);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_cluster_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_CLUSTER_PM_EXIT, -1, NULL);\n}"
  },
  {
    "function_name": "cpu_cluster_pm_enter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
    "lines": "141-155",
    "snippet": "int cpu_cluster_pm_enter(void)\n{\n\tint nr_calls;\n\tint ret = 0;\n\n\tret = cpu_pm_notify(CPU_CLUSTER_PM_ENTER, -1, &nr_calls);\n\tif (ret)\n\t\t/*\n\t\t * Inform listeners (nr_calls - 1) about failure of CPU cluster\n\t\t * PM entry who are notified earlier to prepare for it.\n\t\t */\n\t\tcpu_pm_notify(CPU_CLUSTER_PM_ENTER_FAILED, nr_calls - 1, NULL);\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_pm_notify",
          "args": [
            "CPU_CLUSTER_PM_ENTER_FAILED",
            "nr_calls - 1",
            "NULL"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_notify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
          "lines": "27-42",
          "snippet": "static int cpu_pm_notify(enum cpu_pm_event event, int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\t/*\n\t * __atomic_notifier_call_chain has a RCU read critical section, which\n\t * could be disfunctional in cpu idle. Copy RCU_NONIDLE code to let\n\t * RCU know this.\n\t */\n\trcu_irq_enter_irqson();\n\tret = __atomic_notifier_call_chain(&cpu_pm_notifier_chain, event, NULL,\n\t\tnr_to_call, nr_calls);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);\n\nstatic int cpu_pm_notify(enum cpu_pm_event event, int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\t/*\n\t * __atomic_notifier_call_chain has a RCU read critical section, which\n\t * could be disfunctional in cpu idle. Copy RCU_NONIDLE code to let\n\t * RCU know this.\n\t */\n\trcu_irq_enter_irqson();\n\tret = __atomic_notifier_call_chain(&cpu_pm_notifier_chain, event, NULL,\n\t\tnr_to_call, nr_calls);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_cluster_pm_enter(void)\n{\n\tint nr_calls;\n\tint ret = 0;\n\n\tret = cpu_pm_notify(CPU_CLUSTER_PM_ENTER, -1, &nr_calls);\n\tif (ret)\n\t\t/*\n\t\t * Inform listeners (nr_calls - 1) about failure of CPU cluster\n\t\t * PM entry who are notified earlier to prepare for it.\n\t\t */\n\t\tcpu_pm_notify(CPU_CLUSTER_PM_ENTER_FAILED, nr_calls - 1, NULL);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "cpu_pm_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
    "lines": "119-122",
    "snippet": "int cpu_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_PM_EXIT, -1, NULL);\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_pm_notify",
          "args": [
            "CPU_PM_EXIT",
            "-1",
            "NULL"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_notify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
          "lines": "27-42",
          "snippet": "static int cpu_pm_notify(enum cpu_pm_event event, int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\t/*\n\t * __atomic_notifier_call_chain has a RCU read critical section, which\n\t * could be disfunctional in cpu idle. Copy RCU_NONIDLE code to let\n\t * RCU know this.\n\t */\n\trcu_irq_enter_irqson();\n\tret = __atomic_notifier_call_chain(&cpu_pm_notifier_chain, event, NULL,\n\t\tnr_to_call, nr_calls);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);\n\nstatic int cpu_pm_notify(enum cpu_pm_event event, int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\t/*\n\t * __atomic_notifier_call_chain has a RCU read critical section, which\n\t * could be disfunctional in cpu idle. Copy RCU_NONIDLE code to let\n\t * RCU know this.\n\t */\n\trcu_irq_enter_irqson();\n\tret = __atomic_notifier_call_chain(&cpu_pm_notifier_chain, event, NULL,\n\t\tnr_to_call, nr_calls);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_PM_EXIT, -1, NULL);\n}"
  },
  {
    "function_name": "cpu_pm_enter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
    "lines": "90-104",
    "snippet": "int cpu_pm_enter(void)\n{\n\tint nr_calls;\n\tint ret = 0;\n\n\tret = cpu_pm_notify(CPU_PM_ENTER, -1, &nr_calls);\n\tif (ret)\n\t\t/*\n\t\t * Inform listeners (nr_calls - 1) about failure of CPU PM\n\t\t * PM entry who are notified earlier to prepare for it.\n\t\t */\n\t\tcpu_pm_notify(CPU_PM_ENTER_FAILED, nr_calls - 1, NULL);\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_pm_notify",
          "args": [
            "CPU_PM_ENTER_FAILED",
            "nr_calls - 1",
            "NULL"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_notify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
          "lines": "27-42",
          "snippet": "static int cpu_pm_notify(enum cpu_pm_event event, int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\t/*\n\t * __atomic_notifier_call_chain has a RCU read critical section, which\n\t * could be disfunctional in cpu idle. Copy RCU_NONIDLE code to let\n\t * RCU know this.\n\t */\n\trcu_irq_enter_irqson();\n\tret = __atomic_notifier_call_chain(&cpu_pm_notifier_chain, event, NULL,\n\t\tnr_to_call, nr_calls);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);\n\nstatic int cpu_pm_notify(enum cpu_pm_event event, int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\t/*\n\t * __atomic_notifier_call_chain has a RCU read critical section, which\n\t * could be disfunctional in cpu idle. Copy RCU_NONIDLE code to let\n\t * RCU know this.\n\t */\n\trcu_irq_enter_irqson();\n\tret = __atomic_notifier_call_chain(&cpu_pm_notifier_chain, event, NULL,\n\t\tnr_to_call, nr_calls);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_pm_enter(void)\n{\n\tint nr_calls;\n\tint ret = 0;\n\n\tret = cpu_pm_notify(CPU_PM_ENTER, -1, &nr_calls);\n\tif (ret)\n\t\t/*\n\t\t * Inform listeners (nr_calls - 1) about failure of CPU PM\n\t\t * PM entry who are notified earlier to prepare for it.\n\t\t */\n\t\tcpu_pm_notify(CPU_PM_ENTER_FAILED, nr_calls - 1, NULL);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "cpu_pm_unregister_notifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
    "lines": "69-72",
    "snippet": "int cpu_pm_unregister_notifier(struct notifier_block *nb)\n{\n\treturn atomic_notifier_chain_unregister(&cpu_pm_notifier_chain, nb);\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_notifier_chain_unregister",
          "args": [
            "&cpu_pm_notifier_chain",
            "nb"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "atomic_notifier_chain_unregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/notifier.c",
          "lines": "143-154",
          "snippet": "int atomic_notifier_chain_unregister(struct atomic_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tunsigned long flags;\n\tint ret;\n\n\tspin_lock_irqsave(&nh->lock, flags);\n\tret = notifier_chain_unregister(&nh->head, n);\n\tspin_unlock_irqrestore(&nh->lock, flags);\n\tsynchronize_rcu();\n\treturn ret;\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint atomic_notifier_chain_unregister(struct atomic_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tunsigned long flags;\n\tint ret;\n\n\tspin_lock_irqsave(&nh->lock, flags);\n\tret = notifier_chain_unregister(&nh->head, n);\n\tspin_unlock_irqrestore(&nh->lock, flags);\n\tsynchronize_rcu();\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);\n\nint cpu_pm_unregister_notifier(struct notifier_block *nb)\n{\n\treturn atomic_notifier_chain_unregister(&cpu_pm_notifier_chain, nb);\n}"
  },
  {
    "function_name": "cpu_pm_register_notifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
    "lines": "54-57",
    "snippet": "int cpu_pm_register_notifier(struct notifier_block *nb)\n{\n\treturn atomic_notifier_chain_register(&cpu_pm_notifier_chain, nb);\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_notifier_chain_register",
          "args": [
            "&cpu_pm_notifier_chain",
            "nb"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "atomic_notifier_chain_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/notifier.c",
          "lines": "121-131",
          "snippet": "int atomic_notifier_chain_register(struct atomic_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tunsigned long flags;\n\tint ret;\n\n\tspin_lock_irqsave(&nh->lock, flags);\n\tret = notifier_chain_register(&nh->head, n);\n\tspin_unlock_irqrestore(&nh->lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint atomic_notifier_chain_register(struct atomic_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tunsigned long flags;\n\tint ret;\n\n\tspin_lock_irqsave(&nh->lock, flags);\n\tret = notifier_chain_register(&nh->head, n);\n\tspin_unlock_irqrestore(&nh->lock, flags);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);\n\nint cpu_pm_register_notifier(struct notifier_block *nb)\n{\n\treturn atomic_notifier_chain_register(&cpu_pm_notifier_chain, nb);\n}"
  },
  {
    "function_name": "cpu_pm_notify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/cpu_pm.c",
    "lines": "27-42",
    "snippet": "static int cpu_pm_notify(enum cpu_pm_event event, int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\t/*\n\t * __atomic_notifier_call_chain has a RCU read critical section, which\n\t * could be disfunctional in cpu idle. Copy RCU_NONIDLE code to let\n\t * RCU know this.\n\t */\n\trcu_irq_enter_irqson();\n\tret = __atomic_notifier_call_chain(&cpu_pm_notifier_chain, event, NULL,\n\t\tnr_to_call, nr_calls);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "notifier_to_errno",
          "args": [
            "ret"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_irq_exit_irqson",
          "args": [],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_irq_exit_irqson",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tree.c",
          "lines": "719-726",
          "snippet": "void rcu_irq_exit_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_exit();\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"tree_plugin.h\"",
            "#include \"tree_exp.h\"",
            "#include \"rcu.h\"",
            "#include \"tree.h\"",
            "#include <linux/tick.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/suspend.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/random.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/delay.h>",
            "#include <linux/prefetch.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/kthread.h>",
            "#include <linux/wait.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/time.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/completion.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tree_plugin.h\"\n#include \"tree_exp.h\"\n#include \"rcu.h\"\n#include \"tree.h\"\n#include <linux/tick.h>\n#include <linux/ftrace.h>\n#include <linux/suspend.h>\n#include <linux/trace_events.h>\n#include <linux/random.h>\n#include <linux/stop_machine.h>\n#include <linux/delay.h>\n#include <linux/prefetch.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/kthread.h>\n#include <linux/wait.h>\n#include <linux/kernel_stat.h>\n#include <linux/time.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/moduleparam.h>\n#include <linux/completion.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/nmi.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);\n\nvoid rcu_irq_exit_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_exit();\n\tlocal_irq_restore(flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__atomic_notifier_call_chain",
          "args": [
            "&cpu_pm_notifier_chain",
            "event",
            "NULL",
            "nr_to_call",
            "nr_calls"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "__atomic_notifier_call_chain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/notifier.c",
          "lines": "176-186",
          "snippet": "int __atomic_notifier_call_chain(struct atomic_notifier_head *nh,\n\t\t\t\t unsigned long val, void *v,\n\t\t\t\t int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\trcu_read_lock();\n\tret = notifier_call_chain(&nh->head, val, v, nr_to_call, nr_calls);\n\trcu_read_unlock();\n\treturn ret;\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint __atomic_notifier_call_chain(struct atomic_notifier_head *nh,\n\t\t\t\t unsigned long val, void *v,\n\t\t\t\t int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\trcu_read_lock();\n\tret = notifier_call_chain(&nh->head, val, v, nr_to_call, nr_calls);\n\trcu_read_unlock();\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_irq_enter_irqson",
          "args": [],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_irq_enter_irqson",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/rcu/tree.c",
          "lines": "884-891",
          "snippet": "void rcu_irq_enter_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_enter();\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"tree_plugin.h\"",
            "#include \"tree_exp.h\"",
            "#include \"rcu.h\"",
            "#include \"tree.h\"",
            "#include <linux/tick.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/suspend.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/random.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/delay.h>",
            "#include <linux/prefetch.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/kthread.h>",
            "#include <linux/wait.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/time.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/completion.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tree_plugin.h\"\n#include \"tree_exp.h\"\n#include \"rcu.h\"\n#include \"tree.h\"\n#include <linux/tick.h>\n#include <linux/ftrace.h>\n#include <linux/suspend.h>\n#include <linux/trace_events.h>\n#include <linux/random.h>\n#include <linux/stop_machine.h>\n#include <linux/delay.h>\n#include <linux/prefetch.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/kthread.h>\n#include <linux/wait.h>\n#include <linux/kernel_stat.h>\n#include <linux/time.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/moduleparam.h>\n#include <linux/completion.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/nmi.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);\n\nvoid rcu_irq_enter_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_enter();\n\tlocal_irq_restore(flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic ATOMIC_NOTIFIER_HEAD(cpu_pm_notifier_chain);\n\nstatic int cpu_pm_notify(enum cpu_pm_event event, int nr_to_call, int *nr_calls)\n{\n\tint ret;\n\n\t/*\n\t * __atomic_notifier_call_chain has a RCU read critical section, which\n\t * could be disfunctional in cpu idle. Copy RCU_NONIDLE code to let\n\t * RCU know this.\n\t */\n\trcu_irq_enter_irqson();\n\tret = __atomic_notifier_call_chain(&cpu_pm_notifier_chain, event, NULL,\n\t\tnr_to_call, nr_calls);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}"
  }
]