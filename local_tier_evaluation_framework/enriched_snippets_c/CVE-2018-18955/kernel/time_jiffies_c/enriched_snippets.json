[
  {
    "function_name": "register_refined_jiffies",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/jiffies.c",
    "lines": "110-136",
    "snippet": "int register_refined_jiffies(long cycles_per_second)\n{\n\tu64 nsec_per_tick, shift_hz;\n\tlong cycles_per_tick;\n\n\n\n\trefined_jiffies = clocksource_jiffies;\n\trefined_jiffies.name = \"refined-jiffies\";\n\trefined_jiffies.rating++;\n\n\t/* Calc cycles per tick */\n\tcycles_per_tick = (cycles_per_second + HZ/2)/HZ;\n\t/* shift_hz stores hz<<8 for extra accuracy */\n\tshift_hz = (u64)cycles_per_second << 8;\n\tshift_hz += cycles_per_tick/2;\n\tdo_div(shift_hz, cycles_per_tick);\n\t/* Calculate nsec_per_tick using shift_hz */\n\tnsec_per_tick = (u64)NSEC_PER_SEC << 8;\n\tnsec_per_tick += (u32)shift_hz/2;\n\tdo_div(nsec_per_tick, (u32)shift_hz);\n\n\trefined_jiffies.mult = ((u32)nsec_per_tick) << JIFFIES_SHIFT;\n\n\t__clocksource_register(&refined_jiffies);\n\treturn 0;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <linux/init.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/clocksource.h>"
    ],
    "macros_used": [
      "#define JIFFIES_SHIFT\t8",
      "#define JIFFIES_SHIFT\t7",
      "#define JIFFIES_SHIFT\t6"
    ],
    "globals_used": [
      "static struct clocksource clocksource_jiffies = {\n\t.name\t\t= \"jiffies\",\n\t.rating\t\t= 1, /* lowest valid rating*/\n\t.read\t\t= jiffies_read,\n\t.mask\t\t= CLOCKSOURCE_MASK(32),\n\t.mult\t\t= TICK_NSEC << JIFFIES_SHIFT, /* details above */\n\t.shift\t\t= JIFFIES_SHIFT,\n\t.max_cycles\t= 10,\n};",
      "struct clocksource refined_jiffies;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__clocksource_register",
          "args": [
            "&refined_jiffies"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "nsec_per_tick",
            "(u32)shift_hz"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "shift_hz",
            "cycles_per_tick"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/clocksource.h>\n\n#define JIFFIES_SHIFT\t8\n#define JIFFIES_SHIFT\t7\n#define JIFFIES_SHIFT\t6\n\nstatic struct clocksource clocksource_jiffies = {\n\t.name\t\t= \"jiffies\",\n\t.rating\t\t= 1, /* lowest valid rating*/\n\t.read\t\t= jiffies_read,\n\t.mask\t\t= CLOCKSOURCE_MASK(32),\n\t.mult\t\t= TICK_NSEC << JIFFIES_SHIFT, /* details above */\n\t.shift\t\t= JIFFIES_SHIFT,\n\t.max_cycles\t= 10,\n};\nstruct clocksource refined_jiffies;\n\nint register_refined_jiffies(long cycles_per_second)\n{\n\tu64 nsec_per_tick, shift_hz;\n\tlong cycles_per_tick;\n\n\n\n\trefined_jiffies = clocksource_jiffies;\n\trefined_jiffies.name = \"refined-jiffies\";\n\trefined_jiffies.rating++;\n\n\t/* Calc cycles per tick */\n\tcycles_per_tick = (cycles_per_second + HZ/2)/HZ;\n\t/* shift_hz stores hz<<8 for extra accuracy */\n\tshift_hz = (u64)cycles_per_second << 8;\n\tshift_hz += cycles_per_tick/2;\n\tdo_div(shift_hz, cycles_per_tick);\n\t/* Calculate nsec_per_tick using shift_hz */\n\tnsec_per_tick = (u64)NSEC_PER_SEC << 8;\n\tnsec_per_tick += (u32)shift_hz/2;\n\tdo_div(nsec_per_tick, (u32)shift_hz);\n\n\trefined_jiffies.mult = ((u32)nsec_per_tick) << JIFFIES_SHIFT;\n\n\t__clocksource_register(&refined_jiffies);\n\treturn 0;\n}"
  },
  {
    "function_name": "clocksource_default_clock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/jiffies.c",
    "lines": "103-106",
    "snippet": "__weak clocksource_default_clock(void)\n{\n\treturn &clocksource_jiffies;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <linux/init.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/clocksource.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct clocksource clocksource_jiffies = {\n\t.name\t\t= \"jiffies\",\n\t.rating\t\t= 1, /* lowest valid rating*/\n\t.read\t\t= jiffies_read,\n\t.mask\t\t= CLOCKSOURCE_MASK(32),\n\t.mult\t\t= TICK_NSEC << JIFFIES_SHIFT, /* details above */\n\t.shift\t\t= JIFFIES_SHIFT,\n\t.max_cycles\t= 10,\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/clocksource.h>\n\nstatic struct clocksource clocksource_jiffies = {\n\t.name\t\t= \"jiffies\",\n\t.rating\t\t= 1, /* lowest valid rating*/\n\t.read\t\t= jiffies_read,\n\t.mask\t\t= CLOCKSOURCE_MASK(32),\n\t.mult\t\t= TICK_NSEC << JIFFIES_SHIFT, /* details above */\n\t.shift\t\t= JIFFIES_SHIFT,\n\t.max_cycles\t= 10,\n};\n\n__weak clocksource_default_clock(void)\n{\n\treturn &clocksource_jiffies;\n}"
  },
  {
    "function_name": "init_jiffies_clocksource",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/jiffies.c",
    "lines": "96-99",
    "snippet": "static int __init init_jiffies_clocksource(void)\n{\n\treturn __clocksource_register(&clocksource_jiffies);\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <linux/init.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/clocksource.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct clocksource clocksource_jiffies = {\n\t.name\t\t= \"jiffies\",\n\t.rating\t\t= 1, /* lowest valid rating*/\n\t.read\t\t= jiffies_read,\n\t.mask\t\t= CLOCKSOURCE_MASK(32),\n\t.mult\t\t= TICK_NSEC << JIFFIES_SHIFT, /* details above */\n\t.shift\t\t= JIFFIES_SHIFT,\n\t.max_cycles\t= 10,\n};",
      "struct clocksource * __init"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__clocksource_register",
          "args": [
            "&clocksource_jiffies"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/clocksource.h>\n\nstatic struct clocksource clocksource_jiffies = {\n\t.name\t\t= \"jiffies\",\n\t.rating\t\t= 1, /* lowest valid rating*/\n\t.read\t\t= jiffies_read,\n\t.mask\t\t= CLOCKSOURCE_MASK(32),\n\t.mult\t\t= TICK_NSEC << JIFFIES_SHIFT, /* details above */\n\t.shift\t\t= JIFFIES_SHIFT,\n\t.max_cycles\t= 10,\n};\nstruct clocksource * __init;\n\nstatic int __init init_jiffies_clocksource(void)\n{\n\treturn __clocksource_register(&clocksource_jiffies);\n}"
  },
  {
    "function_name": "get_jiffies_64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/jiffies.c",
    "lines": "80-90",
    "snippet": "u64 get_jiffies_64(void)\n{\n\tunsigned long seq;\n\tu64 ret;\n\n\tdo {\n\t\tseq = read_seqbegin(&jiffies_lock);\n\t\tret = jiffies_64;\n\t} while (read_seqretry(&jiffies_lock, seq));\n\treturn ret;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <linux/init.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/clocksource.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__cacheline_aligned_in_smp DEFINE_SEQLOCK(jiffies_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "read_seqretry",
          "args": [
            "&jiffies_lock",
            "seq"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read_seqbegin",
          "args": [
            "&jiffies_lock"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/clocksource.h>\n\n__cacheline_aligned_in_smp DEFINE_SEQLOCK(jiffies_lock);\n\nu64 get_jiffies_64(void)\n{\n\tunsigned long seq;\n\tu64 ret;\n\n\tdo {\n\t\tseq = read_seqbegin(&jiffies_lock);\n\t\tret = jiffies_64;\n\t} while (read_seqretry(&jiffies_lock, seq));\n\treturn ret;\n}"
  },
  {
    "function_name": "jiffies_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/time/jiffies.c",
    "lines": "51-54",
    "snippet": "static u64 jiffies_read(struct clocksource *cs)\n{\n\treturn (u64) jiffies;\n}",
    "includes": [
      "#include \"timekeeping.h\"",
      "#include <linux/init.h>",
      "#include <linux/module.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/clocksource.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"timekeeping.h\"\n#include <linux/init.h>\n#include <linux/module.h>\n#include <linux/jiffies.h>\n#include <linux/clocksource.h>\n\nstatic u64 jiffies_read(struct clocksource *cs)\n{\n\treturn (u64) jiffies;\n}"
  }
]