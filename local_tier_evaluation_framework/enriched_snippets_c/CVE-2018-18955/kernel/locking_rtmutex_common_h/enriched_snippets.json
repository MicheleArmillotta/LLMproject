[
  {
    "function_name": "rt_mutex_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex_common.h",
    "lines": "108-113",
    "snippet": "static inline struct task_struct *rt_mutex_owner(struct rt_mutex *lock)\n{\n\tunsigned long owner = (unsigned long) READ_ONCE(lock->owner);\n\n\treturn (struct task_struct *) (owner & ~RT_MUTEX_HAS_WAITERS);\n}",
    "includes": [
      "# include \"rtmutex.h\"",
      "# include \"rtmutex-debug.h\"",
      "#include <linux/sched/wake_q.h>",
      "#include <linux/rtmutex.h>"
    ],
    "macros_used": [
      "#define RT_MUTEX_HAS_WAITERS\t1UL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "lock->owner"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"rtmutex.h\"\n# include \"rtmutex-debug.h\"\n#include <linux/sched/wake_q.h>\n#include <linux/rtmutex.h>\n\n#define RT_MUTEX_HAS_WAITERS\t1UL\n\nstatic inline struct task_struct *rt_mutex_owner(struct rt_mutex *lock)\n{\n\tunsigned long owner = (unsigned long) READ_ONCE(lock->owner);\n\n\treturn (struct task_struct *) (owner & ~RT_MUTEX_HAS_WAITERS);\n}"
  },
  {
    "function_name": "task_top_pi_waiter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex_common.h",
    "lines": "95-99",
    "snippet": "static inline struct rt_mutex_waiter *\ntask_top_pi_waiter(struct task_struct *p)\n{\n\treturn NULL;\n}",
    "includes": [
      "# include \"rtmutex.h\"",
      "# include \"rtmutex-debug.h\"",
      "#include <linux/sched/wake_q.h>",
      "#include <linux/rtmutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include \"rtmutex.h\"\n# include \"rtmutex-debug.h\"\n#include <linux/sched/wake_q.h>\n#include <linux/rtmutex.h>\n\nstatic inline struct rt_mutex_waiter *\ntask_top_pi_waiter(struct task_struct *p)\n{\n\treturn NULL;\n}"
  },
  {
    "function_name": "task_has_pi_waiters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex_common.h",
    "lines": "90-93",
    "snippet": "static inline int task_has_pi_waiters(struct task_struct *p)\n{\n\treturn false;\n}",
    "includes": [
      "# include \"rtmutex.h\"",
      "# include \"rtmutex-debug.h\"",
      "#include <linux/sched/wake_q.h>",
      "#include <linux/rtmutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include \"rtmutex.h\"\n# include \"rtmutex-debug.h\"\n#include <linux/sched/wake_q.h>\n#include <linux/rtmutex.h>\n\nstatic inline int task_has_pi_waiters(struct task_struct *p)\n{\n\treturn false;\n}"
  },
  {
    "function_name": "rt_mutex_top_waiter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex_common.h",
    "lines": "84-88",
    "snippet": "static inline struct rt_mutex_waiter *\nrt_mutex_top_waiter(struct rt_mutex *lock)\n{\n\treturn NULL;\n}",
    "includes": [
      "# include \"rtmutex.h\"",
      "# include \"rtmutex-debug.h\"",
      "#include <linux/sched/wake_q.h>",
      "#include <linux/rtmutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include \"rtmutex.h\"\n# include \"rtmutex-debug.h\"\n#include <linux/sched/wake_q.h>\n#include <linux/rtmutex.h>\n\nstatic inline struct rt_mutex_waiter *\nrt_mutex_top_waiter(struct rt_mutex *lock)\n{\n\treturn NULL;\n}"
  },
  {
    "function_name": "rt_mutex_has_waiters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex_common.h",
    "lines": "79-82",
    "snippet": "static inline int rt_mutex_has_waiters(struct rt_mutex *lock)\n{\n\treturn false;\n}",
    "includes": [
      "# include \"rtmutex.h\"",
      "# include \"rtmutex-debug.h\"",
      "#include <linux/sched/wake_q.h>",
      "#include <linux/rtmutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include \"rtmutex.h\"\n# include \"rtmutex-debug.h\"\n#include <linux/sched/wake_q.h>\n#include <linux/rtmutex.h>\n\nstatic inline int rt_mutex_has_waiters(struct rt_mutex *lock)\n{\n\treturn false;\n}"
  },
  {
    "function_name": "task_top_pi_waiter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex_common.h",
    "lines": "70-75",
    "snippet": "static inline struct rt_mutex_waiter *\ntask_top_pi_waiter(struct task_struct *p)\n{\n\treturn rb_entry(p->pi_waiters.rb_leftmost,\n\t\t\tstruct rt_mutex_waiter, pi_tree_entry);\n}",
    "includes": [
      "# include \"rtmutex.h\"",
      "# include \"rtmutex-debug.h\"",
      "#include <linux/sched/wake_q.h>",
      "#include <linux/rtmutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "p->pi_waiters.rb_leftmost",
            "structrt_mutex_waiter",
            "pi_tree_entry"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"rtmutex.h\"\n# include \"rtmutex-debug.h\"\n#include <linux/sched/wake_q.h>\n#include <linux/rtmutex.h>\n\nstatic inline struct rt_mutex_waiter *\ntask_top_pi_waiter(struct task_struct *p)\n{\n\treturn rb_entry(p->pi_waiters.rb_leftmost,\n\t\t\tstruct rt_mutex_waiter, pi_tree_entry);\n}"
  },
  {
    "function_name": "task_has_pi_waiters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex_common.h",
    "lines": "65-68",
    "snippet": "static inline int task_has_pi_waiters(struct task_struct *p)\n{\n\treturn !RB_EMPTY_ROOT(&p->pi_waiters.rb_root);\n}",
    "includes": [
      "# include \"rtmutex.h\"",
      "# include \"rtmutex-debug.h\"",
      "#include <linux/sched/wake_q.h>",
      "#include <linux/rtmutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RB_EMPTY_ROOT",
          "args": [
            "&p->pi_waiters.rb_root"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"rtmutex.h\"\n# include \"rtmutex-debug.h\"\n#include <linux/sched/wake_q.h>\n#include <linux/rtmutex.h>\n\nstatic inline int task_has_pi_waiters(struct task_struct *p)\n{\n\treturn !RB_EMPTY_ROOT(&p->pi_waiters.rb_root);\n}"
  },
  {
    "function_name": "rt_mutex_top_waiter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex_common.h",
    "lines": "52-63",
    "snippet": "static inline struct rt_mutex_waiter *\nrt_mutex_top_waiter(struct rt_mutex *lock)\n{\n\tstruct rb_node *leftmost = rb_first_cached(&lock->waiters);\n\tstruct rt_mutex_waiter *w = NULL;\n\n\tif (leftmost) {\n\t\tw = rb_entry(leftmost, struct rt_mutex_waiter, tree_entry);\n\t\tBUG_ON(w->lock != lock);\n\t}\n\treturn w;\n}",
    "includes": [
      "# include \"rtmutex.h\"",
      "# include \"rtmutex-debug.h\"",
      "#include <linux/sched/wake_q.h>",
      "#include <linux/rtmutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "w->lock != lock"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "leftmost",
            "structrt_mutex_waiter",
            "tree_entry"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_first_cached",
          "args": [
            "&lock->waiters"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"rtmutex.h\"\n# include \"rtmutex-debug.h\"\n#include <linux/sched/wake_q.h>\n#include <linux/rtmutex.h>\n\nstatic inline struct rt_mutex_waiter *\nrt_mutex_top_waiter(struct rt_mutex *lock)\n{\n\tstruct rb_node *leftmost = rb_first_cached(&lock->waiters);\n\tstruct rt_mutex_waiter *w = NULL;\n\n\tif (leftmost) {\n\t\tw = rb_entry(leftmost, struct rt_mutex_waiter, tree_entry);\n\t\tBUG_ON(w->lock != lock);\n\t}\n\treturn w;\n}"
  },
  {
    "function_name": "rt_mutex_has_waiters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18955/repo/kernel/locking/rtmutex_common.h",
    "lines": "47-50",
    "snippet": "static inline int rt_mutex_has_waiters(struct rt_mutex *lock)\n{\n\treturn !RB_EMPTY_ROOT(&lock->waiters.rb_root);\n}",
    "includes": [
      "# include \"rtmutex.h\"",
      "# include \"rtmutex-debug.h\"",
      "#include <linux/sched/wake_q.h>",
      "#include <linux/rtmutex.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RB_EMPTY_ROOT",
          "args": [
            "&lock->waiters.rb_root"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"rtmutex.h\"\n# include \"rtmutex-debug.h\"\n#include <linux/sched/wake_q.h>\n#include <linux/rtmutex.h>\n\nstatic inline int rt_mutex_has_waiters(struct rt_mutex *lock)\n{\n\treturn !RB_EMPTY_ROOT(&lock->waiters.rb_root);\n}"
  }
]