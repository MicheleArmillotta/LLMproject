[
  {
    "function_name": "aa_free_secid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/secid.c",
    "lines": "52-55",
    "snippet": "void aa_free_secid(u32 secid)\n{\n\t;\t\t\t/* NOP ATM */\n}",
    "includes": [
      "#include \"include/secid.h\"",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"include/secid.h\"\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/spinlock.h>\n\nvoid aa_free_secid(u32 secid)\n{\n\t;\t\t\t/* NOP ATM */\n}"
  },
  {
    "function_name": "aa_alloc_secid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/secid.c",
    "lines": "35-46",
    "snippet": "u32 aa_alloc_secid(void)\n{\n\tu32 secid;\n\n\t/*\n\t * TODO FIXME: secid recycling - part of profile mapping table\n\t */\n\tspin_lock(&secid_lock);\n\tsecid = (++global_secid);\n\tspin_unlock(&secid_lock);\n\treturn secid;\n}",
    "includes": [
      "#include \"include/secid.h\"",
      "#include <linux/err.h>",
      "#include <linux/errno.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u32 global_secid;",
      "static DEFINE_SPINLOCK(secid_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&secid_lock"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&secid_lock"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"include/secid.h\"\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/spinlock.h>\n\nstatic u32 global_secid;\nstatic DEFINE_SPINLOCK(secid_lock);\n\nu32 aa_alloc_secid(void)\n{\n\tu32 secid;\n\n\t/*\n\t * TODO FIXME: secid recycling - part of profile mapping table\n\t */\n\tspin_lock(&secid_lock);\n\tsecid = (++global_secid);\n\tspin_unlock(&secid_lock);\n\treturn secid;\n}"
  }
]