[
  {
    "function_name": "integrity_load_keys",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
    "lines": "208-212",
    "snippet": "void __init integrity_load_keys(void)\n{\n\tima_load_x509();\n\tevm_load_x509();\n}",
    "includes": [
      "#include \"integrity.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/file.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "evm_load_x509",
          "args": [],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "evm_load_x509",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/integrity.h",
          "lines": "172-174",
          "snippet": "static inline void evm_load_x509(void)\n{\n}",
          "includes": [
            "#include <linux/key.h>",
            "#include <crypto/sha.h>",
            "#include <linux/integrity.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/key.h>\n#include <crypto/sha.h>\n#include <linux/integrity.h>\n#include <linux/types.h>\n\nstatic inline void evm_load_x509(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "ima_load_x509",
          "args": [],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "ima_load_x509",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/integrity.h",
          "lines": "164-166",
          "snippet": "static inline void ima_load_x509(void)\n{\n}",
          "includes": [
            "#include <linux/key.h>",
            "#include <crypto/sha.h>",
            "#include <linux/integrity.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/key.h>\n#include <crypto/sha.h>\n#include <linux/integrity.h>\n#include <linux/types.h>\n\nstatic inline void ima_load_x509(void)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nvoid __init integrity_load_keys(void)\n{\n\tima_load_x509();\n\tevm_load_x509();\n}"
  },
  {
    "function_name": "integrity_kernel_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
    "lines": "184-200",
    "snippet": "int integrity_kernel_read(struct file *file, loff_t offset,\n\t\t\t  void *addr, unsigned long count)\n{\n\tmm_segment_t old_fs;\n\tchar __user *buf = (char __user *)addr;\n\tssize_t ret;\n\n\tif (!(file->f_mode & FMODE_READ))\n\t\treturn -EBADF;\n\n\told_fs = get_fs();\n\tset_fs(get_ds());\n\tret = __vfs_read(file, buf, count, &offset);\n\tset_fs(old_fs);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"integrity.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/file.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "old_fs"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__vfs_read",
          "args": [
            "file",
            "buf",
            "count",
            "&offset"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_fs",
          "args": [
            "get_ds()"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_ds",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_fs",
          "args": [],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nint integrity_kernel_read(struct file *file, loff_t offset,\n\t\t\t  void *addr, unsigned long count)\n{\n\tmm_segment_t old_fs;\n\tchar __user *buf = (char __user *)addr;\n\tssize_t ret;\n\n\tif (!(file->f_mode & FMODE_READ))\n\t\treturn -EBADF;\n\n\told_fs = get_fs();\n\tset_fs(get_ds());\n\tret = __vfs_read(file, buf, count, &offset);\n\tset_fs(old_fs);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "integrity_iintcache_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
    "lines": "166-172",
    "snippet": "static int __init integrity_iintcache_init(void)\n{\n\tiint_cache =\n\t    kmem_cache_create(\"iint_cache\", sizeof(struct integrity_iint_cache),\n\t\t\t      0, SLAB_PANIC, init_once);\n\treturn 0;\n}",
    "includes": [
      "#include \"integrity.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/file.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *iint_cache"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"iint_cache\"",
            "sizeof(struct integrity_iint_cache)",
            "0",
            "SLAB_PANIC",
            "init_once"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *iint_cache;\n\nstatic int __init integrity_iintcache_init(void)\n{\n\tiint_cache =\n\t    kmem_cache_create(\"iint_cache\", sizeof(struct integrity_iint_cache),\n\t\t\t      0, SLAB_PANIC, init_once);\n\treturn 0;\n}"
  },
  {
    "function_name": "init_once",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
    "lines": "151-164",
    "snippet": "static void init_once(void *foo)\n{\n\tstruct integrity_iint_cache *iint = foo;\n\n\tmemset(iint, 0, sizeof(*iint));\n\tiint->version = 0;\n\tiint->flags = 0UL;\n\tiint->ima_file_status = INTEGRITY_UNKNOWN;\n\tiint->ima_mmap_status = INTEGRITY_UNKNOWN;\n\tiint->ima_bprm_status = INTEGRITY_UNKNOWN;\n\tiint->ima_read_status = INTEGRITY_UNKNOWN;\n\tiint->evm_status = INTEGRITY_UNKNOWN;\n\tiint->measured_pcrs = 0;\n}",
    "includes": [
      "#include \"integrity.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/file.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "iint",
            "0",
            "sizeof(*iint)"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nstatic void init_once(void *foo)\n{\n\tstruct integrity_iint_cache *iint = foo;\n\n\tmemset(iint, 0, sizeof(*iint));\n\tiint->version = 0;\n\tiint->flags = 0UL;\n\tiint->ima_file_status = INTEGRITY_UNKNOWN;\n\tiint->ima_mmap_status = INTEGRITY_UNKNOWN;\n\tiint->ima_bprm_status = INTEGRITY_UNKNOWN;\n\tiint->ima_read_status = INTEGRITY_UNKNOWN;\n\tiint->evm_status = INTEGRITY_UNKNOWN;\n\tiint->measured_pcrs = 0;\n}"
  },
  {
    "function_name": "integrity_inode_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
    "lines": "136-149",
    "snippet": "void integrity_inode_free(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\n\tif (!IS_IMA(inode))\n\t\treturn;\n\n\twrite_lock(&integrity_iint_lock);\n\tiint = __integrity_iint_find(inode);\n\trb_erase(&iint->rb_node, &integrity_iint_tree);\n\twrite_unlock(&integrity_iint_lock);\n\n\tiint_free(iint);\n}",
    "includes": [
      "#include \"integrity.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/file.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rb_root integrity_iint_tree = RB_ROOT;",
      "static DEFINE_RWLOCK(integrity_iint_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "iint_free",
          "args": [
            "iint"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "iint_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
          "lines": "71-84",
          "snippet": "static void iint_free(struct integrity_iint_cache *iint)\n{\n\tkfree(iint->ima_hash);\n\tiint->ima_hash = NULL;\n\tiint->version = 0;\n\tiint->flags = 0UL;\n\tiint->ima_file_status = INTEGRITY_UNKNOWN;\n\tiint->ima_mmap_status = INTEGRITY_UNKNOWN;\n\tiint->ima_bprm_status = INTEGRITY_UNKNOWN;\n\tiint->ima_read_status = INTEGRITY_UNKNOWN;\n\tiint->evm_status = INTEGRITY_UNKNOWN;\n\tiint->measured_pcrs = 0;\n\tkmem_cache_free(iint_cache, iint);\n}",
          "includes": [
            "#include \"integrity.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *iint_cache"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *iint_cache;\n\nstatic void iint_free(struct integrity_iint_cache *iint)\n{\n\tkfree(iint->ima_hash);\n\tiint->ima_hash = NULL;\n\tiint->version = 0;\n\tiint->flags = 0UL;\n\tiint->ima_file_status = INTEGRITY_UNKNOWN;\n\tiint->ima_mmap_status = INTEGRITY_UNKNOWN;\n\tiint->ima_bprm_status = INTEGRITY_UNKNOWN;\n\tiint->ima_read_status = INTEGRITY_UNKNOWN;\n\tiint->evm_status = INTEGRITY_UNKNOWN;\n\tiint->measured_pcrs = 0;\n\tkmem_cache_free(iint_cache, iint);\n}"
        }
      },
      {
        "call_info": {
          "callee": "write_unlock",
          "args": [
            "&integrity_iint_lock"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_erase",
          "args": [
            "&iint->rb_node",
            "&integrity_iint_tree"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__integrity_iint_find",
          "args": [
            "inode"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "__integrity_iint_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
          "lines": "33-52",
          "snippet": "static struct integrity_iint_cache *__integrity_iint_find(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\tstruct rb_node *n = integrity_iint_tree.rb_node;\n\n\twhile (n) {\n\t\tiint = rb_entry(n, struct integrity_iint_cache, rb_node);\n\n\t\tif (inode < iint->inode)\n\t\t\tn = n->rb_left;\n\t\telse if (inode > iint->inode)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\tbreak;\n\t}\n\tif (!n)\n\t\treturn NULL;\n\n\treturn iint;\n}",
          "includes": [
            "#include \"integrity.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct rb_root integrity_iint_tree = RB_ROOT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nstatic struct rb_root integrity_iint_tree = RB_ROOT;\n\nstatic struct integrity_iint_cache *__integrity_iint_find(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\tstruct rb_node *n = integrity_iint_tree.rb_node;\n\n\twhile (n) {\n\t\tiint = rb_entry(n, struct integrity_iint_cache, rb_node);\n\n\t\tif (inode < iint->inode)\n\t\t\tn = n->rb_left;\n\t\telse if (inode > iint->inode)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\tbreak;\n\t}\n\tif (!n)\n\t\treturn NULL;\n\n\treturn iint;\n}"
        }
      },
      {
        "call_info": {
          "callee": "write_lock",
          "args": [
            "&integrity_iint_lock"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_IMA",
          "args": [
            "inode"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nstatic struct rb_root integrity_iint_tree = RB_ROOT;\nstatic DEFINE_RWLOCK(integrity_iint_lock);\n\nvoid integrity_inode_free(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\n\tif (!IS_IMA(inode))\n\t\treturn;\n\n\twrite_lock(&integrity_iint_lock);\n\tiint = __integrity_iint_find(inode);\n\trb_erase(&iint->rb_node, &integrity_iint_tree);\n\twrite_unlock(&integrity_iint_lock);\n\n\tiint_free(iint);\n}"
  },
  {
    "function_name": "integrity_inode_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
    "lines": "93-128",
    "snippet": "struct integrity_iint_cache *integrity_inode_get(struct inode *inode)\n{\n\tstruct rb_node **p;\n\tstruct rb_node *node, *parent = NULL;\n\tstruct integrity_iint_cache *iint, *test_iint;\n\n\tiint = integrity_iint_find(inode);\n\tif (iint)\n\t\treturn iint;\n\n\tiint = kmem_cache_alloc(iint_cache, GFP_NOFS);\n\tif (!iint)\n\t\treturn NULL;\n\n\twrite_lock(&integrity_iint_lock);\n\n\tp = &integrity_iint_tree.rb_node;\n\twhile (*p) {\n\t\tparent = *p;\n\t\ttest_iint = rb_entry(parent, struct integrity_iint_cache,\n\t\t\t\t     rb_node);\n\t\tif (inode < test_iint->inode)\n\t\t\tp = &(*p)->rb_left;\n\t\telse\n\t\t\tp = &(*p)->rb_right;\n\t}\n\n\tiint->inode = inode;\n\tnode = &iint->rb_node;\n\tinode->i_flags |= S_IMA;\n\trb_link_node(node, parent, p);\n\trb_insert_color(node, &integrity_iint_tree);\n\n\twrite_unlock(&integrity_iint_lock);\n\treturn iint;\n}",
    "includes": [
      "#include \"integrity.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/file.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rb_root integrity_iint_tree = RB_ROOT;",
      "static DEFINE_RWLOCK(integrity_iint_lock);",
      "static struct kmem_cache *iint_cache"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_unlock",
          "args": [
            "&integrity_iint_lock"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_insert_color",
          "args": [
            "node",
            "&integrity_iint_tree"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_link_node",
          "args": [
            "node",
            "parent",
            "p"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "parent",
            "structintegrity_iint_cache",
            "rb_node"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "write_lock",
          "args": [
            "&integrity_iint_lock"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "iint_cache",
            "GFP_NOFS"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "integrity_iint_find",
          "args": [
            "inode"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "integrity_iint_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
          "lines": "57-69",
          "snippet": "struct integrity_iint_cache *integrity_iint_find(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\n\tif (!IS_IMA(inode))\n\t\treturn NULL;\n\n\tread_lock(&integrity_iint_lock);\n\tiint = __integrity_iint_find(inode);\n\tread_unlock(&integrity_iint_lock);\n\n\treturn iint;\n}",
          "includes": [
            "#include \"integrity.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_RWLOCK(integrity_iint_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nstatic DEFINE_RWLOCK(integrity_iint_lock);\n\nstruct integrity_iint_cache *integrity_iint_find(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\n\tif (!IS_IMA(inode))\n\t\treturn NULL;\n\n\tread_lock(&integrity_iint_lock);\n\tiint = __integrity_iint_find(inode);\n\tread_unlock(&integrity_iint_lock);\n\n\treturn iint;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nstatic struct rb_root integrity_iint_tree = RB_ROOT;\nstatic DEFINE_RWLOCK(integrity_iint_lock);\nstatic struct kmem_cache *iint_cache;\n\nstruct integrity_iint_cache *integrity_inode_get(struct inode *inode)\n{\n\tstruct rb_node **p;\n\tstruct rb_node *node, *parent = NULL;\n\tstruct integrity_iint_cache *iint, *test_iint;\n\n\tiint = integrity_iint_find(inode);\n\tif (iint)\n\t\treturn iint;\n\n\tiint = kmem_cache_alloc(iint_cache, GFP_NOFS);\n\tif (!iint)\n\t\treturn NULL;\n\n\twrite_lock(&integrity_iint_lock);\n\n\tp = &integrity_iint_tree.rb_node;\n\twhile (*p) {\n\t\tparent = *p;\n\t\ttest_iint = rb_entry(parent, struct integrity_iint_cache,\n\t\t\t\t     rb_node);\n\t\tif (inode < test_iint->inode)\n\t\t\tp = &(*p)->rb_left;\n\t\telse\n\t\t\tp = &(*p)->rb_right;\n\t}\n\n\tiint->inode = inode;\n\tnode = &iint->rb_node;\n\tinode->i_flags |= S_IMA;\n\trb_link_node(node, parent, p);\n\trb_insert_color(node, &integrity_iint_tree);\n\n\twrite_unlock(&integrity_iint_lock);\n\treturn iint;\n}"
  },
  {
    "function_name": "iint_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
    "lines": "71-84",
    "snippet": "static void iint_free(struct integrity_iint_cache *iint)\n{\n\tkfree(iint->ima_hash);\n\tiint->ima_hash = NULL;\n\tiint->version = 0;\n\tiint->flags = 0UL;\n\tiint->ima_file_status = INTEGRITY_UNKNOWN;\n\tiint->ima_mmap_status = INTEGRITY_UNKNOWN;\n\tiint->ima_bprm_status = INTEGRITY_UNKNOWN;\n\tiint->ima_read_status = INTEGRITY_UNKNOWN;\n\tiint->evm_status = INTEGRITY_UNKNOWN;\n\tiint->measured_pcrs = 0;\n\tkmem_cache_free(iint_cache, iint);\n}",
    "includes": [
      "#include \"integrity.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/file.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *iint_cache"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "iint_cache",
            "iint"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "iint->ima_hash"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nstatic struct kmem_cache *iint_cache;\n\nstatic void iint_free(struct integrity_iint_cache *iint)\n{\n\tkfree(iint->ima_hash);\n\tiint->ima_hash = NULL;\n\tiint->version = 0;\n\tiint->flags = 0UL;\n\tiint->ima_file_status = INTEGRITY_UNKNOWN;\n\tiint->ima_mmap_status = INTEGRITY_UNKNOWN;\n\tiint->ima_bprm_status = INTEGRITY_UNKNOWN;\n\tiint->ima_read_status = INTEGRITY_UNKNOWN;\n\tiint->evm_status = INTEGRITY_UNKNOWN;\n\tiint->measured_pcrs = 0;\n\tkmem_cache_free(iint_cache, iint);\n}"
  },
  {
    "function_name": "integrity_iint_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
    "lines": "57-69",
    "snippet": "struct integrity_iint_cache *integrity_iint_find(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\n\tif (!IS_IMA(inode))\n\t\treturn NULL;\n\n\tread_lock(&integrity_iint_lock);\n\tiint = __integrity_iint_find(inode);\n\tread_unlock(&integrity_iint_lock);\n\n\treturn iint;\n}",
    "includes": [
      "#include \"integrity.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/file.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_RWLOCK(integrity_iint_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "read_unlock",
          "args": [
            "&integrity_iint_lock"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_read_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/common.h",
          "lines": "1108-1111",
          "snippet": "static inline void tomoyo_read_unlock(int idx)\n{\n\tsrcu_read_unlock(&tomoyo_ss, idx);\n}",
          "includes": [
            "#include <net/udp.h>",
            "#include <net/ipv6.h>",
            "#include <net/ip.h>",
            "#include <net/af_unix.h>",
            "#include <net/sock.h>",
            "#include <linux/un.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/inet.h>",
            "#include <linux/net.h>",
            "#include <linux/highmem.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/poll.h>",
            "#include <linux/cred.h>",
            "#include <linux/list.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/file.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <net/udp.h>\n#include <net/ipv6.h>\n#include <net/ip.h>\n#include <net/af_unix.h>\n#include <net/sock.h>\n#include <linux/un.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/inet.h>\n#include <linux/net.h>\n#include <linux/highmem.h>\n#include <linux/binfmts.h>\n#include <linux/poll.h>\n#include <linux/cred.h>\n#include <linux/list.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/file.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/ctype.h>\n\nstatic inline void tomoyo_read_unlock(int idx)\n{\n\tsrcu_read_unlock(&tomoyo_ss, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__integrity_iint_find",
          "args": [
            "inode"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "__integrity_iint_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
          "lines": "33-52",
          "snippet": "static struct integrity_iint_cache *__integrity_iint_find(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\tstruct rb_node *n = integrity_iint_tree.rb_node;\n\n\twhile (n) {\n\t\tiint = rb_entry(n, struct integrity_iint_cache, rb_node);\n\n\t\tif (inode < iint->inode)\n\t\t\tn = n->rb_left;\n\t\telse if (inode > iint->inode)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\tbreak;\n\t}\n\tif (!n)\n\t\treturn NULL;\n\n\treturn iint;\n}",
          "includes": [
            "#include \"integrity.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/module.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct rb_root integrity_iint_tree = RB_ROOT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nstatic struct rb_root integrity_iint_tree = RB_ROOT;\n\nstatic struct integrity_iint_cache *__integrity_iint_find(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\tstruct rb_node *n = integrity_iint_tree.rb_node;\n\n\twhile (n) {\n\t\tiint = rb_entry(n, struct integrity_iint_cache, rb_node);\n\n\t\tif (inode < iint->inode)\n\t\t\tn = n->rb_left;\n\t\telse if (inode > iint->inode)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\tbreak;\n\t}\n\tif (!n)\n\t\treturn NULL;\n\n\treturn iint;\n}"
        }
      },
      {
        "call_info": {
          "callee": "read_lock",
          "args": [
            "&integrity_iint_lock"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_IMA",
          "args": [
            "inode"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nstatic DEFINE_RWLOCK(integrity_iint_lock);\n\nstruct integrity_iint_cache *integrity_iint_find(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\n\tif (!IS_IMA(inode))\n\t\treturn NULL;\n\n\tread_lock(&integrity_iint_lock);\n\tiint = __integrity_iint_find(inode);\n\tread_unlock(&integrity_iint_lock);\n\n\treturn iint;\n}"
  },
  {
    "function_name": "__integrity_iint_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/iint.c",
    "lines": "33-52",
    "snippet": "static struct integrity_iint_cache *__integrity_iint_find(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\tstruct rb_node *n = integrity_iint_tree.rb_node;\n\n\twhile (n) {\n\t\tiint = rb_entry(n, struct integrity_iint_cache, rb_node);\n\n\t\tif (inode < iint->inode)\n\t\t\tn = n->rb_left;\n\t\telse if (inode > iint->inode)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\tbreak;\n\t}\n\tif (!n)\n\t\treturn NULL;\n\n\treturn iint;\n}",
    "includes": [
      "#include \"integrity.h\"",
      "#include <linux/uaccess.h>",
      "#include <linux/file.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/module.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rb_root integrity_iint_tree = RB_ROOT;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "n",
            "structintegrity_iint_cache",
            "rb_node"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"integrity.h\"\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/rbtree.h>\n#include <linux/spinlock.h>\n#include <linux/module.h>\n#include <linux/slab.h>\n\nstatic struct rb_root integrity_iint_tree = RB_ROOT;\n\nstatic struct integrity_iint_cache *__integrity_iint_find(struct inode *inode)\n{\n\tstruct integrity_iint_cache *iint;\n\tstruct rb_node *n = integrity_iint_tree.rb_node;\n\n\twhile (n) {\n\t\tiint = rb_entry(n, struct integrity_iint_cache, rb_node);\n\n\t\tif (inode < iint->inode)\n\t\t\tn = n->rb_left;\n\t\telse if (inode > iint->inode)\n\t\t\tn = n->rb_right;\n\t\telse\n\t\t\tbreak;\n\t}\n\tif (!n)\n\t\treturn NULL;\n\n\treturn iint;\n}"
  }
]