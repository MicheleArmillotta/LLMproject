[
  {
    "function_name": "aa_lookup_ns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_ns.h",
    "lines": "163-166",
    "snippet": "static inline struct aa_ns *aa_lookup_ns(struct aa_ns *view, const char *name)\n{\n\treturn aa_lookupn_ns(view, name, strlen(name));\n}",
    "includes": [
      "#include \"policy.h\"",
      "#include \"label.h\"",
      "#include \"apparmorfs.h\"",
      "#include \"apparmor.h\"",
      "#include <linux/kref.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aa_lookupn_ns",
          "args": [
            "view",
            "name",
            "strlen(name)"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "aa_lookupn_ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/policy_ns.c",
          "lines": "235-244",
          "snippet": "struct aa_ns *aa_lookupn_ns(struct aa_ns *view, const char *name, size_t n)\n{\n\tstruct aa_ns *ns = NULL;\n\n\trcu_read_lock();\n\tns = aa_get_ns(__aa_lookupn_ns(view, name, n));\n\trcu_read_unlock();\n\n\treturn ns;\n}",
          "includes": [
            "#include \"include/policy.h\"",
            "#include \"include/label.h\"",
            "#include \"include/policy_ns.h\"",
            "#include \"include/context.h\"",
            "#include \"include/apparmor.h\"",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/mutex.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"include/policy.h\"\n#include \"include/label.h\"\n#include \"include/policy_ns.h\"\n#include \"include/context.h\"\n#include \"include/apparmor.h\"\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/mutex.h>\n#include <linux/list.h>\n\nstruct aa_ns *aa_lookupn_ns(struct aa_ns *view, const char *name, size_t n)\n{\n\tstruct aa_ns *ns = NULL;\n\n\trcu_read_lock();\n\tns = aa_get_ns(__aa_lookupn_ns(view, name, n));\n\trcu_read_unlock();\n\n\treturn ns;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"policy.h\"\n#include \"label.h\"\n#include \"apparmorfs.h\"\n#include \"apparmor.h\"\n#include <linux/kref.h>\n\nstatic inline struct aa_ns *aa_lookup_ns(struct aa_ns *view, const char *name)\n{\n\treturn aa_lookupn_ns(view, name, strlen(name));\n}"
  },
  {
    "function_name": "__aa_lookup_ns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_ns.h",
    "lines": "157-161",
    "snippet": "static inline struct aa_ns *__aa_lookup_ns(struct aa_ns *base,\n\t\t\t\t\t   const char *hname)\n{\n\treturn __aa_lookupn_ns(base, hname, strlen(hname));\n}",
    "includes": [
      "#include \"policy.h\"",
      "#include \"label.h\"",
      "#include \"apparmorfs.h\"",
      "#include \"apparmor.h\"",
      "#include <linux/kref.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__aa_lookupn_ns",
          "args": [
            "base",
            "hname",
            "strlen(hname)"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "__aa_lookupn_ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/policy_ns.c",
          "lines": "204-222",
          "snippet": "struct aa_ns *__aa_lookupn_ns(struct aa_ns *view, const char *hname, size_t n)\n{\n\tstruct aa_ns *ns = view;\n\tconst char *split;\n\n\tfor (split = strnstr(hname, \"//\", n); split;\n\t     split = strnstr(hname, \"//\", n)) {\n\t\tns = __aa_findn_ns(&ns->sub_ns, hname, split - hname);\n\t\tif (!ns)\n\t\t\treturn NULL;\n\n\t\tn -= split + 2 - hname;\n\t\thname = split + 2;\n\t}\n\n\tif (n)\n\t\treturn __aa_findn_ns(&ns->sub_ns, hname, n);\n\treturn NULL;\n}",
          "includes": [
            "#include \"include/policy.h\"",
            "#include \"include/label.h\"",
            "#include \"include/policy_ns.h\"",
            "#include \"include/context.h\"",
            "#include \"include/apparmor.h\"",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/mutex.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"include/policy.h\"\n#include \"include/label.h\"\n#include \"include/policy_ns.h\"\n#include \"include/context.h\"\n#include \"include/apparmor.h\"\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/mutex.h>\n#include <linux/list.h>\n\nstruct aa_ns *__aa_lookupn_ns(struct aa_ns *view, const char *hname, size_t n)\n{\n\tstruct aa_ns *ns = view;\n\tconst char *split;\n\n\tfor (split = strnstr(hname, \"//\", n); split;\n\t     split = strnstr(hname, \"//\", n)) {\n\t\tns = __aa_findn_ns(&ns->sub_ns, hname, split - hname);\n\t\tif (!ns)\n\t\t\treturn NULL;\n\n\t\tn -= split + 2 - hname;\n\t\thname = split + 2;\n\t}\n\n\tif (n)\n\t\treturn __aa_findn_ns(&ns->sub_ns, hname, n);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "hname"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"policy.h\"\n#include \"label.h\"\n#include \"apparmorfs.h\"\n#include \"apparmor.h\"\n#include <linux/kref.h>\n\nstatic inline struct aa_ns *__aa_lookup_ns(struct aa_ns *base,\n\t\t\t\t\t   const char *hname)\n{\n\treturn __aa_lookupn_ns(base, hname, strlen(hname));\n}"
  },
  {
    "function_name": "__aa_find_ns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_ns.h",
    "lines": "151-155",
    "snippet": "static inline struct aa_ns *__aa_find_ns(struct list_head *head,\n\t\t\t\t\t const char *name)\n{\n\treturn __aa_findn_ns(head, name, strlen(name));\n}",
    "includes": [
      "#include \"policy.h\"",
      "#include \"label.h\"",
      "#include \"apparmorfs.h\"",
      "#include \"apparmor.h\"",
      "#include <linux/kref.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__aa_findn_ns",
          "args": [
            "head",
            "name",
            "strlen(name)"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "__aa_findn_ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_ns.h",
          "lines": "145-149",
          "snippet": "static inline struct aa_ns *__aa_findn_ns(struct list_head *head,\n\t\t\t\t\t  const char *name, size_t n)\n{\n\treturn (struct aa_ns *)__policy_strn_find(head, name, n);\n}",
          "includes": [
            "#include \"policy.h\"",
            "#include \"label.h\"",
            "#include \"apparmorfs.h\"",
            "#include \"apparmor.h\"",
            "#include <linux/kref.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"policy.h\"\n#include \"label.h\"\n#include \"apparmorfs.h\"\n#include \"apparmor.h\"\n#include <linux/kref.h>\n\nstatic inline struct aa_ns *__aa_findn_ns(struct list_head *head,\n\t\t\t\t\t  const char *name, size_t n)\n{\n\treturn (struct aa_ns *)__policy_strn_find(head, name, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"policy.h\"\n#include \"label.h\"\n#include \"apparmorfs.h\"\n#include \"apparmor.h\"\n#include <linux/kref.h>\n\nstatic inline struct aa_ns *__aa_find_ns(struct list_head *head,\n\t\t\t\t\t const char *name)\n{\n\treturn __aa_findn_ns(head, name, strlen(name));\n}"
  },
  {
    "function_name": "__aa_findn_ns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_ns.h",
    "lines": "145-149",
    "snippet": "static inline struct aa_ns *__aa_findn_ns(struct list_head *head,\n\t\t\t\t\t  const char *name, size_t n)\n{\n\treturn (struct aa_ns *)__policy_strn_find(head, name, n);\n}",
    "includes": [
      "#include \"policy.h\"",
      "#include \"label.h\"",
      "#include \"apparmorfs.h\"",
      "#include \"apparmor.h\"",
      "#include <linux/kref.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__policy_strn_find",
          "args": [
            "head",
            "name",
            "n"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "__policy_strn_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/lib.h",
          "lines": "186-197",
          "snippet": "static inline struct aa_policy *__policy_strn_find(struct list_head *head,\n\t\t\t\t\t    const char *str, int len)\n{\n\tstruct aa_policy *policy;\n\n\tlist_for_each_entry_rcu(policy, head, list) {\n\t\tif (aa_strneq(policy->name, str, len))\n\t\t\treturn policy;\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"match.h\"",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"match.h\"\n#include <linux/fs.h>\n#include <linux/slab.h>\n\nstatic inline struct aa_policy *__policy_strn_find(struct list_head *head,\n\t\t\t\t\t    const char *str, int len)\n{\n\tstruct aa_policy *policy;\n\n\tlist_for_each_entry_rcu(policy, head, list) {\n\t\tif (aa_strneq(policy->name, str, len))\n\t\t\treturn policy;\n\t}\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"policy.h\"\n#include \"label.h\"\n#include \"apparmorfs.h\"\n#include \"apparmor.h\"\n#include <linux/kref.h>\n\nstatic inline struct aa_ns *__aa_findn_ns(struct list_head *head,\n\t\t\t\t\t  const char *name, size_t n)\n{\n\treturn (struct aa_ns *)__policy_strn_find(head, name, n);\n}"
  },
  {
    "function_name": "aa_put_ns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_ns.h",
    "lines": "130-134",
    "snippet": "static inline void aa_put_ns(struct aa_ns *ns)\n{\n\tif (ns)\n\t\taa_put_profile(ns->unconfined);\n}",
    "includes": [
      "#include \"policy.h\"",
      "#include \"label.h\"",
      "#include \"apparmorfs.h\"",
      "#include \"apparmor.h\"",
      "#include <linux/kref.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aa_put_profile",
          "args": [
            "ns->unconfined"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "aa_put_profile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy.h",
          "lines": "277-281",
          "snippet": "static inline void aa_put_profile(struct aa_profile *p)\n{\n\tif (p)\n\t\tkref_put(&p->label.count, aa_label_kref);\n}",
          "includes": [
            "#include \"resource.h\"",
            "#include \"perms.h\"",
            "#include \"label.h\"",
            "#include \"lib.h\"",
            "#include \"file.h\"",
            "#include \"domain.h\"",
            "#include \"capability.h\"",
            "#include \"audit.h\"",
            "#include \"apparmor.h\"",
            "#include <linux/socket.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/rhashtable.h>",
            "#include <linux/kref.h>",
            "#include <linux/cred.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"resource.h\"\n#include \"perms.h\"\n#include \"label.h\"\n#include \"lib.h\"\n#include \"file.h\"\n#include \"domain.h\"\n#include \"capability.h\"\n#include \"audit.h\"\n#include \"apparmor.h\"\n#include <linux/socket.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/rhashtable.h>\n#include <linux/kref.h>\n#include <linux/cred.h>\n#include <linux/capability.h>\n\nstatic inline void aa_put_profile(struct aa_profile *p)\n{\n\tif (p)\n\t\tkref_put(&p->label.count, aa_label_kref);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"policy.h\"\n#include \"label.h\"\n#include \"apparmorfs.h\"\n#include \"apparmor.h\"\n#include <linux/kref.h>\n\nstatic inline void aa_put_ns(struct aa_ns *ns)\n{\n\tif (ns)\n\t\taa_put_profile(ns->unconfined);\n}"
  },
  {
    "function_name": "aa_get_ns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_ns.h",
    "lines": "116-122",
    "snippet": "static inline struct aa_ns *aa_get_ns(struct aa_ns *ns)\n{\n\tif (ns)\n\t\taa_get_profile(ns->unconfined);\n\n\treturn ns;\n}",
    "includes": [
      "#include \"policy.h\"",
      "#include \"label.h\"",
      "#include \"apparmorfs.h\"",
      "#include \"apparmor.h\"",
      "#include <linux/kref.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aa_get_profile",
          "args": [
            "ns->unconfined"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "aa_get_profile_rcu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy.h",
          "lines": "260-271",
          "snippet": "static inline struct aa_profile *aa_get_profile_rcu(struct aa_profile __rcu **p)\n{\n\tstruct aa_profile *c;\n\n\trcu_read_lock();\n\tdo {\n\t\tc = rcu_dereference(*p);\n\t} while (c && !kref_get_unless_zero(&c->label.count));\n\trcu_read_unlock();\n\n\treturn c;\n}",
          "includes": [
            "#include \"resource.h\"",
            "#include \"perms.h\"",
            "#include \"label.h\"",
            "#include \"lib.h\"",
            "#include \"file.h\"",
            "#include \"domain.h\"",
            "#include \"capability.h\"",
            "#include \"audit.h\"",
            "#include \"apparmor.h\"",
            "#include <linux/socket.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/rhashtable.h>",
            "#include <linux/kref.h>",
            "#include <linux/cred.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"resource.h\"\n#include \"perms.h\"\n#include \"label.h\"\n#include \"lib.h\"\n#include \"file.h\"\n#include \"domain.h\"\n#include \"capability.h\"\n#include \"audit.h\"\n#include \"apparmor.h\"\n#include <linux/socket.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/rhashtable.h>\n#include <linux/kref.h>\n#include <linux/cred.h>\n#include <linux/capability.h>\n\nstatic inline struct aa_profile *aa_get_profile_rcu(struct aa_profile __rcu **p)\n{\n\tstruct aa_profile *c;\n\n\trcu_read_lock();\n\tdo {\n\t\tc = rcu_dereference(*p);\n\t} while (c && !kref_get_unless_zero(&c->label.count));\n\trcu_read_unlock();\n\n\treturn c;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"policy.h\"\n#include \"label.h\"\n#include \"apparmorfs.h\"\n#include \"apparmor.h\"\n#include <linux/kref.h>\n\nstatic inline struct aa_ns *aa_get_ns(struct aa_ns *ns)\n{\n\tif (ns)\n\t\taa_get_profile(ns->unconfined);\n\n\treturn ns;\n}"
  },
  {
    "function_name": "aa_deref_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_ns.h",
    "lines": "103-107",
    "snippet": "static inline struct aa_profile *aa_deref_parent(struct aa_profile *p)\n{\n\treturn rcu_dereference_protected(p->parent,\n\t\t\t\t\t mutex_is_locked(&p->ns->lock));\n}",
    "includes": [
      "#include \"policy.h\"",
      "#include \"label.h\"",
      "#include \"apparmorfs.h\"",
      "#include \"apparmor.h\"",
      "#include <linux/kref.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_dereference_protected",
          "args": [
            "p->parent",
            "mutex_is_locked(&p->ns->lock)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_is_locked",
          "args": [
            "&p->ns->lock"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"policy.h\"\n#include \"label.h\"\n#include \"apparmorfs.h\"\n#include \"apparmor.h\"\n#include <linux/kref.h>\n\nstatic inline struct aa_profile *aa_deref_parent(struct aa_profile *p)\n{\n\treturn rcu_dereference_protected(p->parent,\n\t\t\t\t\t mutex_is_locked(&p->ns->lock));\n}"
  }
]