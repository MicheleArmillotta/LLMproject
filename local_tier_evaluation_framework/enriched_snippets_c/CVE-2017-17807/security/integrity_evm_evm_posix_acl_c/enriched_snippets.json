[
  {
    "function_name": "posix_xattr_acl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/integrity/evm/evm_posix_acl.c",
    "lines": "16-27",
    "snippet": "int posix_xattr_acl(const char *xattr)\n{\n\tint xattr_len = strlen(xattr);\n\n\tif ((strlen(XATTR_NAME_POSIX_ACL_ACCESS) == xattr_len)\n\t     && (strncmp(XATTR_NAME_POSIX_ACL_ACCESS, xattr, xattr_len) == 0))\n\t\treturn 1;\n\tif ((strlen(XATTR_NAME_POSIX_ACL_DEFAULT) == xattr_len)\n\t     && (strncmp(XATTR_NAME_POSIX_ACL_DEFAULT, xattr, xattr_len) == 0))\n\t\treturn 1;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/evm.h>",
      "#include <linux/xattr.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "XATTR_NAME_POSIX_ACL_DEFAULT",
            "xattr",
            "xattr_len"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "XATTR_NAME_POSIX_ACL_DEFAULT"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "XATTR_NAME_POSIX_ACL_ACCESS",
            "xattr",
            "xattr_len"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "XATTR_NAME_POSIX_ACL_ACCESS"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "xattr"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/evm.h>\n#include <linux/xattr.h>\n#include <linux/module.h>\n\nint posix_xattr_acl(const char *xattr)\n{\n\tint xattr_len = strlen(xattr);\n\n\tif ((strlen(XATTR_NAME_POSIX_ACL_ACCESS) == xattr_len)\n\t     && (strncmp(XATTR_NAME_POSIX_ACL_ACCESS, xattr, xattr_len) == 0))\n\t\treturn 1;\n\tif ((strlen(XATTR_NAME_POSIX_ACL_DEFAULT) == xattr_len)\n\t     && (strncmp(XATTR_NAME_POSIX_ACL_DEFAULT, xattr, xattr_len) == 0))\n\t\treturn 1;\n\treturn 0;\n}"
  }
]