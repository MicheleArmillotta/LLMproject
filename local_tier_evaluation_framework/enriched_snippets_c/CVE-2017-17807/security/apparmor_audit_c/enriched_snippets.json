[
  {
    "function_name": "aa_audit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/audit.c",
    "lines": "129-165",
    "snippet": "int aa_audit(int type, struct aa_profile *profile, struct common_audit_data *sa,\n\t     void (*cb) (struct audit_buffer *, void *))\n{\n\tAA_BUG(!profile);\n\n\tif (type == AUDIT_APPARMOR_AUTO) {\n\t\tif (likely(!aad(sa)->error)) {\n\t\t\tif (AUDIT_MODE(profile) != AUDIT_ALL)\n\t\t\t\treturn 0;\n\t\t\ttype = AUDIT_APPARMOR_AUDIT;\n\t\t} else if (COMPLAIN_MODE(profile))\n\t\t\ttype = AUDIT_APPARMOR_ALLOWED;\n\t\telse\n\t\t\ttype = AUDIT_APPARMOR_DENIED;\n\t}\n\tif (AUDIT_MODE(profile) == AUDIT_QUIET ||\n\t    (type == AUDIT_APPARMOR_DENIED &&\n\t     AUDIT_MODE(profile) == AUDIT_QUIET))\n\t\treturn aad(sa)->error;\n\n\tif (KILL_MODE(profile) && type == AUDIT_APPARMOR_DENIED)\n\t\ttype = AUDIT_APPARMOR_KILL;\n\n\taad(sa)->label = &profile->label;\n\n\taa_audit_msg(type, sa, cb);\n\n\tif (aad(sa)->type == AUDIT_APPARMOR_KILL)\n\t\t(void)send_sig_info(SIGKILL, NULL,\n\t\t\tsa->type == LSM_AUDIT_DATA_TASK && sa->u.tsk ?\n\t\t\t\t    sa->u.tsk : current);\n\n\tif (aad(sa)->type == AUDIT_APPARMOR_ALLOWED)\n\t\treturn complain_error(aad(sa)->error);\n\n\treturn aad(sa)->error;\n}",
    "includes": [
      "#include \"include/policy_ns.h\"",
      "#include \"include/policy.h\"",
      "#include \"include/audit.h\"",
      "#include \"include/apparmor.h\"",
      "#include <linux/socket.h>",
      "#include <linux/audit.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "complain_error",
          "args": [
            "aad(sa)->error"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "complain_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/audit.h",
          "lines": "176-181",
          "snippet": "static inline int complain_error(int error)\n{\n\tif (error == -EPERM || error == -EACCES)\n\t\treturn 0;\n\treturn error;\n}",
          "includes": [
            "#include \"label.h\"",
            "#include \"file.h\"",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/lsm_audit.h>",
            "#include <linux/fs.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"label.h\"\n#include \"file.h\"\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/lsm_audit.h>\n#include <linux/fs.h>\n#include <linux/audit.h>\n\nstatic inline int complain_error(int error)\n{\n\tif (error == -EPERM || error == -EACCES)\n\t\treturn 0;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "send_sig_info",
          "args": [
            "SIGKILL",
            "NULL",
            "sa->type == LSM_AUDIT_DATA_TASK && sa->u.tsk ?\n\t\t\t\t    sa->u.tsk : current"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aa_audit_msg",
          "args": [
            "type",
            "sa",
            "cb"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "aa_audit_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/audit.c",
          "lines": "111-116",
          "snippet": "void aa_audit_msg(int type, struct common_audit_data *sa,\n\t\t  void (*cb) (struct audit_buffer *, void *))\n{\n\taad(sa)->type = type;\n\tcommon_lsm_audit(sa, audit_pre, cb);\n}",
          "includes": [
            "#include \"include/policy_ns.h\"",
            "#include \"include/policy.h\"",
            "#include \"include/audit.h\"",
            "#include \"include/apparmor.h\"",
            "#include <linux/socket.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"include/policy_ns.h\"\n#include \"include/policy.h\"\n#include \"include/audit.h\"\n#include \"include/apparmor.h\"\n#include <linux/socket.h>\n#include <linux/audit.h>\n\nvoid aa_audit_msg(int type, struct common_audit_data *sa,\n\t\t  void (*cb) (struct audit_buffer *, void *))\n{\n\taad(sa)->type = type;\n\tcommon_lsm_audit(sa, audit_pre, cb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KILL_MODE",
          "args": [
            "profile"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUDIT_MODE",
          "args": [
            "profile"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "AUDIT_MODE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy.h",
          "lines": "283-289",
          "snippet": "static inline int AUDIT_MODE(struct aa_profile *profile)\n{\n\tif (aa_g_audit != AUDIT_NORMAL)\n\t\treturn aa_g_audit;\n\n\treturn profile->audit;\n}",
          "includes": [
            "#include \"resource.h\"",
            "#include \"perms.h\"",
            "#include \"label.h\"",
            "#include \"lib.h\"",
            "#include \"file.h\"",
            "#include \"domain.h\"",
            "#include \"capability.h\"",
            "#include \"audit.h\"",
            "#include \"apparmor.h\"",
            "#include <linux/socket.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/rhashtable.h>",
            "#include <linux/kref.h>",
            "#include <linux/cred.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"resource.h\"\n#include \"perms.h\"\n#include \"label.h\"\n#include \"lib.h\"\n#include \"file.h\"\n#include \"domain.h\"\n#include \"capability.h\"\n#include \"audit.h\"\n#include \"apparmor.h\"\n#include <linux/socket.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/rhashtable.h>\n#include <linux/kref.h>\n#include <linux/cred.h>\n#include <linux/capability.h>\n\nstatic inline int AUDIT_MODE(struct aa_profile *profile)\n{\n\tif (aa_g_audit != AUDIT_NORMAL)\n\t\treturn aa_g_audit;\n\n\treturn profile->audit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "COMPLAIN_MODE",
          "args": [
            "profile"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!aad(sa)->error"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AA_BUG",
          "args": [
            "!profile"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"include/policy_ns.h\"\n#include \"include/policy.h\"\n#include \"include/audit.h\"\n#include \"include/apparmor.h\"\n#include <linux/socket.h>\n#include <linux/audit.h>\n\nint aa_audit(int type, struct aa_profile *profile, struct common_audit_data *sa,\n\t     void (*cb) (struct audit_buffer *, void *))\n{\n\tAA_BUG(!profile);\n\n\tif (type == AUDIT_APPARMOR_AUTO) {\n\t\tif (likely(!aad(sa)->error)) {\n\t\t\tif (AUDIT_MODE(profile) != AUDIT_ALL)\n\t\t\t\treturn 0;\n\t\t\ttype = AUDIT_APPARMOR_AUDIT;\n\t\t} else if (COMPLAIN_MODE(profile))\n\t\t\ttype = AUDIT_APPARMOR_ALLOWED;\n\t\telse\n\t\t\ttype = AUDIT_APPARMOR_DENIED;\n\t}\n\tif (AUDIT_MODE(profile) == AUDIT_QUIET ||\n\t    (type == AUDIT_APPARMOR_DENIED &&\n\t     AUDIT_MODE(profile) == AUDIT_QUIET))\n\t\treturn aad(sa)->error;\n\n\tif (KILL_MODE(profile) && type == AUDIT_APPARMOR_DENIED)\n\t\ttype = AUDIT_APPARMOR_KILL;\n\n\taad(sa)->label = &profile->label;\n\n\taa_audit_msg(type, sa, cb);\n\n\tif (aad(sa)->type == AUDIT_APPARMOR_KILL)\n\t\t(void)send_sig_info(SIGKILL, NULL,\n\t\t\tsa->type == LSM_AUDIT_DATA_TASK && sa->u.tsk ?\n\t\t\t\t    sa->u.tsk : current);\n\n\tif (aad(sa)->type == AUDIT_APPARMOR_ALLOWED)\n\t\treturn complain_error(aad(sa)->error);\n\n\treturn aad(sa)->error;\n}"
  },
  {
    "function_name": "aa_audit_msg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/audit.c",
    "lines": "111-116",
    "snippet": "void aa_audit_msg(int type, struct common_audit_data *sa,\n\t\t  void (*cb) (struct audit_buffer *, void *))\n{\n\taad(sa)->type = type;\n\tcommon_lsm_audit(sa, audit_pre, cb);\n}",
    "includes": [
      "#include \"include/policy_ns.h\"",
      "#include \"include/policy.h\"",
      "#include \"include/audit.h\"",
      "#include \"include/apparmor.h\"",
      "#include <linux/socket.h>",
      "#include <linux/audit.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "common_lsm_audit",
          "args": [
            "sa",
            "audit_pre",
            "cb"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "common_lsm_audit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/lsm_audit.c",
          "lines": "441-465",
          "snippet": "void common_lsm_audit(struct common_audit_data *a,\n\tvoid (*pre_audit)(struct audit_buffer *, void *),\n\tvoid (*post_audit)(struct audit_buffer *, void *))\n{\n\tstruct audit_buffer *ab;\n\n\tif (a == NULL)\n\t\treturn;\n\t/* we use GFP_ATOMIC so we won't sleep */\n\tab = audit_log_start(current->audit_context, GFP_ATOMIC | __GFP_NOWARN,\n\t\t\t     AUDIT_AVC);\n\n\tif (ab == NULL)\n\t\treturn;\n\n\tif (pre_audit)\n\t\tpre_audit(ab, a);\n\n\tdump_common_audit_data(ab, a);\n\n\tif (post_audit)\n\t\tpost_audit(ab, a);\n\n\taudit_log_end(ab);\n}",
          "includes": [
            "#include <linux/lsm_audit.h>",
            "#include <linux/sctp.h>",
            "#include <linux/dccp.h>",
            "#include <linux/udp.h>",
            "#include <linux/tcp.h>",
            "#include <net/ipv6.h>",
            "#include <net/ip.h>",
            "#include <linux/ip.h>",
            "#include <linux/ipv6.h>",
            "#include <linux/audit.h>",
            "#include <net/af_unix.h>",
            "#include <linux/un.h>",
            "#include <net/sock.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/sctp.h>\n#include <linux/dccp.h>\n#include <linux/udp.h>\n#include <linux/tcp.h>\n#include <net/ipv6.h>\n#include <net/ip.h>\n#include <linux/ip.h>\n#include <linux/ipv6.h>\n#include <linux/audit.h>\n#include <net/af_unix.h>\n#include <linux/un.h>\n#include <net/sock.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/gfp.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/types.h>\n\nvoid common_lsm_audit(struct common_audit_data *a,\n\tvoid (*pre_audit)(struct audit_buffer *, void *),\n\tvoid (*post_audit)(struct audit_buffer *, void *))\n{\n\tstruct audit_buffer *ab;\n\n\tif (a == NULL)\n\t\treturn;\n\t/* we use GFP_ATOMIC so we won't sleep */\n\tab = audit_log_start(current->audit_context, GFP_ATOMIC | __GFP_NOWARN,\n\t\t\t     AUDIT_AVC);\n\n\tif (ab == NULL)\n\t\treturn;\n\n\tif (pre_audit)\n\t\tpre_audit(ab, a);\n\n\tdump_common_audit_data(ab, a);\n\n\tif (post_audit)\n\t\tpost_audit(ab, a);\n\n\taudit_log_end(ab);\n}"
        }
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"include/policy_ns.h\"\n#include \"include/policy.h\"\n#include \"include/audit.h\"\n#include \"include/apparmor.h\"\n#include <linux/socket.h>\n#include <linux/audit.h>\n\nvoid aa_audit_msg(int type, struct common_audit_data *sa,\n\t\t  void (*cb) (struct audit_buffer *, void *))\n{\n\taad(sa)->type = type;\n\tcommon_lsm_audit(sa, audit_pre, cb);\n}"
  },
  {
    "function_name": "audit_pre",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/audit.c",
    "lines": "59-104",
    "snippet": "static void audit_pre(struct audit_buffer *ab, void *ca)\n{\n\tstruct common_audit_data *sa = ca;\n\n\tif (aa_g_audit_header) {\n\t\taudit_log_format(ab, \"apparmor=\");\n\t\taudit_log_string(ab, aa_audit_type[aad(sa)->type]);\n\t}\n\n\tif (aad(sa)->op) {\n\t\taudit_log_format(ab, \" operation=\");\n\t\taudit_log_string(ab, aad(sa)->op);\n\t}\n\n\tif (aad(sa)->info) {\n\t\taudit_log_format(ab, \" info=\");\n\t\taudit_log_string(ab, aad(sa)->info);\n\t\tif (aad(sa)->error)\n\t\t\taudit_log_format(ab, \" error=%d\", aad(sa)->error);\n\t}\n\n\tif (aad(sa)->label) {\n\t\tstruct aa_label *label = aad(sa)->label;\n\n\t\tif (label_isprofile(label)) {\n\t\t\tstruct aa_profile *profile = labels_profile(label);\n\n\t\t\tif (profile->ns != root_ns) {\n\t\t\t\taudit_log_format(ab, \" namespace=\");\n\t\t\t\taudit_log_untrustedstring(ab,\n\t\t\t\t\t\t       profile->ns->base.hname);\n\t\t\t}\n\t\t\taudit_log_format(ab, \" profile=\");\n\t\t\taudit_log_untrustedstring(ab, profile->base.hname);\n\t\t} else {\n\t\t\taudit_log_format(ab, \" label=\");\n\t\t\taa_label_xaudit(ab, root_ns, label, FLAG_VIEW_SUBNS,\n\t\t\t\t\tGFP_ATOMIC);\n\t\t}\n\t}\n\n\tif (aad(sa)->name) {\n\t\taudit_log_format(ab, \" name=\");\n\t\taudit_log_untrustedstring(ab, aad(sa)->name);\n\t}\n}",
    "includes": [
      "#include \"include/policy_ns.h\"",
      "#include \"include/policy.h\"",
      "#include \"include/audit.h\"",
      "#include \"include/apparmor.h\"",
      "#include <linux/socket.h>",
      "#include <linux/audit.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *const aa_audit_type[] = {\n\t\"AUDIT\",\n\t\"ALLOWED\",\n\t\"DENIED\",\n\t\"HINT\",\n\t\"STATUS\",\n\t\"ERROR\",\n\t\"KILLED\",\n\t\"AUTO\"\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "audit_log_untrustedstring",
          "args": [
            "ab",
            "aad(sa)->name"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_format",
          "args": [
            "ab",
            "\" name=\""
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aa_label_xaudit",
          "args": [
            "ab",
            "root_ns",
            "label",
            "FLAG_VIEW_SUBNS",
            "GFP_ATOMIC"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "aa_label_xaudit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/label.c",
          "lines": "1710-1738",
          "snippet": "void aa_label_xaudit(struct audit_buffer *ab, struct aa_ns *ns,\n\t\t     struct aa_label *label, int flags, gfp_t gfp)\n{\n\tconst char *str;\n\tchar *name = NULL;\n\tint len;\n\n\tAA_BUG(!ab);\n\tAA_BUG(!label);\n\n\tif (!use_label_hname(ns, label, flags) ||\n\t    display_mode(ns, label, flags)) {\n\t\tlen  = aa_label_asxprint(&name, ns, label, flags, gfp);\n\t\tif (len == -1) {\n\t\t\tAA_DEBUG(\"label print error\");\n\t\t\treturn;\n\t\t}\n\t\tstr = name;\n\t} else {\n\t\tstr = (char *) label->hname;\n\t\tlen = strlen(str);\n\t}\n\tif (audit_string_contains_control(str, len))\n\t\taudit_log_n_hex(ab, str, len);\n\telse\n\t\taudit_log_n_string(ab, str, len);\n\n\tkfree(name);\n}",
          "includes": [
            "#include \"include/secid.h\"",
            "#include \"include/policy.h\"",
            "#include \"include/label.h\"",
            "#include \"include/context.h\"",
            "#include \"include/apparmor.h\"",
            "#include <linux/sort.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"include/secid.h\"\n#include \"include/policy.h\"\n#include \"include/label.h\"\n#include \"include/context.h\"\n#include \"include/apparmor.h\"\n#include <linux/sort.h>\n#include <linux/seq_file.h>\n#include <linux/audit.h>\n\nvoid aa_label_xaudit(struct audit_buffer *ab, struct aa_ns *ns,\n\t\t     struct aa_label *label, int flags, gfp_t gfp)\n{\n\tconst char *str;\n\tchar *name = NULL;\n\tint len;\n\n\tAA_BUG(!ab);\n\tAA_BUG(!label);\n\n\tif (!use_label_hname(ns, label, flags) ||\n\t    display_mode(ns, label, flags)) {\n\t\tlen  = aa_label_asxprint(&name, ns, label, flags, gfp);\n\t\tif (len == -1) {\n\t\t\tAA_DEBUG(\"label print error\");\n\t\t\treturn;\n\t\t}\n\t\tstr = name;\n\t} else {\n\t\tstr = (char *) label->hname;\n\t\tlen = strlen(str);\n\t}\n\tif (audit_string_contains_control(str, len))\n\t\taudit_log_n_hex(ab, str, len);\n\telse\n\t\taudit_log_n_string(ab, str, len);\n\n\tkfree(name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "audit_log_format",
          "args": [
            "ab",
            "\" label=\""
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_untrustedstring",
          "args": [
            "ab",
            "profile->base.hname"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_format",
          "args": [
            "ab",
            "\" profile=\""
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_untrustedstring",
          "args": [
            "ab",
            "profile->ns->base.hname"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_format",
          "args": [
            "ab",
            "\" namespace=\""
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "labels_profile",
          "args": [
            "label"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "label_isprofile",
          "args": [
            "label"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_format",
          "args": [
            "ab",
            "\" error=%d\"",
            "aad(sa)->error"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_string",
          "args": [
            "ab",
            "aad(sa)->info"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_format",
          "args": [
            "ab",
            "\" info=\""
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_string",
          "args": [
            "ab",
            "aad(sa)->op"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_format",
          "args": [
            "ab",
            "\" operation=\""
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_string",
          "args": [
            "ab",
            "aa_audit_type[aad(sa)->type]"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aad",
          "args": [
            "sa"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_format",
          "args": [
            "ab",
            "\"apparmor=\""
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"include/policy_ns.h\"\n#include \"include/policy.h\"\n#include \"include/audit.h\"\n#include \"include/apparmor.h\"\n#include <linux/socket.h>\n#include <linux/audit.h>\n\nstatic const char *const aa_audit_type[] = {\n\t\"AUDIT\",\n\t\"ALLOWED\",\n\t\"DENIED\",\n\t\"HINT\",\n\t\"STATUS\",\n\t\"ERROR\",\n\t\"KILLED\",\n\t\"AUTO\"\n};\n\nstatic void audit_pre(struct audit_buffer *ab, void *ca)\n{\n\tstruct common_audit_data *sa = ca;\n\n\tif (aa_g_audit_header) {\n\t\taudit_log_format(ab, \"apparmor=\");\n\t\taudit_log_string(ab, aa_audit_type[aad(sa)->type]);\n\t}\n\n\tif (aad(sa)->op) {\n\t\taudit_log_format(ab, \" operation=\");\n\t\taudit_log_string(ab, aad(sa)->op);\n\t}\n\n\tif (aad(sa)->info) {\n\t\taudit_log_format(ab, \" info=\");\n\t\taudit_log_string(ab, aad(sa)->info);\n\t\tif (aad(sa)->error)\n\t\t\taudit_log_format(ab, \" error=%d\", aad(sa)->error);\n\t}\n\n\tif (aad(sa)->label) {\n\t\tstruct aa_label *label = aad(sa)->label;\n\n\t\tif (label_isprofile(label)) {\n\t\t\tstruct aa_profile *profile = labels_profile(label);\n\n\t\t\tif (profile->ns != root_ns) {\n\t\t\t\taudit_log_format(ab, \" namespace=\");\n\t\t\t\taudit_log_untrustedstring(ab,\n\t\t\t\t\t\t       profile->ns->base.hname);\n\t\t\t}\n\t\t\taudit_log_format(ab, \" profile=\");\n\t\t\taudit_log_untrustedstring(ab, profile->base.hname);\n\t\t} else {\n\t\t\taudit_log_format(ab, \" label=\");\n\t\t\taa_label_xaudit(ab, root_ns, label, FLAG_VIEW_SUBNS,\n\t\t\t\t\tGFP_ATOMIC);\n\t\t}\n\t}\n\n\tif (aad(sa)->name) {\n\t\taudit_log_format(ab, \" name=\");\n\t\taudit_log_untrustedstring(ab, aad(sa)->name);\n\t}\n}"
  }
]