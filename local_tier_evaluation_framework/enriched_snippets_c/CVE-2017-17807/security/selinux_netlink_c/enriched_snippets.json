[
  {
    "function_name": "selnl_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/netlink.c",
    "lines": "111-122",
    "snippet": "static int __init selnl_init(void)\n{\n\tstruct netlink_kernel_cfg cfg = {\n\t\t.groups\t= SELNLGRP_MAX,\n\t\t.flags\t= NL_CFG_F_NONROOT_RECV,\n\t};\n\n\tselnl = netlink_kernel_create(&init_net, NETLINK_SELINUX, &cfg);\n\tif (selnl == NULL)\n\t\tpanic(\"SELinux:  Cannot create netlink socket.\");\n\treturn 0;\n}",
    "includes": [
      "#include \"security.h\"",
      "#include <net/netlink.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/selinux_netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct sock *selnl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"SELinux:  Cannot create netlink socket.\""
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "netlink_kernel_create",
          "args": [
            "&init_net",
            "NETLINK_SELINUX",
            "&cfg"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include <net/netlink.h>\n#include <net/net_namespace.h>\n#include <linux/selinux_netlink.h>\n#include <linux/skbuff.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nstatic struct sock *selnl;\n\nstatic int __init selnl_init(void)\n{\n\tstruct netlink_kernel_cfg cfg = {\n\t\t.groups\t= SELNLGRP_MAX,\n\t\t.flags\t= NL_CFG_F_NONROOT_RECV,\n\t};\n\n\tselnl = netlink_kernel_create(&init_net, NETLINK_SELINUX, &cfg);\n\tif (selnl == NULL)\n\t\tpanic(\"SELinux:  Cannot create netlink socket.\");\n\treturn 0;\n}"
  },
  {
    "function_name": "selnl_notify_policyload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/netlink.c",
    "lines": "106-109",
    "snippet": "void selnl_notify_policyload(u32 seqno)\n{\n\tselnl_notify(SELNL_MSG_POLICYLOAD, &seqno);\n}",
    "includes": [
      "#include \"security.h\"",
      "#include <net/netlink.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/selinux_netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "selnl_notify",
          "args": [
            "SELNL_MSG_POLICYLOAD",
            "&seqno"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "selnl_notify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/netlink.c",
          "lines": "70-99",
          "snippet": "static void selnl_notify(int msgtype, void *data)\n{\n\tint len;\n\tsk_buff_data_t tmp;\n\tstruct sk_buff *skb;\n\tstruct nlmsghdr *nlh;\n\n\tlen = selnl_msglen(msgtype);\n\n\tskb = nlmsg_new(len, GFP_USER);\n\tif (!skb)\n\t\tgoto oom;\n\n\ttmp = skb->tail;\n\tnlh = nlmsg_put(skb, 0, 0, msgtype, len, 0);\n\tif (!nlh)\n\t\tgoto out_kfree_skb;\n\tselnl_add_payload(nlh, len, msgtype, data);\n\tnlh->nlmsg_len = skb->tail - tmp;\n\tNETLINK_CB(skb).dst_group = SELNLGRP_AVC;\n\tnetlink_broadcast(selnl, skb, 0, SELNLGRP_AVC, GFP_USER);\nout:\n\treturn;\n\nout_kfree_skb:\n\tkfree_skb(skb);\noom:\n\tprintk(KERN_ERR \"SELinux:  OOM in %s\\n\", __func__);\n\tgoto out;\n}",
          "includes": [
            "#include \"security.h\"",
            "#include <net/netlink.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/selinux_netlink.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct sock *selnl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"security.h\"\n#include <net/netlink.h>\n#include <net/net_namespace.h>\n#include <linux/selinux_netlink.h>\n#include <linux/skbuff.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nstatic struct sock *selnl;\n\nstatic void selnl_notify(int msgtype, void *data)\n{\n\tint len;\n\tsk_buff_data_t tmp;\n\tstruct sk_buff *skb;\n\tstruct nlmsghdr *nlh;\n\n\tlen = selnl_msglen(msgtype);\n\n\tskb = nlmsg_new(len, GFP_USER);\n\tif (!skb)\n\t\tgoto oom;\n\n\ttmp = skb->tail;\n\tnlh = nlmsg_put(skb, 0, 0, msgtype, len, 0);\n\tif (!nlh)\n\t\tgoto out_kfree_skb;\n\tselnl_add_payload(nlh, len, msgtype, data);\n\tnlh->nlmsg_len = skb->tail - tmp;\n\tNETLINK_CB(skb).dst_group = SELNLGRP_AVC;\n\tnetlink_broadcast(selnl, skb, 0, SELNLGRP_AVC, GFP_USER);\nout:\n\treturn;\n\nout_kfree_skb:\n\tkfree_skb(skb);\noom:\n\tprintk(KERN_ERR \"SELinux:  OOM in %s\\n\", __func__);\n\tgoto out;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include <net/netlink.h>\n#include <net/net_namespace.h>\n#include <linux/selinux_netlink.h>\n#include <linux/skbuff.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nvoid selnl_notify_policyload(u32 seqno)\n{\n\tselnl_notify(SELNL_MSG_POLICYLOAD, &seqno);\n}"
  },
  {
    "function_name": "selnl_notify_setenforce",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/netlink.c",
    "lines": "101-104",
    "snippet": "void selnl_notify_setenforce(int val)\n{\n\tselnl_notify(SELNL_MSG_SETENFORCE, &val);\n}",
    "includes": [
      "#include \"security.h\"",
      "#include <net/netlink.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/selinux_netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "selnl_notify",
          "args": [
            "SELNL_MSG_SETENFORCE",
            "&val"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "selnl_notify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/netlink.c",
          "lines": "70-99",
          "snippet": "static void selnl_notify(int msgtype, void *data)\n{\n\tint len;\n\tsk_buff_data_t tmp;\n\tstruct sk_buff *skb;\n\tstruct nlmsghdr *nlh;\n\n\tlen = selnl_msglen(msgtype);\n\n\tskb = nlmsg_new(len, GFP_USER);\n\tif (!skb)\n\t\tgoto oom;\n\n\ttmp = skb->tail;\n\tnlh = nlmsg_put(skb, 0, 0, msgtype, len, 0);\n\tif (!nlh)\n\t\tgoto out_kfree_skb;\n\tselnl_add_payload(nlh, len, msgtype, data);\n\tnlh->nlmsg_len = skb->tail - tmp;\n\tNETLINK_CB(skb).dst_group = SELNLGRP_AVC;\n\tnetlink_broadcast(selnl, skb, 0, SELNLGRP_AVC, GFP_USER);\nout:\n\treturn;\n\nout_kfree_skb:\n\tkfree_skb(skb);\noom:\n\tprintk(KERN_ERR \"SELinux:  OOM in %s\\n\", __func__);\n\tgoto out;\n}",
          "includes": [
            "#include \"security.h\"",
            "#include <net/netlink.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/selinux_netlink.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct sock *selnl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"security.h\"\n#include <net/netlink.h>\n#include <net/net_namespace.h>\n#include <linux/selinux_netlink.h>\n#include <linux/skbuff.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nstatic struct sock *selnl;\n\nstatic void selnl_notify(int msgtype, void *data)\n{\n\tint len;\n\tsk_buff_data_t tmp;\n\tstruct sk_buff *skb;\n\tstruct nlmsghdr *nlh;\n\n\tlen = selnl_msglen(msgtype);\n\n\tskb = nlmsg_new(len, GFP_USER);\n\tif (!skb)\n\t\tgoto oom;\n\n\ttmp = skb->tail;\n\tnlh = nlmsg_put(skb, 0, 0, msgtype, len, 0);\n\tif (!nlh)\n\t\tgoto out_kfree_skb;\n\tselnl_add_payload(nlh, len, msgtype, data);\n\tnlh->nlmsg_len = skb->tail - tmp;\n\tNETLINK_CB(skb).dst_group = SELNLGRP_AVC;\n\tnetlink_broadcast(selnl, skb, 0, SELNLGRP_AVC, GFP_USER);\nout:\n\treturn;\n\nout_kfree_skb:\n\tkfree_skb(skb);\noom:\n\tprintk(KERN_ERR \"SELinux:  OOM in %s\\n\", __func__);\n\tgoto out;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include <net/netlink.h>\n#include <net/net_namespace.h>\n#include <linux/selinux_netlink.h>\n#include <linux/skbuff.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nvoid selnl_notify_setenforce(int val)\n{\n\tselnl_notify(SELNL_MSG_SETENFORCE, &val);\n}"
  },
  {
    "function_name": "selnl_notify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/netlink.c",
    "lines": "70-99",
    "snippet": "static void selnl_notify(int msgtype, void *data)\n{\n\tint len;\n\tsk_buff_data_t tmp;\n\tstruct sk_buff *skb;\n\tstruct nlmsghdr *nlh;\n\n\tlen = selnl_msglen(msgtype);\n\n\tskb = nlmsg_new(len, GFP_USER);\n\tif (!skb)\n\t\tgoto oom;\n\n\ttmp = skb->tail;\n\tnlh = nlmsg_put(skb, 0, 0, msgtype, len, 0);\n\tif (!nlh)\n\t\tgoto out_kfree_skb;\n\tselnl_add_payload(nlh, len, msgtype, data);\n\tnlh->nlmsg_len = skb->tail - tmp;\n\tNETLINK_CB(skb).dst_group = SELNLGRP_AVC;\n\tnetlink_broadcast(selnl, skb, 0, SELNLGRP_AVC, GFP_USER);\nout:\n\treturn;\n\nout_kfree_skb:\n\tkfree_skb(skb);\noom:\n\tprintk(KERN_ERR \"SELinux:  OOM in %s\\n\", __func__);\n\tgoto out;\n}",
    "includes": [
      "#include \"security.h\"",
      "#include <net/netlink.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/selinux_netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct sock *selnl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"SELinux:  OOM in %s\\n\"",
            "__func__"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "aa_label_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/label.c",
          "lines": "1803-1809",
          "snippet": "void aa_label_printk(struct aa_label *label, gfp_t gfp)\n{\n\tstruct aa_ns *ns = aa_get_current_ns();\n\n\taa_label_xprintk(ns, label, FLAG_VIEW_SUBNS, gfp);\n\taa_put_ns(ns);\n}",
          "includes": [
            "#include \"include/secid.h\"",
            "#include \"include/policy.h\"",
            "#include \"include/label.h\"",
            "#include \"include/context.h\"",
            "#include \"include/apparmor.h\"",
            "#include <linux/sort.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"include/secid.h\"\n#include \"include/policy.h\"\n#include \"include/label.h\"\n#include \"include/context.h\"\n#include \"include/apparmor.h\"\n#include <linux/sort.h>\n#include <linux/seq_file.h>\n#include <linux/audit.h>\n\nvoid aa_label_printk(struct aa_label *label, gfp_t gfp)\n{\n\tstruct aa_ns *ns = aa_get_current_ns();\n\n\taa_label_xprintk(ns, label, FLAG_VIEW_SUBNS, gfp);\n\taa_put_ns(ns);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree_skb",
          "args": [
            "skb"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "netlink_broadcast",
          "args": [
            "selnl",
            "skb",
            "0",
            "SELNLGRP_AVC",
            "GFP_USER"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NETLINK_CB",
          "args": [
            "skb"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selnl_add_payload",
          "args": [
            "nlh",
            "len",
            "msgtype",
            "data"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "selnl_add_payload",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/netlink.c",
          "lines": "46-68",
          "snippet": "static void selnl_add_payload(struct nlmsghdr *nlh, int len, int msgtype, void *data)\n{\n\tswitch (msgtype) {\n\tcase SELNL_MSG_SETENFORCE: {\n\t\tstruct selnl_msg_setenforce *msg = nlmsg_data(nlh);\n\n\t\tmemset(msg, 0, len);\n\t\tmsg->val = *((int *)data);\n\t\tbreak;\n\t}\n\n\tcase SELNL_MSG_POLICYLOAD: {\n\t\tstruct selnl_msg_policyload *msg = nlmsg_data(nlh);\n\n\t\tmemset(msg, 0, len);\n\t\tmsg->seqno = *((u32 *)data);\n\t\tbreak;\n\t}\n\n\tdefault:\n\t\tBUG();\n\t}\n}",
          "includes": [
            "#include \"security.h\"",
            "#include <net/netlink.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/selinux_netlink.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"security.h\"\n#include <net/netlink.h>\n#include <net/net_namespace.h>\n#include <linux/selinux_netlink.h>\n#include <linux/skbuff.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nstatic void selnl_add_payload(struct nlmsghdr *nlh, int len, int msgtype, void *data)\n{\n\tswitch (msgtype) {\n\tcase SELNL_MSG_SETENFORCE: {\n\t\tstruct selnl_msg_setenforce *msg = nlmsg_data(nlh);\n\n\t\tmemset(msg, 0, len);\n\t\tmsg->val = *((int *)data);\n\t\tbreak;\n\t}\n\n\tcase SELNL_MSG_POLICYLOAD: {\n\t\tstruct selnl_msg_policyload *msg = nlmsg_data(nlh);\n\n\t\tmemset(msg, 0, len);\n\t\tmsg->seqno = *((u32 *)data);\n\t\tbreak;\n\t}\n\n\tdefault:\n\t\tBUG();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlmsg_put",
          "args": [
            "skb",
            "0",
            "0",
            "msgtype",
            "len",
            "0"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_new",
          "args": [
            "len",
            "GFP_USER"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selnl_msglen",
          "args": [
            "msgtype"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "selnl_msglen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/netlink.c",
          "lines": "27-44",
          "snippet": "static int selnl_msglen(int msgtype)\n{\n\tint ret = 0;\n\n\tswitch (msgtype) {\n\tcase SELNL_MSG_SETENFORCE:\n\t\tret = sizeof(struct selnl_msg_setenforce);\n\t\tbreak;\n\n\tcase SELNL_MSG_POLICYLOAD:\n\t\tret = sizeof(struct selnl_msg_policyload);\n\t\tbreak;\n\n\tdefault:\n\t\tBUG();\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"security.h\"",
            "#include <net/netlink.h>",
            "#include <net/net_namespace.h>",
            "#include <linux/selinux_netlink.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/stddef.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"security.h\"\n#include <net/netlink.h>\n#include <net/net_namespace.h>\n#include <linux/selinux_netlink.h>\n#include <linux/skbuff.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nstatic int selnl_msglen(int msgtype)\n{\n\tint ret = 0;\n\n\tswitch (msgtype) {\n\tcase SELNL_MSG_SETENFORCE:\n\t\tret = sizeof(struct selnl_msg_setenforce);\n\t\tbreak;\n\n\tcase SELNL_MSG_POLICYLOAD:\n\t\tret = sizeof(struct selnl_msg_policyload);\n\t\tbreak;\n\n\tdefault:\n\t\tBUG();\n\t}\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include <net/netlink.h>\n#include <net/net_namespace.h>\n#include <linux/selinux_netlink.h>\n#include <linux/skbuff.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nstatic struct sock *selnl;\n\nstatic void selnl_notify(int msgtype, void *data)\n{\n\tint len;\n\tsk_buff_data_t tmp;\n\tstruct sk_buff *skb;\n\tstruct nlmsghdr *nlh;\n\n\tlen = selnl_msglen(msgtype);\n\n\tskb = nlmsg_new(len, GFP_USER);\n\tif (!skb)\n\t\tgoto oom;\n\n\ttmp = skb->tail;\n\tnlh = nlmsg_put(skb, 0, 0, msgtype, len, 0);\n\tif (!nlh)\n\t\tgoto out_kfree_skb;\n\tselnl_add_payload(nlh, len, msgtype, data);\n\tnlh->nlmsg_len = skb->tail - tmp;\n\tNETLINK_CB(skb).dst_group = SELNLGRP_AVC;\n\tnetlink_broadcast(selnl, skb, 0, SELNLGRP_AVC, GFP_USER);\nout:\n\treturn;\n\nout_kfree_skb:\n\tkfree_skb(skb);\noom:\n\tprintk(KERN_ERR \"SELinux:  OOM in %s\\n\", __func__);\n\tgoto out;\n}"
  },
  {
    "function_name": "selnl_add_payload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/netlink.c",
    "lines": "46-68",
    "snippet": "static void selnl_add_payload(struct nlmsghdr *nlh, int len, int msgtype, void *data)\n{\n\tswitch (msgtype) {\n\tcase SELNL_MSG_SETENFORCE: {\n\t\tstruct selnl_msg_setenforce *msg = nlmsg_data(nlh);\n\n\t\tmemset(msg, 0, len);\n\t\tmsg->val = *((int *)data);\n\t\tbreak;\n\t}\n\n\tcase SELNL_MSG_POLICYLOAD: {\n\t\tstruct selnl_msg_policyload *msg = nlmsg_data(nlh);\n\n\t\tmemset(msg, 0, len);\n\t\tmsg->seqno = *((u32 *)data);\n\t\tbreak;\n\t}\n\n\tdefault:\n\t\tBUG();\n\t}\n}",
    "includes": [
      "#include \"security.h\"",
      "#include <net/netlink.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/selinux_netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "msg",
            "0",
            "len"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_data",
          "args": [
            "nlh"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "msg",
            "0",
            "len"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_data",
          "args": [
            "nlh"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include <net/netlink.h>\n#include <net/net_namespace.h>\n#include <linux/selinux_netlink.h>\n#include <linux/skbuff.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nstatic void selnl_add_payload(struct nlmsghdr *nlh, int len, int msgtype, void *data)\n{\n\tswitch (msgtype) {\n\tcase SELNL_MSG_SETENFORCE: {\n\t\tstruct selnl_msg_setenforce *msg = nlmsg_data(nlh);\n\n\t\tmemset(msg, 0, len);\n\t\tmsg->val = *((int *)data);\n\t\tbreak;\n\t}\n\n\tcase SELNL_MSG_POLICYLOAD: {\n\t\tstruct selnl_msg_policyload *msg = nlmsg_data(nlh);\n\n\t\tmemset(msg, 0, len);\n\t\tmsg->seqno = *((u32 *)data);\n\t\tbreak;\n\t}\n\n\tdefault:\n\t\tBUG();\n\t}\n}"
  },
  {
    "function_name": "selnl_msglen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/netlink.c",
    "lines": "27-44",
    "snippet": "static int selnl_msglen(int msgtype)\n{\n\tint ret = 0;\n\n\tswitch (msgtype) {\n\tcase SELNL_MSG_SETENFORCE:\n\t\tret = sizeof(struct selnl_msg_setenforce);\n\t\tbreak;\n\n\tcase SELNL_MSG_POLICYLOAD:\n\t\tret = sizeof(struct selnl_msg_policyload);\n\t\tbreak;\n\n\tdefault:\n\t\tBUG();\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"security.h\"",
      "#include <net/netlink.h>",
      "#include <net/net_namespace.h>",
      "#include <linux/selinux_netlink.h>",
      "#include <linux/skbuff.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/stddef.h>",
      "#include <linux/slab.h>",
      "#include <linux/types.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include <net/netlink.h>\n#include <net/net_namespace.h>\n#include <linux/selinux_netlink.h>\n#include <linux/skbuff.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/stddef.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/init.h>\n\nstatic int selnl_msglen(int msgtype)\n{\n\tint ret = 0;\n\n\tswitch (msgtype) {\n\tcase SELNL_MSG_SETENFORCE:\n\t\tret = sizeof(struct selnl_msg_setenforce);\n\t\tbreak;\n\n\tcase SELNL_MSG_POLICYLOAD:\n\t\tret = sizeof(struct selnl_msg_policyload);\n\t\tbreak;\n\n\tdefault:\n\t\tBUG();\n\t}\n\treturn ret;\n}"
  }
]