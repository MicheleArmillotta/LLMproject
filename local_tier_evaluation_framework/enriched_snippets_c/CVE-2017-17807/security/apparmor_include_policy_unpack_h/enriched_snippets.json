[
  {
    "function_name": "aa_put_loaddata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_unpack.h",
    "lines": "119-123",
    "snippet": "static inline void aa_put_loaddata(struct aa_loaddata *data)\n{\n\tif (data)\n\t\tkref_put(&data->count, aa_loaddata_kref);\n}",
    "includes": [
      "#include <linux/workqueue.h>",
      "#include <linux/dcache.h>",
      "#include <linux/kref.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_put",
          "args": [
            "&data->count",
            "aa_loaddata_kref"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/dcache.h>\n#include <linux/kref.h>\n#include <linux/list.h>\n\nstatic inline void aa_put_loaddata(struct aa_loaddata *data)\n{\n\tif (data)\n\t\tkref_put(&data->count, aa_loaddata_kref);\n}"
  },
  {
    "function_name": "aa_get_loaddata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_unpack.h",
    "lines": "105-113",
    "snippet": "static inline struct aa_loaddata *\naa_get_loaddata(struct aa_loaddata *data)\n{\n\tstruct aa_loaddata *tmp = __aa_get_loaddata(data);\n\n\tAA_BUG(data && !tmp);\n\n\treturn tmp;\n}",
    "includes": [
      "#include <linux/workqueue.h>",
      "#include <linux/dcache.h>",
      "#include <linux/kref.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AA_BUG",
          "args": [
            "data && !tmp"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__aa_get_loaddata",
          "args": [
            "data"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "__aa_get_loaddata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_unpack.h",
          "lines": "88-95",
          "snippet": "static inline struct aa_loaddata *\n__aa_get_loaddata(struct aa_loaddata *data)\n{\n\tif (data && kref_get_unless_zero(&(data->count)))\n\t\treturn data;\n\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/workqueue.h>",
            "#include <linux/dcache.h>",
            "#include <linux/kref.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/dcache.h>\n#include <linux/kref.h>\n#include <linux/list.h>\n\nstatic inline struct aa_loaddata *\n__aa_get_loaddata(struct aa_loaddata *data)\n{\n\tif (data && kref_get_unless_zero(&(data->count)))\n\t\treturn data;\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/dcache.h>\n#include <linux/kref.h>\n#include <linux/list.h>\n\nstatic inline struct aa_loaddata *\naa_get_loaddata(struct aa_loaddata *data)\n{\n\tstruct aa_loaddata *tmp = __aa_get_loaddata(data);\n\n\tAA_BUG(data && !tmp);\n\n\treturn tmp;\n}"
  },
  {
    "function_name": "__aa_get_loaddata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/policy_unpack.h",
    "lines": "88-95",
    "snippet": "static inline struct aa_loaddata *\n__aa_get_loaddata(struct aa_loaddata *data)\n{\n\tif (data && kref_get_unless_zero(&(data->count)))\n\t\treturn data;\n\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/workqueue.h>",
      "#include <linux/dcache.h>",
      "#include <linux/kref.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_get_unless_zero",
          "args": [
            "&(data->count)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/workqueue.h>\n#include <linux/dcache.h>\n#include <linux/kref.h>\n#include <linux/list.h>\n\nstatic inline struct aa_loaddata *\n__aa_get_loaddata(struct aa_loaddata *data)\n{\n\tif (data && kref_get_unless_zero(&(data->count)))\n\t\treturn data;\n\n\treturn NULL;\n}"
  }
]