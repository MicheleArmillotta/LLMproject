[
  {
    "function_name": "ebitmap_netlbl_import",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.h",
    "lines": "148-152",
    "snippet": "static inline int ebitmap_netlbl_import(struct ebitmap *ebmap,\n\t\t\t\t\tstruct netlbl_lsm_catmap *catmap)\n{\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include <net/netlabel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <net/netlabel.h>\n\nstatic inline int ebitmap_netlbl_import(struct ebitmap *ebmap,\n\t\t\t\t\tstruct netlbl_lsm_catmap *catmap)\n{\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "ebitmap_netlbl_export",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.h",
    "lines": "143-147",
    "snippet": "static inline int ebitmap_netlbl_export(struct ebitmap *ebmap,\n\t\t\t\t\tstruct netlbl_lsm_catmap **catmap)\n{\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include <net/netlabel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <net/netlabel.h>\n\nstatic inline int ebitmap_netlbl_export(struct ebitmap *ebmap,\n\t\t\t\t\tstruct netlbl_lsm_catmap **catmap)\n{\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "ebitmap_node_clr_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.h",
    "lines": "110-118",
    "snippet": "static inline void ebitmap_node_clr_bit(struct ebitmap_node *n,\n\t\t\t\t\tunsigned int bit)\n{\n\tunsigned int index = EBITMAP_NODE_INDEX(n, bit);\n\tunsigned int ofs = EBITMAP_NODE_OFFSET(n, bit);\n\n\tBUG_ON(index >= EBITMAP_UNIT_NUMS);\n\tn->maps[index] &= ~(EBITMAP_BIT << ofs);\n}",
    "includes": [
      "#include <net/netlabel.h>"
    ],
    "macros_used": [
      "#define EBITMAP_BIT\t\t1ULL",
      "#define EBITMAP_UNIT_NUMS\t((EBITMAP_NODE_SIZE-sizeof(void *)-sizeof(u32))\\\n\t\t\t\t\t/ sizeof(unsigned long))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "index >= EBITMAP_UNIT_NUMS"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBITMAP_NODE_OFFSET",
          "args": [
            "n",
            "bit"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBITMAP_NODE_INDEX",
          "args": [
            "n",
            "bit"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <net/netlabel.h>\n\n#define EBITMAP_BIT\t\t1ULL\n#define EBITMAP_UNIT_NUMS\t((EBITMAP_NODE_SIZE-sizeof(void *)-sizeof(u32))\\\n\t\t\t\t\t/ sizeof(unsigned long))\n\nstatic inline void ebitmap_node_clr_bit(struct ebitmap_node *n,\n\t\t\t\t\tunsigned int bit)\n{\n\tunsigned int index = EBITMAP_NODE_INDEX(n, bit);\n\tunsigned int ofs = EBITMAP_NODE_OFFSET(n, bit);\n\n\tBUG_ON(index >= EBITMAP_UNIT_NUMS);\n\tn->maps[index] &= ~(EBITMAP_BIT << ofs);\n}"
  },
  {
    "function_name": "ebitmap_node_set_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.h",
    "lines": "100-108",
    "snippet": "static inline void ebitmap_node_set_bit(struct ebitmap_node *n,\n\t\t\t\t\tunsigned int bit)\n{\n\tunsigned int index = EBITMAP_NODE_INDEX(n, bit);\n\tunsigned int ofs = EBITMAP_NODE_OFFSET(n, bit);\n\n\tBUG_ON(index >= EBITMAP_UNIT_NUMS);\n\tn->maps[index] |= (EBITMAP_BIT << ofs);\n}",
    "includes": [
      "#include <net/netlabel.h>"
    ],
    "macros_used": [
      "#define EBITMAP_BIT\t\t1ULL",
      "#define EBITMAP_UNIT_NUMS\t((EBITMAP_NODE_SIZE-sizeof(void *)-sizeof(u32))\\\n\t\t\t\t\t/ sizeof(unsigned long))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "index >= EBITMAP_UNIT_NUMS"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBITMAP_NODE_OFFSET",
          "args": [
            "n",
            "bit"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBITMAP_NODE_INDEX",
          "args": [
            "n",
            "bit"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <net/netlabel.h>\n\n#define EBITMAP_BIT\t\t1ULL\n#define EBITMAP_UNIT_NUMS\t((EBITMAP_NODE_SIZE-sizeof(void *)-sizeof(u32))\\\n\t\t\t\t\t/ sizeof(unsigned long))\n\nstatic inline void ebitmap_node_set_bit(struct ebitmap_node *n,\n\t\t\t\t\tunsigned int bit)\n{\n\tunsigned int index = EBITMAP_NODE_INDEX(n, bit);\n\tunsigned int ofs = EBITMAP_NODE_OFFSET(n, bit);\n\n\tBUG_ON(index >= EBITMAP_UNIT_NUMS);\n\tn->maps[index] |= (EBITMAP_BIT << ofs);\n}"
  },
  {
    "function_name": "ebitmap_node_get_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.h",
    "lines": "88-98",
    "snippet": "static inline int ebitmap_node_get_bit(struct ebitmap_node *n,\n\t\t\t\t       unsigned int bit)\n{\n\tunsigned int index = EBITMAP_NODE_INDEX(n, bit);\n\tunsigned int ofs = EBITMAP_NODE_OFFSET(n, bit);\n\n\tBUG_ON(index >= EBITMAP_UNIT_NUMS);\n\tif ((n->maps[index] & (EBITMAP_BIT << ofs)))\n\t\treturn 1;\n\treturn 0;\n}",
    "includes": [
      "#include <net/netlabel.h>"
    ],
    "macros_used": [
      "#define EBITMAP_BIT\t\t1ULL",
      "#define EBITMAP_UNIT_NUMS\t((EBITMAP_NODE_SIZE-sizeof(void *)-sizeof(u32))\\\n\t\t\t\t\t/ sizeof(unsigned long))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "index >= EBITMAP_UNIT_NUMS"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBITMAP_NODE_OFFSET",
          "args": [
            "n",
            "bit"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBITMAP_NODE_INDEX",
          "args": [
            "n",
            "bit"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <net/netlabel.h>\n\n#define EBITMAP_BIT\t\t1ULL\n#define EBITMAP_UNIT_NUMS\t((EBITMAP_NODE_SIZE-sizeof(void *)-sizeof(u32))\\\n\t\t\t\t\t/ sizeof(unsigned long))\n\nstatic inline int ebitmap_node_get_bit(struct ebitmap_node *n,\n\t\t\t\t       unsigned int bit)\n{\n\tunsigned int index = EBITMAP_NODE_INDEX(n, bit);\n\tunsigned int ofs = EBITMAP_NODE_OFFSET(n, bit);\n\n\tBUG_ON(index >= EBITMAP_UNIT_NUMS);\n\tif ((n->maps[index] & (EBITMAP_BIT << ofs)))\n\t\treturn 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "ebitmap_next_positive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.h",
    "lines": "65-81",
    "snippet": "static inline unsigned int ebitmap_next_positive(struct ebitmap *e,\n\t\t\t\t\t\t struct ebitmap_node **n,\n\t\t\t\t\t\t unsigned int bit)\n{\n\tunsigned int ofs;\n\n\tofs = find_next_bit((*n)->maps, EBITMAP_SIZE, bit - (*n)->startbit + 1);\n\tif (ofs < EBITMAP_SIZE)\n\t\treturn ofs + (*n)->startbit;\n\n\tfor (*n = (*n)->next; *n; *n = (*n)->next) {\n\t\tofs = find_first_bit((*n)->maps, EBITMAP_SIZE);\n\t\tif (ofs < EBITMAP_SIZE)\n\t\t\treturn ofs + (*n)->startbit;\n\t}\n\treturn ebitmap_length(e);\n}",
    "includes": [
      "#include <net/netlabel.h>"
    ],
    "macros_used": [
      "#define EBITMAP_SIZE\t\t(EBITMAP_UNIT_NUMS * EBITMAP_UNIT_SIZE)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ebitmap_length",
          "args": [
            "e"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_first_bit",
          "args": [
            "(*n)->maps",
            "EBITMAP_SIZE"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_next_bit",
          "args": [
            "(*n)->maps",
            "EBITMAP_SIZE",
            "bit - (*n)->startbit + 1"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <net/netlabel.h>\n\n#define EBITMAP_SIZE\t\t(EBITMAP_UNIT_NUMS * EBITMAP_UNIT_SIZE)\n\nstatic inline unsigned int ebitmap_next_positive(struct ebitmap *e,\n\t\t\t\t\t\t struct ebitmap_node **n,\n\t\t\t\t\t\t unsigned int bit)\n{\n\tunsigned int ofs;\n\n\tofs = find_next_bit((*n)->maps, EBITMAP_SIZE, bit - (*n)->startbit + 1);\n\tif (ofs < EBITMAP_SIZE)\n\t\treturn ofs + (*n)->startbit;\n\n\tfor (*n = (*n)->next; *n; *n = (*n)->next) {\n\t\tofs = find_first_bit((*n)->maps, EBITMAP_SIZE);\n\t\tif (ofs < EBITMAP_SIZE)\n\t\t\treturn ofs + (*n)->startbit;\n\t}\n\treturn ebitmap_length(e);\n}"
  },
  {
    "function_name": "ebitmap_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.h",
    "lines": "60-63",
    "snippet": "static inline void ebitmap_init(struct ebitmap *e)\n{\n\tmemset(e, 0, sizeof(*e));\n}",
    "includes": [
      "#include <net/netlabel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "e",
            "0",
            "sizeof(*e)"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <net/netlabel.h>\n\nstatic inline void ebitmap_init(struct ebitmap *e)\n{\n\tmemset(e, 0, sizeof(*e));\n}"
  },
  {
    "function_name": "ebitmap_start_positive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.h",
    "lines": "47-58",
    "snippet": "static inline unsigned int ebitmap_start_positive(struct ebitmap *e,\n\t\t\t\t\t\t  struct ebitmap_node **n)\n{\n\tunsigned int ofs;\n\n\tfor (*n = e->node; *n; *n = (*n)->next) {\n\t\tofs = find_first_bit((*n)->maps, EBITMAP_SIZE);\n\t\tif (ofs < EBITMAP_SIZE)\n\t\t\treturn (*n)->startbit + ofs;\n\t}\n\treturn ebitmap_length(e);\n}",
    "includes": [
      "#include <net/netlabel.h>"
    ],
    "macros_used": [
      "#define EBITMAP_SIZE\t\t(EBITMAP_UNIT_NUMS * EBITMAP_UNIT_SIZE)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ebitmap_length",
          "args": [
            "e"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_first_bit",
          "args": [
            "(*n)->maps",
            "EBITMAP_SIZE"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <net/netlabel.h>\n\n#define EBITMAP_SIZE\t\t(EBITMAP_UNIT_NUMS * EBITMAP_UNIT_SIZE)\n\nstatic inline unsigned int ebitmap_start_positive(struct ebitmap *e,\n\t\t\t\t\t\t  struct ebitmap_node **n)\n{\n\tunsigned int ofs;\n\n\tfor (*n = e->node; *n; *n = (*n)->next) {\n\t\tofs = find_first_bit((*n)->maps, EBITMAP_SIZE);\n\t\tif (ofs < EBITMAP_SIZE)\n\t\t\treturn (*n)->startbit + ofs;\n\t}\n\treturn ebitmap_length(e);\n}"
  }
]