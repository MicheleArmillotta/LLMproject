[
  {
    "function_name": "storebytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "118-123",
    "snippet": "static inline void storebytes(struct tpm_buf *buf, const unsigned char *in,\n\t\t\t      const int len)\n{\n\tmemcpy(buf->data + buf->len, in, len);\n\tbuf->len += len;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf->data + buf->len",
            "in",
            "len"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void storebytes(struct tpm_buf *buf, const unsigned char *in,\n\t\t\t      const int len)\n{\n\tmemcpy(buf->data + buf->len, in, len);\n\tbuf->len += len;\n}"
  },
  {
    "function_name": "store32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "112-116",
    "snippet": "static inline void store32(struct tpm_buf *buf, const uint32_t value)\n{\n\t*(uint32_t *) & buf->data[buf->len] = htonl(value);\n\tbuf->len += sizeof value;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "value"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void store32(struct tpm_buf *buf, const uint32_t value)\n{\n\t*(uint32_t *) & buf->data[buf->len] = htonl(value);\n\tbuf->len += sizeof value;\n}"
  },
  {
    "function_name": "store16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "106-110",
    "snippet": "static inline void store16(struct tpm_buf *buf, const uint16_t value)\n{\n\t*(uint16_t *) & buf->data[buf->len] = htons(value);\n\tbuf->len += sizeof value;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "htons",
          "args": [
            "value"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void store16(struct tpm_buf *buf, const uint16_t value)\n{\n\t*(uint16_t *) & buf->data[buf->len] = htons(value);\n\tbuf->len += sizeof value;\n}"
  },
  {
    "function_name": "store8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "101-104",
    "snippet": "static inline void store8(struct tpm_buf *buf, const unsigned char value)\n{\n\tbuf->data[buf->len++] = value;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void store8(struct tpm_buf *buf, const unsigned char value)\n{\n\tbuf->data[buf->len++] = value;\n}"
  },
  {
    "function_name": "dump_tpm_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "96-98",
    "snippet": "static inline void dump_tpm_buf(unsigned char *buf)\n{\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void dump_tpm_buf(unsigned char *buf)\n{\n}"
  },
  {
    "function_name": "dump_sess",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "92-94",
    "snippet": "static inline void dump_sess(struct osapsess *s)\n{\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void dump_sess(struct osapsess *s)\n{\n}"
  },
  {
    "function_name": "dump_payload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "88-90",
    "snippet": "static inline void dump_payload(struct trusted_key_payload *p)\n{\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void dump_payload(struct trusted_key_payload *p)\n{\n}"
  },
  {
    "function_name": "dump_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "84-86",
    "snippet": "static inline void dump_options(struct trusted_key_options *o)\n{\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline void dump_options(struct trusted_key_options *o)\n{\n}"
  },
  {
    "function_name": "dump_tpm_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "75-82",
    "snippet": "static inline void dump_tpm_buf(unsigned char *buf)\n{\n\tint len;\n\n\tpr_info(\"\\ntrusted-key: tpm buffer\\n\");\n\tlen = LOAD32(buf, TPM_SIZE_OFFSET);\n\tprint_hex_dump(KERN_INFO, \"\", DUMP_PREFIX_NONE, 16, 1, buf, len, 0);\n}",
    "includes": [],
    "macros_used": [
      "#define TPM_SIZE_OFFSET\t\t\t2"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_hex_dump",
          "args": [
            "KERN_INFO",
            "\"\"",
            "DUMP_PREFIX_NONE",
            "16",
            "1",
            "buf",
            "len",
            "0"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOAD32",
          "args": [
            "buf",
            "TPM_SIZE_OFFSET"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"\\ntrusted-key: tpm buffer\\n\""
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#define TPM_SIZE_OFFSET\t\t\t2\n\nstatic inline void dump_tpm_buf(unsigned char *buf)\n{\n\tint len;\n\n\tpr_info(\"\\ntrusted-key: tpm buffer\\n\");\n\tlen = LOAD32(buf, TPM_SIZE_OFFSET);\n\tprint_hex_dump(KERN_INFO, \"\", DUMP_PREFIX_NONE, 16, 1, buf, len, 0);\n}"
  },
  {
    "function_name": "dump_sess",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "63-73",
    "snippet": "static inline void dump_sess(struct osapsess *s)\n{\n\tprint_hex_dump(KERN_INFO, \"trusted-key: handle \", DUMP_PREFIX_NONE,\n\t\t       16, 1, &s->handle, 4, 0);\n\tpr_info(\"trusted-key: secret:\\n\");\n\tprint_hex_dump(KERN_INFO, \"\", DUMP_PREFIX_NONE,\n\t\t       16, 1, &s->secret, SHA1_DIGEST_SIZE, 0);\n\tpr_info(\"trusted-key: enonce:\\n\");\n\tprint_hex_dump(KERN_INFO, \"\", DUMP_PREFIX_NONE,\n\t\t       16, 1, &s->enonce, SHA1_DIGEST_SIZE, 0);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_hex_dump",
          "args": [
            "KERN_INFO",
            "\"\"",
            "DUMP_PREFIX_NONE",
            "16",
            "1",
            "&s->enonce",
            "SHA1_DIGEST_SIZE",
            "0"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"trusted-key: enonce:\\n\""
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_hex_dump",
          "args": [
            "KERN_INFO",
            "\"\"",
            "DUMP_PREFIX_NONE",
            "16",
            "1",
            "&s->secret",
            "SHA1_DIGEST_SIZE",
            "0"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"trusted-key: secret:\\n\""
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_hex_dump",
          "args": [
            "KERN_INFO",
            "\"trusted-key: handle \"",
            "DUMP_PREFIX_NONE",
            "16",
            "1",
            "&s->handle",
            "4",
            "0"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void dump_sess(struct osapsess *s)\n{\n\tprint_hex_dump(KERN_INFO, \"trusted-key: handle \", DUMP_PREFIX_NONE,\n\t\t       16, 1, &s->handle, 4, 0);\n\tpr_info(\"trusted-key: secret:\\n\");\n\tprint_hex_dump(KERN_INFO, \"\", DUMP_PREFIX_NONE,\n\t\t       16, 1, &s->secret, SHA1_DIGEST_SIZE, 0);\n\tpr_info(\"trusted-key: enonce:\\n\");\n\tprint_hex_dump(KERN_INFO, \"\", DUMP_PREFIX_NONE,\n\t\t       16, 1, &s->enonce, SHA1_DIGEST_SIZE, 0);\n}"
  },
  {
    "function_name": "dump_payload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "52-61",
    "snippet": "static inline void dump_payload(struct trusted_key_payload *p)\n{\n\tpr_info(\"trusted_key: key_len %d\\n\", p->key_len);\n\tprint_hex_dump(KERN_INFO, \"key \", DUMP_PREFIX_NONE,\n\t\t       16, 1, p->key, p->key_len, 0);\n\tpr_info(\"trusted_key: bloblen %d\\n\", p->blob_len);\n\tprint_hex_dump(KERN_INFO, \"blob \", DUMP_PREFIX_NONE,\n\t\t       16, 1, p->blob, p->blob_len, 0);\n\tpr_info(\"trusted_key: migratable %d\\n\", p->migratable);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"trusted_key: migratable %d\\n\"",
            "p->migratable"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_hex_dump",
          "args": [
            "KERN_INFO",
            "\"blob \"",
            "DUMP_PREFIX_NONE",
            "16",
            "1",
            "p->blob",
            "p->blob_len",
            "0"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"trusted_key: bloblen %d\\n\"",
            "p->blob_len"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_hex_dump",
          "args": [
            "KERN_INFO",
            "\"key \"",
            "DUMP_PREFIX_NONE",
            "16",
            "1",
            "p->key",
            "p->key_len",
            "0"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"trusted_key: key_len %d\\n\"",
            "p->key_len"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void dump_payload(struct trusted_key_payload *p)\n{\n\tpr_info(\"trusted_key: key_len %d\\n\", p->key_len);\n\tprint_hex_dump(KERN_INFO, \"key \", DUMP_PREFIX_NONE,\n\t\t       16, 1, p->key, p->key_len, 0);\n\tpr_info(\"trusted_key: bloblen %d\\n\", p->blob_len);\n\tprint_hex_dump(KERN_INFO, \"blob \", DUMP_PREFIX_NONE,\n\t\t       16, 1, p->blob, p->blob_len, 0);\n\tpr_info(\"trusted_key: migratable %d\\n\", p->migratable);\n}"
  },
  {
    "function_name": "dump_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/keys/trusted.h",
    "lines": "42-50",
    "snippet": "static inline void dump_options(struct trusted_key_options *o)\n{\n\tpr_info(\"trusted_key: sealing key type %d\\n\", o->keytype);\n\tpr_info(\"trusted_key: sealing key handle %0X\\n\", o->keyhandle);\n\tpr_info(\"trusted_key: pcrlock %d\\n\", o->pcrlock);\n\tpr_info(\"trusted_key: pcrinfo %d\\n\", o->pcrinfo_len);\n\tprint_hex_dump(KERN_INFO, \"pcrinfo \", DUMP_PREFIX_NONE,\n\t\t       16, 1, o->pcrinfo, o->pcrinfo_len, 0);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_hex_dump",
          "args": [
            "KERN_INFO",
            "\"pcrinfo \"",
            "DUMP_PREFIX_NONE",
            "16",
            "1",
            "o->pcrinfo",
            "o->pcrinfo_len",
            "0"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"trusted_key: pcrinfo %d\\n\"",
            "o->pcrinfo_len"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"trusted_key: pcrlock %d\\n\"",
            "o->pcrlock"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"trusted_key: sealing key handle %0X\\n\"",
            "o->keyhandle"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"trusted_key: sealing key type %d\\n\"",
            "o->keytype"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void dump_options(struct trusted_key_options *o)\n{\n\tpr_info(\"trusted_key: sealing key type %d\\n\", o->keytype);\n\tpr_info(\"trusted_key: sealing key handle %0X\\n\", o->keyhandle);\n\tpr_info(\"trusted_key: pcrlock %d\\n\", o->pcrlock);\n\tpr_info(\"trusted_key: pcrinfo %d\\n\", o->pcrinfo_len);\n\tprint_hex_dump(KERN_INFO, \"pcrinfo \", DUMP_PREFIX_NONE,\n\t\t       16, 1, o->pcrinfo, o->pcrinfo_len, 0);\n}"
  }
]