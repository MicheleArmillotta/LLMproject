[
  {
    "function_name": "__policy_strn_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/lib.h",
    "lines": "186-197",
    "snippet": "static inline struct aa_policy *__policy_strn_find(struct list_head *head,\n\t\t\t\t\t    const char *str, int len)\n{\n\tstruct aa_policy *policy;\n\n\tlist_for_each_entry_rcu(policy, head, list) {\n\t\tif (aa_strneq(policy->name, str, len))\n\t\t\treturn policy;\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"match.h\"",
      "#include <linux/fs.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aa_strneq",
          "args": [
            "policy->name",
            "str",
            "len"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "aa_strneq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/lib.h",
          "lines": "66-69",
          "snippet": "static inline bool aa_strneq(const char *str, const char *sub, int len)\n{\n\treturn !strncmp(str, sub, len) && !str[len];\n}",
          "includes": [
            "#include \"match.h\"",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"match.h\"\n#include <linux/fs.h>\n#include <linux/slab.h>\n\nstatic inline bool aa_strneq(const char *str, const char *sub, int len)\n{\n\treturn !strncmp(str, sub, len) && !str[len];\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "policy",
            "head",
            "list"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"match.h\"\n#include <linux/fs.h>\n#include <linux/slab.h>\n\nstatic inline struct aa_policy *__policy_strn_find(struct list_head *head,\n\t\t\t\t\t    const char *str, int len)\n{\n\tstruct aa_policy *policy;\n\n\tlist_for_each_entry_rcu(policy, head, list) {\n\t\tif (aa_strneq(policy->name, str, len))\n\t\t\treturn policy;\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "__policy_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/lib.h",
    "lines": "161-171",
    "snippet": "static inline struct aa_policy *__policy_find(struct list_head *head,\n\t\t\t\t\t      const char *name)\n{\n\tstruct aa_policy *policy;\n\n\tlist_for_each_entry_rcu(policy, head, list) {\n\t\tif (!strcmp(policy->name, name))\n\t\t\treturn policy;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"match.h\"",
      "#include <linux/fs.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "policy->name",
            "name"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "policy",
            "head",
            "list"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"match.h\"\n#include <linux/fs.h>\n#include <linux/slab.h>\n\nstatic inline struct aa_policy *__policy_find(struct list_head *head,\n\t\t\t\t\t      const char *name)\n{\n\tstruct aa_policy *policy;\n\n\tlist_for_each_entry_rcu(policy, head, list) {\n\t\tif (!strcmp(policy->name, name))\n\t\t\treturn policy;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "basename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/lib.h",
    "lines": "141-150",
    "snippet": "static inline const char *basename(const char *hname)\n{\n\tchar *split;\n\n\thname = strim((char *)hname);\n\tfor (split = strstr(hname, \"//\"); split; split = strstr(hname, \"//\"))\n\t\thname = split + 2;\n\n\treturn hname;\n}",
    "includes": [
      "#include \"match.h\"",
      "#include <linux/fs.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "hname",
            "\"//\""
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "hname",
            "\"//\""
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strim",
          "args": [
            "(char *)hname"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"match.h\"\n#include <linux/fs.h>\n#include <linux/slab.h>\n\nstatic inline const char *basename(const char *hname)\n{\n\tchar *split;\n\n\thname = strim((char *)hname);\n\tfor (split = strstr(hname, \"//\"); split; split = strstr(hname, \"//\"))\n\t\thname = split + 2;\n\n\treturn hname;\n}"
  },
  {
    "function_name": "aa_put_str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/lib.h",
    "lines": "115-119",
    "snippet": "static inline void aa_put_str(__counted char *str)\n{\n\tif (str)\n\t\tkref_put(&str_to_counted(str)->count, aa_str_kref);\n}",
    "includes": [
      "#include \"match.h\"",
      "#include <linux/fs.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [
      "#define __counted\t/* atm just a notation */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_put",
          "args": [
            "&str_to_counted(str)->count",
            "aa_str_kref"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str_to_counted",
          "args": [
            "str"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"match.h\"\n#include <linux/fs.h>\n#include <linux/slab.h>\n\n#define __counted\t/* atm just a notation */\n\nstatic inline void aa_put_str(__counted char *str)\n{\n\tif (str)\n\t\tkref_put(&str_to_counted(str)->count, aa_str_kref);\n}"
  },
  {
    "function_name": "aa_get_str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/lib.h",
    "lines": "107-113",
    "snippet": "static inline __counted char *aa_get_str(__counted char *str)\n{\n\tif (str)\n\t\tkref_get(&(str_to_counted(str)->count));\n\n\treturn str;\n}",
    "includes": [
      "#include \"match.h\"",
      "#include <linux/fs.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [
      "#define __counted\t/* atm just a notation */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_get",
          "args": [
            "&(str_to_counted(str)->count)"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str_to_counted",
          "args": [
            "str"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"match.h\"\n#include <linux/fs.h>\n#include <linux/slab.h>\n\n#define __counted\t/* atm just a notation */\n\nstatic inline __counted char *aa_get_str(__counted char *str)\n{\n\tif (str)\n\t\tkref_get(&(str_to_counted(str)->count));\n\n\treturn str;\n}"
  },
  {
    "function_name": "path_mediated_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/lib.h",
    "lines": "87-90",
    "snippet": "static inline bool path_mediated_fs(struct dentry *dentry)\n{\n\treturn !(dentry->d_sb->s_flags & SB_NOUSER);\n}",
    "includes": [
      "#include \"match.h\"",
      "#include <linux/fs.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"match.h\"\n#include <linux/fs.h>\n#include <linux/slab.h>\n\nstatic inline bool path_mediated_fs(struct dentry *dentry)\n{\n\treturn !(dentry->d_sb->s_flags & SB_NOUSER);\n}"
  },
  {
    "function_name": "aa_dfa_null_transition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/lib.h",
    "lines": "80-85",
    "snippet": "static inline unsigned int aa_dfa_null_transition(struct aa_dfa *dfa,\n\t\t\t\t\t\t  unsigned int start)\n{\n\t/* the null transition only needs the string's null terminator byte */\n\treturn aa_dfa_next(dfa, start, 0);\n}",
    "includes": [
      "#include \"match.h\"",
      "#include <linux/fs.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aa_dfa_next",
          "args": [
            "dfa",
            "start",
            "0"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "aa_dfa_next",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/match.c",
          "lines": "429-459",
          "snippet": "unsigned int aa_dfa_next(struct aa_dfa *dfa, unsigned int state,\n\t\t\t  const char c)\n{\n\tu16 *def = DEFAULT_TABLE(dfa);\n\tu32 *base = BASE_TABLE(dfa);\n\tu16 *next = NEXT_TABLE(dfa);\n\tu16 *check = CHECK_TABLE(dfa);\n\tunsigned int pos;\n\n\t/* current state is <state>, matching character *str */\n\tif (dfa->tables[YYTD_ID_EC]) {\n\t\t/* Equivalence class table defined */\n\t\tu8 *equiv = EQUIV_TABLE(dfa);\n\t\t/* default is direct to next state */\n\n\t\tpos = base_idx(base[state]) + equiv[(u8) c];\n\t\tif (check[pos] == state)\n\t\t\tstate = next[pos];\n\t\telse\n\t\t\tstate = def[state];\n\t} else {\n\t\t/* default is direct to next state */\n\t\tpos = base_idx(base[state]) + (u8) c;\n\t\tif (check[pos] == state)\n\t\t\tstate = next[pos];\n\t\telse\n\t\t\tstate = def[state];\n\t}\n\n\treturn state;\n}",
          "includes": [
            "#include \"include/match.h\"",
            "#include \"include/lib.h\"",
            "#include <linux/kref.h>",
            "#include <linux/err.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"include/match.h\"\n#include \"include/lib.h\"\n#include <linux/kref.h>\n#include <linux/err.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/errno.h>\n\nunsigned int aa_dfa_next(struct aa_dfa *dfa, unsigned int state,\n\t\t\t  const char c)\n{\n\tu16 *def = DEFAULT_TABLE(dfa);\n\tu32 *base = BASE_TABLE(dfa);\n\tu16 *next = NEXT_TABLE(dfa);\n\tu16 *check = CHECK_TABLE(dfa);\n\tunsigned int pos;\n\n\t/* current state is <state>, matching character *str */\n\tif (dfa->tables[YYTD_ID_EC]) {\n\t\t/* Equivalence class table defined */\n\t\tu8 *equiv = EQUIV_TABLE(dfa);\n\t\t/* default is direct to next state */\n\n\t\tpos = base_idx(base[state]) + equiv[(u8) c];\n\t\tif (check[pos] == state)\n\t\t\tstate = next[pos];\n\t\telse\n\t\t\tstate = def[state];\n\t} else {\n\t\t/* default is direct to next state */\n\t\tpos = base_idx(base[state]) + (u8) c;\n\t\tif (check[pos] == state)\n\t\t\tstate = next[pos];\n\t\telse\n\t\t\tstate = def[state];\n\t}\n\n\treturn state;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"match.h\"\n#include <linux/fs.h>\n#include <linux/slab.h>\n\nstatic inline unsigned int aa_dfa_null_transition(struct aa_dfa *dfa,\n\t\t\t\t\t\t  unsigned int start)\n{\n\t/* the null transition only needs the string's null terminator byte */\n\treturn aa_dfa_next(dfa, start, 0);\n}"
  },
  {
    "function_name": "aa_strneq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/include/lib.h",
    "lines": "66-69",
    "snippet": "static inline bool aa_strneq(const char *str, const char *sub, int len)\n{\n\treturn !strncmp(str, sub, len) && !str[len];\n}",
    "includes": [
      "#include \"match.h\"",
      "#include <linux/fs.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "str",
            "sub",
            "len"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"match.h\"\n#include <linux/fs.h>\n#include <linux/slab.h>\n\nstatic inline bool aa_strneq(const char *str, const char *sub, int len)\n{\n\treturn !strncmp(str, sub, len) && !str[len];\n}"
  }
]