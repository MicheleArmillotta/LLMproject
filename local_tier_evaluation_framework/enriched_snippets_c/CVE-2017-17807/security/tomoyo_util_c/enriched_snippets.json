[
  {
    "function_name": "tomoyo_domain_quota_is_ok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "1008-1070",
    "snippet": "bool tomoyo_domain_quota_is_ok(struct tomoyo_request_info *r)\n{\n\tunsigned int count = 0;\n\tstruct tomoyo_domain_info *domain = r->domain;\n\tstruct tomoyo_acl_info *ptr;\n\n\tif (r->mode != TOMOYO_CONFIG_LEARNING)\n\t\treturn false;\n\tif (!domain)\n\t\treturn true;\n\tlist_for_each_entry_rcu(ptr, &domain->acl_info_list, list) {\n\t\tu16 perm;\n\t\tu8 i;\n\t\tif (ptr->is_deleted)\n\t\t\tcontinue;\n\t\tswitch (ptr->type) {\n\t\tcase TOMOYO_TYPE_PATH_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_path_acl, head)\n\t\t\t\t->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_PATH2_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_path2_acl, head)\n\t\t\t\t->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_PATH_NUMBER_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_path_number_acl,\n\t\t\t\t\t    head)->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_MKDEV_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_mkdev_acl,\n\t\t\t\t\t    head)->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_INET_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_inet_acl,\n\t\t\t\t\t    head)->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_UNIX_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_unix_acl,\n\t\t\t\t\t    head)->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_MANUAL_TASK_ACL:\n\t\t\tperm = 0;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tperm = 1;\n\t\t}\n\t\tfor (i = 0; i < 16; i++)\n\t\t\tif (perm & (1 << i))\n\t\t\t\tcount++;\n\t}\n\tif (count < tomoyo_profile(domain->ns, domain->profile)->\n\t    pref[TOMOYO_PREF_MAX_LEARNING_ENTRY])\n\t\treturn true;\n\tif (!domain->flags[TOMOYO_DIF_QUOTA_WARNED]) {\n\t\tdomain->flags[TOMOYO_DIF_QUOTA_WARNED] = true;\n\t\t/* r->granted = false; */\n\t\ttomoyo_write_log(r, \"%s\", tomoyo_dif[TOMOYO_DIF_QUOTA_WARNED]);\n\t\tprintk(KERN_WARNING \"WARNING: \"\n\t\t       \"Domain '%s' has too many ACLs to hold. \"\n\t\t       \"Stopped learning mode.\\n\", domain->domainname->name);\n\t}\n\treturn false;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"WARNING: \"\n\t\t       \"Domain '%s' has too many ACLs to hold. \"\n\t\t       \"Stopped learning mode.\\n\"",
            "domain->domainname->name"
          ],
          "line": 1065
        },
        "resolved": true,
        "details": {
          "function_name": "aa_label_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/apparmor/label.c",
          "lines": "1803-1809",
          "snippet": "void aa_label_printk(struct aa_label *label, gfp_t gfp)\n{\n\tstruct aa_ns *ns = aa_get_current_ns();\n\n\taa_label_xprintk(ns, label, FLAG_VIEW_SUBNS, gfp);\n\taa_put_ns(ns);\n}",
          "includes": [
            "#include \"include/secid.h\"",
            "#include \"include/policy.h\"",
            "#include \"include/label.h\"",
            "#include \"include/context.h\"",
            "#include \"include/apparmor.h\"",
            "#include <linux/sort.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"include/secid.h\"\n#include \"include/policy.h\"\n#include \"include/label.h\"\n#include \"include/context.h\"\n#include \"include/apparmor.h\"\n#include <linux/sort.h>\n#include <linux/seq_file.h>\n#include <linux/audit.h>\n\nvoid aa_label_printk(struct aa_label *label, gfp_t gfp)\n{\n\tstruct aa_ns *ns = aa_get_current_ns();\n\n\taa_label_xprintk(ns, label, FLAG_VIEW_SUBNS, gfp);\n\taa_put_ns(ns);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_write_log",
          "args": [
            "r",
            "\"%s\"",
            "tomoyo_dif[TOMOYO_DIF_QUOTA_WARNED]"
          ],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_write_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/audit.c",
          "lines": "412-422",
          "snippet": "void tomoyo_write_log(struct tomoyo_request_info *r, const char *fmt, ...)\n{\n\tva_list args;\n\tint len;\n\tva_start(args, fmt);\n\tlen = vsnprintf((char *) &len, 1, fmt, args) + 1;\n\tva_end(args);\n\tva_start(args, fmt);\n\ttomoyo_write_log2(r, len, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include \"common.h\"\n\nvoid tomoyo_write_log(struct tomoyo_request_info *r, const char *fmt, ...)\n{\n\tva_list args;\n\tint len;\n\tva_start(args, fmt);\n\tlen = vsnprintf((char *) &len, 1, fmt, args) + 1;\n\tva_end(args);\n\tva_start(args, fmt);\n\ttomoyo_write_log2(r, len, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_profile",
          "args": [
            "domain->ns",
            "domain->profile"
          ],
          "line": 1058
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_profile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/common.c",
          "lines": "528-536",
          "snippet": "struct tomoyo_profile *tomoyo_profile(const struct tomoyo_policy_namespace *ns,\n\t\t\t\t      const u8 profile)\n{\n\tstatic struct tomoyo_profile tomoyo_null_profile;\n\tstruct tomoyo_profile *ptr = ns->profile_ptr[profile];\n\tif (!ptr)\n\t\tptr = &tomoyo_null_profile;\n\treturn ptr;\n}",
          "includes": [
            "#include \"builtin-policy.h\"",
            "#include \"common.h\"",
            "#include <linux/security.h>",
            "#include <linux/slab.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"builtin-policy.h\"\n#include \"common.h\"\n#include <linux/security.h>\n#include <linux/slab.h>\n#include <linux/uaccess.h>\n\nstruct tomoyo_profile *tomoyo_profile(const struct tomoyo_policy_namespace *ns,\n\t\t\t\t      const u8 profile)\n{\n\tstatic struct tomoyo_profile tomoyo_null_profile;\n\tstruct tomoyo_profile *ptr = ns->profile_ptr[profile];\n\tif (!ptr)\n\t\tptr = &tomoyo_null_profile;\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ptr",
            "structtomoyo_unix_acl",
            "head"
          ],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ptr",
            "structtomoyo_inet_acl",
            "head"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ptr",
            "structtomoyo_mkdev_acl",
            "head"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ptr",
            "structtomoyo_path_number_acl",
            "head"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ptr",
            "structtomoyo_path2_acl",
            "head"
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ptr",
            "structtomoyo_path_acl",
            "head"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "ptr",
            "&domain->acl_info_list",
            "list"
          ],
          "line": 1018
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_domain_quota_is_ok(struct tomoyo_request_info *r)\n{\n\tunsigned int count = 0;\n\tstruct tomoyo_domain_info *domain = r->domain;\n\tstruct tomoyo_acl_info *ptr;\n\n\tif (r->mode != TOMOYO_CONFIG_LEARNING)\n\t\treturn false;\n\tif (!domain)\n\t\treturn true;\n\tlist_for_each_entry_rcu(ptr, &domain->acl_info_list, list) {\n\t\tu16 perm;\n\t\tu8 i;\n\t\tif (ptr->is_deleted)\n\t\t\tcontinue;\n\t\tswitch (ptr->type) {\n\t\tcase TOMOYO_TYPE_PATH_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_path_acl, head)\n\t\t\t\t->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_PATH2_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_path2_acl, head)\n\t\t\t\t->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_PATH_NUMBER_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_path_number_acl,\n\t\t\t\t\t    head)->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_MKDEV_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_mkdev_acl,\n\t\t\t\t\t    head)->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_INET_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_inet_acl,\n\t\t\t\t\t    head)->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_UNIX_ACL:\n\t\t\tperm = container_of(ptr, struct tomoyo_unix_acl,\n\t\t\t\t\t    head)->perm;\n\t\t\tbreak;\n\t\tcase TOMOYO_TYPE_MANUAL_TASK_ACL:\n\t\t\tperm = 0;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tperm = 1;\n\t\t}\n\t\tfor (i = 0; i < 16; i++)\n\t\t\tif (perm & (1 << i))\n\t\t\t\tcount++;\n\t}\n\tif (count < tomoyo_profile(domain->ns, domain->profile)->\n\t    pref[TOMOYO_PREF_MAX_LEARNING_ENTRY])\n\t\treturn true;\n\tif (!domain->flags[TOMOYO_DIF_QUOTA_WARNED]) {\n\t\tdomain->flags[TOMOYO_DIF_QUOTA_WARNED] = true;\n\t\t/* r->granted = false; */\n\t\ttomoyo_write_log(r, \"%s\", tomoyo_dif[TOMOYO_DIF_QUOTA_WARNED]);\n\t\tprintk(KERN_WARNING \"WARNING: \"\n\t\t       \"Domain '%s' has too many ACLs to hold. \"\n\t\t       \"Stopped learning mode.\\n\", domain->domainname->name);\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "tomoyo_init_request_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "984-997",
    "snippet": "int tomoyo_init_request_info(struct tomoyo_request_info *r,\n\t\t\t     struct tomoyo_domain_info *domain, const u8 index)\n{\n\tu8 profile;\n\tmemset(r, 0, sizeof(*r));\n\tif (!domain)\n\t\tdomain = tomoyo_domain();\n\tr->domain = domain;\n\tprofile = domain->profile;\n\tr->profile = profile;\n\tr->type = index;\n\tr->mode = tomoyo_get_mode(domain->ns, profile, index);\n\treturn r->mode;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_get_mode",
          "args": [
            "domain->ns",
            "profile",
            "index"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_get_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "957-973",
          "snippet": "int tomoyo_get_mode(const struct tomoyo_policy_namespace *ns, const u8 profile,\n\t\t    const u8 index)\n{\n\tu8 mode;\n\tstruct tomoyo_profile *p;\n\n\tif (!tomoyo_policy_loaded)\n\t\treturn TOMOYO_CONFIG_DISABLED;\n\tp = tomoyo_profile(ns, profile);\n\tmode = p->config[index];\n\tif (mode == TOMOYO_CONFIG_USE_DEFAULT)\n\t\tmode = p->config[tomoyo_index2category[index]\n\t\t\t\t + TOMOYO_MAX_MAC_INDEX];\n\tif (mode == TOMOYO_CONFIG_USE_DEFAULT)\n\t\tmode = p->default_config;\n\treturn mode & 3;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool tomoyo_policy_loaded;",
            "const u8 tomoyo_index2category[TOMOYO_MAX_MAC_INDEX] = {\n\t/* CONFIG::file group */\n\t[TOMOYO_MAC_FILE_EXECUTE]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_OPEN]       = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CREATE]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_UNLINK]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_GETATTR]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKDIR]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_RMDIR]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKFIFO]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKSOCK]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_TRUNCATE]   = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_SYMLINK]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKBLOCK]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKCHAR]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_LINK]       = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_RENAME]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHMOD]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHOWN]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHGRP]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_IOCTL]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHROOT]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MOUNT]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_UMOUNT]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_PIVOT_ROOT] = TOMOYO_MAC_CATEGORY_FILE,\n\t/* CONFIG::network group */\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_BIND]       =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_LISTEN]     =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_CONNECT]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_DGRAM_BIND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_DGRAM_SEND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_RAW_BIND]          =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_RAW_SEND]          =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_BIND]       =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_LISTEN]     =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_CONNECT]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_DGRAM_BIND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_DGRAM_SEND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_BIND]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_LISTEN]  =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_CONNECT] =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t/* CONFIG::misc group */\n\t[TOMOYO_MAC_ENVIRON]         = TOMOYO_MAC_CATEGORY_MISC,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_policy_loaded;\nconst u8 tomoyo_index2category[TOMOYO_MAX_MAC_INDEX] = {\n\t/* CONFIG::file group */\n\t[TOMOYO_MAC_FILE_EXECUTE]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_OPEN]       = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CREATE]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_UNLINK]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_GETATTR]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKDIR]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_RMDIR]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKFIFO]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKSOCK]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_TRUNCATE]   = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_SYMLINK]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKBLOCK]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKCHAR]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_LINK]       = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_RENAME]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHMOD]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHOWN]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHGRP]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_IOCTL]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHROOT]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MOUNT]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_UMOUNT]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_PIVOT_ROOT] = TOMOYO_MAC_CATEGORY_FILE,\n\t/* CONFIG::network group */\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_BIND]       =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_LISTEN]     =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_CONNECT]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_DGRAM_BIND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_DGRAM_SEND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_RAW_BIND]          =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_RAW_SEND]          =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_BIND]       =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_LISTEN]     =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_CONNECT]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_DGRAM_BIND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_DGRAM_SEND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_BIND]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_LISTEN]  =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_CONNECT] =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t/* CONFIG::misc group */\n\t[TOMOYO_MAC_ENVIRON]         = TOMOYO_MAC_CATEGORY_MISC,\n};\n\nint tomoyo_get_mode(const struct tomoyo_policy_namespace *ns, const u8 profile,\n\t\t    const u8 index)\n{\n\tu8 mode;\n\tstruct tomoyo_profile *p;\n\n\tif (!tomoyo_policy_loaded)\n\t\treturn TOMOYO_CONFIG_DISABLED;\n\tp = tomoyo_profile(ns, profile);\n\tmode = p->config[index];\n\tif (mode == TOMOYO_CONFIG_USE_DEFAULT)\n\t\tmode = p->config[tomoyo_index2category[index]\n\t\t\t\t + TOMOYO_MAX_MAC_INDEX];\n\tif (mode == TOMOYO_CONFIG_USE_DEFAULT)\n\t\tmode = p->default_config;\n\treturn mode & 3;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_domain",
          "args": [],
          "line": 990
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_domain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/common.h",
          "lines": "1204-1207",
          "snippet": "static inline struct tomoyo_domain_info *tomoyo_domain(void)\n{\n\treturn current_cred()->security;\n}",
          "includes": [
            "#include <net/udp.h>",
            "#include <net/ipv6.h>",
            "#include <net/ip.h>",
            "#include <net/af_unix.h>",
            "#include <net/sock.h>",
            "#include <linux/un.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/inet.h>",
            "#include <linux/net.h>",
            "#include <linux/highmem.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/poll.h>",
            "#include <linux/cred.h>",
            "#include <linux/list.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/file.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <net/udp.h>\n#include <net/ipv6.h>\n#include <net/ip.h>\n#include <net/af_unix.h>\n#include <net/sock.h>\n#include <linux/un.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/inet.h>\n#include <linux/net.h>\n#include <linux/highmem.h>\n#include <linux/binfmts.h>\n#include <linux/poll.h>\n#include <linux/cred.h>\n#include <linux/list.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/file.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/ctype.h>\n\nstatic inline struct tomoyo_domain_info *tomoyo_domain(void)\n{\n\treturn current_cred()->security;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "r",
            "0",
            "sizeof(*r)"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nint tomoyo_init_request_info(struct tomoyo_request_info *r,\n\t\t\t     struct tomoyo_domain_info *domain, const u8 index)\n{\n\tu8 profile;\n\tmemset(r, 0, sizeof(*r));\n\tif (!domain)\n\t\tdomain = tomoyo_domain();\n\tr->domain = domain;\n\tprofile = domain->profile;\n\tr->profile = profile;\n\tr->type = index;\n\tr->mode = tomoyo_get_mode(domain->ns, profile, index);\n\treturn r->mode;\n}"
  },
  {
    "function_name": "tomoyo_get_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "957-973",
    "snippet": "int tomoyo_get_mode(const struct tomoyo_policy_namespace *ns, const u8 profile,\n\t\t    const u8 index)\n{\n\tu8 mode;\n\tstruct tomoyo_profile *p;\n\n\tif (!tomoyo_policy_loaded)\n\t\treturn TOMOYO_CONFIG_DISABLED;\n\tp = tomoyo_profile(ns, profile);\n\tmode = p->config[index];\n\tif (mode == TOMOYO_CONFIG_USE_DEFAULT)\n\t\tmode = p->config[tomoyo_index2category[index]\n\t\t\t\t + TOMOYO_MAX_MAC_INDEX];\n\tif (mode == TOMOYO_CONFIG_USE_DEFAULT)\n\t\tmode = p->default_config;\n\treturn mode & 3;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool tomoyo_policy_loaded;",
      "const u8 tomoyo_index2category[TOMOYO_MAX_MAC_INDEX] = {\n\t/* CONFIG::file group */\n\t[TOMOYO_MAC_FILE_EXECUTE]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_OPEN]       = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CREATE]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_UNLINK]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_GETATTR]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKDIR]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_RMDIR]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKFIFO]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKSOCK]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_TRUNCATE]   = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_SYMLINK]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKBLOCK]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKCHAR]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_LINK]       = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_RENAME]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHMOD]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHOWN]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHGRP]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_IOCTL]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHROOT]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MOUNT]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_UMOUNT]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_PIVOT_ROOT] = TOMOYO_MAC_CATEGORY_FILE,\n\t/* CONFIG::network group */\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_BIND]       =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_LISTEN]     =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_CONNECT]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_DGRAM_BIND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_DGRAM_SEND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_RAW_BIND]          =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_RAW_SEND]          =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_BIND]       =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_LISTEN]     =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_CONNECT]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_DGRAM_BIND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_DGRAM_SEND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_BIND]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_LISTEN]  =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_CONNECT] =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t/* CONFIG::misc group */\n\t[TOMOYO_MAC_ENVIRON]         = TOMOYO_MAC_CATEGORY_MISC,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_profile",
          "args": [
            "ns",
            "profile"
          ],
          "line": 965
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_profile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/common.c",
          "lines": "528-536",
          "snippet": "struct tomoyo_profile *tomoyo_profile(const struct tomoyo_policy_namespace *ns,\n\t\t\t\t      const u8 profile)\n{\n\tstatic struct tomoyo_profile tomoyo_null_profile;\n\tstruct tomoyo_profile *ptr = ns->profile_ptr[profile];\n\tif (!ptr)\n\t\tptr = &tomoyo_null_profile;\n\treturn ptr;\n}",
          "includes": [
            "#include \"builtin-policy.h\"",
            "#include \"common.h\"",
            "#include <linux/security.h>",
            "#include <linux/slab.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"builtin-policy.h\"\n#include \"common.h\"\n#include <linux/security.h>\n#include <linux/slab.h>\n#include <linux/uaccess.h>\n\nstruct tomoyo_profile *tomoyo_profile(const struct tomoyo_policy_namespace *ns,\n\t\t\t\t      const u8 profile)\n{\n\tstatic struct tomoyo_profile tomoyo_null_profile;\n\tstruct tomoyo_profile *ptr = ns->profile_ptr[profile];\n\tif (!ptr)\n\t\tptr = &tomoyo_null_profile;\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_policy_loaded;\nconst u8 tomoyo_index2category[TOMOYO_MAX_MAC_INDEX] = {\n\t/* CONFIG::file group */\n\t[TOMOYO_MAC_FILE_EXECUTE]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_OPEN]       = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CREATE]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_UNLINK]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_GETATTR]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKDIR]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_RMDIR]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKFIFO]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKSOCK]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_TRUNCATE]   = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_SYMLINK]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKBLOCK]    = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MKCHAR]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_LINK]       = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_RENAME]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHMOD]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHOWN]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHGRP]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_IOCTL]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_CHROOT]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_MOUNT]      = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_UMOUNT]     = TOMOYO_MAC_CATEGORY_FILE,\n\t[TOMOYO_MAC_FILE_PIVOT_ROOT] = TOMOYO_MAC_CATEGORY_FILE,\n\t/* CONFIG::network group */\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_BIND]       =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_LISTEN]     =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_STREAM_CONNECT]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_DGRAM_BIND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_DGRAM_SEND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_RAW_BIND]          =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_INET_RAW_SEND]          =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_BIND]       =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_LISTEN]     =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_STREAM_CONNECT]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_DGRAM_BIND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_DGRAM_SEND]        =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_BIND]    =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_LISTEN]  =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t[TOMOYO_MAC_NETWORK_UNIX_SEQPACKET_CONNECT] =\n\tTOMOYO_MAC_CATEGORY_NETWORK,\n\t/* CONFIG::misc group */\n\t[TOMOYO_MAC_ENVIRON]         = TOMOYO_MAC_CATEGORY_MISC,\n};\n\nint tomoyo_get_mode(const struct tomoyo_policy_namespace *ns, const u8 profile,\n\t\t    const u8 index)\n{\n\tu8 mode;\n\tstruct tomoyo_profile *p;\n\n\tif (!tomoyo_policy_loaded)\n\t\treturn TOMOYO_CONFIG_DISABLED;\n\tp = tomoyo_profile(ns, profile);\n\tmode = p->config[index];\n\tif (mode == TOMOYO_CONFIG_USE_DEFAULT)\n\t\tmode = p->config[tomoyo_index2category[index]\n\t\t\t\t + TOMOYO_MAX_MAC_INDEX];\n\tif (mode == TOMOYO_CONFIG_USE_DEFAULT)\n\t\tmode = p->default_config;\n\treturn mode & 3;\n}"
  },
  {
    "function_name": "tomoyo_get_exe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "931-946",
    "snippet": "const char *tomoyo_get_exe(void)\n{\n\tstruct file *exe_file;\n\tconst char *cp;\n\tstruct mm_struct *mm = current->mm;\n\n\tif (!mm)\n\t\treturn NULL;\n\texe_file = get_mm_exe_file(mm);\n\tif (!exe_file)\n\t\treturn NULL;\n\n\tcp = tomoyo_realpath_from_path(&exe_file->f_path);\n\tfput(exe_file);\n\treturn cp;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fput",
          "args": [
            "exe_file"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tomoyo_realpath_from_path",
          "args": [
            "&exe_file->f_path"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_realpath_from_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/realpath.c",
          "lines": "251-311",
          "snippet": "char *tomoyo_realpath_from_path(const struct path *path)\n{\n\tchar *buf = NULL;\n\tchar *name = NULL;\n\tunsigned int buf_len = PAGE_SIZE / 2;\n\tstruct dentry *dentry = path->dentry;\n\tstruct super_block *sb;\n\tif (!dentry)\n\t\treturn NULL;\n\tsb = dentry->d_sb;\n\twhile (1) {\n\t\tchar *pos;\n\t\tstruct inode *inode;\n\t\tbuf_len <<= 1;\n\t\tkfree(buf);\n\t\tbuf = kmalloc(buf_len, GFP_NOFS);\n\t\tif (!buf)\n\t\t\tbreak;\n\t\t/* To make sure that pos is '\\0' terminated. */\n\t\tbuf[buf_len - 1] = '\\0';\n\t\t/* Get better name for socket. */\n\t\tif (sb->s_magic == SOCKFS_MAGIC) {\n\t\t\tpos = tomoyo_get_socket_name(path, buf, buf_len - 1);\n\t\t\tgoto encode;\n\t\t}\n\t\t/* For \"pipe:[\\$]\". */\n\t\tif (dentry->d_op && dentry->d_op->d_dname) {\n\t\t\tpos = dentry->d_op->d_dname(dentry, buf, buf_len - 1);\n\t\t\tgoto encode;\n\t\t}\n\t\tinode = d_backing_inode(sb->s_root);\n\t\t/*\n\t\t * Get local name for filesystems without rename() operation\n\t\t * or dentry without vfsmount.\n\t\t */\n\t\tif (!path->mnt ||\n\t\t    (!inode->i_op->rename))\n\t\t\tpos = tomoyo_get_local_path(path->dentry, buf,\n\t\t\t\t\t\t    buf_len - 1);\n\t\t/* Get absolute name for the rest. */\n\t\telse {\n\t\t\tpos = tomoyo_get_absolute_path(path, buf, buf_len - 1);\n\t\t\t/*\n\t\t\t * Fall back to local name if absolute name is not\n\t\t\t * available.\n\t\t\t */\n\t\t\tif (pos == ERR_PTR(-EINVAL))\n\t\t\t\tpos = tomoyo_get_local_path(path->dentry, buf,\n\t\t\t\t\t\t\t    buf_len - 1);\n\t\t}\nencode:\n\t\tif (IS_ERR(pos))\n\t\t\tcontinue;\n\t\tname = tomoyo_encode(pos);\n\t\tbreak;\n\t}\n\tkfree(buf);\n\tif (!name)\n\t\ttomoyo_warn_oom(__func__);\n\treturn name;\n}",
          "includes": [
            "#include <linux/magic.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/magic.h>\n#include \"common.h\"\n\nchar *tomoyo_realpath_from_path(const struct path *path)\n{\n\tchar *buf = NULL;\n\tchar *name = NULL;\n\tunsigned int buf_len = PAGE_SIZE / 2;\n\tstruct dentry *dentry = path->dentry;\n\tstruct super_block *sb;\n\tif (!dentry)\n\t\treturn NULL;\n\tsb = dentry->d_sb;\n\twhile (1) {\n\t\tchar *pos;\n\t\tstruct inode *inode;\n\t\tbuf_len <<= 1;\n\t\tkfree(buf);\n\t\tbuf = kmalloc(buf_len, GFP_NOFS);\n\t\tif (!buf)\n\t\t\tbreak;\n\t\t/* To make sure that pos is '\\0' terminated. */\n\t\tbuf[buf_len - 1] = '\\0';\n\t\t/* Get better name for socket. */\n\t\tif (sb->s_magic == SOCKFS_MAGIC) {\n\t\t\tpos = tomoyo_get_socket_name(path, buf, buf_len - 1);\n\t\t\tgoto encode;\n\t\t}\n\t\t/* For \"pipe:[\\$]\". */\n\t\tif (dentry->d_op && dentry->d_op->d_dname) {\n\t\t\tpos = dentry->d_op->d_dname(dentry, buf, buf_len - 1);\n\t\t\tgoto encode;\n\t\t}\n\t\tinode = d_backing_inode(sb->s_root);\n\t\t/*\n\t\t * Get local name for filesystems without rename() operation\n\t\t * or dentry without vfsmount.\n\t\t */\n\t\tif (!path->mnt ||\n\t\t    (!inode->i_op->rename))\n\t\t\tpos = tomoyo_get_local_path(path->dentry, buf,\n\t\t\t\t\t\t    buf_len - 1);\n\t\t/* Get absolute name for the rest. */\n\t\telse {\n\t\t\tpos = tomoyo_get_absolute_path(path, buf, buf_len - 1);\n\t\t\t/*\n\t\t\t * Fall back to local name if absolute name is not\n\t\t\t * available.\n\t\t\t */\n\t\t\tif (pos == ERR_PTR(-EINVAL))\n\t\t\t\tpos = tomoyo_get_local_path(path->dentry, buf,\n\t\t\t\t\t\t\t    buf_len - 1);\n\t\t}\nencode:\n\t\tif (IS_ERR(pos))\n\t\t\tcontinue;\n\t\tname = tomoyo_encode(pos);\n\t\tbreak;\n\t}\n\tkfree(buf);\n\tif (!name)\n\t\ttomoyo_warn_oom(__func__);\n\treturn name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_mm_exe_file",
          "args": [
            "mm"
          ],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nconst char *tomoyo_get_exe(void)\n{\n\tstruct file *exe_file;\n\tconst char *cp;\n\tstruct mm_struct *mm = current->mm;\n\n\tif (!mm)\n\t\treturn NULL;\n\texe_file = get_mm_exe_file(mm);\n\tif (!exe_file)\n\t\treturn NULL;\n\n\tcp = tomoyo_realpath_from_path(&exe_file->f_path);\n\tfput(exe_file);\n\treturn cp;\n}"
  },
  {
    "function_name": "tomoyo_path_matches_pattern",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "902-921",
    "snippet": "bool tomoyo_path_matches_pattern(const struct tomoyo_path_info *filename,\n\t\t\t\t const struct tomoyo_path_info *pattern)\n{\n\tconst char *f = filename->name;\n\tconst char *p = pattern->name;\n\tconst int len = pattern->const_len;\n\n\t/* If @pattern doesn't contain pattern, I can use strcmp(). */\n\tif (!pattern->is_patterned)\n\t\treturn !tomoyo_pathcmp(filename, pattern);\n\t/* Don't compare directory and non-directory. */\n\tif (filename->is_dir != pattern->is_dir)\n\t\treturn false;\n\t/* Compare the initial length without patterns. */\n\tif (strncmp(f, p, len))\n\t\treturn false;\n\tf += len;\n\tp += len;\n\treturn tomoyo_path_matches_pattern2(f, p);\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_path_matches_pattern2",
          "args": [
            "f",
            "p"
          ],
          "line": 920
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_path_matches_pattern2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "819-874",
          "snippet": "static bool tomoyo_path_matches_pattern2(const char *f, const char *p)\n{\n\tconst char *f_delimiter;\n\tconst char *p_delimiter;\n\n\twhile (*f && *p) {\n\t\tf_delimiter = strchr(f, '/');\n\t\tif (!f_delimiter)\n\t\t\tf_delimiter = f + strlen(f);\n\t\tp_delimiter = strchr(p, '/');\n\t\tif (!p_delimiter)\n\t\t\tp_delimiter = p + strlen(p);\n\t\tif (*p == '\\\\' && *(p + 1) == '{')\n\t\t\tgoto recursive;\n\t\tif (!tomoyo_file_matches_pattern(f, f_delimiter, p,\n\t\t\t\t\t\t p_delimiter))\n\t\t\treturn false;\n\t\tf = f_delimiter;\n\t\tif (*f)\n\t\t\tf++;\n\t\tp = p_delimiter;\n\t\tif (*p)\n\t\t\tp++;\n\t}\n\t/* Ignore trailing \"\\*\" and \"\\@\" in @pattern. */\n\twhile (*p == '\\\\' &&\n\t       (*(p + 1) == '*' || *(p + 1) == '@'))\n\t\tp += 2;\n\treturn !*f && !*p;\n recursive:\n\t/*\n\t * The \"\\{\" pattern is permitted only after '/' character.\n\t * This guarantees that below \"*(p - 1)\" is safe.\n\t * Also, the \"\\}\" pattern is permitted only before '/' character\n\t * so that \"\\{\" + \"\\}\" pair will not break the \"\\-\" operator.\n\t */\n\tif (*(p - 1) != '/' || p_delimiter <= p + 3 || *p_delimiter != '/' ||\n\t    *(p_delimiter - 1) != '}' || *(p_delimiter - 2) != '\\\\')\n\t\treturn false; /* Bad pattern. */\n\tdo {\n\t\t/* Compare current component with pattern. */\n\t\tif (!tomoyo_file_matches_pattern(f, f_delimiter, p + 2,\n\t\t\t\t\t\t p_delimiter - 2))\n\t\t\tbreak;\n\t\t/* Proceed to next component. */\n\t\tf = f_delimiter;\n\t\tif (!*f)\n\t\t\tbreak;\n\t\tf++;\n\t\t/* Continue comparison. */\n\t\tif (tomoyo_path_matches_pattern2(f, p_delimiter + 1))\n\t\t\treturn true;\n\t\tf_delimiter = strchr(f, '/');\n\t} while (f_delimiter);\n\treturn false; /* Not matched. */\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic bool tomoyo_path_matches_pattern2(const char *f, const char *p)\n{\n\tconst char *f_delimiter;\n\tconst char *p_delimiter;\n\n\twhile (*f && *p) {\n\t\tf_delimiter = strchr(f, '/');\n\t\tif (!f_delimiter)\n\t\t\tf_delimiter = f + strlen(f);\n\t\tp_delimiter = strchr(p, '/');\n\t\tif (!p_delimiter)\n\t\t\tp_delimiter = p + strlen(p);\n\t\tif (*p == '\\\\' && *(p + 1) == '{')\n\t\t\tgoto recursive;\n\t\tif (!tomoyo_file_matches_pattern(f, f_delimiter, p,\n\t\t\t\t\t\t p_delimiter))\n\t\t\treturn false;\n\t\tf = f_delimiter;\n\t\tif (*f)\n\t\t\tf++;\n\t\tp = p_delimiter;\n\t\tif (*p)\n\t\t\tp++;\n\t}\n\t/* Ignore trailing \"\\*\" and \"\\@\" in @pattern. */\n\twhile (*p == '\\\\' &&\n\t       (*(p + 1) == '*' || *(p + 1) == '@'))\n\t\tp += 2;\n\treturn !*f && !*p;\n recursive:\n\t/*\n\t * The \"\\{\" pattern is permitted only after '/' character.\n\t * This guarantees that below \"*(p - 1)\" is safe.\n\t * Also, the \"\\}\" pattern is permitted only before '/' character\n\t * so that \"\\{\" + \"\\}\" pair will not break the \"\\-\" operator.\n\t */\n\tif (*(p - 1) != '/' || p_delimiter <= p + 3 || *p_delimiter != '/' ||\n\t    *(p_delimiter - 1) != '}' || *(p_delimiter - 2) != '\\\\')\n\t\treturn false; /* Bad pattern. */\n\tdo {\n\t\t/* Compare current component with pattern. */\n\t\tif (!tomoyo_file_matches_pattern(f, f_delimiter, p + 2,\n\t\t\t\t\t\t p_delimiter - 2))\n\t\t\tbreak;\n\t\t/* Proceed to next component. */\n\t\tf = f_delimiter;\n\t\tif (!*f)\n\t\t\tbreak;\n\t\tf++;\n\t\t/* Continue comparison. */\n\t\tif (tomoyo_path_matches_pattern2(f, p_delimiter + 1))\n\t\t\treturn true;\n\t\tf_delimiter = strchr(f, '/');\n\t} while (f_delimiter);\n\treturn false; /* Not matched. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "f",
            "p",
            "len"
          ],
          "line": 916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tomoyo_pathcmp",
          "args": [
            "filename",
            "pattern"
          ],
          "line": 911
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_pathcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/common.h",
          "lines": "1151-1155",
          "snippet": "static inline bool tomoyo_pathcmp(const struct tomoyo_path_info *a,\n\t\t\t\t  const struct tomoyo_path_info *b)\n{\n\treturn a->hash != b->hash || strcmp(a->name, b->name);\n}",
          "includes": [
            "#include <net/udp.h>",
            "#include <net/ipv6.h>",
            "#include <net/ip.h>",
            "#include <net/af_unix.h>",
            "#include <net/sock.h>",
            "#include <linux/un.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/inet.h>",
            "#include <linux/net.h>",
            "#include <linux/highmem.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/poll.h>",
            "#include <linux/cred.h>",
            "#include <linux/list.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/file.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <net/udp.h>\n#include <net/ipv6.h>\n#include <net/ip.h>\n#include <net/af_unix.h>\n#include <net/sock.h>\n#include <linux/un.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/inet.h>\n#include <linux/net.h>\n#include <linux/highmem.h>\n#include <linux/binfmts.h>\n#include <linux/poll.h>\n#include <linux/cred.h>\n#include <linux/list.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/file.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/ctype.h>\n\nstatic inline bool tomoyo_pathcmp(const struct tomoyo_path_info *a,\n\t\t\t\t  const struct tomoyo_path_info *b)\n{\n\treturn a->hash != b->hash || strcmp(a->name, b->name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_path_matches_pattern(const struct tomoyo_path_info *filename,\n\t\t\t\t const struct tomoyo_path_info *pattern)\n{\n\tconst char *f = filename->name;\n\tconst char *p = pattern->name;\n\tconst int len = pattern->const_len;\n\n\t/* If @pattern doesn't contain pattern, I can use strcmp(). */\n\tif (!pattern->is_patterned)\n\t\treturn !tomoyo_pathcmp(filename, pattern);\n\t/* Don't compare directory and non-directory. */\n\tif (filename->is_dir != pattern->is_dir)\n\t\treturn false;\n\t/* Compare the initial length without patterns. */\n\tif (strncmp(f, p, len))\n\t\treturn false;\n\tf += len;\n\tp += len;\n\treturn tomoyo_path_matches_pattern2(f, p);\n}"
  },
  {
    "function_name": "tomoyo_path_matches_pattern2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "819-874",
    "snippet": "static bool tomoyo_path_matches_pattern2(const char *f, const char *p)\n{\n\tconst char *f_delimiter;\n\tconst char *p_delimiter;\n\n\twhile (*f && *p) {\n\t\tf_delimiter = strchr(f, '/');\n\t\tif (!f_delimiter)\n\t\t\tf_delimiter = f + strlen(f);\n\t\tp_delimiter = strchr(p, '/');\n\t\tif (!p_delimiter)\n\t\t\tp_delimiter = p + strlen(p);\n\t\tif (*p == '\\\\' && *(p + 1) == '{')\n\t\t\tgoto recursive;\n\t\tif (!tomoyo_file_matches_pattern(f, f_delimiter, p,\n\t\t\t\t\t\t p_delimiter))\n\t\t\treturn false;\n\t\tf = f_delimiter;\n\t\tif (*f)\n\t\t\tf++;\n\t\tp = p_delimiter;\n\t\tif (*p)\n\t\t\tp++;\n\t}\n\t/* Ignore trailing \"\\*\" and \"\\@\" in @pattern. */\n\twhile (*p == '\\\\' &&\n\t       (*(p + 1) == '*' || *(p + 1) == '@'))\n\t\tp += 2;\n\treturn !*f && !*p;\n recursive:\n\t/*\n\t * The \"\\{\" pattern is permitted only after '/' character.\n\t * This guarantees that below \"*(p - 1)\" is safe.\n\t * Also, the \"\\}\" pattern is permitted only before '/' character\n\t * so that \"\\{\" + \"\\}\" pair will not break the \"\\-\" operator.\n\t */\n\tif (*(p - 1) != '/' || p_delimiter <= p + 3 || *p_delimiter != '/' ||\n\t    *(p_delimiter - 1) != '}' || *(p_delimiter - 2) != '\\\\')\n\t\treturn false; /* Bad pattern. */\n\tdo {\n\t\t/* Compare current component with pattern. */\n\t\tif (!tomoyo_file_matches_pattern(f, f_delimiter, p + 2,\n\t\t\t\t\t\t p_delimiter - 2))\n\t\t\tbreak;\n\t\t/* Proceed to next component. */\n\t\tf = f_delimiter;\n\t\tif (!*f)\n\t\t\tbreak;\n\t\tf++;\n\t\t/* Continue comparison. */\n\t\tif (tomoyo_path_matches_pattern2(f, p_delimiter + 1))\n\t\t\treturn true;\n\t\tf_delimiter = strchr(f, '/');\n\t} while (f_delimiter);\n\treturn false; /* Not matched. */\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "f",
            "'/'"
          ],
          "line": 871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tomoyo_path_matches_pattern2",
          "args": [
            "f",
            "p_delimiter + 1"
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_path_matches_pattern2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "819-874",
          "snippet": "static bool tomoyo_path_matches_pattern2(const char *f, const char *p)\n{\n\tconst char *f_delimiter;\n\tconst char *p_delimiter;\n\n\twhile (*f && *p) {\n\t\tf_delimiter = strchr(f, '/');\n\t\tif (!f_delimiter)\n\t\t\tf_delimiter = f + strlen(f);\n\t\tp_delimiter = strchr(p, '/');\n\t\tif (!p_delimiter)\n\t\t\tp_delimiter = p + strlen(p);\n\t\tif (*p == '\\\\' && *(p + 1) == '{')\n\t\t\tgoto recursive;\n\t\tif (!tomoyo_file_matches_pattern(f, f_delimiter, p,\n\t\t\t\t\t\t p_delimiter))\n\t\t\treturn false;\n\t\tf = f_delimiter;\n\t\tif (*f)\n\t\t\tf++;\n\t\tp = p_delimiter;\n\t\tif (*p)\n\t\t\tp++;\n\t}\n\t/* Ignore trailing \"\\*\" and \"\\@\" in @pattern. */\n\twhile (*p == '\\\\' &&\n\t       (*(p + 1) == '*' || *(p + 1) == '@'))\n\t\tp += 2;\n\treturn !*f && !*p;\n recursive:\n\t/*\n\t * The \"\\{\" pattern is permitted only after '/' character.\n\t * This guarantees that below \"*(p - 1)\" is safe.\n\t * Also, the \"\\}\" pattern is permitted only before '/' character\n\t * so that \"\\{\" + \"\\}\" pair will not break the \"\\-\" operator.\n\t */\n\tif (*(p - 1) != '/' || p_delimiter <= p + 3 || *p_delimiter != '/' ||\n\t    *(p_delimiter - 1) != '}' || *(p_delimiter - 2) != '\\\\')\n\t\treturn false; /* Bad pattern. */\n\tdo {\n\t\t/* Compare current component with pattern. */\n\t\tif (!tomoyo_file_matches_pattern(f, f_delimiter, p + 2,\n\t\t\t\t\t\t p_delimiter - 2))\n\t\t\tbreak;\n\t\t/* Proceed to next component. */\n\t\tf = f_delimiter;\n\t\tif (!*f)\n\t\t\tbreak;\n\t\tf++;\n\t\t/* Continue comparison. */\n\t\tif (tomoyo_path_matches_pattern2(f, p_delimiter + 1))\n\t\t\treturn true;\n\t\tf_delimiter = strchr(f, '/');\n\t} while (f_delimiter);\n\treturn false; /* Not matched. */\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_file_matches_pattern",
          "args": [
            "f",
            "f_delimiter",
            "p + 2",
            "p_delimiter - 2"
          ],
          "line": 860
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_file_matches_pattern",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "782-809",
          "snippet": "static bool tomoyo_file_matches_pattern(const char *filename,\n\t\t\t\t\tconst char *filename_end,\n\t\t\t\t\tconst char *pattern,\n\t\t\t\t\tconst char *pattern_end)\n{\n\tconst char *pattern_start = pattern;\n\tbool first = true;\n\tbool result;\n\n\twhile (pattern < pattern_end - 1) {\n\t\t/* Split at \"\\-\" pattern. */\n\t\tif (*pattern++ != '\\\\' || *pattern++ != '-')\n\t\t\tcontinue;\n\t\tresult = tomoyo_file_matches_pattern2(filename,\n\t\t\t\t\t\t      filename_end,\n\t\t\t\t\t\t      pattern_start,\n\t\t\t\t\t\t      pattern - 2);\n\t\tif (first)\n\t\t\tresult = !result;\n\t\tif (result)\n\t\t\treturn false;\n\t\tfirst = false;\n\t\tpattern_start = pattern;\n\t}\n\tresult = tomoyo_file_matches_pattern2(filename, filename_end,\n\t\t\t\t\t      pattern_start, pattern_end);\n\treturn first ? result : !result;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic bool tomoyo_file_matches_pattern(const char *filename,\n\t\t\t\t\tconst char *filename_end,\n\t\t\t\t\tconst char *pattern,\n\t\t\t\t\tconst char *pattern_end)\n{\n\tconst char *pattern_start = pattern;\n\tbool first = true;\n\tbool result;\n\n\twhile (pattern < pattern_end - 1) {\n\t\t/* Split at \"\\-\" pattern. */\n\t\tif (*pattern++ != '\\\\' || *pattern++ != '-')\n\t\t\tcontinue;\n\t\tresult = tomoyo_file_matches_pattern2(filename,\n\t\t\t\t\t\t      filename_end,\n\t\t\t\t\t\t      pattern_start,\n\t\t\t\t\t\t      pattern - 2);\n\t\tif (first)\n\t\t\tresult = !result;\n\t\tif (result)\n\t\t\treturn false;\n\t\tfirst = false;\n\t\tpattern_start = pattern;\n\t}\n\tresult = tomoyo_file_matches_pattern2(filename, filename_end,\n\t\t\t\t\t      pattern_start, pattern_end);\n\treturn first ? result : !result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "p"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "p",
            "'/'"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "f"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "f",
            "'/'"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic bool tomoyo_path_matches_pattern2(const char *f, const char *p)\n{\n\tconst char *f_delimiter;\n\tconst char *p_delimiter;\n\n\twhile (*f && *p) {\n\t\tf_delimiter = strchr(f, '/');\n\t\tif (!f_delimiter)\n\t\t\tf_delimiter = f + strlen(f);\n\t\tp_delimiter = strchr(p, '/');\n\t\tif (!p_delimiter)\n\t\t\tp_delimiter = p + strlen(p);\n\t\tif (*p == '\\\\' && *(p + 1) == '{')\n\t\t\tgoto recursive;\n\t\tif (!tomoyo_file_matches_pattern(f, f_delimiter, p,\n\t\t\t\t\t\t p_delimiter))\n\t\t\treturn false;\n\t\tf = f_delimiter;\n\t\tif (*f)\n\t\t\tf++;\n\t\tp = p_delimiter;\n\t\tif (*p)\n\t\t\tp++;\n\t}\n\t/* Ignore trailing \"\\*\" and \"\\@\" in @pattern. */\n\twhile (*p == '\\\\' &&\n\t       (*(p + 1) == '*' || *(p + 1) == '@'))\n\t\tp += 2;\n\treturn !*f && !*p;\n recursive:\n\t/*\n\t * The \"\\{\" pattern is permitted only after '/' character.\n\t * This guarantees that below \"*(p - 1)\" is safe.\n\t * Also, the \"\\}\" pattern is permitted only before '/' character\n\t * so that \"\\{\" + \"\\}\" pair will not break the \"\\-\" operator.\n\t */\n\tif (*(p - 1) != '/' || p_delimiter <= p + 3 || *p_delimiter != '/' ||\n\t    *(p_delimiter - 1) != '}' || *(p_delimiter - 2) != '\\\\')\n\t\treturn false; /* Bad pattern. */\n\tdo {\n\t\t/* Compare current component with pattern. */\n\t\tif (!tomoyo_file_matches_pattern(f, f_delimiter, p + 2,\n\t\t\t\t\t\t p_delimiter - 2))\n\t\t\tbreak;\n\t\t/* Proceed to next component. */\n\t\tf = f_delimiter;\n\t\tif (!*f)\n\t\t\tbreak;\n\t\tf++;\n\t\t/* Continue comparison. */\n\t\tif (tomoyo_path_matches_pattern2(f, p_delimiter + 1))\n\t\t\treturn true;\n\t\tf_delimiter = strchr(f, '/');\n\t} while (f_delimiter);\n\treturn false; /* Not matched. */\n}"
  },
  {
    "function_name": "tomoyo_file_matches_pattern",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "782-809",
    "snippet": "static bool tomoyo_file_matches_pattern(const char *filename,\n\t\t\t\t\tconst char *filename_end,\n\t\t\t\t\tconst char *pattern,\n\t\t\t\t\tconst char *pattern_end)\n{\n\tconst char *pattern_start = pattern;\n\tbool first = true;\n\tbool result;\n\n\twhile (pattern < pattern_end - 1) {\n\t\t/* Split at \"\\-\" pattern. */\n\t\tif (*pattern++ != '\\\\' || *pattern++ != '-')\n\t\t\tcontinue;\n\t\tresult = tomoyo_file_matches_pattern2(filename,\n\t\t\t\t\t\t      filename_end,\n\t\t\t\t\t\t      pattern_start,\n\t\t\t\t\t\t      pattern - 2);\n\t\tif (first)\n\t\t\tresult = !result;\n\t\tif (result)\n\t\t\treturn false;\n\t\tfirst = false;\n\t\tpattern_start = pattern;\n\t}\n\tresult = tomoyo_file_matches_pattern2(filename, filename_end,\n\t\t\t\t\t      pattern_start, pattern_end);\n\treturn first ? result : !result;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_file_matches_pattern2",
          "args": [
            "filename",
            "filename_end",
            "pattern_start",
            "pattern_end"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_file_matches_pattern2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "664-770",
          "snippet": "static bool tomoyo_file_matches_pattern2(const char *filename,\n\t\t\t\t\t const char *filename_end,\n\t\t\t\t\t const char *pattern,\n\t\t\t\t\t const char *pattern_end)\n{\n\twhile (filename < filename_end && pattern < pattern_end) {\n\t\tchar c;\n\t\tif (*pattern != '\\\\') {\n\t\t\tif (*filename++ != *pattern++)\n\t\t\t\treturn false;\n\t\t\tcontinue;\n\t\t}\n\t\tc = *filename;\n\t\tpattern++;\n\t\tswitch (*pattern) {\n\t\t\tint i;\n\t\t\tint j;\n\t\tcase '?':\n\t\t\tif (c == '/') {\n\t\t\t\treturn false;\n\t\t\t} else if (c == '\\\\') {\n\t\t\t\tif (filename[1] == '\\\\')\n\t\t\t\t\tfilename++;\n\t\t\t\telse if (tomoyo_byte_range(filename + 1))\n\t\t\t\t\tfilename += 3;\n\t\t\t\telse\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '\\\\':\n\t\t\tif (c != '\\\\')\n\t\t\t\treturn false;\n\t\t\tif (*++filename != '\\\\')\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase '+':\n\t\t\tif (!isdigit(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\tif (!isxdigit(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase 'a':\n\t\t\tif (!tomoyo_alphabet_char(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase '0':\n\t\tcase '1':\n\t\tcase '2':\n\t\tcase '3':\n\t\t\tif (c == '\\\\' && tomoyo_byte_range(filename + 1)\n\t\t\t    && strncmp(filename + 1, pattern, 3) == 0) {\n\t\t\t\tfilename += 3;\n\t\t\t\tpattern += 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn false; /* Not matched. */\n\t\tcase '*':\n\t\tcase '@':\n\t\t\tfor (i = 0; i <= filename_end - filename; i++) {\n\t\t\t\tif (tomoyo_file_matches_pattern2(\n\t\t\t\t\t\t    filename + i, filename_end,\n\t\t\t\t\t\t    pattern + 1, pattern_end))\n\t\t\t\t\treturn true;\n\t\t\t\tc = filename[i];\n\t\t\t\tif (c == '.' && *pattern == '@')\n\t\t\t\t\tbreak;\n\t\t\t\tif (c != '\\\\')\n\t\t\t\t\tcontinue;\n\t\t\t\tif (filename[i + 1] == '\\\\')\n\t\t\t\t\ti++;\n\t\t\t\telse if (tomoyo_byte_range(filename + i + 1))\n\t\t\t\t\ti += 3;\n\t\t\t\telse\n\t\t\t\t\tbreak; /* Bad pattern. */\n\t\t\t}\n\t\t\treturn false; /* Not matched. */\n\t\tdefault:\n\t\t\tj = 0;\n\t\t\tc = *pattern;\n\t\t\tif (c == '$') {\n\t\t\t\twhile (isdigit(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t} else if (c == 'X') {\n\t\t\t\twhile (isxdigit(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t} else if (c == 'A') {\n\t\t\t\twhile (tomoyo_alphabet_char(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t}\n\t\t\tfor (i = 1; i <= j; i++) {\n\t\t\t\tif (tomoyo_file_matches_pattern2(\n\t\t\t\t\t\t    filename + i, filename_end,\n\t\t\t\t\t\t    pattern + 1, pattern_end))\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false; /* Not matched or bad pattern. */\n\t\t}\n\t\tfilename++;\n\t\tpattern++;\n\t}\n\twhile (*pattern == '\\\\' &&\n\t       (*(pattern + 1) == '*' || *(pattern + 1) == '@'))\n\t\tpattern += 2;\n\treturn filename == filename_end && pattern == pattern_end;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic bool tomoyo_file_matches_pattern2(const char *filename,\n\t\t\t\t\t const char *filename_end,\n\t\t\t\t\t const char *pattern,\n\t\t\t\t\t const char *pattern_end)\n{\n\twhile (filename < filename_end && pattern < pattern_end) {\n\t\tchar c;\n\t\tif (*pattern != '\\\\') {\n\t\t\tif (*filename++ != *pattern++)\n\t\t\t\treturn false;\n\t\t\tcontinue;\n\t\t}\n\t\tc = *filename;\n\t\tpattern++;\n\t\tswitch (*pattern) {\n\t\t\tint i;\n\t\t\tint j;\n\t\tcase '?':\n\t\t\tif (c == '/') {\n\t\t\t\treturn false;\n\t\t\t} else if (c == '\\\\') {\n\t\t\t\tif (filename[1] == '\\\\')\n\t\t\t\t\tfilename++;\n\t\t\t\telse if (tomoyo_byte_range(filename + 1))\n\t\t\t\t\tfilename += 3;\n\t\t\t\telse\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '\\\\':\n\t\t\tif (c != '\\\\')\n\t\t\t\treturn false;\n\t\t\tif (*++filename != '\\\\')\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase '+':\n\t\t\tif (!isdigit(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\tif (!isxdigit(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase 'a':\n\t\t\tif (!tomoyo_alphabet_char(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase '0':\n\t\tcase '1':\n\t\tcase '2':\n\t\tcase '3':\n\t\t\tif (c == '\\\\' && tomoyo_byte_range(filename + 1)\n\t\t\t    && strncmp(filename + 1, pattern, 3) == 0) {\n\t\t\t\tfilename += 3;\n\t\t\t\tpattern += 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn false; /* Not matched. */\n\t\tcase '*':\n\t\tcase '@':\n\t\t\tfor (i = 0; i <= filename_end - filename; i++) {\n\t\t\t\tif (tomoyo_file_matches_pattern2(\n\t\t\t\t\t\t    filename + i, filename_end,\n\t\t\t\t\t\t    pattern + 1, pattern_end))\n\t\t\t\t\treturn true;\n\t\t\t\tc = filename[i];\n\t\t\t\tif (c == '.' && *pattern == '@')\n\t\t\t\t\tbreak;\n\t\t\t\tif (c != '\\\\')\n\t\t\t\t\tcontinue;\n\t\t\t\tif (filename[i + 1] == '\\\\')\n\t\t\t\t\ti++;\n\t\t\t\telse if (tomoyo_byte_range(filename + i + 1))\n\t\t\t\t\ti += 3;\n\t\t\t\telse\n\t\t\t\t\tbreak; /* Bad pattern. */\n\t\t\t}\n\t\t\treturn false; /* Not matched. */\n\t\tdefault:\n\t\t\tj = 0;\n\t\t\tc = *pattern;\n\t\t\tif (c == '$') {\n\t\t\t\twhile (isdigit(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t} else if (c == 'X') {\n\t\t\t\twhile (isxdigit(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t} else if (c == 'A') {\n\t\t\t\twhile (tomoyo_alphabet_char(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t}\n\t\t\tfor (i = 1; i <= j; i++) {\n\t\t\t\tif (tomoyo_file_matches_pattern2(\n\t\t\t\t\t\t    filename + i, filename_end,\n\t\t\t\t\t\t    pattern + 1, pattern_end))\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false; /* Not matched or bad pattern. */\n\t\t}\n\t\tfilename++;\n\t\tpattern++;\n\t}\n\twhile (*pattern == '\\\\' &&\n\t       (*(pattern + 1) == '*' || *(pattern + 1) == '@'))\n\t\tpattern += 2;\n\treturn filename == filename_end && pattern == pattern_end;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic bool tomoyo_file_matches_pattern(const char *filename,\n\t\t\t\t\tconst char *filename_end,\n\t\t\t\t\tconst char *pattern,\n\t\t\t\t\tconst char *pattern_end)\n{\n\tconst char *pattern_start = pattern;\n\tbool first = true;\n\tbool result;\n\n\twhile (pattern < pattern_end - 1) {\n\t\t/* Split at \"\\-\" pattern. */\n\t\tif (*pattern++ != '\\\\' || *pattern++ != '-')\n\t\t\tcontinue;\n\t\tresult = tomoyo_file_matches_pattern2(filename,\n\t\t\t\t\t\t      filename_end,\n\t\t\t\t\t\t      pattern_start,\n\t\t\t\t\t\t      pattern - 2);\n\t\tif (first)\n\t\t\tresult = !result;\n\t\tif (result)\n\t\t\treturn false;\n\t\tfirst = false;\n\t\tpattern_start = pattern;\n\t}\n\tresult = tomoyo_file_matches_pattern2(filename, filename_end,\n\t\t\t\t\t      pattern_start, pattern_end);\n\treturn first ? result : !result;\n}"
  },
  {
    "function_name": "tomoyo_file_matches_pattern2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "664-770",
    "snippet": "static bool tomoyo_file_matches_pattern2(const char *filename,\n\t\t\t\t\t const char *filename_end,\n\t\t\t\t\t const char *pattern,\n\t\t\t\t\t const char *pattern_end)\n{\n\twhile (filename < filename_end && pattern < pattern_end) {\n\t\tchar c;\n\t\tif (*pattern != '\\\\') {\n\t\t\tif (*filename++ != *pattern++)\n\t\t\t\treturn false;\n\t\t\tcontinue;\n\t\t}\n\t\tc = *filename;\n\t\tpattern++;\n\t\tswitch (*pattern) {\n\t\t\tint i;\n\t\t\tint j;\n\t\tcase '?':\n\t\t\tif (c == '/') {\n\t\t\t\treturn false;\n\t\t\t} else if (c == '\\\\') {\n\t\t\t\tif (filename[1] == '\\\\')\n\t\t\t\t\tfilename++;\n\t\t\t\telse if (tomoyo_byte_range(filename + 1))\n\t\t\t\t\tfilename += 3;\n\t\t\t\telse\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '\\\\':\n\t\t\tif (c != '\\\\')\n\t\t\t\treturn false;\n\t\t\tif (*++filename != '\\\\')\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase '+':\n\t\t\tif (!isdigit(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\tif (!isxdigit(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase 'a':\n\t\t\tif (!tomoyo_alphabet_char(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase '0':\n\t\tcase '1':\n\t\tcase '2':\n\t\tcase '3':\n\t\t\tif (c == '\\\\' && tomoyo_byte_range(filename + 1)\n\t\t\t    && strncmp(filename + 1, pattern, 3) == 0) {\n\t\t\t\tfilename += 3;\n\t\t\t\tpattern += 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn false; /* Not matched. */\n\t\tcase '*':\n\t\tcase '@':\n\t\t\tfor (i = 0; i <= filename_end - filename; i++) {\n\t\t\t\tif (tomoyo_file_matches_pattern2(\n\t\t\t\t\t\t    filename + i, filename_end,\n\t\t\t\t\t\t    pattern + 1, pattern_end))\n\t\t\t\t\treturn true;\n\t\t\t\tc = filename[i];\n\t\t\t\tif (c == '.' && *pattern == '@')\n\t\t\t\t\tbreak;\n\t\t\t\tif (c != '\\\\')\n\t\t\t\t\tcontinue;\n\t\t\t\tif (filename[i + 1] == '\\\\')\n\t\t\t\t\ti++;\n\t\t\t\telse if (tomoyo_byte_range(filename + i + 1))\n\t\t\t\t\ti += 3;\n\t\t\t\telse\n\t\t\t\t\tbreak; /* Bad pattern. */\n\t\t\t}\n\t\t\treturn false; /* Not matched. */\n\t\tdefault:\n\t\t\tj = 0;\n\t\t\tc = *pattern;\n\t\t\tif (c == '$') {\n\t\t\t\twhile (isdigit(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t} else if (c == 'X') {\n\t\t\t\twhile (isxdigit(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t} else if (c == 'A') {\n\t\t\t\twhile (tomoyo_alphabet_char(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t}\n\t\t\tfor (i = 1; i <= j; i++) {\n\t\t\t\tif (tomoyo_file_matches_pattern2(\n\t\t\t\t\t\t    filename + i, filename_end,\n\t\t\t\t\t\t    pattern + 1, pattern_end))\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false; /* Not matched or bad pattern. */\n\t\t}\n\t\tfilename++;\n\t\tpattern++;\n\t}\n\twhile (*pattern == '\\\\' &&\n\t       (*(pattern + 1) == '*' || *(pattern + 1) == '@'))\n\t\tpattern += 2;\n\treturn filename == filename_end && pattern == pattern_end;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_file_matches_pattern2",
          "args": [
            "filename + i",
            "filename_end",
            "pattern + 1",
            "pattern_end"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_file_matches_pattern2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "664-770",
          "snippet": "static bool tomoyo_file_matches_pattern2(const char *filename,\n\t\t\t\t\t const char *filename_end,\n\t\t\t\t\t const char *pattern,\n\t\t\t\t\t const char *pattern_end)\n{\n\twhile (filename < filename_end && pattern < pattern_end) {\n\t\tchar c;\n\t\tif (*pattern != '\\\\') {\n\t\t\tif (*filename++ != *pattern++)\n\t\t\t\treturn false;\n\t\t\tcontinue;\n\t\t}\n\t\tc = *filename;\n\t\tpattern++;\n\t\tswitch (*pattern) {\n\t\t\tint i;\n\t\t\tint j;\n\t\tcase '?':\n\t\t\tif (c == '/') {\n\t\t\t\treturn false;\n\t\t\t} else if (c == '\\\\') {\n\t\t\t\tif (filename[1] == '\\\\')\n\t\t\t\t\tfilename++;\n\t\t\t\telse if (tomoyo_byte_range(filename + 1))\n\t\t\t\t\tfilename += 3;\n\t\t\t\telse\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '\\\\':\n\t\t\tif (c != '\\\\')\n\t\t\t\treturn false;\n\t\t\tif (*++filename != '\\\\')\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase '+':\n\t\t\tif (!isdigit(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\tif (!isxdigit(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase 'a':\n\t\t\tif (!tomoyo_alphabet_char(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase '0':\n\t\tcase '1':\n\t\tcase '2':\n\t\tcase '3':\n\t\t\tif (c == '\\\\' && tomoyo_byte_range(filename + 1)\n\t\t\t    && strncmp(filename + 1, pattern, 3) == 0) {\n\t\t\t\tfilename += 3;\n\t\t\t\tpattern += 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn false; /* Not matched. */\n\t\tcase '*':\n\t\tcase '@':\n\t\t\tfor (i = 0; i <= filename_end - filename; i++) {\n\t\t\t\tif (tomoyo_file_matches_pattern2(\n\t\t\t\t\t\t    filename + i, filename_end,\n\t\t\t\t\t\t    pattern + 1, pattern_end))\n\t\t\t\t\treturn true;\n\t\t\t\tc = filename[i];\n\t\t\t\tif (c == '.' && *pattern == '@')\n\t\t\t\t\tbreak;\n\t\t\t\tif (c != '\\\\')\n\t\t\t\t\tcontinue;\n\t\t\t\tif (filename[i + 1] == '\\\\')\n\t\t\t\t\ti++;\n\t\t\t\telse if (tomoyo_byte_range(filename + i + 1))\n\t\t\t\t\ti += 3;\n\t\t\t\telse\n\t\t\t\t\tbreak; /* Bad pattern. */\n\t\t\t}\n\t\t\treturn false; /* Not matched. */\n\t\tdefault:\n\t\t\tj = 0;\n\t\t\tc = *pattern;\n\t\t\tif (c == '$') {\n\t\t\t\twhile (isdigit(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t} else if (c == 'X') {\n\t\t\t\twhile (isxdigit(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t} else if (c == 'A') {\n\t\t\t\twhile (tomoyo_alphabet_char(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t}\n\t\t\tfor (i = 1; i <= j; i++) {\n\t\t\t\tif (tomoyo_file_matches_pattern2(\n\t\t\t\t\t\t    filename + i, filename_end,\n\t\t\t\t\t\t    pattern + 1, pattern_end))\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false; /* Not matched or bad pattern. */\n\t\t}\n\t\tfilename++;\n\t\tpattern++;\n\t}\n\twhile (*pattern == '\\\\' &&\n\t       (*(pattern + 1) == '*' || *(pattern + 1) == '@'))\n\t\tpattern += 2;\n\treturn filename == filename_end && pattern == pattern_end;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_alphabet_char",
          "args": [
            "filename[j]"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_alphabet_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "320-323",
          "snippet": "static inline bool tomoyo_alphabet_char(const char c)\n{\n\treturn (c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z');\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic inline bool tomoyo_alphabet_char(const char c)\n{\n\treturn (c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z');\n}"
        }
      },
      {
        "call_info": {
          "callee": "isxdigit",
          "args": [
            "filename[j]"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "filename[j]"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tomoyo_byte_range",
          "args": [
            "filename + i + 1"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_byte_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "306-311",
          "snippet": "static inline bool tomoyo_byte_range(const char *str)\n{\n\treturn *str >= '0' && *str++ <= '3' &&\n\t\t*str >= '0' && *str++ <= '7' &&\n\t\t*str >= '0' && *str <= '7';\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic inline bool tomoyo_byte_range(const char *str)\n{\n\treturn *str >= '0' && *str++ <= '3' &&\n\t\t*str >= '0' && *str++ <= '7' &&\n\t\t*str >= '0' && *str <= '7';\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "filename + 1",
            "pattern",
            "3"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isxdigit",
          "args": [
            "c"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "c"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic bool tomoyo_file_matches_pattern2(const char *filename,\n\t\t\t\t\t const char *filename_end,\n\t\t\t\t\t const char *pattern,\n\t\t\t\t\t const char *pattern_end)\n{\n\twhile (filename < filename_end && pattern < pattern_end) {\n\t\tchar c;\n\t\tif (*pattern != '\\\\') {\n\t\t\tif (*filename++ != *pattern++)\n\t\t\t\treturn false;\n\t\t\tcontinue;\n\t\t}\n\t\tc = *filename;\n\t\tpattern++;\n\t\tswitch (*pattern) {\n\t\t\tint i;\n\t\t\tint j;\n\t\tcase '?':\n\t\t\tif (c == '/') {\n\t\t\t\treturn false;\n\t\t\t} else if (c == '\\\\') {\n\t\t\t\tif (filename[1] == '\\\\')\n\t\t\t\t\tfilename++;\n\t\t\t\telse if (tomoyo_byte_range(filename + 1))\n\t\t\t\t\tfilename += 3;\n\t\t\t\telse\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '\\\\':\n\t\t\tif (c != '\\\\')\n\t\t\t\treturn false;\n\t\t\tif (*++filename != '\\\\')\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase '+':\n\t\t\tif (!isdigit(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase 'x':\n\t\t\tif (!isxdigit(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase 'a':\n\t\t\tif (!tomoyo_alphabet_char(c))\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\tcase '0':\n\t\tcase '1':\n\t\tcase '2':\n\t\tcase '3':\n\t\t\tif (c == '\\\\' && tomoyo_byte_range(filename + 1)\n\t\t\t    && strncmp(filename + 1, pattern, 3) == 0) {\n\t\t\t\tfilename += 3;\n\t\t\t\tpattern += 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn false; /* Not matched. */\n\t\tcase '*':\n\t\tcase '@':\n\t\t\tfor (i = 0; i <= filename_end - filename; i++) {\n\t\t\t\tif (tomoyo_file_matches_pattern2(\n\t\t\t\t\t\t    filename + i, filename_end,\n\t\t\t\t\t\t    pattern + 1, pattern_end))\n\t\t\t\t\treturn true;\n\t\t\t\tc = filename[i];\n\t\t\t\tif (c == '.' && *pattern == '@')\n\t\t\t\t\tbreak;\n\t\t\t\tif (c != '\\\\')\n\t\t\t\t\tcontinue;\n\t\t\t\tif (filename[i + 1] == '\\\\')\n\t\t\t\t\ti++;\n\t\t\t\telse if (tomoyo_byte_range(filename + i + 1))\n\t\t\t\t\ti += 3;\n\t\t\t\telse\n\t\t\t\t\tbreak; /* Bad pattern. */\n\t\t\t}\n\t\t\treturn false; /* Not matched. */\n\t\tdefault:\n\t\t\tj = 0;\n\t\t\tc = *pattern;\n\t\t\tif (c == '$') {\n\t\t\t\twhile (isdigit(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t} else if (c == 'X') {\n\t\t\t\twhile (isxdigit(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t} else if (c == 'A') {\n\t\t\t\twhile (tomoyo_alphabet_char(filename[j]))\n\t\t\t\t\tj++;\n\t\t\t}\n\t\t\tfor (i = 1; i <= j; i++) {\n\t\t\t\tif (tomoyo_file_matches_pattern2(\n\t\t\t\t\t\t    filename + i, filename_end,\n\t\t\t\t\t\t    pattern + 1, pattern_end))\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false; /* Not matched or bad pattern. */\n\t\t}\n\t\tfilename++;\n\t\tpattern++;\n\t}\n\twhile (*pattern == '\\\\' &&\n\t       (*(pattern + 1) == '*' || *(pattern + 1) == '@'))\n\t\tpattern += 2;\n\treturn filename == filename_end && pattern == pattern_end;\n}"
  },
  {
    "function_name": "tomoyo_fill_path_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "643-652",
    "snippet": "void tomoyo_fill_path_info(struct tomoyo_path_info *ptr)\n{\n\tconst char *name = ptr->name;\n\tconst int len = strlen(name);\n\n\tptr->const_len = tomoyo_const_part_length(name);\n\tptr->is_dir = len && (name[len - 1] == '/');\n\tptr->is_patterned = (ptr->const_len < len);\n\tptr->hash = full_name_hash(NULL, name, len);\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "full_name_hash",
          "args": [
            "NULL",
            "name",
            "len"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tomoyo_const_part_length",
          "args": [
            "name"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_const_part_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "601-634",
          "snippet": "static int tomoyo_const_part_length(const char *filename)\n{\n\tchar c;\n\tint len = 0;\n\n\tif (!filename)\n\t\treturn 0;\n\twhile ((c = *filename++) != '\\0') {\n\t\tif (c != '\\\\') {\n\t\t\tlen++;\n\t\t\tcontinue;\n\t\t}\n\t\tc = *filename++;\n\t\tswitch (c) {\n\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\tlen += 2;\n\t\t\tcontinue;\n\t\tcase '0':   /* \"\\ooo\" */\n\t\tcase '1':\n\t\tcase '2':\n\t\tcase '3':\n\t\t\tc = *filename++;\n\t\t\tif (c < '0' || c > '7')\n\t\t\t\tbreak;\n\t\t\tc = *filename++;\n\t\t\tif (c < '0' || c > '7')\n\t\t\t\tbreak;\n\t\t\tlen += 4;\n\t\t\tcontinue;\n\t\t}\n\t\tbreak;\n\t}\n\treturn len;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic int tomoyo_const_part_length(const char *filename)\n{\n\tchar c;\n\tint len = 0;\n\n\tif (!filename)\n\t\treturn 0;\n\twhile ((c = *filename++) != '\\0') {\n\t\tif (c != '\\\\') {\n\t\t\tlen++;\n\t\t\tcontinue;\n\t\t}\n\t\tc = *filename++;\n\t\tswitch (c) {\n\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\tlen += 2;\n\t\t\tcontinue;\n\t\tcase '0':   /* \"\\ooo\" */\n\t\tcase '1':\n\t\tcase '2':\n\t\tcase '3':\n\t\t\tc = *filename++;\n\t\t\tif (c < '0' || c > '7')\n\t\t\t\tbreak;\n\t\t\tc = *filename++;\n\t\t\tif (c < '0' || c > '7')\n\t\t\t\tbreak;\n\t\t\tlen += 4;\n\t\t\tcontinue;\n\t\t}\n\t\tbreak;\n\t}\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nvoid tomoyo_fill_path_info(struct tomoyo_path_info *ptr)\n{\n\tconst char *name = ptr->name;\n\tconst int len = strlen(name);\n\n\tptr->const_len = tomoyo_const_part_length(name);\n\tptr->is_dir = len && (name[len - 1] == '/');\n\tptr->is_patterned = (ptr->const_len < len);\n\tptr->hash = full_name_hash(NULL, name, len);\n}"
  },
  {
    "function_name": "tomoyo_const_part_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "601-634",
    "snippet": "static int tomoyo_const_part_length(const char *filename)\n{\n\tchar c;\n\tint len = 0;\n\n\tif (!filename)\n\t\treturn 0;\n\twhile ((c = *filename++) != '\\0') {\n\t\tif (c != '\\\\') {\n\t\t\tlen++;\n\t\t\tcontinue;\n\t\t}\n\t\tc = *filename++;\n\t\tswitch (c) {\n\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\tlen += 2;\n\t\t\tcontinue;\n\t\tcase '0':   /* \"\\ooo\" */\n\t\tcase '1':\n\t\tcase '2':\n\t\tcase '3':\n\t\t\tc = *filename++;\n\t\t\tif (c < '0' || c > '7')\n\t\t\t\tbreak;\n\t\t\tc = *filename++;\n\t\t\tif (c < '0' || c > '7')\n\t\t\t\tbreak;\n\t\t\tlen += 4;\n\t\t\tcontinue;\n\t\t}\n\t\tbreak;\n\t}\n\treturn len;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic int tomoyo_const_part_length(const char *filename)\n{\n\tchar c;\n\tint len = 0;\n\n\tif (!filename)\n\t\treturn 0;\n\twhile ((c = *filename++) != '\\0') {\n\t\tif (c != '\\\\') {\n\t\t\tlen++;\n\t\t\tcontinue;\n\t\t}\n\t\tc = *filename++;\n\t\tswitch (c) {\n\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\tlen += 2;\n\t\t\tcontinue;\n\t\tcase '0':   /* \"\\ooo\" */\n\t\tcase '1':\n\t\tcase '2':\n\t\tcase '3':\n\t\t\tc = *filename++;\n\t\t\tif (c < '0' || c > '7')\n\t\t\t\tbreak;\n\t\t\tc = *filename++;\n\t\t\tif (c < '0' || c > '7')\n\t\t\t\tbreak;\n\t\t\tlen += 4;\n\t\t\tcontinue;\n\t\t}\n\t\tbreak;\n\t}\n\treturn len;\n}"
  },
  {
    "function_name": "tomoyo_find_domain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "579-592",
    "snippet": "struct tomoyo_domain_info *tomoyo_find_domain(const char *domainname)\n{\n\tstruct tomoyo_domain_info *domain;\n\tstruct tomoyo_path_info name;\n\n\tname.name = domainname;\n\ttomoyo_fill_path_info(&name);\n\tlist_for_each_entry_rcu(domain, &tomoyo_domain_list, list) {\n\t\tif (!domain->is_deleted &&\n\t\t    !tomoyo_pathcmp(&name, domain->domainname))\n\t\t\treturn domain;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_pathcmp",
          "args": [
            "&name",
            "domain->domainname"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_pathcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/common.h",
          "lines": "1151-1155",
          "snippet": "static inline bool tomoyo_pathcmp(const struct tomoyo_path_info *a,\n\t\t\t\t  const struct tomoyo_path_info *b)\n{\n\treturn a->hash != b->hash || strcmp(a->name, b->name);\n}",
          "includes": [
            "#include <net/udp.h>",
            "#include <net/ipv6.h>",
            "#include <net/ip.h>",
            "#include <net/af_unix.h>",
            "#include <net/sock.h>",
            "#include <linux/un.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/inet.h>",
            "#include <linux/net.h>",
            "#include <linux/highmem.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/poll.h>",
            "#include <linux/cred.h>",
            "#include <linux/list.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/file.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/ctype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <net/udp.h>\n#include <net/ipv6.h>\n#include <net/ip.h>\n#include <net/af_unix.h>\n#include <net/sock.h>\n#include <linux/un.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/inet.h>\n#include <linux/net.h>\n#include <linux/highmem.h>\n#include <linux/binfmts.h>\n#include <linux/poll.h>\n#include <linux/cred.h>\n#include <linux/list.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/file.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/ctype.h>\n\nstatic inline bool tomoyo_pathcmp(const struct tomoyo_path_info *a,\n\t\t\t\t  const struct tomoyo_path_info *b)\n{\n\treturn a->hash != b->hash || strcmp(a->name, b->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "domain",
            "&tomoyo_domain_list",
            "list"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tomoyo_fill_path_info",
          "args": [
            "&name"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_fill_path_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "643-652",
          "snippet": "void tomoyo_fill_path_info(struct tomoyo_path_info *ptr)\n{\n\tconst char *name = ptr->name;\n\tconst int len = strlen(name);\n\n\tptr->const_len = tomoyo_const_part_length(name);\n\tptr->is_dir = len && (name[len - 1] == '/');\n\tptr->is_patterned = (ptr->const_len < len);\n\tptr->hash = full_name_hash(NULL, name, len);\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nvoid tomoyo_fill_path_info(struct tomoyo_path_info *ptr)\n{\n\tconst char *name = ptr->name;\n\tconst int len = strlen(name);\n\n\tptr->const_len = tomoyo_const_part_length(name);\n\tptr->is_dir = len && (name[len - 1] == '/');\n\tptr->is_patterned = (ptr->const_len < len);\n\tptr->hash = full_name_hash(NULL, name, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstruct tomoyo_domain_info *tomoyo_find_domain(const char *domainname)\n{\n\tstruct tomoyo_domain_info *domain;\n\tstruct tomoyo_path_info name;\n\n\tname.name = domainname;\n\ttomoyo_fill_path_info(&name);\n\tlist_for_each_entry_rcu(domain, &tomoyo_domain_list, list) {\n\t\tif (!domain->is_deleted &&\n\t\t    !tomoyo_pathcmp(&name, domain->domainname))\n\t\t\treturn domain;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "tomoyo_domain_def",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "553-568",
    "snippet": "bool tomoyo_domain_def(const unsigned char *buffer)\n{\n\tconst unsigned char *cp;\n\tint len;\n\tif (*buffer != '<')\n\t\treturn false;\n\tcp = strchr(buffer, ' ');\n\tif (!cp)\n\t\tlen = strlen(buffer);\n\telse\n\t\tlen = cp - buffer;\n\tif (buffer[len - 1] != '>' ||\n\t    !tomoyo_correct_word2(buffer + 1, len - 2))\n\t\treturn false;\n\treturn true;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_correct_word2",
          "args": [
            "buffer + 1",
            "len - 2"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_correct_word2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "425-492",
          "snippet": "static bool tomoyo_correct_word2(const char *string, size_t len)\n{\n\tconst char *const start = string;\n\tbool in_repetition = false;\n\tunsigned char c;\n\tunsigned char d;\n\tunsigned char e;\n\tif (!len)\n\t\tgoto out;\n\twhile (len--) {\n\t\tc = *string++;\n\t\tif (c == '\\\\') {\n\t\t\tif (!len--)\n\t\t\t\tgoto out;\n\t\t\tc = *string++;\n\t\t\tswitch (c) {\n\t\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\t\tcontinue;\n\t\t\tcase '$':   /* \"\\$\" */\n\t\t\tcase '+':   /* \"\\+\" */\n\t\t\tcase '?':   /* \"\\?\" */\n\t\t\tcase '*':   /* \"\\*\" */\n\t\t\tcase '@':   /* \"\\@\" */\n\t\t\tcase 'x':   /* \"\\x\" */\n\t\t\tcase 'X':   /* \"\\X\" */\n\t\t\tcase 'a':   /* \"\\a\" */\n\t\t\tcase 'A':   /* \"\\A\" */\n\t\t\tcase '-':   /* \"\\-\" */\n\t\t\t\tcontinue;\n\t\t\tcase '{':   /* \"/\\{\" */\n\t\t\t\tif (string - 3 < start || *(string - 3) != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = true;\n\t\t\t\tcontinue;\n\t\t\tcase '}':   /* \"\\}/\" */\n\t\t\t\tif (*string != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tif (!in_repetition)\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = false;\n\t\t\t\tcontinue;\n\t\t\tcase '0':   /* \"\\ooo\" */\n\t\t\tcase '1':\n\t\t\tcase '2':\n\t\t\tcase '3':\n\t\t\t\tif (!len-- || !len--)\n\t\t\t\t\tbreak;\n\t\t\t\td = *string++;\n\t\t\t\te = *string++;\n\t\t\t\tif (d < '0' || d > '7' || e < '0' || e > '7')\n\t\t\t\t\tbreak;\n\t\t\t\tc = tomoyo_make_byte(c, d, e);\n\t\t\t\tif (c <= ' ' || c >= 127)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tgoto out;\n\t\t} else if (in_repetition && c == '/') {\n\t\t\tgoto out;\n\t\t} else if (c <= ' ' || c >= 127) {\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif (in_repetition)\n\t\tgoto out;\n\treturn true;\n out:\n\treturn false;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic bool tomoyo_correct_word2(const char *string, size_t len)\n{\n\tconst char *const start = string;\n\tbool in_repetition = false;\n\tunsigned char c;\n\tunsigned char d;\n\tunsigned char e;\n\tif (!len)\n\t\tgoto out;\n\twhile (len--) {\n\t\tc = *string++;\n\t\tif (c == '\\\\') {\n\t\t\tif (!len--)\n\t\t\t\tgoto out;\n\t\t\tc = *string++;\n\t\t\tswitch (c) {\n\t\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\t\tcontinue;\n\t\t\tcase '$':   /* \"\\$\" */\n\t\t\tcase '+':   /* \"\\+\" */\n\t\t\tcase '?':   /* \"\\?\" */\n\t\t\tcase '*':   /* \"\\*\" */\n\t\t\tcase '@':   /* \"\\@\" */\n\t\t\tcase 'x':   /* \"\\x\" */\n\t\t\tcase 'X':   /* \"\\X\" */\n\t\t\tcase 'a':   /* \"\\a\" */\n\t\t\tcase 'A':   /* \"\\A\" */\n\t\t\tcase '-':   /* \"\\-\" */\n\t\t\t\tcontinue;\n\t\t\tcase '{':   /* \"/\\{\" */\n\t\t\t\tif (string - 3 < start || *(string - 3) != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = true;\n\t\t\t\tcontinue;\n\t\t\tcase '}':   /* \"\\}/\" */\n\t\t\t\tif (*string != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tif (!in_repetition)\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = false;\n\t\t\t\tcontinue;\n\t\t\tcase '0':   /* \"\\ooo\" */\n\t\t\tcase '1':\n\t\t\tcase '2':\n\t\t\tcase '3':\n\t\t\t\tif (!len-- || !len--)\n\t\t\t\t\tbreak;\n\t\t\t\td = *string++;\n\t\t\t\te = *string++;\n\t\t\t\tif (d < '0' || d > '7' || e < '0' || e > '7')\n\t\t\t\t\tbreak;\n\t\t\t\tc = tomoyo_make_byte(c, d, e);\n\t\t\t\tif (c <= ' ' || c >= 127)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tgoto out;\n\t\t} else if (in_repetition && c == '/') {\n\t\t\tgoto out;\n\t\t} else if (c <= ' ' || c >= 127) {\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif (in_repetition)\n\t\tgoto out;\n\treturn true;\n out:\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "buffer"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "buffer",
            "' '"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_domain_def(const unsigned char *buffer)\n{\n\tconst unsigned char *cp;\n\tint len;\n\tif (*buffer != '<')\n\t\treturn false;\n\tcp = strchr(buffer, ' ');\n\tif (!cp)\n\t\tlen = strlen(buffer);\n\telse\n\t\tlen = cp - buffer;\n\tif (buffer[len - 1] != '>' ||\n\t    !tomoyo_correct_word2(buffer + 1, len - 2))\n\t\treturn false;\n\treturn true;\n}"
  },
  {
    "function_name": "tomoyo_correct_domain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "527-544",
    "snippet": "bool tomoyo_correct_domain(const unsigned char *domainname)\n{\n\tif (!domainname || !tomoyo_domain_def(domainname))\n\t\treturn false;\n\tdomainname = strchr(domainname, ' ');\n\tif (!domainname++)\n\t\treturn true;\n\twhile (1) {\n\t\tconst unsigned char *cp = strchr(domainname, ' ');\n\t\tif (!cp)\n\t\t\tbreak;\n\t\tif (*domainname != '/' ||\n\t\t    !tomoyo_correct_word2(domainname, cp - domainname))\n\t\t\treturn false;\n\t\tdomainname = cp + 1;\n\t}\n\treturn tomoyo_correct_path(domainname);\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_correct_path",
          "args": [
            "domainname"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_correct_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "515-518",
          "snippet": "bool tomoyo_correct_path(const char *filename)\n{\n\treturn *filename == '/' && tomoyo_correct_word(filename);\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_correct_path(const char *filename)\n{\n\treturn *filename == '/' && tomoyo_correct_word(filename);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_correct_word2",
          "args": [
            "domainname",
            "cp - domainname"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_correct_word2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "425-492",
          "snippet": "static bool tomoyo_correct_word2(const char *string, size_t len)\n{\n\tconst char *const start = string;\n\tbool in_repetition = false;\n\tunsigned char c;\n\tunsigned char d;\n\tunsigned char e;\n\tif (!len)\n\t\tgoto out;\n\twhile (len--) {\n\t\tc = *string++;\n\t\tif (c == '\\\\') {\n\t\t\tif (!len--)\n\t\t\t\tgoto out;\n\t\t\tc = *string++;\n\t\t\tswitch (c) {\n\t\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\t\tcontinue;\n\t\t\tcase '$':   /* \"\\$\" */\n\t\t\tcase '+':   /* \"\\+\" */\n\t\t\tcase '?':   /* \"\\?\" */\n\t\t\tcase '*':   /* \"\\*\" */\n\t\t\tcase '@':   /* \"\\@\" */\n\t\t\tcase 'x':   /* \"\\x\" */\n\t\t\tcase 'X':   /* \"\\X\" */\n\t\t\tcase 'a':   /* \"\\a\" */\n\t\t\tcase 'A':   /* \"\\A\" */\n\t\t\tcase '-':   /* \"\\-\" */\n\t\t\t\tcontinue;\n\t\t\tcase '{':   /* \"/\\{\" */\n\t\t\t\tif (string - 3 < start || *(string - 3) != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = true;\n\t\t\t\tcontinue;\n\t\t\tcase '}':   /* \"\\}/\" */\n\t\t\t\tif (*string != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tif (!in_repetition)\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = false;\n\t\t\t\tcontinue;\n\t\t\tcase '0':   /* \"\\ooo\" */\n\t\t\tcase '1':\n\t\t\tcase '2':\n\t\t\tcase '3':\n\t\t\t\tif (!len-- || !len--)\n\t\t\t\t\tbreak;\n\t\t\t\td = *string++;\n\t\t\t\te = *string++;\n\t\t\t\tif (d < '0' || d > '7' || e < '0' || e > '7')\n\t\t\t\t\tbreak;\n\t\t\t\tc = tomoyo_make_byte(c, d, e);\n\t\t\t\tif (c <= ' ' || c >= 127)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tgoto out;\n\t\t} else if (in_repetition && c == '/') {\n\t\t\tgoto out;\n\t\t} else if (c <= ' ' || c >= 127) {\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif (in_repetition)\n\t\tgoto out;\n\treturn true;\n out:\n\treturn false;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic bool tomoyo_correct_word2(const char *string, size_t len)\n{\n\tconst char *const start = string;\n\tbool in_repetition = false;\n\tunsigned char c;\n\tunsigned char d;\n\tunsigned char e;\n\tif (!len)\n\t\tgoto out;\n\twhile (len--) {\n\t\tc = *string++;\n\t\tif (c == '\\\\') {\n\t\t\tif (!len--)\n\t\t\t\tgoto out;\n\t\t\tc = *string++;\n\t\t\tswitch (c) {\n\t\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\t\tcontinue;\n\t\t\tcase '$':   /* \"\\$\" */\n\t\t\tcase '+':   /* \"\\+\" */\n\t\t\tcase '?':   /* \"\\?\" */\n\t\t\tcase '*':   /* \"\\*\" */\n\t\t\tcase '@':   /* \"\\@\" */\n\t\t\tcase 'x':   /* \"\\x\" */\n\t\t\tcase 'X':   /* \"\\X\" */\n\t\t\tcase 'a':   /* \"\\a\" */\n\t\t\tcase 'A':   /* \"\\A\" */\n\t\t\tcase '-':   /* \"\\-\" */\n\t\t\t\tcontinue;\n\t\t\tcase '{':   /* \"/\\{\" */\n\t\t\t\tif (string - 3 < start || *(string - 3) != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = true;\n\t\t\t\tcontinue;\n\t\t\tcase '}':   /* \"\\}/\" */\n\t\t\t\tif (*string != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tif (!in_repetition)\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = false;\n\t\t\t\tcontinue;\n\t\t\tcase '0':   /* \"\\ooo\" */\n\t\t\tcase '1':\n\t\t\tcase '2':\n\t\t\tcase '3':\n\t\t\t\tif (!len-- || !len--)\n\t\t\t\t\tbreak;\n\t\t\t\td = *string++;\n\t\t\t\te = *string++;\n\t\t\t\tif (d < '0' || d > '7' || e < '0' || e > '7')\n\t\t\t\t\tbreak;\n\t\t\t\tc = tomoyo_make_byte(c, d, e);\n\t\t\t\tif (c <= ' ' || c >= 127)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tgoto out;\n\t\t} else if (in_repetition && c == '/') {\n\t\t\tgoto out;\n\t\t} else if (c <= ' ' || c >= 127) {\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif (in_repetition)\n\t\tgoto out;\n\treturn true;\n out:\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "domainname",
            "' '"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "domainname",
            "' '"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tomoyo_domain_def",
          "args": [
            "domainname"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_domain_def",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "553-568",
          "snippet": "bool tomoyo_domain_def(const unsigned char *buffer)\n{\n\tconst unsigned char *cp;\n\tint len;\n\tif (*buffer != '<')\n\t\treturn false;\n\tcp = strchr(buffer, ' ');\n\tif (!cp)\n\t\tlen = strlen(buffer);\n\telse\n\t\tlen = cp - buffer;\n\tif (buffer[len - 1] != '>' ||\n\t    !tomoyo_correct_word2(buffer + 1, len - 2))\n\t\treturn false;\n\treturn true;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_domain_def(const unsigned char *buffer)\n{\n\tconst unsigned char *cp;\n\tint len;\n\tif (*buffer != '<')\n\t\treturn false;\n\tcp = strchr(buffer, ' ');\n\tif (!cp)\n\t\tlen = strlen(buffer);\n\telse\n\t\tlen = cp - buffer;\n\tif (buffer[len - 1] != '>' ||\n\t    !tomoyo_correct_word2(buffer + 1, len - 2))\n\t\treturn false;\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_correct_domain(const unsigned char *domainname)\n{\n\tif (!domainname || !tomoyo_domain_def(domainname))\n\t\treturn false;\n\tdomainname = strchr(domainname, ' ');\n\tif (!domainname++)\n\t\treturn true;\n\twhile (1) {\n\t\tconst unsigned char *cp = strchr(domainname, ' ');\n\t\tif (!cp)\n\t\t\tbreak;\n\t\tif (*domainname != '/' ||\n\t\t    !tomoyo_correct_word2(domainname, cp - domainname))\n\t\t\treturn false;\n\t\tdomainname = cp + 1;\n\t}\n\treturn tomoyo_correct_path(domainname);\n}"
  },
  {
    "function_name": "tomoyo_correct_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "515-518",
    "snippet": "bool tomoyo_correct_path(const char *filename)\n{\n\treturn *filename == '/' && tomoyo_correct_word(filename);\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_correct_word",
          "args": [
            "filename"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_correct_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "502-505",
          "snippet": "bool tomoyo_correct_word(const char *string)\n{\n\treturn tomoyo_correct_word2(string, strlen(string));\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_correct_word(const char *string)\n{\n\treturn tomoyo_correct_word2(string, strlen(string));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_correct_path(const char *filename)\n{\n\treturn *filename == '/' && tomoyo_correct_word(filename);\n}"
  },
  {
    "function_name": "tomoyo_correct_word",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "502-505",
    "snippet": "bool tomoyo_correct_word(const char *string)\n{\n\treturn tomoyo_correct_word2(string, strlen(string));\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_correct_word2",
          "args": [
            "string",
            "strlen(string)"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_correct_word2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "425-492",
          "snippet": "static bool tomoyo_correct_word2(const char *string, size_t len)\n{\n\tconst char *const start = string;\n\tbool in_repetition = false;\n\tunsigned char c;\n\tunsigned char d;\n\tunsigned char e;\n\tif (!len)\n\t\tgoto out;\n\twhile (len--) {\n\t\tc = *string++;\n\t\tif (c == '\\\\') {\n\t\t\tif (!len--)\n\t\t\t\tgoto out;\n\t\t\tc = *string++;\n\t\t\tswitch (c) {\n\t\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\t\tcontinue;\n\t\t\tcase '$':   /* \"\\$\" */\n\t\t\tcase '+':   /* \"\\+\" */\n\t\t\tcase '?':   /* \"\\?\" */\n\t\t\tcase '*':   /* \"\\*\" */\n\t\t\tcase '@':   /* \"\\@\" */\n\t\t\tcase 'x':   /* \"\\x\" */\n\t\t\tcase 'X':   /* \"\\X\" */\n\t\t\tcase 'a':   /* \"\\a\" */\n\t\t\tcase 'A':   /* \"\\A\" */\n\t\t\tcase '-':   /* \"\\-\" */\n\t\t\t\tcontinue;\n\t\t\tcase '{':   /* \"/\\{\" */\n\t\t\t\tif (string - 3 < start || *(string - 3) != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = true;\n\t\t\t\tcontinue;\n\t\t\tcase '}':   /* \"\\}/\" */\n\t\t\t\tif (*string != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tif (!in_repetition)\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = false;\n\t\t\t\tcontinue;\n\t\t\tcase '0':   /* \"\\ooo\" */\n\t\t\tcase '1':\n\t\t\tcase '2':\n\t\t\tcase '3':\n\t\t\t\tif (!len-- || !len--)\n\t\t\t\t\tbreak;\n\t\t\t\td = *string++;\n\t\t\t\te = *string++;\n\t\t\t\tif (d < '0' || d > '7' || e < '0' || e > '7')\n\t\t\t\t\tbreak;\n\t\t\t\tc = tomoyo_make_byte(c, d, e);\n\t\t\t\tif (c <= ' ' || c >= 127)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tgoto out;\n\t\t} else if (in_repetition && c == '/') {\n\t\t\tgoto out;\n\t\t} else if (c <= ' ' || c >= 127) {\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif (in_repetition)\n\t\tgoto out;\n\treturn true;\n out:\n\treturn false;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic bool tomoyo_correct_word2(const char *string, size_t len)\n{\n\tconst char *const start = string;\n\tbool in_repetition = false;\n\tunsigned char c;\n\tunsigned char d;\n\tunsigned char e;\n\tif (!len)\n\t\tgoto out;\n\twhile (len--) {\n\t\tc = *string++;\n\t\tif (c == '\\\\') {\n\t\t\tif (!len--)\n\t\t\t\tgoto out;\n\t\t\tc = *string++;\n\t\t\tswitch (c) {\n\t\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\t\tcontinue;\n\t\t\tcase '$':   /* \"\\$\" */\n\t\t\tcase '+':   /* \"\\+\" */\n\t\t\tcase '?':   /* \"\\?\" */\n\t\t\tcase '*':   /* \"\\*\" */\n\t\t\tcase '@':   /* \"\\@\" */\n\t\t\tcase 'x':   /* \"\\x\" */\n\t\t\tcase 'X':   /* \"\\X\" */\n\t\t\tcase 'a':   /* \"\\a\" */\n\t\t\tcase 'A':   /* \"\\A\" */\n\t\t\tcase '-':   /* \"\\-\" */\n\t\t\t\tcontinue;\n\t\t\tcase '{':   /* \"/\\{\" */\n\t\t\t\tif (string - 3 < start || *(string - 3) != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = true;\n\t\t\t\tcontinue;\n\t\t\tcase '}':   /* \"\\}/\" */\n\t\t\t\tif (*string != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tif (!in_repetition)\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = false;\n\t\t\t\tcontinue;\n\t\t\tcase '0':   /* \"\\ooo\" */\n\t\t\tcase '1':\n\t\t\tcase '2':\n\t\t\tcase '3':\n\t\t\t\tif (!len-- || !len--)\n\t\t\t\t\tbreak;\n\t\t\t\td = *string++;\n\t\t\t\te = *string++;\n\t\t\t\tif (d < '0' || d > '7' || e < '0' || e > '7')\n\t\t\t\t\tbreak;\n\t\t\t\tc = tomoyo_make_byte(c, d, e);\n\t\t\t\tif (c <= ' ' || c >= 127)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tgoto out;\n\t\t} else if (in_repetition && c == '/') {\n\t\t\tgoto out;\n\t\t} else if (c <= ' ' || c >= 127) {\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif (in_repetition)\n\t\tgoto out;\n\treturn true;\n out:\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "string"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_correct_word(const char *string)\n{\n\treturn tomoyo_correct_word2(string, strlen(string));\n}"
  },
  {
    "function_name": "tomoyo_correct_word2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "425-492",
    "snippet": "static bool tomoyo_correct_word2(const char *string, size_t len)\n{\n\tconst char *const start = string;\n\tbool in_repetition = false;\n\tunsigned char c;\n\tunsigned char d;\n\tunsigned char e;\n\tif (!len)\n\t\tgoto out;\n\twhile (len--) {\n\t\tc = *string++;\n\t\tif (c == '\\\\') {\n\t\t\tif (!len--)\n\t\t\t\tgoto out;\n\t\t\tc = *string++;\n\t\t\tswitch (c) {\n\t\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\t\tcontinue;\n\t\t\tcase '$':   /* \"\\$\" */\n\t\t\tcase '+':   /* \"\\+\" */\n\t\t\tcase '?':   /* \"\\?\" */\n\t\t\tcase '*':   /* \"\\*\" */\n\t\t\tcase '@':   /* \"\\@\" */\n\t\t\tcase 'x':   /* \"\\x\" */\n\t\t\tcase 'X':   /* \"\\X\" */\n\t\t\tcase 'a':   /* \"\\a\" */\n\t\t\tcase 'A':   /* \"\\A\" */\n\t\t\tcase '-':   /* \"\\-\" */\n\t\t\t\tcontinue;\n\t\t\tcase '{':   /* \"/\\{\" */\n\t\t\t\tif (string - 3 < start || *(string - 3) != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = true;\n\t\t\t\tcontinue;\n\t\t\tcase '}':   /* \"\\}/\" */\n\t\t\t\tif (*string != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tif (!in_repetition)\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = false;\n\t\t\t\tcontinue;\n\t\t\tcase '0':   /* \"\\ooo\" */\n\t\t\tcase '1':\n\t\t\tcase '2':\n\t\t\tcase '3':\n\t\t\t\tif (!len-- || !len--)\n\t\t\t\t\tbreak;\n\t\t\t\td = *string++;\n\t\t\t\te = *string++;\n\t\t\t\tif (d < '0' || d > '7' || e < '0' || e > '7')\n\t\t\t\t\tbreak;\n\t\t\t\tc = tomoyo_make_byte(c, d, e);\n\t\t\t\tif (c <= ' ' || c >= 127)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tgoto out;\n\t\t} else if (in_repetition && c == '/') {\n\t\t\tgoto out;\n\t\t} else if (c <= ' ' || c >= 127) {\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif (in_repetition)\n\t\tgoto out;\n\treturn true;\n out:\n\treturn false;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_make_byte",
          "args": [
            "c",
            "d",
            "e"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_make_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "334-337",
          "snippet": "static inline u8 tomoyo_make_byte(const u8 c1, const u8 c2, const u8 c3)\n{\n\treturn ((c1 - '0') << 6) + ((c2 - '0') << 3) + (c3 - '0');\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic inline u8 tomoyo_make_byte(const u8 c1, const u8 c2, const u8 c3)\n{\n\treturn ((c1 - '0') << 6) + ((c2 - '0') << 3) + (c3 - '0');\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic bool tomoyo_correct_word2(const char *string, size_t len)\n{\n\tconst char *const start = string;\n\tbool in_repetition = false;\n\tunsigned char c;\n\tunsigned char d;\n\tunsigned char e;\n\tif (!len)\n\t\tgoto out;\n\twhile (len--) {\n\t\tc = *string++;\n\t\tif (c == '\\\\') {\n\t\t\tif (!len--)\n\t\t\t\tgoto out;\n\t\t\tc = *string++;\n\t\t\tswitch (c) {\n\t\t\tcase '\\\\':  /* \"\\\\\" */\n\t\t\t\tcontinue;\n\t\t\tcase '$':   /* \"\\$\" */\n\t\t\tcase '+':   /* \"\\+\" */\n\t\t\tcase '?':   /* \"\\?\" */\n\t\t\tcase '*':   /* \"\\*\" */\n\t\t\tcase '@':   /* \"\\@\" */\n\t\t\tcase 'x':   /* \"\\x\" */\n\t\t\tcase 'X':   /* \"\\X\" */\n\t\t\tcase 'a':   /* \"\\a\" */\n\t\t\tcase 'A':   /* \"\\A\" */\n\t\t\tcase '-':   /* \"\\-\" */\n\t\t\t\tcontinue;\n\t\t\tcase '{':   /* \"/\\{\" */\n\t\t\t\tif (string - 3 < start || *(string - 3) != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = true;\n\t\t\t\tcontinue;\n\t\t\tcase '}':   /* \"\\}/\" */\n\t\t\t\tif (*string != '/')\n\t\t\t\t\tbreak;\n\t\t\t\tif (!in_repetition)\n\t\t\t\t\tbreak;\n\t\t\t\tin_repetition = false;\n\t\t\t\tcontinue;\n\t\t\tcase '0':   /* \"\\ooo\" */\n\t\t\tcase '1':\n\t\t\tcase '2':\n\t\t\tcase '3':\n\t\t\t\tif (!len-- || !len--)\n\t\t\t\t\tbreak;\n\t\t\t\td = *string++;\n\t\t\t\te = *string++;\n\t\t\t\tif (d < '0' || d > '7' || e < '0' || e > '7')\n\t\t\t\t\tbreak;\n\t\t\t\tc = tomoyo_make_byte(c, d, e);\n\t\t\t\tif (c <= ' ' || c >= 127)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tgoto out;\n\t\t} else if (in_repetition && c == '/') {\n\t\t\tgoto out;\n\t\t} else if (c <= ' ' || c >= 127) {\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif (in_repetition)\n\t\tgoto out;\n\treturn true;\n out:\n\treturn false;\n}"
  },
  {
    "function_name": "tomoyo_normalize_line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "396-414",
    "snippet": "void tomoyo_normalize_line(unsigned char *buffer)\n{\n\tunsigned char *sp = buffer;\n\tunsigned char *dp = buffer;\n\tbool first = true;\n\n\twhile (tomoyo_invalid(*sp))\n\t\tsp++;\n\twhile (*sp) {\n\t\tif (!first)\n\t\t\t*dp++ = ' ';\n\t\tfirst = false;\n\t\twhile (tomoyo_valid(*sp))\n\t\t\t*dp++ = *sp++;\n\t\twhile (tomoyo_invalid(*sp))\n\t\t\tsp++;\n\t}\n\t*dp = '\\0';\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_invalid",
          "args": [
            "*sp"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_invalid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "358-361",
          "snippet": "static inline bool tomoyo_invalid(const unsigned char c)\n{\n\treturn c && (c <= ' ' || c >= 127);\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic inline bool tomoyo_invalid(const unsigned char c)\n{\n\treturn c && (c <= ' ' || c >= 127);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_valid",
          "args": [
            "*sp"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "346-349",
          "snippet": "static inline bool tomoyo_valid(const unsigned char c)\n{\n\treturn c > ' ' && c < 127;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic inline bool tomoyo_valid(const unsigned char c)\n{\n\treturn c > ' ' && c < 127;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nvoid tomoyo_normalize_line(unsigned char *buffer)\n{\n\tunsigned char *sp = buffer;\n\tunsigned char *dp = buffer;\n\tbool first = true;\n\n\twhile (tomoyo_invalid(*sp))\n\t\tsp++;\n\twhile (*sp) {\n\t\tif (!first)\n\t\t\t*dp++ = ' ';\n\t\tfirst = false;\n\t\twhile (tomoyo_valid(*sp))\n\t\t\t*dp++ = *sp++;\n\t\twhile (tomoyo_invalid(*sp))\n\t\t\tsp++;\n\t}\n\t*dp = '\\0';\n}"
  },
  {
    "function_name": "tomoyo_str_starts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "374-384",
    "snippet": "bool tomoyo_str_starts(char **src, const char *find)\n{\n\tconst int len = strlen(find);\n\tchar *tmp = *src;\n\n\tif (strncmp(tmp, find, len))\n\t\treturn false;\n\ttmp += len;\n\t*src = tmp;\n\treturn true;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "tmp",
            "find",
            "len"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "find"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_str_starts(char **src, const char *find)\n{\n\tconst int len = strlen(find);\n\tchar *tmp = *src;\n\n\tif (strncmp(tmp, find, len))\n\t\treturn false;\n\ttmp += len;\n\t*src = tmp;\n\treturn true;\n}"
  },
  {
    "function_name": "tomoyo_invalid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "358-361",
    "snippet": "static inline bool tomoyo_invalid(const unsigned char c)\n{\n\treturn c && (c <= ' ' || c >= 127);\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic inline bool tomoyo_invalid(const unsigned char c)\n{\n\treturn c && (c <= ' ' || c >= 127);\n}"
  },
  {
    "function_name": "tomoyo_valid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "346-349",
    "snippet": "static inline bool tomoyo_valid(const unsigned char c)\n{\n\treturn c > ' ' && c < 127;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic inline bool tomoyo_valid(const unsigned char c)\n{\n\treturn c > ' ' && c < 127;\n}"
  },
  {
    "function_name": "tomoyo_make_byte",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "334-337",
    "snippet": "static inline u8 tomoyo_make_byte(const u8 c1, const u8 c2, const u8 c3)\n{\n\treturn ((c1 - '0') << 6) + ((c2 - '0') << 3) + (c3 - '0');\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic inline u8 tomoyo_make_byte(const u8 c1, const u8 c2, const u8 c3)\n{\n\treturn ((c1 - '0') << 6) + ((c2 - '0') << 3) + (c3 - '0');\n}"
  },
  {
    "function_name": "tomoyo_alphabet_char",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "320-323",
    "snippet": "static inline bool tomoyo_alphabet_char(const char c)\n{\n\treturn (c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z');\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic inline bool tomoyo_alphabet_char(const char c)\n{\n\treturn (c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z');\n}"
  },
  {
    "function_name": "tomoyo_byte_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "306-311",
    "snippet": "static inline bool tomoyo_byte_range(const char *str)\n{\n\treturn *str >= '0' && *str++ <= '3' &&\n\t\t*str >= '0' && *str++ <= '7' &&\n\t\t*str >= '0' && *str <= '7';\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nstatic inline bool tomoyo_byte_range(const char *str)\n{\n\treturn *str >= '0' && *str++ <= '3' &&\n\t\t*str >= '0' && *str++ <= '7' &&\n\t\t*str >= '0' && *str <= '7';\n}"
  },
  {
    "function_name": "tomoyo_parse_number_union",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "263-294",
    "snippet": "bool tomoyo_parse_number_union(struct tomoyo_acl_param *param,\n\t\t\t       struct tomoyo_number_union *ptr)\n{\n\tchar *data;\n\tu8 type;\n\tunsigned long v;\n\tmemset(ptr, 0, sizeof(*ptr));\n\tif (param->data[0] == '@') {\n\t\tparam->data++;\n\t\tptr->group = tomoyo_get_group(param, TOMOYO_NUMBER_GROUP);\n\t\treturn ptr->group != NULL;\n\t}\n\tdata = tomoyo_read_token(param);\n\ttype = tomoyo_parse_ulong(&v, &data);\n\tif (type == TOMOYO_VALUE_TYPE_INVALID)\n\t\treturn false;\n\tptr->values[0] = v;\n\tptr->value_type[0] = type;\n\tif (!*data) {\n\t\tptr->values[1] = v;\n\t\tptr->value_type[1] = type;\n\t\treturn true;\n\t}\n\tif (*data++ != '-')\n\t\treturn false;\n\ttype = tomoyo_parse_ulong(&v, &data);\n\tif (type == TOMOYO_VALUE_TYPE_INVALID || *data || ptr->values[0] > v)\n\t\treturn false;\n\tptr->values[1] = v;\n\tptr->value_type[1] = type;\n\treturn true;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_parse_ulong",
          "args": [
            "&v",
            "&data"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_parse_ulong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "179-206",
          "snippet": "u8 tomoyo_parse_ulong(unsigned long *result, char **str)\n{\n\tconst char *cp = *str;\n\tchar *ep;\n\tint base = 10;\n\tif (*cp == '0') {\n\t\tchar c = *(cp + 1);\n\t\tif (c == 'x' || c == 'X') {\n\t\t\tbase = 16;\n\t\t\tcp += 2;\n\t\t} else if (c >= '0' && c <= '7') {\n\t\t\tbase = 8;\n\t\t\tcp++;\n\t\t}\n\t}\n\t*result = simple_strtoul(cp, &ep, base);\n\tif (cp == ep)\n\t\treturn TOMOYO_VALUE_TYPE_INVALID;\n\t*str = ep;\n\tswitch (base) {\n\tcase 16:\n\t\treturn TOMOYO_VALUE_TYPE_HEXADECIMAL;\n\tcase 8:\n\t\treturn TOMOYO_VALUE_TYPE_OCTAL;\n\tdefault:\n\t\treturn TOMOYO_VALUE_TYPE_DECIMAL;\n\t}\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nu8 tomoyo_parse_ulong(unsigned long *result, char **str)\n{\n\tconst char *cp = *str;\n\tchar *ep;\n\tint base = 10;\n\tif (*cp == '0') {\n\t\tchar c = *(cp + 1);\n\t\tif (c == 'x' || c == 'X') {\n\t\t\tbase = 16;\n\t\t\tcp += 2;\n\t\t} else if (c >= '0' && c <= '7') {\n\t\t\tbase = 8;\n\t\t\tcp++;\n\t\t}\n\t}\n\t*result = simple_strtoul(cp, &ep, base);\n\tif (cp == ep)\n\t\treturn TOMOYO_VALUE_TYPE_INVALID;\n\t*str = ep;\n\tswitch (base) {\n\tcase 16:\n\t\treturn TOMOYO_VALUE_TYPE_HEXADECIMAL;\n\tcase 8:\n\t\treturn TOMOYO_VALUE_TYPE_OCTAL;\n\tdefault:\n\t\treturn TOMOYO_VALUE_TYPE_DECIMAL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_read_token",
          "args": [
            "param"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_read_token",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "131-141",
          "snippet": "char *tomoyo_read_token(struct tomoyo_acl_param *param)\n{\n\tchar *pos = param->data;\n\tchar *del = strchr(pos, ' ');\n\tif (del)\n\t\t*del++ = '\\0';\n\telse\n\t\tdel = pos + strlen(pos);\n\tparam->data = del;\n\treturn pos;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nchar *tomoyo_read_token(struct tomoyo_acl_param *param)\n{\n\tchar *pos = param->data;\n\tchar *del = strchr(pos, ' ');\n\tif (del)\n\t\t*del++ = '\\0';\n\telse\n\t\tdel = pos + strlen(pos);\n\tparam->data = del;\n\treturn pos;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_get_group",
          "args": [
            "param",
            "TOMOYO_NUMBER_GROUP"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_get_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/memory.c",
          "lines": "93-131",
          "snippet": "struct tomoyo_group *tomoyo_get_group(struct tomoyo_acl_param *param,\n\t\t\t\t      const u8 idx)\n{\n\tstruct tomoyo_group e = { };\n\tstruct tomoyo_group *group = NULL;\n\tstruct list_head *list;\n\tconst char *group_name = tomoyo_read_token(param);\n\tbool found = false;\n\tif (!tomoyo_correct_word(group_name) || idx >= TOMOYO_MAX_GROUP)\n\t\treturn NULL;\n\te.group_name = tomoyo_get_name(group_name);\n\tif (!e.group_name)\n\t\treturn NULL;\n\tif (mutex_lock_interruptible(&tomoyo_policy_lock))\n\t\tgoto out;\n\tlist = &param->ns->group_list[idx];\n\tlist_for_each_entry(group, list, head.list) {\n\t\tif (e.group_name != group->group_name ||\n\t\t    atomic_read(&group->head.users) == TOMOYO_GC_IN_PROGRESS)\n\t\t\tcontinue;\n\t\tatomic_inc(&group->head.users);\n\t\tfound = true;\n\t\tbreak;\n\t}\n\tif (!found) {\n\t\tstruct tomoyo_group *entry = tomoyo_commit_ok(&e, sizeof(e));\n\t\tif (entry) {\n\t\t\tINIT_LIST_HEAD(&entry->member_list);\n\t\t\tatomic_set(&entry->head.users, 1);\n\t\t\tlist_add_tail_rcu(&entry->head.list, list);\n\t\t\tgroup = entry;\n\t\t\tfound = true;\n\t\t}\n\t}\n\tmutex_unlock(&tomoyo_policy_lock);\nout:\n\ttomoyo_put_name(e.group_name);\n\treturn found ? group : NULL;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/slab.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/slab.h>\n#include <linux/hash.h>\n\nstruct tomoyo_group *tomoyo_get_group(struct tomoyo_acl_param *param,\n\t\t\t\t      const u8 idx)\n{\n\tstruct tomoyo_group e = { };\n\tstruct tomoyo_group *group = NULL;\n\tstruct list_head *list;\n\tconst char *group_name = tomoyo_read_token(param);\n\tbool found = false;\n\tif (!tomoyo_correct_word(group_name) || idx >= TOMOYO_MAX_GROUP)\n\t\treturn NULL;\n\te.group_name = tomoyo_get_name(group_name);\n\tif (!e.group_name)\n\t\treturn NULL;\n\tif (mutex_lock_interruptible(&tomoyo_policy_lock))\n\t\tgoto out;\n\tlist = &param->ns->group_list[idx];\n\tlist_for_each_entry(group, list, head.list) {\n\t\tif (e.group_name != group->group_name ||\n\t\t    atomic_read(&group->head.users) == TOMOYO_GC_IN_PROGRESS)\n\t\t\tcontinue;\n\t\tatomic_inc(&group->head.users);\n\t\tfound = true;\n\t\tbreak;\n\t}\n\tif (!found) {\n\t\tstruct tomoyo_group *entry = tomoyo_commit_ok(&e, sizeof(e));\n\t\tif (entry) {\n\t\t\tINIT_LIST_HEAD(&entry->member_list);\n\t\t\tatomic_set(&entry->head.users, 1);\n\t\t\tlist_add_tail_rcu(&entry->head.list, list);\n\t\t\tgroup = entry;\n\t\t\tfound = true;\n\t\t}\n\t}\n\tmutex_unlock(&tomoyo_policy_lock);\nout:\n\ttomoyo_put_name(e.group_name);\n\treturn found ? group : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ptr",
            "0",
            "sizeof(*ptr)"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_parse_number_union(struct tomoyo_acl_param *param,\n\t\t\t       struct tomoyo_number_union *ptr)\n{\n\tchar *data;\n\tu8 type;\n\tunsigned long v;\n\tmemset(ptr, 0, sizeof(*ptr));\n\tif (param->data[0] == '@') {\n\t\tparam->data++;\n\t\tptr->group = tomoyo_get_group(param, TOMOYO_NUMBER_GROUP);\n\t\treturn ptr->group != NULL;\n\t}\n\tdata = tomoyo_read_token(param);\n\ttype = tomoyo_parse_ulong(&v, &data);\n\tif (type == TOMOYO_VALUE_TYPE_INVALID)\n\t\treturn false;\n\tptr->values[0] = v;\n\tptr->value_type[0] = type;\n\tif (!*data) {\n\t\tptr->values[1] = v;\n\t\tptr->value_type[1] = type;\n\t\treturn true;\n\t}\n\tif (*data++ != '-')\n\t\treturn false;\n\ttype = tomoyo_parse_ulong(&v, &data);\n\tif (type == TOMOYO_VALUE_TYPE_INVALID || *data || ptr->values[0] > v)\n\t\treturn false;\n\tptr->values[1] = v;\n\tptr->value_type[1] = type;\n\treturn true;\n}"
  },
  {
    "function_name": "tomoyo_parse_name_union",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "239-253",
    "snippet": "bool tomoyo_parse_name_union(struct tomoyo_acl_param *param,\n\t\t\t     struct tomoyo_name_union *ptr)\n{\n\tchar *filename;\n\tif (param->data[0] == '@') {\n\t\tparam->data++;\n\t\tptr->group = tomoyo_get_group(param, TOMOYO_PATH_GROUP);\n\t\treturn ptr->group != NULL;\n\t}\n\tfilename = tomoyo_read_token(param);\n\tif (!tomoyo_correct_word(filename))\n\t\treturn false;\n\tptr->filename = tomoyo_get_name(filename);\n\treturn ptr->filename != NULL;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_get_name",
          "args": [
            "filename"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_get_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/memory.c",
          "lines": "148-183",
          "snippet": "const struct tomoyo_path_info *tomoyo_get_name(const char *name)\n{\n\tstruct tomoyo_name *ptr;\n\tunsigned int hash;\n\tint len;\n\tstruct list_head *head;\n\n\tif (!name)\n\t\treturn NULL;\n\tlen = strlen(name) + 1;\n\thash = full_name_hash(NULL, (const unsigned char *) name, len - 1);\n\thead = &tomoyo_name_list[hash_long(hash, TOMOYO_HASH_BITS)];\n\tif (mutex_lock_interruptible(&tomoyo_policy_lock))\n\t\treturn NULL;\n\tlist_for_each_entry(ptr, head, head.list) {\n\t\tif (hash != ptr->entry.hash || strcmp(name, ptr->entry.name) ||\n\t\t    atomic_read(&ptr->head.users) == TOMOYO_GC_IN_PROGRESS)\n\t\t\tcontinue;\n\t\tatomic_inc(&ptr->head.users);\n\t\tgoto out;\n\t}\n\tptr = kzalloc(sizeof(*ptr) + len, GFP_NOFS);\n\tif (tomoyo_memory_ok(ptr)) {\n\t\tptr->entry.name = ((char *) ptr) + sizeof(*ptr);\n\t\tmemmove((char *) ptr->entry.name, name, len);\n\t\tatomic_set(&ptr->head.users, 1);\n\t\ttomoyo_fill_path_info(&ptr->entry);\n\t\tlist_add_tail(&ptr->head.list, head);\n\t} else {\n\t\tkfree(ptr);\n\t\tptr = NULL;\n\t}\nout:\n\tmutex_unlock(&tomoyo_policy_lock);\n\treturn ptr ? &ptr->entry : NULL;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/slab.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct list_head tomoyo_name_list[TOMOYO_MAX_HASH];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/slab.h>\n#include <linux/hash.h>\n\nstruct list_head tomoyo_name_list[TOMOYO_MAX_HASH];\n\nconst struct tomoyo_path_info *tomoyo_get_name(const char *name)\n{\n\tstruct tomoyo_name *ptr;\n\tunsigned int hash;\n\tint len;\n\tstruct list_head *head;\n\n\tif (!name)\n\t\treturn NULL;\n\tlen = strlen(name) + 1;\n\thash = full_name_hash(NULL, (const unsigned char *) name, len - 1);\n\thead = &tomoyo_name_list[hash_long(hash, TOMOYO_HASH_BITS)];\n\tif (mutex_lock_interruptible(&tomoyo_policy_lock))\n\t\treturn NULL;\n\tlist_for_each_entry(ptr, head, head.list) {\n\t\tif (hash != ptr->entry.hash || strcmp(name, ptr->entry.name) ||\n\t\t    atomic_read(&ptr->head.users) == TOMOYO_GC_IN_PROGRESS)\n\t\t\tcontinue;\n\t\tatomic_inc(&ptr->head.users);\n\t\tgoto out;\n\t}\n\tptr = kzalloc(sizeof(*ptr) + len, GFP_NOFS);\n\tif (tomoyo_memory_ok(ptr)) {\n\t\tptr->entry.name = ((char *) ptr) + sizeof(*ptr);\n\t\tmemmove((char *) ptr->entry.name, name, len);\n\t\tatomic_set(&ptr->head.users, 1);\n\t\ttomoyo_fill_path_info(&ptr->entry);\n\t\tlist_add_tail(&ptr->head.list, head);\n\t} else {\n\t\tkfree(ptr);\n\t\tptr = NULL;\n\t}\nout:\n\tmutex_unlock(&tomoyo_policy_lock);\n\treturn ptr ? &ptr->entry : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_correct_word",
          "args": [
            "filename"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_correct_word",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "502-505",
          "snippet": "bool tomoyo_correct_word(const char *string)\n{\n\treturn tomoyo_correct_word2(string, strlen(string));\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_correct_word(const char *string)\n{\n\treturn tomoyo_correct_word2(string, strlen(string));\n}"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_read_token",
          "args": [
            "param"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_read_token",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "131-141",
          "snippet": "char *tomoyo_read_token(struct tomoyo_acl_param *param)\n{\n\tchar *pos = param->data;\n\tchar *del = strchr(pos, ' ');\n\tif (del)\n\t\t*del++ = '\\0';\n\telse\n\t\tdel = pos + strlen(pos);\n\tparam->data = del;\n\treturn pos;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nchar *tomoyo_read_token(struct tomoyo_acl_param *param)\n{\n\tchar *pos = param->data;\n\tchar *del = strchr(pos, ' ');\n\tif (del)\n\t\t*del++ = '\\0';\n\telse\n\t\tdel = pos + strlen(pos);\n\tparam->data = del;\n\treturn pos;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_get_group",
          "args": [
            "param",
            "TOMOYO_PATH_GROUP"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_get_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/memory.c",
          "lines": "93-131",
          "snippet": "struct tomoyo_group *tomoyo_get_group(struct tomoyo_acl_param *param,\n\t\t\t\t      const u8 idx)\n{\n\tstruct tomoyo_group e = { };\n\tstruct tomoyo_group *group = NULL;\n\tstruct list_head *list;\n\tconst char *group_name = tomoyo_read_token(param);\n\tbool found = false;\n\tif (!tomoyo_correct_word(group_name) || idx >= TOMOYO_MAX_GROUP)\n\t\treturn NULL;\n\te.group_name = tomoyo_get_name(group_name);\n\tif (!e.group_name)\n\t\treturn NULL;\n\tif (mutex_lock_interruptible(&tomoyo_policy_lock))\n\t\tgoto out;\n\tlist = &param->ns->group_list[idx];\n\tlist_for_each_entry(group, list, head.list) {\n\t\tif (e.group_name != group->group_name ||\n\t\t    atomic_read(&group->head.users) == TOMOYO_GC_IN_PROGRESS)\n\t\t\tcontinue;\n\t\tatomic_inc(&group->head.users);\n\t\tfound = true;\n\t\tbreak;\n\t}\n\tif (!found) {\n\t\tstruct tomoyo_group *entry = tomoyo_commit_ok(&e, sizeof(e));\n\t\tif (entry) {\n\t\t\tINIT_LIST_HEAD(&entry->member_list);\n\t\t\tatomic_set(&entry->head.users, 1);\n\t\t\tlist_add_tail_rcu(&entry->head.list, list);\n\t\t\tgroup = entry;\n\t\t\tfound = true;\n\t\t}\n\t}\n\tmutex_unlock(&tomoyo_policy_lock);\nout:\n\ttomoyo_put_name(e.group_name);\n\treturn found ? group : NULL;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/slab.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/slab.h>\n#include <linux/hash.h>\n\nstruct tomoyo_group *tomoyo_get_group(struct tomoyo_acl_param *param,\n\t\t\t\t      const u8 idx)\n{\n\tstruct tomoyo_group e = { };\n\tstruct tomoyo_group *group = NULL;\n\tstruct list_head *list;\n\tconst char *group_name = tomoyo_read_token(param);\n\tbool found = false;\n\tif (!tomoyo_correct_word(group_name) || idx >= TOMOYO_MAX_GROUP)\n\t\treturn NULL;\n\te.group_name = tomoyo_get_name(group_name);\n\tif (!e.group_name)\n\t\treturn NULL;\n\tif (mutex_lock_interruptible(&tomoyo_policy_lock))\n\t\tgoto out;\n\tlist = &param->ns->group_list[idx];\n\tlist_for_each_entry(group, list, head.list) {\n\t\tif (e.group_name != group->group_name ||\n\t\t    atomic_read(&group->head.users) == TOMOYO_GC_IN_PROGRESS)\n\t\t\tcontinue;\n\t\tatomic_inc(&group->head.users);\n\t\tfound = true;\n\t\tbreak;\n\t}\n\tif (!found) {\n\t\tstruct tomoyo_group *entry = tomoyo_commit_ok(&e, sizeof(e));\n\t\tif (entry) {\n\t\t\tINIT_LIST_HEAD(&entry->member_list);\n\t\t\tatomic_set(&entry->head.users, 1);\n\t\t\tlist_add_tail_rcu(&entry->head.list, list);\n\t\t\tgroup = entry;\n\t\t\tfound = true;\n\t\t}\n\t}\n\tmutex_unlock(&tomoyo_policy_lock);\nout:\n\ttomoyo_put_name(e.group_name);\n\treturn found ? group : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_parse_name_union(struct tomoyo_acl_param *param,\n\t\t\t     struct tomoyo_name_union *ptr)\n{\n\tchar *filename;\n\tif (param->data[0] == '@') {\n\t\tparam->data++;\n\t\tptr->group = tomoyo_get_group(param, TOMOYO_PATH_GROUP);\n\t\treturn ptr->group != NULL;\n\t}\n\tfilename = tomoyo_read_token(param);\n\tif (!tomoyo_correct_word(filename))\n\t\treturn false;\n\tptr->filename = tomoyo_get_name(filename);\n\treturn ptr->filename != NULL;\n}"
  },
  {
    "function_name": "tomoyo_print_ulong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "218-229",
    "snippet": "void tomoyo_print_ulong(char *buffer, const int buffer_len,\n\t\t\tconst unsigned long value, const u8 type)\n{\n\tif (type == TOMOYO_VALUE_TYPE_DECIMAL)\n\t\tsnprintf(buffer, buffer_len, \"%lu\", value);\n\telse if (type == TOMOYO_VALUE_TYPE_OCTAL)\n\t\tsnprintf(buffer, buffer_len, \"0%lo\", value);\n\telse if (type == TOMOYO_VALUE_TYPE_HEXADECIMAL)\n\t\tsnprintf(buffer, buffer_len, \"0x%lX\", value);\n\telse\n\t\tsnprintf(buffer, buffer_len, \"type(%u)\", type);\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buffer",
            "buffer_len",
            "\"type(%u)\"",
            "type"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buffer",
            "buffer_len",
            "\"0x%lX\"",
            "value"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buffer",
            "buffer_len",
            "\"0%lo\"",
            "value"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buffer",
            "buffer_len",
            "\"%lu\"",
            "value"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nvoid tomoyo_print_ulong(char *buffer, const int buffer_len,\n\t\t\tconst unsigned long value, const u8 type)\n{\n\tif (type == TOMOYO_VALUE_TYPE_DECIMAL)\n\t\tsnprintf(buffer, buffer_len, \"%lu\", value);\n\telse if (type == TOMOYO_VALUE_TYPE_OCTAL)\n\t\tsnprintf(buffer, buffer_len, \"0%lo\", value);\n\telse if (type == TOMOYO_VALUE_TYPE_HEXADECIMAL)\n\t\tsnprintf(buffer, buffer_len, \"0x%lX\", value);\n\telse\n\t\tsnprintf(buffer, buffer_len, \"type(%u)\", type);\n}"
  },
  {
    "function_name": "tomoyo_parse_ulong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "179-206",
    "snippet": "u8 tomoyo_parse_ulong(unsigned long *result, char **str)\n{\n\tconst char *cp = *str;\n\tchar *ep;\n\tint base = 10;\n\tif (*cp == '0') {\n\t\tchar c = *(cp + 1);\n\t\tif (c == 'x' || c == 'X') {\n\t\t\tbase = 16;\n\t\t\tcp += 2;\n\t\t} else if (c >= '0' && c <= '7') {\n\t\t\tbase = 8;\n\t\t\tcp++;\n\t\t}\n\t}\n\t*result = simple_strtoul(cp, &ep, base);\n\tif (cp == ep)\n\t\treturn TOMOYO_VALUE_TYPE_INVALID;\n\t*str = ep;\n\tswitch (base) {\n\tcase 16:\n\t\treturn TOMOYO_VALUE_TYPE_HEXADECIMAL;\n\tcase 8:\n\t\treturn TOMOYO_VALUE_TYPE_OCTAL;\n\tdefault:\n\t\treturn TOMOYO_VALUE_TYPE_DECIMAL;\n\t}\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "cp",
            "&ep",
            "base"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nu8 tomoyo_parse_ulong(unsigned long *result, char **str)\n{\n\tconst char *cp = *str;\n\tchar *ep;\n\tint base = 10;\n\tif (*cp == '0') {\n\t\tchar c = *(cp + 1);\n\t\tif (c == 'x' || c == 'X') {\n\t\t\tbase = 16;\n\t\t\tcp += 2;\n\t\t} else if (c >= '0' && c <= '7') {\n\t\t\tbase = 8;\n\t\t\tcp++;\n\t\t}\n\t}\n\t*result = simple_strtoul(cp, &ep, base);\n\tif (cp == ep)\n\t\treturn TOMOYO_VALUE_TYPE_INVALID;\n\t*str = ep;\n\tswitch (base) {\n\tcase 16:\n\t\treturn TOMOYO_VALUE_TYPE_HEXADECIMAL;\n\tcase 8:\n\t\treturn TOMOYO_VALUE_TYPE_OCTAL;\n\tdefault:\n\t\treturn TOMOYO_VALUE_TYPE_DECIMAL;\n\t}\n}"
  },
  {
    "function_name": "tomoyo_get_domainname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "150-166",
    "snippet": "const struct tomoyo_path_info *tomoyo_get_domainname\n(struct tomoyo_acl_param *param)\n{\n\tchar *start = param->data;\n\tchar *pos = start;\n\twhile (*pos) {\n\t\tif (*pos++ != ' ' || *pos++ == '/')\n\t\t\tcontinue;\n\t\tpos -= 2;\n\t\t*pos++ = '\\0';\n\t\tbreak;\n\t}\n\tparam->data = pos;\n\tif (tomoyo_correct_domain(start))\n\t\treturn tomoyo_get_name(start);\n\treturn NULL;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tomoyo_get_name",
          "args": [
            "start"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_get_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/memory.c",
          "lines": "148-183",
          "snippet": "const struct tomoyo_path_info *tomoyo_get_name(const char *name)\n{\n\tstruct tomoyo_name *ptr;\n\tunsigned int hash;\n\tint len;\n\tstruct list_head *head;\n\n\tif (!name)\n\t\treturn NULL;\n\tlen = strlen(name) + 1;\n\thash = full_name_hash(NULL, (const unsigned char *) name, len - 1);\n\thead = &tomoyo_name_list[hash_long(hash, TOMOYO_HASH_BITS)];\n\tif (mutex_lock_interruptible(&tomoyo_policy_lock))\n\t\treturn NULL;\n\tlist_for_each_entry(ptr, head, head.list) {\n\t\tif (hash != ptr->entry.hash || strcmp(name, ptr->entry.name) ||\n\t\t    atomic_read(&ptr->head.users) == TOMOYO_GC_IN_PROGRESS)\n\t\t\tcontinue;\n\t\tatomic_inc(&ptr->head.users);\n\t\tgoto out;\n\t}\n\tptr = kzalloc(sizeof(*ptr) + len, GFP_NOFS);\n\tif (tomoyo_memory_ok(ptr)) {\n\t\tptr->entry.name = ((char *) ptr) + sizeof(*ptr);\n\t\tmemmove((char *) ptr->entry.name, name, len);\n\t\tatomic_set(&ptr->head.users, 1);\n\t\ttomoyo_fill_path_info(&ptr->entry);\n\t\tlist_add_tail(&ptr->head.list, head);\n\t} else {\n\t\tkfree(ptr);\n\t\tptr = NULL;\n\t}\nout:\n\tmutex_unlock(&tomoyo_policy_lock);\n\treturn ptr ? &ptr->entry : NULL;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/slab.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct list_head tomoyo_name_list[TOMOYO_MAX_HASH];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/slab.h>\n#include <linux/hash.h>\n\nstruct list_head tomoyo_name_list[TOMOYO_MAX_HASH];\n\nconst struct tomoyo_path_info *tomoyo_get_name(const char *name)\n{\n\tstruct tomoyo_name *ptr;\n\tunsigned int hash;\n\tint len;\n\tstruct list_head *head;\n\n\tif (!name)\n\t\treturn NULL;\n\tlen = strlen(name) + 1;\n\thash = full_name_hash(NULL, (const unsigned char *) name, len - 1);\n\thead = &tomoyo_name_list[hash_long(hash, TOMOYO_HASH_BITS)];\n\tif (mutex_lock_interruptible(&tomoyo_policy_lock))\n\t\treturn NULL;\n\tlist_for_each_entry(ptr, head, head.list) {\n\t\tif (hash != ptr->entry.hash || strcmp(name, ptr->entry.name) ||\n\t\t    atomic_read(&ptr->head.users) == TOMOYO_GC_IN_PROGRESS)\n\t\t\tcontinue;\n\t\tatomic_inc(&ptr->head.users);\n\t\tgoto out;\n\t}\n\tptr = kzalloc(sizeof(*ptr) + len, GFP_NOFS);\n\tif (tomoyo_memory_ok(ptr)) {\n\t\tptr->entry.name = ((char *) ptr) + sizeof(*ptr);\n\t\tmemmove((char *) ptr->entry.name, name, len);\n\t\tatomic_set(&ptr->head.users, 1);\n\t\ttomoyo_fill_path_info(&ptr->entry);\n\t\tlist_add_tail(&ptr->head.list, head);\n\t} else {\n\t\tkfree(ptr);\n\t\tptr = NULL;\n\t}\nout:\n\tmutex_unlock(&tomoyo_policy_lock);\n\treturn ptr ? &ptr->entry : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tomoyo_correct_domain",
          "args": [
            "start"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "tomoyo_correct_domain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
          "lines": "527-544",
          "snippet": "bool tomoyo_correct_domain(const unsigned char *domainname)\n{\n\tif (!domainname || !tomoyo_domain_def(domainname))\n\t\treturn false;\n\tdomainname = strchr(domainname, ' ');\n\tif (!domainname++)\n\t\treturn true;\n\twhile (1) {\n\t\tconst unsigned char *cp = strchr(domainname, ' ');\n\t\tif (!cp)\n\t\t\tbreak;\n\t\tif (*domainname != '/' ||\n\t\t    !tomoyo_correct_word2(domainname, cp - domainname))\n\t\t\treturn false;\n\t\tdomainname = cp + 1;\n\t}\n\treturn tomoyo_correct_path(domainname);\n}",
          "includes": [
            "#include \"common.h\"",
            "#include <linux/rculist.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_correct_domain(const unsigned char *domainname)\n{\n\tif (!domainname || !tomoyo_domain_def(domainname))\n\t\treturn false;\n\tdomainname = strchr(domainname, ' ');\n\tif (!domainname++)\n\t\treturn true;\n\twhile (1) {\n\t\tconst unsigned char *cp = strchr(domainname, ' ');\n\t\tif (!cp)\n\t\t\tbreak;\n\t\tif (*domainname != '/' ||\n\t\t    !tomoyo_correct_word2(domainname, cp - domainname))\n\t\t\treturn false;\n\t\tdomainname = cp + 1;\n\t}\n\treturn tomoyo_correct_path(domainname);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nconst struct tomoyo_path_info *tomoyo_get_domainname\n(struct tomoyo_acl_param *param)\n{\n\tchar *start = param->data;\n\tchar *pos = start;\n\twhile (*pos) {\n\t\tif (*pos++ != ' ' || *pos++ == '/')\n\t\t\tcontinue;\n\t\tpos -= 2;\n\t\t*pos++ = '\\0';\n\t\tbreak;\n\t}\n\tparam->data = pos;\n\tif (tomoyo_correct_domain(start))\n\t\treturn tomoyo_get_name(start);\n\treturn NULL;\n}"
  },
  {
    "function_name": "tomoyo_read_token",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "131-141",
    "snippet": "char *tomoyo_read_token(struct tomoyo_acl_param *param)\n{\n\tchar *pos = param->data;\n\tchar *del = strchr(pos, ' ');\n\tif (del)\n\t\t*del++ = '\\0';\n\telse\n\t\tdel = pos + strlen(pos);\n\tparam->data = del;\n\treturn pos;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pos"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "pos",
            "' '"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nchar *tomoyo_read_token(struct tomoyo_acl_param *param)\n{\n\tchar *pos = param->data;\n\tchar *del = strchr(pos, ' ');\n\tif (del)\n\t\t*del++ = '\\0';\n\telse\n\t\tdel = pos + strlen(pos);\n\tparam->data = del;\n\treturn pos;\n}"
  },
  {
    "function_name": "tomoyo_permstr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "113-119",
    "snippet": "bool tomoyo_permstr(const char *string, const char *keyword)\n{\n\tconst char *cp = strstr(string, keyword);\n\tif (cp)\n\t\treturn cp == string || *(cp - 1) == '/';\n\treturn false;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "string",
            "keyword"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nbool tomoyo_permstr(const char *string, const char *keyword)\n{\n\tconst char *cp = strstr(string, keyword);\n\tif (cp)\n\t\treturn cp == string || *(cp - 1) == '/';\n\treturn false;\n}"
  },
  {
    "function_name": "tomoyo_convert_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/tomoyo/util.c",
    "lines": "91-101",
    "snippet": "void tomoyo_convert_time(time64_t time64, struct tomoyo_time *stamp)\n{\n\tstruct tm tm;\n\ttime64_to_tm(time64, 0, &tm);\n\tstamp->sec = tm.tm_sec;\n\tstamp->min = tm.tm_min;\n\tstamp->hour = tm.tm_hour;\n\tstamp->day = tm.tm_mday;\n\tstamp->month = tm.tm_mon + 1;\n\tstamp->year = tm.tm_year + 1900;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include <linux/rculist.h>",
      "#include <linux/slab.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "time64_to_tm",
          "args": [
            "time64",
            "0",
            "&tm"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include <linux/rculist.h>\n#include <linux/slab.h>\n\nvoid tomoyo_convert_time(time64_t time64, struct tomoyo_time *stamp)\n{\n\tstruct tm tm;\n\ttime64_to_tm(time64, 0, &tm);\n\tstamp->sec = tm.tm_sec;\n\tstamp->min = tm.tm_min;\n\tstamp->hour = tm.tm_hour;\n\tstamp->day = tm.tm_mday;\n\tstamp->month = tm.tm_mon + 1;\n\tstamp->year = tm.tm_year + 1900;\n}"
  }
]