[
  {
    "function_name": "smk_ad_setfield_u_net_sk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "497-500",
    "snippet": "static inline void smk_ad_setfield_u_net_sk(struct smk_audit_info *a,\n\t\t\t\t\t    struct sock *sk)\n{\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_setfield_u_net_sk(struct smk_audit_info *a,\n\t\t\t\t\t    struct sock *sk)\n{\n}"
  },
  {
    "function_name": "smk_ad_setfield_u_fs_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "493-496",
    "snippet": "static inline void smk_ad_setfield_u_fs_path(struct smk_audit_info *a,\n\t\t\t\t\t     struct path p)\n{\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_setfield_u_fs_path(struct smk_audit_info *a,\n\t\t\t\t\t     struct path p)\n{\n}"
  },
  {
    "function_name": "smk_ad_setfield_u_fs_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "489-492",
    "snippet": "static inline void smk_ad_setfield_u_fs_inode(struct smk_audit_info *a,\n\t\t\t\t\t      struct inode *i)\n{\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_setfield_u_fs_inode(struct smk_audit_info *a,\n\t\t\t\t\t      struct inode *i)\n{\n}"
  },
  {
    "function_name": "smk_ad_setfield_u_fs_path_mnt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "485-488",
    "snippet": "static inline void smk_ad_setfield_u_fs_path_mnt(struct smk_audit_info *a,\n\t\t\t\t\t\t struct vfsmount *m)\n{\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_setfield_u_fs_path_mnt(struct smk_audit_info *a,\n\t\t\t\t\t\t struct vfsmount *m)\n{\n}"
  },
  {
    "function_name": "smk_ad_setfield_u_fs_path_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "481-484",
    "snippet": "static inline void smk_ad_setfield_u_fs_path_dentry(struct smk_audit_info *a,\n\t\t\t\t\t\t    struct dentry *d)\n{\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_setfield_u_fs_path_dentry(struct smk_audit_info *a,\n\t\t\t\t\t\t    struct dentry *d)\n{\n}"
  },
  {
    "function_name": "smk_ad_setfield_u_tsk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "477-480",
    "snippet": "static inline void smk_ad_setfield_u_tsk(struct smk_audit_info *a,\n\t\t\t\t\t struct task_struct *t)\n{\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_setfield_u_tsk(struct smk_audit_info *a,\n\t\t\t\t\t struct task_struct *t)\n{\n}"
  },
  {
    "function_name": "smk_ad_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "473-476",
    "snippet": "static inline void smk_ad_init(struct smk_audit_info *a, const char *func,\n\t\t\t       char type)\n{\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_init(struct smk_audit_info *a, const char *func,\n\t\t\t       char type)\n{\n}"
  },
  {
    "function_name": "smk_ad_setfield_u_net_sk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "465-469",
    "snippet": "static inline void smk_ad_setfield_u_net_sk(struct smk_audit_info *a,\n\t\t\t\t\t    struct sock *sk)\n{\n\ta->a.u.net->sk = sk;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_setfield_u_net_sk(struct smk_audit_info *a,\n\t\t\t\t\t    struct sock *sk)\n{\n\ta->a.u.net->sk = sk;\n}"
  },
  {
    "function_name": "smk_ad_setfield_u_fs_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "460-464",
    "snippet": "static inline void smk_ad_setfield_u_fs_path(struct smk_audit_info *a,\n\t\t\t\t\t     struct path p)\n{\n\ta->a.u.path = p;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_setfield_u_fs_path(struct smk_audit_info *a,\n\t\t\t\t\t     struct path p)\n{\n\ta->a.u.path = p;\n}"
  },
  {
    "function_name": "smk_ad_setfield_u_fs_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "455-459",
    "snippet": "static inline void smk_ad_setfield_u_fs_inode(struct smk_audit_info *a,\n\t\t\t\t\t      struct inode *i)\n{\n\ta->a.u.inode = i;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_setfield_u_fs_inode(struct smk_audit_info *a,\n\t\t\t\t\t      struct inode *i)\n{\n\ta->a.u.inode = i;\n}"
  },
  {
    "function_name": "smk_ad_setfield_u_fs_path_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "450-454",
    "snippet": "static inline void smk_ad_setfield_u_fs_path_dentry(struct smk_audit_info *a,\n\t\t\t\t\t\t    struct dentry *d)\n{\n\ta->a.u.dentry = d;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_setfield_u_fs_path_dentry(struct smk_audit_info *a,\n\t\t\t\t\t\t    struct dentry *d)\n{\n\ta->a.u.dentry = d;\n}"
  },
  {
    "function_name": "smk_ad_setfield_u_tsk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "445-449",
    "snippet": "static inline void smk_ad_setfield_u_tsk(struct smk_audit_info *a,\n\t\t\t\t\t struct task_struct *t)\n{\n\ta->a.u.tsk = t;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_setfield_u_tsk(struct smk_audit_info *a,\n\t\t\t\t\t struct task_struct *t)\n{\n\ta->a.u.tsk = t;\n}"
  },
  {
    "function_name": "smk_ad_init_net",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "437-443",
    "snippet": "static inline void smk_ad_init_net(struct smk_audit_info *a, const char *func,\n\t\t\t\t   char type, struct lsm_network_audit *net)\n{\n\tsmk_ad_init(a, func, type);\n\tmemset(net, 0, sizeof(*net));\n\ta->a.u.net = net;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "net",
            "0",
            "sizeof(*net)"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smk_ad_init",
          "args": [
            "a",
            "func",
            "type"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "smk_ad_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
          "lines": "473-476",
          "snippet": "static inline void smk_ad_init(struct smk_audit_info *a, const char *func,\n\t\t\t       char type)\n{\n}",
          "includes": [
            "#include <linux/lsm_audit.h>",
            "#include <linux/rculist.h>",
            "#include <linux/list.h>",
            "#include <net/netlabel.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/lsm_hooks.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_init(struct smk_audit_info *a, const char *func,\n\t\t\t       char type)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_init_net(struct smk_audit_info *a, const char *func,\n\t\t\t\t   char type, struct lsm_network_audit *net)\n{\n\tsmk_ad_init(a, func, type);\n\tmemset(net, 0, sizeof(*net));\n\ta->a.u.net = net;\n}"
  },
  {
    "function_name": "smk_ad_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "428-435",
    "snippet": "static inline void smk_ad_init(struct smk_audit_info *a, const char *func,\n\t\t\t       char type)\n{\n\tmemset(&a->sad, 0, sizeof(a->sad));\n\ta->a.type = type;\n\ta->a.smack_audit_data = &a->sad;\n\ta->a.smack_audit_data->function = func;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&a->sad",
            "0",
            "sizeof(a->sad)"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline void smk_ad_init(struct smk_audit_info *a, const char *func,\n\t\t\t       char type)\n{\n\tmemset(&a->sad, 0, sizeof(a->sad));\n\ta->a.type = type;\n\ta->a.smack_audit_data = &a->sad;\n\ta->a.smack_audit_data->function = func;\n}"
  },
  {
    "function_name": "smk_of_current",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "405-408",
    "snippet": "static inline struct smack_known *smk_of_current(void)\n{\n\treturn smk_of_task(current_security());\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smk_of_task",
          "args": [
            "current_security()"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "smk_of_task_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
          "lines": "384-392",
          "snippet": "static inline struct smack_known *smk_of_task_struct(const struct task_struct *t)\n{\n\tstruct smack_known *skp;\n\n\trcu_read_lock();\n\tskp = smk_of_task(__task_cred(t)->security);\n\trcu_read_unlock();\n\treturn skp;\n}",
          "includes": [
            "#include <linux/lsm_audit.h>",
            "#include <linux/rculist.h>",
            "#include <linux/list.h>",
            "#include <net/netlabel.h>",
            "#include <linux/in6.h>",
            "#include <linux/in.h>",
            "#include <linux/lsm_hooks.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline struct smack_known *smk_of_task_struct(const struct task_struct *t)\n{\n\tstruct smack_known *skp;\n\n\trcu_read_lock();\n\tskp = smk_of_task(__task_cred(t)->security);\n\trcu_read_unlock();\n\treturn skp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_security",
          "args": [],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline struct smack_known *smk_of_current(void)\n{\n\treturn smk_of_task(current_security());\n}"
  },
  {
    "function_name": "smk_of_forked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "397-400",
    "snippet": "static inline struct smack_known *smk_of_forked(const struct task_smack *tsp)\n{\n\treturn tsp->smk_forked;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline struct smack_known *smk_of_forked(const struct task_smack *tsp)\n{\n\treturn tsp->smk_forked;\n}"
  },
  {
    "function_name": "smk_of_task_struct",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "384-392",
    "snippet": "static inline struct smack_known *smk_of_task_struct(const struct task_struct *t)\n{\n\tstruct smack_known *skp;\n\n\trcu_read_lock();\n\tskp = smk_of_task(__task_cred(t)->security);\n\trcu_read_unlock();\n\treturn skp;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smk_of_task",
          "args": [
            "__task_cred(t)->security"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "smk_of_task_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
          "lines": "384-392",
          "snippet": "static inline struct smack_known *smk_of_task_struct(const struct task_struct *t)\n{\n\tstruct smack_known *skp;\n\n\trcu_read_lock();\n\tskp = smk_of_task(__task_cred(t)->security);\n\trcu_read_unlock();\n\treturn skp;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "__task_cred",
          "args": [
            "t"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline struct smack_known *smk_of_task_struct(const struct task_struct *t)\n{\n\tstruct smack_known *skp;\n\n\trcu_read_lock();\n\tskp = smk_of_task(__task_cred(t)->security);\n\trcu_read_unlock();\n\treturn skp;\n}"
  },
  {
    "function_name": "smk_of_task",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "379-382",
    "snippet": "static inline struct smack_known *smk_of_task(const struct task_smack *tsp)\n{\n\treturn tsp->smk_task;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline struct smack_known *smk_of_task(const struct task_smack *tsp)\n{\n\treturn tsp->smk_task;\n}"
  },
  {
    "function_name": "smk_of_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "370-374",
    "snippet": "static inline struct smack_known *smk_of_inode(const struct inode *isp)\n{\n\tstruct inode_smack *sip = isp->i_security;\n\treturn sip->smk_inode;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\nstatic inline struct smack_known *smk_of_inode(const struct inode *isp)\n{\n\tstruct inode_smack *sip = isp->i_security;\n\treturn sip->smk_inode;\n}"
  },
  {
    "function_name": "smk_inode_transmutable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/smack/smack.h",
    "lines": "361-365",
    "snippet": "static inline int smk_inode_transmutable(const struct inode *isp)\n{\n\tstruct inode_smack *sip = isp->i_security;\n\treturn (sip->smk_flags & SMK_INODE_TRANSMUTE) != 0;\n}",
    "includes": [
      "#include <linux/lsm_audit.h>",
      "#include <linux/rculist.h>",
      "#include <linux/list.h>",
      "#include <net/netlabel.h>",
      "#include <linux/in6.h>",
      "#include <linux/in.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/capability.h>"
    ],
    "macros_used": [
      "#define\tSMK_INODE_TRANSMUTE\t0x02\t/* directory is transmuting */"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/lsm_audit.h>\n#include <linux/rculist.h>\n#include <linux/list.h>\n#include <net/netlabel.h>\n#include <linux/in6.h>\n#include <linux/in.h>\n#include <linux/lsm_hooks.h>\n#include <linux/spinlock.h>\n#include <linux/capability.h>\n\n#define\tSMK_INODE_TRANSMUTE\t0x02\t/* directory is transmuting */\n\nstatic inline int smk_inode_transmutable(const struct inode *isp)\n{\n\tstruct inode_smack *sip = isp->i_security;\n\treturn (sip->smk_flags & SMK_INODE_TRANSMUTE) != 0;\n}"
  }
]