[
  {
    "function_name": "context_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
    "lines": "151-161",
    "snippet": "static inline int context_cmp(struct context *c1, struct context *c2)\n{\n\tif (c1->len && c2->len)\n\t\treturn (c1->len == c2->len && !strcmp(c1->str, c2->str));\n\tif (c1->len || c2->len)\n\t\treturn 0;\n\treturn ((c1->user == c2->user) &&\n\t\t(c1->role == c2->role) &&\n\t\t(c1->type == c2->type) &&\n\t\tmls_context_cmp(c1, c2));\n}",
    "includes": [
      "#include \"security.h\"",
      "#include \"mls_types.h\"",
      "#include \"ebitmap.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mls_context_cmp",
          "args": [
            "c1",
            "c2"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "mls_context_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
          "lines": "98-104",
          "snippet": "static inline int mls_context_cmp(struct context *c1, struct context *c2)\n{\n\treturn ((c1->range.level[0].sens == c2->range.level[0].sens) &&\n\t\tebitmap_cmp(&c1->range.level[0].cat, &c2->range.level[0].cat) &&\n\t\t(c1->range.level[1].sens == c2->range.level[1].sens) &&\n\t\tebitmap_cmp(&c1->range.level[1].cat, &c2->range.level[1].cat));\n}",
          "includes": [
            "#include \"security.h\"",
            "#include \"mls_types.h\"",
            "#include \"ebitmap.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline int mls_context_cmp(struct context *c1, struct context *c2)\n{\n\treturn ((c1->range.level[0].sens == c2->range.level[0].sens) &&\n\t\tebitmap_cmp(&c1->range.level[0].cat, &c2->range.level[0].cat) &&\n\t\t(c1->range.level[1].sens == c2->range.level[1].sens) &&\n\t\tebitmap_cmp(&c1->range.level[1].cat, &c2->range.level[1].cat));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "c1->str",
            "c2->str"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline int context_cmp(struct context *c1, struct context *c2)\n{\n\tif (c1->len && c2->len)\n\t\treturn (c1->len == c2->len && !strcmp(c1->str, c2->str));\n\tif (c1->len || c2->len)\n\t\treturn 0;\n\treturn ((c1->user == c2->user) &&\n\t\t(c1->role == c2->role) &&\n\t\t(c1->type == c2->type) &&\n\t\tmls_context_cmp(c1, c2));\n}"
  },
  {
    "function_name": "context_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
    "lines": "142-149",
    "snippet": "static inline void context_destroy(struct context *c)\n{\n\tc->user = c->role = c->type = 0;\n\tkfree(c->str);\n\tc->str = NULL;\n\tc->len = 0;\n\tmls_context_destroy(c);\n}",
    "includes": [
      "#include \"security.h\"",
      "#include \"mls_types.h\"",
      "#include \"ebitmap.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mls_context_destroy",
          "args": [
            "c"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "mls_context_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
          "lines": "106-111",
          "snippet": "static inline void mls_context_destroy(struct context *c)\n{\n\tebitmap_destroy(&c->range.level[0].cat);\n\tebitmap_destroy(&c->range.level[1].cat);\n\tmls_context_init(c);\n}",
          "includes": [
            "#include \"security.h\"",
            "#include \"mls_types.h\"",
            "#include \"ebitmap.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline void mls_context_destroy(struct context *c)\n{\n\tebitmap_destroy(&c->range.level[0].cat);\n\tebitmap_destroy(&c->range.level[1].cat);\n\tmls_context_init(c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "c->str"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline void context_destroy(struct context *c)\n{\n\tc->user = c->role = c->type = 0;\n\tkfree(c->str);\n\tc->str = NULL;\n\tc->len = 0;\n\tmls_context_destroy(c);\n}"
  },
  {
    "function_name": "context_cpy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
    "lines": "118-140",
    "snippet": "static inline int context_cpy(struct context *dst, struct context *src)\n{\n\tint rc;\n\n\tdst->user = src->user;\n\tdst->role = src->role;\n\tdst->type = src->type;\n\tif (src->str) {\n\t\tdst->str = kstrdup(src->str, GFP_ATOMIC);\n\t\tif (!dst->str)\n\t\t\treturn -ENOMEM;\n\t\tdst->len = src->len;\n\t} else {\n\t\tdst->str = NULL;\n\t\tdst->len = 0;\n\t}\n\trc = mls_context_cpy(dst, src);\n\tif (rc) {\n\t\tkfree(dst->str);\n\t\treturn rc;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"security.h\"",
      "#include \"mls_types.h\"",
      "#include \"ebitmap.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "dst->str"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mls_context_cpy",
          "args": [
            "dst",
            "src"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "mls_context_cpy_high",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
          "lines": "81-96",
          "snippet": "static inline int mls_context_cpy_high(struct context *dst, struct context *src)\n{\n\tint rc;\n\n\tdst->range.level[0].sens = src->range.level[1].sens;\n\trc = ebitmap_cpy(&dst->range.level[0].cat, &src->range.level[1].cat);\n\tif (rc)\n\t\tgoto out;\n\n\tdst->range.level[1].sens = src->range.level[1].sens;\n\trc = ebitmap_cpy(&dst->range.level[1].cat, &src->range.level[1].cat);\n\tif (rc)\n\t\tebitmap_destroy(&dst->range.level[0].cat);\nout:\n\treturn rc;\n}",
          "includes": [
            "#include \"security.h\"",
            "#include \"mls_types.h\"",
            "#include \"ebitmap.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline int mls_context_cpy_high(struct context *dst, struct context *src)\n{\n\tint rc;\n\n\tdst->range.level[0].sens = src->range.level[1].sens;\n\trc = ebitmap_cpy(&dst->range.level[0].cat, &src->range.level[1].cat);\n\tif (rc)\n\t\tgoto out;\n\n\tdst->range.level[1].sens = src->range.level[1].sens;\n\trc = ebitmap_cpy(&dst->range.level[1].cat, &src->range.level[1].cat);\n\tif (rc)\n\t\tebitmap_destroy(&dst->range.level[0].cat);\nout:\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrdup",
          "args": [
            "src->str",
            "GFP_ATOMIC"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline int context_cpy(struct context *dst, struct context *src)\n{\n\tint rc;\n\n\tdst->user = src->user;\n\tdst->role = src->role;\n\tdst->type = src->type;\n\tif (src->str) {\n\t\tdst->str = kstrdup(src->str, GFP_ATOMIC);\n\t\tif (!dst->str)\n\t\t\treturn -ENOMEM;\n\t\tdst->len = src->len;\n\t} else {\n\t\tdst->str = NULL;\n\t\tdst->len = 0;\n\t}\n\trc = mls_context_cpy(dst, src);\n\tif (rc) {\n\t\tkfree(dst->str);\n\t\treturn rc;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "context_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
    "lines": "113-116",
    "snippet": "static inline void context_init(struct context *c)\n{\n\tmemset(c, 0, sizeof(*c));\n}",
    "includes": [
      "#include \"security.h\"",
      "#include \"mls_types.h\"",
      "#include \"ebitmap.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "c",
            "0",
            "sizeof(*c)"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline void context_init(struct context *c)\n{\n\tmemset(c, 0, sizeof(*c));\n}"
  },
  {
    "function_name": "mls_context_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
    "lines": "106-111",
    "snippet": "static inline void mls_context_destroy(struct context *c)\n{\n\tebitmap_destroy(&c->range.level[0].cat);\n\tebitmap_destroy(&c->range.level[1].cat);\n\tmls_context_init(c);\n}",
    "includes": [
      "#include \"security.h\"",
      "#include \"mls_types.h\"",
      "#include \"ebitmap.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mls_context_init",
          "args": [
            "c"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "mls_context_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
          "lines": "36-39",
          "snippet": "static inline void mls_context_init(struct context *c)\n{\n\tmemset(&c->range, 0, sizeof(c->range));\n}",
          "includes": [
            "#include \"security.h\"",
            "#include \"mls_types.h\"",
            "#include \"ebitmap.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline void mls_context_init(struct context *c)\n{\n\tmemset(&c->range, 0, sizeof(c->range));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ebitmap_destroy",
          "args": [
            "&c->range.level[1].cat"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "ebitmap_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.c",
          "lines": "327-344",
          "snippet": "void ebitmap_destroy(struct ebitmap *e)\n{\n\tstruct ebitmap_node *n, *temp;\n\n\tif (!e)\n\t\treturn;\n\n\tn = e->node;\n\twhile (n) {\n\t\ttemp = n;\n\t\tn = n->next;\n\t\tkmem_cache_free(ebitmap_node_cachep, temp);\n\t}\n\n\te->highbit = 0;\n\te->node = NULL;\n\treturn;\n}",
          "includes": [
            "#include \"policydb.h\"",
            "#include \"ebitmap.h\"",
            "#include <net/netlabel.h>",
            "#include <linux/errno.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *ebitmap_node_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"policydb.h\"\n#include \"ebitmap.h\"\n#include <net/netlabel.h>\n#include <linux/errno.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic struct kmem_cache *ebitmap_node_cachep;\n\nvoid ebitmap_destroy(struct ebitmap *e)\n{\n\tstruct ebitmap_node *n, *temp;\n\n\tif (!e)\n\t\treturn;\n\n\tn = e->node;\n\twhile (n) {\n\t\ttemp = n;\n\t\tn = n->next;\n\t\tkmem_cache_free(ebitmap_node_cachep, temp);\n\t}\n\n\te->highbit = 0;\n\te->node = NULL;\n\treturn;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline void mls_context_destroy(struct context *c)\n{\n\tebitmap_destroy(&c->range.level[0].cat);\n\tebitmap_destroy(&c->range.level[1].cat);\n\tmls_context_init(c);\n}"
  },
  {
    "function_name": "mls_context_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
    "lines": "98-104",
    "snippet": "static inline int mls_context_cmp(struct context *c1, struct context *c2)\n{\n\treturn ((c1->range.level[0].sens == c2->range.level[0].sens) &&\n\t\tebitmap_cmp(&c1->range.level[0].cat, &c2->range.level[0].cat) &&\n\t\t(c1->range.level[1].sens == c2->range.level[1].sens) &&\n\t\tebitmap_cmp(&c1->range.level[1].cat, &c2->range.level[1].cat));\n}",
    "includes": [
      "#include \"security.h\"",
      "#include \"mls_types.h\"",
      "#include \"ebitmap.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ebitmap_cmp",
          "args": [
            "&c1->range.level[1].cat",
            "&c2->range.level[1].cat"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "ebitmap_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.c",
          "lines": "30-50",
          "snippet": "int ebitmap_cmp(struct ebitmap *e1, struct ebitmap *e2)\n{\n\tstruct ebitmap_node *n1, *n2;\n\n\tif (e1->highbit != e2->highbit)\n\t\treturn 0;\n\n\tn1 = e1->node;\n\tn2 = e2->node;\n\twhile (n1 && n2 &&\n\t       (n1->startbit == n2->startbit) &&\n\t       !memcmp(n1->maps, n2->maps, EBITMAP_SIZE / 8)) {\n\t\tn1 = n1->next;\n\t\tn2 = n2->next;\n\t}\n\n\tif (n1 || n2)\n\t\treturn 0;\n\n\treturn 1;\n}",
          "includes": [
            "#include \"policydb.h\"",
            "#include \"ebitmap.h\"",
            "#include <net/netlabel.h>",
            "#include <linux/errno.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"policydb.h\"\n#include \"ebitmap.h\"\n#include <net/netlabel.h>\n#include <linux/errno.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nint ebitmap_cmp(struct ebitmap *e1, struct ebitmap *e2)\n{\n\tstruct ebitmap_node *n1, *n2;\n\n\tif (e1->highbit != e2->highbit)\n\t\treturn 0;\n\n\tn1 = e1->node;\n\tn2 = e2->node;\n\twhile (n1 && n2 &&\n\t       (n1->startbit == n2->startbit) &&\n\t       !memcmp(n1->maps, n2->maps, EBITMAP_SIZE / 8)) {\n\t\tn1 = n1->next;\n\t\tn2 = n2->next;\n\t}\n\n\tif (n1 || n2)\n\t\treturn 0;\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline int mls_context_cmp(struct context *c1, struct context *c2)\n{\n\treturn ((c1->range.level[0].sens == c2->range.level[0].sens) &&\n\t\tebitmap_cmp(&c1->range.level[0].cat, &c2->range.level[0].cat) &&\n\t\t(c1->range.level[1].sens == c2->range.level[1].sens) &&\n\t\tebitmap_cmp(&c1->range.level[1].cat, &c2->range.level[1].cat));\n}"
  },
  {
    "function_name": "mls_context_cpy_high",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
    "lines": "81-96",
    "snippet": "static inline int mls_context_cpy_high(struct context *dst, struct context *src)\n{\n\tint rc;\n\n\tdst->range.level[0].sens = src->range.level[1].sens;\n\trc = ebitmap_cpy(&dst->range.level[0].cat, &src->range.level[1].cat);\n\tif (rc)\n\t\tgoto out;\n\n\tdst->range.level[1].sens = src->range.level[1].sens;\n\trc = ebitmap_cpy(&dst->range.level[1].cat, &src->range.level[1].cat);\n\tif (rc)\n\t\tebitmap_destroy(&dst->range.level[0].cat);\nout:\n\treturn rc;\n}",
    "includes": [
      "#include \"security.h\"",
      "#include \"mls_types.h\"",
      "#include \"ebitmap.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ebitmap_destroy",
          "args": [
            "&dst->range.level[0].cat"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "ebitmap_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.c",
          "lines": "327-344",
          "snippet": "void ebitmap_destroy(struct ebitmap *e)\n{\n\tstruct ebitmap_node *n, *temp;\n\n\tif (!e)\n\t\treturn;\n\n\tn = e->node;\n\twhile (n) {\n\t\ttemp = n;\n\t\tn = n->next;\n\t\tkmem_cache_free(ebitmap_node_cachep, temp);\n\t}\n\n\te->highbit = 0;\n\te->node = NULL;\n\treturn;\n}",
          "includes": [
            "#include \"policydb.h\"",
            "#include \"ebitmap.h\"",
            "#include <net/netlabel.h>",
            "#include <linux/errno.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *ebitmap_node_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"policydb.h\"\n#include \"ebitmap.h\"\n#include <net/netlabel.h>\n#include <linux/errno.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic struct kmem_cache *ebitmap_node_cachep;\n\nvoid ebitmap_destroy(struct ebitmap *e)\n{\n\tstruct ebitmap_node *n, *temp;\n\n\tif (!e)\n\t\treturn;\n\n\tn = e->node;\n\twhile (n) {\n\t\ttemp = n;\n\t\tn = n->next;\n\t\tkmem_cache_free(ebitmap_node_cachep, temp);\n\t}\n\n\te->highbit = 0;\n\te->node = NULL;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ebitmap_cpy",
          "args": [
            "&dst->range.level[1].cat",
            "&src->range.level[1].cat"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "ebitmap_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.c",
          "lines": "52-78",
          "snippet": "int ebitmap_cpy(struct ebitmap *dst, struct ebitmap *src)\n{\n\tstruct ebitmap_node *n, *new, *prev;\n\n\tebitmap_init(dst);\n\tn = src->node;\n\tprev = NULL;\n\twhile (n) {\n\t\tnew = kmem_cache_zalloc(ebitmap_node_cachep, GFP_ATOMIC);\n\t\tif (!new) {\n\t\t\tebitmap_destroy(dst);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tnew->startbit = n->startbit;\n\t\tmemcpy(new->maps, n->maps, EBITMAP_SIZE / 8);\n\t\tnew->next = NULL;\n\t\tif (prev)\n\t\t\tprev->next = new;\n\t\telse\n\t\t\tdst->node = new;\n\t\tprev = new;\n\t\tn = n->next;\n\t}\n\n\tdst->highbit = src->highbit;\n\treturn 0;\n}",
          "includes": [
            "#include \"policydb.h\"",
            "#include \"ebitmap.h\"",
            "#include <net/netlabel.h>",
            "#include <linux/errno.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *ebitmap_node_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"policydb.h\"\n#include \"ebitmap.h\"\n#include <net/netlabel.h>\n#include <linux/errno.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic struct kmem_cache *ebitmap_node_cachep;\n\nint ebitmap_cpy(struct ebitmap *dst, struct ebitmap *src)\n{\n\tstruct ebitmap_node *n, *new, *prev;\n\n\tebitmap_init(dst);\n\tn = src->node;\n\tprev = NULL;\n\twhile (n) {\n\t\tnew = kmem_cache_zalloc(ebitmap_node_cachep, GFP_ATOMIC);\n\t\tif (!new) {\n\t\t\tebitmap_destroy(dst);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tnew->startbit = n->startbit;\n\t\tmemcpy(new->maps, n->maps, EBITMAP_SIZE / 8);\n\t\tnew->next = NULL;\n\t\tif (prev)\n\t\t\tprev->next = new;\n\t\telse\n\t\t\tdst->node = new;\n\t\tprev = new;\n\t\tn = n->next;\n\t}\n\n\tdst->highbit = src->highbit;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline int mls_context_cpy_high(struct context *dst, struct context *src)\n{\n\tint rc;\n\n\tdst->range.level[0].sens = src->range.level[1].sens;\n\trc = ebitmap_cpy(&dst->range.level[0].cat, &src->range.level[1].cat);\n\tif (rc)\n\t\tgoto out;\n\n\tdst->range.level[1].sens = src->range.level[1].sens;\n\trc = ebitmap_cpy(&dst->range.level[1].cat, &src->range.level[1].cat);\n\tif (rc)\n\t\tebitmap_destroy(&dst->range.level[0].cat);\nout:\n\treturn rc;\n}"
  },
  {
    "function_name": "mls_context_cpy_low",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
    "lines": "61-76",
    "snippet": "static inline int mls_context_cpy_low(struct context *dst, struct context *src)\n{\n\tint rc;\n\n\tdst->range.level[0].sens = src->range.level[0].sens;\n\trc = ebitmap_cpy(&dst->range.level[0].cat, &src->range.level[0].cat);\n\tif (rc)\n\t\tgoto out;\n\n\tdst->range.level[1].sens = src->range.level[0].sens;\n\trc = ebitmap_cpy(&dst->range.level[1].cat, &src->range.level[0].cat);\n\tif (rc)\n\t\tebitmap_destroy(&dst->range.level[0].cat);\nout:\n\treturn rc;\n}",
    "includes": [
      "#include \"security.h\"",
      "#include \"mls_types.h\"",
      "#include \"ebitmap.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ebitmap_destroy",
          "args": [
            "&dst->range.level[0].cat"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "ebitmap_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.c",
          "lines": "327-344",
          "snippet": "void ebitmap_destroy(struct ebitmap *e)\n{\n\tstruct ebitmap_node *n, *temp;\n\n\tif (!e)\n\t\treturn;\n\n\tn = e->node;\n\twhile (n) {\n\t\ttemp = n;\n\t\tn = n->next;\n\t\tkmem_cache_free(ebitmap_node_cachep, temp);\n\t}\n\n\te->highbit = 0;\n\te->node = NULL;\n\treturn;\n}",
          "includes": [
            "#include \"policydb.h\"",
            "#include \"ebitmap.h\"",
            "#include <net/netlabel.h>",
            "#include <linux/errno.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *ebitmap_node_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"policydb.h\"\n#include \"ebitmap.h\"\n#include <net/netlabel.h>\n#include <linux/errno.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic struct kmem_cache *ebitmap_node_cachep;\n\nvoid ebitmap_destroy(struct ebitmap *e)\n{\n\tstruct ebitmap_node *n, *temp;\n\n\tif (!e)\n\t\treturn;\n\n\tn = e->node;\n\twhile (n) {\n\t\ttemp = n;\n\t\tn = n->next;\n\t\tkmem_cache_free(ebitmap_node_cachep, temp);\n\t}\n\n\te->highbit = 0;\n\te->node = NULL;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ebitmap_cpy",
          "args": [
            "&dst->range.level[1].cat",
            "&src->range.level[0].cat"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "ebitmap_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.c",
          "lines": "52-78",
          "snippet": "int ebitmap_cpy(struct ebitmap *dst, struct ebitmap *src)\n{\n\tstruct ebitmap_node *n, *new, *prev;\n\n\tebitmap_init(dst);\n\tn = src->node;\n\tprev = NULL;\n\twhile (n) {\n\t\tnew = kmem_cache_zalloc(ebitmap_node_cachep, GFP_ATOMIC);\n\t\tif (!new) {\n\t\t\tebitmap_destroy(dst);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tnew->startbit = n->startbit;\n\t\tmemcpy(new->maps, n->maps, EBITMAP_SIZE / 8);\n\t\tnew->next = NULL;\n\t\tif (prev)\n\t\t\tprev->next = new;\n\t\telse\n\t\t\tdst->node = new;\n\t\tprev = new;\n\t\tn = n->next;\n\t}\n\n\tdst->highbit = src->highbit;\n\treturn 0;\n}",
          "includes": [
            "#include \"policydb.h\"",
            "#include \"ebitmap.h\"",
            "#include <net/netlabel.h>",
            "#include <linux/errno.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *ebitmap_node_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"policydb.h\"\n#include \"ebitmap.h\"\n#include <net/netlabel.h>\n#include <linux/errno.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic struct kmem_cache *ebitmap_node_cachep;\n\nint ebitmap_cpy(struct ebitmap *dst, struct ebitmap *src)\n{\n\tstruct ebitmap_node *n, *new, *prev;\n\n\tebitmap_init(dst);\n\tn = src->node;\n\tprev = NULL;\n\twhile (n) {\n\t\tnew = kmem_cache_zalloc(ebitmap_node_cachep, GFP_ATOMIC);\n\t\tif (!new) {\n\t\t\tebitmap_destroy(dst);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tnew->startbit = n->startbit;\n\t\tmemcpy(new->maps, n->maps, EBITMAP_SIZE / 8);\n\t\tnew->next = NULL;\n\t\tif (prev)\n\t\t\tprev->next = new;\n\t\telse\n\t\t\tdst->node = new;\n\t\tprev = new;\n\t\tn = n->next;\n\t}\n\n\tdst->highbit = src->highbit;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline int mls_context_cpy_low(struct context *dst, struct context *src)\n{\n\tint rc;\n\n\tdst->range.level[0].sens = src->range.level[0].sens;\n\trc = ebitmap_cpy(&dst->range.level[0].cat, &src->range.level[0].cat);\n\tif (rc)\n\t\tgoto out;\n\n\tdst->range.level[1].sens = src->range.level[0].sens;\n\trc = ebitmap_cpy(&dst->range.level[1].cat, &src->range.level[0].cat);\n\tif (rc)\n\t\tebitmap_destroy(&dst->range.level[0].cat);\nout:\n\treturn rc;\n}"
  },
  {
    "function_name": "mls_context_cpy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
    "lines": "41-56",
    "snippet": "static inline int mls_context_cpy(struct context *dst, struct context *src)\n{\n\tint rc;\n\n\tdst->range.level[0].sens = src->range.level[0].sens;\n\trc = ebitmap_cpy(&dst->range.level[0].cat, &src->range.level[0].cat);\n\tif (rc)\n\t\tgoto out;\n\n\tdst->range.level[1].sens = src->range.level[1].sens;\n\trc = ebitmap_cpy(&dst->range.level[1].cat, &src->range.level[1].cat);\n\tif (rc)\n\t\tebitmap_destroy(&dst->range.level[0].cat);\nout:\n\treturn rc;\n}",
    "includes": [
      "#include \"security.h\"",
      "#include \"mls_types.h\"",
      "#include \"ebitmap.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ebitmap_destroy",
          "args": [
            "&dst->range.level[0].cat"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "ebitmap_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.c",
          "lines": "327-344",
          "snippet": "void ebitmap_destroy(struct ebitmap *e)\n{\n\tstruct ebitmap_node *n, *temp;\n\n\tif (!e)\n\t\treturn;\n\n\tn = e->node;\n\twhile (n) {\n\t\ttemp = n;\n\t\tn = n->next;\n\t\tkmem_cache_free(ebitmap_node_cachep, temp);\n\t}\n\n\te->highbit = 0;\n\te->node = NULL;\n\treturn;\n}",
          "includes": [
            "#include \"policydb.h\"",
            "#include \"ebitmap.h\"",
            "#include <net/netlabel.h>",
            "#include <linux/errno.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *ebitmap_node_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"policydb.h\"\n#include \"ebitmap.h\"\n#include <net/netlabel.h>\n#include <linux/errno.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic struct kmem_cache *ebitmap_node_cachep;\n\nvoid ebitmap_destroy(struct ebitmap *e)\n{\n\tstruct ebitmap_node *n, *temp;\n\n\tif (!e)\n\t\treturn;\n\n\tn = e->node;\n\twhile (n) {\n\t\ttemp = n;\n\t\tn = n->next;\n\t\tkmem_cache_free(ebitmap_node_cachep, temp);\n\t}\n\n\te->highbit = 0;\n\te->node = NULL;\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ebitmap_cpy",
          "args": [
            "&dst->range.level[1].cat",
            "&src->range.level[1].cat"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "ebitmap_cpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/ebitmap.c",
          "lines": "52-78",
          "snippet": "int ebitmap_cpy(struct ebitmap *dst, struct ebitmap *src)\n{\n\tstruct ebitmap_node *n, *new, *prev;\n\n\tebitmap_init(dst);\n\tn = src->node;\n\tprev = NULL;\n\twhile (n) {\n\t\tnew = kmem_cache_zalloc(ebitmap_node_cachep, GFP_ATOMIC);\n\t\tif (!new) {\n\t\t\tebitmap_destroy(dst);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tnew->startbit = n->startbit;\n\t\tmemcpy(new->maps, n->maps, EBITMAP_SIZE / 8);\n\t\tnew->next = NULL;\n\t\tif (prev)\n\t\t\tprev->next = new;\n\t\telse\n\t\t\tdst->node = new;\n\t\tprev = new;\n\t\tn = n->next;\n\t}\n\n\tdst->highbit = src->highbit;\n\treturn 0;\n}",
          "includes": [
            "#include \"policydb.h\"",
            "#include \"ebitmap.h\"",
            "#include <net/netlabel.h>",
            "#include <linux/errno.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *ebitmap_node_cachep;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"policydb.h\"\n#include \"ebitmap.h\"\n#include <net/netlabel.h>\n#include <linux/errno.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic struct kmem_cache *ebitmap_node_cachep;\n\nint ebitmap_cpy(struct ebitmap *dst, struct ebitmap *src)\n{\n\tstruct ebitmap_node *n, *new, *prev;\n\n\tebitmap_init(dst);\n\tn = src->node;\n\tprev = NULL;\n\twhile (n) {\n\t\tnew = kmem_cache_zalloc(ebitmap_node_cachep, GFP_ATOMIC);\n\t\tif (!new) {\n\t\t\tebitmap_destroy(dst);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tnew->startbit = n->startbit;\n\t\tmemcpy(new->maps, n->maps, EBITMAP_SIZE / 8);\n\t\tnew->next = NULL;\n\t\tif (prev)\n\t\t\tprev->next = new;\n\t\telse\n\t\t\tdst->node = new;\n\t\tprev = new;\n\t\tn = n->next;\n\t}\n\n\tdst->highbit = src->highbit;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline int mls_context_cpy(struct context *dst, struct context *src)\n{\n\tint rc;\n\n\tdst->range.level[0].sens = src->range.level[0].sens;\n\trc = ebitmap_cpy(&dst->range.level[0].cat, &src->range.level[0].cat);\n\tif (rc)\n\t\tgoto out;\n\n\tdst->range.level[1].sens = src->range.level[1].sens;\n\trc = ebitmap_cpy(&dst->range.level[1].cat, &src->range.level[1].cat);\n\tif (rc)\n\t\tebitmap_destroy(&dst->range.level[0].cat);\nout:\n\treturn rc;\n}"
  },
  {
    "function_name": "mls_context_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-17807/repo/security/selinux/ss/context.h",
    "lines": "36-39",
    "snippet": "static inline void mls_context_init(struct context *c)\n{\n\tmemset(&c->range, 0, sizeof(c->range));\n}",
    "includes": [
      "#include \"security.h\"",
      "#include \"mls_types.h\"",
      "#include \"ebitmap.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&c->range",
            "0",
            "sizeof(c->range)"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"security.h\"\n#include \"mls_types.h\"\n#include \"ebitmap.h\"\n\nstatic inline void mls_context_init(struct context *c)\n{\n\tmemset(&c->range, 0, sizeof(c->range));\n}"
  }
]