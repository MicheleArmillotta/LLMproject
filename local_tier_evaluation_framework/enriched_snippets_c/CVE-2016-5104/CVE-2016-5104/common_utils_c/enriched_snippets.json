[
  {
    "function_name": "plist_print_to_stream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "466-483",
    "snippet": "void plist_print_to_stream(plist_t plist, FILE* stream)\n{\n\tint indent = 0;\n\n\tif (!plist || !stream)\n\t\treturn;\n\n\tswitch (plist_get_node_type(plist)) {\n\tcase PLIST_DICT:\n\t\tplist_dict_print_to_stream(plist, &indent, stream);\n\t\tbreak;\n\tcase PLIST_ARRAY:\n\t\tplist_array_print_to_stream(plist, &indent, stream);\n\t\tbreak;\n\tdefault:\n\t\tplist_node_print_to_stream(plist, &indent, stream);\n\t}\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_node_print_to_stream",
          "args": [
            "plist",
            "&indent",
            "stream"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "plist_node_print_to_stream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "365-464",
          "snippet": "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\tchar *s = NULL;\n\tchar *data = NULL;\n\tdouble d;\n\tuint8_t b;\n\tuint64_t u = 0;\n\tstruct timeval tv = { 0, 0 };\n\n\tplist_type t;\n\n\tif (!node)\n\t\treturn;\n\n\tt = plist_get_node_type(node);\n\n\tswitch (t) {\n\tcase PLIST_BOOLEAN:\n\t\tplist_get_bool_val(node, &b);\n\t\tfprintf(stream, \"%s\\n\", (b ? \"true\" : \"false\"));\n\t\tbreak;\n\n\tcase PLIST_UINT:\n\t\tplist_get_uint_val(node, &u);\n\t\tfprintf(stream, \"%\"PRIu64\"\\n\", u);\n\t\tbreak;\n\n\tcase PLIST_REAL:\n\t\tplist_get_real_val(node, &d);\n\t\tfprintf(stream, \"%f\\n\", d);\n\t\tbreak;\n\n\tcase PLIST_STRING:\n\t\tplist_get_string_val(node, &s);\n\t\tfprintf(stream, \"%s\\n\", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_KEY:\n\t\tplist_get_key_val(node, &s);\n\t\tfprintf(stream, \"%s: \", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_DATA:\n\t\tplist_get_data_val(node, &data, &u);\n\t\tif (u > 0) {\n\t\t\ts = base64encode((unsigned char*)data, u);\n\t\t\tfree(data);\n\t\t\tif (s) {\n\t\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\t\tfree(s);\n\t\t\t} else {\n\t\t\t\tfprintf(stream, \"\\n\");\n\t\t\t}\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_DATE:\n\t\tplist_get_date_val(node, (int32_t*)&tv.tv_sec, (int32_t*)&tv.tv_usec);\n\t\t{\n\t\t\ttime_t ti = (time_t)tv.tv_sec;\n\t\t\tstruct tm *btime = localtime(&ti);\n\t\t\tif (btime) {\n\t\t\t\ts = (char*)malloc(24);\n \t\t\t\tmemset(s, 0, 24);\n\t\t\t\tif (strftime(s, 24, \"%Y-%m-%dT%H:%M:%SZ\", btime) <= 0) {\n\t\t\t\t\tfree (s);\n\t\t\t\t\ts = NULL;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (s) {\n\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\tfree(s);\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_ARRAY:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_array_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tcase PLIST_DICT:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_dict_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\tchar *s = NULL;\n\tchar *data = NULL;\n\tdouble d;\n\tuint8_t b;\n\tuint64_t u = 0;\n\tstruct timeval tv = { 0, 0 };\n\n\tplist_type t;\n\n\tif (!node)\n\t\treturn;\n\n\tt = plist_get_node_type(node);\n\n\tswitch (t) {\n\tcase PLIST_BOOLEAN:\n\t\tplist_get_bool_val(node, &b);\n\t\tfprintf(stream, \"%s\\n\", (b ? \"true\" : \"false\"));\n\t\tbreak;\n\n\tcase PLIST_UINT:\n\t\tplist_get_uint_val(node, &u);\n\t\tfprintf(stream, \"%\"PRIu64\"\\n\", u);\n\t\tbreak;\n\n\tcase PLIST_REAL:\n\t\tplist_get_real_val(node, &d);\n\t\tfprintf(stream, \"%f\\n\", d);\n\t\tbreak;\n\n\tcase PLIST_STRING:\n\t\tplist_get_string_val(node, &s);\n\t\tfprintf(stream, \"%s\\n\", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_KEY:\n\t\tplist_get_key_val(node, &s);\n\t\tfprintf(stream, \"%s: \", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_DATA:\n\t\tplist_get_data_val(node, &data, &u);\n\t\tif (u > 0) {\n\t\t\ts = base64encode((unsigned char*)data, u);\n\t\t\tfree(data);\n\t\t\tif (s) {\n\t\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\t\tfree(s);\n\t\t\t} else {\n\t\t\t\tfprintf(stream, \"\\n\");\n\t\t\t}\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_DATE:\n\t\tplist_get_date_val(node, (int32_t*)&tv.tv_sec, (int32_t*)&tv.tv_usec);\n\t\t{\n\t\t\ttime_t ti = (time_t)tv.tv_sec;\n\t\t\tstruct tm *btime = localtime(&ti);\n\t\t\tif (btime) {\n\t\t\t\ts = (char*)malloc(24);\n \t\t\t\tmemset(s, 0, 24);\n\t\t\t\tif (strftime(s, 24, \"%Y-%m-%dT%H:%M:%SZ\", btime) <= 0) {\n\t\t\t\t\tfree (s);\n\t\t\t\t\ts = NULL;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (s) {\n\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\tfree(s);\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_ARRAY:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_array_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tcase PLIST_DICT:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_dict_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_array_print_to_stream",
          "args": [
            "plist",
            "&indent",
            "stream"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "plist_array_print_to_stream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "324-338",
          "snippet": "static void plist_array_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over items */\n\tint i, count;\n\tplist_t subnode = NULL;\n\n\tcount = plist_array_get_size(node);\n\n\tfor (i = 0; i < count; i++) {\n\t\tsubnode = plist_array_get_item(node, i);\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%d: \", i);\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t}\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);\n\nstatic void plist_array_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over items */\n\tint i, count;\n\tplist_t subnode = NULL;\n\n\tcount = plist_array_get_size(node);\n\n\tfor (i = 0; i < count; i++) {\n\t\tsubnode = plist_array_get_item(node, i);\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%d: \", i);\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_print_to_stream",
          "args": [
            "plist",
            "&indent",
            "stream"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "plist_dict_print_to_stream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "340-363",
          "snippet": "static void plist_dict_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over key/value pairs */\n\tplist_dict_iter it = NULL;\n\n\tchar* key = NULL;\n\tplist_t subnode = NULL;\n\tplist_dict_new_iter(node, &it);\n\tplist_dict_next_item(node, it, &key, &subnode);\n\twhile (subnode)\n\t{\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%s\", key);\n\t\tif (plist_get_node_type(subnode) == PLIST_ARRAY)\n\t\t\tfprintf(stream, \"[%d]: \", plist_array_get_size(subnode));\n\t\telse\n\t\t\tfprintf(stream, \": \");\n\t\tfree(key);\n\t\tkey = NULL;\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t\tplist_dict_next_item(node, it, &key, &subnode);\n\t}\n\tfree(it);\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);\n\nstatic void plist_dict_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over key/value pairs */\n\tplist_dict_iter it = NULL;\n\n\tchar* key = NULL;\n\tplist_t subnode = NULL;\n\tplist_dict_new_iter(node, &it);\n\tplist_dict_next_item(node, it, &key, &subnode);\n\twhile (subnode)\n\t{\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%s\", key);\n\t\tif (plist_get_node_type(subnode) == PLIST_ARRAY)\n\t\t\tfprintf(stream, \"[%d]: \", plist_array_get_size(subnode));\n\t\telse\n\t\t\tfprintf(stream, \": \");\n\t\tfree(key);\n\t\tkey = NULL;\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t\tplist_dict_next_item(node, it, &key, &subnode);\n\t}\n\tfree(it);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_get_node_type",
          "args": [
            "plist"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);\n\nvoid plist_print_to_stream(plist_t plist, FILE* stream)\n{\n\tint indent = 0;\n\n\tif (!plist || !stream)\n\t\treturn;\n\n\tswitch (plist_get_node_type(plist)) {\n\tcase PLIST_DICT:\n\t\tplist_dict_print_to_stream(plist, &indent, stream);\n\t\tbreak;\n\tcase PLIST_ARRAY:\n\t\tplist_array_print_to_stream(plist, &indent, stream);\n\t\tbreak;\n\tdefault:\n\t\tplist_node_print_to_stream(plist, &indent, stream);\n\t}\n}"
  },
  {
    "function_name": "plist_node_print_to_stream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "365-464",
    "snippet": "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\tchar *s = NULL;\n\tchar *data = NULL;\n\tdouble d;\n\tuint8_t b;\n\tuint64_t u = 0;\n\tstruct timeval tv = { 0, 0 };\n\n\tplist_type t;\n\n\tif (!node)\n\t\treturn;\n\n\tt = plist_get_node_type(node);\n\n\tswitch (t) {\n\tcase PLIST_BOOLEAN:\n\t\tplist_get_bool_val(node, &b);\n\t\tfprintf(stream, \"%s\\n\", (b ? \"true\" : \"false\"));\n\t\tbreak;\n\n\tcase PLIST_UINT:\n\t\tplist_get_uint_val(node, &u);\n\t\tfprintf(stream, \"%\"PRIu64\"\\n\", u);\n\t\tbreak;\n\n\tcase PLIST_REAL:\n\t\tplist_get_real_val(node, &d);\n\t\tfprintf(stream, \"%f\\n\", d);\n\t\tbreak;\n\n\tcase PLIST_STRING:\n\t\tplist_get_string_val(node, &s);\n\t\tfprintf(stream, \"%s\\n\", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_KEY:\n\t\tplist_get_key_val(node, &s);\n\t\tfprintf(stream, \"%s: \", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_DATA:\n\t\tplist_get_data_val(node, &data, &u);\n\t\tif (u > 0) {\n\t\t\ts = base64encode((unsigned char*)data, u);\n\t\t\tfree(data);\n\t\t\tif (s) {\n\t\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\t\tfree(s);\n\t\t\t} else {\n\t\t\t\tfprintf(stream, \"\\n\");\n\t\t\t}\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_DATE:\n\t\tplist_get_date_val(node, (int32_t*)&tv.tv_sec, (int32_t*)&tv.tv_usec);\n\t\t{\n\t\t\ttime_t ti = (time_t)tv.tv_sec;\n\t\t\tstruct tm *btime = localtime(&ti);\n\t\t\tif (btime) {\n\t\t\t\ts = (char*)malloc(24);\n \t\t\t\tmemset(s, 0, 24);\n\t\t\t\tif (strftime(s, 24, \"%Y-%m-%dT%H:%M:%SZ\", btime) <= 0) {\n\t\t\t\t\tfree (s);\n\t\t\t\t\ts = NULL;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (s) {\n\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\tfree(s);\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_ARRAY:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_array_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tcase PLIST_DICT:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_dict_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_dict_print_to_stream",
          "args": [
            "node",
            "indent_level",
            "stream"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "plist_dict_print_to_stream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "340-363",
          "snippet": "static void plist_dict_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over key/value pairs */\n\tplist_dict_iter it = NULL;\n\n\tchar* key = NULL;\n\tplist_t subnode = NULL;\n\tplist_dict_new_iter(node, &it);\n\tplist_dict_next_item(node, it, &key, &subnode);\n\twhile (subnode)\n\t{\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%s\", key);\n\t\tif (plist_get_node_type(subnode) == PLIST_ARRAY)\n\t\t\tfprintf(stream, \"[%d]: \", plist_array_get_size(subnode));\n\t\telse\n\t\t\tfprintf(stream, \": \");\n\t\tfree(key);\n\t\tkey = NULL;\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t\tplist_dict_next_item(node, it, &key, &subnode);\n\t}\n\tfree(it);\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);\n\nstatic void plist_dict_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over key/value pairs */\n\tplist_dict_iter it = NULL;\n\n\tchar* key = NULL;\n\tplist_t subnode = NULL;\n\tplist_dict_new_iter(node, &it);\n\tplist_dict_next_item(node, it, &key, &subnode);\n\twhile (subnode)\n\t{\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%s\", key);\n\t\tif (plist_get_node_type(subnode) == PLIST_ARRAY)\n\t\t\tfprintf(stream, \"[%d]: \", plist_array_get_size(subnode));\n\t\telse\n\t\t\tfprintf(stream, \": \");\n\t\tfree(key);\n\t\tkey = NULL;\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t\tplist_dict_next_item(node, it, &key, &subnode);\n\t}\n\tfree(it);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"\\n\""
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_print_to_stream",
          "args": [
            "node",
            "indent_level",
            "stream"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "plist_array_print_to_stream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "324-338",
          "snippet": "static void plist_array_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over items */\n\tint i, count;\n\tplist_t subnode = NULL;\n\n\tcount = plist_array_get_size(node);\n\n\tfor (i = 0; i < count; i++) {\n\t\tsubnode = plist_array_get_item(node, i);\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%d: \", i);\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t}\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);\n\nstatic void plist_array_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over items */\n\tint i, count;\n\tplist_t subnode = NULL;\n\n\tcount = plist_array_get_size(node);\n\n\tfor (i = 0; i < count; i++) {\n\t\tsubnode = plist_array_get_item(node, i);\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%d: \", i);\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"\\n\""
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"\\n\""
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "s"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "thread_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "39-44",
          "snippet": "void thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"%s\\n\"",
            "s"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strftime",
          "args": [
            "s",
            "24",
            "\"%Y-%m-%dT%H:%M:%SZ\"",
            "btime"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "s",
            "0",
            "24"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "24"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "localtime",
          "args": [
            "&ti"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_date_val",
          "args": [
            "node",
            "(int32_t*)&tv.tv_sec",
            "(int32_t*)&tv.tv_usec"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"\\n\""
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"\\n\""
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"%s\\n\"",
            "s"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "base64encode",
          "args": [
            "(unsigned char*)data",
            "u"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "base64encode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "295-320",
          "snippet": "static char *base64encode(const unsigned char *buf, size_t size)\n{\n\tif (!buf || !(size > 0)) return NULL;\n\tint outlen = (size / 3) * 4;\n\tchar *outbuf = (char*)malloc(outlen+5); // 4 spare bytes + 1 for '\\0'\n\tsize_t n = 0;\n\tsize_t m = 0;\n\tunsigned char input[3];\n\tunsigned int output[4];\n\twhile (n < size) {\n\t\tinput[0] = buf[n];\n\t\tinput[1] = (n+1 < size) ? buf[n+1] : 0;\n\t\tinput[2] = (n+2 < size) ? buf[n+2] : 0;\n\t\toutput[0] = input[0] >> 2;\n\t\toutput[1] = ((input[0] & 3) << 4) + (input[1] >> 4);\n\t\toutput[2] = ((input[1] & 15) << 2) + (input[2] >> 6);\n\t\toutput[3] = input[2] & 63;\n\t\toutbuf[m++] = base64_str[(int)output[0]];\n\t\toutbuf[m++] = base64_str[(int)output[1]];\n\t\toutbuf[m++] = (n+1 < size) ? base64_str[(int)output[2]] : base64_pad;\n\t\toutbuf[m++] = (n+2 < size) ? base64_str[(int)output[3]] : base64_pad;\n\t\tn+=3;\n\t}\n\toutbuf[m] = 0; // 0-termination!\n\treturn outbuf;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char base64_str[] = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";",
            "static const char base64_pad = '=';"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic const char base64_str[] = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\nstatic const char base64_pad = '=';\n\nstatic char *base64encode(const unsigned char *buf, size_t size)\n{\n\tif (!buf || !(size > 0)) return NULL;\n\tint outlen = (size / 3) * 4;\n\tchar *outbuf = (char*)malloc(outlen+5); // 4 spare bytes + 1 for '\\0'\n\tsize_t n = 0;\n\tsize_t m = 0;\n\tunsigned char input[3];\n\tunsigned int output[4];\n\twhile (n < size) {\n\t\tinput[0] = buf[n];\n\t\tinput[1] = (n+1 < size) ? buf[n+1] : 0;\n\t\tinput[2] = (n+2 < size) ? buf[n+2] : 0;\n\t\toutput[0] = input[0] >> 2;\n\t\toutput[1] = ((input[0] & 3) << 4) + (input[1] >> 4);\n\t\toutput[2] = ((input[1] & 15) << 2) + (input[2] >> 6);\n\t\toutput[3] = input[2] & 63;\n\t\toutbuf[m++] = base64_str[(int)output[0]];\n\t\toutbuf[m++] = base64_str[(int)output[1]];\n\t\toutbuf[m++] = (n+1 < size) ? base64_str[(int)output[2]] : base64_pad;\n\t\toutbuf[m++] = (n+2 < size) ? base64_str[(int)output[3]] : base64_pad;\n\t\tn+=3;\n\t}\n\toutbuf[m] = 0; // 0-termination!\n\treturn outbuf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_get_data_val",
          "args": [
            "node",
            "&data",
            "&u"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"%s: \"",
            "s"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_key_val",
          "args": [
            "node",
            "&s"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"%s\\n\"",
            "s"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "node",
            "&s"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"%f\\n\"",
            "d"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_real_val",
          "args": [
            "node",
            "&d"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"%\"PRIu64\"\\n\"",
            "u"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_uint_val",
          "args": [
            "node",
            "&u"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"%s\\n\"",
            "(b ? \"true\" : \"false\")"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_bool_val",
          "args": [
            "node",
            "&b"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_node_type",
          "args": [
            "node"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\tchar *s = NULL;\n\tchar *data = NULL;\n\tdouble d;\n\tuint8_t b;\n\tuint64_t u = 0;\n\tstruct timeval tv = { 0, 0 };\n\n\tplist_type t;\n\n\tif (!node)\n\t\treturn;\n\n\tt = plist_get_node_type(node);\n\n\tswitch (t) {\n\tcase PLIST_BOOLEAN:\n\t\tplist_get_bool_val(node, &b);\n\t\tfprintf(stream, \"%s\\n\", (b ? \"true\" : \"false\"));\n\t\tbreak;\n\n\tcase PLIST_UINT:\n\t\tplist_get_uint_val(node, &u);\n\t\tfprintf(stream, \"%\"PRIu64\"\\n\", u);\n\t\tbreak;\n\n\tcase PLIST_REAL:\n\t\tplist_get_real_val(node, &d);\n\t\tfprintf(stream, \"%f\\n\", d);\n\t\tbreak;\n\n\tcase PLIST_STRING:\n\t\tplist_get_string_val(node, &s);\n\t\tfprintf(stream, \"%s\\n\", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_KEY:\n\t\tplist_get_key_val(node, &s);\n\t\tfprintf(stream, \"%s: \", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_DATA:\n\t\tplist_get_data_val(node, &data, &u);\n\t\tif (u > 0) {\n\t\t\ts = base64encode((unsigned char*)data, u);\n\t\t\tfree(data);\n\t\t\tif (s) {\n\t\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\t\tfree(s);\n\t\t\t} else {\n\t\t\t\tfprintf(stream, \"\\n\");\n\t\t\t}\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_DATE:\n\t\tplist_get_date_val(node, (int32_t*)&tv.tv_sec, (int32_t*)&tv.tv_usec);\n\t\t{\n\t\t\ttime_t ti = (time_t)tv.tv_sec;\n\t\t\tstruct tm *btime = localtime(&ti);\n\t\t\tif (btime) {\n\t\t\t\ts = (char*)malloc(24);\n \t\t\t\tmemset(s, 0, 24);\n\t\t\t\tif (strftime(s, 24, \"%Y-%m-%dT%H:%M:%SZ\", btime) <= 0) {\n\t\t\t\t\tfree (s);\n\t\t\t\t\ts = NULL;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (s) {\n\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\tfree(s);\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_ARRAY:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_array_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tcase PLIST_DICT:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_dict_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "plist_dict_print_to_stream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "340-363",
    "snippet": "static void plist_dict_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over key/value pairs */\n\tplist_dict_iter it = NULL;\n\n\tchar* key = NULL;\n\tplist_t subnode = NULL;\n\tplist_dict_new_iter(node, &it);\n\tplist_dict_next_item(node, it, &key, &subnode);\n\twhile (subnode)\n\t{\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%s\", key);\n\t\tif (plist_get_node_type(subnode) == PLIST_ARRAY)\n\t\t\tfprintf(stream, \"[%d]: \", plist_array_get_size(subnode));\n\t\telse\n\t\t\tfprintf(stream, \": \");\n\t\tfree(key);\n\t\tkey = NULL;\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t\tplist_dict_next_item(node, it, &key, &subnode);\n\t}\n\tfree(it);\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "it"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "thread_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "39-44",
          "snippet": "void thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_next_item",
          "args": [
            "node",
            "it",
            "&key",
            "&subnode"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_node_print_to_stream",
          "args": [
            "subnode",
            "indent_level",
            "stream"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "plist_node_print_to_stream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "365-464",
          "snippet": "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\tchar *s = NULL;\n\tchar *data = NULL;\n\tdouble d;\n\tuint8_t b;\n\tuint64_t u = 0;\n\tstruct timeval tv = { 0, 0 };\n\n\tplist_type t;\n\n\tif (!node)\n\t\treturn;\n\n\tt = plist_get_node_type(node);\n\n\tswitch (t) {\n\tcase PLIST_BOOLEAN:\n\t\tplist_get_bool_val(node, &b);\n\t\tfprintf(stream, \"%s\\n\", (b ? \"true\" : \"false\"));\n\t\tbreak;\n\n\tcase PLIST_UINT:\n\t\tplist_get_uint_val(node, &u);\n\t\tfprintf(stream, \"%\"PRIu64\"\\n\", u);\n\t\tbreak;\n\n\tcase PLIST_REAL:\n\t\tplist_get_real_val(node, &d);\n\t\tfprintf(stream, \"%f\\n\", d);\n\t\tbreak;\n\n\tcase PLIST_STRING:\n\t\tplist_get_string_val(node, &s);\n\t\tfprintf(stream, \"%s\\n\", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_KEY:\n\t\tplist_get_key_val(node, &s);\n\t\tfprintf(stream, \"%s: \", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_DATA:\n\t\tplist_get_data_val(node, &data, &u);\n\t\tif (u > 0) {\n\t\t\ts = base64encode((unsigned char*)data, u);\n\t\t\tfree(data);\n\t\t\tif (s) {\n\t\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\t\tfree(s);\n\t\t\t} else {\n\t\t\t\tfprintf(stream, \"\\n\");\n\t\t\t}\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_DATE:\n\t\tplist_get_date_val(node, (int32_t*)&tv.tv_sec, (int32_t*)&tv.tv_usec);\n\t\t{\n\t\t\ttime_t ti = (time_t)tv.tv_sec;\n\t\t\tstruct tm *btime = localtime(&ti);\n\t\t\tif (btime) {\n\t\t\t\ts = (char*)malloc(24);\n \t\t\t\tmemset(s, 0, 24);\n\t\t\t\tif (strftime(s, 24, \"%Y-%m-%dT%H:%M:%SZ\", btime) <= 0) {\n\t\t\t\t\tfree (s);\n\t\t\t\t\ts = NULL;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (s) {\n\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\tfree(s);\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_ARRAY:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_array_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tcase PLIST_DICT:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_dict_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\tchar *s = NULL;\n\tchar *data = NULL;\n\tdouble d;\n\tuint8_t b;\n\tuint64_t u = 0;\n\tstruct timeval tv = { 0, 0 };\n\n\tplist_type t;\n\n\tif (!node)\n\t\treturn;\n\n\tt = plist_get_node_type(node);\n\n\tswitch (t) {\n\tcase PLIST_BOOLEAN:\n\t\tplist_get_bool_val(node, &b);\n\t\tfprintf(stream, \"%s\\n\", (b ? \"true\" : \"false\"));\n\t\tbreak;\n\n\tcase PLIST_UINT:\n\t\tplist_get_uint_val(node, &u);\n\t\tfprintf(stream, \"%\"PRIu64\"\\n\", u);\n\t\tbreak;\n\n\tcase PLIST_REAL:\n\t\tplist_get_real_val(node, &d);\n\t\tfprintf(stream, \"%f\\n\", d);\n\t\tbreak;\n\n\tcase PLIST_STRING:\n\t\tplist_get_string_val(node, &s);\n\t\tfprintf(stream, \"%s\\n\", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_KEY:\n\t\tplist_get_key_val(node, &s);\n\t\tfprintf(stream, \"%s: \", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_DATA:\n\t\tplist_get_data_val(node, &data, &u);\n\t\tif (u > 0) {\n\t\t\ts = base64encode((unsigned char*)data, u);\n\t\t\tfree(data);\n\t\t\tif (s) {\n\t\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\t\tfree(s);\n\t\t\t} else {\n\t\t\t\tfprintf(stream, \"\\n\");\n\t\t\t}\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_DATE:\n\t\tplist_get_date_val(node, (int32_t*)&tv.tv_sec, (int32_t*)&tv.tv_usec);\n\t\t{\n\t\t\ttime_t ti = (time_t)tv.tv_sec;\n\t\t\tstruct tm *btime = localtime(&ti);\n\t\t\tif (btime) {\n\t\t\t\ts = (char*)malloc(24);\n \t\t\t\tmemset(s, 0, 24);\n\t\t\t\tif (strftime(s, 24, \"%Y-%m-%dT%H:%M:%SZ\", btime) <= 0) {\n\t\t\t\t\tfree (s);\n\t\t\t\t\ts = NULL;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (s) {\n\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\tfree(s);\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_ARRAY:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_array_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tcase PLIST_DICT:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_dict_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\": \""
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"[%d]: \"",
            "plist_array_get_size(subnode)"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_size",
          "args": [
            "subnode"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_node_type",
          "args": [
            "subnode"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"%s\"",
            "key"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"%*s\"",
            "*indent_level",
            "\"\""
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_next_item",
          "args": [
            "node",
            "it",
            "&key",
            "&subnode"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_new_iter",
          "args": [
            "node",
            "&it"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);\n\nstatic void plist_dict_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over key/value pairs */\n\tplist_dict_iter it = NULL;\n\n\tchar* key = NULL;\n\tplist_t subnode = NULL;\n\tplist_dict_new_iter(node, &it);\n\tplist_dict_next_item(node, it, &key, &subnode);\n\twhile (subnode)\n\t{\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%s\", key);\n\t\tif (plist_get_node_type(subnode) == PLIST_ARRAY)\n\t\t\tfprintf(stream, \"[%d]: \", plist_array_get_size(subnode));\n\t\telse\n\t\t\tfprintf(stream, \": \");\n\t\tfree(key);\n\t\tkey = NULL;\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t\tplist_dict_next_item(node, it, &key, &subnode);\n\t}\n\tfree(it);\n}"
  },
  {
    "function_name": "plist_array_print_to_stream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "324-338",
    "snippet": "static void plist_array_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over items */\n\tint i, count;\n\tplist_t subnode = NULL;\n\n\tcount = plist_array_get_size(node);\n\n\tfor (i = 0; i < count; i++) {\n\t\tsubnode = plist_array_get_item(node, i);\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%d: \", i);\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t}\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_node_print_to_stream",
          "args": [
            "subnode",
            "indent_level",
            "stream"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "plist_node_print_to_stream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "365-464",
          "snippet": "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\tchar *s = NULL;\n\tchar *data = NULL;\n\tdouble d;\n\tuint8_t b;\n\tuint64_t u = 0;\n\tstruct timeval tv = { 0, 0 };\n\n\tplist_type t;\n\n\tif (!node)\n\t\treturn;\n\n\tt = plist_get_node_type(node);\n\n\tswitch (t) {\n\tcase PLIST_BOOLEAN:\n\t\tplist_get_bool_val(node, &b);\n\t\tfprintf(stream, \"%s\\n\", (b ? \"true\" : \"false\"));\n\t\tbreak;\n\n\tcase PLIST_UINT:\n\t\tplist_get_uint_val(node, &u);\n\t\tfprintf(stream, \"%\"PRIu64\"\\n\", u);\n\t\tbreak;\n\n\tcase PLIST_REAL:\n\t\tplist_get_real_val(node, &d);\n\t\tfprintf(stream, \"%f\\n\", d);\n\t\tbreak;\n\n\tcase PLIST_STRING:\n\t\tplist_get_string_val(node, &s);\n\t\tfprintf(stream, \"%s\\n\", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_KEY:\n\t\tplist_get_key_val(node, &s);\n\t\tfprintf(stream, \"%s: \", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_DATA:\n\t\tplist_get_data_val(node, &data, &u);\n\t\tif (u > 0) {\n\t\t\ts = base64encode((unsigned char*)data, u);\n\t\t\tfree(data);\n\t\t\tif (s) {\n\t\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\t\tfree(s);\n\t\t\t} else {\n\t\t\t\tfprintf(stream, \"\\n\");\n\t\t\t}\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_DATE:\n\t\tplist_get_date_val(node, (int32_t*)&tv.tv_sec, (int32_t*)&tv.tv_usec);\n\t\t{\n\t\t\ttime_t ti = (time_t)tv.tv_sec;\n\t\t\tstruct tm *btime = localtime(&ti);\n\t\t\tif (btime) {\n\t\t\t\ts = (char*)malloc(24);\n \t\t\t\tmemset(s, 0, 24);\n\t\t\t\tif (strftime(s, 24, \"%Y-%m-%dT%H:%M:%SZ\", btime) <= 0) {\n\t\t\t\t\tfree (s);\n\t\t\t\t\ts = NULL;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (s) {\n\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\tfree(s);\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_ARRAY:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_array_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tcase PLIST_DICT:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_dict_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\tchar *s = NULL;\n\tchar *data = NULL;\n\tdouble d;\n\tuint8_t b;\n\tuint64_t u = 0;\n\tstruct timeval tv = { 0, 0 };\n\n\tplist_type t;\n\n\tif (!node)\n\t\treturn;\n\n\tt = plist_get_node_type(node);\n\n\tswitch (t) {\n\tcase PLIST_BOOLEAN:\n\t\tplist_get_bool_val(node, &b);\n\t\tfprintf(stream, \"%s\\n\", (b ? \"true\" : \"false\"));\n\t\tbreak;\n\n\tcase PLIST_UINT:\n\t\tplist_get_uint_val(node, &u);\n\t\tfprintf(stream, \"%\"PRIu64\"\\n\", u);\n\t\tbreak;\n\n\tcase PLIST_REAL:\n\t\tplist_get_real_val(node, &d);\n\t\tfprintf(stream, \"%f\\n\", d);\n\t\tbreak;\n\n\tcase PLIST_STRING:\n\t\tplist_get_string_val(node, &s);\n\t\tfprintf(stream, \"%s\\n\", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_KEY:\n\t\tplist_get_key_val(node, &s);\n\t\tfprintf(stream, \"%s: \", s);\n\t\tfree(s);\n\t\tbreak;\n\n\tcase PLIST_DATA:\n\t\tplist_get_data_val(node, &data, &u);\n\t\tif (u > 0) {\n\t\t\ts = base64encode((unsigned char*)data, u);\n\t\t\tfree(data);\n\t\t\tif (s) {\n\t\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\t\tfree(s);\n\t\t\t} else {\n\t\t\t\tfprintf(stream, \"\\n\");\n\t\t\t}\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_DATE:\n\t\tplist_get_date_val(node, (int32_t*)&tv.tv_sec, (int32_t*)&tv.tv_usec);\n\t\t{\n\t\t\ttime_t ti = (time_t)tv.tv_sec;\n\t\t\tstruct tm *btime = localtime(&ti);\n\t\t\tif (btime) {\n\t\t\t\ts = (char*)malloc(24);\n \t\t\t\tmemset(s, 0, 24);\n\t\t\t\tif (strftime(s, 24, \"%Y-%m-%dT%H:%M:%SZ\", btime) <= 0) {\n\t\t\t\t\tfree (s);\n\t\t\t\t\ts = NULL;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (s) {\n\t\t\tfprintf(stream, \"%s\\n\", s);\n\t\t\tfree(s);\n\t\t} else {\n\t\t\tfprintf(stream, \"\\n\");\n\t\t}\n\t\tbreak;\n\n\tcase PLIST_ARRAY:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_array_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tcase PLIST_DICT:\n\t\tfprintf(stream, \"\\n\");\n\t\t(*indent_level)++;\n\t\tplist_dict_print_to_stream(node, indent_level, stream);\n\t\t(*indent_level)--;\n\t\tbreak;\n\n\tdefault:\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"%d: \"",
            "i"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stream",
            "\"%*s\"",
            "*indent_level",
            "\"\""
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "node",
            "i"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_size",
          "args": [
            "node"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void plist_node_print_to_stream(plist_t node, int* indent_level, FILE* stream);\n\nstatic void plist_array_print_to_stream(plist_t node, int* indent_level, FILE* stream)\n{\n\t/* iterate over items */\n\tint i, count;\n\tplist_t subnode = NULL;\n\n\tcount = plist_array_get_size(node);\n\n\tfor (i = 0; i < count; i++) {\n\t\tsubnode = plist_array_get_item(node, i);\n\t\tfprintf(stream, \"%*s\", *indent_level, \"\");\n\t\tfprintf(stream, \"%d: \", i);\n\t\tplist_node_print_to_stream(subnode, indent_level, stream);\n\t}\n}"
  },
  {
    "function_name": "base64encode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "295-320",
    "snippet": "static char *base64encode(const unsigned char *buf, size_t size)\n{\n\tif (!buf || !(size > 0)) return NULL;\n\tint outlen = (size / 3) * 4;\n\tchar *outbuf = (char*)malloc(outlen+5); // 4 spare bytes + 1 for '\\0'\n\tsize_t n = 0;\n\tsize_t m = 0;\n\tunsigned char input[3];\n\tunsigned int output[4];\n\twhile (n < size) {\n\t\tinput[0] = buf[n];\n\t\tinput[1] = (n+1 < size) ? buf[n+1] : 0;\n\t\tinput[2] = (n+2 < size) ? buf[n+2] : 0;\n\t\toutput[0] = input[0] >> 2;\n\t\toutput[1] = ((input[0] & 3) << 4) + (input[1] >> 4);\n\t\toutput[2] = ((input[1] & 15) << 2) + (input[2] >> 6);\n\t\toutput[3] = input[2] & 63;\n\t\toutbuf[m++] = base64_str[(int)output[0]];\n\t\toutbuf[m++] = base64_str[(int)output[1]];\n\t\toutbuf[m++] = (n+1 < size) ? base64_str[(int)output[2]] : base64_pad;\n\t\toutbuf[m++] = (n+2 < size) ? base64_str[(int)output[3]] : base64_pad;\n\t\tn+=3;\n\t}\n\toutbuf[m] = 0; // 0-termination!\n\treturn outbuf;\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char base64_str[] = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";",
      "static const char base64_pad = '=';"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "outlen+5"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic const char base64_str[] = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\nstatic const char base64_pad = '=';\n\nstatic char *base64encode(const unsigned char *buf, size_t size)\n{\n\tif (!buf || !(size > 0)) return NULL;\n\tint outlen = (size / 3) * 4;\n\tchar *outbuf = (char*)malloc(outlen+5); // 4 spare bytes + 1 for '\\0'\n\tsize_t n = 0;\n\tsize_t m = 0;\n\tunsigned char input[3];\n\tunsigned int output[4];\n\twhile (n < size) {\n\t\tinput[0] = buf[n];\n\t\tinput[1] = (n+1 < size) ? buf[n+1] : 0;\n\t\tinput[2] = (n+2 < size) ? buf[n+2] : 0;\n\t\toutput[0] = input[0] >> 2;\n\t\toutput[1] = ((input[0] & 3) << 4) + (input[1] >> 4);\n\t\toutput[2] = ((input[1] & 15) << 2) + (input[2] >> 6);\n\t\toutput[3] = input[2] & 63;\n\t\toutbuf[m++] = base64_str[(int)output[0]];\n\t\toutbuf[m++] = base64_str[(int)output[1]];\n\t\toutbuf[m++] = (n+1 < size) ? base64_str[(int)output[2]] : base64_pad;\n\t\toutbuf[m++] = (n+2 < size) ? base64_str[(int)output[3]] : base64_pad;\n\t\tn+=3;\n\t}\n\toutbuf[m] = 0; // 0-termination!\n\treturn outbuf;\n}"
  },
  {
    "function_name": "plist_write_to_filename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "270-290",
    "snippet": "int plist_write_to_filename(plist_t plist, const char *filename, enum plist_format_t format)\n{\n\tchar *buffer = NULL;\n\tuint32_t length;\n\n\tif (!plist || !filename)\n\t\treturn 0;\n\n\tif (format == PLIST_FORMAT_XML)\n\t\tplist_to_xml(plist, &buffer, &length);\n\telse if (format == PLIST_FORMAT_BINARY)\n\t\tplist_to_bin(plist, &buffer, &length);\n\telse\n\t\treturn 0;\n\n\tbuffer_write_to_filename(filename, buffer, length);\n\n\tfree(buffer);\n\n\treturn 1;\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "buffer"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "thread_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "39-44",
          "snippet": "void thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_write_to_filename",
          "args": [
            "filename",
            "buffer",
            "length"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "buffer_write_to_filename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "234-243",
          "snippet": "void buffer_write_to_filename(const char *filename, const char *buffer, uint64_t length)\n{\n\tFILE *f;\n\n\tf = fopen(filename, \"wb\");\n\tif (f) {\n\t\tfwrite(buffer, sizeof(char), length, f);\n\t\tfclose(f);\n\t}\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid buffer_write_to_filename(const char *filename, const char *buffer, uint64_t length)\n{\n\tFILE *f;\n\n\tf = fopen(filename, \"wb\");\n\tif (f) {\n\t\tfwrite(buffer, sizeof(char), length, f);\n\t\tfclose(f);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_to_bin",
          "args": [
            "plist",
            "&buffer",
            "&length"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_to_xml",
          "args": [
            "plist",
            "&buffer",
            "&length"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nint plist_write_to_filename(plist_t plist, const char *filename, enum plist_format_t format)\n{\n\tchar *buffer = NULL;\n\tuint32_t length;\n\n\tif (!plist || !filename)\n\t\treturn 0;\n\n\tif (format == PLIST_FORMAT_XML)\n\t\tplist_to_xml(plist, &buffer, &length);\n\telse if (format == PLIST_FORMAT_BINARY)\n\t\tplist_to_bin(plist, &buffer, &length);\n\telse\n\t\treturn 0;\n\n\tbuffer_write_to_filename(filename, buffer, length);\n\n\tfree(buffer);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "plist_read_from_filename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "245-268",
    "snippet": "int plist_read_from_filename(plist_t *plist, const char *filename)\n{\n\tchar *buffer = NULL;\n\tuint64_t length;\n\n\tif (!filename)\n\t\treturn 0;\n\n\tbuffer_read_from_filename(filename, &buffer, &length);\n\n\tif (!buffer) {\n\t\treturn 0;\n\t}\n\n\tif ((length > 8) && (memcmp(buffer, \"bplist00\", 8) == 0)) {\n\t\tplist_from_bin(buffer, length, plist);\n\t} else {\n\t\tplist_from_xml(buffer, length, plist);\n\t}\n\n\tfree(buffer);\n\n\treturn 1;\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "buffer"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "thread_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "39-44",
          "snippet": "void thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_from_xml",
          "args": [
            "buffer",
            "length",
            "plist"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_from_bin",
          "args": [
            "buffer",
            "length",
            "plist"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "buffer",
            "\"bplist00\"",
            "8"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_read_from_filename",
          "args": [
            "filename",
            "&buffer",
            "&length"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "buffer_read_from_filename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "203-232",
          "snippet": "void buffer_read_from_filename(const char *filename, char **buffer, uint64_t *length)\n{\n\tFILE *f;\n\tuint64_t size;\n\n\t*length = 0;\n\n\tf = fopen(filename, \"rb\");\n\tif (!f) {\n\t\treturn;\n\t}\n\n\tfseek(f, 0, SEEK_END);\n\tsize = ftell(f);\n\trewind(f);\n\n\tif (size == 0) {\n\t\tfclose(f);\n\t\treturn;\n\t}\n\n\t*buffer = (char*)malloc(sizeof(char)*(size+1));\n\tif (fread(*buffer, sizeof(char), size, f) != size) {\n\t\tfclose(f);\n\t\treturn;\n\t}\n\tfclose(f);\n\n\t*length = size;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid buffer_read_from_filename(const char *filename, char **buffer, uint64_t *length)\n{\n\tFILE *f;\n\tuint64_t size;\n\n\t*length = 0;\n\n\tf = fopen(filename, \"rb\");\n\tif (!f) {\n\t\treturn;\n\t}\n\n\tfseek(f, 0, SEEK_END);\n\tsize = ftell(f);\n\trewind(f);\n\n\tif (size == 0) {\n\t\tfclose(f);\n\t\treturn;\n\t}\n\n\t*buffer = (char*)malloc(sizeof(char)*(size+1));\n\tif (fread(*buffer, sizeof(char), size, f) != size) {\n\t\tfclose(f);\n\t\treturn;\n\t}\n\tfclose(f);\n\n\t*length = size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nint plist_read_from_filename(plist_t *plist, const char *filename)\n{\n\tchar *buffer = NULL;\n\tuint64_t length;\n\n\tif (!filename)\n\t\treturn 0;\n\n\tbuffer_read_from_filename(filename, &buffer, &length);\n\n\tif (!buffer) {\n\t\treturn 0;\n\t}\n\n\tif ((length > 8) && (memcmp(buffer, \"bplist00\", 8) == 0)) {\n\t\tplist_from_bin(buffer, length, plist);\n\t} else {\n\t\tplist_from_xml(buffer, length, plist);\n\t}\n\n\tfree(buffer);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "buffer_write_to_filename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "234-243",
    "snippet": "void buffer_write_to_filename(const char *filename, const char *buffer, uint64_t length)\n{\n\tFILE *f;\n\n\tf = fopen(filename, \"wb\");\n\tif (f) {\n\t\tfwrite(buffer, sizeof(char), length, f);\n\t\tfclose(f);\n\t}\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "f"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fwrite",
          "args": [
            "buffer",
            "sizeof(char)",
            "length",
            "f"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "filename",
            "\"wb\""
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid buffer_write_to_filename(const char *filename, const char *buffer, uint64_t length)\n{\n\tFILE *f;\n\n\tf = fopen(filename, \"wb\");\n\tif (f) {\n\t\tfwrite(buffer, sizeof(char), length, f);\n\t\tfclose(f);\n\t}\n}"
  },
  {
    "function_name": "buffer_read_from_filename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "203-232",
    "snippet": "void buffer_read_from_filename(const char *filename, char **buffer, uint64_t *length)\n{\n\tFILE *f;\n\tuint64_t size;\n\n\t*length = 0;\n\n\tf = fopen(filename, \"rb\");\n\tif (!f) {\n\t\treturn;\n\t}\n\n\tfseek(f, 0, SEEK_END);\n\tsize = ftell(f);\n\trewind(f);\n\n\tif (size == 0) {\n\t\tfclose(f);\n\t\treturn;\n\t}\n\n\t*buffer = (char*)malloc(sizeof(char)*(size+1));\n\tif (fread(*buffer, sizeof(char), size, f) != size) {\n\t\tfclose(f);\n\t\treturn;\n\t}\n\tfclose(f);\n\n\t*length = size;\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "f"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "f"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fread",
          "args": [
            "*buffer",
            "sizeof(char)",
            "size",
            "f"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(char)*(size+1)"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "f"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rewind",
          "args": [
            "f"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ftell",
          "args": [
            "f"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fseek",
          "args": [
            "f",
            "0",
            "SEEK_END"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "filename",
            "\"rb\""
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid buffer_read_from_filename(const char *filename, char **buffer, uint64_t *length)\n{\n\tFILE *f;\n\tuint64_t size;\n\n\t*length = 0;\n\n\tf = fopen(filename, \"rb\");\n\tif (!f) {\n\t\treturn;\n\t}\n\n\tfseek(f, 0, SEEK_END);\n\tsize = ftell(f);\n\trewind(f);\n\n\tif (size == 0) {\n\t\tfclose(f);\n\t\treturn;\n\t}\n\n\t*buffer = (char*)malloc(sizeof(char)*(size+1));\n\tif (fread(*buffer, sizeof(char), size, f) != size) {\n\t\tfclose(f);\n\t\treturn;\n\t}\n\tfclose(f);\n\n\t*length = size;\n}"
  },
  {
    "function_name": "generate_uuid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "180-201",
    "snippet": "char *generate_uuid()\n{\n\tconst char *chars = \"ABCDEF0123456789\";\n\tint i = 0;\n\tchar *uuid = (char *) malloc(sizeof(char) * 37);\n\n\tsrand(time(NULL));\n\n\tfor (i = 0; i < 36; i++) {\n\t\tif (i == 8 || i == 13 || i == 18 || i == 23) {\n\t\t\tuuid[i] = '-';\n\t\t\tcontinue;\n\t\t} else {\n\t\t\tuuid[i] = chars[get_rand(0, 16)];\n\t\t}\n\t}\n\n\t/* make it a real string */\n\tuuid[36] = '\\0';\n\n\treturn uuid;\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_rand",
          "args": [
            "0",
            "16"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "get_rand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "174-178",
          "snippet": "static int get_rand(int min, int max)\n{\n\tint retval = (rand() % (max - min)) + min;\n\treturn retval;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int get_rand(int min, int max)\n{\n\tint retval = (rand() % (max - min)) + min;\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "srand",
          "args": [
            "time(NULL)"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "NULL"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(char) * 37"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nchar *generate_uuid()\n{\n\tconst char *chars = \"ABCDEF0123456789\";\n\tint i = 0;\n\tchar *uuid = (char *) malloc(sizeof(char) * 37);\n\n\tsrand(time(NULL));\n\n\tfor (i = 0; i < 36; i++) {\n\t\tif (i == 8 || i == 13 || i == 18 || i == 23) {\n\t\t\tuuid[i] = '-';\n\t\t\tcontinue;\n\t\t} else {\n\t\t\tuuid[i] = chars[get_rand(0, 16)];\n\t\t}\n\t}\n\n\t/* make it a real string */\n\tuuid[36] = '\\0';\n\n\treturn uuid;\n}"
  },
  {
    "function_name": "get_rand",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "174-178",
    "snippet": "static int get_rand(int min, int max)\n{\n\tint retval = (rand() % (max - min)) + min;\n\treturn retval;\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int get_rand(int min, int max)\n{\n\tint retval = (rand() % (max - min)) + min;\n\treturn retval;\n}"
  },
  {
    "function_name": "string_toupper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "164-172",
    "snippet": "char *string_toupper(char* str)\n{\n\tchar *res = strdup(str);\n\tunsigned int i;\n\tfor (i = 0; i < strlen(res); i++) {\n\t\tres[i] = toupper(res[i]);\n\t}\n\treturn res;\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "toupper",
          "args": [
            "res[i]"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "string_toupper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "164-172",
          "snippet": "char *string_toupper(char* str)\n{\n\tchar *res = strdup(str);\n\tunsigned int i;\n\tfor (i = 0; i < strlen(res); i++) {\n\t\tres[i] = toupper(res[i]);\n\t}\n\treturn res;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "res"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "str"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nchar *string_toupper(char* str)\n{\n\tchar *res = strdup(str);\n\tunsigned int i;\n\tfor (i = 0; i < strlen(res); i++) {\n\t\tres[i] = toupper(res[i]);\n\t}\n\treturn res;\n}"
  },
  {
    "function_name": "string_format_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "142-162",
    "snippet": "char *string_format_size(uint64_t size)\n{\n\tchar buf[80];\n\tdouble sz;\n\tif (size >= 1000000000000LL) {\n\t\tsz = ((double)size / 1000000000000.0f);\n\t\tsprintf(buf, \"%0.1f TB\", sz);\n\t} else if (size >= 1000000000LL) {\n\t\tsz = ((double)size / 1000000000.0f);\n\t\tsprintf(buf, \"%0.1f GB\", sz);\n\t} else if (size >= 1000000LL) {\n\t\tsz = ((double)size / 1000000.0f);\n\t\tsprintf(buf, \"%0.1f MB\", sz);\n\t} else if (size >= 1000LL) {\n\t\tsz = ((double)size / 1000.0f);\n\t\tsprintf(buf, \"%0.1f KB\", sz);\n\t} else {\n\t\tsprintf(buf, \"%d Bytes\", (int)size);\n\t}\n\treturn strdup(buf);\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "buf"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d Bytes\"",
            "(int)size"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "asprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/include/asprintf.h",
          "lines": "23-31",
          "snippet": "static inline int asprintf(char **PTR, const char *TEMPLATE, ...)\n{\n\tint res;\n\tva_list AP;\n\tva_start(AP, TEMPLATE);\n\tres = vasprintf(PTR, TEMPLATE, AP);\n\tva_end(AP);\n\treturn res;\n}",
          "includes": [
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <config.h>\n\nstatic inline int asprintf(char **PTR, const char *TEMPLATE, ...)\n{\n\tint res;\n\tva_list AP;\n\tva_start(AP, TEMPLATE);\n\tres = vasprintf(PTR, TEMPLATE, AP);\n\tva_end(AP);\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nchar *string_format_size(uint64_t size)\n{\n\tchar buf[80];\n\tdouble sz;\n\tif (size >= 1000000000000LL) {\n\t\tsz = ((double)size / 1000000000000.0f);\n\t\tsprintf(buf, \"%0.1f TB\", sz);\n\t} else if (size >= 1000000000LL) {\n\t\tsz = ((double)size / 1000000000.0f);\n\t\tsprintf(buf, \"%0.1f GB\", sz);\n\t} else if (size >= 1000000LL) {\n\t\tsz = ((double)size / 1000000.0f);\n\t\tsprintf(buf, \"%0.1f MB\", sz);\n\t} else if (size >= 1000LL) {\n\t\tsz = ((double)size / 1000.0f);\n\t\tsprintf(buf, \"%0.1f KB\", sz);\n\t} else {\n\t\tsprintf(buf, \"%d Bytes\", (int)size);\n\t}\n\treturn strdup(buf);\n}"
  },
  {
    "function_name": "string_build_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "114-140",
    "snippet": "char *string_build_path(const char *elem, ...)\n{\n\tif (!elem)\n\t\treturn NULL;\n\tva_list args;\n\tint len = strlen(elem)+1;\n\tva_start(args, elem);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tlen += strlen(arg)+1;\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n\n\tchar* out = (char*)malloc(len);\n\tstrcpy(out, elem);\n\n\tva_start(args, elem);\n\targ = va_arg(args, char*);\n\twhile (arg) {\n\t\tstrcat(out, \"/\");\n\t\tstrcat(out, arg);\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n\treturn out;\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "out",
            "arg"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "out",
            "\"/\""
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "elem"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "out",
            "elem"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "len"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "arg"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "elem"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "elem"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nchar *string_build_path(const char *elem, ...)\n{\n\tif (!elem)\n\t\treturn NULL;\n\tva_list args;\n\tint len = strlen(elem)+1;\n\tva_start(args, elem);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tlen += strlen(arg)+1;\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n\n\tchar* out = (char*)malloc(len);\n\tstrcpy(out, elem);\n\n\tva_start(args, elem);\n\targ = va_arg(args, char*);\n\twhile (arg) {\n\t\tstrcat(out, \"/\");\n\t\tstrcat(out, arg);\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n\treturn out;\n}"
  },
  {
    "function_name": "string_concat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "70-112",
    "snippet": "char *string_concat(const char *str, ...)\n{\n\tsize_t len;\n\tva_list args;\n\tchar *s;\n\tchar *result;\n\tchar *dest;\n\n\tif (!str)\n\t\treturn NULL;\n\n\t/* Compute final length */\n\n\tlen = strlen(str) + 1; /* plus 1 for the null terminator */\n\n\tva_start(args, str);\n\ts = va_arg(args, char *);\n\twhile (s) {\n\t\tlen += strlen(s);\n\t\ts = va_arg(args, char*);\n\t}\n\tva_end(args);\n\n\t/* Concat each string */\n\n\tresult = malloc(len);\n\tif (!result)\n\t\treturn NULL; /* errno remains set */\n\n\tdest = result;\n\n\tdest = stpcpy(dest, str);\n\n\tva_start(args, str);\n\ts = va_arg(args, char *);\n\twhile (s) {\n\t\tdest = stpcpy(dest, s);\n\t\ts = va_arg(args, char *);\n\t}\n\tva_end(args);\n\n\treturn result;\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stpcpy",
          "args": [
            "dest",
            "s"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "stpcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
          "lines": "48-56",
          "snippet": "char *stpcpy(char *s1, const char *s2)\n{\n\tif (s1 == NULL || s2 == NULL)\n\t\treturn NULL;\n\n\tstrcpy(s1, s2);\n\n\treturn s1 + strlen(s2);\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include <ctype.h>",
            "#include <inttypes.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nchar *stpcpy(char *s1, const char *s2)\n{\n\tif (s1 == NULL || s2 == NULL)\n\t\treturn NULL;\n\n\tstrcpy(s1, s2);\n\n\treturn s1 + strlen(s2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "str"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "len"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "s"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "str"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nchar *string_concat(const char *str, ...)\n{\n\tsize_t len;\n\tva_list args;\n\tchar *s;\n\tchar *result;\n\tchar *dest;\n\n\tif (!str)\n\t\treturn NULL;\n\n\t/* Compute final length */\n\n\tlen = strlen(str) + 1; /* plus 1 for the null terminator */\n\n\tva_start(args, str);\n\ts = va_arg(args, char *);\n\twhile (s) {\n\t\tlen += strlen(s);\n\t\ts = va_arg(args, char*);\n\t}\n\tva_end(args);\n\n\t/* Concat each string */\n\n\tresult = malloc(len);\n\tif (!result)\n\t\treturn NULL; /* errno remains set */\n\n\tdest = result;\n\n\tdest = stpcpy(dest, str);\n\n\tva_start(args, str);\n\ts = va_arg(args, char *);\n\twhile (s) {\n\t\tdest = stpcpy(dest, s);\n\t\ts = va_arg(args, char *);\n\t}\n\tva_end(args);\n\n\treturn result;\n}"
  },
  {
    "function_name": "stpcpy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/utils.c",
    "lines": "48-56",
    "snippet": "char *stpcpy(char *s1, const char *s2)\n{\n\tif (s1 == NULL || s2 == NULL)\n\t\treturn NULL;\n\n\tstrcpy(s1, s2);\n\n\treturn s1 + strlen(s2);\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include <ctype.h>",
      "#include <inttypes.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "s2"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "s1",
            "s2"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include <ctype.h>\n#include <inttypes.h>\n#include <sys/time.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <config.h>\n\nchar *stpcpy(char *s1, const char *s2)\n{\n\tif (s1 == NULL || s2 == NULL)\n\t\treturn NULL;\n\n\tstrcpy(s1, s2);\n\n\treturn s1 + strlen(s2);\n}"
  }
]