[
  {
    "function_name": "diagnostics_relay_query_ioregistry_plane",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "413-453",
    "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_query_ioregistry_plane(diagnostics_relay_client_t client, const char* plane, plist_t* result)\n{\n\tif (!client || plane == NULL || result == NULL)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"CurrentPlane\", plist_new_string(plane));\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(\"IORegistry\"));\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (ret != DIAGNOSTICS_RELAY_E_SUCCESS) {\n\t\tplist_free(dict);\n\t\treturn ret;\n\t}\n\n\tplist_t value_node = plist_dict_get_item(dict, \"Diagnostics\");\n\tif (value_node) {\n\t\t*result = plist_copy(value_node);\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [
      "#define RESULT_UNKNOWN_REQUEST 2",
      "#define RESULT_SUCCESS 0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_copy",
          "args": [
            "value_node"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_get_item",
          "args": [
            "dict",
            "\"Diagnostics\""
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_check_result",
          "args": [
            "dict"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_check_result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "41-70",
          "snippet": "static int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [
            "#define RESULT_UNKNOWN_REQUEST 2",
            "#define RESULT_FAILURE 1",
            "#define RESULT_SUCCESS 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_FAILURE 1\n#define RESULT_SUCCESS 0\n\nstatic int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_receive",
          "args": [
            "client",
            "&dict"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "119-136",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_send",
          "args": [
            "client",
            "dict"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "150-163",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"Request\"",
            "plist_new_string(\"IORegistry\")"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"IORegistry\""
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"CurrentPlane\"",
            "plist_new_string(plane)"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "plane"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_SUCCESS 0\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_query_ioregistry_plane(diagnostics_relay_client_t client, const char* plane, plist_t* result)\n{\n\tif (!client || plane == NULL || result == NULL)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"CurrentPlane\", plist_new_string(plane));\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(\"IORegistry\"));\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (ret != DIAGNOSTICS_RELAY_E_SUCCESS) {\n\t\tplist_free(dict);\n\t\treturn ret;\n\t}\n\n\tplist_t value_node = plist_dict_get_item(dict, \"Diagnostics\");\n\tif (value_node) {\n\t\t*result = plist_copy(value_node);\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}"
  },
  {
    "function_name": "diagnostics_relay_query_ioregistry_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "368-411",
    "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_query_ioregistry_entry(diagnostics_relay_client_t client, const char* name, const char* class, plist_t* result)\n{\n\tif (!client || (name == NULL && class == NULL) || result == NULL)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tif (name)\n\t\tplist_dict_set_item(dict,\"EntryName\", plist_new_string(name));\n\tif (class)\n\t\tplist_dict_set_item(dict,\"EntryClass\", plist_new_string(class));\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(\"IORegistry\"));\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (ret != DIAGNOSTICS_RELAY_E_SUCCESS) {\n\t\tplist_free(dict);\n\t\treturn ret;\n\t}\n\n\tplist_t value_node = plist_dict_get_item(dict, \"Diagnostics\");\n\tif (value_node) {\n\t\t*result = plist_copy(value_node);\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [
      "#define RESULT_UNKNOWN_REQUEST 2",
      "#define RESULT_SUCCESS 0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_copy",
          "args": [
            "value_node"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_get_item",
          "args": [
            "dict",
            "\"Diagnostics\""
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_check_result",
          "args": [
            "dict"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_check_result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "41-70",
          "snippet": "static int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [
            "#define RESULT_UNKNOWN_REQUEST 2",
            "#define RESULT_FAILURE 1",
            "#define RESULT_SUCCESS 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_FAILURE 1\n#define RESULT_SUCCESS 0\n\nstatic int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_receive",
          "args": [
            "client",
            "&dict"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "119-136",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_send",
          "args": [
            "client",
            "dict"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "150-163",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"Request\"",
            "plist_new_string(\"IORegistry\")"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"IORegistry\""
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"EntryClass\"",
            "plist_new_string(class)"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "class"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"EntryName\"",
            "plist_new_string(name)"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "name"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_SUCCESS 0\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_query_ioregistry_entry(diagnostics_relay_client_t client, const char* name, const char* class, plist_t* result)\n{\n\tif (!client || (name == NULL && class == NULL) || result == NULL)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tif (name)\n\t\tplist_dict_set_item(dict,\"EntryName\", plist_new_string(name));\n\tif (class)\n\t\tplist_dict_set_item(dict,\"EntryClass\", plist_new_string(class));\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(\"IORegistry\"));\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (ret != DIAGNOSTICS_RELAY_E_SUCCESS) {\n\t\tplist_free(dict);\n\t\treturn ret;\n\t}\n\n\tplist_t value_node = plist_dict_get_item(dict, \"Diagnostics\");\n\tif (value_node) {\n\t\t*result = plist_copy(value_node);\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}"
  },
  {
    "function_name": "diagnostics_relay_query_mobilegestalt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "326-366",
    "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_query_mobilegestalt(diagnostics_relay_client_t client, plist_t keys, plist_t* result)\n{\n\tif (!client || plist_get_node_type(keys) != PLIST_ARRAY || result == NULL)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"MobileGestaltKeys\", plist_copy(keys));\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(\"MobileGestalt\"));\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (ret != DIAGNOSTICS_RELAY_E_SUCCESS) {\n\t\tplist_free(dict);\n\t\treturn ret;\n\t}\n\n\tplist_t value_node = plist_dict_get_item(dict, \"Diagnostics\");\n\tif (value_node) {\n\t\t*result = plist_copy(value_node);\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [
      "#define RESULT_UNKNOWN_REQUEST 2",
      "#define RESULT_SUCCESS 0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_copy",
          "args": [
            "value_node"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_get_item",
          "args": [
            "dict",
            "\"Diagnostics\""
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_check_result",
          "args": [
            "dict"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_check_result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "41-70",
          "snippet": "static int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [
            "#define RESULT_UNKNOWN_REQUEST 2",
            "#define RESULT_FAILURE 1",
            "#define RESULT_SUCCESS 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_FAILURE 1\n#define RESULT_SUCCESS 0\n\nstatic int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_receive",
          "args": [
            "client",
            "&dict"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "119-136",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_send",
          "args": [
            "client",
            "dict"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "150-163",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"Request\"",
            "plist_new_string(\"MobileGestalt\")"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"MobileGestalt\""
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"MobileGestaltKeys\"",
            "plist_copy(keys)"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_copy",
          "args": [
            "keys"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_node_type",
          "args": [
            "keys"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_SUCCESS 0\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_query_mobilegestalt(diagnostics_relay_client_t client, plist_t keys, plist_t* result)\n{\n\tif (!client || plist_get_node_type(keys) != PLIST_ARRAY || result == NULL)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"MobileGestaltKeys\", plist_copy(keys));\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(\"MobileGestalt\"));\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (ret != DIAGNOSTICS_RELAY_E_SUCCESS) {\n\t\tplist_free(dict);\n\t\treturn ret;\n\t}\n\n\tplist_t value_node = plist_dict_get_item(dict, \"Diagnostics\");\n\tif (value_node) {\n\t\t*result = plist_copy(value_node);\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}"
  },
  {
    "function_name": "diagnostics_relay_request_diagnostics",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "285-324",
    "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_request_diagnostics(diagnostics_relay_client_t client, const char* type, plist_t* diagnostics)\n{\n\tif (!client || diagnostics == NULL)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(type));\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (ret != DIAGNOSTICS_RELAY_E_SUCCESS) {\n\t\tplist_free(dict);\n\t\treturn ret;\n\t}\n\n\tplist_t value_node = plist_dict_get_item(dict, \"Diagnostics\");\n\tif (value_node) {\n\t\t*diagnostics = plist_copy(value_node);\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [
      "#define RESULT_UNKNOWN_REQUEST 2",
      "#define RESULT_SUCCESS 0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_copy",
          "args": [
            "value_node"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_get_item",
          "args": [
            "dict",
            "\"Diagnostics\""
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_check_result",
          "args": [
            "dict"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_check_result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "41-70",
          "snippet": "static int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [
            "#define RESULT_UNKNOWN_REQUEST 2",
            "#define RESULT_FAILURE 1",
            "#define RESULT_SUCCESS 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_FAILURE 1\n#define RESULT_SUCCESS 0\n\nstatic int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_receive",
          "args": [
            "client",
            "&dict"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "119-136",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_send",
          "args": [
            "client",
            "dict"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "150-163",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"Request\"",
            "plist_new_string(type)"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "type"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_SUCCESS 0\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_request_diagnostics(diagnostics_relay_client_t client, const char* type, plist_t* diagnostics)\n{\n\tif (!client || diagnostics == NULL)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(type));\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (ret != DIAGNOSTICS_RELAY_E_SUCCESS) {\n\t\tplist_free(dict);\n\t\treturn ret;\n\t}\n\n\tplist_t value_node = plist_dict_get_item(dict, \"Diagnostics\");\n\tif (value_node) {\n\t\t*diagnostics = plist_copy(value_node);\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}"
  },
  {
    "function_name": "diagnostics_relay_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "280-283",
    "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_shutdown(diagnostics_relay_client_t client, int flags)\n{\n\treturn internal_diagnostics_relay_action(client, \"Shutdown\", flags);\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "internal_diagnostics_relay_action",
          "args": [
            "client",
            "\"Shutdown\"",
            "flags"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "internal_diagnostics_relay_action",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "231-273",
          "snippet": "static diagnostics_relay_error_t internal_diagnostics_relay_action(diagnostics_relay_client_t client, const char* name, int flags)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(name));\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_WAIT_FOR_DISCONNECT) {\n\t\tplist_dict_set_item(dict, \"WaitForDisconnect\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_PASS) {\n\t\tplist_dict_set_item(dict, \"DisplayPass\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_FAIL) {\n\t\tplist_dict_set_item(dict, \"DisplayFail\", plist_new_bool(1));\n\t}\n\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [
            "#define RESULT_UNKNOWN_REQUEST 2",
            "#define RESULT_SUCCESS 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_SUCCESS 0\n\nstatic diagnostics_relay_error_t internal_diagnostics_relay_action(diagnostics_relay_client_t client, const char* name, int flags)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(name));\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_WAIT_FOR_DISCONNECT) {\n\t\tplist_dict_set_item(dict, \"WaitForDisconnect\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_PASS) {\n\t\tplist_dict_set_item(dict, \"DisplayPass\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_FAIL) {\n\t\tplist_dict_set_item(dict, \"DisplayFail\", plist_new_bool(1));\n\t}\n\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_shutdown(diagnostics_relay_client_t client, int flags)\n{\n\treturn internal_diagnostics_relay_action(client, \"Shutdown\", flags);\n}"
  },
  {
    "function_name": "diagnostics_relay_restart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "275-278",
    "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_restart(diagnostics_relay_client_t client, int flags)\n{\n\treturn internal_diagnostics_relay_action(client, \"Restart\", flags);\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "internal_diagnostics_relay_action",
          "args": [
            "client",
            "\"Restart\"",
            "flags"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "internal_diagnostics_relay_action",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "231-273",
          "snippet": "static diagnostics_relay_error_t internal_diagnostics_relay_action(diagnostics_relay_client_t client, const char* name, int flags)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(name));\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_WAIT_FOR_DISCONNECT) {\n\t\tplist_dict_set_item(dict, \"WaitForDisconnect\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_PASS) {\n\t\tplist_dict_set_item(dict, \"DisplayPass\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_FAIL) {\n\t\tplist_dict_set_item(dict, \"DisplayFail\", plist_new_bool(1));\n\t}\n\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [
            "#define RESULT_UNKNOWN_REQUEST 2",
            "#define RESULT_SUCCESS 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_SUCCESS 0\n\nstatic diagnostics_relay_error_t internal_diagnostics_relay_action(diagnostics_relay_client_t client, const char* name, int flags)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(name));\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_WAIT_FOR_DISCONNECT) {\n\t\tplist_dict_set_item(dict, \"WaitForDisconnect\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_PASS) {\n\t\tplist_dict_set_item(dict, \"DisplayPass\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_FAIL) {\n\t\tplist_dict_set_item(dict, \"DisplayFail\", plist_new_bool(1));\n\t}\n\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_restart(diagnostics_relay_client_t client, int flags)\n{\n\treturn internal_diagnostics_relay_action(client, \"Restart\", flags);\n}"
  },
  {
    "function_name": "internal_diagnostics_relay_action",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "231-273",
    "snippet": "static diagnostics_relay_error_t internal_diagnostics_relay_action(diagnostics_relay_client_t client, const char* name, int flags)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(name));\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_WAIT_FOR_DISCONNECT) {\n\t\tplist_dict_set_item(dict, \"WaitForDisconnect\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_PASS) {\n\t\tplist_dict_set_item(dict, \"DisplayPass\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_FAIL) {\n\t\tplist_dict_set_item(dict, \"DisplayFail\", plist_new_bool(1));\n\t}\n\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [
      "#define RESULT_UNKNOWN_REQUEST 2",
      "#define RESULT_SUCCESS 0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_check_result",
          "args": [
            "dict"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_check_result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "41-70",
          "snippet": "static int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [
            "#define RESULT_UNKNOWN_REQUEST 2",
            "#define RESULT_FAILURE 1",
            "#define RESULT_SUCCESS 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_FAILURE 1\n#define RESULT_SUCCESS 0\n\nstatic int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_receive",
          "args": [
            "client",
            "&dict"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "119-136",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_send",
          "args": [
            "client",
            "dict"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "150-163",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"DisplayFail\"",
            "plist_new_bool(1)"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_bool",
          "args": [
            "1"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"DisplayPass\"",
            "plist_new_bool(1)"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_bool",
          "args": [
            "1"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"WaitForDisconnect\"",
            "plist_new_bool(1)"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_bool",
          "args": [
            "1"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"Request\"",
            "plist_new_string(name)"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "name"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_SUCCESS 0\n\nstatic diagnostics_relay_error_t internal_diagnostics_relay_action(diagnostics_relay_client_t client, const char* name, int flags)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(name));\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_WAIT_FOR_DISCONNECT) {\n\t\tplist_dict_set_item(dict, \"WaitForDisconnect\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_PASS) {\n\t\tplist_dict_set_item(dict, \"DisplayPass\", plist_new_bool(1));\n\t}\n\n\tif (flags & DIAGNOSTICS_RELAY_ACTION_FLAG_DISPLAY_FAIL) {\n\t\tplist_dict_set_item(dict, \"DisplayFail\", plist_new_bool(1));\n\t}\n\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}"
  },
  {
    "function_name": "diagnostics_relay_sleep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "199-229",
    "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_sleep(diagnostics_relay_client_t client)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(\"Sleep\"));\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [
      "#define RESULT_UNKNOWN_REQUEST 2",
      "#define RESULT_SUCCESS 0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_check_result",
          "args": [
            "dict"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_check_result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "41-70",
          "snippet": "static int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [
            "#define RESULT_UNKNOWN_REQUEST 2",
            "#define RESULT_FAILURE 1",
            "#define RESULT_SUCCESS 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_FAILURE 1\n#define RESULT_SUCCESS 0\n\nstatic int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_receive",
          "args": [
            "client",
            "&dict"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "119-136",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_send",
          "args": [
            "client",
            "dict"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "150-163",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"Request\"",
            "plist_new_string(\"Sleep\")"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"Sleep\""
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_SUCCESS 0\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_sleep(diagnostics_relay_client_t client)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\n\tplist_dict_set_item(dict,\"Request\", plist_new_string(\"Sleep\"));\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tplist_free(dict);\n\treturn ret;\n}"
  },
  {
    "function_name": "diagnostics_relay_goodbye",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "165-197",
    "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_goodbye(diagnostics_relay_client_t client)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"Request\", plist_new_string(\"Goodbye\"));\n\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\tdebug_info(\"did not get goodbye response back\");\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tplist_free(dict);\n\tdict = NULL;\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [
      "#define RESULT_UNKNOWN_REQUEST 2",
      "#define RESULT_SUCCESS 0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_check_result",
          "args": [
            "dict"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_check_result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "41-70",
          "snippet": "static int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [
            "#define RESULT_UNKNOWN_REQUEST 2",
            "#define RESULT_FAILURE 1",
            "#define RESULT_SUCCESS 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_FAILURE 1\n#define RESULT_SUCCESS 0\n\nstatic int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"did not get goodbye response back\""
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_receive",
          "args": [
            "client",
            "&dict"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "119-136",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "diagnostics_relay_send",
          "args": [
            "client",
            "dict"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "150-163",
          "snippet": "static diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"Request\"",
            "plist_new_string(\"Goodbye\")"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"Goodbye\""
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_SUCCESS 0\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_goodbye(diagnostics_relay_client_t client)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"Request\", plist_new_string(\"Goodbye\"));\n\n\tret = diagnostics_relay_send(client, dict);\n\tplist_free(dict);\n\tdict = NULL;\n\n\tret = diagnostics_relay_receive(client, &dict);\n\tif (!dict) {\n\t\tdebug_info(\"did not get goodbye response back\");\n\t\treturn DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\t}\n\n\tint check = diagnostics_relay_check_result(dict);\n\tif (check == RESULT_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\t} else if (check == RESULT_UNKNOWN_REQUEST) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_REQUEST;\n\t} else {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tplist_free(dict);\n\tdict = NULL;\n\treturn ret;\n}"
  },
  {
    "function_name": "diagnostics_relay_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "150-163",
    "snippet": "static diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "property_list_service_send_xml_plist",
          "args": [
            "client->parent",
            "plist"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_send_xml_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "150-153",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_xml_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 0);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_xml_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_send(diagnostics_relay_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_send_xml_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "diagnostics_relay_receive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "119-136",
    "snippet": "static diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "property_list_service_receive_plist",
          "args": [
            "client->parent",
            "plist"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_receive_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "258-261",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nstatic diagnostics_relay_error_t diagnostics_relay_receive(diagnostics_relay_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist))\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tdiagnostics_relay_error_t ret = DIAGNOSTICS_RELAY_E_SUCCESS;\n\tproperty_list_service_error_t err;\n\n\terr = property_list_service_receive_plist(client->parent, plist);\n\tif (err != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tret = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\n\tif (!*plist)\n\t\tret = DIAGNOSTICS_RELAY_E_PLIST_ERROR;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "diagnostics_relay_client_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "99-108",
    "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_client_free(diagnostics_relay_client_t client)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tif (property_list_service_client_free(client->parent) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn DIAGNOSTICS_RELAY_E_SUCCESS;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "property_list_service_client_free",
          "args": [
            "client->parent"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "77-88",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_free(property_list_service_client_t client)\n{\n\tif (!client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tproperty_list_service_error_t err = service_to_property_list_service_error(service_client_free(client->parent));\n\n\tfree(client);\n\tclient = NULL;\n\n\treturn err;\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_free(property_list_service_client_t client)\n{\n\tif (!client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tproperty_list_service_error_t err = service_to_property_list_service_error(service_client_free(client->parent));\n\n\tfree(client);\n\tclient = NULL;\n\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_client_free(diagnostics_relay_client_t client)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tif (property_list_service_client_free(client->parent) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn DIAGNOSTICS_RELAY_E_SUCCESS;\n}"
  },
  {
    "function_name": "diagnostics_relay_client_start_service",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "92-97",
    "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_client_start_service(idevice_t device, diagnostics_relay_client_t * client, const char* label)\n{\n\tdiagnostics_relay_error_t err = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, DIAGNOSTICS_RELAY_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(diagnostics_relay_client_new), &err);\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_client_factory_start_service",
          "args": [
            "device",
            "DIAGNOSTICS_RELAY_SERVICE_NAME",
            "(void**)client",
            "label",
            "SERVICE_CONSTRUCTOR(diagnostics_relay_client_new)",
            "&err"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "service_client_factory_start_service",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/service.c",
          "lines": "79-116",
          "snippet": "LIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"idevice.h\"",
            "#include \"service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"idevice.h\"\n#include \"service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SERVICE_CONSTRUCTOR",
          "args": [
            "diagnostics_relay_client_new"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_client_start_service(idevice_t device, diagnostics_relay_client_t * client, const char* label)\n{\n\tdiagnostics_relay_error_t err = DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, DIAGNOSTICS_RELAY_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(diagnostics_relay_client_new), &err);\n\treturn err;\n}"
  },
  {
    "function_name": "diagnostics_relay_client_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "72-90",
    "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_client_new(idevice_t device, lockdownd_service_descriptor_t service, diagnostics_relay_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client) {\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\t}\n\n\tproperty_list_service_client_t plistclient = NULL;\n\tif (property_list_service_client_new(device, service, &plistclient) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DIAGNOSTICS_RELAY_E_MUX_ERROR;\n\t}\n\n\t/* create client object */\n\tdiagnostics_relay_client_t client_loc = (diagnostics_relay_client_t) malloc(sizeof(struct diagnostics_relay_client_private));\n\tclient_loc->parent = plistclient;\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn DIAGNOSTICS_RELAY_E_SUCCESS;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct diagnostics_relay_client_private)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "property_list_service_client_new",
          "args": [
            "device",
            "service",
            "&plistclient"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_client_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "57-75",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, property_list_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tservice_client_t parent = NULL;\n\tservice_error_t rerr = service_client_new(device, service, &parent);\n\tif (rerr != SERVICE_E_SUCCESS) {\n\t\treturn service_to_property_list_service_error(rerr);\n\t}\n\n\t/* create client object */\n\tproperty_list_service_client_t client_loc = (property_list_service_client_t)malloc(sizeof(struct property_list_service_client_private));\n\tclient_loc->parent = parent;\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn PROPERTY_LIST_SERVICE_E_SUCCESS;\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, property_list_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tservice_client_t parent = NULL;\n\tservice_error_t rerr = service_client_new(device, service, &parent);\n\tif (rerr != SERVICE_E_SUCCESS) {\n\t\treturn service_to_property_list_service_error(rerr);\n\t}\n\n\t/* create client object */\n\tproperty_list_service_client_t client_loc = (property_list_service_client_t)malloc(sizeof(struct property_list_service_client_private));\n\tclient_loc->parent = parent;\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn PROPERTY_LIST_SERVICE_E_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_client_new(idevice_t device, lockdownd_service_descriptor_t service, diagnostics_relay_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client) {\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\t}\n\n\tproperty_list_service_client_t plistclient = NULL;\n\tif (property_list_service_client_new(device, service, &plistclient) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DIAGNOSTICS_RELAY_E_MUX_ERROR;\n\t}\n\n\t/* create client object */\n\tdiagnostics_relay_client_t client_loc = (diagnostics_relay_client_t) malloc(sizeof(struct diagnostics_relay_client_private));\n\tclient_loc->parent = plistclient;\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn DIAGNOSTICS_RELAY_E_SUCCESS;\n}"
  },
  {
    "function_name": "diagnostics_relay_check_result",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
    "lines": "41-70",
    "snippet": "static int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"diagnostics_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [
      "#define RESULT_UNKNOWN_REQUEST 2",
      "#define RESULT_FAILURE 1",
      "#define RESULT_SUCCESS 0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "result_value"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "diagnostics_relay_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/diagnostics_relay.c",
          "lines": "99-108",
          "snippet": "LIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_client_free(diagnostics_relay_client_t client)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tif (property_list_service_client_free(client->parent) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn DIAGNOSTICS_RELAY_E_SUCCESS;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"diagnostics_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API diagnostics_relay_error_t diagnostics_relay_client_free(diagnostics_relay_client_t client)\n{\n\tif (!client)\n\t\treturn DIAGNOSTICS_RELAY_E_INVALID_ARG;\n\n\tif (property_list_service_client_free(client->parent) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DIAGNOSTICS_RELAY_E_UNKNOWN_ERROR;\n\t}\n\treturn DIAGNOSTICS_RELAY_E_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"ERROR: unknown result value '%s'\"",
            "result_value"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "result_value",
            "\"UnknownRequest\""
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "plist_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/tools/idevicebackup.c",
          "lines": "296-309",
          "snippet": "static int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"common/utils.h\"",
            "#include <libimobiledevice/afc.h>",
            "#include <libimobiledevice/notification_proxy.h>",
            "#include <libimobiledevice/mobilebackup.h>",
            "#include <libimobiledevice/lockdown.h>",
            "#include <libimobiledevice/libimobiledevice.h>",
            "#include <time.h>",
            "#include <ctype.h>",
            "#include <unistd.h>",
            "#include <gcrypt.h>",
            "#include <openssl/sha.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"common/utils.h\"\n#include <libimobiledevice/afc.h>\n#include <libimobiledevice/notification_proxy.h>\n#include <libimobiledevice/mobilebackup.h>\n#include <libimobiledevice/lockdown.h>\n#include <libimobiledevice/libimobiledevice.h>\n#include <time.h>\n#include <ctype.h>\n#include <unistd.h>\n#include <gcrypt.h>\n#include <openssl/sha.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "result_node",
            "&result_value"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_node_type",
          "args": [
            "result_node"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_get_item",
          "args": [
            "dict",
            "\"Status\""
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"diagnostics_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n\n#define RESULT_UNKNOWN_REQUEST 2\n#define RESULT_FAILURE 1\n#define RESULT_SUCCESS 0\n\nstatic int diagnostics_relay_check_result(plist_t dict)\n{\n\tint ret = -1;\n\n\tplist_t result_node = plist_dict_get_item(dict, \"Status\");\n\tif (!result_node)\n\t\treturn ret;\n\n\tplist_type result_type = plist_get_node_type(result_node);\n\tif (result_type == PLIST_STRING) {\n\t\tchar *result_value = NULL;\n\n\t\tplist_get_string_val(result_node, &result_value);\n\n\t\tif (result_value) {\n\t\t\tif (!strcmp(result_value, \"Success\")) {\n\t\t\t\tret = RESULT_SUCCESS;\n\t\t\t} else if (!strcmp(result_value, \"Failure\")) {\n\t\t\t\tret = RESULT_FAILURE;\n\t\t\t} else if (!strcmp(result_value, \"UnknownRequest\")) {\n\t\t\t\tret = RESULT_UNKNOWN_REQUEST;\n\t\t\t} else {\n\t\t\t\tdebug_info(\"ERROR: unknown result value '%s'\", result_value);\n\t\t\t}\n\t\t}\n\t\tif (result_value)\n\t\t\tfree(result_value);\n\t}\n\treturn ret;\n}"
  }
]