[
  {
    "function_name": "afc_client_new_from_house_arrest_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
    "lines": "150-160",
    "snippet": "LIBIMOBILEDEVICE_API afc_error_t afc_client_new_from_house_arrest_client(house_arrest_client_t client, afc_client_t *afc_client)\n{\n\tif (!client || !client->parent || (client->mode == HOUSE_ARREST_CLIENT_MODE_AFC)) {\n\t\treturn AFC_E_INVALID_ARG;\n\t}\n\tafc_error_t err = afc_client_new_with_service_client(client->parent->parent, afc_client);\n\tif (err == AFC_E_SUCCESS) {\n\t\tclient->mode = HOUSE_ARREST_CLIENT_MODE_AFC;\n\t}\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"afc.h\"",
      "#include \"property_list_service.h\"",
      "#include \"house_arrest.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "afc_client_new_with_service_client",
          "args": [
            "client->parent->parent",
            "afc_client"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "afc_client_new_with_service_client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/afc.c",
          "lines": "71-97",
          "snippet": "LIBIMOBILEDEVICE_API afc_error_t afc_client_new_with_service_client(service_client_t service_client, afc_client_t *client)\n{\n\tif (!service_client)\n\t\treturn AFC_E_INVALID_ARG;\n\n\tafc_client_t client_loc = (afc_client_t) malloc(sizeof(struct afc_client_private));\n\tclient_loc->parent = service_client;\n\tclient_loc->free_parent = 0;\n\n\t/* allocate a packet */\n\tclient_loc->afc_packet = (AFCPacket *) malloc(sizeof(AFCPacket));\n\tif (!client_loc->afc_packet) {\n\t\tfree(client_loc);\n\t\treturn AFC_E_NO_MEM;\n\t}\n\n\tclient_loc->afc_packet->packet_num = 0;\n\tclient_loc->afc_packet->entire_length = 0;\n\tclient_loc->afc_packet->this_length = 0;\n\tmemcpy(client_loc->afc_packet->magic, AFC_MAGIC, AFC_MAGIC_LEN);\n\tclient_loc->file_handle = 0;\n\tclient_loc->lock = 0;\n\tmutex_init(&client_loc->mutex);\n\n\t*client = client_loc;\n\treturn AFC_E_SUCCESS;\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"idevice.h\"",
            "#include \"afc.h\"",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"idevice.h\"\n#include \"afc.h\"\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API afc_error_t afc_client_new_with_service_client(service_client_t service_client, afc_client_t *client)\n{\n\tif (!service_client)\n\t\treturn AFC_E_INVALID_ARG;\n\n\tafc_client_t client_loc = (afc_client_t) malloc(sizeof(struct afc_client_private));\n\tclient_loc->parent = service_client;\n\tclient_loc->free_parent = 0;\n\n\t/* allocate a packet */\n\tclient_loc->afc_packet = (AFCPacket *) malloc(sizeof(AFCPacket));\n\tif (!client_loc->afc_packet) {\n\t\tfree(client_loc);\n\t\treturn AFC_E_NO_MEM;\n\t}\n\n\tclient_loc->afc_packet->packet_num = 0;\n\tclient_loc->afc_packet->entire_length = 0;\n\tclient_loc->afc_packet->this_length = 0;\n\tmemcpy(client_loc->afc_packet->magic, AFC_MAGIC, AFC_MAGIC_LEN);\n\tclient_loc->file_handle = 0;\n\tclient_loc->lock = 0;\n\tmutex_init(&client_loc->mutex);\n\n\t*client = client_loc;\n\treturn AFC_E_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API afc_error_t afc_client_new_from_house_arrest_client(house_arrest_client_t client, afc_client_t *afc_client)\n{\n\tif (!client || !client->parent || (client->mode == HOUSE_ARREST_CLIENT_MODE_AFC)) {\n\t\treturn AFC_E_INVALID_ARG;\n\t}\n\tafc_error_t err = afc_client_new_with_service_client(client->parent->parent, afc_client);\n\tif (err == AFC_E_SUCCESS) {\n\t\tclient->mode = HOUSE_ARREST_CLIENT_MODE_AFC;\n\t}\n\treturn err;\n}"
  },
  {
    "function_name": "house_arrest_get_result",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
    "lines": "132-148",
    "snippet": "LIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_get_result(house_arrest_client_t client, plist_t *dict)\n{\n\tif (!client || !client->parent)\n\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\tif (client->mode != HOUSE_ARREST_CLIENT_MODE_NORMAL)\n\t\treturn HOUSE_ARREST_E_INVALID_MODE;\n\n\thouse_arrest_error_t res = house_arrest_error(property_list_service_receive_plist(client->parent, dict));\n\tif (res != HOUSE_ARREST_E_SUCCESS) {\n\t\tdebug_info(\"could not get result, error %d\", res);\n\t\tif (*dict) {\n\t\t\tplist_free(*dict);\n\t\t\t*dict = NULL;\n\t\t}\n\t}\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"afc.h\"",
      "#include \"property_list_service.h\"",
      "#include \"house_arrest.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "*dict"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"could not get result, error %d\"",
            "res"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "house_arrest_error",
          "args": [
            "property_list_service_receive_plist(client->parent, dict)"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "house_arrest_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
          "lines": "41-56",
          "snippet": "static house_arrest_error_t house_arrest_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn HOUSE_ARREST_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn HOUSE_ARREST_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn HOUSE_ARREST_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"afc.h\"",
            "#include \"property_list_service.h\"",
            "#include \"house_arrest.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic house_arrest_error_t house_arrest_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn HOUSE_ARREST_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn HOUSE_ARREST_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn HOUSE_ARREST_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_receive_plist",
          "args": [
            "client->parent",
            "dict"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_receive_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "258-261",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_get_result(house_arrest_client_t client, plist_t *dict)\n{\n\tif (!client || !client->parent)\n\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\tif (client->mode != HOUSE_ARREST_CLIENT_MODE_NORMAL)\n\t\treturn HOUSE_ARREST_E_INVALID_MODE;\n\n\thouse_arrest_error_t res = house_arrest_error(property_list_service_receive_plist(client->parent, dict));\n\tif (res != HOUSE_ARREST_E_SUCCESS) {\n\t\tdebug_info(\"could not get result, error %d\", res);\n\t\tif (*dict) {\n\t\t\tplist_free(*dict);\n\t\t\t*dict = NULL;\n\t\t}\n\t}\n\treturn res;\n}"
  },
  {
    "function_name": "house_arrest_send_command",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
    "lines": "112-130",
    "snippet": "LIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_send_command(house_arrest_client_t client, const char *command, const char *appid)\n{\n\tif (!client || !client->parent || !command || !appid)\n\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\tif (client->mode != HOUSE_ARREST_CLIENT_MODE_NORMAL)\n\t\treturn HOUSE_ARREST_E_INVALID_MODE;\n\n\thouse_arrest_error_t res = HOUSE_ARREST_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"Command\", plist_new_string(command));\n\tplist_dict_set_item(dict, \"Identifier\", plist_new_string(appid));\n\n\tres = house_arrest_send_request(client, dict);\n\n\tplist_free(dict);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"afc.h\"",
      "#include \"property_list_service.h\"",
      "#include \"house_arrest.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "house_arrest_send_request",
          "args": [
            "client",
            "dict"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "house_arrest_send_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
          "lines": "96-110",
          "snippet": "LIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_send_request(house_arrest_client_t client, plist_t dict)\n{\n\tif (!client || !client->parent || !dict)\n\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\tif (plist_get_node_type(dict) != PLIST_DICT)\n\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\tif (client->mode != HOUSE_ARREST_CLIENT_MODE_NORMAL)\n\t\treturn HOUSE_ARREST_E_INVALID_MODE;\n\n\thouse_arrest_error_t res = house_arrest_error(property_list_service_send_xml_plist(client->parent, dict));\n\tif (res != HOUSE_ARREST_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"afc.h\"",
            "#include \"property_list_service.h\"",
            "#include \"house_arrest.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_send_request(house_arrest_client_t client, plist_t dict)\n{\n\tif (!client || !client->parent || !dict)\n\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\tif (plist_get_node_type(dict) != PLIST_DICT)\n\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\tif (client->mode != HOUSE_ARREST_CLIENT_MODE_NORMAL)\n\t\treturn HOUSE_ARREST_E_INVALID_MODE;\n\n\thouse_arrest_error_t res = house_arrest_error(property_list_service_send_xml_plist(client->parent, dict));\n\tif (res != HOUSE_ARREST_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t}\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"Identifier\"",
            "plist_new_string(appid)"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "appid"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"Command\"",
            "plist_new_string(command)"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "command"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_send_command(house_arrest_client_t client, const char *command, const char *appid)\n{\n\tif (!client || !client->parent || !command || !appid)\n\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\tif (client->mode != HOUSE_ARREST_CLIENT_MODE_NORMAL)\n\t\treturn HOUSE_ARREST_E_INVALID_MODE;\n\n\thouse_arrest_error_t res = HOUSE_ARREST_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"Command\", plist_new_string(command));\n\tplist_dict_set_item(dict, \"Identifier\", plist_new_string(appid));\n\n\tres = house_arrest_send_request(client, dict);\n\n\tplist_free(dict);\n\n\treturn res;\n}"
  },
  {
    "function_name": "house_arrest_send_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
    "lines": "96-110",
    "snippet": "LIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_send_request(house_arrest_client_t client, plist_t dict)\n{\n\tif (!client || !client->parent || !dict)\n\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\tif (plist_get_node_type(dict) != PLIST_DICT)\n\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\tif (client->mode != HOUSE_ARREST_CLIENT_MODE_NORMAL)\n\t\treturn HOUSE_ARREST_E_INVALID_MODE;\n\n\thouse_arrest_error_t res = house_arrest_error(property_list_service_send_xml_plist(client->parent, dict));\n\tif (res != HOUSE_ARREST_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t}\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"afc.h\"",
      "#include \"property_list_service.h\"",
      "#include \"house_arrest.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"could not send plist, error %d\"",
            "res"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "house_arrest_error",
          "args": [
            "property_list_service_send_xml_plist(client->parent, dict)"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "house_arrest_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
          "lines": "41-56",
          "snippet": "static house_arrest_error_t house_arrest_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn HOUSE_ARREST_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn HOUSE_ARREST_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn HOUSE_ARREST_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"afc.h\"",
            "#include \"property_list_service.h\"",
            "#include \"house_arrest.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic house_arrest_error_t house_arrest_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn HOUSE_ARREST_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn HOUSE_ARREST_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn HOUSE_ARREST_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_send_xml_plist",
          "args": [
            "client->parent",
            "dict"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_send_xml_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "150-153",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_xml_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 0);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_xml_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_get_node_type",
          "args": [
            "dict"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_send_request(house_arrest_client_t client, plist_t dict)\n{\n\tif (!client || !client->parent || !dict)\n\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\tif (plist_get_node_type(dict) != PLIST_DICT)\n\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\tif (client->mode != HOUSE_ARREST_CLIENT_MODE_NORMAL)\n\t\treturn HOUSE_ARREST_E_INVALID_MODE;\n\n\thouse_arrest_error_t res = house_arrest_error(property_list_service_send_xml_plist(client->parent, dict));\n\tif (res != HOUSE_ARREST_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t}\n\treturn res;\n}"
  },
  {
    "function_name": "house_arrest_client_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
    "lines": "81-94",
    "snippet": "LIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_client_free(house_arrest_client_t client)\n{\n\tif (!client)\n\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\n\thouse_arrest_error_t err = HOUSE_ARREST_E_SUCCESS;\n\tif (client->parent && client->parent->parent->connection) {\n\t\thouse_arrest_error(property_list_service_client_free(client->parent));\n\t}\n\tclient->parent = NULL;\n\tfree(client);\n\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"afc.h\"",
      "#include \"property_list_service.h\"",
      "#include \"house_arrest.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "client"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "house_arrest_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
          "lines": "81-94",
          "snippet": "LIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_client_free(house_arrest_client_t client)\n{\n\tif (!client)\n\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\n\thouse_arrest_error_t err = HOUSE_ARREST_E_SUCCESS;\n\tif (client->parent && client->parent->parent->connection) {\n\t\thouse_arrest_error(property_list_service_client_free(client->parent));\n\t}\n\tclient->parent = NULL;\n\tfree(client);\n\n\treturn err;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "house_arrest_error",
          "args": [
            "property_list_service_client_free(client->parent)"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "house_arrest_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
          "lines": "41-56",
          "snippet": "static house_arrest_error_t house_arrest_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn HOUSE_ARREST_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn HOUSE_ARREST_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn HOUSE_ARREST_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"afc.h\"",
            "#include \"property_list_service.h\"",
            "#include \"house_arrest.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic house_arrest_error_t house_arrest_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn HOUSE_ARREST_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn HOUSE_ARREST_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn HOUSE_ARREST_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_client_free",
          "args": [
            "client->parent"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "77-88",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_free(property_list_service_client_t client)\n{\n\tif (!client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tproperty_list_service_error_t err = service_to_property_list_service_error(service_client_free(client->parent));\n\n\tfree(client);\n\tclient = NULL;\n\n\treturn err;\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_free(property_list_service_client_t client)\n{\n\tif (!client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tproperty_list_service_error_t err = service_to_property_list_service_error(service_client_free(client->parent));\n\n\tfree(client);\n\tclient = NULL;\n\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_client_free(house_arrest_client_t client)\n{\n\tif (!client)\n\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\n\thouse_arrest_error_t err = HOUSE_ARREST_E_SUCCESS;\n\tif (client->parent && client->parent->parent->connection) {\n\t\thouse_arrest_error(property_list_service_client_free(client->parent));\n\t}\n\tclient->parent = NULL;\n\tfree(client);\n\n\treturn err;\n}"
  },
  {
    "function_name": "house_arrest_client_start_service",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
    "lines": "74-79",
    "snippet": "LIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_client_start_service(idevice_t device, house_arrest_client_t * client, const char* label)\n{\n\thouse_arrest_error_t err = HOUSE_ARREST_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, HOUSE_ARREST_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(house_arrest_client_new), &err);\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"afc.h\"",
      "#include \"property_list_service.h\"",
      "#include \"house_arrest.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_client_factory_start_service",
          "args": [
            "device",
            "HOUSE_ARREST_SERVICE_NAME",
            "(void**)client",
            "label",
            "SERVICE_CONSTRUCTOR(house_arrest_client_new)",
            "&err"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "service_client_factory_start_service",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/service.c",
          "lines": "79-116",
          "snippet": "LIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"idevice.h\"",
            "#include \"service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"idevice.h\"\n#include \"service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SERVICE_CONSTRUCTOR",
          "args": [
            "house_arrest_client_new"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_client_start_service(idevice_t device, house_arrest_client_t * client, const char* label)\n{\n\thouse_arrest_error_t err = HOUSE_ARREST_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, HOUSE_ARREST_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(house_arrest_client_new), &err);\n\treturn err;\n}"
  },
  {
    "function_name": "house_arrest_client_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
    "lines": "58-72",
    "snippet": "LIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_client_new(idevice_t device, lockdownd_service_descriptor_t service, house_arrest_client_t *client)\n{\n\tproperty_list_service_client_t plistclient = NULL;\n\thouse_arrest_error_t err = house_arrest_error(property_list_service_client_new(device, service, &plistclient));\n\tif (err != HOUSE_ARREST_E_SUCCESS) {\n\t\treturn err;\n\t}\n\n\thouse_arrest_client_t client_loc = (house_arrest_client_t) malloc(sizeof(struct house_arrest_client_private));\n\tclient_loc->parent = plistclient;\n\tclient_loc->mode = HOUSE_ARREST_CLIENT_MODE_NORMAL;\n\n\t*client = client_loc;\n\treturn HOUSE_ARREST_E_SUCCESS;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"afc.h\"",
      "#include \"property_list_service.h\"",
      "#include \"house_arrest.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct house_arrest_client_private)"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "house_arrest_error",
          "args": [
            "property_list_service_client_new(device, service, &plistclient)"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "house_arrest_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
          "lines": "41-56",
          "snippet": "static house_arrest_error_t house_arrest_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn HOUSE_ARREST_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn HOUSE_ARREST_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn HOUSE_ARREST_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"afc.h\"",
            "#include \"property_list_service.h\"",
            "#include \"house_arrest.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic house_arrest_error_t house_arrest_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn HOUSE_ARREST_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn HOUSE_ARREST_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn HOUSE_ARREST_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_client_new",
          "args": [
            "device",
            "service",
            "&plistclient"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_client_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "57-75",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, property_list_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tservice_client_t parent = NULL;\n\tservice_error_t rerr = service_client_new(device, service, &parent);\n\tif (rerr != SERVICE_E_SUCCESS) {\n\t\treturn service_to_property_list_service_error(rerr);\n\t}\n\n\t/* create client object */\n\tproperty_list_service_client_t client_loc = (property_list_service_client_t)malloc(sizeof(struct property_list_service_client_private));\n\tclient_loc->parent = parent;\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn PROPERTY_LIST_SERVICE_E_SUCCESS;\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, property_list_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tservice_client_t parent = NULL;\n\tservice_error_t rerr = service_client_new(device, service, &parent);\n\tif (rerr != SERVICE_E_SUCCESS) {\n\t\treturn service_to_property_list_service_error(rerr);\n\t}\n\n\t/* create client object */\n\tproperty_list_service_client_t client_loc = (property_list_service_client_t)malloc(sizeof(struct property_list_service_client_private));\n\tclient_loc->parent = parent;\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn PROPERTY_LIST_SERVICE_E_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API house_arrest_error_t house_arrest_client_new(idevice_t device, lockdownd_service_descriptor_t service, house_arrest_client_t *client)\n{\n\tproperty_list_service_client_t plistclient = NULL;\n\thouse_arrest_error_t err = house_arrest_error(property_list_service_client_new(device, service, &plistclient));\n\tif (err != HOUSE_ARREST_E_SUCCESS) {\n\t\treturn err;\n\t}\n\n\thouse_arrest_client_t client_loc = (house_arrest_client_t) malloc(sizeof(struct house_arrest_client_private));\n\tclient_loc->parent = plistclient;\n\tclient_loc->mode = HOUSE_ARREST_CLIENT_MODE_NORMAL;\n\n\t*client = client_loc;\n\treturn HOUSE_ARREST_E_SUCCESS;\n}"
  },
  {
    "function_name": "house_arrest_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/house_arrest.c",
    "lines": "41-56",
    "snippet": "static house_arrest_error_t house_arrest_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn HOUSE_ARREST_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn HOUSE_ARREST_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn HOUSE_ARREST_E_UNKNOWN_ERROR;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"afc.h\"",
      "#include \"property_list_service.h\"",
      "#include \"house_arrest.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"afc.h\"\n#include \"property_list_service.h\"\n#include \"house_arrest.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic house_arrest_error_t house_arrest_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn HOUSE_ARREST_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn HOUSE_ARREST_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn HOUSE_ARREST_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn HOUSE_ARREST_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn HOUSE_ARREST_E_UNKNOWN_ERROR;\n}"
  }
]