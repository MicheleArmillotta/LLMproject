[
  {
    "function_name": "mobilesync_actions_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "779-785",
    "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "actions"
          ],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}"
  },
  {
    "function_name": "mobilesync_actions_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "747-777",
    "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_add(plist_t actions, ...)\n{\n\tif (!actions)\n\t\treturn;\n\tva_list args;\n\tva_start(args, actions);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tchar *key = strdup(arg);\n\t\tif (!strcmp(key, \"SyncDeviceLinkEntityNamesKey\")) {\n\t\t\tchar **entity_names = va_arg(args, char**);\n\t\t\tint entity_names_length = va_arg(args, int);\n\t\t\tint i = 0;\n\n\t\t\tplist_t array = plist_new_array();\n\n\t\t\tfor (i = 0; i < entity_names_length; i++) {\n\t\t\t\tplist_array_append_item(array, plist_new_string(entity_names[i]));\n\t\t\t}\n\n\t\t\tplist_dict_set_item(actions, key, array);\n\t\t} else if (!strcmp(key, \"SyncDeviceLinkAllRecordsOfPulledEntityTypeSentKey\")) {\n\t\t\tint link_records = va_arg(args, int);\n\t\t\tplist_dict_set_item(actions, key, plist_new_bool(link_records));\n\t\t}\n\t\tfree(key);\n\t\tkey = NULL;\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "key"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_actions_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "779-785",
          "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "actions",
            "key",
            "plist_new_bool(link_records)"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_bool",
          "args": [
            "link_records"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "int"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"SyncDeviceLinkAllRecordsOfPulledEntityTypeSentKey\""
          ],
          "line": 768
        },
        "resolved": true,
        "details": {
          "function_name": "plist_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/tools/idevicebackup.c",
          "lines": "296-309",
          "snippet": "static int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"common/utils.h\"",
            "#include <libimobiledevice/afc.h>",
            "#include <libimobiledevice/notification_proxy.h>",
            "#include <libimobiledevice/mobilebackup.h>",
            "#include <libimobiledevice/lockdown.h>",
            "#include <libimobiledevice/libimobiledevice.h>",
            "#include <time.h>",
            "#include <ctype.h>",
            "#include <unistd.h>",
            "#include <gcrypt.h>",
            "#include <openssl/sha.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"common/utils.h\"\n#include <libimobiledevice/afc.h>\n#include <libimobiledevice/notification_proxy.h>\n#include <libimobiledevice/mobilebackup.h>\n#include <libimobiledevice/lockdown.h>\n#include <libimobiledevice/libimobiledevice.h>\n#include <time.h>\n#include <ctype.h>\n#include <unistd.h>\n#include <gcrypt.h>\n#include <openssl/sha.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "actions",
            "key",
            "array"
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "array",
            "plist_new_string(entity_names[i])"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "entity_names[i]"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_array",
          "args": [],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "int"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char**"
          ],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "arg"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "args",
            "char*"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "actions"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_add(plist_t actions, ...)\n{\n\tif (!actions)\n\t\treturn;\n\tva_list args;\n\tva_start(args, actions);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tchar *key = strdup(arg);\n\t\tif (!strcmp(key, \"SyncDeviceLinkEntityNamesKey\")) {\n\t\t\tchar **entity_names = va_arg(args, char**);\n\t\t\tint entity_names_length = va_arg(args, int);\n\t\t\tint i = 0;\n\n\t\t\tplist_t array = plist_new_array();\n\n\t\t\tfor (i = 0; i < entity_names_length; i++) {\n\t\t\t\tplist_array_append_item(array, plist_new_string(entity_names[i]));\n\t\t\t}\n\n\t\t\tplist_dict_set_item(actions, key, array);\n\t\t} else if (!strcmp(key, \"SyncDeviceLinkAllRecordsOfPulledEntityTypeSentKey\")) {\n\t\t\tint link_records = va_arg(args, int);\n\t\t\tplist_dict_set_item(actions, key, plist_new_bool(link_records));\n\t\t}\n\t\tfree(key);\n\t\tkey = NULL;\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n}"
  },
  {
    "function_name": "mobilesync_actions_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "742-745",
    "snippet": "LIBIMOBILEDEVICE_API plist_t mobilesync_actions_new(void)\n{\n\treturn plist_new_dict();\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API plist_t mobilesync_actions_new(void)\n{\n\treturn plist_new_dict();\n}"
  },
  {
    "function_name": "mobilesync_anchors_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "728-740",
    "snippet": "LIBIMOBILEDEVICE_API void mobilesync_anchors_free(mobilesync_anchors_t anchors)\n{\n\tif (anchors->device_anchor != NULL) {\n\t\tfree(anchors->device_anchor);\n\t\tanchors->device_anchor = NULL;\n\t}\n\tif (anchors->computer_anchor != NULL) {\n\t\tfree(anchors->computer_anchor);\n\t\tanchors->computer_anchor = NULL;\n\t}\n\tfree(anchors);\n\tanchors = NULL;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "anchors"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_actions_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "779-785",
          "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_anchors_free(mobilesync_anchors_t anchors)\n{\n\tif (anchors->device_anchor != NULL) {\n\t\tfree(anchors->device_anchor);\n\t\tanchors->device_anchor = NULL;\n\t}\n\tif (anchors->computer_anchor != NULL) {\n\t\tfree(anchors->computer_anchor);\n\t\tanchors->computer_anchor = NULL;\n\t}\n\tfree(anchors);\n\tanchors = NULL;\n}"
  },
  {
    "function_name": "mobilesync_anchors_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "711-726",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_anchors_t mobilesync_anchors_new(const char *device_anchor, const char *computer_anchor)\n{\n\tmobilesync_anchors_t anchors = (mobilesync_anchors_t) malloc(sizeof(mobilesync_anchors));\n\tif (device_anchor != NULL) {\n\t\tanchors->device_anchor = strdup(device_anchor);\n\t} else {\n\t\tanchors->device_anchor = NULL;\n\t}\n\tif (computer_anchor != NULL) {\n\t\tanchors->computer_anchor = strdup(computer_anchor);\n\t} else {\n\t\tanchors->computer_anchor = NULL;\n\t}\n\n\treturn anchors;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "computer_anchor"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "device_anchor"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(mobilesync_anchors)"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_anchors_t mobilesync_anchors_new(const char *device_anchor, const char *computer_anchor)\n{\n\tmobilesync_anchors_t anchors = (mobilesync_anchors_t) malloc(sizeof(mobilesync_anchors));\n\tif (device_anchor != NULL) {\n\t\tanchors->device_anchor = strdup(device_anchor);\n\t} else {\n\t\tanchors->device_anchor = NULL;\n\t}\n\tif (computer_anchor != NULL) {\n\t\tanchors->computer_anchor = strdup(computer_anchor);\n\t} else {\n\t\tanchors->computer_anchor = NULL;\n\t}\n\n\treturn anchors;\n}"
  },
  {
    "function_name": "mobilesync_cancel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "685-709",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_cancel(mobilesync_client_t client, const char* reason)\n{\n\tif (!client || !client->data_class || !reason) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageCancelSession\"));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\tplist_array_append_item(msg, plist_new_string(reason));\n\n\terr = mobilesync_send(client, msg);\n\n\tplist_free(msg);\n\tmsg = NULL;\n\n\tfree(client->data_class);\n\tclient->data_class = NULL;\n\tclient->direction = MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER;\n\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "client->data_class"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_actions_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "779-785",
          "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_send",
          "args": [
            "client",
            "msg"
          ],
          "line": 699
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "123-128",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(reason)"
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "reason"
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(client->data_class)"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "client->data_class"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(\"SDMessageCancelSession\")"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"SDMessageCancelSession\""
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_array",
          "args": [],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_cancel(mobilesync_client_t client, const char* reason)\n{\n\tif (!client || !client->data_class || !reason) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageCancelSession\"));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\tplist_array_append_item(msg, plist_new_string(reason));\n\n\terr = mobilesync_send(client, msg);\n\n\tplist_free(msg);\n\tmsg = NULL;\n\n\tfree(client->data_class);\n\tclient->data_class = NULL;\n\tclient->direction = MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER;\n\n\treturn err;\n}"
  },
  {
    "function_name": "mobilesync_remap_identifiers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "616-683",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_remap_identifiers(mobilesync_client_t client, plist_t *mapping)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tif (client->direction == MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER) {\n\t\treturn MOBILESYNC_E_WRONG_DIRECTION;\n\t}\n\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\tchar *response_type = NULL;\n\n\tmobilesync_error_t err = mobilesync_receive(client, &msg);\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (!strcmp(response_type, \"SDMessageCancelSession\")) {\n\t\tchar *reason = NULL;\n\t\terr = MOBILESYNC_E_CANCELLED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), &reason);\n\t\tdebug_info(\"Device cancelled: %s\", reason);\n\t\tfree(reason);\n\t\tgoto out;\n\t}\n\n\tif (strcmp(response_type, \"SDMessageRemapRecordIdentifiers\") != 0) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (mapping != NULL) {\n\t\tplist_t map = plist_array_get_item(msg, 2);\n\t\tif (plist_get_node_type(map) == PLIST_DICT) {\n\t\t\t*mapping = plist_copy(map);\n\t\t} else {\n\t\t\t*mapping = NULL;\n\t\t}\n\t}\n\n\terr = MOBILESYNC_E_SUCCESS;\n\n\tout:\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "response_type"
          ],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_actions_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "779-785",
          "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_copy",
          "args": [
            "map"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_node_type",
          "args": [
            "map"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "2"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "response_type",
            "\"SDMessageRemapRecordIdentifiers\""
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "plist_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/tools/idevicebackup.c",
          "lines": "296-309",
          "snippet": "static int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"common/utils.h\"",
            "#include <libimobiledevice/afc.h>",
            "#include <libimobiledevice/notification_proxy.h>",
            "#include <libimobiledevice/mobilebackup.h>",
            "#include <libimobiledevice/lockdown.h>",
            "#include <libimobiledevice/libimobiledevice.h>",
            "#include <time.h>",
            "#include <ctype.h>",
            "#include <unistd.h>",
            "#include <gcrypt.h>",
            "#include <openssl/sha.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"common/utils.h\"\n#include <libimobiledevice/afc.h>\n#include <libimobiledevice/notification_proxy.h>\n#include <libimobiledevice/mobilebackup.h>\n#include <libimobiledevice/lockdown.h>\n#include <libimobiledevice/libimobiledevice.h>\n#include <time.h>\n#include <ctype.h>\n#include <unistd.h>\n#include <gcrypt.h>\n#include <openssl/sha.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Device cancelled: %s\"",
            "reason"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "plist_array_get_item(msg, 2)",
            "&reason"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "2"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "response_type_node",
            "&response_type"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "0"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_receive",
          "args": [
            "client",
            "&msg"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "115-121",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_remap_identifiers(mobilesync_client_t client, plist_t *mapping)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tif (client->direction == MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER) {\n\t\treturn MOBILESYNC_E_WRONG_DIRECTION;\n\t}\n\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\tchar *response_type = NULL;\n\n\tmobilesync_error_t err = mobilesync_receive(client, &msg);\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (!strcmp(response_type, \"SDMessageCancelSession\")) {\n\t\tchar *reason = NULL;\n\t\terr = MOBILESYNC_E_CANCELLED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), &reason);\n\t\tdebug_info(\"Device cancelled: %s\", reason);\n\t\tfree(reason);\n\t\tgoto out;\n\t}\n\n\tif (strcmp(response_type, \"SDMessageRemapRecordIdentifiers\") != 0) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (mapping != NULL) {\n\t\tplist_t map = plist_array_get_item(msg, 2);\n\t\tif (plist_get_node_type(map) == PLIST_DICT) {\n\t\t\t*mapping = plist_copy(map);\n\t\t} else {\n\t\t\t*mapping = NULL;\n\t\t}\n\t}\n\n\terr = MOBILESYNC_E_SUCCESS;\n\n\tout:\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\treturn err;\n}"
  },
  {
    "function_name": "mobilesync_send_changes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "588-614",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send_changes(mobilesync_client_t client, plist_t entities, uint8_t is_last_record, plist_t actions)\n{\n\tif (!client || !client->data_class || !entities) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tif (plist_get_node_type(entities) != PLIST_DICT) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tif (client->direction != MOBILESYNC_SYNC_DIR_COMPUTER_TO_DEVICE) {\n\t\treturn MOBILESYNC_E_WRONG_DIRECTION;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\n\tmsg = create_process_changes_message(client->data_class, entities, (is_last_record > 0 ? 0 : 1), actions);\n\terr = mobilesync_send(client, msg);\n\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_send",
          "args": [
            "client",
            "msg"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "123-128",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}"
        }
      },
      {
        "call_info": {
          "callee": "create_process_changes_message",
          "args": [
            "client->data_class",
            "entities",
            "(is_last_record > 0 ? 0 : 1)",
            "actions"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "create_process_changes_message",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "505-519",
          "snippet": "static plist_t create_process_changes_message(const char *data_class, plist_t entities, uint8_t more_changes, plist_t actions)\n{\n\tplist_t msg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageProcessChanges\"));\n\tplist_array_append_item(msg, plist_new_string(data_class));\n\tplist_array_append_item(msg, plist_copy(entities));\n\tplist_array_append_item(msg, plist_new_bool(more_changes));\n\n\tif (actions)\n\t\tplist_array_append_item(msg, plist_copy(actions));\n\telse\n\t\tplist_array_append_item(msg, plist_new_string(EMPTY_PARAMETER_STRING));\n\n\treturn msg;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [
            "#define EMPTY_PARAMETER_STRING \"___EmptyParameterString___\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\n#define EMPTY_PARAMETER_STRING \"___EmptyParameterString___\"\n\nstatic plist_t create_process_changes_message(const char *data_class, plist_t entities, uint8_t more_changes, plist_t actions)\n{\n\tplist_t msg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageProcessChanges\"));\n\tplist_array_append_item(msg, plist_new_string(data_class));\n\tplist_array_append_item(msg, plist_copy(entities));\n\tplist_array_append_item(msg, plist_new_bool(more_changes));\n\n\tif (actions)\n\t\tplist_array_append_item(msg, plist_copy(actions));\n\telse\n\t\tplist_array_append_item(msg, plist_new_string(EMPTY_PARAMETER_STRING));\n\n\treturn msg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_get_node_type",
          "args": [
            "entities"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send_changes(mobilesync_client_t client, plist_t entities, uint8_t is_last_record, plist_t actions)\n{\n\tif (!client || !client->data_class || !entities) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tif (plist_get_node_type(entities) != PLIST_DICT) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tif (client->direction != MOBILESYNC_SYNC_DIR_COMPUTER_TO_DEVICE) {\n\t\treturn MOBILESYNC_E_WRONG_DIRECTION;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\n\tmsg = create_process_changes_message(client->data_class, entities, (is_last_record > 0 ? 0 : 1), actions);\n\terr = mobilesync_send(client, msg);\n\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\treturn err;\n}"
  },
  {
    "function_name": "mobilesync_ready_to_send_changes_from_computer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "521-586",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_ready_to_send_changes_from_computer(mobilesync_client_t client)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tif (client->direction != MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER) {\n\t\treturn MOBILESYNC_E_WRONG_DIRECTION;\n\t}\n\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\tchar *response_type = NULL;\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\n\terr = mobilesync_receive(client, &msg);\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (!strcmp(response_type, \"SDMessageCancelSession\")) {\n\t\tchar *reason = NULL;\n\t\terr = MOBILESYNC_E_CANCELLED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), &reason);\n\t\tdebug_info(\"Device cancelled: %s\", reason);\n\t\tfree(reason);\n\t\tgoto out;\n\t}\n\n\tif (strcmp(response_type, \"SDMessageDeviceReadyToReceiveChanges\") != 0) {\n\t\terr = MOBILESYNC_E_NOT_READY;\n\t\tgoto out;\n\t}\n\n\terr = mobilesync_error(device_link_service_send_ping(client->parent, \"Preparing to get changes for device\"));\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tclient->direction = MOBILESYNC_SYNC_DIR_COMPUTER_TO_DEVICE;\n\terr = MOBILESYNC_E_SUCCESS;\n\n\tout:\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "response_type"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_actions_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "779-785",
          "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mobilesync_error",
          "args": [
            "device_link_service_send_ping(client->parent, \"Preparing to get changes for device\")"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "49-66",
          "snippet": "static mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nstatic mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_link_service_send_ping",
          "args": [
            "client->parent",
            "\"Preparing to get changes for device\""
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "device_link_service_send_ping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/device_link_service.c",
          "lines": "280-295",
          "snippet": "device_link_service_error_t device_link_service_send_ping(device_link_service_client_t client, const char *message)\n{\n\tif (!client || !client->parent || !message)\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\n\tplist_t array = plist_new_array();\n\tplist_array_append_item(array, plist_new_string(\"DLMessagePing\"));\n\tplist_array_append_item(array, plist_new_string(message));\n\n\tdevice_link_service_error_t err = DEVICE_LINK_SERVICE_E_SUCCESS;\n\tif (property_list_service_send_binary_plist(client->parent, array) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\terr = DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\tplist_free(array);\n\treturn err;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"device_link_service.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"device_link_service.h\"\n#include <stdlib.h>\n#include <string.h>\n\ndevice_link_service_error_t device_link_service_send_ping(device_link_service_client_t client, const char *message)\n{\n\tif (!client || !client->parent || !message)\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\n\tplist_t array = plist_new_array();\n\tplist_array_append_item(array, plist_new_string(\"DLMessagePing\"));\n\tplist_array_append_item(array, plist_new_string(message));\n\n\tdevice_link_service_error_t err = DEVICE_LINK_SERVICE_E_SUCCESS;\n\tif (property_list_service_send_binary_plist(client->parent, array) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\terr = DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\tplist_free(array);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "response_type",
            "\"SDMessageDeviceReadyToReceiveChanges\""
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "plist_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/tools/idevicebackup.c",
          "lines": "296-309",
          "snippet": "static int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"common/utils.h\"",
            "#include <libimobiledevice/afc.h>",
            "#include <libimobiledevice/notification_proxy.h>",
            "#include <libimobiledevice/mobilebackup.h>",
            "#include <libimobiledevice/lockdown.h>",
            "#include <libimobiledevice/libimobiledevice.h>",
            "#include <time.h>",
            "#include <ctype.h>",
            "#include <unistd.h>",
            "#include <gcrypt.h>",
            "#include <openssl/sha.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"common/utils.h\"\n#include <libimobiledevice/afc.h>\n#include <libimobiledevice/notification_proxy.h>\n#include <libimobiledevice/mobilebackup.h>\n#include <libimobiledevice/lockdown.h>\n#include <libimobiledevice/libimobiledevice.h>\n#include <time.h>\n#include <ctype.h>\n#include <unistd.h>\n#include <gcrypt.h>\n#include <openssl/sha.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Device cancelled: %s\"",
            "reason"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "plist_array_get_item(msg, 2)",
            "&reason"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "2"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "response_type_node",
            "&response_type"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "0"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_receive",
          "args": [
            "client",
            "&msg"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "115-121",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_ready_to_send_changes_from_computer(mobilesync_client_t client)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tif (client->direction != MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER) {\n\t\treturn MOBILESYNC_E_WRONG_DIRECTION;\n\t}\n\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\tchar *response_type = NULL;\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\n\terr = mobilesync_receive(client, &msg);\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (!strcmp(response_type, \"SDMessageCancelSession\")) {\n\t\tchar *reason = NULL;\n\t\terr = MOBILESYNC_E_CANCELLED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), &reason);\n\t\tdebug_info(\"Device cancelled: %s\", reason);\n\t\tfree(reason);\n\t\tgoto out;\n\t}\n\n\tif (strcmp(response_type, \"SDMessageDeviceReadyToReceiveChanges\") != 0) {\n\t\terr = MOBILESYNC_E_NOT_READY;\n\t\tgoto out;\n\t}\n\n\terr = mobilesync_error(device_link_service_send_ping(client->parent, \"Preparing to get changes for device\"));\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tclient->direction = MOBILESYNC_SYNC_DIR_COMPUTER_TO_DEVICE;\n\terr = MOBILESYNC_E_SUCCESS;\n\n\tout:\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\treturn err;\n}"
  },
  {
    "function_name": "create_process_changes_message",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "505-519",
    "snippet": "static plist_t create_process_changes_message(const char *data_class, plist_t entities, uint8_t more_changes, plist_t actions)\n{\n\tplist_t msg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageProcessChanges\"));\n\tplist_array_append_item(msg, plist_new_string(data_class));\n\tplist_array_append_item(msg, plist_copy(entities));\n\tplist_array_append_item(msg, plist_new_bool(more_changes));\n\n\tif (actions)\n\t\tplist_array_append_item(msg, plist_copy(actions));\n\telse\n\t\tplist_array_append_item(msg, plist_new_string(EMPTY_PARAMETER_STRING));\n\n\treturn msg;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [
      "#define EMPTY_PARAMETER_STRING \"___EmptyParameterString___\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(EMPTY_PARAMETER_STRING)"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "EMPTY_PARAMETER_STRING"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_copy(actions)"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_copy",
          "args": [
            "actions"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_bool(more_changes)"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_bool",
          "args": [
            "more_changes"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_copy(entities)"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_copy",
          "args": [
            "entities"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(data_class)"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "data_class"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(\"SDMessageProcessChanges\")"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"SDMessageProcessChanges\""
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_array",
          "args": [],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\n#define EMPTY_PARAMETER_STRING \"___EmptyParameterString___\"\n\nstatic plist_t create_process_changes_message(const char *data_class, plist_t entities, uint8_t more_changes, plist_t actions)\n{\n\tplist_t msg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageProcessChanges\"));\n\tplist_array_append_item(msg, plist_new_string(data_class));\n\tplist_array_append_item(msg, plist_copy(entities));\n\tplist_array_append_item(msg, plist_new_bool(more_changes));\n\n\tif (actions)\n\t\tplist_array_append_item(msg, plist_copy(actions));\n\telse\n\t\tplist_array_append_item(msg, plist_new_string(EMPTY_PARAMETER_STRING));\n\n\treturn msg;\n}"
  },
  {
    "function_name": "mobilesync_acknowledge_changes_from_device",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "487-503",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_acknowledge_changes_from_device(mobilesync_client_t client)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tplist_t msg = NULL;\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageAcknowledgeChangesFromDevice\"));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\n\terr = mobilesync_send(client, msg);\n\tplist_free(msg);\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_send",
          "args": [
            "client",
            "msg"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "123-128",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(client->data_class)"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "client->data_class"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(\"SDMessageAcknowledgeChangesFromDevice\")"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"SDMessageAcknowledgeChangesFromDevice\""
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_array",
          "args": [],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_acknowledge_changes_from_device(mobilesync_client_t client)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tplist_t msg = NULL;\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageAcknowledgeChangesFromDevice\"));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\n\terr = mobilesync_send(client, msg);\n\tplist_free(msg);\n\treturn err;\n}"
  },
  {
    "function_name": "mobilesync_clear_all_records_on_device",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "418-485",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_clear_all_records_on_device(mobilesync_client_t client)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\tchar *response_type = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageClearAllRecordsOnDevice\"));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\tplist_array_append_item(msg, plist_new_string(EMPTY_PARAMETER_STRING));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tplist_free(msg);\n\tmsg = NULL;\n\n\terr = mobilesync_receive(client, &msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (!strcmp(response_type, \"SDMessageCancelSession\")) {\n\t\tchar *reason = NULL;\n\t\terr = MOBILESYNC_E_CANCELLED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), &reason);\n\t\tdebug_info(\"Device cancelled: %s\", reason);\n\t\tfree(reason);\n\t\tgoto out;\n\t}\n\n\tif (strcmp(response_type, \"SDMessageDeviceWillClearAllRecords\")) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t}\n\n\tout:\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [
      "#define EMPTY_PARAMETER_STRING \"___EmptyParameterString___\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "response_type"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_actions_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "779-785",
          "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "response_type",
            "\"SDMessageDeviceWillClearAllRecords\""
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "plist_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/tools/idevicebackup.c",
          "lines": "296-309",
          "snippet": "static int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"common/utils.h\"",
            "#include <libimobiledevice/afc.h>",
            "#include <libimobiledevice/notification_proxy.h>",
            "#include <libimobiledevice/mobilebackup.h>",
            "#include <libimobiledevice/lockdown.h>",
            "#include <libimobiledevice/libimobiledevice.h>",
            "#include <time.h>",
            "#include <ctype.h>",
            "#include <unistd.h>",
            "#include <gcrypt.h>",
            "#include <openssl/sha.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"common/utils.h\"\n#include <libimobiledevice/afc.h>\n#include <libimobiledevice/notification_proxy.h>\n#include <libimobiledevice/mobilebackup.h>\n#include <libimobiledevice/lockdown.h>\n#include <libimobiledevice/libimobiledevice.h>\n#include <time.h>\n#include <ctype.h>\n#include <unistd.h>\n#include <gcrypt.h>\n#include <openssl/sha.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Device cancelled: %s\"",
            "reason"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "plist_array_get_item(msg, 2)",
            "&reason"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "2"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "response_type_node",
            "&response_type"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "0"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_receive",
          "args": [
            "client",
            "&msg"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "115-121",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_send",
          "args": [
            "client",
            "msg"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "123-128",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(EMPTY_PARAMETER_STRING)"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "EMPTY_PARAMETER_STRING"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(client->data_class)"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "client->data_class"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(\"SDMessageClearAllRecordsOnDevice\")"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"SDMessageClearAllRecordsOnDevice\""
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_array",
          "args": [],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\n#define EMPTY_PARAMETER_STRING \"___EmptyParameterString___\"\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_clear_all_records_on_device(mobilesync_client_t client)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\tchar *response_type = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageClearAllRecordsOnDevice\"));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\tplist_array_append_item(msg, plist_new_string(EMPTY_PARAMETER_STRING));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tplist_free(msg);\n\tmsg = NULL;\n\n\terr = mobilesync_receive(client, &msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (!strcmp(response_type, \"SDMessageCancelSession\")) {\n\t\tchar *reason = NULL;\n\t\terr = MOBILESYNC_E_CANCELLED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), &reason);\n\t\tdebug_info(\"Device cancelled: %s\", reason);\n\t\tfree(reason);\n\t\tgoto out;\n\t}\n\n\tif (strcmp(response_type, \"SDMessageDeviceWillClearAllRecords\")) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t}\n\n\tout:\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\treturn err;\n}"
  },
  {
    "function_name": "mobilesync_receive_changes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "351-416",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive_changes(mobilesync_client_t client, plist_t *entities, uint8_t *is_last_record, plist_t *actions)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\tplist_t actions_node = NULL;\n\tchar *response_type = NULL;\n\tuint8_t has_more_changes = 0;\n\n\tmobilesync_error_t err = mobilesync_receive(client, &msg);\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (!strcmp(response_type, \"SDMessageCancelSession\")) {\n\t\tchar *reason = NULL;\n\t\terr = MOBILESYNC_E_CANCELLED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), &reason);\n\t\tdebug_info(\"Device cancelled: %s\", reason);\n\t\tfree(reason);\n\t\tgoto out;\n\t}\n\n\tif (entities != NULL) {\n\t\t*entities = plist_copy(plist_array_get_item(msg, 2));\n\t}\n\n\tif (is_last_record != NULL) {\n\t\tplist_get_bool_val(plist_array_get_item(msg, 3), &has_more_changes);\n\t\t*is_last_record = (has_more_changes > 0 ? 0 : 1);\n\t}\n\n\tif (actions != NULL) {\n\t\tactions_node = plist_array_get_item(msg, 4);\n\t\tif (plist_get_node_type(actions_node) == PLIST_DICT)\n\t\t\t*actions = plist_copy(actions_node);\n\t\telse\n\t\t\t*actions = NULL;\n\t}\n\n\tout:\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "response_type"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_actions_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "779-785",
          "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_copy",
          "args": [
            "actions_node"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_node_type",
          "args": [
            "actions_node"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "4"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_bool_val",
          "args": [
            "plist_array_get_item(msg, 3)",
            "&has_more_changes"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "3"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_copy",
          "args": [
            "plist_array_get_item(msg, 2)"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "2"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Device cancelled: %s\"",
            "reason"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "plist_array_get_item(msg, 2)",
            "&reason"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "2"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "response_type",
            "\"SDMessageCancelSession\""
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "plist_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/tools/idevicebackup.c",
          "lines": "296-309",
          "snippet": "static int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"common/utils.h\"",
            "#include <libimobiledevice/afc.h>",
            "#include <libimobiledevice/notification_proxy.h>",
            "#include <libimobiledevice/mobilebackup.h>",
            "#include <libimobiledevice/lockdown.h>",
            "#include <libimobiledevice/libimobiledevice.h>",
            "#include <time.h>",
            "#include <ctype.h>",
            "#include <unistd.h>",
            "#include <gcrypt.h>",
            "#include <openssl/sha.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"common/utils.h\"\n#include <libimobiledevice/afc.h>\n#include <libimobiledevice/notification_proxy.h>\n#include <libimobiledevice/mobilebackup.h>\n#include <libimobiledevice/lockdown.h>\n#include <libimobiledevice/libimobiledevice.h>\n#include <time.h>\n#include <ctype.h>\n#include <unistd.h>\n#include <gcrypt.h>\n#include <openssl/sha.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "response_type_node",
            "&response_type"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "0"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_receive",
          "args": [
            "client",
            "&msg"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "115-121",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive_changes(mobilesync_client_t client, plist_t *entities, uint8_t *is_last_record, plist_t *actions)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\tplist_t actions_node = NULL;\n\tchar *response_type = NULL;\n\tuint8_t has_more_changes = 0;\n\n\tmobilesync_error_t err = mobilesync_receive(client, &msg);\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (!strcmp(response_type, \"SDMessageCancelSession\")) {\n\t\tchar *reason = NULL;\n\t\terr = MOBILESYNC_E_CANCELLED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), &reason);\n\t\tdebug_info(\"Device cancelled: %s\", reason);\n\t\tfree(reason);\n\t\tgoto out;\n\t}\n\n\tif (entities != NULL) {\n\t\t*entities = plist_copy(plist_array_get_item(msg, 2));\n\t}\n\n\tif (is_last_record != NULL) {\n\t\tplist_get_bool_val(plist_array_get_item(msg, 3), &has_more_changes);\n\t\t*is_last_record = (has_more_changes > 0 ? 0 : 1);\n\t}\n\n\tif (actions != NULL) {\n\t\tactions_node = plist_array_get_item(msg, 4);\n\t\tif (plist_get_node_type(actions_node) == PLIST_DICT)\n\t\t\t*actions = plist_copy(actions_node);\n\t\telse\n\t\t\t*actions = NULL;\n\t}\n\n\tout:\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\treturn err;\n}"
  },
  {
    "function_name": "mobilesync_get_changes_from_device",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "346-349",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_get_changes_from_device(mobilesync_client_t client)\n{\n\treturn mobilesync_get_records(client, \"SDMessageGetChangesFromDevice\");\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mobilesync_get_records",
          "args": [
            "client",
            "\"SDMessageGetChangesFromDevice\""
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_get_records",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "319-339",
          "snippet": "static mobilesync_error_t mobilesync_get_records(mobilesync_client_t client, const char *operation)\n{\n\tif (!client || !client->data_class || !operation) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(operation));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nstatic mobilesync_error_t mobilesync_get_records(mobilesync_client_t client, const char *operation)\n{\n\tif (!client || !client->data_class || !operation) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(operation));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_get_changes_from_device(mobilesync_client_t client)\n{\n\treturn mobilesync_get_records(client, \"SDMessageGetChangesFromDevice\");\n}"
  },
  {
    "function_name": "mobilesync_get_all_records_from_device",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "341-344",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_get_all_records_from_device(mobilesync_client_t client)\n{\n\treturn mobilesync_get_records(client, \"SDMessageGetAllRecordsFromDevice\");\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mobilesync_get_records",
          "args": [
            "client",
            "\"SDMessageGetAllRecordsFromDevice\""
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_get_records",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "319-339",
          "snippet": "static mobilesync_error_t mobilesync_get_records(mobilesync_client_t client, const char *operation)\n{\n\tif (!client || !client->data_class || !operation) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(operation));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nstatic mobilesync_error_t mobilesync_get_records(mobilesync_client_t client, const char *operation)\n{\n\tif (!client || !client->data_class || !operation) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(operation));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_get_all_records_from_device(mobilesync_client_t client)\n{\n\treturn mobilesync_get_records(client, \"SDMessageGetAllRecordsFromDevice\");\n}"
  },
  {
    "function_name": "mobilesync_get_records",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "319-339",
    "snippet": "static mobilesync_error_t mobilesync_get_records(mobilesync_client_t client, const char *operation)\n{\n\tif (!client || !client->data_class || !operation) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(operation));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_send",
          "args": [
            "client",
            "msg"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "123-128",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(client->data_class)"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "client->data_class"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(operation)"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "operation"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_array",
          "args": [],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nstatic mobilesync_error_t mobilesync_get_records(mobilesync_client_t client, const char *operation)\n{\n\tif (!client || !client->data_class || !operation) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tplist_t msg = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(operation));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\treturn err;\n}"
  },
  {
    "function_name": "mobilesync_finish",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "256-317",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_finish(mobilesync_client_t client)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\tchar *response_type = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageFinishSessionOnDevice\"));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tplist_free(msg);\n\tmsg = NULL;\n\n\terr = mobilesync_receive(client, &msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (!strcmp(response_type, \"SDMessageDeviceFinishedSession\")) {\n\t\terr = MOBILESYNC_E_SUCCESS;\n\t}\n\n\tout:\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\tfree(client->data_class);\n\tclient->data_class = NULL;\n\tclient->direction = MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER;\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "client->data_class"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_actions_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "779-785",
          "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "response_type",
            "\"SDMessageDeviceFinishedSession\""
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "plist_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/tools/idevicebackup.c",
          "lines": "296-309",
          "snippet": "static int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"common/utils.h\"",
            "#include <libimobiledevice/afc.h>",
            "#include <libimobiledevice/notification_proxy.h>",
            "#include <libimobiledevice/mobilebackup.h>",
            "#include <libimobiledevice/lockdown.h>",
            "#include <libimobiledevice/libimobiledevice.h>",
            "#include <time.h>",
            "#include <ctype.h>",
            "#include <unistd.h>",
            "#include <gcrypt.h>",
            "#include <openssl/sha.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"common/utils.h\"\n#include <libimobiledevice/afc.h>\n#include <libimobiledevice/notification_proxy.h>\n#include <libimobiledevice/mobilebackup.h>\n#include <libimobiledevice/lockdown.h>\n#include <libimobiledevice/libimobiledevice.h>\n#include <time.h>\n#include <ctype.h>\n#include <unistd.h>\n#include <gcrypt.h>\n#include <openssl/sha.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "response_type_node",
            "&response_type"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "0"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_receive",
          "args": [
            "client",
            "&msg"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "115-121",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_send",
          "args": [
            "client",
            "msg"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "123-128",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(client->data_class)"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "client->data_class"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(\"SDMessageFinishSessionOnDevice\")"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"SDMessageFinishSessionOnDevice\""
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_array",
          "args": [],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_finish(mobilesync_client_t client)\n{\n\tif (!client || !client->data_class) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\tchar *response_type = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageFinishSessionOnDevice\"));\n\tplist_array_append_item(msg, plist_new_string(client->data_class));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tplist_free(msg);\n\tmsg = NULL;\n\n\terr = mobilesync_receive(client, &msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tif (!strcmp(response_type, \"SDMessageDeviceFinishedSession\")) {\n\t\terr = MOBILESYNC_E_SUCCESS;\n\t}\n\n\tout:\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\tfree(client->data_class);\n\tclient->data_class = NULL;\n\tclient->direction = MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER;\n\treturn err;\n}"
  },
  {
    "function_name": "mobilesync_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "130-254",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_start(mobilesync_client_t client, const char *data_class, mobilesync_anchors_t anchors, uint64_t computer_data_class_version, mobilesync_sync_type_t *sync_type, uint64_t *device_data_class_version, char** error_description)\n{\n\tif (!client || client->data_class || !data_class ||\n\t\t!anchors || !anchors->computer_anchor) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tchar *response_type = NULL;\n\tchar *sync_type_str = NULL;\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\n\t*error_description = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageSyncDataClassWithDevice\"));\n\tplist_array_append_item(msg, plist_new_string(data_class));\n\tif (anchors->device_anchor) {\n\t\tplist_array_append_item(msg, plist_new_string(anchors->device_anchor));\n\t} else {\n\t\tplist_array_append_item(msg, plist_new_string(\"---\"));\n\t}\n\tplist_array_append_item(msg, plist_new_string(anchors->computer_anchor));\n\tplist_array_append_item(msg, plist_new_uint(computer_data_class_version));\n\tplist_array_append_item(msg, plist_new_string(EMPTY_PARAMETER_STRING));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tplist_free(msg);\n\tmsg = NULL;\n\n\terr = mobilesync_receive(client, &msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\t// did the device refuse to sync with the computer?\n\tif (!strcmp(response_type, \"SDMessageRefuseToSyncDataClassWithComputer\")) {\n\t\terr = MOBILESYNC_E_SYNC_REFUSED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), error_description);\n\t\tdebug_info(\"Device refused sync: %s\", error_description);\n\t\tgoto out;\n\t}\n\n\t// did the device cancel the session?\n\tif (!strcmp(response_type, \"SDMessageCancelSession\")) {\n\t\terr = MOBILESYNC_E_CANCELLED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), error_description);\n\t\tdebug_info(\"Device cancelled: %s\", error_description);\n\t\tgoto out;\n\t}\n\n\tif (sync_type != NULL) {\n\t\tplist_t sync_type_node = plist_array_get_item(msg, 4);\n\t\tif (!sync_type_node) {\n\t\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\t\tgoto out;\n\t\t}\n\n\t\tplist_get_string_val(sync_type_node, &sync_type_str);\n\t\tif (!sync_type_str) {\n\t\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\t\tgoto out;\n\t\t}\n\n\t\tif (!strcmp(sync_type_str, \"SDSyncTypeFast\")) {\n\t\t\t*sync_type = MOBILESYNC_SYNC_TYPE_FAST;\n\t\t} else if (!strcmp(sync_type_str, \"SDSyncTypeSlow\")) {\n\t\t\t*sync_type = MOBILESYNC_SYNC_TYPE_SLOW;\n\t\t} else if (!strcmp(sync_type_str, \"SDSyncTypeReset\")) {\n\t\t\t*sync_type = MOBILESYNC_SYNC_TYPE_RESET;\n\t\t} else {\n\t\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tif (device_data_class_version != NULL) {\n\t\tplist_t device_data_class_version_node = plist_array_get_item(msg, 5);\n\t\tif (!device_data_class_version_node) {\n\t\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\t\tgoto out;\n\t\t}\n\n\t\tplist_get_uint_val(device_data_class_version_node, device_data_class_version);\n\t}\n\n\terr = MOBILESYNC_E_SUCCESS;\n\n\tout:\n\tif (sync_type_str) {\n\t\tfree(sync_type_str);\n\t\tsync_type_str = NULL;\n\t}\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\tclient->data_class = strdup(data_class);\n\tclient->direction = MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER;\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [
      "#define EMPTY_PARAMETER_STRING \"___EmptyParameterString___\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "data_class"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "response_type"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_actions_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "779-785",
          "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_get_uint_val",
          "args": [
            "device_data_class_version_node",
            "device_data_class_version"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "5"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "sync_type_str",
            "\"SDSyncTypeReset\""
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "plist_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/tools/idevicebackup.c",
          "lines": "296-309",
          "snippet": "static int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"common/utils.h\"",
            "#include <libimobiledevice/afc.h>",
            "#include <libimobiledevice/notification_proxy.h>",
            "#include <libimobiledevice/mobilebackup.h>",
            "#include <libimobiledevice/lockdown.h>",
            "#include <libimobiledevice/libimobiledevice.h>",
            "#include <time.h>",
            "#include <ctype.h>",
            "#include <unistd.h>",
            "#include <gcrypt.h>",
            "#include <openssl/sha.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"common/utils.h\"\n#include <libimobiledevice/afc.h>\n#include <libimobiledevice/notification_proxy.h>\n#include <libimobiledevice/mobilebackup.h>\n#include <libimobiledevice/lockdown.h>\n#include <libimobiledevice/libimobiledevice.h>\n#include <time.h>\n#include <ctype.h>\n#include <unistd.h>\n#include <gcrypt.h>\n#include <openssl/sha.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "sync_type_node",
            "&sync_type_str"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "4"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Device cancelled: %s\"",
            "error_description"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "plist_array_get_item(msg, 2)",
            "error_description"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "2"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Device refused sync: %s\"",
            "error_description"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "plist_array_get_item(msg, 2)",
            "error_description"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "2"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_string_val",
          "args": [
            "response_type_node",
            "&response_type"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_get_item",
          "args": [
            "msg",
            "0"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_receive",
          "args": [
            "client",
            "&msg"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "115-121",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "msg"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_send",
          "args": [
            "client",
            "msg"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "123-128",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(EMPTY_PARAMETER_STRING)"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "EMPTY_PARAMETER_STRING"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_uint(computer_data_class_version)"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_uint",
          "args": [
            "computer_data_class_version"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(anchors->computer_anchor)"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "anchors->computer_anchor"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(\"---\")"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"---\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(anchors->device_anchor)"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "anchors->device_anchor"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(data_class)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "data_class"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_array_append_item",
          "args": [
            "msg",
            "plist_new_string(\"SDMessageSyncDataClassWithDevice\")"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"SDMessageSyncDataClassWithDevice\""
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_array",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\n#define EMPTY_PARAMETER_STRING \"___EmptyParameterString___\"\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_start(mobilesync_client_t client, const char *data_class, mobilesync_anchors_t anchors, uint64_t computer_data_class_version, mobilesync_sync_type_t *sync_type, uint64_t *device_data_class_version, char** error_description)\n{\n\tif (!client || client->data_class || !data_class ||\n\t\t!anchors || !anchors->computer_anchor) {\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t}\n\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tchar *response_type = NULL;\n\tchar *sync_type_str = NULL;\n\tplist_t msg = NULL;\n\tplist_t response_type_node = NULL;\n\n\t*error_description = NULL;\n\n\tmsg = plist_new_array();\n\tplist_array_append_item(msg, plist_new_string(\"SDMessageSyncDataClassWithDevice\"));\n\tplist_array_append_item(msg, plist_new_string(data_class));\n\tif (anchors->device_anchor) {\n\t\tplist_array_append_item(msg, plist_new_string(anchors->device_anchor));\n\t} else {\n\t\tplist_array_append_item(msg, plist_new_string(\"---\"));\n\t}\n\tplist_array_append_item(msg, plist_new_string(anchors->computer_anchor));\n\tplist_array_append_item(msg, plist_new_uint(computer_data_class_version));\n\tplist_array_append_item(msg, plist_new_string(EMPTY_PARAMETER_STRING));\n\n\terr = mobilesync_send(client, msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tplist_free(msg);\n\tmsg = NULL;\n\n\terr = mobilesync_receive(client, &msg);\n\n\tif (err != MOBILESYNC_E_SUCCESS) {\n\t\tgoto out;\n\t}\n\n\tresponse_type_node = plist_array_get_item(msg, 0);\n\tif (!response_type_node) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\tplist_get_string_val(response_type_node, &response_type);\n\tif (!response_type) {\n\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\tgoto out;\n\t}\n\n\t// did the device refuse to sync with the computer?\n\tif (!strcmp(response_type, \"SDMessageRefuseToSyncDataClassWithComputer\")) {\n\t\terr = MOBILESYNC_E_SYNC_REFUSED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), error_description);\n\t\tdebug_info(\"Device refused sync: %s\", error_description);\n\t\tgoto out;\n\t}\n\n\t// did the device cancel the session?\n\tif (!strcmp(response_type, \"SDMessageCancelSession\")) {\n\t\terr = MOBILESYNC_E_CANCELLED;\n\t\tplist_get_string_val(plist_array_get_item(msg, 2), error_description);\n\t\tdebug_info(\"Device cancelled: %s\", error_description);\n\t\tgoto out;\n\t}\n\n\tif (sync_type != NULL) {\n\t\tplist_t sync_type_node = plist_array_get_item(msg, 4);\n\t\tif (!sync_type_node) {\n\t\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\t\tgoto out;\n\t\t}\n\n\t\tplist_get_string_val(sync_type_node, &sync_type_str);\n\t\tif (!sync_type_str) {\n\t\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\t\tgoto out;\n\t\t}\n\n\t\tif (!strcmp(sync_type_str, \"SDSyncTypeFast\")) {\n\t\t\t*sync_type = MOBILESYNC_SYNC_TYPE_FAST;\n\t\t} else if (!strcmp(sync_type_str, \"SDSyncTypeSlow\")) {\n\t\t\t*sync_type = MOBILESYNC_SYNC_TYPE_SLOW;\n\t\t} else if (!strcmp(sync_type_str, \"SDSyncTypeReset\")) {\n\t\t\t*sync_type = MOBILESYNC_SYNC_TYPE_RESET;\n\t\t} else {\n\t\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tif (device_data_class_version != NULL) {\n\t\tplist_t device_data_class_version_node = plist_array_get_item(msg, 5);\n\t\tif (!device_data_class_version_node) {\n\t\t\terr = MOBILESYNC_E_PLIST_ERROR;\n\t\t\tgoto out;\n\t\t}\n\n\t\tplist_get_uint_val(device_data_class_version_node, device_data_class_version);\n\t}\n\n\terr = MOBILESYNC_E_SUCCESS;\n\n\tout:\n\tif (sync_type_str) {\n\t\tfree(sync_type_str);\n\t\tsync_type_str = NULL;\n\t}\n\tif (response_type) {\n\t\tfree(response_type);\n\t\tresponse_type = NULL;\n\t}\n\tif (msg) {\n\t\tplist_free(msg);\n\t\tmsg = NULL;\n\t}\n\n\tclient->data_class = strdup(data_class);\n\tclient->direction = MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER;\n\treturn err;\n}"
  },
  {
    "function_name": "mobilesync_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "123-128",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mobilesync_error",
          "args": [
            "device_link_service_send(client->parent, plist)"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "49-66",
          "snippet": "static mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nstatic mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_link_service_send",
          "args": [
            "client->parent",
            "plist"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "device_link_service_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/device_link_service.c",
          "lines": "430-439",
          "snippet": "device_link_service_error_t device_link_service_send(device_link_service_client_t client, plist_t plist)\n{\n\tif (!client || !plist) {\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\t}\n\tif (property_list_service_send_binary_plist(client->parent, plist) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"device_link_service.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"device_link_service.h\"\n#include <stdlib.h>\n#include <string.h>\n\ndevice_link_service_error_t device_link_service_send(device_link_service_client_t client, plist_t plist)\n{\n\tif (!client || !plist) {\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\t}\n\tif (property_list_service_send_binary_plist(client->parent, plist) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_send(mobilesync_client_t client, plist_t plist)\n{\n\tif (!client || !plist)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\treturn mobilesync_error(device_link_service_send(client->parent, plist));\n}"
  },
  {
    "function_name": "mobilesync_receive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "115-121",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mobilesync_error",
          "args": [
            "device_link_service_receive(client->parent, plist)"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "49-66",
          "snippet": "static mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nstatic mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_link_service_receive",
          "args": [
            "client->parent",
            "plist"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "device_link_service_receive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/device_link_service.c",
          "lines": "452-462",
          "snippet": "device_link_service_error_t device_link_service_receive(device_link_service_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist)) {\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\t}\n\n\tif (property_list_service_receive_plist(client->parent, plist) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"device_link_service.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"device_link_service.h\"\n#include <stdlib.h>\n#include <string.h>\n\ndevice_link_service_error_t device_link_service_receive(device_link_service_client_t client, plist_t *plist)\n{\n\tif (!client || !plist || (plist && *plist)) {\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\t}\n\n\tif (property_list_service_receive_plist(client->parent, plist) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_receive(mobilesync_client_t client, plist_t * plist)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_receive(client->parent, plist));\n\treturn ret;\n}"
  },
  {
    "function_name": "mobilesync_client_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "105-113",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_client_free(mobilesync_client_t client)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tdevice_link_service_disconnect(client->parent, \"All done, thanks for the memories\");\n\tmobilesync_error_t err = mobilesync_error(device_link_service_client_free(client->parent));\n\tfree(client);\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "client"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_actions_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "779-785",
          "snippet": "LIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API void mobilesync_actions_free(plist_t actions)\n{\n\tif (actions) {\n\t\tplist_free(actions);\n\t\tactions = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mobilesync_error",
          "args": [
            "device_link_service_client_free(client->parent)"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "49-66",
          "snippet": "static mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nstatic mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_link_service_client_free",
          "args": [
            "client->parent"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "device_link_service_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/device_link_service.c",
          "lines": "119-129",
          "snippet": "device_link_service_error_t device_link_service_client_free(device_link_service_client_t client)\n{\n\tif (!client)\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\n\tif (property_list_service_client_free(client->parent) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_UNKNOWN_ERROR;\n\t}\n\tfree(client);\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"device_link_service.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"device_link_service.h\"\n#include <stdlib.h>\n#include <string.h>\n\ndevice_link_service_error_t device_link_service_client_free(device_link_service_client_t client)\n{\n\tif (!client)\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\n\tif (property_list_service_client_free(client->parent) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_UNKNOWN_ERROR;\n\t}\n\tfree(client);\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_link_service_disconnect",
          "args": [
            "client->parent",
            "\"All done, thanks for the memories\""
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "device_link_service_disconnect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/device_link_service.c",
          "lines": "249-267",
          "snippet": "device_link_service_error_t device_link_service_disconnect(device_link_service_client_t client, const char *message)\n{\n\tif (!client)\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\n\tplist_t array = plist_new_array();\n\tplist_array_append_item(array, plist_new_string(\"DLMessageDisconnect\"));\n\tif (message)\n\t\tplist_array_append_item(array, plist_new_string(message));\n\telse\n\t\tplist_array_append_item(array, plist_new_string(\"___EmptyParameterString___\"));\n\n\tdevice_link_service_error_t err = DEVICE_LINK_SERVICE_E_SUCCESS;\n\tif (property_list_service_send_binary_plist(client->parent, array) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\terr = DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\tplist_free(array);\n\treturn err;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"device_link_service.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"device_link_service.h\"\n#include <stdlib.h>\n#include <string.h>\n\ndevice_link_service_error_t device_link_service_disconnect(device_link_service_client_t client, const char *message)\n{\n\tif (!client)\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\n\tplist_t array = plist_new_array();\n\tplist_array_append_item(array, plist_new_string(\"DLMessageDisconnect\"));\n\tif (message)\n\t\tplist_array_append_item(array, plist_new_string(message));\n\telse\n\t\tplist_array_append_item(array, plist_new_string(\"___EmptyParameterString___\"));\n\n\tdevice_link_service_error_t err = DEVICE_LINK_SERVICE_E_SUCCESS;\n\tif (property_list_service_send_binary_plist(client->parent, array) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\terr = DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\tplist_free(array);\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_client_free(mobilesync_client_t client)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tdevice_link_service_disconnect(client->parent, \"All done, thanks for the memories\");\n\tmobilesync_error_t err = mobilesync_error(device_link_service_client_free(client->parent));\n\tfree(client);\n\treturn err;\n}"
  },
  {
    "function_name": "mobilesync_client_start_service",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "98-103",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_client_start_service(idevice_t device, mobilesync_client_t * client, const char* label)\n{\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, MOBILESYNC_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(mobilesync_client_new), &err);\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_client_factory_start_service",
          "args": [
            "device",
            "MOBILESYNC_SERVICE_NAME",
            "(void**)client",
            "label",
            "SERVICE_CONSTRUCTOR(mobilesync_client_new)",
            "&err"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "service_client_factory_start_service",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/service.c",
          "lines": "79-116",
          "snippet": "LIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"idevice.h\"",
            "#include \"service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"idevice.h\"\n#include \"service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SERVICE_CONSTRUCTOR",
          "args": [
            "mobilesync_client_new"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_client_start_service(idevice_t device, mobilesync_client_t * client, const char* label)\n{\n\tmobilesync_error_t err = MOBILESYNC_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, MOBILESYNC_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(mobilesync_client_new), &err);\n\treturn err;\n}"
  },
  {
    "function_name": "mobilesync_client_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "68-96",
    "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_client_new(idevice_t device, lockdownd_service_descriptor_t service,\n\t\t\t\t\t\t   mobilesync_client_t * client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\n\tdevice_link_service_client_t dlclient = NULL;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_client_new(device, service, &dlclient));\n\tif (ret != MOBILESYNC_E_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\tmobilesync_client_t client_loc = (mobilesync_client_t) malloc(sizeof(struct mobilesync_client_private));\n\tclient_loc->parent = dlclient;\n\tclient_loc->direction = MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER;\n\tclient_loc->data_class = NULL;\n\n\t/* perform handshake */\n\tret = mobilesync_error(device_link_service_version_exchange(dlclient, MSYNC_VERSION_INT1, MSYNC_VERSION_INT2));\n\tif (ret != MOBILESYNC_E_SUCCESS) {\n\t\tdebug_info(\"version exchange failed, error %d\", ret);\n\t\tmobilesync_client_free(client_loc);\n\t\treturn ret;\n\t}\n\n\t*client = client_loc;\n\n\treturn ret;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [
      "#define MSYNC_VERSION_INT2 100",
      "#define MSYNC_VERSION_INT1 300"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mobilesync_client_free",
          "args": [
            "client_loc"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "105-113",
          "snippet": "LIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_client_free(mobilesync_client_t client)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tdevice_link_service_disconnect(client->parent, \"All done, thanks for the memories\");\n\tmobilesync_error_t err = mobilesync_error(device_link_service_client_free(client->parent));\n\tfree(client);\n\treturn err;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_client_free(mobilesync_client_t client)\n{\n\tif (!client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\tdevice_link_service_disconnect(client->parent, \"All done, thanks for the memories\");\n\tmobilesync_error_t err = mobilesync_error(device_link_service_client_free(client->parent));\n\tfree(client);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"version exchange failed, error %d\"",
            "ret"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mobilesync_error",
          "args": [
            "device_link_service_version_exchange(dlclient, MSYNC_VERSION_INT1, MSYNC_VERSION_INT2)"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "mobilesync_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
          "lines": "49-66",
          "snippet": "static mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"device_link_service.h\"",
            "#include \"mobilesync.h\"",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <plist/plist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nstatic mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_link_service_version_exchange",
          "args": [
            "dlclient",
            "MSYNC_VERSION_INT1",
            "MSYNC_VERSION_INT2"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "device_link_service_version_exchange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/device_link_service.c",
          "lines": "148-236",
          "snippet": "device_link_service_error_t device_link_service_version_exchange(device_link_service_client_t client, uint64_t version_major, uint64_t version_minor)\n{\n\tif (!client)\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\n\tdevice_link_service_error_t err = DEVICE_LINK_SERVICE_E_UNKNOWN_ERROR;\n\n\t/* perform version exchange */\n\tplist_t array = NULL;\n\tchar *msg = NULL;\n\n\t/* receive DLMessageVersionExchange from device */\n\tif (property_list_service_receive_plist(client->parent, &array) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Did not receive initial message from device!\");\n\t\terr = DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t\tgoto leave;\n\t}\n\tdevice_link_service_get_message(array, &msg);\n\tif (!msg || strcmp(msg, \"DLMessageVersionExchange\")) {\n\t\tdebug_info(\"Did not receive DLMessageVersionExchange from device!\");\n\t\terr = DEVICE_LINK_SERVICE_E_PLIST_ERROR;\n\t\tgoto leave;\n\t}\n\tfree(msg);\n\tmsg = NULL;\n\n\t/* get major and minor version number */\n\tif (plist_array_get_size(array) < 3) {\n\t\tdebug_info(\"DLMessageVersionExchange has unexpected format!\");\n\t\terr = DEVICE_LINK_SERVICE_E_PLIST_ERROR;\n\t\tgoto leave;\n\t}\n\tplist_t maj = plist_array_get_item(array, 1);\n\tplist_t min = plist_array_get_item(array, 2);\n\tuint64_t vmajor = 0;\n\tuint64_t vminor = 0;\n\tif (maj) {\n\t\tplist_get_uint_val(maj, &vmajor);\n\t}\n\tif (min) {\n\t\tplist_get_uint_val(min, &vminor);\n\t}\n\tif (vmajor > version_major) {\n\t\tdebug_info(\"Version mismatch: device=(%lld,%lld) > expected=(%lld,%lld)\", vmajor, vminor, version_major, version_minor);\n\t\terr = DEVICE_LINK_SERVICE_E_BAD_VERSION;\n\t\tgoto leave;\n\t} else if ((vmajor == version_major) && (vminor > version_minor)) {\n\t\tdebug_info(\"WARNING: Version mismatch: device=(%lld,%lld) > expected=(%lld,%lld)\", vmajor, vminor, version_major, version_minor);\n\t\terr = DEVICE_LINK_SERVICE_E_BAD_VERSION;\n\t\tgoto leave;\n\t}\n\tplist_free(array);\n\n\t/* version is ok, send reply */\n\tarray = plist_new_array();\n\tplist_array_append_item(array, plist_new_string(\"DLMessageVersionExchange\"));\n\tplist_array_append_item(array, plist_new_string(\"DLVersionsOk\"));\n\tplist_array_append_item(array, plist_new_uint(version_major));\n\tif (property_list_service_send_binary_plist(client->parent, array) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Error when sending DLVersionsOk\");\n\t\terr = DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t\tgoto leave;\n\t}\n\tplist_free(array);\n\n\t/* receive DeviceReady message */\n\tarray = NULL;\n\tif (property_list_service_receive_plist(client->parent, &array) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Error when receiving DLMessageDeviceReady!\");\n\t\terr = DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t\tgoto leave;\n\t}\n\tdevice_link_service_get_message(array, &msg);\n\tif (!msg || strcmp(msg, \"DLMessageDeviceReady\")) {\n\t\tdebug_info(\"Did not get DLMessageDeviceReady!\");\n\t\terr = DEVICE_LINK_SERVICE_E_PLIST_ERROR;\n\t\tgoto leave;\n\t}\n\terr = DEVICE_LINK_SERVICE_E_SUCCESS;\n\nleave:\n\tif (msg) {\n\t\tfree(msg);\n\t}\n\tif (array) {\n\t\tplist_free(array);\n\t}\n\treturn err;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"device_link_service.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"device_link_service.h\"\n#include <stdlib.h>\n#include <string.h>\n\ndevice_link_service_error_t device_link_service_version_exchange(device_link_service_client_t client, uint64_t version_major, uint64_t version_minor)\n{\n\tif (!client)\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\n\tdevice_link_service_error_t err = DEVICE_LINK_SERVICE_E_UNKNOWN_ERROR;\n\n\t/* perform version exchange */\n\tplist_t array = NULL;\n\tchar *msg = NULL;\n\n\t/* receive DLMessageVersionExchange from device */\n\tif (property_list_service_receive_plist(client->parent, &array) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Did not receive initial message from device!\");\n\t\terr = DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t\tgoto leave;\n\t}\n\tdevice_link_service_get_message(array, &msg);\n\tif (!msg || strcmp(msg, \"DLMessageVersionExchange\")) {\n\t\tdebug_info(\"Did not receive DLMessageVersionExchange from device!\");\n\t\terr = DEVICE_LINK_SERVICE_E_PLIST_ERROR;\n\t\tgoto leave;\n\t}\n\tfree(msg);\n\tmsg = NULL;\n\n\t/* get major and minor version number */\n\tif (plist_array_get_size(array) < 3) {\n\t\tdebug_info(\"DLMessageVersionExchange has unexpected format!\");\n\t\terr = DEVICE_LINK_SERVICE_E_PLIST_ERROR;\n\t\tgoto leave;\n\t}\n\tplist_t maj = plist_array_get_item(array, 1);\n\tplist_t min = plist_array_get_item(array, 2);\n\tuint64_t vmajor = 0;\n\tuint64_t vminor = 0;\n\tif (maj) {\n\t\tplist_get_uint_val(maj, &vmajor);\n\t}\n\tif (min) {\n\t\tplist_get_uint_val(min, &vminor);\n\t}\n\tif (vmajor > version_major) {\n\t\tdebug_info(\"Version mismatch: device=(%lld,%lld) > expected=(%lld,%lld)\", vmajor, vminor, version_major, version_minor);\n\t\terr = DEVICE_LINK_SERVICE_E_BAD_VERSION;\n\t\tgoto leave;\n\t} else if ((vmajor == version_major) && (vminor > version_minor)) {\n\t\tdebug_info(\"WARNING: Version mismatch: device=(%lld,%lld) > expected=(%lld,%lld)\", vmajor, vminor, version_major, version_minor);\n\t\terr = DEVICE_LINK_SERVICE_E_BAD_VERSION;\n\t\tgoto leave;\n\t}\n\tplist_free(array);\n\n\t/* version is ok, send reply */\n\tarray = plist_new_array();\n\tplist_array_append_item(array, plist_new_string(\"DLMessageVersionExchange\"));\n\tplist_array_append_item(array, plist_new_string(\"DLVersionsOk\"));\n\tplist_array_append_item(array, plist_new_uint(version_major));\n\tif (property_list_service_send_binary_plist(client->parent, array) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Error when sending DLVersionsOk\");\n\t\terr = DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t\tgoto leave;\n\t}\n\tplist_free(array);\n\n\t/* receive DeviceReady message */\n\tarray = NULL;\n\tif (property_list_service_receive_plist(client->parent, &array) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Error when receiving DLMessageDeviceReady!\");\n\t\terr = DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t\tgoto leave;\n\t}\n\tdevice_link_service_get_message(array, &msg);\n\tif (!msg || strcmp(msg, \"DLMessageDeviceReady\")) {\n\t\tdebug_info(\"Did not get DLMessageDeviceReady!\");\n\t\terr = DEVICE_LINK_SERVICE_E_PLIST_ERROR;\n\t\tgoto leave;\n\t}\n\terr = DEVICE_LINK_SERVICE_E_SUCCESS;\n\nleave:\n\tif (msg) {\n\t\tfree(msg);\n\t}\n\tif (array) {\n\t\tplist_free(array);\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct mobilesync_client_private)"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_link_service_client_new",
          "args": [
            "device",
            "service",
            "&dlclient"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "device_link_service_client_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/device_link_service.c",
          "lines": "85-107",
          "snippet": "device_link_service_error_t device_link_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, device_link_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client) {\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\t}\n\n\tproperty_list_service_client_t plistclient = NULL;\n\tif (property_list_service_client_new(device, service, &plistclient) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\n\t/* create client object */\n\tdevice_link_service_client_t client_loc = (device_link_service_client_t) malloc(sizeof(struct device_link_service_client_private));\n\tclient_loc->parent = plistclient;\n\n\t/* enable SSL if requested */\n\tif (service->ssl_enabled)\n\t\tproperty_list_service_enable_ssl(client_loc->parent);\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"device_link_service.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"device_link_service.h\"\n#include <stdlib.h>\n#include <string.h>\n\ndevice_link_service_error_t device_link_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, device_link_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client) {\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\t}\n\n\tproperty_list_service_client_t plistclient = NULL;\n\tif (property_list_service_client_new(device, service, &plistclient) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\n\t/* create client object */\n\tdevice_link_service_client_t client_loc = (device_link_service_client_t) malloc(sizeof(struct device_link_service_client_private));\n\tclient_loc->parent = plistclient;\n\n\t/* enable SSL if requested */\n\tif (service->ssl_enabled)\n\t\tproperty_list_service_enable_ssl(client_loc->parent);\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\n#define MSYNC_VERSION_INT2 100\n#define MSYNC_VERSION_INT1 300\n\nLIBIMOBILEDEVICE_API mobilesync_error_t mobilesync_client_new(idevice_t device, lockdownd_service_descriptor_t service,\n\t\t\t\t\t\t   mobilesync_client_t * client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client)\n\t\treturn MOBILESYNC_E_INVALID_ARG;\n\n\tdevice_link_service_client_t dlclient = NULL;\n\tmobilesync_error_t ret = mobilesync_error(device_link_service_client_new(device, service, &dlclient));\n\tif (ret != MOBILESYNC_E_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\tmobilesync_client_t client_loc = (mobilesync_client_t) malloc(sizeof(struct mobilesync_client_private));\n\tclient_loc->parent = dlclient;\n\tclient_loc->direction = MOBILESYNC_SYNC_DIR_DEVICE_TO_COMPUTER;\n\tclient_loc->data_class = NULL;\n\n\t/* perform handshake */\n\tret = mobilesync_error(device_link_service_version_exchange(dlclient, MSYNC_VERSION_INT1, MSYNC_VERSION_INT2));\n\tif (ret != MOBILESYNC_E_SUCCESS) {\n\t\tdebug_info(\"version exchange failed, error %d\", ret);\n\t\tmobilesync_client_free(client_loc);\n\t\treturn ret;\n\t}\n\n\t*client = client_loc;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "mobilesync_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/mobilesync.c",
    "lines": "49-66",
    "snippet": "static mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"device_link_service.h\"",
      "#include \"mobilesync.h\"",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <plist/plist.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"device_link_service.h\"\n#include \"mobilesync.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <plist/plist.h>\n\nstatic mobilesync_error_t mobilesync_error(device_link_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase DEVICE_LINK_SERVICE_E_SUCCESS:\n\t\t\treturn MOBILESYNC_E_SUCCESS;\n\t\tcase DEVICE_LINK_SERVICE_E_INVALID_ARG:\n\t\t\treturn MOBILESYNC_E_INVALID_ARG;\n\t\tcase DEVICE_LINK_SERVICE_E_PLIST_ERROR:\n\t\t\treturn MOBILESYNC_E_PLIST_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_MUX_ERROR:\n\t\t\treturn MOBILESYNC_E_MUX_ERROR;\n\t\tcase DEVICE_LINK_SERVICE_E_BAD_VERSION:\n\t\t\treturn MOBILESYNC_E_BAD_VERSION;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn MOBILESYNC_E_UNKNOWN_ERROR;\n}"
  }
]