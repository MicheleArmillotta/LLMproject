[
  {
    "function_name": "sbservices_get_home_screen_wallpaper_pngdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
    "lines": "256-290",
    "snippet": "LIBIMOBILEDEVICE_API sbservices_error_t sbservices_get_home_screen_wallpaper_pngdata(sbservices_client_t client, char **pngdata, uint64_t *pngsize)\n{\n\tif (!client || !client->parent || !pngdata)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t res = SBSERVICES_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"command\", plist_new_string(\"getHomeScreenWallpaperPNGData\"));\n\n\tsbservices_lock(client);\n\n\tres = sbservices_error(property_list_service_send_binary_plist(client->parent, dict));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t\tgoto leave_unlock;\n\t}\n\tplist_free(dict);\n\n\tdict = NULL;\n\tres = sbservices_error(property_list_service_receive_plist(client->parent, &dict));\n\tif (res\t== SBSERVICES_E_SUCCESS) {\n\t\tplist_t node = plist_dict_get_item(dict, \"pngData\");\n\t\tif (node) {\n\t\t\tplist_get_data_val(node, pngdata, pngsize);\n\t\t}\n\t}\n\nleave_unlock:\n\tif (dict) {\n\t\tplist_free(dict);\n\t}\n\tsbservices_unlock(client);\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"sbservices.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sbservices_unlock",
          "args": [
            "client"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "47-51",
          "snippet": "static void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_data_val",
          "args": [
            "node",
            "pngdata",
            "pngsize"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_get_item",
          "args": [
            "dict",
            "\"pngData\""
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sbservices_error",
          "args": [
            "property_list_service_receive_plist(client->parent, &dict)"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "62-77",
          "snippet": "static sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_receive_plist",
          "args": [
            "client->parent",
            "&dict"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_receive_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "258-261",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"could not send plist, error %d\"",
            "res"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "property_list_service_send_binary_plist",
          "args": [
            "client->parent",
            "dict"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_send_binary_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "155-158",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_binary_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 1);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_binary_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sbservices_lock",
          "args": [
            "client"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "36-40",
          "snippet": "static void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"command\"",
            "plist_new_string(\"getHomeScreenWallpaperPNGData\")"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"getHomeScreenWallpaperPNGData\""
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API sbservices_error_t sbservices_get_home_screen_wallpaper_pngdata(sbservices_client_t client, char **pngdata, uint64_t *pngsize)\n{\n\tif (!client || !client->parent || !pngdata)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t res = SBSERVICES_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"command\", plist_new_string(\"getHomeScreenWallpaperPNGData\"));\n\n\tsbservices_lock(client);\n\n\tres = sbservices_error(property_list_service_send_binary_plist(client->parent, dict));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t\tgoto leave_unlock;\n\t}\n\tplist_free(dict);\n\n\tdict = NULL;\n\tres = sbservices_error(property_list_service_receive_plist(client->parent, &dict));\n\tif (res\t== SBSERVICES_E_SUCCESS) {\n\t\tplist_t node = plist_dict_get_item(dict, \"pngData\");\n\t\tif (node) {\n\t\t\tplist_get_data_val(node, pngdata, pngsize);\n\t\t}\n\t}\n\nleave_unlock:\n\tif (dict) {\n\t\tplist_free(dict);\n\t}\n\tsbservices_unlock(client);\n\treturn res;\n}"
  },
  {
    "function_name": "sbservices_get_interface_orientation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
    "lines": "218-254",
    "snippet": "LIBIMOBILEDEVICE_API sbservices_error_t sbservices_get_interface_orientation(sbservices_client_t client, sbservices_interface_orientation_t* interface_orientation)\n{\n\tif (!client || !client->parent || !interface_orientation)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t res = SBSERVICES_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"command\", plist_new_string(\"getInterfaceOrientation\"));\n\n\tsbservices_lock(client);\n\n\tres = sbservices_error(property_list_service_send_binary_plist(client->parent, dict));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t\tgoto leave_unlock;\n\t}\n\tplist_free(dict);\n\tdict = NULL;\n\n\tres = sbservices_error(property_list_service_receive_plist(client->parent, &dict));\n\tif (res\t== SBSERVICES_E_SUCCESS) {\n\t\tplist_t node = plist_dict_get_item(dict, \"interfaceOrientation\");\n\t\tif (node) {\n\t\t\tuint64_t value = SBSERVICES_INTERFACE_ORIENTATION_UNKNOWN;\n\t\t\tplist_get_uint_val(node, &value);\n\t\t\t*interface_orientation = (sbservices_interface_orientation_t)value;\n\t\t}\n\t}\n\nleave_unlock:\n\tif (dict) {\n\t\tplist_free(dict);\n\t}\n\tsbservices_unlock(client);\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"sbservices.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sbservices_unlock",
          "args": [
            "client"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "47-51",
          "snippet": "static void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_uint_val",
          "args": [
            "node",
            "&value"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_get_item",
          "args": [
            "dict",
            "\"interfaceOrientation\""
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sbservices_error",
          "args": [
            "property_list_service_receive_plist(client->parent, &dict)"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "62-77",
          "snippet": "static sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_receive_plist",
          "args": [
            "client->parent",
            "&dict"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_receive_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "258-261",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"could not send plist, error %d\"",
            "res"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "property_list_service_send_binary_plist",
          "args": [
            "client->parent",
            "dict"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_send_binary_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "155-158",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_binary_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 1);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_binary_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sbservices_lock",
          "args": [
            "client"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "36-40",
          "snippet": "static void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"command\"",
            "plist_new_string(\"getInterfaceOrientation\")"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"getInterfaceOrientation\""
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API sbservices_error_t sbservices_get_interface_orientation(sbservices_client_t client, sbservices_interface_orientation_t* interface_orientation)\n{\n\tif (!client || !client->parent || !interface_orientation)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t res = SBSERVICES_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"command\", plist_new_string(\"getInterfaceOrientation\"));\n\n\tsbservices_lock(client);\n\n\tres = sbservices_error(property_list_service_send_binary_plist(client->parent, dict));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t\tgoto leave_unlock;\n\t}\n\tplist_free(dict);\n\tdict = NULL;\n\n\tres = sbservices_error(property_list_service_receive_plist(client->parent, &dict));\n\tif (res\t== SBSERVICES_E_SUCCESS) {\n\t\tplist_t node = plist_dict_get_item(dict, \"interfaceOrientation\");\n\t\tif (node) {\n\t\t\tuint64_t value = SBSERVICES_INTERFACE_ORIENTATION_UNKNOWN;\n\t\t\tplist_get_uint_val(node, &value);\n\t\t\t*interface_orientation = (sbservices_interface_orientation_t)value;\n\t\t}\n\t}\n\nleave_unlock:\n\tif (dict) {\n\t\tplist_free(dict);\n\t}\n\tsbservices_unlock(client);\n\treturn res;\n}"
  },
  {
    "function_name": "sbservices_get_icon_pngdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
    "lines": "181-216",
    "snippet": "LIBIMOBILEDEVICE_API sbservices_error_t sbservices_get_icon_pngdata(sbservices_client_t client, const char *bundleId, char **pngdata, uint64_t *pngsize)\n{\n\tif (!client || !client->parent || !bundleId || !pngdata)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t res = SBSERVICES_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"command\", plist_new_string(\"getIconPNGData\"));\n\tplist_dict_set_item(dict, \"bundleId\", plist_new_string(bundleId));\n\n\tsbservices_lock(client);\n\n\tres = sbservices_error(property_list_service_send_binary_plist(client->parent, dict));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t\tgoto leave_unlock;\n\t}\n\tplist_free(dict);\n\n\tdict = NULL;\n\tres = sbservices_error(property_list_service_receive_plist(client->parent, &dict));\n\tif (res\t== SBSERVICES_E_SUCCESS) {\n\t\tplist_t node = plist_dict_get_item(dict, \"pngData\");\n\t\tif (node) {\n\t\t\tplist_get_data_val(node, pngdata, pngsize);\n\t\t}\n\t}\n\nleave_unlock:\n\tif (dict) {\n\t\tplist_free(dict);\n\t}\n\tsbservices_unlock(client);\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"sbservices.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sbservices_unlock",
          "args": [
            "client"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "47-51",
          "snippet": "static void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_get_data_val",
          "args": [
            "node",
            "pngdata",
            "pngsize"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_get_item",
          "args": [
            "dict",
            "\"pngData\""
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sbservices_error",
          "args": [
            "property_list_service_receive_plist(client->parent, &dict)"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "62-77",
          "snippet": "static sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_receive_plist",
          "args": [
            "client->parent",
            "&dict"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_receive_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "258-261",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"could not send plist, error %d\"",
            "res"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "property_list_service_send_binary_plist",
          "args": [
            "client->parent",
            "dict"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_send_binary_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "155-158",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_binary_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 1);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_binary_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sbservices_lock",
          "args": [
            "client"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "36-40",
          "snippet": "static void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"bundleId\"",
            "plist_new_string(bundleId)"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "bundleId"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"command\"",
            "plist_new_string(\"getIconPNGData\")"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"getIconPNGData\""
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API sbservices_error_t sbservices_get_icon_pngdata(sbservices_client_t client, const char *bundleId, char **pngdata, uint64_t *pngsize)\n{\n\tif (!client || !client->parent || !bundleId || !pngdata)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t res = SBSERVICES_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"command\", plist_new_string(\"getIconPNGData\"));\n\tplist_dict_set_item(dict, \"bundleId\", plist_new_string(bundleId));\n\n\tsbservices_lock(client);\n\n\tres = sbservices_error(property_list_service_send_binary_plist(client->parent, dict));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t\tgoto leave_unlock;\n\t}\n\tplist_free(dict);\n\n\tdict = NULL;\n\tres = sbservices_error(property_list_service_receive_plist(client->parent, &dict));\n\tif (res\t== SBSERVICES_E_SUCCESS) {\n\t\tplist_t node = plist_dict_get_item(dict, \"pngData\");\n\t\tif (node) {\n\t\t\tplist_get_data_val(node, pngdata, pngsize);\n\t\t}\n\t}\n\nleave_unlock:\n\tif (dict) {\n\t\tplist_free(dict);\n\t}\n\tsbservices_unlock(client);\n\treturn res;\n}"
  },
  {
    "function_name": "sbservices_set_icon_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
    "lines": "155-179",
    "snippet": "LIBIMOBILEDEVICE_API sbservices_error_t sbservices_set_icon_state(sbservices_client_t client, plist_t newstate)\n{\n\tif (!client || !client->parent || !newstate)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t res = SBSERVICES_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"command\", plist_new_string(\"setIconState\"));\n\tplist_dict_set_item(dict, \"iconState\", plist_copy(newstate));\n\n\tsbservices_lock(client);\n\n\tres = sbservices_error(property_list_service_send_binary_plist(client->parent, dict));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t}\n\t/* NO RESPONSE */\n\n\tif (dict) {\n\t\tplist_free(dict);\n\t}\n\tsbservices_unlock(client);\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"sbservices.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sbservices_unlock",
          "args": [
            "client"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "47-51",
          "snippet": "static void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"could not send plist, error %d\"",
            "res"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sbservices_error",
          "args": [
            "property_list_service_send_binary_plist(client->parent, dict)"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "62-77",
          "snippet": "static sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_send_binary_plist",
          "args": [
            "client->parent",
            "dict"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_send_binary_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "155-158",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_binary_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 1);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_binary_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sbservices_lock",
          "args": [
            "client"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "36-40",
          "snippet": "static void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"iconState\"",
            "plist_copy(newstate)"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_copy",
          "args": [
            "newstate"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"command\"",
            "plist_new_string(\"setIconState\")"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"setIconState\""
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API sbservices_error_t sbservices_set_icon_state(sbservices_client_t client, plist_t newstate)\n{\n\tif (!client || !client->parent || !newstate)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t res = SBSERVICES_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"command\", plist_new_string(\"setIconState\"));\n\tplist_dict_set_item(dict, \"iconState\", plist_copy(newstate));\n\n\tsbservices_lock(client);\n\n\tres = sbservices_error(property_list_service_send_binary_plist(client->parent, dict));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t}\n\t/* NO RESPONSE */\n\n\tif (dict) {\n\t\tplist_free(dict);\n\t}\n\tsbservices_unlock(client);\n\treturn res;\n}"
  },
  {
    "function_name": "sbservices_get_icon_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
    "lines": "115-153",
    "snippet": "LIBIMOBILEDEVICE_API sbservices_error_t sbservices_get_icon_state(sbservices_client_t client, plist_t *state, const char *format_version)\n{\n\tif (!client || !client->parent || !state)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t res = SBSERVICES_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"command\", plist_new_string(\"getIconState\"));\n\tif (format_version) {\n\t\tplist_dict_set_item(dict, \"formatVersion\", plist_new_string(format_version));\n\t}\n\n\tsbservices_lock(client);\n\n\tres = sbservices_error(property_list_service_send_binary_plist(client->parent, dict));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t\tgoto leave_unlock;\n\t}\n\tplist_free(dict);\n\tdict = NULL;\n\n\tres = sbservices_error(property_list_service_receive_plist(client->parent, state));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not get icon state, error %d\", res);\n\t\tif (*state) {\n\t\t\tplist_free(*state);\n\t\t\t*state = NULL;\n\t\t}\n\t}\n\nleave_unlock:\n\tif (dict) {\n\t\tplist_free(dict);\n\t}\n\tsbservices_unlock(client);\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"sbservices.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sbservices_unlock",
          "args": [
            "client"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "47-51",
          "snippet": "static void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "*state"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"could not get icon state, error %d\"",
            "res"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sbservices_error",
          "args": [
            "property_list_service_receive_plist(client->parent, state)"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "62-77",
          "snippet": "static sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_receive_plist",
          "args": [
            "client->parent",
            "state"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_receive_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "258-261",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist(property_list_service_client_t client, plist_t *plist)\n{\n\treturn internal_plist_receive_timeout(client, plist, 10000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_free",
          "args": [
            "dict"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"could not send plist, error %d\"",
            "res"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "property_list_service_send_binary_plist",
          "args": [
            "client->parent",
            "dict"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_send_binary_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "155-158",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_binary_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 1);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_binary_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sbservices_lock",
          "args": [
            "client"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "36-40",
          "snippet": "static void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"formatVersion\"",
            "plist_new_string(format_version)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "format_version"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_dict_set_item",
          "args": [
            "dict",
            "\"command\"",
            "plist_new_string(\"getIconState\")"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_string",
          "args": [
            "\"getIconState\""
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_new_dict",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API sbservices_error_t sbservices_get_icon_state(sbservices_client_t client, plist_t *state, const char *format_version)\n{\n\tif (!client || !client->parent || !state)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t res = SBSERVICES_E_UNKNOWN_ERROR;\n\n\tplist_t dict = plist_new_dict();\n\tplist_dict_set_item(dict, \"command\", plist_new_string(\"getIconState\"));\n\tif (format_version) {\n\t\tplist_dict_set_item(dict, \"formatVersion\", plist_new_string(format_version));\n\t}\n\n\tsbservices_lock(client);\n\n\tres = sbservices_error(property_list_service_send_binary_plist(client->parent, dict));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not send plist, error %d\", res);\n\t\tgoto leave_unlock;\n\t}\n\tplist_free(dict);\n\tdict = NULL;\n\n\tres = sbservices_error(property_list_service_receive_plist(client->parent, state));\n\tif (res != SBSERVICES_E_SUCCESS) {\n\t\tdebug_info(\"could not get icon state, error %d\", res);\n\t\tif (*state) {\n\t\t\tplist_free(*state);\n\t\t\t*state = NULL;\n\t\t}\n\t}\n\nleave_unlock:\n\tif (dict) {\n\t\tplist_free(dict);\n\t}\n\tsbservices_unlock(client);\n\treturn res;\n}"
  },
  {
    "function_name": "sbservices_client_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
    "lines": "102-113",
    "snippet": "LIBIMOBILEDEVICE_API sbservices_error_t sbservices_client_free(sbservices_client_t client)\n{\n\tif (!client)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t err = sbservices_error(property_list_service_client_free(client->parent));\n\tclient->parent = NULL;\n\tmutex_destroy(&client->mutex);\n\tfree(client);\n\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"sbservices.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "client"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "102-113",
          "snippet": "LIBIMOBILEDEVICE_API sbservices_error_t sbservices_client_free(sbservices_client_t client)\n{\n\tif (!client)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t err = sbservices_error(property_list_service_client_free(client->parent));\n\tclient->parent = NULL;\n\tmutex_destroy(&client->mutex);\n\tfree(client);\n\n\treturn err;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "mutex_destroy",
          "args": [
            "&client->mutex"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "65-72",
          "snippet": "void mutex_destroy(mutex_t* mutex)\n{\n#ifdef WIN32\n\tDeleteCriticalSection(mutex);\n#else\n\tpthread_mutex_destroy(mutex);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid mutex_destroy(mutex_t* mutex)\n{\n#ifdef WIN32\n\tDeleteCriticalSection(mutex);\n#else\n\tpthread_mutex_destroy(mutex);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "sbservices_error",
          "args": [
            "property_list_service_client_free(client->parent)"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "62-77",
          "snippet": "static sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_client_free",
          "args": [
            "client->parent"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "77-88",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_free(property_list_service_client_t client)\n{\n\tif (!client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tproperty_list_service_error_t err = service_to_property_list_service_error(service_client_free(client->parent));\n\n\tfree(client);\n\tclient = NULL;\n\n\treturn err;\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_free(property_list_service_client_t client)\n{\n\tif (!client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tproperty_list_service_error_t err = service_to_property_list_service_error(service_client_free(client->parent));\n\n\tfree(client);\n\tclient = NULL;\n\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API sbservices_error_t sbservices_client_free(sbservices_client_t client)\n{\n\tif (!client)\n\t\treturn SBSERVICES_E_INVALID_ARG;\n\n\tsbservices_error_t err = sbservices_error(property_list_service_client_free(client->parent));\n\tclient->parent = NULL;\n\tmutex_destroy(&client->mutex);\n\tfree(client);\n\n\treturn err;\n}"
  },
  {
    "function_name": "sbservices_client_start_service",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
    "lines": "95-100",
    "snippet": "LIBIMOBILEDEVICE_API sbservices_error_t sbservices_client_start_service(idevice_t device, sbservices_client_t * client, const char* label)\n{\n\tsbservices_error_t err = SBSERVICES_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, SBSERVICES_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(sbservices_client_new), &err);\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"sbservices.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_client_factory_start_service",
          "args": [
            "device",
            "SBSERVICES_SERVICE_NAME",
            "(void**)client",
            "label",
            "SERVICE_CONSTRUCTOR(sbservices_client_new)",
            "&err"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "service_client_factory_start_service",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/service.c",
          "lines": "79-116",
          "snippet": "LIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"idevice.h\"",
            "#include \"service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"idevice.h\"\n#include \"service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SERVICE_CONSTRUCTOR",
          "args": [
            "sbservices_client_new"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API sbservices_error_t sbservices_client_start_service(idevice_t device, sbservices_client_t * client, const char* label)\n{\n\tsbservices_error_t err = SBSERVICES_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, SBSERVICES_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(sbservices_client_new), &err);\n\treturn err;\n}"
  },
  {
    "function_name": "sbservices_client_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
    "lines": "79-93",
    "snippet": "LIBIMOBILEDEVICE_API sbservices_error_t sbservices_client_new(idevice_t device, lockdownd_service_descriptor_t service, sbservices_client_t *client)\n{\n\tproperty_list_service_client_t plistclient = NULL;\n\tsbservices_error_t err = sbservices_error(property_list_service_client_new(device, service, &plistclient));\n\tif (err != SBSERVICES_E_SUCCESS) {\n\t\treturn err;\n\t}\n\n\tsbservices_client_t client_loc = (sbservices_client_t) malloc(sizeof(struct sbservices_client_private));\n\tclient_loc->parent = plistclient;\n\tmutex_init(&client_loc->mutex);\n\n\t*client = client_loc;\n\treturn SBSERVICES_E_SUCCESS;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"sbservices.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&client_loc->mutex"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "56-63",
          "snippet": "void mutex_init(mutex_t* mutex)\n{\n#ifdef WIN32\n\tInitializeCriticalSection(mutex);\n#else\n\tpthread_mutex_init(mutex, NULL);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid mutex_init(mutex_t* mutex)\n{\n#ifdef WIN32\n\tInitializeCriticalSection(mutex);\n#else\n\tpthread_mutex_init(mutex, NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct sbservices_client_private)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sbservices_error",
          "args": [
            "property_list_service_client_new(device, service, &plistclient)"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "sbservices_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
          "lines": "62-77",
          "snippet": "static sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"sbservices.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_client_new",
          "args": [
            "device",
            "service",
            "&plistclient"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_client_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "57-75",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, property_list_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tservice_client_t parent = NULL;\n\tservice_error_t rerr = service_client_new(device, service, &parent);\n\tif (rerr != SERVICE_E_SUCCESS) {\n\t\treturn service_to_property_list_service_error(rerr);\n\t}\n\n\t/* create client object */\n\tproperty_list_service_client_t client_loc = (property_list_service_client_t)malloc(sizeof(struct property_list_service_client_private));\n\tclient_loc->parent = parent;\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn PROPERTY_LIST_SERVICE_E_SUCCESS;\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, property_list_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tservice_client_t parent = NULL;\n\tservice_error_t rerr = service_client_new(device, service, &parent);\n\tif (rerr != SERVICE_E_SUCCESS) {\n\t\treturn service_to_property_list_service_error(rerr);\n\t}\n\n\t/* create client object */\n\tproperty_list_service_client_t client_loc = (property_list_service_client_t)malloc(sizeof(struct property_list_service_client_private));\n\tclient_loc->parent = parent;\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn PROPERTY_LIST_SERVICE_E_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API sbservices_error_t sbservices_client_new(idevice_t device, lockdownd_service_descriptor_t service, sbservices_client_t *client)\n{\n\tproperty_list_service_client_t plistclient = NULL;\n\tsbservices_error_t err = sbservices_error(property_list_service_client_new(device, service, &plistclient));\n\tif (err != SBSERVICES_E_SUCCESS) {\n\t\treturn err;\n\t}\n\n\tsbservices_client_t client_loc = (sbservices_client_t) malloc(sizeof(struct sbservices_client_private));\n\tclient_loc->parent = plistclient;\n\tmutex_init(&client_loc->mutex);\n\n\t*client = client_loc;\n\treturn SBSERVICES_E_SUCCESS;\n}"
  },
  {
    "function_name": "sbservices_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
    "lines": "62-77",
    "snippet": "static sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"sbservices.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic sbservices_error_t sbservices_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn SBSERVICES_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn SBSERVICES_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn SBSERVICES_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn SBSERVICES_E_CONN_FAILED;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SBSERVICES_E_UNKNOWN_ERROR;\n}"
  },
  {
    "function_name": "sbservices_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
    "lines": "47-51",
    "snippet": "static void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"sbservices.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&client->mutex"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "83-90",
          "snippet": "void mutex_unlock(mutex_t* mutex)\n{\n#ifdef WIN32\n\tLeaveCriticalSection(mutex);\n#else\n\tpthread_mutex_unlock(mutex);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid mutex_unlock(mutex_t* mutex)\n{\n#ifdef WIN32\n\tLeaveCriticalSection(mutex);\n#else\n\tpthread_mutex_unlock(mutex);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Unlocked\""
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_unlock(sbservices_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}"
  },
  {
    "function_name": "sbservices_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/sbservices.c",
    "lines": "36-40",
    "snippet": "static void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"sbservices.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&client->mutex"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "74-81",
          "snippet": "void mutex_lock(mutex_t* mutex)\n{\n#ifdef WIN32\n\tEnterCriticalSection(mutex);\n#else\n\tpthread_mutex_lock(mutex);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid mutex_lock(mutex_t* mutex)\n{\n#ifdef WIN32\n\tEnterCriticalSection(mutex);\n#else\n\tpthread_mutex_lock(mutex);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Locked\""
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"sbservices.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void sbservices_lock(sbservices_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}"
  }
]