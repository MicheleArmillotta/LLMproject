[
  {
    "function_name": "debug_plist_real",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/debug.c",
    "lines": "148-169",
    "snippet": "void debug_plist_real(const char *func, const char *file, int line, plist_t plist)\n{\n#ifndef STRIP_DEBUG_CODE\n\tif (!plist)\n\t\treturn;\n\n\tchar *buffer = NULL;\n\tuint32_t length = 0;\n\tplist_to_xml(plist, &buffer, &length);\n\n\t/* get rid of ending newline as one is already added in the debug line */\n\tif (buffer[length-1] == '\\n')\n\t\tbuffer[length-1] = '\\0';\n\n\tif (length <= MAX_PRINT_LEN)\n\t\tdebug_info_real(func, file, line, \"printing %i bytes plist:\\n%s\", length, buffer);\n\telse\n\t\tdebug_info_real(func, file, line, \"supress printing %i bytes plist...\\n\", length);\n\n\tfree(buffer);\n#endif\n}",
    "includes": [
      "#include \"asprintf.h\"",
      "#include \"src/idevice.h\"",
      "#include \"libimobiledevice/libimobiledevice.h\"",
      "#include \"debug.h\"",
      "#include <time.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define MAX_PRINT_LEN 16*1024"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "buffer"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "thread_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "39-44",
          "snippet": "void thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info_real",
          "args": [
            "func",
            "file",
            "line",
            "\"supress printing %i bytes plist...\\n\"",
            "length"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "debug_info_real",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/debug.c",
          "lines": "81-99",
          "snippet": "void debug_info_real(const char *func, const char *file, int line, const char *format, ...)\n{\n#ifndef STRIP_DEBUG_CODE\n\tva_list args;\n\tchar *buffer = NULL;\n\n\tif (!debug_level)\n\t\treturn;\n\n\t/* run the real fprintf */\n\tva_start(args, format);\n\t(void)vasprintf(&buffer, format, args);\n\tva_end(args);\n\n\tdebug_print_line(func, file, line, buffer);\n\n\tfree(buffer);\n#endif\n}",
          "includes": [
            "#include \"asprintf.h\"",
            "#include \"src/idevice.h\"",
            "#include \"libimobiledevice/libimobiledevice.h\"",
            "#include \"debug.h\"",
            "#include <time.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int debug_level;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"asprintf.h\"\n#include \"src/idevice.h\"\n#include \"libimobiledevice/libimobiledevice.h\"\n#include \"debug.h\"\n#include <time.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int debug_level;\n\nvoid debug_info_real(const char *func, const char *file, int line, const char *format, ...)\n{\n#ifndef STRIP_DEBUG_CODE\n\tva_list args;\n\tchar *buffer = NULL;\n\n\tif (!debug_level)\n\t\treturn;\n\n\t/* run the real fprintf */\n\tva_start(args, format);\n\t(void)vasprintf(&buffer, format, args);\n\tva_end(args);\n\n\tdebug_print_line(func, file, line, buffer);\n\n\tfree(buffer);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_to_xml",
          "args": [
            "plist",
            "&buffer",
            "&length"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"asprintf.h\"\n#include \"src/idevice.h\"\n#include \"libimobiledevice/libimobiledevice.h\"\n#include \"debug.h\"\n#include <time.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <config.h>\n\n#define MAX_PRINT_LEN 16*1024\n\nvoid debug_plist_real(const char *func, const char *file, int line, plist_t plist)\n{\n#ifndef STRIP_DEBUG_CODE\n\tif (!plist)\n\t\treturn;\n\n\tchar *buffer = NULL;\n\tuint32_t length = 0;\n\tplist_to_xml(plist, &buffer, &length);\n\n\t/* get rid of ending newline as one is already added in the debug line */\n\tif (buffer[length-1] == '\\n')\n\t\tbuffer[length-1] = '\\0';\n\n\tif (length <= MAX_PRINT_LEN)\n\t\tdebug_info_real(func, file, line, \"printing %i bytes plist:\\n%s\", length, buffer);\n\telse\n\t\tdebug_info_real(func, file, line, \"supress printing %i bytes plist...\\n\", length);\n\n\tfree(buffer);\n#endif\n}"
  },
  {
    "function_name": "debug_buffer_to_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/debug.c",
    "lines": "136-146",
    "snippet": "void debug_buffer_to_file(const char *file, const char *data, const int length)\n{\n#ifndef STRIP_DEBUG_CODE\n\tif (debug_level) {\n\t\tFILE *f = fopen(file, \"wb\");\n\t\tfwrite(data, 1, length, f);\n\t\tfflush(f);\n\t\tfclose(f);\n\t}\n#endif\n}",
    "includes": [
      "#include \"asprintf.h\"",
      "#include \"src/idevice.h\"",
      "#include \"libimobiledevice/libimobiledevice.h\"",
      "#include \"debug.h\"",
      "#include <time.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int debug_level;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "f"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "f"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fwrite",
          "args": [
            "data",
            "1",
            "length",
            "f"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "file",
            "\"wb\""
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"asprintf.h\"\n#include \"src/idevice.h\"\n#include \"libimobiledevice/libimobiledevice.h\"\n#include \"debug.h\"\n#include <time.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int debug_level;\n\nvoid debug_buffer_to_file(const char *file, const char *data, const int length)\n{\n#ifndef STRIP_DEBUG_CODE\n\tif (debug_level) {\n\t\tFILE *f = fopen(file, \"wb\");\n\t\tfwrite(data, 1, length, f);\n\t\tfflush(f);\n\t\tfclose(f);\n\t}\n#endif\n}"
  },
  {
    "function_name": "debug_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/debug.c",
    "lines": "101-134",
    "snippet": "void debug_buffer(const char *data, const int length)\n{\n#ifndef STRIP_DEBUG_CODE\n\tint i;\n\tint j;\n\tunsigned char c;\n\n\tif (debug_level) {\n\t\tfor (i = 0; i < length; i += 16) {\n\t\t\tfprintf(stderr, \"%04x: \", i);\n\t\t\tfor (j = 0; j < 16; j++) {\n\t\t\t\tif (i + j >= length) {\n\t\t\t\t\tfprintf(stderr, \"   \");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tfprintf(stderr, \"%02x \", *(data + i + j) & 0xff);\n\t\t\t}\n\t\t\tfprintf(stderr, \"  | \");\n\t\t\tfor (j = 0; j < 16; j++) {\n\t\t\t\tif (i + j >= length)\n\t\t\t\t\tbreak;\n\t\t\t\tc = *(data + i + j);\n\t\t\t\tif ((c < 32) || (c > 127)) {\n\t\t\t\t\tfprintf(stderr, \".\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tfprintf(stderr, \"%c\", c);\n\t\t\t}\n\t\t\tfprintf(stderr, \"\\n\");\n\t\t}\n\t\tfprintf(stderr, \"\\n\");\n\t}\n#endif\n}",
    "includes": [
      "#include \"asprintf.h\"",
      "#include \"src/idevice.h\"",
      "#include \"libimobiledevice/libimobiledevice.h\"",
      "#include \"debug.h\"",
      "#include <time.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int debug_level;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"\\n\""
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"\\n\""
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%c\"",
            "c"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\".\""
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"  | \""
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%02x \"",
            "*(data + i + j) & 0xff"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"   \""
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%04x: \"",
            "i"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"asprintf.h\"\n#include \"src/idevice.h\"\n#include \"libimobiledevice/libimobiledevice.h\"\n#include \"debug.h\"\n#include <time.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int debug_level;\n\nvoid debug_buffer(const char *data, const int length)\n{\n#ifndef STRIP_DEBUG_CODE\n\tint i;\n\tint j;\n\tunsigned char c;\n\n\tif (debug_level) {\n\t\tfor (i = 0; i < length; i += 16) {\n\t\t\tfprintf(stderr, \"%04x: \", i);\n\t\t\tfor (j = 0; j < 16; j++) {\n\t\t\t\tif (i + j >= length) {\n\t\t\t\t\tfprintf(stderr, \"   \");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tfprintf(stderr, \"%02x \", *(data + i + j) & 0xff);\n\t\t\t}\n\t\t\tfprintf(stderr, \"  | \");\n\t\t\tfor (j = 0; j < 16; j++) {\n\t\t\t\tif (i + j >= length)\n\t\t\t\t\tbreak;\n\t\t\t\tc = *(data + i + j);\n\t\t\t\tif ((c < 32) || (c > 127)) {\n\t\t\t\t\tfprintf(stderr, \".\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tfprintf(stderr, \"%c\", c);\n\t\t\t}\n\t\t\tfprintf(stderr, \"\\n\");\n\t\t}\n\t\tfprintf(stderr, \"\\n\");\n\t}\n#endif\n}"
  },
  {
    "function_name": "debug_info_real",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/debug.c",
    "lines": "81-99",
    "snippet": "void debug_info_real(const char *func, const char *file, int line, const char *format, ...)\n{\n#ifndef STRIP_DEBUG_CODE\n\tva_list args;\n\tchar *buffer = NULL;\n\n\tif (!debug_level)\n\t\treturn;\n\n\t/* run the real fprintf */\n\tva_start(args, format);\n\t(void)vasprintf(&buffer, format, args);\n\tva_end(args);\n\n\tdebug_print_line(func, file, line, buffer);\n\n\tfree(buffer);\n#endif\n}",
    "includes": [
      "#include \"asprintf.h\"",
      "#include \"src/idevice.h\"",
      "#include \"libimobiledevice/libimobiledevice.h\"",
      "#include \"debug.h\"",
      "#include <time.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int debug_level;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "buffer"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "thread_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "39-44",
          "snippet": "void thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_print_line",
          "args": [
            "func",
            "file",
            "line",
            "buffer"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "debug_print_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/debug.c",
          "lines": "52-78",
          "snippet": "static void debug_print_line(const char *func, const char *file, int line, const char *buffer)\n{\n\tchar *str_time = NULL;\n\tchar *header = NULL;\n\ttime_t the_time;\n\n\ttime(&the_time);\n\tstr_time = (char*)malloc(255);\n\tstrftime(str_time, 254, \"%H:%M:%S\", localtime (&the_time));\n\n\t/* generate header text */\n\t(void)asprintf(&header, \"%s %s:%d %s()\", str_time, file, line, func);\n\tfree (str_time);\n\n\t/* trim ending newlines */\n\n\t/* print header */\n\tprintf (\"%s: \", header);\n\n\t/* print actual debug content */\n\tprintf (\"%s\\n\", buffer);\n\n\t/* flush this output, as we need to debug */\n\tfflush (stdout);\n\n\tfree (header);\n}",
          "includes": [
            "#include \"asprintf.h\"",
            "#include \"src/idevice.h\"",
            "#include \"libimobiledevice/libimobiledevice.h\"",
            "#include \"debug.h\"",
            "#include <time.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"asprintf.h\"\n#include \"src/idevice.h\"\n#include \"libimobiledevice/libimobiledevice.h\"\n#include \"debug.h\"\n#include <time.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void debug_print_line(const char *func, const char *file, int line, const char *buffer)\n{\n\tchar *str_time = NULL;\n\tchar *header = NULL;\n\ttime_t the_time;\n\n\ttime(&the_time);\n\tstr_time = (char*)malloc(255);\n\tstrftime(str_time, 254, \"%H:%M:%S\", localtime (&the_time));\n\n\t/* generate header text */\n\t(void)asprintf(&header, \"%s %s:%d %s()\", str_time, file, line, func);\n\tfree (str_time);\n\n\t/* trim ending newlines */\n\n\t/* print header */\n\tprintf (\"%s: \", header);\n\n\t/* print actual debug content */\n\tprintf (\"%s\\n\", buffer);\n\n\t/* flush this output, as we need to debug */\n\tfflush (stdout);\n\n\tfree (header);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vasprintf",
          "args": [
            "&buffer",
            "format",
            "args"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "vasprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/include/asprintf.h",
          "lines": "9-19",
          "snippet": "static inline int vasprintf(char **PTR, const char *TEMPLATE, va_list AP)\n{\n\tint res;\n\tchar buf[16];\n\tres = vsnprintf(buf, 16, TEMPLATE, AP);\n\tif (res > 0) {\n\t\t*PTR = (char*)malloc(res+1);\n\t\tres = vsnprintf(*PTR, res+1, TEMPLATE, AP);\n\t}\n\treturn res;\n}",
          "includes": [
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <config.h>\n\nstatic inline int vasprintf(char **PTR, const char *TEMPLATE, va_list AP)\n{\n\tint res;\n\tchar buf[16];\n\tres = vsnprintf(buf, 16, TEMPLATE, AP);\n\tif (res > 0) {\n\t\t*PTR = (char*)malloc(res+1);\n\t\tres = vsnprintf(*PTR, res+1, TEMPLATE, AP);\n\t}\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "format"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"asprintf.h\"\n#include \"src/idevice.h\"\n#include \"libimobiledevice/libimobiledevice.h\"\n#include \"debug.h\"\n#include <time.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int debug_level;\n\nvoid debug_info_real(const char *func, const char *file, int line, const char *format, ...)\n{\n#ifndef STRIP_DEBUG_CODE\n\tva_list args;\n\tchar *buffer = NULL;\n\n\tif (!debug_level)\n\t\treturn;\n\n\t/* run the real fprintf */\n\tva_start(args, format);\n\t(void)vasprintf(&buffer, format, args);\n\tva_end(args);\n\n\tdebug_print_line(func, file, line, buffer);\n\n\tfree(buffer);\n#endif\n}"
  },
  {
    "function_name": "debug_print_line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/debug.c",
    "lines": "52-78",
    "snippet": "static void debug_print_line(const char *func, const char *file, int line, const char *buffer)\n{\n\tchar *str_time = NULL;\n\tchar *header = NULL;\n\ttime_t the_time;\n\n\ttime(&the_time);\n\tstr_time = (char*)malloc(255);\n\tstrftime(str_time, 254, \"%H:%M:%S\", localtime (&the_time));\n\n\t/* generate header text */\n\t(void)asprintf(&header, \"%s %s:%d %s()\", str_time, file, line, func);\n\tfree (str_time);\n\n\t/* trim ending newlines */\n\n\t/* print header */\n\tprintf (\"%s: \", header);\n\n\t/* print actual debug content */\n\tprintf (\"%s\\n\", buffer);\n\n\t/* flush this output, as we need to debug */\n\tfflush (stdout);\n\n\tfree (header);\n}",
    "includes": [
      "#include \"asprintf.h\"",
      "#include \"src/idevice.h\"",
      "#include \"libimobiledevice/libimobiledevice.h\"",
      "#include \"debug.h\"",
      "#include <time.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "header"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "thread_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "39-44",
          "snippet": "void thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "stdout"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "buffer"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "asprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/include/asprintf.h",
          "lines": "23-31",
          "snippet": "static inline int asprintf(char **PTR, const char *TEMPLATE, ...)\n{\n\tint res;\n\tva_list AP;\n\tva_start(AP, TEMPLATE);\n\tres = vasprintf(PTR, TEMPLATE, AP);\n\tva_end(AP);\n\treturn res;\n}",
          "includes": [
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <config.h>\n\nstatic inline int asprintf(char **PTR, const char *TEMPLATE, ...)\n{\n\tint res;\n\tva_list AP;\n\tva_start(AP, TEMPLATE);\n\tres = vasprintf(PTR, TEMPLATE, AP);\n\tva_end(AP);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strftime",
          "args": [
            "str_time",
            "254",
            "\"%H:%M:%S\"",
            "localtime (&the_time)"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "localtime",
          "args": [
            "&the_time"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "255"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&the_time"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"asprintf.h\"\n#include \"src/idevice.h\"\n#include \"libimobiledevice/libimobiledevice.h\"\n#include \"debug.h\"\n#include <time.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void debug_print_line(const char *func, const char *file, int line, const char *buffer)\n{\n\tchar *str_time = NULL;\n\tchar *header = NULL;\n\ttime_t the_time;\n\n\ttime(&the_time);\n\tstr_time = (char*)malloc(255);\n\tstrftime(str_time, 254, \"%H:%M:%S\", localtime (&the_time));\n\n\t/* generate header text */\n\t(void)asprintf(&header, \"%s %s:%d %s()\", str_time, file, line, func);\n\tfree (str_time);\n\n\t/* trim ending newlines */\n\n\t/* print header */\n\tprintf (\"%s: \", header);\n\n\t/* print actual debug content */\n\tprintf (\"%s\\n\", buffer);\n\n\t/* flush this output, as we need to debug */\n\tfflush (stdout);\n\n\tfree (header);\n}"
  },
  {
    "function_name": "internal_set_debug_level",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/debug.c",
    "lines": "44-47",
    "snippet": "void internal_set_debug_level(int level)\n{\n\tdebug_level = level;\n}",
    "includes": [
      "#include \"asprintf.h\"",
      "#include \"src/idevice.h\"",
      "#include \"libimobiledevice/libimobiledevice.h\"",
      "#include \"debug.h\"",
      "#include <time.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int debug_level;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"asprintf.h\"\n#include \"src/idevice.h\"\n#include \"libimobiledevice/libimobiledevice.h\"\n#include \"debug.h\"\n#include <time.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int debug_level;\n\nvoid internal_set_debug_level(int level)\n{\n\tdebug_level = level;\n}"
  }
]