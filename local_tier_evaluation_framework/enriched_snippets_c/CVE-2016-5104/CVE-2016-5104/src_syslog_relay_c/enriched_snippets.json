[
  {
    "function_name": "syslog_relay_stop_capture",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
    "lines": "203-217",
    "snippet": "LIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_stop_capture(syslog_relay_client_t client)\n{\n\tif (client->worker) {\n\t\t/* notify thread to finish */\n\t\tservice_client_t parent = client->parent;\n\t\tclient->parent = NULL;\n\t\t/* join thread to make it exit */\n\t\tthread_join(client->worker);\n\t\tthread_free(client->worker);\n\t\tclient->worker = (thread_t)NULL;\n\t\tclient->parent = parent;\n\t}\n\n\treturn SYSLOG_RELAY_E_SUCCESS;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"lockdown.h\"",
      "#include \"syslog_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "thread_free",
          "args": [
            "client->worker"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "thread_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "39-44",
          "snippet": "void thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "thread_join",
          "args": [
            "client->worker"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "thread_join",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "46-54",
          "snippet": "void thread_join(thread_t thread)\n{\n\t/* wait for thread to complete */\n#ifdef WIN32\n\tWaitForSingleObject(thread, INFINITE);\n#else\n\tpthread_join(thread, NULL);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_join(thread_t thread)\n{\n\t/* wait for thread to complete */\n#ifdef WIN32\n\tWaitForSingleObject(thread, INFINITE);\n#else\n\tpthread_join(thread, NULL);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_stop_capture(syslog_relay_client_t client)\n{\n\tif (client->worker) {\n\t\t/* notify thread to finish */\n\t\tservice_client_t parent = client->parent;\n\t\tclient->parent = NULL;\n\t\t/* join thread to make it exit */\n\t\tthread_join(client->worker);\n\t\tthread_free(client->worker);\n\t\tclient->worker = (thread_t)NULL;\n\t\tclient->parent = parent;\n\t}\n\n\treturn SYSLOG_RELAY_E_SUCCESS;\n}"
  },
  {
    "function_name": "syslog_relay_start_capture",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
    "lines": "176-201",
    "snippet": "LIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_start_capture(syslog_relay_client_t client, syslog_relay_receive_cb_t callback, void* user_data)\n{\n\tif (!client || !callback)\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\n\tsyslog_relay_error_t res = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\n\tif (client->worker) {\n\t\tdebug_info(\"Another syslog capture thread appears to be running already.\");\n\t\treturn res;\n\t}\n\n\t/* start worker thread */\n\tstruct syslog_relay_worker_thread *srwt = (struct syslog_relay_worker_thread*)malloc(sizeof(struct syslog_relay_worker_thread));\n\tif (srwt) {\n\t\tsrwt->client = client;\n\t\tsrwt->cbfunc = callback;\n\t\tsrwt->user_data = user_data;\n\n\t\tif (thread_new(&client->worker, syslog_relay_worker, srwt) == 0) {\n\t\t\tres = SYSLOG_RELAY_E_SUCCESS;\n\t\t}\n\t}\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"lockdown.h\"",
      "#include \"syslog_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "thread_new",
          "args": [
            "&client->worker",
            "syslog_relay_worker",
            "srwt"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "thread_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "24-37",
          "snippet": "int thread_new(thread_t *thread, thread_func_t thread_func, void* data)\n{\n#ifdef WIN32\n\tHANDLE th = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)thread_func, data, 0, NULL);\n\tif (th == NULL) {\n\t\treturn -1;\n\t}\n\t*thread = th;\n\treturn 0;\n#else\n\tint res = pthread_create(thread, NULL, thread_func, data);\n\treturn res;\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nint thread_new(thread_t *thread, thread_func_t thread_func, void* data)\n{\n#ifdef WIN32\n\tHANDLE th = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)thread_func, data, 0, NULL);\n\tif (th == NULL) {\n\t\treturn -1;\n\t}\n\t*thread = th;\n\treturn 0;\n#else\n\tint res = pthread_create(thread, NULL, thread_func, data);\n\treturn res;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct syslog_relay_worker_thread)"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Another syslog capture thread appears to be running already.\""
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_start_capture(syslog_relay_client_t client, syslog_relay_receive_cb_t callback, void* user_data)\n{\n\tif (!client || !callback)\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\n\tsyslog_relay_error_t res = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\n\tif (client->worker) {\n\t\tdebug_info(\"Another syslog capture thread appears to be running already.\");\n\t\treturn res;\n\t}\n\n\t/* start worker thread */\n\tstruct syslog_relay_worker_thread *srwt = (struct syslog_relay_worker_thread*)malloc(sizeof(struct syslog_relay_worker_thread));\n\tif (srwt) {\n\t\tsrwt->client = client;\n\t\tsrwt->cbfunc = callback;\n\t\tsrwt->user_data = user_data;\n\n\t\tif (thread_new(&client->worker, syslog_relay_worker, srwt) == 0) {\n\t\t\tres = SYSLOG_RELAY_E_SUCCESS;\n\t\t}\n\t}\n\n\treturn res;\n}"
  },
  {
    "function_name": "syslog_relay_worker",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
    "lines": "142-174",
    "snippet": "void *syslog_relay_worker(void *arg)\n{\n\tsyslog_relay_error_t ret = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\tstruct syslog_relay_worker_thread *srwt = (struct syslog_relay_worker_thread*)arg;\n\n\tif (!srwt)\n\t\treturn NULL;\n\n\tdebug_info(\"Running\");\n\n\twhile (srwt->client->parent) {\n\t\tchar c;\n\t\tuint32_t bytes = 0;\n\t\tret = syslog_relay_receive_with_timeout(srwt->client, &c, 1, &bytes, 100);\n\t\tif ((bytes == 0) && (ret == SYSLOG_RELAY_E_SUCCESS)) {\n\t\t\tcontinue;\n\t\t} else if (ret < 0) {\n\t\t\tdebug_info(\"Connection to syslog relay interrupted\");\n\t\t\tbreak;\n\t\t}\n\t\tif(c != 0) {\n\t\t\tsrwt->cbfunc(c, srwt->user_data);\n\t\t}\n\t}\n\n\tif (srwt) {\n\t\tfree(srwt);\n\t}\n\n\tdebug_info(\"Exiting\");\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"lockdown.h\"",
      "#include \"syslog_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Exiting\""
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "srwt"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "syslog_relay_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
          "lines": "99-115",
          "snippet": "LIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_client_free(syslog_relay_client_t client)\n{\n\tif (!client)\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\n\tsyslog_relay_error_t err = syslog_relay_error(service_client_free(client->parent));\n\tclient->parent = NULL;\n\tif (client->worker) {\n\t\tdebug_info(\"Joining syslog capture callback worker thread\");\n\t\tthread_join(client->worker);\n\t\tthread_free(client->worker);\n\t\tclient->worker = (thread_t)NULL;\n\t}\n\tfree(client);\n\n\treturn err;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"lockdown.h\"",
            "#include \"syslog_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_client_free(syslog_relay_client_t client)\n{\n\tif (!client)\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\n\tsyslog_relay_error_t err = syslog_relay_error(service_client_free(client->parent));\n\tclient->parent = NULL;\n\tif (client->worker) {\n\t\tdebug_info(\"Joining syslog capture callback worker thread\");\n\t\tthread_join(client->worker);\n\t\tthread_free(client->worker);\n\t\tclient->worker = (thread_t)NULL;\n\t}\n\tfree(client);\n\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "srwt->cbfunc",
          "args": [
            "c",
            "srwt->user_data"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Connection to syslog relay interrupted\""
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syslog_relay_receive_with_timeout",
          "args": [
            "srwt->client",
            "&c",
            "1",
            "&bytes",
            "100"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "syslog_relay_receive_with_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
          "lines": "122-140",
          "snippet": "LIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_receive_with_timeout(syslog_relay_client_t client, char* data, uint32_t size, uint32_t *received, unsigned int timeout)\n{\n\tsyslog_relay_error_t res = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\tint bytes = 0;\n\n\tif (!client || !data || (size == 0)) {\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t}\n\n\tres = syslog_relay_error(service_receive_with_timeout(client->parent, data, size, (uint32_t*)&bytes, timeout));\n\tif (bytes <= 0) {\n\t\tdebug_info(\"Could not read data, error %d\", res);\n\t}\n\tif (received) {\n\t\t*received = (uint32_t)bytes;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"lockdown.h\"",
            "#include \"syslog_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_receive_with_timeout(syslog_relay_client_t client, char* data, uint32_t size, uint32_t *received, unsigned int timeout)\n{\n\tsyslog_relay_error_t res = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\tint bytes = 0;\n\n\tif (!client || !data || (size == 0)) {\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t}\n\n\tres = syslog_relay_error(service_receive_with_timeout(client->parent, data, size, (uint32_t*)&bytes, timeout));\n\tif (bytes <= 0) {\n\t\tdebug_info(\"Could not read data, error %d\", res);\n\t}\n\tif (received) {\n\t\t*received = (uint32_t)bytes;\n\t}\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Running\""
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nvoid *syslog_relay_worker(void *arg)\n{\n\tsyslog_relay_error_t ret = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\tstruct syslog_relay_worker_thread *srwt = (struct syslog_relay_worker_thread*)arg;\n\n\tif (!srwt)\n\t\treturn NULL;\n\n\tdebug_info(\"Running\");\n\n\twhile (srwt->client->parent) {\n\t\tchar c;\n\t\tuint32_t bytes = 0;\n\t\tret = syslog_relay_receive_with_timeout(srwt->client, &c, 1, &bytes, 100);\n\t\tif ((bytes == 0) && (ret == SYSLOG_RELAY_E_SUCCESS)) {\n\t\t\tcontinue;\n\t\t} else if (ret < 0) {\n\t\t\tdebug_info(\"Connection to syslog relay interrupted\");\n\t\t\tbreak;\n\t\t}\n\t\tif(c != 0) {\n\t\t\tsrwt->cbfunc(c, srwt->user_data);\n\t\t}\n\t}\n\n\tif (srwt) {\n\t\tfree(srwt);\n\t}\n\n\tdebug_info(\"Exiting\");\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "syslog_relay_receive_with_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
    "lines": "122-140",
    "snippet": "LIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_receive_with_timeout(syslog_relay_client_t client, char* data, uint32_t size, uint32_t *received, unsigned int timeout)\n{\n\tsyslog_relay_error_t res = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\tint bytes = 0;\n\n\tif (!client || !data || (size == 0)) {\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t}\n\n\tres = syslog_relay_error(service_receive_with_timeout(client->parent, data, size, (uint32_t*)&bytes, timeout));\n\tif (bytes <= 0) {\n\t\tdebug_info(\"Could not read data, error %d\", res);\n\t}\n\tif (received) {\n\t\t*received = (uint32_t)bytes;\n\t}\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"lockdown.h\"",
      "#include \"syslog_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Could not read data, error %d\"",
            "res"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syslog_relay_error",
          "args": [
            "service_receive_with_timeout(client->parent, data, size, (uint32_t*)&bytes, timeout)"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "syslog_relay_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
          "lines": "47-62",
          "snippet": "static syslog_relay_error_t syslog_relay_error(service_error_t err)\n{\n\tswitch (err) {\n\t\tcase SERVICE_E_SUCCESS:\n\t\t\treturn SYSLOG_RELAY_E_SUCCESS;\n\t\tcase SERVICE_E_INVALID_ARG:\n\t\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t\tcase SERVICE_E_MUX_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_MUX_ERROR;\n\t\tcase SERVICE_E_SSL_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_SSL_ERROR;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SYSLOG_RELAY_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"lockdown.h\"",
            "#include \"syslog_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nstatic syslog_relay_error_t syslog_relay_error(service_error_t err)\n{\n\tswitch (err) {\n\t\tcase SERVICE_E_SUCCESS:\n\t\t\treturn SYSLOG_RELAY_E_SUCCESS;\n\t\tcase SERVICE_E_INVALID_ARG:\n\t\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t\tcase SERVICE_E_MUX_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_MUX_ERROR;\n\t\tcase SERVICE_E_SSL_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_SSL_ERROR;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SYSLOG_RELAY_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "service_receive_with_timeout",
          "args": [
            "client->parent",
            "data",
            "size",
            "(uint32_t*)&bytes",
            "timeout"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "service_receive_with_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/service.c",
          "lines": "152-170",
          "snippet": "LIBIMOBILEDEVICE_API service_error_t service_receive_with_timeout(service_client_t client, char* data, uint32_t size, uint32_t *received, unsigned int timeout)\n{\n\tservice_error_t res = SERVICE_E_UNKNOWN_ERROR;\n\tint bytes = 0;\n\n\tif (!client || (client && !client->connection) || !data || (size == 0)) {\n\t\treturn SERVICE_E_INVALID_ARG;\n\t}\n\n\tres = idevice_to_service_error(idevice_connection_receive_timeout(client->connection, data, size, (uint32_t*)&bytes, timeout));\n\tif (bytes <= 0) {\n\t\tdebug_info(\"could not read data\");\n\t}\n\tif (received) {\n\t\t*received = (uint32_t)bytes;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"idevice.h\"",
            "#include \"service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"idevice.h\"\n#include \"service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API service_error_t service_receive_with_timeout(service_client_t client, char* data, uint32_t size, uint32_t *received, unsigned int timeout)\n{\n\tservice_error_t res = SERVICE_E_UNKNOWN_ERROR;\n\tint bytes = 0;\n\n\tif (!client || (client && !client->connection) || !data || (size == 0)) {\n\t\treturn SERVICE_E_INVALID_ARG;\n\t}\n\n\tres = idevice_to_service_error(idevice_connection_receive_timeout(client->connection, data, size, (uint32_t*)&bytes, timeout));\n\tif (bytes <= 0) {\n\t\tdebug_info(\"could not read data\");\n\t}\n\tif (received) {\n\t\t*received = (uint32_t)bytes;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_receive_with_timeout(syslog_relay_client_t client, char* data, uint32_t size, uint32_t *received, unsigned int timeout)\n{\n\tsyslog_relay_error_t res = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\tint bytes = 0;\n\n\tif (!client || !data || (size == 0)) {\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t}\n\n\tres = syslog_relay_error(service_receive_with_timeout(client->parent, data, size, (uint32_t*)&bytes, timeout));\n\tif (bytes <= 0) {\n\t\tdebug_info(\"Could not read data, error %d\", res);\n\t}\n\tif (received) {\n\t\t*received = (uint32_t)bytes;\n\t}\n\n\treturn res;\n}"
  },
  {
    "function_name": "syslog_relay_receive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
    "lines": "117-120",
    "snippet": "LIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_receive(syslog_relay_client_t client, char* data, uint32_t size, uint32_t *received)\n{\n\treturn syslog_relay_receive_with_timeout(client, data, size, received, 1000);\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"lockdown.h\"",
      "#include \"syslog_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syslog_relay_receive_with_timeout",
          "args": [
            "client",
            "data",
            "size",
            "received",
            "1000"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "syslog_relay_receive_with_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
          "lines": "122-140",
          "snippet": "LIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_receive_with_timeout(syslog_relay_client_t client, char* data, uint32_t size, uint32_t *received, unsigned int timeout)\n{\n\tsyslog_relay_error_t res = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\tint bytes = 0;\n\n\tif (!client || !data || (size == 0)) {\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t}\n\n\tres = syslog_relay_error(service_receive_with_timeout(client->parent, data, size, (uint32_t*)&bytes, timeout));\n\tif (bytes <= 0) {\n\t\tdebug_info(\"Could not read data, error %d\", res);\n\t}\n\tif (received) {\n\t\t*received = (uint32_t)bytes;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"lockdown.h\"",
            "#include \"syslog_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_receive_with_timeout(syslog_relay_client_t client, char* data, uint32_t size, uint32_t *received, unsigned int timeout)\n{\n\tsyslog_relay_error_t res = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\tint bytes = 0;\n\n\tif (!client || !data || (size == 0)) {\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t}\n\n\tres = syslog_relay_error(service_receive_with_timeout(client->parent, data, size, (uint32_t*)&bytes, timeout));\n\tif (bytes <= 0) {\n\t\tdebug_info(\"Could not read data, error %d\", res);\n\t}\n\tif (received) {\n\t\t*received = (uint32_t)bytes;\n\t}\n\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_receive(syslog_relay_client_t client, char* data, uint32_t size, uint32_t *received)\n{\n\treturn syslog_relay_receive_with_timeout(client, data, size, received, 1000);\n}"
  },
  {
    "function_name": "syslog_relay_client_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
    "lines": "99-115",
    "snippet": "LIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_client_free(syslog_relay_client_t client)\n{\n\tif (!client)\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\n\tsyslog_relay_error_t err = syslog_relay_error(service_client_free(client->parent));\n\tclient->parent = NULL;\n\tif (client->worker) {\n\t\tdebug_info(\"Joining syslog capture callback worker thread\");\n\t\tthread_join(client->worker);\n\t\tthread_free(client->worker);\n\t\tclient->worker = (thread_t)NULL;\n\t}\n\tfree(client);\n\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"lockdown.h\"",
      "#include \"syslog_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "client"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "syslog_relay_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
          "lines": "99-115",
          "snippet": "LIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_client_free(syslog_relay_client_t client)\n{\n\tif (!client)\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\n\tsyslog_relay_error_t err = syslog_relay_error(service_client_free(client->parent));\n\tclient->parent = NULL;\n\tif (client->worker) {\n\t\tdebug_info(\"Joining syslog capture callback worker thread\");\n\t\tthread_join(client->worker);\n\t\tthread_free(client->worker);\n\t\tclient->worker = (thread_t)NULL;\n\t}\n\tfree(client);\n\n\treturn err;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "thread_free",
          "args": [
            "client->worker"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "thread_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "39-44",
          "snippet": "void thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "thread_join",
          "args": [
            "client->worker"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "thread_join",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "46-54",
          "snippet": "void thread_join(thread_t thread)\n{\n\t/* wait for thread to complete */\n#ifdef WIN32\n\tWaitForSingleObject(thread, INFINITE);\n#else\n\tpthread_join(thread, NULL);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_join(thread_t thread)\n{\n\t/* wait for thread to complete */\n#ifdef WIN32\n\tWaitForSingleObject(thread, INFINITE);\n#else\n\tpthread_join(thread, NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Joining syslog capture callback worker thread\""
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syslog_relay_error",
          "args": [
            "service_client_free(client->parent)"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "syslog_relay_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
          "lines": "47-62",
          "snippet": "static syslog_relay_error_t syslog_relay_error(service_error_t err)\n{\n\tswitch (err) {\n\t\tcase SERVICE_E_SUCCESS:\n\t\t\treturn SYSLOG_RELAY_E_SUCCESS;\n\t\tcase SERVICE_E_INVALID_ARG:\n\t\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t\tcase SERVICE_E_MUX_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_MUX_ERROR;\n\t\tcase SERVICE_E_SSL_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_SSL_ERROR;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SYSLOG_RELAY_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"lockdown.h\"",
            "#include \"syslog_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nstatic syslog_relay_error_t syslog_relay_error(service_error_t err)\n{\n\tswitch (err) {\n\t\tcase SERVICE_E_SUCCESS:\n\t\t\treturn SYSLOG_RELAY_E_SUCCESS;\n\t\tcase SERVICE_E_INVALID_ARG:\n\t\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t\tcase SERVICE_E_MUX_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_MUX_ERROR;\n\t\tcase SERVICE_E_SSL_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_SSL_ERROR;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SYSLOG_RELAY_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "service_client_free",
          "args": [
            "client->parent"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "device_link_service_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/device_link_service.c",
          "lines": "119-129",
          "snippet": "device_link_service_error_t device_link_service_client_free(device_link_service_client_t client)\n{\n\tif (!client)\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\n\tif (property_list_service_client_free(client->parent) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_UNKNOWN_ERROR;\n\t}\n\tfree(client);\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"device_link_service.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"device_link_service.h\"\n#include <stdlib.h>\n#include <string.h>\n\ndevice_link_service_error_t device_link_service_client_free(device_link_service_client_t client)\n{\n\tif (!client)\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\n\tif (property_list_service_client_free(client->parent) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_UNKNOWN_ERROR;\n\t}\n\tfree(client);\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_client_free(syslog_relay_client_t client)\n{\n\tif (!client)\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\n\tsyslog_relay_error_t err = syslog_relay_error(service_client_free(client->parent));\n\tclient->parent = NULL;\n\tif (client->worker) {\n\t\tdebug_info(\"Joining syslog capture callback worker thread\");\n\t\tthread_join(client->worker);\n\t\tthread_free(client->worker);\n\t\tclient->worker = (thread_t)NULL;\n\t}\n\tfree(client);\n\n\treturn err;\n}"
  },
  {
    "function_name": "syslog_relay_client_start_service",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
    "lines": "92-97",
    "snippet": "LIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_client_start_service(idevice_t device, syslog_relay_client_t * client, const char* label)\n{\n\tsyslog_relay_error_t err = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, SYSLOG_RELAY_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(syslog_relay_client_new), &err);\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"lockdown.h\"",
      "#include \"syslog_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_client_factory_start_service",
          "args": [
            "device",
            "SYSLOG_RELAY_SERVICE_NAME",
            "(void**)client",
            "label",
            "SERVICE_CONSTRUCTOR(syslog_relay_client_new)",
            "&err"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "service_client_factory_start_service",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/service.c",
          "lines": "79-116",
          "snippet": "LIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"idevice.h\"",
            "#include \"service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"idevice.h\"\n#include \"service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SERVICE_CONSTRUCTOR",
          "args": [
            "syslog_relay_client_new"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_client_start_service(idevice_t device, syslog_relay_client_t * client, const char* label)\n{\n\tsyslog_relay_error_t err = SYSLOG_RELAY_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, SYSLOG_RELAY_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(syslog_relay_client_new), &err);\n\treturn err;\n}"
  },
  {
    "function_name": "syslog_relay_client_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
    "lines": "64-90",
    "snippet": "LIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_client_new(idevice_t device, lockdownd_service_descriptor_t service, syslog_relay_client_t * client)\n{\n\t*client = NULL;\n\n\tif (!device || !service || service->port == 0 || !client || *client) {\n\t\tdebug_info(\"Incorrect parameter passed to syslog_relay_client_new.\");\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t}\n\n\tdebug_info(\"Creating syslog_relay_client, port = %d.\", service->port);\n\n\tservice_client_t parent = NULL;\n\tsyslog_relay_error_t ret = syslog_relay_error(service_client_new(device, service, &parent));\n\tif (ret != SYSLOG_RELAY_E_SUCCESS) {\n\t\tdebug_info(\"Creating base service client failed. Error: %i\", ret);\n\t\treturn ret;\n\t}\n\n\tsyslog_relay_client_t client_loc = (syslog_relay_client_t) malloc(sizeof(struct syslog_relay_client_private));\n\tclient_loc->parent = parent;\n\tclient_loc->worker = (thread_t)NULL;\n\n\t*client = client_loc;\n\n\tdebug_info(\"syslog_relay_client successfully created.\");\n\treturn 0;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"lockdown.h\"",
      "#include \"syslog_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"syslog_relay_client successfully created.\""
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct syslog_relay_client_private)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Creating base service client failed. Error: %i\"",
            "ret"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syslog_relay_error",
          "args": [
            "service_client_new(device, service, &parent)"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "syslog_relay_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
          "lines": "47-62",
          "snippet": "static syslog_relay_error_t syslog_relay_error(service_error_t err)\n{\n\tswitch (err) {\n\t\tcase SERVICE_E_SUCCESS:\n\t\t\treturn SYSLOG_RELAY_E_SUCCESS;\n\t\tcase SERVICE_E_INVALID_ARG:\n\t\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t\tcase SERVICE_E_MUX_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_MUX_ERROR;\n\t\tcase SERVICE_E_SSL_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_SSL_ERROR;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SYSLOG_RELAY_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"lockdown.h\"",
            "#include \"syslog_relay.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nstatic syslog_relay_error_t syslog_relay_error(service_error_t err)\n{\n\tswitch (err) {\n\t\tcase SERVICE_E_SUCCESS:\n\t\t\treturn SYSLOG_RELAY_E_SUCCESS;\n\t\tcase SERVICE_E_INVALID_ARG:\n\t\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t\tcase SERVICE_E_MUX_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_MUX_ERROR;\n\t\tcase SERVICE_E_SSL_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_SSL_ERROR;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SYSLOG_RELAY_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "service_client_new",
          "args": [
            "device",
            "service",
            "&parent"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "device_link_service_client_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/device_link_service.c",
          "lines": "85-107",
          "snippet": "device_link_service_error_t device_link_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, device_link_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client) {\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\t}\n\n\tproperty_list_service_client_t plistclient = NULL;\n\tif (property_list_service_client_new(device, service, &plistclient) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\n\t/* create client object */\n\tdevice_link_service_client_t client_loc = (device_link_service_client_t) malloc(sizeof(struct device_link_service_client_private));\n\tclient_loc->parent = plistclient;\n\n\t/* enable SSL if requested */\n\tif (service->ssl_enabled)\n\t\tproperty_list_service_enable_ssl(client_loc->parent);\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"device_link_service.h\"",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"device_link_service.h\"\n#include <stdlib.h>\n#include <string.h>\n\ndevice_link_service_error_t device_link_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, device_link_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client) {\n\t\treturn DEVICE_LINK_SERVICE_E_INVALID_ARG;\n\t}\n\n\tproperty_list_service_client_t plistclient = NULL;\n\tif (property_list_service_client_new(device, service, &plistclient) != PROPERTY_LIST_SERVICE_E_SUCCESS) {\n\t\treturn DEVICE_LINK_SERVICE_E_MUX_ERROR;\n\t}\n\n\t/* create client object */\n\tdevice_link_service_client_t client_loc = (device_link_service_client_t) malloc(sizeof(struct device_link_service_client_private));\n\tclient_loc->parent = plistclient;\n\n\t/* enable SSL if requested */\n\tif (service->ssl_enabled)\n\t\tproperty_list_service_enable_ssl(client_loc->parent);\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn DEVICE_LINK_SERVICE_E_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Creating syslog_relay_client, port = %d.\"",
            "service->port"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Incorrect parameter passed to syslog_relay_client_new.\""
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API syslog_relay_error_t syslog_relay_client_new(idevice_t device, lockdownd_service_descriptor_t service, syslog_relay_client_t * client)\n{\n\t*client = NULL;\n\n\tif (!device || !service || service->port == 0 || !client || *client) {\n\t\tdebug_info(\"Incorrect parameter passed to syslog_relay_client_new.\");\n\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t}\n\n\tdebug_info(\"Creating syslog_relay_client, port = %d.\", service->port);\n\n\tservice_client_t parent = NULL;\n\tsyslog_relay_error_t ret = syslog_relay_error(service_client_new(device, service, &parent));\n\tif (ret != SYSLOG_RELAY_E_SUCCESS) {\n\t\tdebug_info(\"Creating base service client failed. Error: %i\", ret);\n\t\treturn ret;\n\t}\n\n\tsyslog_relay_client_t client_loc = (syslog_relay_client_t) malloc(sizeof(struct syslog_relay_client_private));\n\tclient_loc->parent = parent;\n\tclient_loc->worker = (thread_t)NULL;\n\n\t*client = client_loc;\n\n\tdebug_info(\"syslog_relay_client successfully created.\");\n\treturn 0;\n}"
  },
  {
    "function_name": "syslog_relay_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/syslog_relay.c",
    "lines": "47-62",
    "snippet": "static syslog_relay_error_t syslog_relay_error(service_error_t err)\n{\n\tswitch (err) {\n\t\tcase SERVICE_E_SUCCESS:\n\t\t\treturn SYSLOG_RELAY_E_SUCCESS;\n\t\tcase SERVICE_E_INVALID_ARG:\n\t\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t\tcase SERVICE_E_MUX_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_MUX_ERROR;\n\t\tcase SERVICE_E_SSL_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_SSL_ERROR;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SYSLOG_RELAY_E_UNKNOWN_ERROR;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"lockdown.h\"",
      "#include \"syslog_relay.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"lockdown.h\"\n#include \"syslog_relay.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <config.h>\n\nstatic syslog_relay_error_t syslog_relay_error(service_error_t err)\n{\n\tswitch (err) {\n\t\tcase SERVICE_E_SUCCESS:\n\t\t\treturn SYSLOG_RELAY_E_SUCCESS;\n\t\tcase SERVICE_E_INVALID_ARG:\n\t\t\treturn SYSLOG_RELAY_E_INVALID_ARG;\n\t\tcase SERVICE_E_MUX_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_MUX_ERROR;\n\t\tcase SERVICE_E_SSL_ERROR:\n\t\t\treturn SYSLOG_RELAY_E_SSL_ERROR;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn SYSLOG_RELAY_E_UNKNOWN_ERROR;\n}"
  }
]