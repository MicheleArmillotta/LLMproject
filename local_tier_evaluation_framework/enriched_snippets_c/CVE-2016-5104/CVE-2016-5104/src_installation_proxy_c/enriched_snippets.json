[
  {
    "function_name": "nstproxy_client_get_path_for_bundle_identifier(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "984-1058",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_client_get_path_for_bundle_identifier(instproxy_client_t client, const char* appid, char** path)\n{\n\tif (!client || !client->parent || !appid)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tplist_t apps = NULL;\n\n\t// create client options for any application types\n\tplist_t client_opts = instproxy_client_options_new();\n\tinstproxy_client_options_add(client_opts, \"ApplicationType\", \"Any\", NULL);\n\n\t// only return attributes we need\n\tinstproxy_client_options_set_return_attributes(client_opts, \"CFBundleIdentifier\", \"CFBundleExecutable\", \"Path\", NULL);\n\n\t// only query for specific appid\n\tconst char* appids[] = {appid, NULL};\n\n\t// query device for list of apps\n\tinstproxy_error_t ierr = instproxy_lookup(client, appids, client_opts, &apps);\n\n\tinstproxy_client_options_free(client_opts);\n\n\tif (ierr != INSTPROXY_E_SUCCESS) {\n\t\treturn ierr;\n\t}\n\n\tplist_t app_found = plist_access_path(apps, 1, appid);\n\tif (!app_found) {\n\t\tif (apps)\n\t\t\tplist_free(apps);\n\t\t*path = NULL;\n\t\treturn INSTPROXY_E_OP_FAILED;\n\t}\n\n\tchar* path_str = NULL;\n\tplist_t path_p = plist_dict_get_item(app_found, \"Path\");\n\tif (path_p) {\n\t\tplist_get_string_val(path_p, &path_str);\n\t}\n\n\tchar* exec_str = NULL;\n\tplist_t exec_p = plist_dict_get_item(app_found, \"CFBundleExecutable\");\n\tif (exec_p) {\n\t\tplist_get_string_val(exec_p, &exec_str);\n\t}\n\n\tif (!path_str) {\n\t\tdebug_info(\"app path not found\");\n\t\treturn INSTPROXY_E_OP_FAILED;\n\t}\n\n\tif (!exec_str) {\n\t\tdebug_info(\"bundle executable not found\");\n\t\treturn INSTPROXY_E_OP_FAILED;\n\t}\n\n\tplist_free(apps);\n\n\tchar* ret = (char*)malloc(strlen(path_str) + 1 + strlen(exec_str) + 1);\n\tstrcpy(ret, path_str);\n\tstrcat(ret, \"/\");\n\tstrcat(ret, exec_str);\n\n\t*path = ret;\n\n\tif (path_str) {\n\t\tfree(path_str);\n\t}\n\n\tif (exec_str) {\n\t\tfree(exec_str);\n\t}\n\n\treturn INSTPROXY_E_SUCCESS;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ree(",
          "args": [
            "xec_str)"
          ],
          "line": 1054
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_client_options_free(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "977-982",
          "snippet": "IBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "trcat(",
          "args": [
            "et,",
            "xec_str)"
          ],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trcat(",
          "args": [
            "et,",
            "/\")"
          ],
          "line": 1044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trcpy(",
          "args": [
            "et,",
            "ath_str)"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc(",
          "args": [
            "trlen(path_str) + 1 + strlen(exec_str) + 1)"
          ],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trlen(",
          "args": [
            "xec_str)"
          ],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trlen(",
          "args": [
            "ath_str)"
          ],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "pps)"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ebug_info(",
          "args": [
            "bundle executable not found\")"
          ],
          "line": 1036
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ebug_info(",
          "args": [
            "app path not found\")"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_get_string_val(",
          "args": [
            "xec_p,",
            "exec_str)"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "pp_found,",
            "CFBundleExecutable\")"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_get_string_val(",
          "args": [
            "ath_p,",
            "path_str)"
          ],
          "line": 1021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "pp_found,",
            "Path\")"
          ],
          "line": 1019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "pps)"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_access_path(",
          "args": [
            "pps,",
            ",",
            "ppid)"
          ],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_lookup(",
          "args": [
            "lient,",
            "ppids,",
            "lient_opts,",
            "apps)"
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_lookup(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "608-653",
          "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_lookup(instproxy_client_t client, const char** appids, plist_t client_options, plist_t *result)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\tint i = 0;\n\tplist_t lookup_result = NULL;\n\tplist_t command = NULL;\n\tplist_t appid_array = NULL;\n\tplist_t node = NULL;\n\n\tif (!client || !client->parent || !result)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tcommand = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Lookup\"));\n\tif (client_options) {\n\t\tnode = plist_copy(client_options);\n\t} else if (appids) {\n\t\tnode = plist_new_dict();\n\t}\n\n\t/* add bundle identifiers to client options */\n\tif (appids) {\n\t\tappid_array = plist_new_array();\n\t\twhile (appids[i]) {\n\t\t\tplist_array_append_item(appid_array, plist_new_string(appids[i]));\n\t\t\ti++;\n\t\t}\n\t\tplist_dict_set_item(node, \"BundleIDs\", appid_array);\n\t}\n\n\tif (node) {\n\t\tplist_dict_set_item(command, \"ClientOptions\", node);\n\t}\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_SYNC, instproxy_copy_lookup_result_cb, (void*)&lookup_result);\n\n\tif (res == INSTPROXY_E_SUCCESS) {\n\t\t*result = lookup_result;\n\t} else {\n\t\tplist_free(lookup_result);\n\t}\n\n\tplist_free(command);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_lookup(instproxy_client_t client, const char** appids, plist_t client_options, plist_t *result)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\tint i = 0;\n\tplist_t lookup_result = NULL;\n\tplist_t command = NULL;\n\tplist_t appid_array = NULL;\n\tplist_t node = NULL;\n\n\tif (!client || !client->parent || !result)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tcommand = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Lookup\"));\n\tif (client_options) {\n\t\tnode = plist_copy(client_options);\n\t} else if (appids) {\n\t\tnode = plist_new_dict();\n\t}\n\n\t/* add bundle identifiers to client options */\n\tif (appids) {\n\t\tappid_array = plist_new_array();\n\t\twhile (appids[i]) {\n\t\t\tplist_array_append_item(appid_array, plist_new_string(appids[i]));\n\t\t\ti++;\n\t\t}\n\t\tplist_dict_set_item(node, \"BundleIDs\", appid_array);\n\t}\n\n\tif (node) {\n\t\tplist_dict_set_item(command, \"ClientOptions\", node);\n\t}\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_SYNC, instproxy_copy_lookup_result_cb, (void*)&lookup_result);\n\n\tif (res == INSTPROXY_E_SUCCESS) {\n\t\t*result = lookup_result;\n\t} else {\n\t\tplist_free(lookup_result);\n\t}\n\n\tplist_free(command);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nstproxy_client_options_set_return_attributes(",
          "args": [
            "lient_opts,",
            "CFBundleIdentifier\",",
            "CFBundleExecutable\",",
            "Path\",",
            "ULL)"
          ],
          "line": 996
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_client_options_set_return_attributes(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "956-975",
          "snippet": "IBIMOBILEDEVICE_API void instproxy_client_options_set_return_attributes(plist_t client_options, ...)\n{\n\tif (!client_options)\n\t\treturn;\n\n\tplist_t return_attributes = plist_new_array();\n\n\tva_list args;\n\tva_start(args, client_options);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tchar *attribute = strdup(arg);\n\t\tplist_array_append_item(return_attributes, plist_new_string(attribute));\n\t\tfree(attribute);\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n\n\tplist_dict_set_item(client_options, \"ReturnAttributes\", return_attributes);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_client_options_set_return_attributes(plist_t client_options, ...)\n{\n\tif (!client_options)\n\t\treturn;\n\n\tplist_t return_attributes = plist_new_array();\n\n\tva_list args;\n\tva_start(args, client_options);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tchar *attribute = strdup(arg);\n\t\tplist_array_append_item(return_attributes, plist_new_string(attribute));\n\t\tfree(attribute);\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n\n\tplist_dict_set_item(client_options, \"ReturnAttributes\", return_attributes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nstproxy_client_options_add(",
          "args": [
            "lient_opts,",
            "ApplicationType\",",
            "Any\",",
            "ULL)"
          ],
          "line": 993
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_client_options_add(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "922-954",
          "snippet": "IBIMOBILEDEVICE_API void instproxy_client_options_add(plist_t client_options, ...)\n{\n\tif (!client_options)\n\t\treturn;\n\n\tva_list args;\n\tva_start(args, client_options);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tchar *key = strdup(arg);\n\t\tif (!strcmp(key, \"SkipUninstall\")) {\n\t\t\tint intval = va_arg(args, int);\n\t\t\tplist_dict_set_item(client_options, key, plist_new_bool(intval));\n\t\t} else if (!strcmp(key, \"ApplicationSINF\") || !strcmp(key, \"iTunesMetadata\") || !strcmp(key, \"ReturnAttributes\")) {\n\t\t\tplist_t plistval = va_arg(args, plist_t);\n\t\t\tif (!plistval) {\n\t\t\t\tfree(key);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tplist_dict_set_item(client_options, key, plist_copy(plistval));\n\t\t} else {\n\t\t\tchar *strval = va_arg(args, char*);\n\t\t\tif (!strval) {\n\t\t\t\tfree(key);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tplist_dict_set_item(client_options, key, plist_new_string(strval));\n\t\t}\n\t\tfree(key);\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_client_options_add(plist_t client_options, ...)\n{\n\tif (!client_options)\n\t\treturn;\n\n\tva_list args;\n\tva_start(args, client_options);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tchar *key = strdup(arg);\n\t\tif (!strcmp(key, \"SkipUninstall\")) {\n\t\t\tint intval = va_arg(args, int);\n\t\t\tplist_dict_set_item(client_options, key, plist_new_bool(intval));\n\t\t} else if (!strcmp(key, \"ApplicationSINF\") || !strcmp(key, \"iTunesMetadata\") || !strcmp(key, \"ReturnAttributes\")) {\n\t\t\tplist_t plistval = va_arg(args, plist_t);\n\t\t\tif (!plistval) {\n\t\t\t\tfree(key);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tplist_dict_set_item(client_options, key, plist_copy(plistval));\n\t\t} else {\n\t\t\tchar *strval = va_arg(args, char*);\n\t\t\tif (!strval) {\n\t\t\t\tfree(key);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tplist_dict_set_item(client_options, key, plist_new_string(strval));\n\t\t}\n\t\tfree(key);\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nstproxy_client_options_new(",
          "args": [],
          "line": 992
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_client_get_path_for_bundle_identifier(instproxy_client_t client, const char* appid, char** path)\n{\n\tif (!client || !client->parent || !appid)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tplist_t apps = NULL;\n\n\t// create client options for any application types\n\tplist_t client_opts = instproxy_client_options_new();\n\tinstproxy_client_options_add(client_opts, \"ApplicationType\", \"Any\", NULL);\n\n\t// only return attributes we need\n\tinstproxy_client_options_set_return_attributes(client_opts, \"CFBundleIdentifier\", \"CFBundleExecutable\", \"Path\", NULL);\n\n\t// only query for specific appid\n\tconst char* appids[] = {appid, NULL};\n\n\t// query device for list of apps\n\tinstproxy_error_t ierr = instproxy_lookup(client, appids, client_opts, &apps);\n\n\tinstproxy_client_options_free(client_opts);\n\n\tif (ierr != INSTPROXY_E_SUCCESS) {\n\t\treturn ierr;\n\t}\n\n\tplist_t app_found = plist_access_path(apps, 1, appid);\n\tif (!app_found) {\n\t\tif (apps)\n\t\t\tplist_free(apps);\n\t\t*path = NULL;\n\t\treturn INSTPROXY_E_OP_FAILED;\n\t}\n\n\tchar* path_str = NULL;\n\tplist_t path_p = plist_dict_get_item(app_found, \"Path\");\n\tif (path_p) {\n\t\tplist_get_string_val(path_p, &path_str);\n\t}\n\n\tchar* exec_str = NULL;\n\tplist_t exec_p = plist_dict_get_item(app_found, \"CFBundleExecutable\");\n\tif (exec_p) {\n\t\tplist_get_string_val(exec_p, &exec_str);\n\t}\n\n\tif (!path_str) {\n\t\tdebug_info(\"app path not found\");\n\t\treturn INSTPROXY_E_OP_FAILED;\n\t}\n\n\tif (!exec_str) {\n\t\tdebug_info(\"bundle executable not found\");\n\t\treturn INSTPROXY_E_OP_FAILED;\n\t}\n\n\tplist_free(apps);\n\n\tchar* ret = (char*)malloc(strlen(path_str) + 1 + strlen(exec_str) + 1);\n\tstrcpy(ret, path_str);\n\tstrcat(ret, \"/\");\n\tstrcat(ret, exec_str);\n\n\t*path = ret;\n\n\tif (path_str) {\n\t\tfree(path_str);\n\t}\n\n\tif (exec_str) {\n\t\tfree(exec_str);\n\t}\n\n\treturn INSTPROXY_E_SUCCESS;\n}"
  },
  {
    "function_name": "nstproxy_client_options_free(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "977-982",
    "snippet": "IBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "lient_options)"
          ],
          "line": 980
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}"
  },
  {
    "function_name": "nstproxy_client_options_set_return_attributes(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "956-975",
    "snippet": "IBIMOBILEDEVICE_API void instproxy_client_options_set_return_attributes(plist_t client_options, ...)\n{\n\tif (!client_options)\n\t\treturn;\n\n\tplist_t return_attributes = plist_new_array();\n\n\tva_list args;\n\tva_start(args, client_options);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tchar *attribute = strdup(arg);\n\t\tplist_array_append_item(return_attributes, plist_new_string(attribute));\n\t\tfree(attribute);\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n\n\tplist_dict_set_item(client_options, \"ReturnAttributes\", return_attributes);\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "lient_options,",
            "ReturnAttributes\",",
            "eturn_attributes)"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a_end(",
          "args": [
            "rgs)"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a_arg(",
          "args": [
            "rgs,",
            "har*)"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ree(",
          "args": [
            "ttribute)"
          ],
          "line": 969
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_client_options_free(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "977-982",
          "snippet": "IBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_array_append_item(",
          "args": [
            "eturn_attributes,",
            "list_new_string(attribute))"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "ttribute)"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trdup(",
          "args": [
            "rg)"
          ],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a_arg(",
          "args": [
            "rgs,",
            "har*)"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a_start(",
          "args": [
            "rgs,",
            "lient_options)"
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_array(",
          "args": [],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_client_options_set_return_attributes(plist_t client_options, ...)\n{\n\tif (!client_options)\n\t\treturn;\n\n\tplist_t return_attributes = plist_new_array();\n\n\tva_list args;\n\tva_start(args, client_options);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tchar *attribute = strdup(arg);\n\t\tplist_array_append_item(return_attributes, plist_new_string(attribute));\n\t\tfree(attribute);\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n\n\tplist_dict_set_item(client_options, \"ReturnAttributes\", return_attributes);\n}"
  },
  {
    "function_name": "nstproxy_client_options_add(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "922-954",
    "snippet": "IBIMOBILEDEVICE_API void instproxy_client_options_add(plist_t client_options, ...)\n{\n\tif (!client_options)\n\t\treturn;\n\n\tva_list args;\n\tva_start(args, client_options);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tchar *key = strdup(arg);\n\t\tif (!strcmp(key, \"SkipUninstall\")) {\n\t\t\tint intval = va_arg(args, int);\n\t\t\tplist_dict_set_item(client_options, key, plist_new_bool(intval));\n\t\t} else if (!strcmp(key, \"ApplicationSINF\") || !strcmp(key, \"iTunesMetadata\") || !strcmp(key, \"ReturnAttributes\")) {\n\t\t\tplist_t plistval = va_arg(args, plist_t);\n\t\t\tif (!plistval) {\n\t\t\t\tfree(key);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tplist_dict_set_item(client_options, key, plist_copy(plistval));\n\t\t} else {\n\t\t\tchar *strval = va_arg(args, char*);\n\t\t\tif (!strval) {\n\t\t\t\tfree(key);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tplist_dict_set_item(client_options, key, plist_new_string(strval));\n\t\t}\n\t\tfree(key);\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a_end(",
          "args": [
            "rgs)"
          ],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a_arg(",
          "args": [
            "rgs,",
            "har*)"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ree(",
          "args": [
            "ey)"
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_client_options_free(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "977-982",
          "snippet": "IBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "lient_options,",
            "ey,",
            "list_new_string(strval))"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "trval)"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a_arg(",
          "args": [
            "rgs,",
            "har*)"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "lient_options,",
            "ey,",
            "list_copy(plistval))"
          ],
          "line": 941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "listval)"
          ],
          "line": 941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a_arg(",
          "args": [
            "rgs,",
            "list_t)"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trcmp(",
          "args": [
            "ey,",
            "ReturnAttributes\")"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trcmp(",
          "args": [
            "ey,",
            "iTunesMetadata\")"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trcmp(",
          "args": [
            "ey,",
            "ApplicationSINF\")"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "lient_options,",
            "ey,",
            "list_new_bool(intval))"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_bool(",
          "args": [
            "ntval)"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a_arg(",
          "args": [
            "rgs,",
            "nt)"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trcmp(",
          "args": [
            "ey,",
            "SkipUninstall\")"
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trdup(",
          "args": [
            "rg)"
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a_arg(",
          "args": [
            "rgs,",
            "har*)"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "a_start(",
          "args": [
            "rgs,",
            "lient_options)"
          ],
          "line": 928
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_client_options_add(plist_t client_options, ...)\n{\n\tif (!client_options)\n\t\treturn;\n\n\tva_list args;\n\tva_start(args, client_options);\n\tchar *arg = va_arg(args, char*);\n\twhile (arg) {\n\t\tchar *key = strdup(arg);\n\t\tif (!strcmp(key, \"SkipUninstall\")) {\n\t\t\tint intval = va_arg(args, int);\n\t\t\tplist_dict_set_item(client_options, key, plist_new_bool(intval));\n\t\t} else if (!strcmp(key, \"ApplicationSINF\") || !strcmp(key, \"iTunesMetadata\") || !strcmp(key, \"ReturnAttributes\")) {\n\t\t\tplist_t plistval = va_arg(args, plist_t);\n\t\t\tif (!plistval) {\n\t\t\t\tfree(key);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tplist_dict_set_item(client_options, key, plist_copy(plistval));\n\t\t} else {\n\t\t\tchar *strval = va_arg(args, char*);\n\t\t\tif (!strval) {\n\t\t\t\tfree(key);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tplist_dict_set_item(client_options, key, plist_new_string(strval));\n\t\t}\n\t\tfree(key);\n\t\targ = va_arg(args, char*);\n\t}\n\tva_end(args);\n}"
  },
  {
    "function_name": "nstproxy_client_options_new(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "917-920",
    "snippet": "IBIMOBILEDEVICE_API plist_t instproxy_client_options_new(void)\n{\n\treturn plist_new_dict();\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API plist_t instproxy_client_options_new(void)\n{\n\treturn plist_new_dict();\n}"
  },
  {
    "function_name": "nstproxy_command_get_name(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "908-915",
    "snippet": "IBIMOBILEDEVICE_API void instproxy_command_get_name(plist_t command, char** name)\n{\n\t*name = NULL;\n\tplist_t node = plist_dict_get_item(command, \"Command\");\n\tif (node) {\n\t\tplist_get_string_val(node, name);\n\t}\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_get_string_val(",
          "args": [
            "ode,",
            "ame)"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "ommand,",
            "Command\")"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_command_get_name(plist_t command, char** name)\n{\n\t*name = NULL;\n\tplist_t node = plist_dict_get_item(command, \"Command\");\n\tif (node) {\n\t\tplist_get_string_val(node, name);\n\t}\n}"
  },
  {
    "function_name": "nstproxy_status_get_current_list(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "871-906",
    "snippet": "IBIMOBILEDEVICE_API void instproxy_status_get_current_list(plist_t status, uint64_t* total, uint64_t* current_index, uint64_t* current_amount, plist_t* list)\n{\n\tplist_t node = NULL;\n\n\tif (status && plist_get_node_type(status) == PLIST_DICT) {\n\t\t/* command specific logic: parse browsed list */\n\t\tif (list != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentList\");\n\t\t\tif (node) {\n\t\t\t\t*current_amount = plist_array_get_size(node);\n\t\t\t\t*list = plist_copy(node);\n\t\t\t}\n\t\t}\n\n\t\tif (total != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"Total\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, total);\n\t\t\t}\n\t\t}\n\n\t\tif (current_amount != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentAmount\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, current_amount);\n\t\t\t}\n\t\t}\n\n\t\tif (current_index != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentIndex\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, current_index);\n\t\t\t}\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_get_uint_val(",
          "args": [
            "ode,",
            "urrent_index)"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "tatus,",
            "CurrentIndex\")"
          ],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_get_uint_val(",
          "args": [
            "ode,",
            "urrent_amount)"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "tatus,",
            "CurrentAmount\")"
          ],
          "line": 893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_get_uint_val(",
          "args": [
            "ode,",
            "otal)"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "tatus,",
            "Total\")"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "ode)"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_array_get_size(",
          "args": [
            "ode)"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "tatus,",
            "CurrentList\")"
          ],
          "line": 878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_get_node_type(",
          "args": [
            "tatus)"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_status_get_current_list(plist_t status, uint64_t* total, uint64_t* current_index, uint64_t* current_amount, plist_t* list)\n{\n\tplist_t node = NULL;\n\n\tif (status && plist_get_node_type(status) == PLIST_DICT) {\n\t\t/* command specific logic: parse browsed list */\n\t\tif (list != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentList\");\n\t\t\tif (node) {\n\t\t\t\t*current_amount = plist_array_get_size(node);\n\t\t\t\t*list = plist_copy(node);\n\t\t\t}\n\t\t}\n\n\t\tif (total != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"Total\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, total);\n\t\t\t}\n\t\t}\n\n\t\tif (current_amount != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentAmount\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, current_amount);\n\t\t\t}\n\t\t}\n\n\t\tif (current_index != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentIndex\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, current_index);\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "nstproxy_status_get_percent_complete(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "859-869",
    "snippet": "IBIMOBILEDEVICE_API void instproxy_status_get_percent_complete(plist_t status, int *percent)\n{\n\tuint64_t val = 0;\n\tif (percent) {\n\t\tplist_t node = plist_dict_get_item(status, \"PercentComplete\");\n\t\tif (node) {\n\t\t\tplist_get_uint_val(node, &val);\n\t\t\t*percent = val;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_get_uint_val(",
          "args": [
            "ode,",
            "val)"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "tatus,",
            "PercentComplete\")"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_status_get_percent_complete(plist_t status, int *percent)\n{\n\tuint64_t val = 0;\n\tif (percent) {\n\t\tplist_t node = plist_dict_get_item(status, \"PercentComplete\");\n\t\tif (node) {\n\t\t\tplist_get_uint_val(node, &val);\n\t\t\t*percent = val;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "nstproxy_status_get_name(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "848-857",
    "snippet": "IBIMOBILEDEVICE_API void instproxy_status_get_name(plist_t status, char **name)\n{\n\t*name = NULL;\n\tif (name) {\n\t\tplist_t node = plist_dict_get_item(status, \"Status\");\n\t\tif (node) {\n\t\t\tplist_get_string_val(node, name);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_get_string_val(",
          "args": [
            "ode,",
            "ame)"
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "tatus,",
            "Status\")"
          ],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_status_get_name(plist_t status, char **name)\n{\n\t*name = NULL;\n\tif (name) {\n\t\tplist_t node = plist_dict_get_item(status, \"Status\");\n\t\tif (node) {\n\t\t\tplist_get_string_val(node, name);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "nstproxy_status_get_error(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "810-846",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_status_get_error(plist_t status, char **name, char** description, uint64_t* code)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tif (!status || !name)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tplist_t node = plist_dict_get_item(status, \"Error\");\n\tif (node) {\n\t\tplist_get_string_val(node, name);\n\t} else {\n\t\t/* no error here */\n\t\tres = INSTPROXY_E_SUCCESS;\n\t}\n\n\tif (code != NULL) {\n\t\t*code = 0;\n\t\tnode = plist_dict_get_item(status, \"ErrorDetail\");\n\t\tif (node) {\n\t\t\tplist_get_uint_val(node, code);\n\t\t\t*code &= 0xffffffff;\n\t\t}\n\t}\n\n\tif (description != NULL) {\n\t\tnode = plist_dict_get_item(status, \"ErrorDescription\");\n\t\tif (node) {\n\t\t\tplist_get_string_val(node, description);\n\t\t}\n\t}\n\n\tif (*name) {\n\t\tres = instproxy_strtoerr(*name);\n\t}\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nstproxy_strtoerr(",
          "args": [
            "name)"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_get_string_val(",
          "args": [
            "ode,",
            "escription)"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "tatus,",
            "ErrorDescription\")"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_get_uint_val(",
          "args": [
            "ode,",
            "ode)"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "tatus,",
            "ErrorDetail\")"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_get_string_val(",
          "args": [
            "ode,",
            "ame)"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "tatus,",
            "Error\")"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_status_get_error(plist_t status, char **name, char** description, uint64_t* code)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tif (!status || !name)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tplist_t node = plist_dict_get_item(status, \"Error\");\n\tif (node) {\n\t\tplist_get_string_val(node, name);\n\t} else {\n\t\t/* no error here */\n\t\tres = INSTPROXY_E_SUCCESS;\n\t}\n\n\tif (code != NULL) {\n\t\t*code = 0;\n\t\tnode = plist_dict_get_item(status, \"ErrorDetail\");\n\t\tif (node) {\n\t\t\tplist_get_uint_val(node, code);\n\t\t\t*code &= 0xffffffff;\n\t\t}\n\t}\n\n\tif (description != NULL) {\n\t\tnode = plist_dict_get_item(status, \"ErrorDescription\");\n\t\tif (node) {\n\t\t\tplist_get_string_val(node, description);\n\t\t}\n\t}\n\n\tif (*name) {\n\t\tres = instproxy_strtoerr(*name);\n\t}\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_check_capabilities_match(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "773-808",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_check_capabilities_match(instproxy_client_t client, const char** capabilities, plist_t client_options, plist_t *result)\n{\n\tif (!capabilities || (plist_get_node_type(capabilities) != PLIST_ARRAY && plist_get_node_type(capabilities) != PLIST_DICT))\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tplist_t lookup_result = NULL;\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"CheckCapabilitiesMatch\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\n\tif (capabilities) {\n\t\tint i = 0;\n\t\tplist_t capabilities_array = plist_new_array();\n\t\twhile (capabilities[i]) {\n\t\t\tplist_array_append_item(capabilities_array, plist_new_string(capabilities[i]));\n\t\t\ti++;\n\t\t}\n\t\tplist_dict_set_item(command, \"Capabilities\", capabilities_array);\n\t}\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_SYNC, instproxy_copy_lookup_result_cb, (void*)&lookup_result);\n\n\tif (res == INSTPROXY_E_SUCCESS) {\n\t\t*result = lookup_result;\n\t} else {\n\t\tplist_free(lookup_result);\n\t}\n\n\tplist_free(command);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ommand)"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ookup_result)"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_perform_command(",
          "args": [
            "lient,",
            "ommand,",
            "NSTPROXY_COMMAND_TYPE_SYNC,",
            "nstproxy_copy_lookup_result_cb,",
            "void*)&lookup_result)"
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_perform_command(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "507-528",
          "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Capabilities\",",
            "apabilities_array)"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_array_append_item(",
          "args": [
            "apabilities_array,",
            "list_new_string(capabilities[i]))"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "apabilities[i])"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_array(",
          "args": [],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ClientOptions\",",
            "list_copy(client_options))"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "lient_options)"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Command\",",
            "list_new_string(\"CheckCapabilitiesMatch\"))"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "CheckCapabilitiesMatch\")"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_get_node_type(",
          "args": [
            "apabilities)"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_get_node_type(",
          "args": [
            "apabilities)"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_check_capabilities_match(instproxy_client_t client, const char** capabilities, plist_t client_options, plist_t *result)\n{\n\tif (!capabilities || (plist_get_node_type(capabilities) != PLIST_ARRAY && plist_get_node_type(capabilities) != PLIST_DICT))\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tplist_t lookup_result = NULL;\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"CheckCapabilitiesMatch\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\n\tif (capabilities) {\n\t\tint i = 0;\n\t\tplist_t capabilities_array = plist_new_array();\n\t\twhile (capabilities[i]) {\n\t\t\tplist_array_append_item(capabilities_array, plist_new_string(capabilities[i]));\n\t\t\ti++;\n\t\t}\n\t\tplist_dict_set_item(command, \"Capabilities\", capabilities_array);\n\t}\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_SYNC, instproxy_copy_lookup_result_cb, (void*)&lookup_result);\n\n\tif (res == INSTPROXY_E_SUCCESS) {\n\t\t*result = lookup_result;\n\t} else {\n\t\tplist_free(lookup_result);\n\t}\n\n\tplist_free(command);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_remove_archive(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "756-771",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_remove_archive(instproxy_client_t client, const char *appid, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"RemoveArchive\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"ApplicationIdentifier\", plist_new_string(appid));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ommand)"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_perform_command(",
          "args": [
            "lient,",
            "ommand,",
            "NSTPROXY_COMMAND_TYPE_ASYNC,",
            "tatus_cb,",
            "ser_data)"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_perform_command(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "507-528",
          "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ApplicationIdentifier\",",
            "list_new_string(appid))"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "ppid)"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ClientOptions\",",
            "list_copy(client_options))"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "lient_options)"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Command\",",
            "list_new_string(\"RemoveArchive\"))"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "RemoveArchive\")"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_remove_archive(instproxy_client_t client, const char *appid, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"RemoveArchive\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"ApplicationIdentifier\", plist_new_string(appid));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_restore(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "739-754",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_restore(instproxy_client_t client, const char *appid, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Restore\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"ApplicationIdentifier\", plist_new_string(appid));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ommand)"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_perform_command(",
          "args": [
            "lient,",
            "ommand,",
            "NSTPROXY_COMMAND_TYPE_ASYNC,",
            "tatus_cb,",
            "ser_data)"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_perform_command(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "507-528",
          "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ApplicationIdentifier\",",
            "list_new_string(appid))"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "ppid)"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ClientOptions\",",
            "list_copy(client_options))"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "lient_options)"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Command\",",
            "list_new_string(\"Restore\"))"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "Restore\")"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_restore(instproxy_client_t client, const char *appid, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Restore\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"ApplicationIdentifier\", plist_new_string(appid));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_archive(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "722-737",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_archive(instproxy_client_t client, const char *appid, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Archive\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"ApplicationIdentifier\", plist_new_string(appid));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ommand)"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_perform_command(",
          "args": [
            "lient,",
            "ommand,",
            "NSTPROXY_COMMAND_TYPE_ASYNC,",
            "tatus_cb,",
            "ser_data)"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_perform_command(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "507-528",
          "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ApplicationIdentifier\",",
            "list_new_string(appid))"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "ppid)"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ClientOptions\",",
            "list_copy(client_options))"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "lient_options)"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Command\",",
            "list_new_string(\"Archive\"))"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "Archive\")"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_archive(instproxy_client_t client, const char *appid, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Archive\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"ApplicationIdentifier\", plist_new_string(appid));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_lookup_archives(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "706-720",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_lookup_archives(instproxy_client_t client, plist_t client_options, plist_t *result)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"LookupArchives\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_SYNC, instproxy_copy_lookup_result_cb, (void*)result);\n\n\tplist_free(command);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ommand)"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_perform_command(",
          "args": [
            "lient,",
            "ommand,",
            "NSTPROXY_COMMAND_TYPE_SYNC,",
            "nstproxy_copy_lookup_result_cb,",
            "void*)result)"
          ],
          "line": 715
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_perform_command(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "507-528",
          "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ClientOptions\",",
            "list_copy(client_options))"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "lient_options)"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Command\",",
            "list_new_string(\"LookupArchives\"))"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "LookupArchives\")"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_lookup_archives(instproxy_client_t client, plist_t client_options, plist_t *result)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"LookupArchives\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_SYNC, instproxy_copy_lookup_result_cb, (void*)result);\n\n\tplist_free(command);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_uninstall(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "689-704",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_uninstall(instproxy_client_t client, const char *appid, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Uninstall\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"ApplicationIdentifier\", plist_new_string(appid));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ommand)"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_perform_command(",
          "args": [
            "lient,",
            "ommand,",
            "NSTPROXY_COMMAND_TYPE_ASYNC,",
            "tatus_cb,",
            "ser_data)"
          ],
          "line": 699
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_perform_command(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "507-528",
          "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ApplicationIdentifier\",",
            "list_new_string(appid))"
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "ppid)"
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ClientOptions\",",
            "list_copy(client_options))"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "lient_options)"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Command\",",
            "list_new_string(\"Uninstall\"))"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "Uninstall\")"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_uninstall(instproxy_client_t client, const char *appid, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Uninstall\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"ApplicationIdentifier\", plist_new_string(appid));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_upgrade(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "672-687",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_upgrade(instproxy_client_t client, const char *pkg_path, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Upgrade\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"PackagePath\", plist_new_string(pkg_path));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ommand)"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_perform_command(",
          "args": [
            "lient,",
            "ommand,",
            "NSTPROXY_COMMAND_TYPE_ASYNC,",
            "tatus_cb,",
            "ser_data)"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_perform_command(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "507-528",
          "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "PackagePath\",",
            "list_new_string(pkg_path))"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "kg_path)"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ClientOptions\",",
            "list_copy(client_options))"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "lient_options)"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Command\",",
            "list_new_string(\"Upgrade\"))"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "Upgrade\")"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_upgrade(instproxy_client_t client, const char *pkg_path, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Upgrade\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"PackagePath\", plist_new_string(pkg_path));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_install(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "655-670",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_install(instproxy_client_t client, const char *pkg_path, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Install\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"PackagePath\", plist_new_string(pkg_path));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ommand)"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_perform_command(",
          "args": [
            "lient,",
            "ommand,",
            "NSTPROXY_COMMAND_TYPE_ASYNC,",
            "tatus_cb,",
            "ser_data)"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_perform_command(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "507-528",
          "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "PackagePath\",",
            "list_new_string(pkg_path))"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "kg_path)"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ClientOptions\",",
            "list_copy(client_options))"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "lient_options)"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Command\",",
            "list_new_string(\"Install\"))"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "Install\")"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_install(instproxy_client_t client, const char *pkg_path, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Install\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\tplist_dict_set_item(command, \"PackagePath\", plist_new_string(pkg_path));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_lookup(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "608-653",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_lookup(instproxy_client_t client, const char** appids, plist_t client_options, plist_t *result)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\tint i = 0;\n\tplist_t lookup_result = NULL;\n\tplist_t command = NULL;\n\tplist_t appid_array = NULL;\n\tplist_t node = NULL;\n\n\tif (!client || !client->parent || !result)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tcommand = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Lookup\"));\n\tif (client_options) {\n\t\tnode = plist_copy(client_options);\n\t} else if (appids) {\n\t\tnode = plist_new_dict();\n\t}\n\n\t/* add bundle identifiers to client options */\n\tif (appids) {\n\t\tappid_array = plist_new_array();\n\t\twhile (appids[i]) {\n\t\t\tplist_array_append_item(appid_array, plist_new_string(appids[i]));\n\t\t\ti++;\n\t\t}\n\t\tplist_dict_set_item(node, \"BundleIDs\", appid_array);\n\t}\n\n\tif (node) {\n\t\tplist_dict_set_item(command, \"ClientOptions\", node);\n\t}\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_SYNC, instproxy_copy_lookup_result_cb, (void*)&lookup_result);\n\n\tif (res == INSTPROXY_E_SUCCESS) {\n\t\t*result = lookup_result;\n\t} else {\n\t\tplist_free(lookup_result);\n\t}\n\n\tplist_free(command);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ommand)"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ookup_result)"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_perform_command(",
          "args": [
            "lient,",
            "ommand,",
            "NSTPROXY_COMMAND_TYPE_SYNC,",
            "nstproxy_copy_lookup_result_cb,",
            "void*)&lookup_result)"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_perform_command(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "507-528",
          "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ClientOptions\",",
            "ode)"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ode,",
            "BundleIDs\",",
            "ppid_array)"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_array_append_item(",
          "args": [
            "ppid_array,",
            "list_new_string(appids[i]))"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "ppids[i])"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_array(",
          "args": [],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "lient_options)"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Command\",",
            "list_new_string(\"Lookup\"))"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "Lookup\")"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_lookup(instproxy_client_t client, const char** appids, plist_t client_options, plist_t *result)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\tint i = 0;\n\tplist_t lookup_result = NULL;\n\tplist_t command = NULL;\n\tplist_t appid_array = NULL;\n\tplist_t node = NULL;\n\n\tif (!client || !client->parent || !result)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tcommand = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Lookup\"));\n\tif (client_options) {\n\t\tnode = plist_copy(client_options);\n\t} else if (appids) {\n\t\tnode = plist_new_dict();\n\t}\n\n\t/* add bundle identifiers to client options */\n\tif (appids) {\n\t\tappid_array = plist_new_array();\n\t\twhile (appids[i]) {\n\t\t\tplist_array_append_item(appid_array, plist_new_string(appids[i]));\n\t\t\ti++;\n\t\t}\n\t\tplist_dict_set_item(node, \"BundleIDs\", appid_array);\n\t}\n\n\tif (node) {\n\t\tplist_dict_set_item(command, \"ClientOptions\", node);\n\t}\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_SYNC, instproxy_copy_lookup_result_cb, (void*)&lookup_result);\n\n\tif (res == INSTPROXY_E_SUCCESS) {\n\t\t*result = lookup_result;\n\t} else {\n\t\tplist_free(lookup_result);\n\t}\n\n\tplist_free(command);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_copy_lookup_result_cb(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "598-606",
    "snippet": "tatic void instproxy_copy_lookup_result_cb(plist_t command, plist_t status, void *user_data)\n{\n\tplist_t* result = (plist_t*)user_data;\n\n\tplist_t node = plist_dict_get_item(status, \"LookupResult\");\n\tif (node) {\n\t\t*result = plist_copy(node);\n\t}\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "ode)"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_get_item(",
          "args": [
            "tatus,",
            "LookupResult\")"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic void instproxy_copy_lookup_result_cb(plist_t command, plist_t status, void *user_data)\n{\n\tplist_t* result = (plist_t*)user_data;\n\n\tplist_t node = plist_dict_get_item(status, \"LookupResult\");\n\tif (node) {\n\t\t*result = plist_copy(node);\n\t}\n}"
  },
  {
    "function_name": "nstproxy_browse(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "571-596",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_browse(instproxy_client_t client, plist_t client_options, plist_t *result)\n{\n\tif (!client || !client->parent || !result)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t result_array = plist_new_array();\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Browse\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_SYNC, instproxy_append_current_list_to_result_cb, (void*)&result_array);\n\n\tif (res == INSTPROXY_E_SUCCESS) {\n\t\t*result = result_array;\n\t} else {\n\t\tplist_free(result_array);\n\t}\n\n\tplist_free(command);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ommand)"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "esult_array)"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_perform_command(",
          "args": [
            "lient,",
            "ommand,",
            "NSTPROXY_COMMAND_TYPE_SYNC,",
            "nstproxy_append_current_list_to_result_cb,",
            "void*)&result_array)"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_perform_command(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "507-528",
          "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ClientOptions\",",
            "list_copy(client_options))"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "lient_options)"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Command\",",
            "list_new_string(\"Browse\"))"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "Browse\")"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_array(",
          "args": [],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_browse(instproxy_client_t client, plist_t client_options, plist_t *result)\n{\n\tif (!client || !client->parent || !result)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t result_array = plist_new_array();\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Browse\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_SYNC, instproxy_append_current_list_to_result_cb, (void*)&result_array);\n\n\tif (res == INSTPROXY_E_SUCCESS) {\n\t\t*result = result_array;\n\t} else {\n\t\tplist_free(result_array);\n\t}\n\n\tplist_free(command);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_append_current_list_to_result_cb(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "549-569",
    "snippet": "tatic void instproxy_append_current_list_to_result_cb(plist_t command, plist_t status, void *user_data)\n{\n\tplist_t *result_array = (plist_t*)user_data;\n\tuint64_t current_amount = 0;\n\tplist_t current_list = NULL;\n\tuint64_t i;\n\n\tinstproxy_status_get_current_list(status, NULL, NULL, &current_amount, &current_list);\n\n\tdebug_info(\"current_amount: %d\", current_amount);\n\n\tif (current_amount > 0) {\n\t\tfor (i = 0; current_list && (i < current_amount); i++) {\n\t\t\tplist_t item = plist_array_get_item(current_list, i);\n\t\t\tplist_array_append_item(*result_array, plist_copy(item));\n\t\t}\n\t}\n\n\tif (current_list)\n\t\tplist_free(current_list);\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "urrent_list)"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_array_append_item(",
          "args": [
            "result_array,",
            "list_copy(item))"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "tem)"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_array_get_item(",
          "args": [
            "urrent_list,",
            ")"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ebug_info(",
          "args": [
            "current_amount: %d\",",
            "urrent_amount)"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_status_get_current_list(",
          "args": [
            "tatus,",
            "ULL,",
            "ULL,",
            "current_amount,",
            "current_list)"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_status_get_current_list(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "871-906",
          "snippet": "IBIMOBILEDEVICE_API void instproxy_status_get_current_list(plist_t status, uint64_t* total, uint64_t* current_index, uint64_t* current_amount, plist_t* list)\n{\n\tplist_t node = NULL;\n\n\tif (status && plist_get_node_type(status) == PLIST_DICT) {\n\t\t/* command specific logic: parse browsed list */\n\t\tif (list != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentList\");\n\t\t\tif (node) {\n\t\t\t\t*current_amount = plist_array_get_size(node);\n\t\t\t\t*list = plist_copy(node);\n\t\t\t}\n\t\t}\n\n\t\tif (total != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"Total\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, total);\n\t\t\t}\n\t\t}\n\n\t\tif (current_amount != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentAmount\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, current_amount);\n\t\t\t}\n\t\t}\n\n\t\tif (current_index != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentIndex\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, current_index);\n\t\t\t}\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_status_get_current_list(plist_t status, uint64_t* total, uint64_t* current_index, uint64_t* current_amount, plist_t* list)\n{\n\tplist_t node = NULL;\n\n\tif (status && plist_get_node_type(status) == PLIST_DICT) {\n\t\t/* command specific logic: parse browsed list */\n\t\tif (list != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentList\");\n\t\t\tif (node) {\n\t\t\t\t*current_amount = plist_array_get_size(node);\n\t\t\t\t*list = plist_copy(node);\n\t\t\t}\n\t\t}\n\n\t\tif (total != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"Total\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, total);\n\t\t\t}\n\t\t}\n\n\t\tif (current_amount != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentAmount\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, current_amount);\n\t\t\t}\n\t\t}\n\n\t\tif (current_index != NULL) {\n\t\t\tnode = plist_dict_get_item(status, \"CurrentIndex\");\n\t\t\tif (node) {\n\t\t\t\tplist_get_uint_val(node, current_index);\n\t\t\t}\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic void instproxy_append_current_list_to_result_cb(plist_t command, plist_t status, void *user_data)\n{\n\tplist_t *result_array = (plist_t*)user_data;\n\tuint64_t current_amount = 0;\n\tplist_t current_list = NULL;\n\tuint64_t i;\n\n\tinstproxy_status_get_current_list(status, NULL, NULL, &current_amount, &current_list);\n\n\tdebug_info(\"current_amount: %d\", current_amount);\n\n\tif (current_amount > 0) {\n\t\tfor (i = 0; current_list && (i < current_amount); i++) {\n\t\t\tplist_t item = plist_array_get_item(current_list, i);\n\t\t\tplist_array_append_item(*result_array, plist_copy(item));\n\t\t}\n\t}\n\n\tif (current_list)\n\t\tplist_free(current_list);\n}"
  },
  {
    "function_name": "nstproxy_browse_with_callback(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "530-547",
    "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_browse_with_callback(instproxy_client_t client, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !status_cb)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Browse\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, (void*)user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ommand)"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_perform_command(",
          "args": [
            "lient,",
            "ommand,",
            "NSTPROXY_COMMAND_TYPE_ASYNC,",
            "tatus_cb,",
            "void*)user_data)"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_perform_command(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "507-528",
          "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "ClientOptions\",",
            "list_copy(client_options))"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "lient_options)"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_dict_set_item(",
          "args": [
            "ommand,",
            "Command\",",
            "list_new_string(\"Browse\"))"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_string(",
          "args": [
            "Browse\")"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_new_dict(",
          "args": [],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_browse_with_callback(instproxy_client_t client, plist_t client_options, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !status_cb)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tplist_t command = plist_new_dict();\n\tplist_dict_set_item(command, \"Command\", plist_new_string(\"Browse\"));\n\tif (client_options)\n\t\tplist_dict_set_item(command, \"ClientOptions\", plist_copy(client_options));\n\n\tres = instproxy_perform_command(client, command, INSTPROXY_COMMAND_TYPE_ASYNC, status_cb, (void*)user_data);\n\n\tplist_free(command);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_perform_command(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "507-528",
    "snippet": "tatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nstproxy_receive_status_loop_with_callback(",
          "args": [
            "lient,",
            "ommand,",
            "sync,",
            "tatus_cb,",
            "ser_data)"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_receive_status_loop_with_callback(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "462-492",
          "snippet": "tatic instproxy_error_t instproxy_receive_status_loop_with_callback(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\tif (async == INSTPROXY_COMMAND_TYPE_ASYNC) {\n\t\t/* async mode */\n\t\tstruct instproxy_status_data *data = (struct instproxy_status_data*)malloc(sizeof(struct instproxy_status_data));\n\t\tif (data) {\n\t\t\tdata->client = client;\n\t\t\tdata->command = plist_copy(command);\n\t\t\tdata->cbfunc = status_cb;\n\t\t\tdata->user_data = user_data;\n\n\t\t\tif (thread_new(&client->receive_status_thread, instproxy_receive_status_loop_thread, data) == 0) {\n\t\t\t\tres = INSTPROXY_E_SUCCESS;\n\t\t\t}\n\t\t}\n\t} else {\n\t\t/* sync mode as a fallback */\n\t\tres = instproxy_receive_status_loop(client, command, status_cb, user_data);\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_receive_status_loop_with_callback(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\tif (async == INSTPROXY_COMMAND_TYPE_ASYNC) {\n\t\t/* async mode */\n\t\tstruct instproxy_status_data *data = (struct instproxy_status_data*)malloc(sizeof(struct instproxy_status_data));\n\t\tif (data) {\n\t\t\tdata->client = client;\n\t\t\tdata->command = plist_copy(command);\n\t\t\tdata->cbfunc = status_cb;\n\t\t\tdata->user_data = user_data;\n\n\t\t\tif (thread_new(&client->receive_status_thread, instproxy_receive_status_loop_thread, data) == 0) {\n\t\t\t\tres = INSTPROXY_E_SUCCESS;\n\t\t\t}\n\t\t}\n\t} else {\n\t\t/* sync mode as a fallback */\n\t\tres = instproxy_receive_status_loop(client, command, status_cb, user_data);\n\t}\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nstproxy_unlock(",
          "args": [
            "lient)"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_send_command(",
          "args": [
            "lient,",
            "ommand)"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_lock(",
          "args": [
            "lient)"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_perform_command(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\t/* send command */\n\tinstproxy_lock(client);\n\tres = instproxy_send_command(client, command);\n\tinstproxy_unlock(client);\n\n\t/* loop until status or error is received */\n\tres = instproxy_receive_status_loop_with_callback(client, command, async, status_cb, user_data);\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_receive_status_loop_with_callback(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "462-492",
    "snippet": "tatic instproxy_error_t instproxy_receive_status_loop_with_callback(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\tif (async == INSTPROXY_COMMAND_TYPE_ASYNC) {\n\t\t/* async mode */\n\t\tstruct instproxy_status_data *data = (struct instproxy_status_data*)malloc(sizeof(struct instproxy_status_data));\n\t\tif (data) {\n\t\t\tdata->client = client;\n\t\t\tdata->command = plist_copy(command);\n\t\t\tdata->cbfunc = status_cb;\n\t\t\tdata->user_data = user_data;\n\n\t\t\tif (thread_new(&client->receive_status_thread, instproxy_receive_status_loop_thread, data) == 0) {\n\t\t\t\tres = INSTPROXY_E_SUCCESS;\n\t\t\t}\n\t\t}\n\t} else {\n\t\t/* sync mode as a fallback */\n\t\tres = instproxy_receive_status_loop(client, command, status_cb, user_data);\n\t}\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nstproxy_receive_status_loop(",
          "args": [
            "lient,",
            "ommand,",
            "tatus_cb,",
            "ser_data)"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hread_new(",
          "args": [
            "client->receive_status_thread,",
            "nstproxy_receive_status_loop_thread,",
            "ata)"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_copy(",
          "args": [
            "ommand)"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc(",
          "args": [
            "izeof(struct instproxy_status_data))"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic instproxy_error_t instproxy_receive_status_loop_with_callback(instproxy_client_t client, plist_t command, instproxy_command_type_t async, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tif (!client || !client->parent || !command) {\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\t}\n\n\tif (client->receive_status_thread) {\n\t\treturn INSTPROXY_E_OP_IN_PROGRESS;\n\t}\n\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\tif (async == INSTPROXY_COMMAND_TYPE_ASYNC) {\n\t\t/* async mode */\n\t\tstruct instproxy_status_data *data = (struct instproxy_status_data*)malloc(sizeof(struct instproxy_status_data));\n\t\tif (data) {\n\t\t\tdata->client = client;\n\t\t\tdata->command = plist_copy(command);\n\t\t\tdata->cbfunc = status_cb;\n\t\t\tdata->user_data = user_data;\n\n\t\t\tif (thread_new(&client->receive_status_thread, instproxy_receive_status_loop_thread, data) == 0) {\n\t\t\t\tres = INSTPROXY_E_SUCCESS;\n\t\t\t}\n\t\t}\n\t} else {\n\t\t/* sync mode as a fallback */\n\t\tres = instproxy_receive_status_loop(client, command, status_cb, user_data);\n\t}\n\n\treturn res;\n}"
  },
  {
    "function_name": "nstproxy_receive_status_loop_thread(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "416-441",
    "snippet": "tatic void* instproxy_receive_status_loop_thread(void* arg)\n{\n\tstruct instproxy_status_data *data = (struct instproxy_status_data*)arg;\n\n\t/* run until the command is complete or an error occurs */\n\t(void)instproxy_receive_status_loop(data->client, data->command, data->cbfunc, data->user_data);\n\n\t/* cleanup */\n\tinstproxy_lock(data->client);\n\n\tdebug_info(\"done, cleaning up.\");\n\n\tif (data->command) {\n\t\tplist_free(data->command);\n\t}\n\n\tif (data->client->receive_status_thread) {\n\t\tthread_free(data->client->receive_status_thread);\n\t\tdata->client->receive_status_thread = (thread_t)NULL;\n\t}\n\n\tinstproxy_unlock(data->client);\n\tfree(data);\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ree(",
          "args": [
            "ata)"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_client_options_free(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "977-982",
          "snippet": "IBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "nstproxy_unlock(",
          "args": [
            "ata->client)"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hread_free(",
          "args": [
            "ata->client->receive_status_thread)"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ata->command)"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ebug_info(",
          "args": [
            "done, cleaning up.\")"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_lock(",
          "args": [
            "ata->client)"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_receive_status_loop(",
          "args": [
            "ata->client,",
            "ata->command,",
            "ata->cbfunc,",
            "ata->user_data)"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\ntatic void* instproxy_receive_status_loop_thread(void* arg)\n{\n\tstruct instproxy_status_data *data = (struct instproxy_status_data*)arg;\n\n\t/* run until the command is complete or an error occurs */\n\t(void)instproxy_receive_status_loop(data->client, data->command, data->cbfunc, data->user_data);\n\n\t/* cleanup */\n\tinstproxy_lock(data->client);\n\n\tdebug_info(\"done, cleaning up.\");\n\n\tif (data->command) {\n\t\tplist_free(data->command);\n\t}\n\n\tif (data->client->receive_status_thread) {\n\t\tthread_free(data->client->receive_status_thread);\n\t\tdata->client->receive_status_thread = (thread_t)NULL;\n\t}\n\n\tinstproxy_unlock(data->client);\n\tfree(data);\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "instproxy_receive_status_loop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "316-404",
    "snippet": "static instproxy_error_t instproxy_receive_status_loop(instproxy_client_t client, plist_t command, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\tint complete = 0;\n\tplist_t node = NULL;\n\tchar* command_name = NULL;\n\tchar* status_name = NULL;\n\tchar* error_name = NULL;\n\tchar* error_description = NULL;\n\tuint64_t error_code = 0;\n#ifndef STRIP_DEBUG_CODE\n\tint percent_complete = 0;\n#endif\n\n\tinstproxy_command_get_name(command, &command_name);\n\n\tdo {\n\t\t/* receive status response */\n\t\tinstproxy_lock(client);\n\t\tres = instproxy_error(property_list_service_receive_plist_with_timeout(client->parent, &node, 1000));\n\t\tinstproxy_unlock(client);\n\n\t\t/* break out if we have a communication problem */\n\t\tif (res != INSTPROXY_E_SUCCESS && res != INSTPROXY_E_RECEIVE_TIMEOUT) {\n\t\t\tdebug_info(\"could not receive plist, error %d\", res);\n\t\t\tbreak;\n\t\t}\n\n\t\t/* parse status response */\n\t\tif (node) {\n\t\t\t/* check status for possible errorto allow reporting it and aborting it gracefully */\n\t\t\tres = instproxy_status_get_error(node, &error_name, &error_description, &error_code);\n\t\t\tif (res != INSTPROXY_E_SUCCESS) {\n\t\t\t\tdebug_info(\"command: %s, error %d, code 0x%08\"PRIx64\", name: %s, description: \\\"%s\\\"\", command_name, res, error_code, error_name, error_description ? error_description: \"N/A\");\n\t\t\t\tcomplete = 1;\n\t\t\t}\n\n\t\t\tif (error_name) {\n\t\t\t\tfree(error_name);\n\t\t\t\terror_name = NULL;\n\t\t\t}\n\n\t\t\tif (error_description) {\n\t\t\t\tfree(error_description);\n\t\t\t\terror_description = NULL;\n\t\t\t}\n\n\t\t\t/* check status from response */\n\t\t\tinstproxy_status_get_name(node, &status_name);\n\t\t\tif (!status_name) {\n\t\t\t\tdebug_info(\"failed to retrieve name from status response with error %d.\", res);\n\t\t\t\tcomplete = 1;\n\t\t\t}\n\n\t\t\tif (status_name) {\n\t\t\t\tif (!strcmp(status_name, \"Complete\")) {\n\t\t\t\t\tcomplete = 1;\n\t\t\t\t} else {\n\t\t\t\t\tres = INSTPROXY_E_OP_IN_PROGRESS;\n\t\t\t\t}\n\n#ifndef STRIP_DEBUG_CODE\n\t\t\t\tpercent_complete = -1;\n\t\t\t\tinstproxy_status_get_percent_complete(node, &percent_complete);\n\t\t\t\tif (percent_complete >= 0) {\n\t\t\t\t\tdebug_info(\"command: %s, status: %s, percent (%d%%)\", command_name, status_name, percent_complete);\n\t\t\t\t} else {\n\t\t\t\t\tdebug_info(\"command: %s, status: %s\", command_name, status_name);\n\t\t\t\t}\n#endif\n\t\t\t\tfree(status_name);\n\t\t\t\tstatus_name = NULL;\n\t\t\t}\n\n\t\t\t/* invoke status callback function */\n\t\t\tif (status_cb) {\n\t\t\t\tstatus_cb(command, node, user_data);\n\t\t\t}\n\n\t\t\tplist_free(node);\n\t\t\tnode = NULL;\n\t\t}\n\t} while (!complete && client->parent);\n\n\tif (command_name)\n\t\tfree(command_name);\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ree(",
          "args": [
            "ommand_name)"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_client_options_free(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "977-982",
          "snippet": "IBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_free(",
          "args": [
            "ode)"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatus_cb(",
          "args": [
            "ommand,",
            "ode,",
            "ser_data)"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ebug_info(",
          "args": [
            "command: %s, status: %s\",",
            "ommand_name,",
            "tatus_name)"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ebug_info(",
          "args": [
            "command: %s, status: %s, percent (%d%%)\",",
            "ommand_name,",
            "tatus_name,",
            "ercent_complete)"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_status_get_percent_complete(",
          "args": [
            "ode,",
            "percent_complete)"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_status_get_percent_complete(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "859-869",
          "snippet": "IBIMOBILEDEVICE_API void instproxy_status_get_percent_complete(plist_t status, int *percent)\n{\n\tuint64_t val = 0;\n\tif (percent) {\n\t\tplist_t node = plist_dict_get_item(status, \"PercentComplete\");\n\t\tif (node) {\n\t\t\tplist_get_uint_val(node, &val);\n\t\t\t*percent = val;\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_status_get_percent_complete(plist_t status, int *percent)\n{\n\tuint64_t val = 0;\n\tif (percent) {\n\t\tplist_t node = plist_dict_get_item(status, \"PercentComplete\");\n\t\tif (node) {\n\t\t\tplist_get_uint_val(node, &val);\n\t\t\t*percent = val;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "trcmp(",
          "args": [
            "tatus_name,",
            "Complete\")"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ebug_info(",
          "args": [
            "failed to retrieve name from status response with error %d.\",",
            "es)"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_status_get_name(",
          "args": [
            "ode,",
            "status_name)"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_status_get_name(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "848-857",
          "snippet": "IBIMOBILEDEVICE_API void instproxy_status_get_name(plist_t status, char **name)\n{\n\t*name = NULL;\n\tif (name) {\n\t\tplist_t node = plist_dict_get_item(status, \"Status\");\n\t\tif (node) {\n\t\t\tplist_get_string_val(node, name);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_status_get_name(plist_t status, char **name)\n{\n\t*name = NULL;\n\tif (name) {\n\t\tplist_t node = plist_dict_get_item(status, \"Status\");\n\t\tif (node) {\n\t\t\tplist_get_string_val(node, name);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ebug_info(",
          "args": [
            "command: %s, error %d, code 0x%08\"PRIx64\", name: %s, description: \\\"%s\\\"\",",
            "ommand_name,",
            "es,",
            "rror_code,",
            "rror_name,",
            "rror_description ? error_description: \"N/A\")"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstproxy_status_get_error(",
          "args": [
            "ode,",
            "error_name,",
            "error_description,",
            "error_code)"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_status_get_error(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "810-846",
          "snippet": "IBIMOBILEDEVICE_API instproxy_error_t instproxy_status_get_error(plist_t status, char **name, char** description, uint64_t* code)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tif (!status || !name)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tplist_t node = plist_dict_get_item(status, \"Error\");\n\tif (node) {\n\t\tplist_get_string_val(node, name);\n\t} else {\n\t\t/* no error here */\n\t\tres = INSTPROXY_E_SUCCESS;\n\t}\n\n\tif (code != NULL) {\n\t\t*code = 0;\n\t\tnode = plist_dict_get_item(status, \"ErrorDetail\");\n\t\tif (node) {\n\t\t\tplist_get_uint_val(node, code);\n\t\t\t*code &= 0xffffffff;\n\t\t}\n\t}\n\n\tif (description != NULL) {\n\t\tnode = plist_dict_get_item(status, \"ErrorDescription\");\n\t\tif (node) {\n\t\t\tplist_get_string_val(node, description);\n\t\t}\n\t}\n\n\tif (*name) {\n\t\tres = instproxy_strtoerr(*name);\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API instproxy_error_t instproxy_status_get_error(plist_t status, char **name, char** description, uint64_t* code)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tif (!status || !name)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tplist_t node = plist_dict_get_item(status, \"Error\");\n\tif (node) {\n\t\tplist_get_string_val(node, name);\n\t} else {\n\t\t/* no error here */\n\t\tres = INSTPROXY_E_SUCCESS;\n\t}\n\n\tif (code != NULL) {\n\t\t*code = 0;\n\t\tnode = plist_dict_get_item(status, \"ErrorDetail\");\n\t\tif (node) {\n\t\t\tplist_get_uint_val(node, code);\n\t\t\t*code &= 0xffffffff;\n\t\t}\n\t}\n\n\tif (description != NULL) {\n\t\tnode = plist_dict_get_item(status, \"ErrorDescription\");\n\t\tif (node) {\n\t\t\tplist_get_string_val(node, description);\n\t\t}\n\t}\n\n\tif (*name) {\n\t\tres = instproxy_strtoerr(*name);\n\t}\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"could not receive plist, error %d\"",
            "res"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "instproxy_unlock",
          "args": [
            "client"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "instproxy_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "198-202",
          "snippet": "static void instproxy_unlock(instproxy_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void instproxy_unlock(instproxy_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "instproxy_error",
          "args": [
            "property_list_service_receive_plist_with_timeout(client->parent, &node, 1000)"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "instproxy_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "213-230",
          "snippet": "static instproxy_error_t instproxy_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn INSTPROXY_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn INSTPROXY_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn INSTPROXY_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn INSTPROXY_E_CONN_FAILED;\n\t\tcase PROPERTY_LIST_SERVICE_E_RECEIVE_TIMEOUT:\n\t\t\treturn INSTPROXY_E_RECEIVE_TIMEOUT;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn INSTPROXY_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic instproxy_error_t instproxy_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn INSTPROXY_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn INSTPROXY_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn INSTPROXY_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn INSTPROXY_E_CONN_FAILED;\n\t\tcase PROPERTY_LIST_SERVICE_E_RECEIVE_TIMEOUT:\n\t\t\treturn INSTPROXY_E_RECEIVE_TIMEOUT;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn INSTPROXY_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_receive_plist_with_timeout",
          "args": [
            "client->parent",
            "&node",
            "1000"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_receive_plist_with_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "253-256",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist_with_timeout(property_list_service_client_t client, plist_t *plist, unsigned int timeout)\n{\n\treturn internal_plist_receive_timeout(client, plist, timeout);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_receive_plist_with_timeout(property_list_service_client_t client, plist_t *plist, unsigned int timeout)\n{\n\treturn internal_plist_receive_timeout(client, plist, timeout);\n}"
        }
      },
      {
        "call_info": {
          "callee": "instproxy_lock",
          "args": [
            "client"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "instproxy_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "187-191",
          "snippet": "static void instproxy_lock(instproxy_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void instproxy_lock(instproxy_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "instproxy_command_get_name",
          "args": [
            "command",
            "&command_name"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic instproxy_error_t instproxy_receive_status_loop(instproxy_client_t client, plist_t command, instproxy_status_cb_t status_cb, void *user_data)\n{\n\tinstproxy_error_t res = INSTPROXY_E_UNKNOWN_ERROR;\n\tint complete = 0;\n\tplist_t node = NULL;\n\tchar* command_name = NULL;\n\tchar* status_name = NULL;\n\tchar* error_name = NULL;\n\tchar* error_description = NULL;\n\tuint64_t error_code = 0;\n#ifndef STRIP_DEBUG_CODE\n\tint percent_complete = 0;\n#endif\n\n\tinstproxy_command_get_name(command, &command_name);\n\n\tdo {\n\t\t/* receive status response */\n\t\tinstproxy_lock(client);\n\t\tres = instproxy_error(property_list_service_receive_plist_with_timeout(client->parent, &node, 1000));\n\t\tinstproxy_unlock(client);\n\n\t\t/* break out if we have a communication problem */\n\t\tif (res != INSTPROXY_E_SUCCESS && res != INSTPROXY_E_RECEIVE_TIMEOUT) {\n\t\t\tdebug_info(\"could not receive plist, error %d\", res);\n\t\t\tbreak;\n\t\t}\n\n\t\t/* parse status response */\n\t\tif (node) {\n\t\t\t/* check status for possible errorto allow reporting it and aborting it gracefully */\n\t\t\tres = instproxy_status_get_error(node, &error_name, &error_description, &error_code);\n\t\t\tif (res != INSTPROXY_E_SUCCESS) {\n\t\t\t\tdebug_info(\"command: %s, error %d, code 0x%08\"PRIx64\", name: %s, description: \\\"%s\\\"\", command_name, res, error_code, error_name, error_description ? error_description: \"N/A\");\n\t\t\t\tcomplete = 1;\n\t\t\t}\n\n\t\t\tif (error_name) {\n\t\t\t\tfree(error_name);\n\t\t\t\terror_name = NULL;\n\t\t\t}\n\n\t\t\tif (error_description) {\n\t\t\t\tfree(error_description);\n\t\t\t\terror_description = NULL;\n\t\t\t}\n\n\t\t\t/* check status from response */\n\t\t\tinstproxy_status_get_name(node, &status_name);\n\t\t\tif (!status_name) {\n\t\t\t\tdebug_info(\"failed to retrieve name from status response with error %d.\", res);\n\t\t\t\tcomplete = 1;\n\t\t\t}\n\n\t\t\tif (status_name) {\n\t\t\t\tif (!strcmp(status_name, \"Complete\")) {\n\t\t\t\t\tcomplete = 1;\n\t\t\t\t} else {\n\t\t\t\t\tres = INSTPROXY_E_OP_IN_PROGRESS;\n\t\t\t\t}\n\n#ifndef STRIP_DEBUG_CODE\n\t\t\t\tpercent_complete = -1;\n\t\t\t\tinstproxy_status_get_percent_complete(node, &percent_complete);\n\t\t\t\tif (percent_complete >= 0) {\n\t\t\t\t\tdebug_info(\"command: %s, status: %s, percent (%d%%)\", command_name, status_name, percent_complete);\n\t\t\t\t} else {\n\t\t\t\t\tdebug_info(\"command: %s, status: %s\", command_name, status_name);\n\t\t\t\t}\n#endif\n\t\t\t\tfree(status_name);\n\t\t\t\tstatus_name = NULL;\n\t\t\t}\n\n\t\t\t/* invoke status callback function */\n\t\t\tif (status_cb) {\n\t\t\t\tstatus_cb(command, node, user_data);\n\t\t\t}\n\n\t\t\tplist_free(node);\n\t\t\tnode = NULL;\n\t\t}\n\t} while (!complete && client->parent);\n\n\tif (command_name)\n\t\tfree(command_name);\n\n\treturn res;\n}"
  },
  {
    "function_name": "instproxy_send_command",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "288-301",
    "snippet": "static instproxy_error_t instproxy_send_command(instproxy_client_t client, plist_t command)\n{\n\tif (!client || !command)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tinstproxy_error_t res = instproxy_error(property_list_service_send_xml_plist(client->parent, command));\n\n\tif (res != INSTPROXY_E_SUCCESS) {\n\t\tdebug_info(\"could not send command plist, error %d\", res);\n\t\treturn res;\n\t}\n\n\treturn res;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"could not send command plist, error %d\"",
            "res"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "instproxy_error",
          "args": [
            "property_list_service_send_xml_plist(client->parent, command)"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "instproxy_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "213-230",
          "snippet": "static instproxy_error_t instproxy_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn INSTPROXY_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn INSTPROXY_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn INSTPROXY_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn INSTPROXY_E_CONN_FAILED;\n\t\tcase PROPERTY_LIST_SERVICE_E_RECEIVE_TIMEOUT:\n\t\t\treturn INSTPROXY_E_RECEIVE_TIMEOUT;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn INSTPROXY_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic instproxy_error_t instproxy_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn INSTPROXY_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn INSTPROXY_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn INSTPROXY_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn INSTPROXY_E_CONN_FAILED;\n\t\tcase PROPERTY_LIST_SERVICE_E_RECEIVE_TIMEOUT:\n\t\t\treturn INSTPROXY_E_RECEIVE_TIMEOUT;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn INSTPROXY_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_send_xml_plist",
          "args": [
            "client->parent",
            "command"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_send_xml_plist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "150-153",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_xml_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 0);\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_send_xml_plist(property_list_service_client_t client, plist_t plist)\n{\n\treturn internal_plist_send(client, plist, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic instproxy_error_t instproxy_send_command(instproxy_client_t client, plist_t command)\n{\n\tif (!client || !command)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tinstproxy_error_t res = instproxy_error(property_list_service_send_xml_plist(client->parent, command));\n\n\tif (res != INSTPROXY_E_SUCCESS) {\n\t\tdebug_info(\"could not send command plist, error %d\", res);\n\t\treturn res;\n\t}\n\n\treturn res;\n}"
  },
  {
    "function_name": "instproxy_client_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "256-273",
    "snippet": "LIBIMOBILEDEVICE_API instproxy_error_t instproxy_client_free(instproxy_client_t client)\n{\n\tif (!client)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tproperty_list_service_client_free(client->parent);\n\tclient->parent = NULL;\n\tif (client->receive_status_thread) {\n\t\tdebug_info(\"joining receive_status_thread\");\n\t\tthread_join(client->receive_status_thread);\n\t\tthread_free(client->receive_status_thread);\n\t\tclient->receive_status_thread = (thread_t)NULL;\n\t}\n\tmutex_destroy(&client->mutex);\n\tfree(client);\n\n\treturn INSTPROXY_E_SUCCESS;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "client"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "nstproxy_client_options_free(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "977-982",
          "snippet": "IBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nIBIMOBILEDEVICE_API void instproxy_client_options_free(plist_t client_options)\n{\n\tif (client_options) {\n\t\tplist_free(client_options);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_destroy",
          "args": [
            "&client->mutex"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "65-72",
          "snippet": "void mutex_destroy(mutex_t* mutex)\n{\n#ifdef WIN32\n\tDeleteCriticalSection(mutex);\n#else\n\tpthread_mutex_destroy(mutex);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid mutex_destroy(mutex_t* mutex)\n{\n#ifdef WIN32\n\tDeleteCriticalSection(mutex);\n#else\n\tpthread_mutex_destroy(mutex);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "thread_free",
          "args": [
            "client->receive_status_thread"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "thread_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "39-44",
          "snippet": "void thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_free(thread_t thread)\n{\n#ifdef WIN32\n\tCloseHandle(thread);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "thread_join",
          "args": [
            "client->receive_status_thread"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "thread_join",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "46-54",
          "snippet": "void thread_join(thread_t thread)\n{\n\t/* wait for thread to complete */\n#ifdef WIN32\n\tWaitForSingleObject(thread, INFINITE);\n#else\n\tpthread_join(thread, NULL);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid thread_join(thread_t thread)\n{\n\t/* wait for thread to complete */\n#ifdef WIN32\n\tWaitForSingleObject(thread, INFINITE);\n#else\n\tpthread_join(thread, NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"joining receive_status_thread\""
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "property_list_service_client_free",
          "args": [
            "client->parent"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_client_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "77-88",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_free(property_list_service_client_t client)\n{\n\tif (!client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tproperty_list_service_error_t err = service_to_property_list_service_error(service_client_free(client->parent));\n\n\tfree(client);\n\tclient = NULL;\n\n\treturn err;\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_free(property_list_service_client_t client)\n{\n\tif (!client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tproperty_list_service_error_t err = service_to_property_list_service_error(service_client_free(client->parent));\n\n\tfree(client);\n\tclient = NULL;\n\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API instproxy_error_t instproxy_client_free(instproxy_client_t client)\n{\n\tif (!client)\n\t\treturn INSTPROXY_E_INVALID_ARG;\n\n\tproperty_list_service_client_free(client->parent);\n\tclient->parent = NULL;\n\tif (client->receive_status_thread) {\n\t\tdebug_info(\"joining receive_status_thread\");\n\t\tthread_join(client->receive_status_thread);\n\t\tthread_free(client->receive_status_thread);\n\t\tclient->receive_status_thread = (thread_t)NULL;\n\t}\n\tmutex_destroy(&client->mutex);\n\tfree(client);\n\n\treturn INSTPROXY_E_SUCCESS;\n}"
  },
  {
    "function_name": "instproxy_client_start_service",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "249-254",
    "snippet": "LIBIMOBILEDEVICE_API instproxy_error_t instproxy_client_start_service(idevice_t device, instproxy_client_t * client, const char* label)\n{\n\tinstproxy_error_t err = INSTPROXY_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, INSTPROXY_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(instproxy_client_new), &err);\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_client_factory_start_service",
          "args": [
            "device",
            "INSTPROXY_SERVICE_NAME",
            "(void**)client",
            "label",
            "SERVICE_CONSTRUCTOR(instproxy_client_new)",
            "&err"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "service_client_factory_start_service",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/service.c",
          "lines": "79-116",
          "snippet": "LIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"idevice.h\"",
            "#include \"service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"idevice.h\"\n#include \"service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API service_error_t service_client_factory_start_service(idevice_t device, const char* service_name, void **client, const char* label, int32_t (*constructor_func)(idevice_t, lockdownd_service_descriptor_t, void**), int32_t *error_code)\n{\n\t*client = NULL;\n\n\tlockdownd_client_t lckd = NULL;\n\tif (LOCKDOWN_E_SUCCESS != lockdownd_client_new_with_handshake(device, &lckd, label)) {\n\t\tdebug_info(\"Could not create a lockdown client.\");\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tlockdownd_service_descriptor_t service = NULL;\n\tlockdownd_start_service(lckd, service_name, &service);\n\tlockdownd_client_free(lckd);\n\n\tif (!service || service->port == 0) {\n\t\tdebug_info(\"Could not start service %s!\", service_name);\n\t\treturn SERVICE_E_START_SERVICE_ERROR;\n\t}\n\n\tint32_t ec;\n\tif (constructor_func) {\n\t\tec = (int32_t)constructor_func(device, service, client);\n\t} else {\n\t\tec = service_client_new(device, service, (service_client_t*)client);\n\t}\n\tif (error_code) {\n\t\t*error_code = ec;\n\t}\n\n\tif (ec != SERVICE_E_SUCCESS) {\n\t\tdebug_info(\"Could not connect to service %s! Port: %i, error: %i\", service_name, service->port, ec);\n\t}\n\n\tlockdownd_service_descriptor_free(service);\n\tservice = NULL;\n\n\treturn (ec == SERVICE_E_SUCCESS) ? SERVICE_E_SUCCESS : SERVICE_E_START_SERVICE_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SERVICE_CONSTRUCTOR",
          "args": [
            "instproxy_client_new"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API instproxy_error_t instproxy_client_start_service(idevice_t device, instproxy_client_t * client, const char* label)\n{\n\tinstproxy_error_t err = INSTPROXY_E_UNKNOWN_ERROR;\n\tservice_client_factory_start_service(device, INSTPROXY_SERVICE_NAME, (void**)client, label, SERVICE_CONSTRUCTOR(instproxy_client_new), &err);\n\treturn err;\n}"
  },
  {
    "function_name": "instproxy_client_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "232-247",
    "snippet": "LIBIMOBILEDEVICE_API instproxy_error_t instproxy_client_new(idevice_t device, lockdownd_service_descriptor_t service, instproxy_client_t *client)\n{\n\tproperty_list_service_client_t plistclient = NULL;\n\tinstproxy_error_t err = instproxy_error(property_list_service_client_new(device, service, &plistclient));\n\tif (err != INSTPROXY_E_SUCCESS) {\n\t\treturn err;\n\t}\n\n\tinstproxy_client_t client_loc = (instproxy_client_t) malloc(sizeof(struct instproxy_client_private));\n\tclient_loc->parent = plistclient;\n\tmutex_init(&client_loc->mutex);\n\tclient_loc->receive_status_thread = (thread_t)NULL;\n\n\t*client = client_loc;\n\treturn INSTPROXY_E_SUCCESS;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&client_loc->mutex"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "56-63",
          "snippet": "void mutex_init(mutex_t* mutex)\n{\n#ifdef WIN32\n\tInitializeCriticalSection(mutex);\n#else\n\tpthread_mutex_init(mutex, NULL);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid mutex_init(mutex_t* mutex)\n{\n#ifdef WIN32\n\tInitializeCriticalSection(mutex);\n#else\n\tpthread_mutex_init(mutex, NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct instproxy_client_private)"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "instproxy_error",
          "args": [
            "property_list_service_client_new(device, service, &plistclient)"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "instproxy_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
          "lines": "213-230",
          "snippet": "static instproxy_error_t instproxy_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn INSTPROXY_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn INSTPROXY_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn INSTPROXY_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn INSTPROXY_E_CONN_FAILED;\n\t\tcase PROPERTY_LIST_SERVICE_E_RECEIVE_TIMEOUT:\n\t\t\treturn INSTPROXY_E_RECEIVE_TIMEOUT;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn INSTPROXY_E_UNKNOWN_ERROR;\n}",
          "includes": [
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include \"installation_proxy.h\"",
            "#include <plist/plist.h>",
            "#include <unistd.h>",
            "#include <inttypes.h>",
            "#include <stdlib.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic instproxy_error_t instproxy_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn INSTPROXY_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn INSTPROXY_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn INSTPROXY_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn INSTPROXY_E_CONN_FAILED;\n\t\tcase PROPERTY_LIST_SERVICE_E_RECEIVE_TIMEOUT:\n\t\t\treturn INSTPROXY_E_RECEIVE_TIMEOUT;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn INSTPROXY_E_UNKNOWN_ERROR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "property_list_service_client_new",
          "args": [
            "device",
            "service",
            "&plistclient"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "property_list_service_client_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/property_list_service.c",
          "lines": "57-75",
          "snippet": "LIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, property_list_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tservice_client_t parent = NULL;\n\tservice_error_t rerr = service_client_new(device, service, &parent);\n\tif (rerr != SERVICE_E_SUCCESS) {\n\t\treturn service_to_property_list_service_error(rerr);\n\t}\n\n\t/* create client object */\n\tproperty_list_service_client_t client_loc = (property_list_service_client_t)malloc(sizeof(struct property_list_service_client_private));\n\tclient_loc->parent = parent;\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn PROPERTY_LIST_SERVICE_E_SUCCESS;\n}",
          "includes": [
            "#include \"endianness.h\"",
            "#include \"common/debug.h\"",
            "#include \"property_list_service.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endianness.h\"\n#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nLIBIMOBILEDEVICE_API property_list_service_error_t property_list_service_client_new(idevice_t device, lockdownd_service_descriptor_t service, property_list_service_client_t *client)\n{\n\tif (!device || !service || service->port == 0 || !client || *client)\n\t\treturn PROPERTY_LIST_SERVICE_E_INVALID_ARG;\n\n\tservice_client_t parent = NULL;\n\tservice_error_t rerr = service_client_new(device, service, &parent);\n\tif (rerr != SERVICE_E_SUCCESS) {\n\t\treturn service_to_property_list_service_error(rerr);\n\t}\n\n\t/* create client object */\n\tproperty_list_service_client_t client_loc = (property_list_service_client_t)malloc(sizeof(struct property_list_service_client_private));\n\tclient_loc->parent = parent;\n\n\t/* all done, return success */\n\t*client = client_loc;\n\treturn PROPERTY_LIST_SERVICE_E_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nLIBIMOBILEDEVICE_API instproxy_error_t instproxy_client_new(idevice_t device, lockdownd_service_descriptor_t service, instproxy_client_t *client)\n{\n\tproperty_list_service_client_t plistclient = NULL;\n\tinstproxy_error_t err = instproxy_error(property_list_service_client_new(device, service, &plistclient));\n\tif (err != INSTPROXY_E_SUCCESS) {\n\t\treturn err;\n\t}\n\n\tinstproxy_client_t client_loc = (instproxy_client_t) malloc(sizeof(struct instproxy_client_private));\n\tclient_loc->parent = plistclient;\n\tmutex_init(&client_loc->mutex);\n\tclient_loc->receive_status_thread = (thread_t)NULL;\n\n\t*client = client_loc;\n\treturn INSTPROXY_E_SUCCESS;\n}"
  },
  {
    "function_name": "instproxy_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "213-230",
    "snippet": "static instproxy_error_t instproxy_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn INSTPROXY_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn INSTPROXY_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn INSTPROXY_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn INSTPROXY_E_CONN_FAILED;\n\t\tcase PROPERTY_LIST_SERVICE_E_RECEIVE_TIMEOUT:\n\t\t\treturn INSTPROXY_E_RECEIVE_TIMEOUT;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn INSTPROXY_E_UNKNOWN_ERROR;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic instproxy_error_t instproxy_error(property_list_service_error_t err)\n{\n\tswitch (err) {\n\t\tcase PROPERTY_LIST_SERVICE_E_SUCCESS:\n\t\t\treturn INSTPROXY_E_SUCCESS;\n\t\tcase PROPERTY_LIST_SERVICE_E_INVALID_ARG:\n\t\t\treturn INSTPROXY_E_INVALID_ARG;\n\t\tcase PROPERTY_LIST_SERVICE_E_PLIST_ERROR:\n\t\t\treturn INSTPROXY_E_PLIST_ERROR;\n\t\tcase PROPERTY_LIST_SERVICE_E_MUX_ERROR:\n\t\t\treturn INSTPROXY_E_CONN_FAILED;\n\t\tcase PROPERTY_LIST_SERVICE_E_RECEIVE_TIMEOUT:\n\t\t\treturn INSTPROXY_E_RECEIVE_TIMEOUT;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn INSTPROXY_E_UNKNOWN_ERROR;\n}"
  },
  {
    "function_name": "instproxy_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "198-202",
    "snippet": "static void instproxy_unlock(instproxy_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&client->mutex"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "83-90",
          "snippet": "void mutex_unlock(mutex_t* mutex)\n{\n#ifdef WIN32\n\tLeaveCriticalSection(mutex);\n#else\n\tpthread_mutex_unlock(mutex);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid mutex_unlock(mutex_t* mutex)\n{\n#ifdef WIN32\n\tLeaveCriticalSection(mutex);\n#else\n\tpthread_mutex_unlock(mutex);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Unlocked\""
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void instproxy_unlock(instproxy_client_t client)\n{\n\tdebug_info(\"Unlocked\");\n\tmutex_unlock(&client->mutex);\n}"
  },
  {
    "function_name": "instproxy_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "187-191",
    "snippet": "static void instproxy_lock(instproxy_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&client->mutex"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/common/thread.c",
          "lines": "74-81",
          "snippet": "void mutex_lock(mutex_t* mutex)\n{\n#ifdef WIN32\n\tEnterCriticalSection(mutex);\n#else\n\tpthread_mutex_lock(mutex);\n#endif\n}",
          "includes": [
            "#include \"thread.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"thread.h\"\n\nvoid mutex_lock(mutex_t* mutex)\n{\n#ifdef WIN32\n\tEnterCriticalSection(mutex);\n#else\n\tpthread_mutex_lock(mutex);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug_info",
          "args": [
            "\"Locked\""
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic void instproxy_lock(instproxy_client_t client)\n{\n\tdebug_info(\"Locked\");\n\tmutex_lock(&client->mutex);\n}"
  },
  {
    "function_name": "instproxy_strtoerr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/src/installation_proxy.c",
    "lines": "57-180",
    "snippet": "static instproxy_error_t instproxy_strtoerr(const char* name)\n{\n\tinstproxy_error_t err = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tif (strcmp(name, \"AlreadyArchived\") == 0) {\n\t\terr = INSTPROXY_E_ALREADY_ARCHIVED;\n\t} else if (strcmp(name, \"APIInternalError\") == 0) {\n\t\terr = INSTPROXY_E_API_INTERNAL_ERROR;\n\t} else if (strcmp(name, \"ApplicationAlreadyInstalled\") == 0) {\n\t\terr = INSTPROXY_E_APPLICATION_ALREADY_INSTALLED;\n\t} else if (strcmp(name, \"ApplicationMoveFailed\") == 0) {\n\t\terr = INSTPROXY_E_APPLICATION_MOVE_FAILED;\n\t} else if (strcmp(name, \"ApplicationSINFCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_APPLICATION_SINF_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"ApplicationSandboxFailed\") == 0) {\n\t\terr = INSTPROXY_E_APPLICATION_SANDBOX_FAILED;\n\t} else if (strcmp(name, \"ApplicationVerificationFailed\") == 0) {\n\t\terr = INSTPROXY_E_APPLICATION_VERIFICATION_FAILED;\n\t} else if (strcmp(name, \"ArchiveDestructionFailed\") == 0) {\n\t\terr = INSTPROXY_E_ARCHIVE_DESTRUCTION_FAILED;\n\t} else if (strcmp(name, \"BundleVerificationFailed\") == 0) {\n\t\terr = INSTPROXY_E_BUNDLE_VERIFICATION_FAILED;\n\t} else if (strcmp(name, \"CarrierBundleCopyFailed\") == 0) {\n\t\terr = INSTPROXY_E_CARRIER_BUNDLE_COPY_FAILED;\n\t} else if (strcmp(name, \"CarrierBundleDirectoryCreationFailed\") == 0) {\n\t\terr = INSTPROXY_E_CARRIER_BUNDLE_DIRECTORY_CREATION_FAILED;\n\t} else if (strcmp(name, \"CarrierBundleMissingSupportedSIMs\") == 0) {\n\t\terr = INSTPROXY_E_CARRIER_BUNDLE_MISSING_SUPPORTED_SIMS;\n\t} else if (strcmp(name, \"CommCenterNotificationFailed\") == 0) {\n\t\terr = INSTPROXY_E_COMM_CENTER_NOTIFICATION_FAILED;\n\t} else if (strcmp(name, \"ContainerCreationFailed\") == 0) {\n\t\terr = INSTPROXY_E_CONTAINER_CREATION_FAILED;\n\t} else if (strcmp(name, \"ContainerP0wnFailed\") == 0) {\n\t\terr = INSTPROXY_E_CONTAINER_P0WN_FAILED;\n\t} else if (strcmp(name, \"ContainerRemovalFailed\") == 0) {\n\t\terr = INSTPROXY_E_CONTAINER_REMOVAL_FAILED;\n\t} else if (strcmp(name, \"EmbeddedProfileInstallFailed\") == 0) {\n\t\terr = INSTPROXY_E_EMBEDDED_PROFILE_INSTALL_FAILED;\n\t} else if (strcmp(name, \"ExecutableTwiddleFailed\") == 0) {\n\t\terr = INSTPROXY_E_EXECUTABLE_TWIDDLE_FAILED;\n\t} else if (strcmp(name, \"ExistenceCheckFailed\") == 0) {\n\t\terr = INSTPROXY_E_EXISTENCE_CHECK_FAILED;\n\t} else if (strcmp(name, \"InstallMapUpdateFailed\") == 0) {\n\t\terr = INSTPROXY_E_INSTALL_MAP_UPDATE_FAILED;\n\t} else if (strcmp(name, \"ManifestCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_MANIFEST_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"MapGenerationFailed\") == 0) {\n\t\terr = INSTPROXY_E_MAP_GENERATION_FAILED;\n\t} else if (strcmp(name, \"MissingBundleExecutable\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_BUNDLE_EXECUTABLE;\n\t} else if (strcmp(name, \"MissingBundleIdentifier\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_BUNDLE_IDENTIFIER;\n\t} else if (strcmp(name, \"MissingBundlePath\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_BUNDLE_PATH;\n\t} else if (strcmp(name, \"MissingContainer\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_CONTAINER;\n\t} else if (strcmp(name, \"NotificationFailed\") == 0) {\n\t\terr = INSTPROXY_E_NOTIFICATION_FAILED;\n\t} else if (strcmp(name, \"PackageExtractionFailed\") == 0) {\n\t\terr = INSTPROXY_E_PACKAGE_EXTRACTION_FAILED;\n\t} else if (strcmp(name, \"PackageInspectionFailed\") == 0) {\n\t\terr = INSTPROXY_E_PACKAGE_INSPECTION_FAILED;\n\t} else if (strcmp(name, \"PackageMoveFailed\") == 0) {\n\t\terr = INSTPROXY_E_PACKAGE_MOVE_FAILED;\n\t} else if (strcmp(name, \"PathConversionFailed\") == 0) {\n\t\terr = INSTPROXY_E_PATH_CONVERSION_FAILED;\n\t} else if (strcmp(name, \"RestoreContainerFailed\") == 0) {\n\t\terr = INSTPROXY_E_RESTORE_CONTAINER_FAILED;\n\t} else if (strcmp(name, \"SeatbeltProfileRemovalFailed\") == 0) {\n\t\terr = INSTPROXY_E_SEATBELT_PROFILE_REMOVAL_FAILED;\n\t} else if (strcmp(name, \"StageCreationFailed\") == 0) {\n\t\terr = INSTPROXY_E_STAGE_CREATION_FAILED;\n\t} else if (strcmp(name, \"SymlinkFailed\") == 0) {\n\t\terr = INSTPROXY_E_SYMLINK_FAILED;\n\t} else if (strcmp(name, \"UnknownCommand\") == 0) {\n\t\terr = INSTPROXY_E_UNKNOWN_COMMAND;\n\t} else if (strcmp(name, \"iTunesArtworkCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_ITUNES_ARTWORK_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"iTunesMetadataCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_ITUNES_METADATA_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"DeviceOSVersionTooLow\") == 0) {\n\t\terr = INSTPROXY_E_DEVICE_OS_VERSION_TOO_LOW;\n\t} else if (strcmp(name, \"DeviceFamilyNotSupported\") == 0) {\n\t\terr = INSTPROXY_E_DEVICE_FAMILY_NOT_SUPPORTED;\n\t} else if (strcmp(name, \"PackagePatchFailed\") == 0) {\n\t\terr = INSTPROXY_E_PACKAGE_PATCH_FAILED;\n\t} else if (strcmp(name, \"IncorrectArchitecture\") == 0) {\n\t\terr = INSTPROXY_E_INCORRECT_ARCHITECTURE;\n\t} else if (strcmp(name, \"PluginCopyFailed\") == 0) {\n\t\terr = INSTPROXY_E_PLUGIN_COPY_FAILED;\n\t} else if (strcmp(name, \"BreadcrumbFailed\") == 0) {\n\t\terr = INSTPROXY_E_BREADCRUMB_FAILED;\n\t} else if (strcmp(name, \"BreadcrumbUnlockFailed\") == 0) {\n\t\terr = INSTPROXY_E_BREADCRUMB_UNLOCK_FAILED;\n\t} else if (strcmp(name, \"GeoJSONCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_GEOJSON_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"NewsstandArtworkCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_NEWSSTAND_ARTWORK_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"MissingCommand\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_COMMAND;\n\t} else if (strcmp(name, \"NotEntitled\") == 0) {\n\t\terr = INSTPROXY_E_NOT_ENTITLED;\n\t} else if (strcmp(name, \"MissingPackagePath\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_PACKAGE_PATH;\n\t} else if (strcmp(name, \"MissingContainerPath\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_CONTAINER_PATH;\n\t} else if (strcmp(name, \"MissingApplicationIdentifier\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_APPLICATION_IDENTIFIER;\n\t} else if (strcmp(name, \"MissingAttributeValue\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_ATTRIBUTE_VALUE;\n\t} else if (strcmp(name, \"LookupFailed\") == 0) {\n\t\terr = INSTPROXY_E_LOOKUP_FAILED;\n\t} else if (strcmp(name, \"DictCreationFailed\") == 0) {\n\t\terr = INSTPROXY_E_DICT_CREATION_FAILED;\n\t} else if (strcmp(name, \"InstallProhibited\") == 0) {\n\t\terr = INSTPROXY_E_INSTALL_PROHIBITED;\n\t} else if (strcmp(name, \"UninstallProhibited\") == 0) {\n\t\terr = INSTPROXY_E_UNINSTALL_PROHIBITED;\n\t} else if (strcmp(name, \"MissingBundleVersion\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_BUNDLE_VERSION;\n\t}\n\n\treturn err;\n}",
    "includes": [
      "#include \"common/debug.h\"",
      "#include \"property_list_service.h\"",
      "#include \"installation_proxy.h\"",
      "#include <plist/plist.h>",
      "#include <unistd.h>",
      "#include <inttypes.h>",
      "#include <stdlib.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "\"MissingBundleVersion\""
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "plist_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-5104/repo/tools/idevicebackup.c",
          "lines": "296-309",
          "snippet": "static int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"common/utils.h\"",
            "#include <libimobiledevice/afc.h>",
            "#include <libimobiledevice/notification_proxy.h>",
            "#include <libimobiledevice/mobilebackup.h>",
            "#include <libimobiledevice/lockdown.h>",
            "#include <libimobiledevice/libimobiledevice.h>",
            "#include <time.h>",
            "#include <ctype.h>",
            "#include <unistd.h>",
            "#include <gcrypt.h>",
            "#include <openssl/sha.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"common/utils.h\"\n#include <libimobiledevice/afc.h>\n#include <libimobiledevice/notification_proxy.h>\n#include <libimobiledevice/mobilebackup.h>\n#include <libimobiledevice/lockdown.h>\n#include <libimobiledevice/libimobiledevice.h>\n#include <time.h>\n#include <ctype.h>\n#include <unistd.h>\n#include <gcrypt.h>\n#include <openssl/sha.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int plist_strcmp(plist_t node, const char *str)\n{\n\tchar *buffer = NULL;\n\tint ret = 0;\n\n\tif (plist_get_node_type(node) != PLIST_STRING)\n\t\treturn ret;\n\n\tplist_get_string_val(node, &buffer);\n\tret = strcmp(buffer, str);\n\tfree(buffer);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common/debug.h\"\n#include \"property_list_service.h\"\n#include \"installation_proxy.h\"\n#include <plist/plist.h>\n#include <unistd.h>\n#include <inttypes.h>\n#include <stdlib.h>\n#include <string.h>\n\nstatic instproxy_error_t instproxy_strtoerr(const char* name)\n{\n\tinstproxy_error_t err = INSTPROXY_E_UNKNOWN_ERROR;\n\n\tif (strcmp(name, \"AlreadyArchived\") == 0) {\n\t\terr = INSTPROXY_E_ALREADY_ARCHIVED;\n\t} else if (strcmp(name, \"APIInternalError\") == 0) {\n\t\terr = INSTPROXY_E_API_INTERNAL_ERROR;\n\t} else if (strcmp(name, \"ApplicationAlreadyInstalled\") == 0) {\n\t\terr = INSTPROXY_E_APPLICATION_ALREADY_INSTALLED;\n\t} else if (strcmp(name, \"ApplicationMoveFailed\") == 0) {\n\t\terr = INSTPROXY_E_APPLICATION_MOVE_FAILED;\n\t} else if (strcmp(name, \"ApplicationSINFCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_APPLICATION_SINF_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"ApplicationSandboxFailed\") == 0) {\n\t\terr = INSTPROXY_E_APPLICATION_SANDBOX_FAILED;\n\t} else if (strcmp(name, \"ApplicationVerificationFailed\") == 0) {\n\t\terr = INSTPROXY_E_APPLICATION_VERIFICATION_FAILED;\n\t} else if (strcmp(name, \"ArchiveDestructionFailed\") == 0) {\n\t\terr = INSTPROXY_E_ARCHIVE_DESTRUCTION_FAILED;\n\t} else if (strcmp(name, \"BundleVerificationFailed\") == 0) {\n\t\terr = INSTPROXY_E_BUNDLE_VERIFICATION_FAILED;\n\t} else if (strcmp(name, \"CarrierBundleCopyFailed\") == 0) {\n\t\terr = INSTPROXY_E_CARRIER_BUNDLE_COPY_FAILED;\n\t} else if (strcmp(name, \"CarrierBundleDirectoryCreationFailed\") == 0) {\n\t\terr = INSTPROXY_E_CARRIER_BUNDLE_DIRECTORY_CREATION_FAILED;\n\t} else if (strcmp(name, \"CarrierBundleMissingSupportedSIMs\") == 0) {\n\t\terr = INSTPROXY_E_CARRIER_BUNDLE_MISSING_SUPPORTED_SIMS;\n\t} else if (strcmp(name, \"CommCenterNotificationFailed\") == 0) {\n\t\terr = INSTPROXY_E_COMM_CENTER_NOTIFICATION_FAILED;\n\t} else if (strcmp(name, \"ContainerCreationFailed\") == 0) {\n\t\terr = INSTPROXY_E_CONTAINER_CREATION_FAILED;\n\t} else if (strcmp(name, \"ContainerP0wnFailed\") == 0) {\n\t\terr = INSTPROXY_E_CONTAINER_P0WN_FAILED;\n\t} else if (strcmp(name, \"ContainerRemovalFailed\") == 0) {\n\t\terr = INSTPROXY_E_CONTAINER_REMOVAL_FAILED;\n\t} else if (strcmp(name, \"EmbeddedProfileInstallFailed\") == 0) {\n\t\terr = INSTPROXY_E_EMBEDDED_PROFILE_INSTALL_FAILED;\n\t} else if (strcmp(name, \"ExecutableTwiddleFailed\") == 0) {\n\t\terr = INSTPROXY_E_EXECUTABLE_TWIDDLE_FAILED;\n\t} else if (strcmp(name, \"ExistenceCheckFailed\") == 0) {\n\t\terr = INSTPROXY_E_EXISTENCE_CHECK_FAILED;\n\t} else if (strcmp(name, \"InstallMapUpdateFailed\") == 0) {\n\t\terr = INSTPROXY_E_INSTALL_MAP_UPDATE_FAILED;\n\t} else if (strcmp(name, \"ManifestCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_MANIFEST_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"MapGenerationFailed\") == 0) {\n\t\terr = INSTPROXY_E_MAP_GENERATION_FAILED;\n\t} else if (strcmp(name, \"MissingBundleExecutable\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_BUNDLE_EXECUTABLE;\n\t} else if (strcmp(name, \"MissingBundleIdentifier\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_BUNDLE_IDENTIFIER;\n\t} else if (strcmp(name, \"MissingBundlePath\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_BUNDLE_PATH;\n\t} else if (strcmp(name, \"MissingContainer\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_CONTAINER;\n\t} else if (strcmp(name, \"NotificationFailed\") == 0) {\n\t\terr = INSTPROXY_E_NOTIFICATION_FAILED;\n\t} else if (strcmp(name, \"PackageExtractionFailed\") == 0) {\n\t\terr = INSTPROXY_E_PACKAGE_EXTRACTION_FAILED;\n\t} else if (strcmp(name, \"PackageInspectionFailed\") == 0) {\n\t\terr = INSTPROXY_E_PACKAGE_INSPECTION_FAILED;\n\t} else if (strcmp(name, \"PackageMoveFailed\") == 0) {\n\t\terr = INSTPROXY_E_PACKAGE_MOVE_FAILED;\n\t} else if (strcmp(name, \"PathConversionFailed\") == 0) {\n\t\terr = INSTPROXY_E_PATH_CONVERSION_FAILED;\n\t} else if (strcmp(name, \"RestoreContainerFailed\") == 0) {\n\t\terr = INSTPROXY_E_RESTORE_CONTAINER_FAILED;\n\t} else if (strcmp(name, \"SeatbeltProfileRemovalFailed\") == 0) {\n\t\terr = INSTPROXY_E_SEATBELT_PROFILE_REMOVAL_FAILED;\n\t} else if (strcmp(name, \"StageCreationFailed\") == 0) {\n\t\terr = INSTPROXY_E_STAGE_CREATION_FAILED;\n\t} else if (strcmp(name, \"SymlinkFailed\") == 0) {\n\t\terr = INSTPROXY_E_SYMLINK_FAILED;\n\t} else if (strcmp(name, \"UnknownCommand\") == 0) {\n\t\terr = INSTPROXY_E_UNKNOWN_COMMAND;\n\t} else if (strcmp(name, \"iTunesArtworkCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_ITUNES_ARTWORK_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"iTunesMetadataCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_ITUNES_METADATA_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"DeviceOSVersionTooLow\") == 0) {\n\t\terr = INSTPROXY_E_DEVICE_OS_VERSION_TOO_LOW;\n\t} else if (strcmp(name, \"DeviceFamilyNotSupported\") == 0) {\n\t\terr = INSTPROXY_E_DEVICE_FAMILY_NOT_SUPPORTED;\n\t} else if (strcmp(name, \"PackagePatchFailed\") == 0) {\n\t\terr = INSTPROXY_E_PACKAGE_PATCH_FAILED;\n\t} else if (strcmp(name, \"IncorrectArchitecture\") == 0) {\n\t\terr = INSTPROXY_E_INCORRECT_ARCHITECTURE;\n\t} else if (strcmp(name, \"PluginCopyFailed\") == 0) {\n\t\terr = INSTPROXY_E_PLUGIN_COPY_FAILED;\n\t} else if (strcmp(name, \"BreadcrumbFailed\") == 0) {\n\t\terr = INSTPROXY_E_BREADCRUMB_FAILED;\n\t} else if (strcmp(name, \"BreadcrumbUnlockFailed\") == 0) {\n\t\terr = INSTPROXY_E_BREADCRUMB_UNLOCK_FAILED;\n\t} else if (strcmp(name, \"GeoJSONCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_GEOJSON_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"NewsstandArtworkCaptureFailed\") == 0) {\n\t\terr = INSTPROXY_E_NEWSSTAND_ARTWORK_CAPTURE_FAILED;\n\t} else if (strcmp(name, \"MissingCommand\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_COMMAND;\n\t} else if (strcmp(name, \"NotEntitled\") == 0) {\n\t\terr = INSTPROXY_E_NOT_ENTITLED;\n\t} else if (strcmp(name, \"MissingPackagePath\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_PACKAGE_PATH;\n\t} else if (strcmp(name, \"MissingContainerPath\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_CONTAINER_PATH;\n\t} else if (strcmp(name, \"MissingApplicationIdentifier\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_APPLICATION_IDENTIFIER;\n\t} else if (strcmp(name, \"MissingAttributeValue\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_ATTRIBUTE_VALUE;\n\t} else if (strcmp(name, \"LookupFailed\") == 0) {\n\t\terr = INSTPROXY_E_LOOKUP_FAILED;\n\t} else if (strcmp(name, \"DictCreationFailed\") == 0) {\n\t\terr = INSTPROXY_E_DICT_CREATION_FAILED;\n\t} else if (strcmp(name, \"InstallProhibited\") == 0) {\n\t\terr = INSTPROXY_E_INSTALL_PROHIBITED;\n\t} else if (strcmp(name, \"UninstallProhibited\") == 0) {\n\t\terr = INSTPROXY_E_UNINSTALL_PROHIBITED;\n\t} else if (strcmp(name, \"MissingBundleVersion\") == 0) {\n\t\terr = INSTPROXY_E_MISSING_BUNDLE_VERSION;\n\t}\n\n\treturn err;\n}"
  }
]