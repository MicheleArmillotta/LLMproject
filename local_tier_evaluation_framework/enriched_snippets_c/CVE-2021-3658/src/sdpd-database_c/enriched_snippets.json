[
  {
    "function_name": "sdp_next_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "297-305",
    "snippet": "uint32_t sdp_next_handle(void)\n{\n\tuint32_t handle = 0x10000;\n\n\twhile (sdp_record_find(handle))\n\t\thandle++;\n\n\treturn handle;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp_record_find",
          "args": [
            "handle"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_record_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
          "lines": "227-237",
          "snippet": "sdp_record_t *sdp_record_find(uint32_t handle)\n{\n\tsdp_list_t *p = record_locate(handle);\n\n\tif (!p) {\n\t\tSDPDBG(\"Couldn't find record for : 0x%x\", handle);\n\t\treturn 0;\n\t}\n\n\treturn p->data;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nsdp_record_t *sdp_record_find(uint32_t handle)\n{\n\tsdp_list_t *p = record_locate(handle);\n\n\tif (!p) {\n\t\tSDPDBG(\"Couldn't find record for : 0x%x\", handle);\n\t\treturn 0;\n\t}\n\n\treturn p->data;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nuint32_t sdp_next_handle(void)\n{\n\tuint32_t handle = 0x10000;\n\n\twhile (sdp_record_find(handle))\n\t\thandle++;\n\n\treturn handle;\n}"
  },
  {
    "function_name": "sdp_check_access",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "277-295",
    "snippet": "int sdp_check_access(uint32_t handle, bdaddr_t *device)\n{\n\tsdp_list_t *p = access_locate(handle);\n\tsdp_access_t *a;\n\n\tif (!p)\n\t\treturn 1;\n\n\ta = p->data;\n\tif (!a)\n\t\treturn 1;\n\n\tif (bacmp(&a->device, device) &&\n\t\t\tbacmp(&a->device, BDADDR_ANY) &&\n\t\t\tbacmp(device, BDADDR_ANY))\n\t\treturn 0;\n\n\treturn 1;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bacmp",
          "args": [
            "device",
            "BDADDR_ANY"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bacmp",
          "args": [
            "&a->device",
            "BDADDR_ANY"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bacmp",
          "args": [
            "&a->device",
            "device"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_locate",
          "args": [
            "handle"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "access_locate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
          "lines": "209-222",
          "snippet": "static sdp_list_t *access_locate(uint32_t handle)\n{\n\tif (access_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_access_t a;\n\n\t\ta.handle = handle;\n\t\tp = sdp_list_find(access_db, &a, access_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find access data for : 0x%x\", handle);\n\treturn NULL;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static sdp_list_t *access_db;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *access_db;\n\nstatic sdp_list_t *access_locate(uint32_t handle)\n{\n\tif (access_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_access_t a;\n\n\t\ta.handle = handle;\n\t\tp = sdp_list_find(access_db, &a, access_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find access data for : 0x%x\", handle);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nint sdp_check_access(uint32_t handle, bdaddr_t *device)\n{\n\tsdp_list_t *p = access_locate(handle);\n\tsdp_access_t *a;\n\n\tif (!p)\n\t\treturn 1;\n\n\ta = p->data;\n\tif (!a)\n\t\treturn 1;\n\n\tif (bacmp(&a->device, device) &&\n\t\t\tbacmp(&a->device, BDADDR_ANY) &&\n\t\t\tbacmp(device, BDADDR_ANY))\n\t\treturn 0;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "sdp_get_record_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "272-275",
    "snippet": "sdp_list_t *sdp_get_record_list(void)\n{\n\treturn service_db;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static sdp_list_t *service_db;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *service_db;\n\nsdp_list_t *sdp_get_record_list(void)\n{\n\treturn service_db;\n}"
  },
  {
    "function_name": "sdp_record_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "242-267",
    "snippet": "int sdp_record_remove(uint32_t handle)\n{\n\tsdp_list_t *p = record_locate(handle);\n\tsdp_record_t *r;\n\tsdp_access_t *a;\n\n\tif (!p) {\n\t\terror(\"Remove : Couldn't find record for : 0x%x\", handle);\n\t\treturn -1;\n\t}\n\n\tr = p->data;\n\tif (r)\n\t\tservice_db = sdp_list_remove(service_db, r);\n\n\tp = access_locate(handle);\n\tif (p == NULL || p->data == NULL)\n\t\treturn 0;\n\n\ta = p->data;\n\n\taccess_db = sdp_list_remove(access_db, a);\n\taccess_free(a);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static sdp_list_t *service_db;",
      "static sdp_list_t *access_db;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "access_free",
          "args": [
            "a"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "access_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
          "lines": "80-83",
          "snippet": "static void access_free(void *p)\n{\n\tfree(p);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic void access_free(void *p)\n{\n\tfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_list_remove",
          "args": [
            "access_db",
            "a"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access_locate",
          "args": [
            "handle"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "access_locate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
          "lines": "209-222",
          "snippet": "static sdp_list_t *access_locate(uint32_t handle)\n{\n\tif (access_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_access_t a;\n\n\t\ta.handle = handle;\n\t\tp = sdp_list_find(access_db, &a, access_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find access data for : 0x%x\", handle);\n\treturn NULL;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static sdp_list_t *access_db;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *access_db;\n\nstatic sdp_list_t *access_locate(uint32_t handle)\n{\n\tif (access_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_access_t a;\n\n\t\ta.handle = handle;\n\t\tp = sdp_list_find(access_db, &a, access_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find access data for : 0x%x\", handle);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_list_remove",
          "args": [
            "service_db",
            "r"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Remove : Couldn't find record for : 0x%x\"",
            "handle"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "btd_error_failed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/error.c",
          "lines": "124-128",
          "snippet": "DBusMessage *btd_error_failed(DBusMessage *msg, const char *str)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE\n\t\t\t\t\t\".Failed\", \"%s\", str);\n}",
          "includes": [
            "#include \"error.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"error.h\"\n#include \"gdbus/gdbus.h\"\n#include <config.h>\n\nDBusMessage *btd_error_failed(DBusMessage *msg, const char *str)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE\n\t\t\t\t\t\".Failed\", \"%s\", str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "record_locate",
          "args": [
            "handle"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "record_locate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
          "lines": "194-207",
          "snippet": "static sdp_list_t *record_locate(uint32_t handle)\n{\n\tif (service_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_record_t r;\n\n\t\tr.handle = handle;\n\t\tp = sdp_list_find(service_db, &r, record_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find svcRec for : 0x%x\", handle);\n\treturn NULL;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static sdp_list_t *service_db;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *service_db;\n\nstatic sdp_list_t *record_locate(uint32_t handle)\n{\n\tif (service_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_record_t r;\n\n\t\tr.handle = handle;\n\t\tp = sdp_list_find(service_db, &r, record_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find svcRec for : 0x%x\", handle);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *service_db;\nstatic sdp_list_t *access_db;\n\nint sdp_record_remove(uint32_t handle)\n{\n\tsdp_list_t *p = record_locate(handle);\n\tsdp_record_t *r;\n\tsdp_access_t *a;\n\n\tif (!p) {\n\t\terror(\"Remove : Couldn't find record for : 0x%x\", handle);\n\t\treturn -1;\n\t}\n\n\tr = p->data;\n\tif (r)\n\t\tservice_db = sdp_list_remove(service_db, r);\n\n\tp = access_locate(handle);\n\tif (p == NULL || p->data == NULL)\n\t\treturn 0;\n\n\ta = p->data;\n\n\taccess_db = sdp_list_remove(access_db, a);\n\taccess_free(a);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "sdp_record_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "227-237",
    "snippet": "sdp_record_t *sdp_record_find(uint32_t handle)\n{\n\tsdp_list_t *p = record_locate(handle);\n\n\tif (!p) {\n\t\tSDPDBG(\"Couldn't find record for : 0x%x\", handle);\n\t\treturn 0;\n\t}\n\n\treturn p->data;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SDPDBG",
          "args": [
            "\"Couldn't find record for : 0x%x\"",
            "handle"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "record_locate",
          "args": [
            "handle"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "record_locate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
          "lines": "194-207",
          "snippet": "static sdp_list_t *record_locate(uint32_t handle)\n{\n\tif (service_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_record_t r;\n\n\t\tr.handle = handle;\n\t\tp = sdp_list_find(service_db, &r, record_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find svcRec for : 0x%x\", handle);\n\treturn NULL;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static sdp_list_t *service_db;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *service_db;\n\nstatic sdp_list_t *record_locate(uint32_t handle)\n{\n\tif (service_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_record_t r;\n\n\t\tr.handle = handle;\n\t\tp = sdp_list_find(service_db, &r, record_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find svcRec for : 0x%x\", handle);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nsdp_record_t *sdp_record_find(uint32_t handle)\n{\n\tsdp_list_t *p = record_locate(handle);\n\n\tif (!p) {\n\t\tSDPDBG(\"Couldn't find record for : 0x%x\", handle);\n\t\treturn 0;\n\t}\n\n\treturn p->data;\n}"
  },
  {
    "function_name": "access_locate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "209-222",
    "snippet": "static sdp_list_t *access_locate(uint32_t handle)\n{\n\tif (access_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_access_t a;\n\n\t\ta.handle = handle;\n\t\tp = sdp_list_find(access_db, &a, access_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find access data for : 0x%x\", handle);\n\treturn NULL;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static sdp_list_t *access_db;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SDPDBG",
          "args": [
            "\"Could not find access data for : 0x%x\"",
            "handle"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_list_find",
          "args": [
            "access_db",
            "&a",
            "access_sort"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *access_db;\n\nstatic sdp_list_t *access_locate(uint32_t handle)\n{\n\tif (access_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_access_t a;\n\n\t\ta.handle = handle;\n\t\tp = sdp_list_find(access_db, &a, access_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find access data for : 0x%x\", handle);\n\treturn NULL;\n}"
  },
  {
    "function_name": "record_locate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "194-207",
    "snippet": "static sdp_list_t *record_locate(uint32_t handle)\n{\n\tif (service_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_record_t r;\n\n\t\tr.handle = handle;\n\t\tp = sdp_list_find(service_db, &r, record_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find svcRec for : 0x%x\", handle);\n\treturn NULL;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static sdp_list_t *service_db;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SDPDBG",
          "args": [
            "\"Could not find svcRec for : 0x%x\"",
            "handle"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_list_find",
          "args": [
            "service_db",
            "&r",
            "record_sort"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *service_db;\n\nstatic sdp_list_t *record_locate(uint32_t handle)\n{\n\tif (service_db) {\n\t\tsdp_list_t *p;\n\t\tsdp_record_t r;\n\n\t\tr.handle = handle;\n\t\tp = sdp_list_find(service_db, &r, record_sort);\n\t\treturn p;\n\t}\n\n\tSDPDBG(\"Could not find svcRec for : 0x%x\", handle);\n\treturn NULL;\n}"
  },
  {
    "function_name": "sdp_record_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "175-192",
    "snippet": "void sdp_record_add(const bdaddr_t *device, sdp_record_t *rec)\n{\n\tsdp_access_t *dev;\n\n\tSDPDBG(\"Adding rec : 0x%lx\", (long) rec);\n\tSDPDBG(\"with handle : 0x%x\", rec->handle);\n\n\tservice_db = sdp_list_insert_sorted(service_db, rec, record_sort);\n\n\tdev = malloc(sizeof(*dev));\n\tif (!dev)\n\t\treturn;\n\n\tbacpy(&dev->device, device);\n\tdev->handle = rec->handle;\n\n\taccess_db = sdp_list_insert_sorted(access_db, dev, access_sort);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static sdp_list_t *service_db;",
      "static sdp_list_t *access_db;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp_list_insert_sorted",
          "args": [
            "access_db",
            "dev",
            "access_sort"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bacpy",
          "args": [
            "&dev->device",
            "device"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*dev)"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "btd_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.c",
          "lines": "41-55",
          "snippet": "void *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"src/shared/util.h\"",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <stdbool.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/util.h\"\n#include <string.h>\n#include <limits.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <stdbool.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_list_insert_sorted",
          "args": [
            "service_db",
            "rec",
            "record_sort"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SDPDBG",
          "args": [
            "\"with handle : 0x%x\"",
            "rec->handle"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SDPDBG",
          "args": [
            "\"Adding rec : 0x%lx\"",
            "(long) rec"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *service_db;\nstatic sdp_list_t *access_db;\n\nvoid sdp_record_add(const bdaddr_t *device, sdp_record_t *rec)\n{\n\tsdp_access_t *dev;\n\n\tSDPDBG(\"Adding rec : 0x%lx\", (long) rec);\n\tSDPDBG(\"with handle : 0x%x\", rec->handle);\n\n\tservice_db = sdp_list_insert_sorted(service_db, rec, record_sort);\n\n\tdev = malloc(sizeof(*dev));\n\tif (!dev)\n\t\treturn;\n\n\tbacpy(&dev->device, device);\n\tdev->handle = rec->handle;\n\n\taccess_db = sdp_list_insert_sorted(access_db, dev, access_sort);\n}"
  },
  {
    "function_name": "sdp_svcdb_set_collectable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "158-170",
    "snippet": "void sdp_svcdb_set_collectable(sdp_record_t *record, int sock)\n{\n\tsdp_indexed_t *item = malloc(sizeof(sdp_indexed_t));\n\n\tif (!item) {\n\t\tSDPDBG(\"No memory\");\n\t\treturn;\n\t}\n\n\titem->sock = sock;\n\titem->record = record;\n\tsocket_index = sdp_list_insert_sorted(socket_index, item, compare_indices);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static sdp_list_t *socket_index;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp_list_insert_sorted",
          "args": [
            "socket_index",
            "item",
            "compare_indices"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SDPDBG",
          "args": [
            "\"No memory\""
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(sdp_indexed_t)"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "btd_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.c",
          "lines": "41-55",
          "snippet": "void *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"src/shared/util.h\"",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <stdbool.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/util.h\"\n#include <string.h>\n#include <limits.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <stdbool.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *socket_index;\n\nvoid sdp_svcdb_set_collectable(sdp_record_t *record, int sock)\n{\n\tsdp_indexed_t *item = malloc(sizeof(sdp_indexed_t));\n\n\tif (!item) {\n\t\tSDPDBG(\"No memory\");\n\t\treturn;\n\t}\n\n\titem->sock = sock;\n\titem->record = record;\n\tsocket_index = sdp_list_insert_sorted(socket_index, item, compare_indices);\n}"
  },
  {
    "function_name": "compare_indices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "151-156",
    "snippet": "static int compare_indices(const void *i1, const void *i2)\n{\n\tconst sdp_indexed_t *s1 = i1;\n\tconst sdp_indexed_t *s2 = i2;\n\treturn s1->sock - s2->sock;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic int compare_indices(const void *i1, const void *i2)\n{\n\tconst sdp_indexed_t *s1 = i1;\n\tconst sdp_indexed_t *s2 = i2;\n\treturn s1->sock - s2->sock;\n}"
  },
  {
    "function_name": "sdp_svcdb_collect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "133-149",
    "snippet": "void sdp_svcdb_collect(sdp_record_t *rec)\n{\n\tsdp_list_t *p, *q;\n\n\tfor (p = socket_index, q = 0; p; q = p, p = p->next) {\n\t\tsdp_indexed_t *item = p->data;\n\t\tif (rec == item->record) {\n\t\t\tfree(item);\n\t\t\tif (q)\n\t\t\t\tq->next = p->next;\n\t\t\telse\n\t\t\t\tsocket_index = p->next;\n\t\t\tfree(p);\n\t\t\treturn;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static sdp_list_t *socket_index;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "p"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "access_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
          "lines": "80-83",
          "snippet": "static void access_free(void *p)\n{\n\tfree(p);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic void access_free(void *p)\n{\n\tfree(p);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *socket_index;\n\nvoid sdp_svcdb_collect(sdp_record_t *rec)\n{\n\tsdp_list_t *p, *q;\n\n\tfor (p = socket_index, q = 0; p; q = p, p = p->next) {\n\t\tsdp_indexed_t *item = p->data;\n\t\tif (rec == item->record) {\n\t\t\tfree(item);\n\t\t\tif (q)\n\t\t\t\tq->next = p->next;\n\t\t\telse\n\t\t\t\tsocket_index = p->next;\n\t\t\tfree(p);\n\t\t\treturn;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "sdp_svcdb_collect_all",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "107-131",
    "snippet": "void sdp_svcdb_collect_all(int sock)\n{\n\tsdp_list_t *p, *q;\n\n\tfor (p = socket_index, q = 0; p; ) {\n\t\tsdp_indexed_t *item = p->data;\n\t\tif (item->sock == sock) {\n\t\t\tsdp_list_t *next = p->next;\n\t\t\tsdp_record_remove(item->record->handle);\n\t\t\tsdp_record_free(item->record);\n\t\t\tfree(item);\n\t\t\tif (q)\n\t\t\t\tq->next = next;\n\t\t\telse\n\t\t\t\tsocket_index = next;\n\t\t\tfree(p);\n\t\t\tp = next;\n\t\t} else if (item->sock > sock)\n\t\t\treturn;\n\t\telse {\n\t\t\tq = p;\n\t\t\tp = p->next;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static sdp_list_t *socket_index;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "p"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "access_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
          "lines": "80-83",
          "snippet": "static void access_free(void *p)\n{\n\tfree(p);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic void access_free(void *p)\n{\n\tfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_record_free",
          "args": [
            "item->record"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_record_remove",
          "args": [
            "item->record->handle"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_record_remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
          "lines": "242-267",
          "snippet": "int sdp_record_remove(uint32_t handle)\n{\n\tsdp_list_t *p = record_locate(handle);\n\tsdp_record_t *r;\n\tsdp_access_t *a;\n\n\tif (!p) {\n\t\terror(\"Remove : Couldn't find record for : 0x%x\", handle);\n\t\treturn -1;\n\t}\n\n\tr = p->data;\n\tif (r)\n\t\tservice_db = sdp_list_remove(service_db, r);\n\n\tp = access_locate(handle);\n\tif (p == NULL || p->data == NULL)\n\t\treturn 0;\n\n\ta = p->data;\n\n\taccess_db = sdp_list_remove(access_db, a);\n\taccess_free(a);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static sdp_list_t *service_db;",
            "static sdp_list_t *access_db;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *service_db;\nstatic sdp_list_t *access_db;\n\nint sdp_record_remove(uint32_t handle)\n{\n\tsdp_list_t *p = record_locate(handle);\n\tsdp_record_t *r;\n\tsdp_access_t *a;\n\n\tif (!p) {\n\t\terror(\"Remove : Couldn't find record for : 0x%x\", handle);\n\t\treturn -1;\n\t}\n\n\tr = p->data;\n\tif (r)\n\t\tservice_db = sdp_list_remove(service_db, r);\n\n\tp = access_locate(handle);\n\tif (p == NULL || p->data == NULL)\n\t\treturn 0;\n\n\ta = p->data;\n\n\taccess_db = sdp_list_remove(access_db, a);\n\taccess_free(a);\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *socket_index;\n\nvoid sdp_svcdb_collect_all(int sock)\n{\n\tsdp_list_t *p, *q;\n\n\tfor (p = socket_index, q = 0; p; ) {\n\t\tsdp_indexed_t *item = p->data;\n\t\tif (item->sock == sock) {\n\t\t\tsdp_list_t *next = p->next;\n\t\t\tsdp_record_remove(item->record->handle);\n\t\t\tsdp_record_free(item->record);\n\t\t\tfree(item);\n\t\t\tif (q)\n\t\t\t\tq->next = next;\n\t\t\telse\n\t\t\t\tsocket_index = next;\n\t\t\tfree(p);\n\t\t\tp = next;\n\t\t} else if (item->sock > sock)\n\t\t\treturn;\n\t\telse {\n\t\t\tq = p;\n\t\t\tp = p->next;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "sdp_svcdb_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "88-95",
    "snippet": "void sdp_svcdb_reset(void)\n{\n\tsdp_list_free(service_db, (sdp_free_func_t) sdp_record_free);\n\tservice_db = NULL;\n\n\tsdp_list_free(access_db, access_free);\n\taccess_db = NULL;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static sdp_list_t *service_db;",
      "static sdp_list_t *access_db;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp_list_free",
          "args": [
            "access_db",
            "access_free"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_list_free",
          "args": [
            "service_db",
            "(sdp_free_func_t) sdp_record_free"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic sdp_list_t *service_db;\nstatic sdp_list_t *access_db;\n\nvoid sdp_svcdb_reset(void)\n{\n\tsdp_list_free(service_db, (sdp_free_func_t) sdp_record_free);\n\tservice_db = NULL;\n\n\tsdp_list_free(access_db, access_free);\n\taccess_db = NULL;\n}"
  },
  {
    "function_name": "access_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "80-83",
    "snippet": "static void access_free(void *p)\n{\n\tfree(p);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "p"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "access_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
          "lines": "80-83",
          "snippet": "static void access_free(void *p)\n{\n\tfree(p);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic void access_free(void *p)\n{\n\tfree(p);\n}"
  },
  {
    "function_name": "access_sort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "67-78",
    "snippet": "static int access_sort(const void *r1, const void *r2)\n{\n\tconst sdp_access_t *rec1 = r1;\n\tconst sdp_access_t *rec2 = r2;\n\n\tif (!rec1 || !rec2) {\n\t\terror(\"NULL RECORD LIST FATAL\");\n\t\treturn -1;\n\t}\n\n\treturn rec1->handle - rec2->handle;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"NULL RECORD LIST FATAL\""
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "btd_error_not_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/error.c",
          "lines": "118-122",
          "snippet": "DBusMessage *btd_error_not_ready(DBusMessage *msg)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE \".NotReady\",\n\t\t\t\t\t\"Resource Not Ready\");\n}",
          "includes": [
            "#include \"error.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"error.h\"\n#include \"gdbus/gdbus.h\"\n#include <config.h>\n\nDBusMessage *btd_error_not_ready(DBusMessage *msg)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE \".NotReady\",\n\t\t\t\t\t\"Resource Not Ready\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic int access_sort(const void *r1, const void *r2)\n{\n\tconst sdp_access_t *rec1 = r1;\n\tconst sdp_access_t *rec2 = r2;\n\n\tif (!rec1 || !rec2) {\n\t\terror(\"NULL RECORD LIST FATAL\");\n\t\treturn -1;\n\t}\n\n\treturn rec1->handle - rec2->handle;\n}"
  },
  {
    "function_name": "record_sort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-database.c",
    "lines": "54-65",
    "snippet": "int record_sort(const void *r1, const void *r2)\n{\n\tconst sdp_record_t *rec1 = r1;\n\tconst sdp_record_t *rec2 = r2;\n\n\tif (!rec1 || !rec2) {\n\t\terror(\"NULL RECORD LIST FATAL\");\n\t\treturn -1;\n\t}\n\n\treturn rec1->handle - rec2->handle;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"sdpd.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <stdbool.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"NULL RECORD LIST FATAL\""
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "btd_error_not_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/error.c",
          "lines": "118-122",
          "snippet": "DBusMessage *btd_error_not_ready(DBusMessage *msg)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE \".NotReady\",\n\t\t\t\t\t\"Resource Not Ready\");\n}",
          "includes": [
            "#include \"error.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"error.h\"\n#include \"gdbus/gdbus.h\"\n#include <config.h>\n\nDBusMessage *btd_error_not_ready(DBusMessage *msg)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE \".NotReady\",\n\t\t\t\t\t\"Resource Not Ready\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <stdbool.h>\n#include <stdlib.h>\n#include <config.h>\n\nint record_sort(const void *r1, const void *r2)\n{\n\tconst sdp_record_t *rec1 = r1;\n\tconst sdp_record_t *rec2 = r2;\n\n\tif (!rec1 || !rec2) {\n\t\terror(\"NULL RECORD LIST FATAL\");\n\t\treturn -1;\n\t}\n\n\treturn rec1->handle - rec2->handle;\n}"
  }
]