[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "687-842",
    "snippet": "int main(int argc, char *argv[])\n{\n\tGOptionContext *context;\n\tGError *err = NULL;\n\tuint16_t sdp_mtu = 0;\n\tuint32_t sdp_flags = 0;\n\tint gdbus_flags = 0;\n\tguint signal, watchdog;\n\tconst char *watchdog_usec;\n\n\tinit_defaults();\n\n\tcontext = g_option_context_new(NULL);\n\tg_option_context_add_main_entries(context, options, NULL);\n\n\tif (g_option_context_parse(context, &argc, &argv, &err) == FALSE) {\n\t\tif (err != NULL) {\n\t\t\tg_printerr(\"%s\\n\", err->message);\n\t\t\tg_error_free(err);\n\t\t} else\n\t\t\tg_printerr(\"An unknown error occurred\\n\");\n\t\texit(1);\n\t}\n\n\tg_option_context_free(context);\n\n\tif (option_version == TRUE) {\n\t\tprintf(\"%s\\n\", VERSION);\n\t\texit(0);\n\t}\n\n\tumask(0077);\n\n\tbtd_backtrace_init();\n\n\tevent_loop = g_main_loop_new(NULL, FALSE);\n\n\tsignal = setup_signalfd();\n\n\t__btd_log_init(option_debug, option_detach);\n\n\tg_log_set_handler(\"GLib\", G_LOG_LEVEL_MASK | G_LOG_FLAG_FATAL |\n\t\t\t\t\t\t\tG_LOG_FLAG_RECURSION,\n\t\t\t\t\t\t\tlog_handler, NULL);\n\n\tsd_notify(0, \"STATUS=Starting up\");\n\n\tif (option_configfile)\n\t\tmain_conf_file_path = option_configfile;\n\telse\n\t\tmain_conf_file_path = CONFIGDIR \"/main.conf\";\n\n\tmain_conf = load_config(main_conf_file_path);\n\n\tparse_config(main_conf);\n\n\tif (connect_dbus() < 0) {\n\t\terror(\"Unable to get on D-Bus\");\n\t\texit(1);\n\t}\n\n\tif (option_experimental)\n\t\tgdbus_flags = G_DBUS_FLAG_ENABLE_EXPERIMENTAL;\n\n\tg_dbus_set_flags(gdbus_flags);\n\n\tif (adapter_init() < 0) {\n\t\terror(\"Adapter handling initialization failed\");\n\t\texit(1);\n\t}\n\n\tbtd_device_init();\n\tbtd_agent_init();\n\tbtd_profile_init();\n\n\tif (main_opts.mode != BT_MODE_LE) {\n\t\tif (option_compat == TRUE)\n\t\t\tsdp_flags |= SDP_SERVER_COMPAT;\n\n\t\tstart_sdp_server(sdp_mtu, sdp_flags);\n\n\t\tif (main_opts.did_source > 0)\n\t\t\tregister_device_id(main_opts.did_source,\n\t\t\t\t\t\tmain_opts.did_vendor,\n\t\t\t\t\t\tmain_opts.did_product,\n\t\t\t\t\t\tmain_opts.did_version);\n\t}\n\n\tif (mps != MPS_OFF)\n\t\tregister_mps(mps == MPS_MULTIPLE);\n\n\t/* Loading plugins has to be done after D-Bus has been setup since\n\t * the plugins might wanna expose some paths on the bus. However the\n\t * best order of how to init various subsystems of the Bluetooth\n\t * daemon needs to be re-worked. */\n\tplugin_init(option_plugin, option_noplugin);\n\n\t/* no need to keep parsed option in memory */\n\tfree_options();\n\n\trfkill_init();\n\n\tDBG(\"Entering main loop\");\n\n\tsd_notify(0, \"STATUS=Running\");\n\tsd_notify(0, \"READY=1\");\n\n\twatchdog_usec = getenv(\"WATCHDOG_USEC\");\n\tif (watchdog_usec) {\n\t\tunsigned int seconds;\n\n\t\tseconds = atoi(watchdog_usec) / (1000 * 1000);\n\t\tinfo(\"Watchdog timeout is %d seconds\", seconds);\n\n\t\twatchdog = g_timeout_add_seconds_full(G_PRIORITY_HIGH,\n\t\t\t\t\t\t\tseconds / 2,\n\t\t\t\t\t\t\twatchdog_callback,\n\t\t\t\t\t\t\tNULL, NULL);\n\t} else\n\t\twatchdog = 0;\n\n\tg_main_loop_run(event_loop);\n\n\tsd_notify(0, \"STATUS=Quitting\");\n\n\tg_source_remove(signal);\n\n\tplugin_cleanup();\n\n\tbtd_profile_cleanup();\n\tbtd_agent_cleanup();\n\tbtd_device_cleanup();\n\n\tadapter_cleanup();\n\n\trfkill_exit();\n\n\tif (main_opts.mode != BT_MODE_LE)\n\t\tstop_sdp_server();\n\n\tg_main_loop_unref(event_loop);\n\n\tif (main_conf)\n\t\tg_key_file_free(main_conf);\n\n\tdisconnect_dbus();\n\n\tinfo(\"Exit\");\n\n\tif (watchdog > 0)\n\t\tg_source_remove(watchdog);\n\n\t__btd_log_cleanup();\n\n\treturn 0;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct main_opts main_opts;",
      "static GKeyFile *main_conf;",
      "static char *main_conf_file_path;",
      "static enum {\n\tMPS_OFF,\n\tMPS_SINGLE,\n\tMPS_MULTIPLE,\n} mps = MPS_OFF;",
      "static GMainLoop *event_loop;",
      "static char *option_debug = NULL;",
      "static char *option_plugin = NULL;",
      "static char *option_noplugin = NULL;",
      "static char *option_configfile = NULL;",
      "static gboolean option_compat = FALSE;",
      "static gboolean option_detach = TRUE;",
      "static gboolean option_version = FALSE;",
      "static gboolean option_experimental = FALSE;",
      "static GOptionEntry options[] = {\n\t{ \"debug\", 'd', G_OPTION_FLAG_OPTIONAL_ARG,\n\t\t\t\tG_OPTION_ARG_CALLBACK, parse_debug,\n\t\t\t\t\"Specify debug options to enable\", \"DEBUG\" },\n\t{ \"plugin\", 'p', 0, G_OPTION_ARG_STRING, &option_plugin,\n\t\t\t\t\"Specify plugins to load\", \"NAME,..,\" },\n\t{ \"noplugin\", 'P', 0, G_OPTION_ARG_STRING, &option_noplugin,\n\t\t\t\t\"Specify plugins not to load\", \"NAME,...\" },\n\t{ \"configfile\", 'f', 0, G_OPTION_ARG_STRING, &option_configfile,\n\t\t\t\"Specify an explicit path to the config file\", \"FILE\"},\n\t{ \"compat\", 'C', 0, G_OPTION_ARG_NONE, &option_compat,\n\t\t\t\t\"Provide deprecated command line interfaces\" },\n\t{ \"experimental\", 'E', 0, G_OPTION_ARG_NONE, &option_experimental,\n\t\t\t\t\"Enable experimental interfaces\" },\n\t{ \"nodetach\", 'n', G_OPTION_FLAG_REVERSE,\n\t\t\t\tG_OPTION_ARG_NONE, &option_detach,\n\t\t\t\t\"Run with logging in foreground\" },\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ NULL },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__btd_log_cleanup",
          "args": [],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "__btd_log_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "324-331",
          "snippet": "void __btd_log_cleanup(void)\n{\n\tcloselog();\n\n\tlogging_close();\n\n\tg_strfreev(enabled);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char **enabled = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic char **enabled = NULL;\n\nvoid __btd_log_cleanup(void)\n{\n\tcloselog();\n\n\tlogging_close();\n\n\tg_strfreev(enabled);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_source_remove",
          "args": [
            "watchdog"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Exit\""
          ],
          "line": 834
        },
        "resolved": true,
        "details": {
          "function_name": "store_device_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/device.c",
          "lines": "475-487",
          "snippet": "static void store_device_info(struct btd_device *device)\n{\n\tif (device->temporary || device->store_id > 0)\n\t\treturn;\n\n\tif (device_address_is_private(device)) {\n\t\tDBG(\"Can't store info for private addressed device %s\",\n\t\t\t\t\t\t\t\tdevice->path);\n\t\treturn;\n\t}\n\n\tdevice->store_id = g_idle_add(store_device_info_cb, device);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"attrib-server.h\"",
            "#include \"storage.h\"",
            "#include \"textfile.h\"",
            "#include \"agent.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"sdp-client.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"service.h\"",
            "#include \"profile.h\"",
            "#include \"gatt-client.h\"",
            "#include \"device.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"gatt-database.h\"",
            "#include \"adapter.h\"",
            "#include \"hcid.h\"",
            "#include \"attrib/att.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/ad.h\"",
            "#include \"src/shared/gatt-server.h\"",
            "#include \"src/shared/gatt-client.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void gatt_client_init(struct btd_device *device);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"attrib-server.h\"\n#include \"storage.h\"\n#include \"textfile.h\"\n#include \"agent.h\"\n#include \"attrib/gatt.h\"\n#include \"sdp-client.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"service.h\"\n#include \"profile.h\"\n#include \"gatt-client.h\"\n#include \"device.h\"\n#include \"attrib/gattrib.h\"\n#include \"gatt-database.h\"\n#include \"adapter.h\"\n#include \"hcid.h\"\n#include \"attrib/att.h\"\n#include \"lib/mgmt.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/ad.h\"\n#include \"src/shared/gatt-server.h\"\n#include \"src/shared/gatt-client.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/util.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <time.h>\n#include <dirent.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void gatt_client_init(struct btd_device *device);\n\nstatic void store_device_info(struct btd_device *device)\n{\n\tif (device->temporary || device->store_id > 0)\n\t\treturn;\n\n\tif (device_address_is_private(device)) {\n\t\tDBG(\"Can't store info for private addressed device %s\",\n\t\t\t\t\t\t\t\tdevice->path);\n\t\treturn;\n\t}\n\n\tdevice->store_id = g_idle_add(store_device_info_cb, device);\n}"
        }
      },
      {
        "call_info": {
          "callee": "disconnect_dbus",
          "args": [],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "disconnect_dbus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "603-614",
          "snippet": "static void disconnect_dbus(void)\n{\n\tDBusConnection *conn = btd_get_dbus_connection();\n\n\tif (!conn || !dbus_connection_get_is_connected(conn))\n\t\treturn;\n\n\tg_dbus_detach_object_manager(conn);\n\tset_dbus_connection(NULL);\n\n\tdbus_connection_unref(conn);\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void disconnect_dbus(void)\n{\n\tDBusConnection *conn = btd_get_dbus_connection();\n\n\tif (!conn || !dbus_connection_get_is_connected(conn))\n\t\treturn;\n\n\tg_dbus_detach_object_manager(conn);\n\tset_dbus_connection(NULL);\n\n\tdbus_connection_unref(conn);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_key_file_free",
          "args": [
            "main_conf"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_main_loop_unref",
          "args": [
            "event_loop"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stop_sdp_server",
          "args": [],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "stop_sdp_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-server.c",
          "lines": "263-277",
          "snippet": "void stop_sdp_server(void)\n{\n\tinfo(\"Stopping SDP server\");\n\n\tsdp_svcdb_reset();\n\n\tif (unix_id > 0)\n\t\tg_source_remove(unix_id);\n\n\tif (l2cap_id > 0)\n\t\tg_source_remove(l2cap_id);\n\n\tl2cap_id = unix_id = 0;\n\tl2cap_sock = unix_sock = -1;\n}",
          "includes": [
            "#include \"sdpd.h\"",
            "#include \"log.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/l2cap.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/un.h>",
            "#include <sys/stat.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static guint l2cap_id = 0, unix_id = 0;",
            "static int l2cap_sock = -1, unix_sock = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sdpd.h\"\n#include \"log.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/l2cap.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/un.h>\n#include <sys/stat.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <config.h>\n\nstatic guint l2cap_id = 0, unix_id = 0;\nstatic int l2cap_sock = -1, unix_sock = -1;\n\nvoid stop_sdp_server(void)\n{\n\tinfo(\"Stopping SDP server\");\n\n\tsdp_svcdb_reset();\n\n\tif (unix_id > 0)\n\t\tg_source_remove(unix_id);\n\n\tif (l2cap_id > 0)\n\t\tg_source_remove(l2cap_id);\n\n\tl2cap_id = unix_id = 0;\n\tl2cap_sock = unix_sock = -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rfkill_exit",
          "args": [],
          "line": 822
        },
        "resolved": true,
        "details": {
          "function_name": "rfkill_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/rfkill.c",
          "lines": "167-174",
          "snippet": "void rfkill_exit(void)\n{\n\tif (watch == 0)\n\t\treturn;\n\n\tg_source_remove(watch);\n\twatch = 0;\n}",
          "includes": [
            "#include \"hcid.h\"",
            "#include \"adapter.h\"",
            "#include \"log.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static guint watch = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"hcid.h\"\n#include \"adapter.h\"\n#include \"log.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic guint watch = 0;\n\nvoid rfkill_exit(void)\n{\n\tif (watch == 0)\n\t\treturn;\n\n\tg_source_remove(watch);\n\twatch = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "adapter_cleanup",
          "args": [],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "adapter_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/adapter.c",
          "lines": "9059-9094",
          "snippet": "void adapter_cleanup(void)\n{\n\tg_list_free(adapter_list);\n\n\twhile (adapters) {\n\t\tstruct btd_adapter *adapter = adapters->data;\n\n\t\tadapter_remove(adapter);\n\t\tadapters = g_slist_remove(adapters, adapter);\n\t\tbtd_adapter_unref(adapter);\n\t}\n\n\t/*\n\t * In case there is another reference active, clear out\n\t * registered handlers for index added and index removed.\n\t *\n\t * This is just an extra precaution to be safe, and in\n\t * reality should not make a difference.\n\t */\n\tmgmt_unregister_index(mgmt_master, MGMT_INDEX_NONE);\n\n\t/*\n\t * In case there is another reference active, cancel\n\t * all pending global commands.\n\t *\n\t * This is just an extra precaution to avoid callbacks\n\t * that potentially then could leak memory or access\n\t * an invalid structure.\n\t */\n\tmgmt_cancel_index(mgmt_master, MGMT_INDEX_NONE);\n\n\tmgmt_unref(mgmt_master);\n\tmgmt_master = NULL;\n\n\tdbus_conn = NULL;\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"advertising.h\"",
            "#include \"gatt-database.h\"",
            "#include \"attrib-server.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"storage.h\"",
            "#include \"agent.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/mgmt.h\"",
            "#include \"textfile.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"bluetooth/sdp_lib.h\"",
            "#include \"bluetooth/sdp.h\"",
            "#include \"bluetooth/hci_lib.h\"",
            "#include \"bluetooth/hci.h\"",
            "#include \"bluetooth/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <sys/ioctl.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <inttypes.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DBusConnection *dbus_conn = NULL;",
            "static GList *adapter_list = NULL;",
            "static GSList *adapters = NULL;",
            "static struct mgmt *mgmt_master = NULL;",
            "static void trigger_pairable_timeout(struct btd_adapter *adapter);",
            "static void adapter_start(struct btd_adapter *adapter);",
            "static void adapter_stop(struct btd_adapter *adapter);",
            "static void trigger_passive_scanning(struct btd_adapter *adapter);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"advertising.h\"\n#include \"gatt-database.h\"\n#include \"attrib-server.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"storage.h\"\n#include \"agent.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/mgmt.h\"\n#include \"textfile.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/mgmt.h\"\n#include \"lib/uuid.h\"\n#include \"bluetooth/sdp_lib.h\"\n#include \"bluetooth/sdp.h\"\n#include \"bluetooth/hci_lib.h\"\n#include \"bluetooth/hci.h\"\n#include \"bluetooth/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <sys/ioctl.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <inttypes.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic DBusConnection *dbus_conn = NULL;\nstatic GList *adapter_list = NULL;\nstatic GSList *adapters = NULL;\nstatic struct mgmt *mgmt_master = NULL;\nstatic void trigger_pairable_timeout(struct btd_adapter *adapter);\nstatic void adapter_start(struct btd_adapter *adapter);\nstatic void adapter_stop(struct btd_adapter *adapter);\nstatic void trigger_passive_scanning(struct btd_adapter *adapter);\n\nvoid adapter_cleanup(void)\n{\n\tg_list_free(adapter_list);\n\n\twhile (adapters) {\n\t\tstruct btd_adapter *adapter = adapters->data;\n\n\t\tadapter_remove(adapter);\n\t\tadapters = g_slist_remove(adapters, adapter);\n\t\tbtd_adapter_unref(adapter);\n\t}\n\n\t/*\n\t * In case there is another reference active, clear out\n\t * registered handlers for index added and index removed.\n\t *\n\t * This is just an extra precaution to be safe, and in\n\t * reality should not make a difference.\n\t */\n\tmgmt_unregister_index(mgmt_master, MGMT_INDEX_NONE);\n\n\t/*\n\t * In case there is another reference active, cancel\n\t * all pending global commands.\n\t *\n\t * This is just an extra precaution to avoid callbacks\n\t * that potentially then could leak memory or access\n\t * an invalid structure.\n\t */\n\tmgmt_cancel_index(mgmt_master, MGMT_INDEX_NONE);\n\n\tmgmt_unref(mgmt_master);\n\tmgmt_master = NULL;\n\n\tdbus_conn = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "btd_device_cleanup",
          "args": [],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "btd_device_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/device.c",
          "lines": "6471-6474",
          "snippet": "void btd_device_cleanup(void)\n{\n\tbtd_service_remove_state_cb(service_state_cb_id);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"attrib-server.h\"",
            "#include \"storage.h\"",
            "#include \"textfile.h\"",
            "#include \"agent.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"sdp-client.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"service.h\"",
            "#include \"profile.h\"",
            "#include \"gatt-client.h\"",
            "#include \"device.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"gatt-database.h\"",
            "#include \"adapter.h\"",
            "#include \"hcid.h\"",
            "#include \"attrib/att.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/ad.h\"",
            "#include \"src/shared/gatt-server.h\"",
            "#include \"src/shared/gatt-client.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned service_state_cb_id;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"attrib-server.h\"\n#include \"storage.h\"\n#include \"textfile.h\"\n#include \"agent.h\"\n#include \"attrib/gatt.h\"\n#include \"sdp-client.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"service.h\"\n#include \"profile.h\"\n#include \"gatt-client.h\"\n#include \"device.h\"\n#include \"attrib/gattrib.h\"\n#include \"gatt-database.h\"\n#include \"adapter.h\"\n#include \"hcid.h\"\n#include \"attrib/att.h\"\n#include \"lib/mgmt.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/ad.h\"\n#include \"src/shared/gatt-server.h\"\n#include \"src/shared/gatt-client.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/util.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <time.h>\n#include <dirent.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic unsigned service_state_cb_id;\n\nvoid btd_device_cleanup(void)\n{\n\tbtd_service_remove_state_cb(service_state_cb_id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btd_agent_cleanup",
          "args": [],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "btd_agent_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/agent.c",
          "lines": "1046-1053",
          "snippet": "void btd_agent_cleanup(void)\n{\n\tg_dbus_unregister_interface(btd_get_dbus_connection(),\n\t\t\t\t\"/org/bluez\", \"org.bluez.AgentManager1\");\n\n\tg_hash_table_destroy(agent_list);\n\tqueue_destroy(default_agents, NULL);\n}",
          "includes": [
            "#include \"shared/queue.h\"",
            "#include \"agent.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"dbus-common.h\"",
            "#include \"hcid.h\"",
            "#include \"error.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static GHashTable *agent_list;",
            "struct queue *default_agents = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"shared/queue.h\"\n#include \"agent.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"dbus-common.h\"\n#include \"hcid.h\"\n#include \"error.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GHashTable *agent_list;\nstruct queue *default_agents = NULL;\n\nvoid btd_agent_cleanup(void)\n{\n\tg_dbus_unregister_interface(btd_get_dbus_connection(),\n\t\t\t\t\"/org/bluez\", \"org.bluez.AgentManager1\");\n\n\tg_hash_table_destroy(agent_list);\n\tqueue_destroy(default_agents, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btd_profile_cleanup",
          "args": [],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "btd_profile_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/profile.c",
          "lines": "2500-2528",
          "snippet": "void btd_profile_cleanup(void)\n{\n\twhile (ext_profiles) {\n\t\tstruct ext_profile *ext = ext_profiles->data;\n\t\tDBusConnection *conn = btd_get_dbus_connection();\n\t\tDBusMessage *msg;\n\n\t\tDBG(\"Releasing \\\"%s\\\"\", ext->name);\n\n\t\tg_slist_free_full(ext->conns, ext_io_destroy);\n\t\text->conns = NULL;\n\n\t\tmsg = dbus_message_new_method_call(ext->owner, ext->path,\n\t\t\t\t\t\t\t\"org.bluez.Profile1\",\n\t\t\t\t\t\t\t\"Release\");\n\t\tif (msg)\n\t\t\tg_dbus_send_message(conn, msg);\n\n\t\tg_dbus_remove_watch(conn, ext->id);\n\t\tremove_ext(ext);\n\n\t}\n\n\tg_slist_free_full(custom_props, free_property);\n\tcustom_props = NULL;\n\n\tg_dbus_unregister_interface(btd_get_dbus_connection(),\n\t\t\t\t\"/org/bluez\", \"org.bluez.ProfileManager1\");\n}",
          "includes": [
            "#include \"service.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdp-xml.h\"",
            "#include \"sdp-client.h\"",
            "#include \"dbus-common.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"btio/btio.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdbool.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static GSList *custom_props = NULL;",
            "static GSList *ext_profiles = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"service.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdp-xml.h\"\n#include \"sdp-client.h\"\n#include \"dbus-common.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"log.h\"\n#include \"sdpd.h\"\n#include \"btio/btio.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdbool.h>\n#include <config.h>\n\nstatic GSList *custom_props = NULL;\nstatic GSList *ext_profiles = NULL;\n\nvoid btd_profile_cleanup(void)\n{\n\twhile (ext_profiles) {\n\t\tstruct ext_profile *ext = ext_profiles->data;\n\t\tDBusConnection *conn = btd_get_dbus_connection();\n\t\tDBusMessage *msg;\n\n\t\tDBG(\"Releasing \\\"%s\\\"\", ext->name);\n\n\t\tg_slist_free_full(ext->conns, ext_io_destroy);\n\t\text->conns = NULL;\n\n\t\tmsg = dbus_message_new_method_call(ext->owner, ext->path,\n\t\t\t\t\t\t\t\"org.bluez.Profile1\",\n\t\t\t\t\t\t\t\"Release\");\n\t\tif (msg)\n\t\t\tg_dbus_send_message(conn, msg);\n\n\t\tg_dbus_remove_watch(conn, ext->id);\n\t\tremove_ext(ext);\n\n\t}\n\n\tg_slist_free_full(custom_props, free_property);\n\tcustom_props = NULL;\n\n\tg_dbus_unregister_interface(btd_get_dbus_connection(),\n\t\t\t\t\"/org/bluez\", \"org.bluez.ProfileManager1\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "plugin_cleanup",
          "args": [],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "plugin_cleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/plugin.c",
          "lines": "220-239",
          "snippet": "void plugin_cleanup(void)\n{\n\tGSList *list;\n\n\tDBG(\"Cleanup plugins\");\n\n\tfor (list = plugins; list; list = list->next) {\n\t\tstruct bluetooth_plugin *plugin = list->data;\n\n\t\tif (plugin->active == TRUE && plugin->desc->exit)\n\t\t\tplugin->desc->exit();\n\n\t\tif (plugin->handle != NULL)\n\t\t\tdlclose(plugin->handle);\n\n\t\tg_free(plugin);\n\t}\n\n\tg_slist_free(plugins);\n}",
          "includes": [
            "#include \"src/builtin.h\"",
            "#include \"src/hcid.h\"",
            "#include \"src/log.h\"",
            "#include \"src/plugin.h\"",
            "#include \"btio/btio.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <string.h>",
            "#include <dlfcn.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static GSList *plugins = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/builtin.h\"\n#include \"src/hcid.h\"\n#include \"src/log.h\"\n#include \"src/plugin.h\"\n#include \"btio/btio.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <dlfcn.h>\n#include <errno.h>\n#include <config.h>\n\nstatic GSList *plugins = NULL;\n\nvoid plugin_cleanup(void)\n{\n\tGSList *list;\n\n\tDBG(\"Cleanup plugins\");\n\n\tfor (list = plugins; list; list = list->next) {\n\t\tstruct bluetooth_plugin *plugin = list->data;\n\n\t\tif (plugin->active == TRUE && plugin->desc->exit)\n\t\t\tplugin->desc->exit();\n\n\t\tif (plugin->handle != NULL)\n\t\t\tdlclose(plugin->handle);\n\n\t\tg_free(plugin);\n\t}\n\n\tg_slist_free(plugins);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_source_remove",
          "args": [
            "signal"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sd_notify",
          "args": [
            "0",
            "\"STATUS=Quitting\""
          ],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "sd_notify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/systemd.c",
          "lines": "44-107",
          "snippet": "int sd_notify(int unset_environment, const char *state)\n{\n\tconst char *sock;\n\tstruct sockaddr_un addr;\n\tstruct msghdr msghdr;\n\tstruct iovec iovec;\n\tint fd, err;\n\n\tif (!state) {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tsock = getenv(\"NOTIFY_SOCKET\");\n\tif (!sock)\n\t\treturn 0;\n\n\t/* check for abstract socket or absolute path */\n\tif (sock[0] != '@' && sock[0] != '/') {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tfd = socket(AF_UNIX, SOCK_DGRAM | SOCK_CLOEXEC, 0);\n\tif (fd < 0) {\n\t\terr = -errno;\n\t\tgoto done;\n\t}\n\n\tmemset(&addr, 0, sizeof(addr));\n\taddr.sun_family = AF_UNIX;\n\tstrncpy(addr.sun_path, sock, sizeof(addr.sun_path) - 1);\n\n\tif (addr.sun_path[0] == '@')\n\t\taddr.sun_path[0] = '\\0';\n\n\tmemset(&iovec, 0, sizeof(iovec));\n\tiovec.iov_base = (char *) state;\n\tiovec.iov_len = strlen(state);\n\n\tmemset(&msghdr, 0, sizeof(msghdr));\n\tmsghdr.msg_name = &addr;\n\tmsghdr.msg_namelen = offsetof(struct sockaddr_un, sun_path) +\n\t\t\t\t\t\t\t\tstrlen(sock);\n\n\tif (msghdr.msg_namelen > sizeof(struct sockaddr_un))\n\t\tmsghdr.msg_namelen = sizeof(struct sockaddr_un);\n\n\tmsghdr.msg_iov = &iovec;\n\tmsghdr.msg_iovlen = 1;\n\n\tif (sendmsg(fd, &msghdr, MSG_NOSIGNAL) < 0)\n\t\terr = -errno;\n\telse\n\t\terr = 1;\n\n\tclose(fd);\n\ndone:\n\tif (unset_environment)\n\t\tunsetenv(\"NOTIFY_SOCKET\");\n\n\treturn err;\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <stddef.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nint sd_notify(int unset_environment, const char *state)\n{\n\tconst char *sock;\n\tstruct sockaddr_un addr;\n\tstruct msghdr msghdr;\n\tstruct iovec iovec;\n\tint fd, err;\n\n\tif (!state) {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tsock = getenv(\"NOTIFY_SOCKET\");\n\tif (!sock)\n\t\treturn 0;\n\n\t/* check for abstract socket or absolute path */\n\tif (sock[0] != '@' && sock[0] != '/') {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tfd = socket(AF_UNIX, SOCK_DGRAM | SOCK_CLOEXEC, 0);\n\tif (fd < 0) {\n\t\terr = -errno;\n\t\tgoto done;\n\t}\n\n\tmemset(&addr, 0, sizeof(addr));\n\taddr.sun_family = AF_UNIX;\n\tstrncpy(addr.sun_path, sock, sizeof(addr.sun_path) - 1);\n\n\tif (addr.sun_path[0] == '@')\n\t\taddr.sun_path[0] = '\\0';\n\n\tmemset(&iovec, 0, sizeof(iovec));\n\tiovec.iov_base = (char *) state;\n\tiovec.iov_len = strlen(state);\n\n\tmemset(&msghdr, 0, sizeof(msghdr));\n\tmsghdr.msg_name = &addr;\n\tmsghdr.msg_namelen = offsetof(struct sockaddr_un, sun_path) +\n\t\t\t\t\t\t\t\tstrlen(sock);\n\n\tif (msghdr.msg_namelen > sizeof(struct sockaddr_un))\n\t\tmsghdr.msg_namelen = sizeof(struct sockaddr_un);\n\n\tmsghdr.msg_iov = &iovec;\n\tmsghdr.msg_iovlen = 1;\n\n\tif (sendmsg(fd, &msghdr, MSG_NOSIGNAL) < 0)\n\t\terr = -errno;\n\telse\n\t\terr = 1;\n\n\tclose(fd);\n\ndone:\n\tif (unset_environment)\n\t\tunsetenv(\"NOTIFY_SOCKET\");\n\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_main_loop_run",
          "args": [
            "event_loop"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_timeout_add_seconds_full",
          "args": [
            "G_PRIORITY_HIGH",
            "seconds / 2",
            "watchdog_callback",
            "NULL",
            "NULL"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Watchdog timeout is %d seconds\"",
            "seconds"
          ],
          "line": 799
        },
        "resolved": true,
        "details": {
          "function_name": "convert_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/device.c",
          "lines": "2946-2983",
          "snippet": "static void convert_info(struct btd_device *device, GKeyFile *key_file)\n{\n\tchar filename[PATH_MAX];\n\tchar adapter_addr[18];\n\tchar device_addr[18];\n\tchar **uuids;\n\tchar *str;\n\tgsize length = 0;\n\n\t/* Load device profile list from legacy properties */\n\tuuids = g_key_file_get_string_list(key_file, \"General\", \"SDPServices\",\n\t\t\t\t\t\t\t\tNULL, NULL);\n\tif (uuids)\n\t\tload_services(device, uuids);\n\n\tuuids = g_key_file_get_string_list(key_file, \"General\", \"GATTServices\",\n\t\t\t\t\t\t\t\tNULL, NULL);\n\tif (uuids)\n\t\tload_services(device, uuids);\n\n\tif (!device->uuids)\n\t\treturn;\n\n\t/* Remove old entries so they are not loaded again */\n\tg_key_file_remove_key(key_file, \"General\", \"SDPServices\", NULL);\n\tg_key_file_remove_key(key_file, \"General\", \"GATTServices\", NULL);\n\n\tba2str(btd_adapter_get_address(device->adapter), adapter_addr);\n\tba2str(&device->bdaddr, device_addr);\n\tsnprintf(filename, PATH_MAX, STORAGEDIR \"/%s/%s/info\", adapter_addr,\n\t\t\tdevice_addr);\n\n\tstr = g_key_file_to_data(key_file, &length, NULL);\n\tg_file_set_contents(filename, str, length, NULL);\n\tg_free(str);\n\n\tstore_device_info(device);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"attrib-server.h\"",
            "#include \"storage.h\"",
            "#include \"textfile.h\"",
            "#include \"agent.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"sdp-client.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"service.h\"",
            "#include \"profile.h\"",
            "#include \"gatt-client.h\"",
            "#include \"device.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"gatt-database.h\"",
            "#include \"adapter.h\"",
            "#include \"hcid.h\"",
            "#include \"attrib/att.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/ad.h\"",
            "#include \"src/shared/gatt-server.h\"",
            "#include \"src/shared/gatt-client.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void gatt_client_init(struct btd_device *device);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"attrib-server.h\"\n#include \"storage.h\"\n#include \"textfile.h\"\n#include \"agent.h\"\n#include \"attrib/gatt.h\"\n#include \"sdp-client.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"service.h\"\n#include \"profile.h\"\n#include \"gatt-client.h\"\n#include \"device.h\"\n#include \"attrib/gattrib.h\"\n#include \"gatt-database.h\"\n#include \"adapter.h\"\n#include \"hcid.h\"\n#include \"attrib/att.h\"\n#include \"lib/mgmt.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/ad.h\"\n#include \"src/shared/gatt-server.h\"\n#include \"src/shared/gatt-client.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/util.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <time.h>\n#include <dirent.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void gatt_client_init(struct btd_device *device);\n\nstatic void convert_info(struct btd_device *device, GKeyFile *key_file)\n{\n\tchar filename[PATH_MAX];\n\tchar adapter_addr[18];\n\tchar device_addr[18];\n\tchar **uuids;\n\tchar *str;\n\tgsize length = 0;\n\n\t/* Load device profile list from legacy properties */\n\tuuids = g_key_file_get_string_list(key_file, \"General\", \"SDPServices\",\n\t\t\t\t\t\t\t\tNULL, NULL);\n\tif (uuids)\n\t\tload_services(device, uuids);\n\n\tuuids = g_key_file_get_string_list(key_file, \"General\", \"GATTServices\",\n\t\t\t\t\t\t\t\tNULL, NULL);\n\tif (uuids)\n\t\tload_services(device, uuids);\n\n\tif (!device->uuids)\n\t\treturn;\n\n\t/* Remove old entries so they are not loaded again */\n\tg_key_file_remove_key(key_file, \"General\", \"SDPServices\", NULL);\n\tg_key_file_remove_key(key_file, \"General\", \"GATTServices\", NULL);\n\n\tba2str(btd_adapter_get_address(device->adapter), adapter_addr);\n\tba2str(&device->bdaddr, device_addr);\n\tsnprintf(filename, PATH_MAX, STORAGEDIR \"/%s/%s/info\", adapter_addr,\n\t\t\tdevice_addr);\n\n\tstr = g_key_file_to_data(key_file, &length, NULL);\n\tg_file_set_contents(filename, str, length, NULL);\n\tg_free(str);\n\n\tstore_device_info(device);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "watchdog_usec"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"WATCHDOG_USEC\""
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"Entering main loop\""
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfkill_init",
          "args": [],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "rfkill_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/rfkill.c",
          "lines": "146-165",
          "snippet": "void rfkill_init(void)\n{\n\tint fd;\n\tGIOChannel *channel;\n\n\tfd = open(\"/dev/rfkill\", O_RDWR);\n\tif (fd < 0) {\n\t\terror(\"Failed to open RFKILL control device\");\n\t\treturn;\n\t}\n\n\tchannel = g_io_channel_unix_new(fd);\n\tg_io_channel_set_close_on_unref(channel, TRUE);\n\n\twatch = g_io_add_watch(channel,\n\t\t\t\tG_IO_IN | G_IO_NVAL | G_IO_HUP | G_IO_ERR,\n\t\t\t\trfkill_event, NULL);\n\n\tg_io_channel_unref(channel);\n}",
          "includes": [
            "#include \"hcid.h\"",
            "#include \"adapter.h\"",
            "#include \"log.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static guint watch = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"hcid.h\"\n#include \"adapter.h\"\n#include \"log.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic guint watch = 0;\n\nvoid rfkill_init(void)\n{\n\tint fd;\n\tGIOChannel *channel;\n\n\tfd = open(\"/dev/rfkill\", O_RDWR);\n\tif (fd < 0) {\n\t\terror(\"Failed to open RFKILL control device\");\n\t\treturn;\n\t}\n\n\tchannel = g_io_channel_unix_new(fd);\n\tg_io_channel_set_close_on_unref(channel, TRUE);\n\n\twatch = g_io_add_watch(channel,\n\t\t\t\tG_IO_IN | G_IO_NVAL | G_IO_HUP | G_IO_ERR,\n\t\t\t\trfkill_event, NULL);\n\n\tg_io_channel_unref(channel);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_options",
          "args": [],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "free_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "588-601",
          "snippet": "static void free_options(void)\n{\n\tg_free(option_debug);\n\toption_debug = NULL;\n\n\tg_free(option_plugin);\n\toption_plugin = NULL;\n\n\tg_free(option_noplugin);\n\toption_noplugin = NULL;\n\n\tg_free(option_configfile);\n\toption_configfile = NULL;\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *option_debug = NULL;",
            "static char *option_plugin = NULL;",
            "static char *option_noplugin = NULL;",
            "static char *option_configfile = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic char *option_debug = NULL;\nstatic char *option_plugin = NULL;\nstatic char *option_noplugin = NULL;\nstatic char *option_configfile = NULL;\n\nstatic void free_options(void)\n{\n\tg_free(option_debug);\n\toption_debug = NULL;\n\n\tg_free(option_plugin);\n\toption_plugin = NULL;\n\n\tg_free(option_noplugin);\n\toption_noplugin = NULL;\n\n\tg_free(option_configfile);\n\toption_configfile = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "plugin_init",
          "args": [
            "option_plugin",
            "option_noplugin"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "plugin_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/plugin.c",
          "lines": "115-218",
          "snippet": "gboolean plugin_init(const char *enable, const char *disable)\n{\n\tGSList *list;\n\tGDir *dir;\n\tconst char *file;\n\tchar **cli_disabled, **cli_enabled;\n\tunsigned int i;\n\n\t/* Make a call to BtIO API so its symbols got resolved before the\n\t * plugins are loaded. */\n\tbt_io_error_quark();\n\n\tif (enable)\n\t\tcli_enabled = g_strsplit_set(enable, \", \", -1);\n\telse\n\t\tcli_enabled = NULL;\n\n\tif (disable)\n\t\tcli_disabled = g_strsplit_set(disable, \", \", -1);\n\telse\n\t\tcli_disabled = NULL;\n\n\tDBG(\"Loading builtin plugins\");\n\n\tfor (i = 0; __bluetooth_builtin[i]; i++) {\n\t\tif (!enable_plugin(__bluetooth_builtin[i]->name, cli_enabled,\n\t\t\t\t\t\t\t\tcli_disabled))\n\t\t\tcontinue;\n\n\t\tadd_plugin(NULL,  __bluetooth_builtin[i]);\n\t}\n\n\tif (strlen(PLUGINDIR) == 0)\n\t\tgoto start;\n\n\tDBG(\"Loading plugins %s\", PLUGINDIR);\n\n\tdir = g_dir_open(PLUGINDIR, 0, NULL);\n\tif (!dir)\n\t\tgoto start;\n\n\twhile ((file = g_dir_read_name(dir)) != NULL) {\n\t\tstruct bluetooth_plugin_desc *desc;\n\t\tvoid *handle;\n\t\tchar *filename;\n\n\t\tif (g_str_has_prefix(file, \"lib\") == TRUE ||\n\t\t\t\tg_str_has_suffix(file, \".so\") == FALSE)\n\t\t\tcontinue;\n\n\t\tfilename = g_build_filename(PLUGINDIR, file, NULL);\n\n\t\thandle = dlopen(filename, RTLD_NOW);\n\t\tif (handle == NULL) {\n\t\t\terror(\"Can't load plugin %s: %s\", filename,\n\t\t\t\t\t\t\t\tdlerror());\n\t\t\tg_free(filename);\n\t\t\tcontinue;\n\t\t}\n\n\t\tg_free(filename);\n\n\t\tdesc = dlsym(handle, \"bluetooth_plugin_desc\");\n\t\tif (desc == NULL) {\n\t\t\terror(\"Can't load plugin description: %s\", dlerror());\n\t\t\tdlclose(handle);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!enable_plugin(desc->name, cli_enabled, cli_disabled)) {\n\t\t\tdlclose(handle);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (add_plugin(handle, desc) == FALSE)\n\t\t\tdlclose(handle);\n\t}\n\n\tg_dir_close(dir);\n\nstart:\n\tfor (list = plugins; list; list = list->next) {\n\t\tstruct bluetooth_plugin *plugin = list->data;\n\t\tint err;\n\n\t\terr = plugin->desc->init();\n\t\tif (err < 0) {\n\t\t\tif (err == -ENOSYS)\n\t\t\t\twarn(\"System does not support %s plugin\",\n\t\t\t\t\t\t\tplugin->desc->name);\n\t\t\telse\n\t\t\t\terror(\"Failed to init %s plugin\",\n\t\t\t\t\t\t\tplugin->desc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tplugin->active = TRUE;\n\t}\n\n\tg_strfreev(cli_enabled);\n\tg_strfreev(cli_disabled);\n\n\treturn TRUE;\n}",
          "includes": [
            "#include \"src/builtin.h\"",
            "#include \"src/hcid.h\"",
            "#include \"src/log.h\"",
            "#include \"src/plugin.h\"",
            "#include \"btio/btio.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <string.h>",
            "#include <dlfcn.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static GSList *plugins = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/builtin.h\"\n#include \"src/hcid.h\"\n#include \"src/log.h\"\n#include \"src/plugin.h\"\n#include \"btio/btio.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/stat.h>\n#include <string.h>\n#include <dlfcn.h>\n#include <errno.h>\n#include <config.h>\n\nstatic GSList *plugins = NULL;\n\ngboolean plugin_init(const char *enable, const char *disable)\n{\n\tGSList *list;\n\tGDir *dir;\n\tconst char *file;\n\tchar **cli_disabled, **cli_enabled;\n\tunsigned int i;\n\n\t/* Make a call to BtIO API so its symbols got resolved before the\n\t * plugins are loaded. */\n\tbt_io_error_quark();\n\n\tif (enable)\n\t\tcli_enabled = g_strsplit_set(enable, \", \", -1);\n\telse\n\t\tcli_enabled = NULL;\n\n\tif (disable)\n\t\tcli_disabled = g_strsplit_set(disable, \", \", -1);\n\telse\n\t\tcli_disabled = NULL;\n\n\tDBG(\"Loading builtin plugins\");\n\n\tfor (i = 0; __bluetooth_builtin[i]; i++) {\n\t\tif (!enable_plugin(__bluetooth_builtin[i]->name, cli_enabled,\n\t\t\t\t\t\t\t\tcli_disabled))\n\t\t\tcontinue;\n\n\t\tadd_plugin(NULL,  __bluetooth_builtin[i]);\n\t}\n\n\tif (strlen(PLUGINDIR) == 0)\n\t\tgoto start;\n\n\tDBG(\"Loading plugins %s\", PLUGINDIR);\n\n\tdir = g_dir_open(PLUGINDIR, 0, NULL);\n\tif (!dir)\n\t\tgoto start;\n\n\twhile ((file = g_dir_read_name(dir)) != NULL) {\n\t\tstruct bluetooth_plugin_desc *desc;\n\t\tvoid *handle;\n\t\tchar *filename;\n\n\t\tif (g_str_has_prefix(file, \"lib\") == TRUE ||\n\t\t\t\tg_str_has_suffix(file, \".so\") == FALSE)\n\t\t\tcontinue;\n\n\t\tfilename = g_build_filename(PLUGINDIR, file, NULL);\n\n\t\thandle = dlopen(filename, RTLD_NOW);\n\t\tif (handle == NULL) {\n\t\t\terror(\"Can't load plugin %s: %s\", filename,\n\t\t\t\t\t\t\t\tdlerror());\n\t\t\tg_free(filename);\n\t\t\tcontinue;\n\t\t}\n\n\t\tg_free(filename);\n\n\t\tdesc = dlsym(handle, \"bluetooth_plugin_desc\");\n\t\tif (desc == NULL) {\n\t\t\terror(\"Can't load plugin description: %s\", dlerror());\n\t\t\tdlclose(handle);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!enable_plugin(desc->name, cli_enabled, cli_disabled)) {\n\t\t\tdlclose(handle);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (add_plugin(handle, desc) == FALSE)\n\t\t\tdlclose(handle);\n\t}\n\n\tg_dir_close(dir);\n\nstart:\n\tfor (list = plugins; list; list = list->next) {\n\t\tstruct bluetooth_plugin *plugin = list->data;\n\t\tint err;\n\n\t\terr = plugin->desc->init();\n\t\tif (err < 0) {\n\t\t\tif (err == -ENOSYS)\n\t\t\t\twarn(\"System does not support %s plugin\",\n\t\t\t\t\t\t\tplugin->desc->name);\n\t\t\telse\n\t\t\t\terror(\"Failed to init %s plugin\",\n\t\t\t\t\t\t\tplugin->desc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tplugin->active = TRUE;\n\t}\n\n\tg_strfreev(cli_enabled);\n\tg_strfreev(cli_disabled);\n\n\treturn TRUE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "register_mps",
          "args": [
            "mps == MPS_MULTIPLE"
          ],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "register_mps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-service.c",
          "lines": "604-619",
          "snippet": "void register_mps(bool mpmd)\n{\n\tsdp_record_t *record;\n\n\trecord = mps_record(mpmd);\n\tif (!record)\n\t\treturn;\n\n\tif (add_record_to_server(BDADDR_ANY, record) < 0) {\n\t\tsdp_record_free(record);\n\t\treturn;\n\t}\n\n\tmps_handle = record->handle;\n\tmps_mpmd = mpmd;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <sys/time.h>",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static uint32_t mps_handle = 0;",
            "static bool mps_mpmd = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <sys/time.h>\n#include <assert.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic uint32_t mps_handle = 0;\nstatic bool mps_mpmd = false;\n\nvoid register_mps(bool mpmd)\n{\n\tsdp_record_t *record;\n\n\trecord = mps_record(mpmd);\n\tif (!record)\n\t\treturn;\n\n\tif (add_record_to_server(BDADDR_ANY, record) < 0) {\n\t\tsdp_record_free(record);\n\t\treturn;\n\t}\n\n\tmps_handle = record->handle;\n\tmps_mpmd = mpmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "register_device_id",
          "args": [
            "main_opts.did_source",
            "main_opts.did_vendor",
            "main_opts.did_product",
            "main_opts.did_version"
          ],
          "line": 769
        },
        "resolved": true,
        "details": {
          "function_name": "register_device_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-service.c",
          "lines": "407-463",
          "snippet": "void register_device_id(uint16_t source, uint16_t vendor,\n\t\t\t\t\tuint16_t product, uint16_t version)\n{\n\tconst uint16_t spec = 0x0103;\n\tconst uint8_t primary = 1;\n\tsdp_list_t *class_list, *group_list, *profile_list;\n\tuuid_t class_uuid, group_uuid;\n\tsdp_data_t *sdp_data, *primary_data, *source_data;\n\tsdp_data_t *spec_data, *vendor_data, *product_data, *version_data;\n\tsdp_profile_desc_t profile;\n\tsdp_record_t *record = sdp_record_alloc();\n\n\tDBG(\"Adding device id record for %04x:%04x:%04x:%04x\",\n\t\t\t\t\tsource, vendor, product, version);\n\n\trecord->handle = sdp_next_handle();\n\n\tsdp_record_add(BDADDR_ANY, record);\n\tsdp_data = sdp_data_alloc(SDP_UINT32, &record->handle);\n\tsdp_attr_add(record, SDP_ATTR_RECORD_HANDLE, sdp_data);\n\n\tsdp_uuid16_create(&class_uuid, PNP_INFO_SVCLASS_ID);\n\tclass_list = sdp_list_append(0, &class_uuid);\n\tsdp_set_service_classes(record, class_list);\n\tsdp_list_free(class_list, NULL);\n\n\tsdp_uuid16_create(&group_uuid, PUBLIC_BROWSE_GROUP);\n\tgroup_list = sdp_list_append(NULL, &group_uuid);\n\tsdp_set_browse_groups(record, group_list);\n\tsdp_list_free(group_list, NULL);\n\n\tsdp_uuid16_create(&profile.uuid, PNP_INFO_PROFILE_ID);\n\tprofile.version = spec;\n\tprofile_list = sdp_list_append(NULL, &profile);\n\tsdp_set_profile_descs(record, profile_list);\n\tsdp_list_free(profile_list, NULL);\n\n\tspec_data = sdp_data_alloc(SDP_UINT16, &spec);\n\tsdp_attr_add(record, 0x0200, spec_data);\n\n\tvendor_data = sdp_data_alloc(SDP_UINT16, &vendor);\n\tsdp_attr_add(record, 0x0201, vendor_data);\n\n\tproduct_data = sdp_data_alloc(SDP_UINT16, &product);\n\tsdp_attr_add(record, 0x0202, product_data);\n\n\tversion_data = sdp_data_alloc(SDP_UINT16, &version);\n\tsdp_attr_add(record, 0x0203, version_data);\n\n\tprimary_data = sdp_data_alloc(SDP_BOOL, &primary);\n\tsdp_attr_add(record, 0x0204, primary_data);\n\n\tsource_data = sdp_data_alloc(SDP_UINT16, &source);\n\tsdp_attr_add(record, 0x0205, source_data);\n\n\tupdate_db_timestamp();\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <sys/time.h>",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"sdpd.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <sys/time.h>\n#include <assert.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <config.h>\n\nvoid register_device_id(uint16_t source, uint16_t vendor,\n\t\t\t\t\tuint16_t product, uint16_t version)\n{\n\tconst uint16_t spec = 0x0103;\n\tconst uint8_t primary = 1;\n\tsdp_list_t *class_list, *group_list, *profile_list;\n\tuuid_t class_uuid, group_uuid;\n\tsdp_data_t *sdp_data, *primary_data, *source_data;\n\tsdp_data_t *spec_data, *vendor_data, *product_data, *version_data;\n\tsdp_profile_desc_t profile;\n\tsdp_record_t *record = sdp_record_alloc();\n\n\tDBG(\"Adding device id record for %04x:%04x:%04x:%04x\",\n\t\t\t\t\tsource, vendor, product, version);\n\n\trecord->handle = sdp_next_handle();\n\n\tsdp_record_add(BDADDR_ANY, record);\n\tsdp_data = sdp_data_alloc(SDP_UINT32, &record->handle);\n\tsdp_attr_add(record, SDP_ATTR_RECORD_HANDLE, sdp_data);\n\n\tsdp_uuid16_create(&class_uuid, PNP_INFO_SVCLASS_ID);\n\tclass_list = sdp_list_append(0, &class_uuid);\n\tsdp_set_service_classes(record, class_list);\n\tsdp_list_free(class_list, NULL);\n\n\tsdp_uuid16_create(&group_uuid, PUBLIC_BROWSE_GROUP);\n\tgroup_list = sdp_list_append(NULL, &group_uuid);\n\tsdp_set_browse_groups(record, group_list);\n\tsdp_list_free(group_list, NULL);\n\n\tsdp_uuid16_create(&profile.uuid, PNP_INFO_PROFILE_ID);\n\tprofile.version = spec;\n\tprofile_list = sdp_list_append(NULL, &profile);\n\tsdp_set_profile_descs(record, profile_list);\n\tsdp_list_free(profile_list, NULL);\n\n\tspec_data = sdp_data_alloc(SDP_UINT16, &spec);\n\tsdp_attr_add(record, 0x0200, spec_data);\n\n\tvendor_data = sdp_data_alloc(SDP_UINT16, &vendor);\n\tsdp_attr_add(record, 0x0201, vendor_data);\n\n\tproduct_data = sdp_data_alloc(SDP_UINT16, &product);\n\tsdp_attr_add(record, 0x0202, product_data);\n\n\tversion_data = sdp_data_alloc(SDP_UINT16, &version);\n\tsdp_attr_add(record, 0x0203, version_data);\n\n\tprimary_data = sdp_data_alloc(SDP_BOOL, &primary);\n\tsdp_attr_add(record, 0x0204, primary_data);\n\n\tsource_data = sdp_data_alloc(SDP_UINT16, &source);\n\tsdp_attr_add(record, 0x0205, source_data);\n\n\tupdate_db_timestamp();\n}"
        }
      },
      {
        "call_info": {
          "callee": "start_sdp_server",
          "args": [
            "sdp_mtu",
            "sdp_flags"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "start_sdp_server",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdpd-server.c",
          "lines": "230-261",
          "snippet": "int start_sdp_server(uint16_t mtu, uint32_t flags)\n{\n\tint compat = flags & SDP_SERVER_COMPAT;\n\tint master = flags & SDP_SERVER_MASTER;\n\tGIOChannel *io;\n\n\tinfo(\"Starting SDP server\");\n\n\tif (init_server(mtu, master, compat) < 0) {\n\t\terror(\"Server initialization failed\");\n\t\treturn -1;\n\t}\n\n\tio = g_io_channel_unix_new(l2cap_sock);\n\tg_io_channel_set_close_on_unref(io, TRUE);\n\n\tl2cap_id = g_io_add_watch(io, G_IO_IN | G_IO_ERR | G_IO_HUP | G_IO_NVAL,\n\t\t\t\t\tio_accept_event, &l2cap_sock);\n\tg_io_channel_unref(io);\n\n\tif (compat && unix_sock > fileno(stderr)) {\n\t\tio = g_io_channel_unix_new(unix_sock);\n\t\tg_io_channel_set_close_on_unref(io, TRUE);\n\n\t\tunix_id = g_io_add_watch(io,\n\t\t\t\t\tG_IO_IN | G_IO_ERR | G_IO_HUP | G_IO_NVAL,\n\t\t\t\t\tio_accept_event, &unix_sock);\n\t\tg_io_channel_unref(io);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"sdpd.h\"",
            "#include \"log.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/l2cap.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/un.h>",
            "#include <sys/stat.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static guint l2cap_id = 0, unix_id = 0;",
            "static int l2cap_sock = -1, unix_sock = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sdpd.h\"\n#include \"log.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/l2cap.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/un.h>\n#include <sys/stat.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <config.h>\n\nstatic guint l2cap_id = 0, unix_id = 0;\nstatic int l2cap_sock = -1, unix_sock = -1;\n\nint start_sdp_server(uint16_t mtu, uint32_t flags)\n{\n\tint compat = flags & SDP_SERVER_COMPAT;\n\tint master = flags & SDP_SERVER_MASTER;\n\tGIOChannel *io;\n\n\tinfo(\"Starting SDP server\");\n\n\tif (init_server(mtu, master, compat) < 0) {\n\t\terror(\"Server initialization failed\");\n\t\treturn -1;\n\t}\n\n\tio = g_io_channel_unix_new(l2cap_sock);\n\tg_io_channel_set_close_on_unref(io, TRUE);\n\n\tl2cap_id = g_io_add_watch(io, G_IO_IN | G_IO_ERR | G_IO_HUP | G_IO_NVAL,\n\t\t\t\t\tio_accept_event, &l2cap_sock);\n\tg_io_channel_unref(io);\n\n\tif (compat && unix_sock > fileno(stderr)) {\n\t\tio = g_io_channel_unix_new(unix_sock);\n\t\tg_io_channel_set_close_on_unref(io, TRUE);\n\n\t\tunix_id = g_io_add_watch(io,\n\t\t\t\t\tG_IO_IN | G_IO_ERR | G_IO_HUP | G_IO_NVAL,\n\t\t\t\t\tio_accept_event, &unix_sock);\n\t\tg_io_channel_unref(io);\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "btd_profile_init",
          "args": [],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "btd_profile_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/profile.c",
          "lines": "2493-2498",
          "snippet": "void btd_profile_init(void)\n{\n\tg_dbus_register_interface(btd_get_dbus_connection(),\n\t\t\t\t\"/org/bluez\", \"org.bluez.ProfileManager1\",\n\t\t\t\tmethods, NULL, NULL, NULL, NULL);\n}",
          "includes": [
            "#include \"service.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdp-xml.h\"",
            "#include \"sdp-client.h\"",
            "#include \"dbus-common.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"log.h\"",
            "#include \"sdpd.h\"",
            "#include \"btio/btio.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdbool.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const GDBusMethodTable methods[] = {\n\t{ GDBUS_METHOD(\"RegisterProfile\",\n\t\t\tGDBUS_ARGS({ \"profile\", \"o\"}, { \"UUID\", \"s\" },\n\t\t\t\t\t\t{ \"options\", \"a{sv}\" }),\n\t\t\tNULL, register_profile) },\n\t{ GDBUS_METHOD(\"UnregisterProfile\", GDBUS_ARGS({ \"profile\", \"o\" }),\n\t\t\tNULL, unregister_profile) },\n\t{ }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"service.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdp-xml.h\"\n#include \"sdp-client.h\"\n#include \"dbus-common.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"log.h\"\n#include \"sdpd.h\"\n#include \"btio/btio.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdbool.h>\n#include <config.h>\n\nstatic const GDBusMethodTable methods[] = {\n\t{ GDBUS_METHOD(\"RegisterProfile\",\n\t\t\tGDBUS_ARGS({ \"profile\", \"o\"}, { \"UUID\", \"s\" },\n\t\t\t\t\t\t{ \"options\", \"a{sv}\" }),\n\t\t\tNULL, register_profile) },\n\t{ GDBUS_METHOD(\"UnregisterProfile\", GDBUS_ARGS({ \"profile\", \"o\" }),\n\t\t\tNULL, unregister_profile) },\n\t{ }\n};\n\nvoid btd_profile_init(void)\n{\n\tg_dbus_register_interface(btd_get_dbus_connection(),\n\t\t\t\t\"/org/bluez\", \"org.bluez.ProfileManager1\",\n\t\t\t\tmethods, NULL, NULL, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btd_agent_init",
          "args": [],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "btd_agent_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/agent.c",
          "lines": "1034-1044",
          "snippet": "void btd_agent_init(void)\n{\n\tagent_list = g_hash_table_new_full(g_str_hash, g_str_equal,\n\t\t\t\t\t\tNULL, agent_destroy);\n\n\tdefault_agents = queue_new();\n\n\tg_dbus_register_interface(btd_get_dbus_connection(),\n\t\t\t\t\"/org/bluez\", \"org.bluez.AgentManager1\",\n\t\t\t\tmethods, NULL, NULL, NULL, NULL);\n}",
          "includes": [
            "#include \"shared/queue.h\"",
            "#include \"agent.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"dbus-common.h\"",
            "#include \"hcid.h\"",
            "#include \"error.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static GHashTable *agent_list;",
            "struct queue *default_agents = NULL;",
            "static const GDBusMethodTable methods[] = {\n\t{ GDBUS_METHOD(\"RegisterAgent\",\n\t\t\tGDBUS_ARGS({ \"agent\", \"o\"}, { \"capability\", \"s\" }),\n\t\t\tNULL, register_agent) },\n\t{ GDBUS_METHOD(\"UnregisterAgent\", GDBUS_ARGS({ \"agent\", \"o\" }),\n\t\t\tNULL, unregister_agent) },\n\t{ GDBUS_METHOD(\"RequestDefaultAgent\", GDBUS_ARGS({ \"agent\", \"o\" }),\n\t\t\tNULL, request_default ) },\n\t{ }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"shared/queue.h\"\n#include \"agent.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"dbus-common.h\"\n#include \"hcid.h\"\n#include \"error.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GHashTable *agent_list;\nstruct queue *default_agents = NULL;\nstatic const GDBusMethodTable methods[] = {\n\t{ GDBUS_METHOD(\"RegisterAgent\",\n\t\t\tGDBUS_ARGS({ \"agent\", \"o\"}, { \"capability\", \"s\" }),\n\t\t\tNULL, register_agent) },\n\t{ GDBUS_METHOD(\"UnregisterAgent\", GDBUS_ARGS({ \"agent\", \"o\" }),\n\t\t\tNULL, unregister_agent) },\n\t{ GDBUS_METHOD(\"RequestDefaultAgent\", GDBUS_ARGS({ \"agent\", \"o\" }),\n\t\t\tNULL, request_default ) },\n\t{ }\n};\n\nvoid btd_agent_init(void)\n{\n\tagent_list = g_hash_table_new_full(g_str_hash, g_str_equal,\n\t\t\t\t\t\tNULL, agent_destroy);\n\n\tdefault_agents = queue_new();\n\n\tg_dbus_register_interface(btd_get_dbus_connection(),\n\t\t\t\t\"/org/bluez\", \"org.bluez.AgentManager1\",\n\t\t\t\tmethods, NULL, NULL, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btd_device_init",
          "args": [],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "btd_device_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/device.c",
          "lines": "6464-6469",
          "snippet": "void btd_device_init(void)\n{\n\tdbus_conn = btd_get_dbus_connection();\n\tservice_state_cb_id = btd_service_add_state_cb(\n\t\t\t\t\t\tservice_state_changed, NULL);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"attrib-server.h\"",
            "#include \"storage.h\"",
            "#include \"textfile.h\"",
            "#include \"agent.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"sdp-client.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"service.h\"",
            "#include \"profile.h\"",
            "#include \"gatt-client.h\"",
            "#include \"device.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"gatt-database.h\"",
            "#include \"adapter.h\"",
            "#include \"hcid.h\"",
            "#include \"attrib/att.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/ad.h\"",
            "#include \"src/shared/gatt-server.h\"",
            "#include \"src/shared/gatt-client.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DBusConnection *dbus_conn = NULL;",
            "static unsigned service_state_cb_id;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"attrib-server.h\"\n#include \"storage.h\"\n#include \"textfile.h\"\n#include \"agent.h\"\n#include \"attrib/gatt.h\"\n#include \"sdp-client.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"service.h\"\n#include \"profile.h\"\n#include \"gatt-client.h\"\n#include \"device.h\"\n#include \"attrib/gattrib.h\"\n#include \"gatt-database.h\"\n#include \"adapter.h\"\n#include \"hcid.h\"\n#include \"attrib/att.h\"\n#include \"lib/mgmt.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/ad.h\"\n#include \"src/shared/gatt-server.h\"\n#include \"src/shared/gatt-client.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/util.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <time.h>\n#include <dirent.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic DBusConnection *dbus_conn = NULL;\nstatic unsigned service_state_cb_id;\n\nvoid btd_device_init(void)\n{\n\tdbus_conn = btd_get_dbus_connection();\n\tservice_state_cb_id = btd_service_add_state_cb(\n\t\t\t\t\t\tservice_state_changed, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Adapter handling initialization failed\""
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "btd_error_not_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/error.c",
          "lines": "118-122",
          "snippet": "DBusMessage *btd_error_not_ready(DBusMessage *msg)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE \".NotReady\",\n\t\t\t\t\t\"Resource Not Ready\");\n}",
          "includes": [
            "#include \"error.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"error.h\"\n#include \"gdbus/gdbus.h\"\n#include <config.h>\n\nDBusMessage *btd_error_not_ready(DBusMessage *msg)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE \".NotReady\",\n\t\t\t\t\t\"Resource Not Ready\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "adapter_init",
          "args": [],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "adapter_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/adapter.c",
          "lines": "9034-9057",
          "snippet": "int adapter_init(void)\n{\n\tdbus_conn = btd_get_dbus_connection();\n\n\tmgmt_master = mgmt_new_default();\n\tif (!mgmt_master) {\n\t\terror(\"Failed to access management interface\");\n\t\treturn -EIO;\n\t}\n\n\tif (getenv(\"MGMT_DEBUG\"))\n\t\tmgmt_set_debug(mgmt_master, mgmt_debug, \"mgmt: \", NULL);\n\n\tDBG(\"sending read version command\");\n\n\tif (mgmt_send(mgmt_master, MGMT_OP_READ_VERSION,\n\t\t\t\tMGMT_INDEX_NONE, 0, NULL,\n\t\t\t\tread_version_complete, NULL, NULL) > 0)\n\t\treturn 0;\n\n\terror(\"Failed to read management version information\");\n\n\treturn -EIO;\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"advertising.h\"",
            "#include \"gatt-database.h\"",
            "#include \"attrib-server.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"storage.h\"",
            "#include \"agent.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/mgmt.h\"",
            "#include \"textfile.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"bluetooth/sdp_lib.h\"",
            "#include \"bluetooth/sdp.h\"",
            "#include \"bluetooth/hci_lib.h\"",
            "#include \"bluetooth/hci.h\"",
            "#include \"bluetooth/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <sys/ioctl.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <inttypes.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DBusConnection *dbus_conn = NULL;",
            "static struct mgmt *mgmt_master = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"advertising.h\"\n#include \"gatt-database.h\"\n#include \"attrib-server.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"storage.h\"\n#include \"agent.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/mgmt.h\"\n#include \"textfile.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/mgmt.h\"\n#include \"lib/uuid.h\"\n#include \"bluetooth/sdp_lib.h\"\n#include \"bluetooth/sdp.h\"\n#include \"bluetooth/hci_lib.h\"\n#include \"bluetooth/hci.h\"\n#include \"bluetooth/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <sys/ioctl.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <inttypes.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic DBusConnection *dbus_conn = NULL;\nstatic struct mgmt *mgmt_master = NULL;\n\nint adapter_init(void)\n{\n\tdbus_conn = btd_get_dbus_connection();\n\n\tmgmt_master = mgmt_new_default();\n\tif (!mgmt_master) {\n\t\terror(\"Failed to access management interface\");\n\t\treturn -EIO;\n\t}\n\n\tif (getenv(\"MGMT_DEBUG\"))\n\t\tmgmt_set_debug(mgmt_master, mgmt_debug, \"mgmt: \", NULL);\n\n\tDBG(\"sending read version command\");\n\n\tif (mgmt_send(mgmt_master, MGMT_OP_READ_VERSION,\n\t\t\t\tMGMT_INDEX_NONE, 0, NULL,\n\t\t\t\tread_version_complete, NULL, NULL) > 0)\n\t\treturn 0;\n\n\terror(\"Failed to read management version information\");\n\n\treturn -EIO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_dbus_set_flags",
          "args": [
            "gdbus_flags"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect_dbus",
          "args": [],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "connect_dbus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "622-645",
          "snippet": "static int connect_dbus(void)\n{\n\tDBusConnection *conn;\n\tDBusError err;\n\n\tdbus_error_init(&err);\n\n\tconn = g_dbus_setup_bus(DBUS_BUS_SYSTEM, BLUEZ_NAME, &err);\n\tif (!conn) {\n\t\tif (dbus_error_is_set(&err)) {\n\t\t\tg_printerr(\"D-Bus setup failed: %s\\n\", err.message);\n\t\t\tdbus_error_free(&err);\n\t\t\treturn -EIO;\n\t\t}\n\t\treturn -EALREADY;\n\t}\n\n\tset_dbus_connection(conn);\n\n\tg_dbus_set_disconnect_function(conn, disconnected_dbus, NULL, NULL);\n\tg_dbus_attach_object_manager(conn);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define BLUEZ_NAME \"org.bluez\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\n#define BLUEZ_NAME \"org.bluez\"\n\nstatic int connect_dbus(void)\n{\n\tDBusConnection *conn;\n\tDBusError err;\n\n\tdbus_error_init(&err);\n\n\tconn = g_dbus_setup_bus(DBUS_BUS_SYSTEM, BLUEZ_NAME, &err);\n\tif (!conn) {\n\t\tif (dbus_error_is_set(&err)) {\n\t\t\tg_printerr(\"D-Bus setup failed: %s\\n\", err.message);\n\t\t\tdbus_error_free(&err);\n\t\t\treturn -EIO;\n\t\t}\n\t\treturn -EALREADY;\n\t}\n\n\tset_dbus_connection(conn);\n\n\tg_dbus_set_disconnect_function(conn, disconnected_dbus, NULL, NULL);\n\tg_dbus_attach_object_manager(conn);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "parse_config",
          "args": [
            "main_conf"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "parse_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "269-446",
          "snippet": "static void parse_config(GKeyFile *config)\n{\n\tGError *err = NULL;\n\tchar *str;\n\tint val;\n\tgboolean boolean;\n\n\tif (!config)\n\t\treturn;\n\n\tcheck_config(config);\n\n\tDBG(\"parsing %s\", main_conf_file_path);\n\n\tval = g_key_file_get_integer(config, \"General\",\n\t\t\t\t\t\t\"DiscoverableTimeout\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"discovto=%d\", val);\n\t\tmain_opts.discovto = val;\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"AlwaysPairable\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"pairable=%s\", boolean ? \"true\" : \"false\");\n\t\tmain_opts.pairable = boolean;\n\t}\n\n\tval = g_key_file_get_integer(config, \"General\",\n\t\t\t\t\t\t\"PairableTimeout\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"pairto=%d\", val);\n\t\tmain_opts.pairto = val;\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Privacy\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t\tmain_opts.privacy = 0x00;\n\t} else {\n\t\tDBG(\"privacy=%s\", str);\n\n\t\tif (!strcmp(str, \"device\"))\n\t\t\tmain_opts.privacy = 0x01;\n\t\telse if (!strcmp(str, \"off\"))\n\t\t\tmain_opts.privacy = 0x00;\n\t\telse {\n\t\t\tDBG(\"Invalid privacy option: %s\", str);\n\t\t\tmain_opts.privacy = 0x00;\n\t\t}\n\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Name\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"name=%s\", str);\n\t\tg_free(main_opts.name);\n\t\tmain_opts.name = str;\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Class\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"class=%s\", str);\n\t\tmain_opts.class = strtol(str, NULL, 16);\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"DeviceID\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"deviceid=%s\", str);\n\t\tparse_did(str);\n\t\tg_free(str);\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"ReverseServiceDiscovery\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else\n\t\tmain_opts.reverse_sdp = boolean;\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"NameResolving\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.name_resolv = boolean;\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"DebugKeys\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.debug_keys = boolean;\n\n\tstr = g_key_file_get_string(config, \"General\", \"ControllerMode\", &err);\n\tif (err) {\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"ControllerMode=%s\", str);\n\t\tmain_opts.mode = get_mode(str);\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"MultiProfile\", &err);\n\tif (err) {\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"MultiProfile=%s\", str);\n\n\t\tif (!strcmp(str, \"single\"))\n\t\t\tmps = MPS_SINGLE;\n\t\telse if (!strcmp(str, \"multiple\"))\n\t\t\tmps = MPS_MULTIPLE;\n\n\t\tg_free(str);\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"FastConnectable\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.fast_conn = boolean;\n\n\tstr = g_key_file_get_string(config, \"GATT\", \"Cache\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tmain_opts.gatt_cache = parse_gatt_cache(str);\n\t\tg_free(str);\n\t}\n\n\tval = g_key_file_get_integer(config, \"GATT\", \"KeySize\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"KeySize=%d\", val);\n\n\t\tif (val >=7 && val <= 16)\n\t\t\tmain_opts.key_size = val;\n\t}\n\n\tval = g_key_file_get_integer(config, \"GATT\", \"ExchangeMTU\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\t/* Ensure the mtu is within a valid range. */\n\t\tval = MIN(val, BT_ATT_MAX_LE_MTU);\n\t\tval = MAX(val, BT_ATT_DEFAULT_LE_MTU);\n\t\tDBG(\"ExchangeMTU=%d\", val);\n\t\tmain_opts.gatt_mtu = val;\n\t}\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct main_opts main_opts;",
            "static char *main_conf_file_path;",
            "static enum {\n\tMPS_OFF,\n\tMPS_SINGLE,\n\tMPS_MULTIPLE,\n} mps = MPS_OFF;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstruct main_opts main_opts;\nstatic char *main_conf_file_path;\nstatic enum {\n\tMPS_OFF,\n\tMPS_SINGLE,\n\tMPS_MULTIPLE,\n} mps = MPS_OFF;\n\nstatic void parse_config(GKeyFile *config)\n{\n\tGError *err = NULL;\n\tchar *str;\n\tint val;\n\tgboolean boolean;\n\n\tif (!config)\n\t\treturn;\n\n\tcheck_config(config);\n\n\tDBG(\"parsing %s\", main_conf_file_path);\n\n\tval = g_key_file_get_integer(config, \"General\",\n\t\t\t\t\t\t\"DiscoverableTimeout\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"discovto=%d\", val);\n\t\tmain_opts.discovto = val;\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"AlwaysPairable\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"pairable=%s\", boolean ? \"true\" : \"false\");\n\t\tmain_opts.pairable = boolean;\n\t}\n\n\tval = g_key_file_get_integer(config, \"General\",\n\t\t\t\t\t\t\"PairableTimeout\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"pairto=%d\", val);\n\t\tmain_opts.pairto = val;\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Privacy\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t\tmain_opts.privacy = 0x00;\n\t} else {\n\t\tDBG(\"privacy=%s\", str);\n\n\t\tif (!strcmp(str, \"device\"))\n\t\t\tmain_opts.privacy = 0x01;\n\t\telse if (!strcmp(str, \"off\"))\n\t\t\tmain_opts.privacy = 0x00;\n\t\telse {\n\t\t\tDBG(\"Invalid privacy option: %s\", str);\n\t\t\tmain_opts.privacy = 0x00;\n\t\t}\n\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Name\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"name=%s\", str);\n\t\tg_free(main_opts.name);\n\t\tmain_opts.name = str;\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Class\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"class=%s\", str);\n\t\tmain_opts.class = strtol(str, NULL, 16);\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"DeviceID\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"deviceid=%s\", str);\n\t\tparse_did(str);\n\t\tg_free(str);\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"ReverseServiceDiscovery\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else\n\t\tmain_opts.reverse_sdp = boolean;\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"NameResolving\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.name_resolv = boolean;\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"DebugKeys\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.debug_keys = boolean;\n\n\tstr = g_key_file_get_string(config, \"General\", \"ControllerMode\", &err);\n\tif (err) {\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"ControllerMode=%s\", str);\n\t\tmain_opts.mode = get_mode(str);\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"MultiProfile\", &err);\n\tif (err) {\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"MultiProfile=%s\", str);\n\n\t\tif (!strcmp(str, \"single\"))\n\t\t\tmps = MPS_SINGLE;\n\t\telse if (!strcmp(str, \"multiple\"))\n\t\t\tmps = MPS_MULTIPLE;\n\n\t\tg_free(str);\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"FastConnectable\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.fast_conn = boolean;\n\n\tstr = g_key_file_get_string(config, \"GATT\", \"Cache\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tmain_opts.gatt_cache = parse_gatt_cache(str);\n\t\tg_free(str);\n\t}\n\n\tval = g_key_file_get_integer(config, \"GATT\", \"KeySize\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"KeySize=%d\", val);\n\n\t\tif (val >=7 && val <= 16)\n\t\t\tmain_opts.key_size = val;\n\t}\n\n\tval = g_key_file_get_integer(config, \"GATT\", \"ExchangeMTU\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\t/* Ensure the mtu is within a valid range. */\n\t\tval = MIN(val, BT_ATT_MAX_LE_MTU);\n\t\tval = MAX(val, BT_ATT_DEFAULT_LE_MTU);\n\t\tDBG(\"ExchangeMTU=%d\", val);\n\t\tmain_opts.gatt_mtu = val;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "load_config",
          "args": [
            "main_conf_file_path"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "load_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "129-147",
          "snippet": "static GKeyFile *load_config(const char *file)\n{\n\tGError *err = NULL;\n\tGKeyFile *keyfile;\n\n\tkeyfile = g_key_file_new();\n\n\tg_key_file_set_list_separator(keyfile, ',');\n\n\tif (!g_key_file_load_from_file(keyfile, file, 0, &err)) {\n\t\tif (!g_error_matches(err, G_FILE_ERROR, G_FILE_ERROR_NOENT))\n\t\t\terror(\"Parsing %s failed: %s\", file, err->message);\n\t\tg_error_free(err);\n\t\tg_key_file_free(keyfile);\n\t\treturn NULL;\n\t}\n\n\treturn keyfile;\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic GKeyFile *load_config(const char *file)\n{\n\tGError *err = NULL;\n\tGKeyFile *keyfile;\n\n\tkeyfile = g_key_file_new();\n\n\tg_key_file_set_list_separator(keyfile, ',');\n\n\tif (!g_key_file_load_from_file(keyfile, file, 0, &err)) {\n\t\tif (!g_error_matches(err, G_FILE_ERROR, G_FILE_ERROR_NOENT))\n\t\t\terror(\"Parsing %s failed: %s\", file, err->message);\n\t\tg_error_free(err);\n\t\tg_key_file_free(keyfile);\n\t\treturn NULL;\n\t}\n\n\treturn keyfile;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_log_set_handler",
          "args": [
            "\"GLib\"",
            "G_LOG_LEVEL_MASK | G_LOG_FLAG_FATAL |\n\t\t\t\t\t\t\tG_LOG_FLAG_RECURSION",
            "log_handler",
            "NULL"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__btd_log_init",
          "args": [
            "option_debug",
            "option_detach"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "__btd_log_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "305-322",
          "snippet": "void __btd_log_init(const char *debug, int detach)\n{\n\tint option = LOG_NDELAY | LOG_PID;\n\n\tif (debug != NULL)\n\t\tenabled = g_strsplit_set(debug, \":, \", 0);\n\n\t__btd_enable_debug(__start___debug, __stop___debug);\n\n\tlogging_open();\n\n\tif (!detach)\n\t\toption |= LOG_PERROR;\n\n\topenlog(LOG_IDENT, option, LOG_DAEMON);\n\n\tinfo(\"Bluetooth daemon %s\", VERSION);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LOG_IDENT \"bluetoothd\""
          ],
          "globals_used": [
            "extern struct btd_debug_desc __start___debug[];",
            "extern struct btd_debug_desc __stop___debug[];",
            "static char **enabled = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define LOG_IDENT \"bluetoothd\"\n\nextern struct btd_debug_desc __start___debug[];\nextern struct btd_debug_desc __stop___debug[];\nstatic char **enabled = NULL;\n\nvoid __btd_log_init(const char *debug, int detach)\n{\n\tint option = LOG_NDELAY | LOG_PID;\n\n\tif (debug != NULL)\n\t\tenabled = g_strsplit_set(debug, \":, \", 0);\n\n\t__btd_enable_debug(__start___debug, __stop___debug);\n\n\tlogging_open();\n\n\tif (!detach)\n\t\toption |= LOG_PERROR;\n\n\topenlog(LOG_IDENT, option, LOG_DAEMON);\n\n\tinfo(\"Bluetooth daemon %s\", VERSION);\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup_signalfd",
          "args": [],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "setup_signalfd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "541-577",
          "snippet": "static guint setup_signalfd(void)\n{\n\tGIOChannel *channel;\n\tguint source;\n\tsigset_t mask;\n\tint fd;\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGTERM);\n\tsigaddset(&mask, SIGUSR2);\n\n\tif (sigprocmask(SIG_BLOCK, &mask, NULL) < 0) {\n\t\tperror(\"Failed to set signal mask\");\n\t\treturn 0;\n\t}\n\n\tfd = signalfd(-1, &mask, 0);\n\tif (fd < 0) {\n\t\tperror(\"Failed to create signal descriptor\");\n\t\treturn 0;\n\t}\n\n\tchannel = g_io_channel_unix_new(fd);\n\n\tg_io_channel_set_close_on_unref(channel, TRUE);\n\tg_io_channel_set_encoding(channel, NULL, NULL);\n\tg_io_channel_set_buffered(channel, FALSE);\n\n\tsource = g_io_add_watch(channel,\n\t\t\t\tG_IO_IN | G_IO_HUP | G_IO_ERR | G_IO_NVAL,\n\t\t\t\tsignal_handler, NULL);\n\n\tg_io_channel_unref(channel);\n\n\treturn source;\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic guint setup_signalfd(void)\n{\n\tGIOChannel *channel;\n\tguint source;\n\tsigset_t mask;\n\tint fd;\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGTERM);\n\tsigaddset(&mask, SIGUSR2);\n\n\tif (sigprocmask(SIG_BLOCK, &mask, NULL) < 0) {\n\t\tperror(\"Failed to set signal mask\");\n\t\treturn 0;\n\t}\n\n\tfd = signalfd(-1, &mask, 0);\n\tif (fd < 0) {\n\t\tperror(\"Failed to create signal descriptor\");\n\t\treturn 0;\n\t}\n\n\tchannel = g_io_channel_unix_new(fd);\n\n\tg_io_channel_set_close_on_unref(channel, TRUE);\n\tg_io_channel_set_encoding(channel, NULL, NULL);\n\tg_io_channel_set_buffered(channel, FALSE);\n\n\tsource = g_io_add_watch(channel,\n\t\t\t\tG_IO_IN | G_IO_HUP | G_IO_ERR | G_IO_NVAL,\n\t\t\t\tsignal_handler, NULL);\n\n\tg_io_channel_unref(channel);\n\n\treturn source;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_main_loop_new",
          "args": [
            "NULL",
            "FALSE"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btd_backtrace_init",
          "args": [],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "btd_backtrace_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/backtrace.c",
          "lines": "39-50",
          "snippet": "void btd_backtrace_init(void)\n{\n#ifdef HAVE_BACKTRACE_SUPPORT\n\tvoid *frames[1];\n\n\t/*\n\t * initialize the backtracer, since the ctor calls dlopen(), which\n\t * calls malloc(), which isn't signal-safe.\n\t */\n\tbacktrace(frames, 1);\n#endif\n}",
          "includes": [
            "#include \"src/backtrace.h\"",
            "#include \"src/log.h\"",
            "#include <elfutils/libdwfl.h>",
            "#include <execinfo.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/backtrace.h\"\n#include \"src/log.h\"\n#include <elfutils/libdwfl.h>\n#include <execinfo.h>\n#include <inttypes.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid btd_backtrace_init(void)\n{\n#ifdef HAVE_BACKTRACE_SUPPORT\n\tvoid *frames[1];\n\n\t/*\n\t * initialize the backtracer, since the ctor calls dlopen(), which\n\t * calls malloc(), which isn't signal-safe.\n\t */\n\tbacktrace(frames, 1);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "umask",
          "args": [
            "0077"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "0"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "VERSION"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "ringbuf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ringbuf.c",
          "lines": "208-218",
          "snippet": "int ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}",
          "includes": [
            "#include \"src/shared/ringbuf.h\"",
            "#include \"src/shared/util.h\"",
            "#include <sys/param.h>",
            "#include <sys/uio.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/ringbuf.h\"\n#include \"src/shared/util.h\"\n#include <sys/param.h>\n#include <sys/uio.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nint ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_option_context_free",
          "args": [
            "context"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_printerr",
          "args": [
            "\"An unknown error occurred\\n\""
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_error_free",
          "args": [
            "err"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_printerr",
          "args": [
            "\"%s\\n\"",
            "err->message"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_option_context_parse",
          "args": [
            "context",
            "&argc",
            "&argv",
            "&err"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_option_context_add_main_entries",
          "args": [
            "context",
            "options",
            "NULL"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_option_context_new",
          "args": [
            "NULL"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_defaults",
          "args": [],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "init_defaults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "448-472",
          "snippet": "static void init_defaults(void)\n{\n\tuint8_t major, minor;\n\n\t/* Default HCId settings */\n\tmemset(&main_opts, 0, sizeof(main_opts));\n\tmain_opts.name = g_strdup_printf(\"BlueZ %s\", VERSION);\n\tmain_opts.class = 0x000000;\n\tmain_opts.pairto = DEFAULT_PAIRABLE_TIMEOUT;\n\tmain_opts.discovto = DEFAULT_DISCOVERABLE_TIMEOUT;\n\tmain_opts.reverse_sdp = TRUE;\n\tmain_opts.name_resolv = TRUE;\n\tmain_opts.debug_keys = FALSE;\n\n\tif (sscanf(VERSION, \"%hhu.%hhu\", &major, &minor) != 2)\n\t\treturn;\n\n\tmain_opts.did_source = 0x0002;\t\t/* USB */\n\tmain_opts.did_vendor = 0x1d6b;\t\t/* Linux Foundation */\n\tmain_opts.did_product = 0x0246;\t\t/* BlueZ */\n\tmain_opts.did_version = (major << 8 | minor);\n\n\tmain_opts.gatt_cache = BT_GATT_CACHE_ALWAYS;\n\tmain_opts.gatt_mtu = BT_ATT_MAX_LE_MTU;\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define DEFAULT_DISCOVERABLE_TIMEOUT 180 /* 3 minutes */",
            "#define DEFAULT_PAIRABLE_TIMEOUT       0 /* disabled */"
          ],
          "globals_used": [
            "struct main_opts main_opts;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\n#define DEFAULT_DISCOVERABLE_TIMEOUT 180 /* 3 minutes */\n#define DEFAULT_PAIRABLE_TIMEOUT       0 /* disabled */\n\nstruct main_opts main_opts;\n\nstatic void init_defaults(void)\n{\n\tuint8_t major, minor;\n\n\t/* Default HCId settings */\n\tmemset(&main_opts, 0, sizeof(main_opts));\n\tmain_opts.name = g_strdup_printf(\"BlueZ %s\", VERSION);\n\tmain_opts.class = 0x000000;\n\tmain_opts.pairto = DEFAULT_PAIRABLE_TIMEOUT;\n\tmain_opts.discovto = DEFAULT_DISCOVERABLE_TIMEOUT;\n\tmain_opts.reverse_sdp = TRUE;\n\tmain_opts.name_resolv = TRUE;\n\tmain_opts.debug_keys = FALSE;\n\n\tif (sscanf(VERSION, \"%hhu.%hhu\", &major, &minor) != 2)\n\t\treturn;\n\n\tmain_opts.did_source = 0x0002;\t\t/* USB */\n\tmain_opts.did_vendor = 0x1d6b;\t\t/* Linux Foundation */\n\tmain_opts.did_product = 0x0246;\t\t/* BlueZ */\n\tmain_opts.did_version = (major << 8 | minor);\n\n\tmain_opts.gatt_cache = BT_GATT_CACHE_ALWAYS;\n\tmain_opts.gatt_mtu = BT_ATT_MAX_LE_MTU;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstruct main_opts main_opts;\nstatic GKeyFile *main_conf;\nstatic char *main_conf_file_path;\nstatic enum {\n\tMPS_OFF,\n\tMPS_SINGLE,\n\tMPS_MULTIPLE,\n} mps = MPS_OFF;\nstatic GMainLoop *event_loop;\nstatic char *option_debug = NULL;\nstatic char *option_plugin = NULL;\nstatic char *option_noplugin = NULL;\nstatic char *option_configfile = NULL;\nstatic gboolean option_compat = FALSE;\nstatic gboolean option_detach = TRUE;\nstatic gboolean option_version = FALSE;\nstatic gboolean option_experimental = FALSE;\nstatic GOptionEntry options[] = {\n\t{ \"debug\", 'd', G_OPTION_FLAG_OPTIONAL_ARG,\n\t\t\t\tG_OPTION_ARG_CALLBACK, parse_debug,\n\t\t\t\t\"Specify debug options to enable\", \"DEBUG\" },\n\t{ \"plugin\", 'p', 0, G_OPTION_ARG_STRING, &option_plugin,\n\t\t\t\t\"Specify plugins to load\", \"NAME,..,\" },\n\t{ \"noplugin\", 'P', 0, G_OPTION_ARG_STRING, &option_noplugin,\n\t\t\t\t\"Specify plugins not to load\", \"NAME,...\" },\n\t{ \"configfile\", 'f', 0, G_OPTION_ARG_STRING, &option_configfile,\n\t\t\t\"Specify an explicit path to the config file\", \"FILE\"},\n\t{ \"compat\", 'C', 0, G_OPTION_ARG_NONE, &option_compat,\n\t\t\t\t\"Provide deprecated command line interfaces\" },\n\t{ \"experimental\", 'E', 0, G_OPTION_ARG_NONE, &option_experimental,\n\t\t\t\t\"Enable experimental interfaces\" },\n\t{ \"nodetach\", 'n', G_OPTION_FLAG_REVERSE,\n\t\t\t\tG_OPTION_ARG_NONE, &option_detach,\n\t\t\t\t\"Run with logging in foreground\" },\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ NULL },\n};\n\nint main(int argc, char *argv[])\n{\n\tGOptionContext *context;\n\tGError *err = NULL;\n\tuint16_t sdp_mtu = 0;\n\tuint32_t sdp_flags = 0;\n\tint gdbus_flags = 0;\n\tguint signal, watchdog;\n\tconst char *watchdog_usec;\n\n\tinit_defaults();\n\n\tcontext = g_option_context_new(NULL);\n\tg_option_context_add_main_entries(context, options, NULL);\n\n\tif (g_option_context_parse(context, &argc, &argv, &err) == FALSE) {\n\t\tif (err != NULL) {\n\t\t\tg_printerr(\"%s\\n\", err->message);\n\t\t\tg_error_free(err);\n\t\t} else\n\t\t\tg_printerr(\"An unknown error occurred\\n\");\n\t\texit(1);\n\t}\n\n\tg_option_context_free(context);\n\n\tif (option_version == TRUE) {\n\t\tprintf(\"%s\\n\", VERSION);\n\t\texit(0);\n\t}\n\n\tumask(0077);\n\n\tbtd_backtrace_init();\n\n\tevent_loop = g_main_loop_new(NULL, FALSE);\n\n\tsignal = setup_signalfd();\n\n\t__btd_log_init(option_debug, option_detach);\n\n\tg_log_set_handler(\"GLib\", G_LOG_LEVEL_MASK | G_LOG_FLAG_FATAL |\n\t\t\t\t\t\t\tG_LOG_FLAG_RECURSION,\n\t\t\t\t\t\t\tlog_handler, NULL);\n\n\tsd_notify(0, \"STATUS=Starting up\");\n\n\tif (option_configfile)\n\t\tmain_conf_file_path = option_configfile;\n\telse\n\t\tmain_conf_file_path = CONFIGDIR \"/main.conf\";\n\n\tmain_conf = load_config(main_conf_file_path);\n\n\tparse_config(main_conf);\n\n\tif (connect_dbus() < 0) {\n\t\terror(\"Unable to get on D-Bus\");\n\t\texit(1);\n\t}\n\n\tif (option_experimental)\n\t\tgdbus_flags = G_DBUS_FLAG_ENABLE_EXPERIMENTAL;\n\n\tg_dbus_set_flags(gdbus_flags);\n\n\tif (adapter_init() < 0) {\n\t\terror(\"Adapter handling initialization failed\");\n\t\texit(1);\n\t}\n\n\tbtd_device_init();\n\tbtd_agent_init();\n\tbtd_profile_init();\n\n\tif (main_opts.mode != BT_MODE_LE) {\n\t\tif (option_compat == TRUE)\n\t\t\tsdp_flags |= SDP_SERVER_COMPAT;\n\n\t\tstart_sdp_server(sdp_mtu, sdp_flags);\n\n\t\tif (main_opts.did_source > 0)\n\t\t\tregister_device_id(main_opts.did_source,\n\t\t\t\t\t\tmain_opts.did_vendor,\n\t\t\t\t\t\tmain_opts.did_product,\n\t\t\t\t\t\tmain_opts.did_version);\n\t}\n\n\tif (mps != MPS_OFF)\n\t\tregister_mps(mps == MPS_MULTIPLE);\n\n\t/* Loading plugins has to be done after D-Bus has been setup since\n\t * the plugins might wanna expose some paths on the bus. However the\n\t * best order of how to init various subsystems of the Bluetooth\n\t * daemon needs to be re-worked. */\n\tplugin_init(option_plugin, option_noplugin);\n\n\t/* no need to keep parsed option in memory */\n\tfree_options();\n\n\trfkill_init();\n\n\tDBG(\"Entering main loop\");\n\n\tsd_notify(0, \"STATUS=Running\");\n\tsd_notify(0, \"READY=1\");\n\n\twatchdog_usec = getenv(\"WATCHDOG_USEC\");\n\tif (watchdog_usec) {\n\t\tunsigned int seconds;\n\n\t\tseconds = atoi(watchdog_usec) / (1000 * 1000);\n\t\tinfo(\"Watchdog timeout is %d seconds\", seconds);\n\n\t\twatchdog = g_timeout_add_seconds_full(G_PRIORITY_HIGH,\n\t\t\t\t\t\t\tseconds / 2,\n\t\t\t\t\t\t\twatchdog_callback,\n\t\t\t\t\t\t\tNULL, NULL);\n\t} else\n\t\twatchdog = 0;\n\n\tg_main_loop_run(event_loop);\n\n\tsd_notify(0, \"STATUS=Quitting\");\n\n\tg_source_remove(signal);\n\n\tplugin_cleanup();\n\n\tbtd_profile_cleanup();\n\tbtd_agent_cleanup();\n\tbtd_device_cleanup();\n\n\tadapter_cleanup();\n\n\trfkill_exit();\n\n\tif (main_opts.mode != BT_MODE_LE)\n\t\tstop_sdp_server();\n\n\tg_main_loop_unref(event_loop);\n\n\tif (main_conf)\n\t\tg_key_file_free(main_conf);\n\n\tdisconnect_dbus();\n\n\tinfo(\"Exit\");\n\n\tif (watchdog > 0)\n\t\tg_source_remove(watchdog);\n\n\t__btd_log_cleanup();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "parse_debug",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "654-663",
    "snippet": "static gboolean parse_debug(const char *key, const char *value,\n\t\t\t\tgpointer user_data, GError **error)\n{\n\tif (value)\n\t\toption_debug = g_strdup(value);\n\telse\n\t\toption_debug = g_strdup(\"*\");\n\n\treturn TRUE;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *option_debug = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"*\""
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "value"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic char *option_debug = NULL;\n\nstatic gboolean parse_debug(const char *key, const char *value,\n\t\t\t\tgpointer user_data, GError **error)\n{\n\tif (value)\n\t\toption_debug = g_strdup(value);\n\telse\n\t\toption_debug = g_strdup(\"*\");\n\n\treturn TRUE;\n}"
  },
  {
    "function_name": "watchdog_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "647-652",
    "snippet": "static gboolean watchdog_callback(gpointer user_data)\n{\n\tsd_notify(0, \"WATCHDOG=1\");\n\n\treturn TRUE;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sd_notify",
          "args": [
            "0",
            "\"WATCHDOG=1\""
          ],
          "line": 649
        },
        "resolved": true,
        "details": {
          "function_name": "sd_notify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/systemd.c",
          "lines": "44-107",
          "snippet": "int sd_notify(int unset_environment, const char *state)\n{\n\tconst char *sock;\n\tstruct sockaddr_un addr;\n\tstruct msghdr msghdr;\n\tstruct iovec iovec;\n\tint fd, err;\n\n\tif (!state) {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tsock = getenv(\"NOTIFY_SOCKET\");\n\tif (!sock)\n\t\treturn 0;\n\n\t/* check for abstract socket or absolute path */\n\tif (sock[0] != '@' && sock[0] != '/') {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tfd = socket(AF_UNIX, SOCK_DGRAM | SOCK_CLOEXEC, 0);\n\tif (fd < 0) {\n\t\terr = -errno;\n\t\tgoto done;\n\t}\n\n\tmemset(&addr, 0, sizeof(addr));\n\taddr.sun_family = AF_UNIX;\n\tstrncpy(addr.sun_path, sock, sizeof(addr.sun_path) - 1);\n\n\tif (addr.sun_path[0] == '@')\n\t\taddr.sun_path[0] = '\\0';\n\n\tmemset(&iovec, 0, sizeof(iovec));\n\tiovec.iov_base = (char *) state;\n\tiovec.iov_len = strlen(state);\n\n\tmemset(&msghdr, 0, sizeof(msghdr));\n\tmsghdr.msg_name = &addr;\n\tmsghdr.msg_namelen = offsetof(struct sockaddr_un, sun_path) +\n\t\t\t\t\t\t\t\tstrlen(sock);\n\n\tif (msghdr.msg_namelen > sizeof(struct sockaddr_un))\n\t\tmsghdr.msg_namelen = sizeof(struct sockaddr_un);\n\n\tmsghdr.msg_iov = &iovec;\n\tmsghdr.msg_iovlen = 1;\n\n\tif (sendmsg(fd, &msghdr, MSG_NOSIGNAL) < 0)\n\t\terr = -errno;\n\telse\n\t\terr = 1;\n\n\tclose(fd);\n\ndone:\n\tif (unset_environment)\n\t\tunsetenv(\"NOTIFY_SOCKET\");\n\n\treturn err;\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <stddef.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nint sd_notify(int unset_environment, const char *state)\n{\n\tconst char *sock;\n\tstruct sockaddr_un addr;\n\tstruct msghdr msghdr;\n\tstruct iovec iovec;\n\tint fd, err;\n\n\tif (!state) {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tsock = getenv(\"NOTIFY_SOCKET\");\n\tif (!sock)\n\t\treturn 0;\n\n\t/* check for abstract socket or absolute path */\n\tif (sock[0] != '@' && sock[0] != '/') {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tfd = socket(AF_UNIX, SOCK_DGRAM | SOCK_CLOEXEC, 0);\n\tif (fd < 0) {\n\t\terr = -errno;\n\t\tgoto done;\n\t}\n\n\tmemset(&addr, 0, sizeof(addr));\n\taddr.sun_family = AF_UNIX;\n\tstrncpy(addr.sun_path, sock, sizeof(addr.sun_path) - 1);\n\n\tif (addr.sun_path[0] == '@')\n\t\taddr.sun_path[0] = '\\0';\n\n\tmemset(&iovec, 0, sizeof(iovec));\n\tiovec.iov_base = (char *) state;\n\tiovec.iov_len = strlen(state);\n\n\tmemset(&msghdr, 0, sizeof(msghdr));\n\tmsghdr.msg_name = &addr;\n\tmsghdr.msg_namelen = offsetof(struct sockaddr_un, sun_path) +\n\t\t\t\t\t\t\t\tstrlen(sock);\n\n\tif (msghdr.msg_namelen > sizeof(struct sockaddr_un))\n\t\tmsghdr.msg_namelen = sizeof(struct sockaddr_un);\n\n\tmsghdr.msg_iov = &iovec;\n\tmsghdr.msg_iovlen = 1;\n\n\tif (sendmsg(fd, &msghdr, MSG_NOSIGNAL) < 0)\n\t\terr = -errno;\n\telse\n\t\terr = 1;\n\n\tclose(fd);\n\ndone:\n\tif (unset_environment)\n\t\tunsetenv(\"NOTIFY_SOCKET\");\n\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic gboolean watchdog_callback(gpointer user_data)\n{\n\tsd_notify(0, \"WATCHDOG=1\");\n\n\treturn TRUE;\n}"
  },
  {
    "function_name": "connect_dbus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "622-645",
    "snippet": "static int connect_dbus(void)\n{\n\tDBusConnection *conn;\n\tDBusError err;\n\n\tdbus_error_init(&err);\n\n\tconn = g_dbus_setup_bus(DBUS_BUS_SYSTEM, BLUEZ_NAME, &err);\n\tif (!conn) {\n\t\tif (dbus_error_is_set(&err)) {\n\t\t\tg_printerr(\"D-Bus setup failed: %s\\n\", err.message);\n\t\t\tdbus_error_free(&err);\n\t\t\treturn -EIO;\n\t\t}\n\t\treturn -EALREADY;\n\t}\n\n\tset_dbus_connection(conn);\n\n\tg_dbus_set_disconnect_function(conn, disconnected_dbus, NULL, NULL);\n\tg_dbus_attach_object_manager(conn);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define BLUEZ_NAME \"org.bluez\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_dbus_attach_object_manager",
          "args": [
            "conn"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_dbus_set_disconnect_function",
          "args": [
            "conn",
            "disconnected_dbus",
            "NULL",
            "NULL"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dbus_connection",
          "args": [
            "conn"
          ],
          "line": 639
        },
        "resolved": true,
        "details": {
          "function_name": "set_dbus_connection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/dbus-common.c",
          "lines": "56-59",
          "snippet": "void set_dbus_connection(DBusConnection *conn)\n{\n\tconnection = conn;\n}",
          "includes": [
            "#include \"dbus-common.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DBusConnection *connection = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dbus-common.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic DBusConnection *connection = NULL;\n\nvoid set_dbus_connection(DBusConnection *conn)\n{\n\tconnection = conn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbus_error_free",
          "args": [
            "&err"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_printerr",
          "args": [
            "\"D-Bus setup failed: %s\\n\"",
            "err.message"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_error_is_set",
          "args": [
            "&err"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_dbus_setup_bus",
          "args": [
            "DBUS_BUS_SYSTEM",
            "BLUEZ_NAME",
            "&err"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_error_init",
          "args": [
            "&err"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\n#define BLUEZ_NAME \"org.bluez\"\n\nstatic int connect_dbus(void)\n{\n\tDBusConnection *conn;\n\tDBusError err;\n\n\tdbus_error_init(&err);\n\n\tconn = g_dbus_setup_bus(DBUS_BUS_SYSTEM, BLUEZ_NAME, &err);\n\tif (!conn) {\n\t\tif (dbus_error_is_set(&err)) {\n\t\t\tg_printerr(\"D-Bus setup failed: %s\\n\", err.message);\n\t\t\tdbus_error_free(&err);\n\t\t\treturn -EIO;\n\t\t}\n\t\treturn -EALREADY;\n\t}\n\n\tset_dbus_connection(conn);\n\n\tg_dbus_set_disconnect_function(conn, disconnected_dbus, NULL, NULL);\n\tg_dbus_attach_object_manager(conn);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "disconnected_dbus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "616-620",
    "snippet": "static void disconnected_dbus(DBusConnection *conn, void *data)\n{\n\tinfo(\"Disconnected from D-Bus. Exiting.\");\n\tg_main_loop_quit(event_loop);\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GMainLoop *event_loop;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_main_loop_quit",
          "args": [
            "event_loop"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Disconnected from D-Bus. Exiting.\""
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "store_device_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/device.c",
          "lines": "475-487",
          "snippet": "static void store_device_info(struct btd_device *device)\n{\n\tif (device->temporary || device->store_id > 0)\n\t\treturn;\n\n\tif (device_address_is_private(device)) {\n\t\tDBG(\"Can't store info for private addressed device %s\",\n\t\t\t\t\t\t\t\tdevice->path);\n\t\treturn;\n\t}\n\n\tdevice->store_id = g_idle_add(store_device_info_cb, device);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"attrib-server.h\"",
            "#include \"storage.h\"",
            "#include \"textfile.h\"",
            "#include \"agent.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"sdp-client.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"service.h\"",
            "#include \"profile.h\"",
            "#include \"gatt-client.h\"",
            "#include \"device.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"gatt-database.h\"",
            "#include \"adapter.h\"",
            "#include \"hcid.h\"",
            "#include \"attrib/att.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/ad.h\"",
            "#include \"src/shared/gatt-server.h\"",
            "#include \"src/shared/gatt-client.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void gatt_client_init(struct btd_device *device);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"attrib-server.h\"\n#include \"storage.h\"\n#include \"textfile.h\"\n#include \"agent.h\"\n#include \"attrib/gatt.h\"\n#include \"sdp-client.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"service.h\"\n#include \"profile.h\"\n#include \"gatt-client.h\"\n#include \"device.h\"\n#include \"attrib/gattrib.h\"\n#include \"gatt-database.h\"\n#include \"adapter.h\"\n#include \"hcid.h\"\n#include \"attrib/att.h\"\n#include \"lib/mgmt.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/ad.h\"\n#include \"src/shared/gatt-server.h\"\n#include \"src/shared/gatt-client.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/util.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <time.h>\n#include <dirent.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void gatt_client_init(struct btd_device *device);\n\nstatic void store_device_info(struct btd_device *device)\n{\n\tif (device->temporary || device->store_id > 0)\n\t\treturn;\n\n\tif (device_address_is_private(device)) {\n\t\tDBG(\"Can't store info for private addressed device %s\",\n\t\t\t\t\t\t\t\tdevice->path);\n\t\treturn;\n\t}\n\n\tdevice->store_id = g_idle_add(store_device_info_cb, device);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic GMainLoop *event_loop;\n\nstatic void disconnected_dbus(DBusConnection *conn, void *data)\n{\n\tinfo(\"Disconnected from D-Bus. Exiting.\");\n\tg_main_loop_quit(event_loop);\n}"
  },
  {
    "function_name": "disconnect_dbus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "603-614",
    "snippet": "static void disconnect_dbus(void)\n{\n\tDBusConnection *conn = btd_get_dbus_connection();\n\n\tif (!conn || !dbus_connection_get_is_connected(conn))\n\t\treturn;\n\n\tg_dbus_detach_object_manager(conn);\n\tset_dbus_connection(NULL);\n\n\tdbus_connection_unref(conn);\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dbus_connection_unref",
          "args": [
            "conn"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_dbus_connection",
          "args": [
            "NULL"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "set_dbus_connection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/dbus-common.c",
          "lines": "56-59",
          "snippet": "void set_dbus_connection(DBusConnection *conn)\n{\n\tconnection = conn;\n}",
          "includes": [
            "#include \"dbus-common.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DBusConnection *connection = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dbus-common.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic DBusConnection *connection = NULL;\n\nvoid set_dbus_connection(DBusConnection *conn)\n{\n\tconnection = conn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_dbus_detach_object_manager",
          "args": [
            "conn"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_connection_get_is_connected",
          "args": [
            "conn"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btd_get_dbus_connection",
          "args": [],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "btd_get_dbus_connection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/dbus-common.c",
          "lines": "61-64",
          "snippet": "DBusConnection *btd_get_dbus_connection(void)\n{\n\treturn connection;\n}",
          "includes": [
            "#include \"dbus-common.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DBusConnection *connection = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"dbus-common.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic DBusConnection *connection = NULL;\n\nDBusConnection *btd_get_dbus_connection(void)\n{\n\treturn connection;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void disconnect_dbus(void)\n{\n\tDBusConnection *conn = btd_get_dbus_connection();\n\n\tif (!conn || !dbus_connection_get_is_connected(conn))\n\t\treturn;\n\n\tg_dbus_detach_object_manager(conn);\n\tset_dbus_connection(NULL);\n\n\tdbus_connection_unref(conn);\n}"
  },
  {
    "function_name": "free_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "588-601",
    "snippet": "static void free_options(void)\n{\n\tg_free(option_debug);\n\toption_debug = NULL;\n\n\tg_free(option_plugin);\n\toption_plugin = NULL;\n\n\tg_free(option_noplugin);\n\toption_noplugin = NULL;\n\n\tg_free(option_configfile);\n\toption_configfile = NULL;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *option_debug = NULL;",
      "static char *option_plugin = NULL;",
      "static char *option_noplugin = NULL;",
      "static char *option_configfile = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "option_configfile"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "option_noplugin"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "option_plugin"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "option_debug"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic char *option_debug = NULL;\nstatic char *option_plugin = NULL;\nstatic char *option_noplugin = NULL;\nstatic char *option_configfile = NULL;\n\nstatic void free_options(void)\n{\n\tg_free(option_debug);\n\toption_debug = NULL;\n\n\tg_free(option_plugin);\n\toption_plugin = NULL;\n\n\tg_free(option_noplugin);\n\toption_noplugin = NULL;\n\n\tg_free(option_configfile);\n\toption_configfile = NULL;\n}"
  },
  {
    "function_name": "setup_signalfd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "541-577",
    "snippet": "static guint setup_signalfd(void)\n{\n\tGIOChannel *channel;\n\tguint source;\n\tsigset_t mask;\n\tint fd;\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGTERM);\n\tsigaddset(&mask, SIGUSR2);\n\n\tif (sigprocmask(SIG_BLOCK, &mask, NULL) < 0) {\n\t\tperror(\"Failed to set signal mask\");\n\t\treturn 0;\n\t}\n\n\tfd = signalfd(-1, &mask, 0);\n\tif (fd < 0) {\n\t\tperror(\"Failed to create signal descriptor\");\n\t\treturn 0;\n\t}\n\n\tchannel = g_io_channel_unix_new(fd);\n\n\tg_io_channel_set_close_on_unref(channel, TRUE);\n\tg_io_channel_set_encoding(channel, NULL, NULL);\n\tg_io_channel_set_buffered(channel, FALSE);\n\n\tsource = g_io_add_watch(channel,\n\t\t\t\tG_IO_IN | G_IO_HUP | G_IO_ERR | G_IO_NVAL,\n\t\t\t\tsignal_handler, NULL);\n\n\tg_io_channel_unref(channel);\n\n\treturn source;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_io_channel_unref",
          "args": [
            "channel"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_add_watch",
          "args": [
            "channel",
            "G_IO_IN | G_IO_HUP | G_IO_ERR | G_IO_NVAL",
            "signal_handler",
            "NULL"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_set_buffered",
          "args": [
            "channel",
            "FALSE"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_set_encoding",
          "args": [
            "channel",
            "NULL",
            "NULL"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_set_close_on_unref",
          "args": [
            "channel",
            "TRUE"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_unix_new",
          "args": [
            "fd"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"Failed to create signal descriptor\""
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signalfd",
          "args": [
            "-1",
            "&mask",
            "0"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"Failed to set signal mask\""
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigprocmask",
          "args": [
            "SIG_BLOCK",
            "&mask",
            "NULL"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaddset",
          "args": [
            "&mask",
            "SIGUSR2"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaddset",
          "args": [
            "&mask",
            "SIGTERM"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaddset",
          "args": [
            "&mask",
            "SIGINT"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigemptyset",
          "args": [
            "&mask"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic guint setup_signalfd(void)\n{\n\tGIOChannel *channel;\n\tguint source;\n\tsigset_t mask;\n\tint fd;\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGTERM);\n\tsigaddset(&mask, SIGUSR2);\n\n\tif (sigprocmask(SIG_BLOCK, &mask, NULL) < 0) {\n\t\tperror(\"Failed to set signal mask\");\n\t\treturn 0;\n\t}\n\n\tfd = signalfd(-1, &mask, 0);\n\tif (fd < 0) {\n\t\tperror(\"Failed to create signal descriptor\");\n\t\treturn 0;\n\t}\n\n\tchannel = g_io_channel_unix_new(fd);\n\n\tg_io_channel_set_close_on_unref(channel, TRUE);\n\tg_io_channel_set_encoding(channel, NULL, NULL);\n\tg_io_channel_set_buffered(channel, FALSE);\n\n\tsource = g_io_add_watch(channel,\n\t\t\t\tG_IO_IN | G_IO_HUP | G_IO_ERR | G_IO_NVAL,\n\t\t\t\tsignal_handler, NULL);\n\n\tg_io_channel_unref(channel);\n\n\treturn source;\n}"
  },
  {
    "function_name": "signal_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "502-539",
    "snippet": "static gboolean signal_handler(GIOChannel *channel, GIOCondition cond,\n\t\t\t\t\t\t\tgpointer user_data)\n{\n\tstatic bool terminated = false;\n\tstruct signalfd_siginfo si;\n\tssize_t result;\n\tint fd;\n\n\tif (cond & (G_IO_NVAL | G_IO_ERR | G_IO_HUP))\n\t\treturn FALSE;\n\n\tfd = g_io_channel_unix_get_fd(channel);\n\n\tresult = read(fd, &si, sizeof(si));\n\tif (result != sizeof(si))\n\t\treturn FALSE;\n\n\tswitch (si.ssi_signo) {\n\tcase SIGINT:\n\tcase SIGTERM:\n\t\tif (!terminated) {\n\t\t\tinfo(\"Terminating\");\n\t\t\tg_timeout_add_seconds(SHUTDOWN_GRACE_SECONDS,\n\t\t\t\t\t\t\tquit_eventloop, NULL);\n\n\t\t\tsd_notify(0, \"STATUS=Powering down\");\n\t\t\tadapter_shutdown();\n\t\t}\n\n\t\tterminated = true;\n\t\tbreak;\n\tcase SIGUSR2:\n\t\t__btd_toggle_debug();\n\t\tbreak;\n\t}\n\n\treturn TRUE;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SHUTDOWN_GRACE_SECONDS 10"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__btd_toggle_debug",
          "args": [],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "__btd_toggle_debug",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "297-303",
          "snippet": "void __btd_toggle_debug(void)\n{\n\tstruct btd_debug_desc *desc;\n\n\tfor (desc = __start___debug; desc < __stop___debug; desc++)\n\t\tdesc->flags |= BTD_DEBUG_FLAG_PRINT;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern struct btd_debug_desc __start___debug[];",
            "extern struct btd_debug_desc __stop___debug[];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nextern struct btd_debug_desc __start___debug[];\nextern struct btd_debug_desc __stop___debug[];\n\nvoid __btd_toggle_debug(void)\n{\n\tstruct btd_debug_desc *desc;\n\n\tfor (desc = __start___debug; desc < __stop___debug; desc++)\n\t\tdesc->flags |= BTD_DEBUG_FLAG_PRINT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "adapter_shutdown",
          "args": [],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "adapter_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/adapter.c",
          "lines": "9096-9119",
          "snippet": "void adapter_shutdown(void)\n{\n\tGList *list;\n\n\tDBG(\"\");\n\n\tpowering_down = true;\n\n\tfor (list = g_list_first(adapter_list); list;\n\t\t\t\t\t\tlist = g_list_next(list)) {\n\t\tstruct btd_adapter *adapter = list->data;\n\n\t\tif (!(adapter->current_settings & MGMT_SETTING_POWERED))\n\t\t\tcontinue;\n\n\t\tclear_discoverable(adapter);\n\t\tset_mode(adapter, MGMT_OP_SET_POWERED, 0x00);\n\n\t\tadapter_remaining++;\n\t}\n\n\tif (!adapter_remaining)\n\t\tbtd_exit();\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"advertising.h\"",
            "#include \"gatt-database.h\"",
            "#include \"attrib-server.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"storage.h\"",
            "#include \"agent.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/mgmt.h\"",
            "#include \"textfile.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"bluetooth/sdp_lib.h\"",
            "#include \"bluetooth/sdp.h\"",
            "#include \"bluetooth/hci_lib.h\"",
            "#include \"bluetooth/hci.h\"",
            "#include \"bluetooth/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <sys/ioctl.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <inttypes.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static GList *adapter_list = NULL;",
            "static unsigned int adapter_remaining = 0;",
            "static bool powering_down = false;",
            "static void trigger_pairable_timeout(struct btd_adapter *adapter);",
            "static void adapter_start(struct btd_adapter *adapter);",
            "static void adapter_stop(struct btd_adapter *adapter);",
            "static void trigger_passive_scanning(struct btd_adapter *adapter);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"advertising.h\"\n#include \"gatt-database.h\"\n#include \"attrib-server.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"storage.h\"\n#include \"agent.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/mgmt.h\"\n#include \"textfile.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/mgmt.h\"\n#include \"lib/uuid.h\"\n#include \"bluetooth/sdp_lib.h\"\n#include \"bluetooth/sdp.h\"\n#include \"bluetooth/hci_lib.h\"\n#include \"bluetooth/hci.h\"\n#include \"bluetooth/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <sys/ioctl.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <inttypes.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GList *adapter_list = NULL;\nstatic unsigned int adapter_remaining = 0;\nstatic bool powering_down = false;\nstatic void trigger_pairable_timeout(struct btd_adapter *adapter);\nstatic void adapter_start(struct btd_adapter *adapter);\nstatic void adapter_stop(struct btd_adapter *adapter);\nstatic void trigger_passive_scanning(struct btd_adapter *adapter);\n\nvoid adapter_shutdown(void)\n{\n\tGList *list;\n\n\tDBG(\"\");\n\n\tpowering_down = true;\n\n\tfor (list = g_list_first(adapter_list); list;\n\t\t\t\t\t\tlist = g_list_next(list)) {\n\t\tstruct btd_adapter *adapter = list->data;\n\n\t\tif (!(adapter->current_settings & MGMT_SETTING_POWERED))\n\t\t\tcontinue;\n\n\t\tclear_discoverable(adapter);\n\t\tset_mode(adapter, MGMT_OP_SET_POWERED, 0x00);\n\n\t\tadapter_remaining++;\n\t}\n\n\tif (!adapter_remaining)\n\t\tbtd_exit();\n}"
        }
      },
      {
        "call_info": {
          "callee": "sd_notify",
          "args": [
            "0",
            "\"STATUS=Powering down\""
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "sd_notify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/systemd.c",
          "lines": "44-107",
          "snippet": "int sd_notify(int unset_environment, const char *state)\n{\n\tconst char *sock;\n\tstruct sockaddr_un addr;\n\tstruct msghdr msghdr;\n\tstruct iovec iovec;\n\tint fd, err;\n\n\tif (!state) {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tsock = getenv(\"NOTIFY_SOCKET\");\n\tif (!sock)\n\t\treturn 0;\n\n\t/* check for abstract socket or absolute path */\n\tif (sock[0] != '@' && sock[0] != '/') {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tfd = socket(AF_UNIX, SOCK_DGRAM | SOCK_CLOEXEC, 0);\n\tif (fd < 0) {\n\t\terr = -errno;\n\t\tgoto done;\n\t}\n\n\tmemset(&addr, 0, sizeof(addr));\n\taddr.sun_family = AF_UNIX;\n\tstrncpy(addr.sun_path, sock, sizeof(addr.sun_path) - 1);\n\n\tif (addr.sun_path[0] == '@')\n\t\taddr.sun_path[0] = '\\0';\n\n\tmemset(&iovec, 0, sizeof(iovec));\n\tiovec.iov_base = (char *) state;\n\tiovec.iov_len = strlen(state);\n\n\tmemset(&msghdr, 0, sizeof(msghdr));\n\tmsghdr.msg_name = &addr;\n\tmsghdr.msg_namelen = offsetof(struct sockaddr_un, sun_path) +\n\t\t\t\t\t\t\t\tstrlen(sock);\n\n\tif (msghdr.msg_namelen > sizeof(struct sockaddr_un))\n\t\tmsghdr.msg_namelen = sizeof(struct sockaddr_un);\n\n\tmsghdr.msg_iov = &iovec;\n\tmsghdr.msg_iovlen = 1;\n\n\tif (sendmsg(fd, &msghdr, MSG_NOSIGNAL) < 0)\n\t\terr = -errno;\n\telse\n\t\terr = 1;\n\n\tclose(fd);\n\ndone:\n\tif (unset_environment)\n\t\tunsetenv(\"NOTIFY_SOCKET\");\n\n\treturn err;\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <stddef.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nint sd_notify(int unset_environment, const char *state)\n{\n\tconst char *sock;\n\tstruct sockaddr_un addr;\n\tstruct msghdr msghdr;\n\tstruct iovec iovec;\n\tint fd, err;\n\n\tif (!state) {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tsock = getenv(\"NOTIFY_SOCKET\");\n\tif (!sock)\n\t\treturn 0;\n\n\t/* check for abstract socket or absolute path */\n\tif (sock[0] != '@' && sock[0] != '/') {\n\t\terr = -EINVAL;\n\t\tgoto done;\n\t}\n\n\tfd = socket(AF_UNIX, SOCK_DGRAM | SOCK_CLOEXEC, 0);\n\tif (fd < 0) {\n\t\terr = -errno;\n\t\tgoto done;\n\t}\n\n\tmemset(&addr, 0, sizeof(addr));\n\taddr.sun_family = AF_UNIX;\n\tstrncpy(addr.sun_path, sock, sizeof(addr.sun_path) - 1);\n\n\tif (addr.sun_path[0] == '@')\n\t\taddr.sun_path[0] = '\\0';\n\n\tmemset(&iovec, 0, sizeof(iovec));\n\tiovec.iov_base = (char *) state;\n\tiovec.iov_len = strlen(state);\n\n\tmemset(&msghdr, 0, sizeof(msghdr));\n\tmsghdr.msg_name = &addr;\n\tmsghdr.msg_namelen = offsetof(struct sockaddr_un, sun_path) +\n\t\t\t\t\t\t\t\tstrlen(sock);\n\n\tif (msghdr.msg_namelen > sizeof(struct sockaddr_un))\n\t\tmsghdr.msg_namelen = sizeof(struct sockaddr_un);\n\n\tmsghdr.msg_iov = &iovec;\n\tmsghdr.msg_iovlen = 1;\n\n\tif (sendmsg(fd, &msghdr, MSG_NOSIGNAL) < 0)\n\t\terr = -errno;\n\telse\n\t\terr = 1;\n\n\tclose(fd);\n\ndone:\n\tif (unset_environment)\n\t\tunsetenv(\"NOTIFY_SOCKET\");\n\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_timeout_add_seconds",
          "args": [
            "SHUTDOWN_GRACE_SECONDS",
            "quit_eventloop",
            "NULL"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Terminating\""
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "store_device_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/device.c",
          "lines": "475-487",
          "snippet": "static void store_device_info(struct btd_device *device)\n{\n\tif (device->temporary || device->store_id > 0)\n\t\treturn;\n\n\tif (device_address_is_private(device)) {\n\t\tDBG(\"Can't store info for private addressed device %s\",\n\t\t\t\t\t\t\t\tdevice->path);\n\t\treturn;\n\t}\n\n\tdevice->store_id = g_idle_add(store_device_info_cb, device);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"attrib-server.h\"",
            "#include \"storage.h\"",
            "#include \"textfile.h\"",
            "#include \"agent.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"sdp-client.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"service.h\"",
            "#include \"profile.h\"",
            "#include \"gatt-client.h\"",
            "#include \"device.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"gatt-database.h\"",
            "#include \"adapter.h\"",
            "#include \"hcid.h\"",
            "#include \"attrib/att.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/ad.h\"",
            "#include \"src/shared/gatt-server.h\"",
            "#include \"src/shared/gatt-client.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void gatt_client_init(struct btd_device *device);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"attrib-server.h\"\n#include \"storage.h\"\n#include \"textfile.h\"\n#include \"agent.h\"\n#include \"attrib/gatt.h\"\n#include \"sdp-client.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"service.h\"\n#include \"profile.h\"\n#include \"gatt-client.h\"\n#include \"device.h\"\n#include \"attrib/gattrib.h\"\n#include \"gatt-database.h\"\n#include \"adapter.h\"\n#include \"hcid.h\"\n#include \"attrib/att.h\"\n#include \"lib/mgmt.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/ad.h\"\n#include \"src/shared/gatt-server.h\"\n#include \"src/shared/gatt-client.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/util.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <time.h>\n#include <dirent.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void gatt_client_init(struct btd_device *device);\n\nstatic void store_device_info(struct btd_device *device)\n{\n\tif (device->temporary || device->store_id > 0)\n\t\treturn;\n\n\tif (device_address_is_private(device)) {\n\t\tDBG(\"Can't store info for private addressed device %s\",\n\t\t\t\t\t\t\t\tdevice->path);\n\t\treturn;\n\t}\n\n\tdevice->store_id = g_idle_add(store_device_info_cb, device);\n}"
        }
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "&si",
            "sizeof(si)"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "read_device_ccc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/attrib-server.c",
          "lines": "763-795",
          "snippet": "static int read_device_ccc(struct btd_device *device, uint16_t handle,\n\t\t\t\tuint16_t *value)\n{\n\tchar *filename;\n\tGKeyFile *key_file;\n\tchar group[6];\n\tchar *str;\n\tunsigned int config;\n\tint err = 0;\n\n\tfilename = btd_device_get_storage_path(device, \"ccc\");\n\tif (!filename) {\n\t\twarn(\"Unable to get ccc storage path for device\");\n\t\treturn -ENOENT;\n\t}\n\n\tkey_file = g_key_file_new();\n\tg_key_file_load_from_file(key_file, filename, 0, NULL);\n\n\tsprintf(group, \"%hu\", handle);\n\n\tstr = g_key_file_get_string(key_file, group, \"Value\", NULL);\n\tif (!str || sscanf(str, \"%04X\", &config) != 1)\n\t\terr = -ENOENT;\n\telse\n\t\t*value = config;\n\n\tg_free(str);\n\tg_free(filename);\n\tg_key_file_free(key_file);\n\n\treturn err;\n}",
          "includes": [
            "#include \"attrib-server.h\"",
            "#include \"storage.h\"",
            "#include \"textfile.h\"",
            "#include \"attrib/att-database.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"btio/btio.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <sys/stat.h>",
            "#include <glib.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"attrib-server.h\"\n#include \"storage.h\"\n#include \"textfile.h\"\n#include \"attrib/att-database.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"src/shared/util.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"btio/btio.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <sys/stat.h>\n#include <glib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <errno.h>\n#include <config.h>\n\nstatic int read_device_ccc(struct btd_device *device, uint16_t handle,\n\t\t\t\tuint16_t *value)\n{\n\tchar *filename;\n\tGKeyFile *key_file;\n\tchar group[6];\n\tchar *str;\n\tunsigned int config;\n\tint err = 0;\n\n\tfilename = btd_device_get_storage_path(device, \"ccc\");\n\tif (!filename) {\n\t\twarn(\"Unable to get ccc storage path for device\");\n\t\treturn -ENOENT;\n\t}\n\n\tkey_file = g_key_file_new();\n\tg_key_file_load_from_file(key_file, filename, 0, NULL);\n\n\tsprintf(group, \"%hu\", handle);\n\n\tstr = g_key_file_get_string(key_file, group, \"Value\", NULL);\n\tif (!str || sscanf(str, \"%04X\", &config) != 1)\n\t\terr = -ENOENT;\n\telse\n\t\t*value = config;\n\n\tg_free(str);\n\tg_free(filename);\n\tg_key_file_free(key_file);\n\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_io_channel_unix_get_fd",
          "args": [
            "channel"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\n#define SHUTDOWN_GRACE_SECONDS 10\n\nstatic gboolean signal_handler(GIOChannel *channel, GIOCondition cond,\n\t\t\t\t\t\t\tgpointer user_data)\n{\n\tstatic bool terminated = false;\n\tstruct signalfd_siginfo si;\n\tssize_t result;\n\tint fd;\n\n\tif (cond & (G_IO_NVAL | G_IO_ERR | G_IO_HUP))\n\t\treturn FALSE;\n\n\tfd = g_io_channel_unix_get_fd(channel);\n\n\tresult = read(fd, &si, sizeof(si));\n\tif (result != sizeof(si))\n\t\treturn FALSE;\n\n\tswitch (si.ssi_signo) {\n\tcase SIGINT:\n\tcase SIGTERM:\n\t\tif (!terminated) {\n\t\t\tinfo(\"Terminating\");\n\t\t\tg_timeout_add_seconds(SHUTDOWN_GRACE_SECONDS,\n\t\t\t\t\t\t\tquit_eventloop, NULL);\n\n\t\t\tsd_notify(0, \"STATUS=Powering down\");\n\t\t\tadapter_shutdown();\n\t\t}\n\n\t\tterminated = true;\n\t\tbreak;\n\tcase SIGUSR2:\n\t\t__btd_toggle_debug();\n\t\tbreak;\n\t}\n\n\treturn TRUE;\n}"
  },
  {
    "function_name": "quit_eventloop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "496-500",
    "snippet": "static gboolean quit_eventloop(gpointer user_data)\n{\n\tbtd_exit();\n\treturn FALSE;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "btd_exit",
          "args": [],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "btd_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "491-494",
          "snippet": "void btd_exit(void)\n{\n\tg_main_loop_quit(event_loop);\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static GMainLoop *event_loop;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic GMainLoop *event_loop;\n\nvoid btd_exit(void)\n{\n\tg_main_loop_quit(event_loop);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic gboolean quit_eventloop(gpointer user_data)\n{\n\tbtd_exit();\n\treturn FALSE;\n}"
  },
  {
    "function_name": "btd_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "491-494",
    "snippet": "void btd_exit(void)\n{\n\tg_main_loop_quit(event_loop);\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GMainLoop *event_loop;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_main_loop_quit",
          "args": [
            "event_loop"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic GMainLoop *event_loop;\n\nvoid btd_exit(void)\n{\n\tg_main_loop_quit(event_loop);\n}"
  },
  {
    "function_name": "log_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "474-487",
    "snippet": "static void log_handler(const gchar *log_domain, GLogLevelFlags log_level,\n\t\t\t\tconst gchar *message, gpointer user_data)\n{\n\tint priority;\n\n\tif (log_level & (G_LOG_LEVEL_ERROR |\n\t\t\t\tG_LOG_LEVEL_CRITICAL | G_LOG_LEVEL_WARNING))\n\t\tpriority = 0x03;\n\telse\n\t\tpriority = 0x06;\n\n\tbtd_log(0xffff, priority, \"GLib: %s\", message);\n\tbtd_backtrace(0xffff);\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "btd_backtrace",
          "args": [
            "0xffff"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "btd_backtrace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/backtrace.c",
          "lines": "52-127",
          "snippet": "void btd_backtrace(uint16_t index)\n{\n#ifdef HAVE_BACKTRACE_SUPPORT\n\tchar *debuginfo_path = NULL;\n\tconst Dwfl_Callbacks callbacks = {\n\t\t.find_debuginfo = dwfl_standard_find_debuginfo,\n\t\t.find_elf = dwfl_linux_proc_find_elf,\n\t\t.debuginfo_path = &debuginfo_path,\n\t};\n\tDwfl *dwfl;\n\tvoid *frames[48];\n\tint n, n_ptrs;\n\n\tdwfl = dwfl_begin(&callbacks);\n\n\tif (dwfl_linux_proc_report(dwfl, getpid()))\n\t\tgoto done;\n\n\tdwfl_report_end(dwfl, NULL, NULL);\n\n\tn_ptrs = backtrace(frames, 48);\n\tif (n_ptrs < 1)\n\t\tgoto done;\n\n\tbtd_error(index, \"++++++++ backtrace ++++++++\");\n\n\tfor (n = 1; n < n_ptrs; n++) {\n\t\tGElf_Addr addr = (uintptr_t) frames[n];\n\t\tGElf_Sym sym;\n\t\tGElf_Word shndx;\n\t\tDwfl_Module *module = dwfl_addrmodule(dwfl, addr);\n\t\tDwfl_Line *line;\n\t\tconst char *name, *modname;\n\n\t\tif (!module) {\n\t\t\tbtd_error(index, \"#%-2u ?? [%#\" PRIx64 \"]\", n, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tname = dwfl_module_addrsym(module, addr, &sym, &shndx);\n\t\tif (!name) {\n\t\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\t\tbtd_error(index, \"#%-2u ?? (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\t\tn, modname, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tline = dwfl_module_getsrc(module, addr);\n\t\tif (line) {\n\t\t\tint lineno;\n\t\t\tconst char *src = dwfl_lineinfo(line, NULL, &lineno,\n\t\t\t\t\t\t\tNULL, NULL, NULL);\n\n\t\t\tif (src) {\n\t\t\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" \"\n\t\t\t\t\t\t\"(%s:%d) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\tsrc, lineno, addr);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\t\tmodname, addr);\n\t}\n\n\tbtd_error(index, \"+++++++++++++++++++++++++++\");\n\ndone:\n\tdwfl_end(dwfl);\n#endif\n}",
          "includes": [
            "#include \"src/backtrace.h\"",
            "#include \"src/log.h\"",
            "#include <elfutils/libdwfl.h>",
            "#include <execinfo.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/backtrace.h\"\n#include \"src/log.h\"\n#include <elfutils/libdwfl.h>\n#include <execinfo.h>\n#include <inttypes.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid btd_backtrace(uint16_t index)\n{\n#ifdef HAVE_BACKTRACE_SUPPORT\n\tchar *debuginfo_path = NULL;\n\tconst Dwfl_Callbacks callbacks = {\n\t\t.find_debuginfo = dwfl_standard_find_debuginfo,\n\t\t.find_elf = dwfl_linux_proc_find_elf,\n\t\t.debuginfo_path = &debuginfo_path,\n\t};\n\tDwfl *dwfl;\n\tvoid *frames[48];\n\tint n, n_ptrs;\n\n\tdwfl = dwfl_begin(&callbacks);\n\n\tif (dwfl_linux_proc_report(dwfl, getpid()))\n\t\tgoto done;\n\n\tdwfl_report_end(dwfl, NULL, NULL);\n\n\tn_ptrs = backtrace(frames, 48);\n\tif (n_ptrs < 1)\n\t\tgoto done;\n\n\tbtd_error(index, \"++++++++ backtrace ++++++++\");\n\n\tfor (n = 1; n < n_ptrs; n++) {\n\t\tGElf_Addr addr = (uintptr_t) frames[n];\n\t\tGElf_Sym sym;\n\t\tGElf_Word shndx;\n\t\tDwfl_Module *module = dwfl_addrmodule(dwfl, addr);\n\t\tDwfl_Line *line;\n\t\tconst char *name, *modname;\n\n\t\tif (!module) {\n\t\t\tbtd_error(index, \"#%-2u ?? [%#\" PRIx64 \"]\", n, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tname = dwfl_module_addrsym(module, addr, &sym, &shndx);\n\t\tif (!name) {\n\t\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\t\tbtd_error(index, \"#%-2u ?? (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\t\tn, modname, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tline = dwfl_module_getsrc(module, addr);\n\t\tif (line) {\n\t\t\tint lineno;\n\t\t\tconst char *src = dwfl_lineinfo(line, NULL, &lineno,\n\t\t\t\t\t\t\tNULL, NULL, NULL);\n\n\t\t\tif (src) {\n\t\t\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" \"\n\t\t\t\t\t\t\"(%s:%d) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\tsrc, lineno, addr);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\t\tmodname, addr);\n\t}\n\n\tbtd_error(index, \"+++++++++++++++++++++++++++\");\n\ndone:\n\tdwfl_end(dwfl);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "btd_log",
          "args": [
            "0xffff",
            "priority",
            "\"GLib: %s\"",
            "message"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "btd_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "183-197",
          "snippet": "void btd_log(uint16_t index, int priority, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(priority, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, priority, format, ap);\n\tva_end(ap);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_log(uint16_t index, int priority, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(priority, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, priority, format, ap);\n\tva_end(ap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void log_handler(const gchar *log_domain, GLogLevelFlags log_level,\n\t\t\t\tconst gchar *message, gpointer user_data)\n{\n\tint priority;\n\n\tif (log_level & (G_LOG_LEVEL_ERROR |\n\t\t\t\tG_LOG_LEVEL_CRITICAL | G_LOG_LEVEL_WARNING))\n\t\tpriority = 0x03;\n\telse\n\t\tpriority = 0x06;\n\n\tbtd_log(0xffff, priority, \"GLib: %s\", message);\n\tbtd_backtrace(0xffff);\n}"
  },
  {
    "function_name": "init_defaults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "448-472",
    "snippet": "static void init_defaults(void)\n{\n\tuint8_t major, minor;\n\n\t/* Default HCId settings */\n\tmemset(&main_opts, 0, sizeof(main_opts));\n\tmain_opts.name = g_strdup_printf(\"BlueZ %s\", VERSION);\n\tmain_opts.class = 0x000000;\n\tmain_opts.pairto = DEFAULT_PAIRABLE_TIMEOUT;\n\tmain_opts.discovto = DEFAULT_DISCOVERABLE_TIMEOUT;\n\tmain_opts.reverse_sdp = TRUE;\n\tmain_opts.name_resolv = TRUE;\n\tmain_opts.debug_keys = FALSE;\n\n\tif (sscanf(VERSION, \"%hhu.%hhu\", &major, &minor) != 2)\n\t\treturn;\n\n\tmain_opts.did_source = 0x0002;\t\t/* USB */\n\tmain_opts.did_vendor = 0x1d6b;\t\t/* Linux Foundation */\n\tmain_opts.did_product = 0x0246;\t\t/* BlueZ */\n\tmain_opts.did_version = (major << 8 | minor);\n\n\tmain_opts.gatt_cache = BT_GATT_CACHE_ALWAYS;\n\tmain_opts.gatt_mtu = BT_ATT_MAX_LE_MTU;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define DEFAULT_DISCOVERABLE_TIMEOUT 180 /* 3 minutes */",
      "#define DEFAULT_PAIRABLE_TIMEOUT       0 /* disabled */"
    ],
    "globals_used": [
      "struct main_opts main_opts;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "VERSION",
            "\"%hhu.%hhu\"",
            "&major",
            "&minor"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"BlueZ %s\"",
            "VERSION"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&main_opts",
            "0",
            "sizeof(main_opts)"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\n#define DEFAULT_DISCOVERABLE_TIMEOUT 180 /* 3 minutes */\n#define DEFAULT_PAIRABLE_TIMEOUT       0 /* disabled */\n\nstruct main_opts main_opts;\n\nstatic void init_defaults(void)\n{\n\tuint8_t major, minor;\n\n\t/* Default HCId settings */\n\tmemset(&main_opts, 0, sizeof(main_opts));\n\tmain_opts.name = g_strdup_printf(\"BlueZ %s\", VERSION);\n\tmain_opts.class = 0x000000;\n\tmain_opts.pairto = DEFAULT_PAIRABLE_TIMEOUT;\n\tmain_opts.discovto = DEFAULT_DISCOVERABLE_TIMEOUT;\n\tmain_opts.reverse_sdp = TRUE;\n\tmain_opts.name_resolv = TRUE;\n\tmain_opts.debug_keys = FALSE;\n\n\tif (sscanf(VERSION, \"%hhu.%hhu\", &major, &minor) != 2)\n\t\treturn;\n\n\tmain_opts.did_source = 0x0002;\t\t/* USB */\n\tmain_opts.did_vendor = 0x1d6b;\t\t/* Linux Foundation */\n\tmain_opts.did_product = 0x0246;\t\t/* BlueZ */\n\tmain_opts.did_version = (major << 8 | minor);\n\n\tmain_opts.gatt_cache = BT_GATT_CACHE_ALWAYS;\n\tmain_opts.gatt_mtu = BT_ATT_MAX_LE_MTU;\n}"
  },
  {
    "function_name": "parse_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "269-446",
    "snippet": "static void parse_config(GKeyFile *config)\n{\n\tGError *err = NULL;\n\tchar *str;\n\tint val;\n\tgboolean boolean;\n\n\tif (!config)\n\t\treturn;\n\n\tcheck_config(config);\n\n\tDBG(\"parsing %s\", main_conf_file_path);\n\n\tval = g_key_file_get_integer(config, \"General\",\n\t\t\t\t\t\t\"DiscoverableTimeout\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"discovto=%d\", val);\n\t\tmain_opts.discovto = val;\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"AlwaysPairable\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"pairable=%s\", boolean ? \"true\" : \"false\");\n\t\tmain_opts.pairable = boolean;\n\t}\n\n\tval = g_key_file_get_integer(config, \"General\",\n\t\t\t\t\t\t\"PairableTimeout\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"pairto=%d\", val);\n\t\tmain_opts.pairto = val;\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Privacy\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t\tmain_opts.privacy = 0x00;\n\t} else {\n\t\tDBG(\"privacy=%s\", str);\n\n\t\tif (!strcmp(str, \"device\"))\n\t\t\tmain_opts.privacy = 0x01;\n\t\telse if (!strcmp(str, \"off\"))\n\t\t\tmain_opts.privacy = 0x00;\n\t\telse {\n\t\t\tDBG(\"Invalid privacy option: %s\", str);\n\t\t\tmain_opts.privacy = 0x00;\n\t\t}\n\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Name\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"name=%s\", str);\n\t\tg_free(main_opts.name);\n\t\tmain_opts.name = str;\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Class\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"class=%s\", str);\n\t\tmain_opts.class = strtol(str, NULL, 16);\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"DeviceID\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"deviceid=%s\", str);\n\t\tparse_did(str);\n\t\tg_free(str);\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"ReverseServiceDiscovery\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else\n\t\tmain_opts.reverse_sdp = boolean;\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"NameResolving\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.name_resolv = boolean;\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"DebugKeys\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.debug_keys = boolean;\n\n\tstr = g_key_file_get_string(config, \"General\", \"ControllerMode\", &err);\n\tif (err) {\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"ControllerMode=%s\", str);\n\t\tmain_opts.mode = get_mode(str);\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"MultiProfile\", &err);\n\tif (err) {\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"MultiProfile=%s\", str);\n\n\t\tif (!strcmp(str, \"single\"))\n\t\t\tmps = MPS_SINGLE;\n\t\telse if (!strcmp(str, \"multiple\"))\n\t\t\tmps = MPS_MULTIPLE;\n\n\t\tg_free(str);\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"FastConnectable\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.fast_conn = boolean;\n\n\tstr = g_key_file_get_string(config, \"GATT\", \"Cache\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tmain_opts.gatt_cache = parse_gatt_cache(str);\n\t\tg_free(str);\n\t}\n\n\tval = g_key_file_get_integer(config, \"GATT\", \"KeySize\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"KeySize=%d\", val);\n\n\t\tif (val >=7 && val <= 16)\n\t\t\tmain_opts.key_size = val;\n\t}\n\n\tval = g_key_file_get_integer(config, \"GATT\", \"ExchangeMTU\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\t/* Ensure the mtu is within a valid range. */\n\t\tval = MIN(val, BT_ATT_MAX_LE_MTU);\n\t\tval = MAX(val, BT_ATT_DEFAULT_LE_MTU);\n\t\tDBG(\"ExchangeMTU=%d\", val);\n\t\tmain_opts.gatt_mtu = val;\n\t}\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct main_opts main_opts;",
      "static char *main_conf_file_path;",
      "static enum {\n\tMPS_OFF,\n\tMPS_SINGLE,\n\tMPS_MULTIPLE,\n} mps = MPS_OFF;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"ExchangeMTU=%d\"",
            "val"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAX",
          "args": [
            "val",
            "BT_ATT_DEFAULT_LE_MTU"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MIN",
          "args": [
            "val",
            "BT_ATT_MAX_LE_MTU"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"%s\"",
            "err->message"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_integer",
          "args": [
            "config",
            "\"GATT\"",
            "\"ExchangeMTU\"",
            "&err"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"KeySize=%d\"",
            "val"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"%s\"",
            "err->message"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_integer",
          "args": [
            "config",
            "\"GATT\"",
            "\"KeySize\"",
            "&err"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "str"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_gatt_cache",
          "args": [
            "str"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "parse_gatt_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "181-193",
          "snippet": "static bt_gatt_cache_t parse_gatt_cache(const char *cache)\n{\n\tif (!strcmp(cache, \"always\")) {\n\t\treturn BT_GATT_CACHE_ALWAYS;\n\t} else if (!strcmp(cache, \"yes\")) {\n\t\treturn BT_GATT_CACHE_YES;\n\t} else if (!strcmp(cache, \"no\")) {\n\t\treturn BT_GATT_CACHE_NO;\n\t} else {\n\t\tDBG(\"Invalid value for KeepCache=%s\", cache);\n\t\treturn BT_GATT_CACHE_ALWAYS;\n\t}\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic bt_gatt_cache_t parse_gatt_cache(const char *cache)\n{\n\tif (!strcmp(cache, \"always\")) {\n\t\treturn BT_GATT_CACHE_ALWAYS;\n\t} else if (!strcmp(cache, \"yes\")) {\n\t\treturn BT_GATT_CACHE_YES;\n\t} else if (!strcmp(cache, \"no\")) {\n\t\treturn BT_GATT_CACHE_NO;\n\t} else {\n\t\tDBG(\"Invalid value for KeepCache=%s\", cache);\n\t\treturn BT_GATT_CACHE_ALWAYS;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"%s\"",
            "err->message"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_string",
          "args": [
            "config",
            "\"GATT\"",
            "\"Cache\"",
            "&err"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_boolean",
          "args": [
            "config",
            "\"General\"",
            "\"FastConnectable\"",
            "&err"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "str"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "\"multiple\""
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "g_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/adapter.c",
          "lines": "1927-1930",
          "snippet": "static gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"advertising.h\"",
            "#include \"gatt-database.h\"",
            "#include \"attrib-server.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"storage.h\"",
            "#include \"agent.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/mgmt.h\"",
            "#include \"textfile.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"bluetooth/sdp_lib.h\"",
            "#include \"bluetooth/sdp.h\"",
            "#include \"bluetooth/hci_lib.h\"",
            "#include \"bluetooth/hci.h\"",
            "#include \"bluetooth/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <sys/ioctl.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <inttypes.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"advertising.h\"\n#include \"gatt-database.h\"\n#include \"attrib-server.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"storage.h\"\n#include \"agent.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/mgmt.h\"\n#include \"textfile.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/mgmt.h\"\n#include \"lib/uuid.h\"\n#include \"bluetooth/sdp_lib.h\"\n#include \"bluetooth/sdp.h\"\n#include \"bluetooth/hci_lib.h\"\n#include \"bluetooth/hci.h\"\n#include \"bluetooth/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <sys/ioctl.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <inttypes.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"MultiProfile=%s\"",
            "str"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_string",
          "args": [
            "config",
            "\"General\"",
            "\"MultiProfile\"",
            "&err"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "str"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_mode",
          "args": [
            "str"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "get_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "255-267",
          "snippet": "static int get_mode(const char *str)\n{\n\tif (strcmp(str, \"dual\") == 0)\n\t\treturn BT_MODE_DUAL;\n\telse if (strcmp(str, \"bredr\") == 0)\n\t\treturn BT_MODE_BREDR;\n\telse if (strcmp(str, \"le\") == 0)\n\t\treturn BT_MODE_LE;\n\n\terror(\"Unknown controller mode \\\"%s\\\"\", str);\n\n\treturn BT_MODE_DUAL;\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic int get_mode(const char *str)\n{\n\tif (strcmp(str, \"dual\") == 0)\n\t\treturn BT_MODE_DUAL;\n\telse if (strcmp(str, \"bredr\") == 0)\n\t\treturn BT_MODE_BREDR;\n\telse if (strcmp(str, \"le\") == 0)\n\t\treturn BT_MODE_LE;\n\n\terror(\"Unknown controller mode \\\"%s\\\"\", str);\n\n\treturn BT_MODE_DUAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"ControllerMode=%s\"",
            "str"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_string",
          "args": [
            "config",
            "\"General\"",
            "\"ControllerMode\"",
            "&err"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_boolean",
          "args": [
            "config",
            "\"General\"",
            "\"DebugKeys\"",
            "&err"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_boolean",
          "args": [
            "config",
            "\"General\"",
            "\"NameResolving\"",
            "&err"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"%s\"",
            "err->message"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_boolean",
          "args": [
            "config",
            "\"General\"",
            "\"ReverseServiceDiscovery\"",
            "&err"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "str"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_did",
          "args": [
            "str"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "parse_did",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "149-179",
          "snippet": "static void parse_did(const char *did)\n{\n\tint result;\n\tuint16_t vendor, product, version , source;\n\n\t/* version and source are optional */\n\tversion = 0x0000;\n\tsource = 0x0002;\n\n\tresult = sscanf(did, \"bluetooth:%4hx:%4hx:%4hx\",\n\t\t\t\t\t&vendor, &product, &version);\n\tif (result != EOF && result >= 2) {\n\t\tsource = 0x0001;\n\t\tgoto done;\n\t}\n\n\tresult = sscanf(did, \"usb:%4hx:%4hx:%4hx\",\n\t\t\t\t\t&vendor, &product, &version);\n\tif (result != EOF && result >= 2)\n\t\tgoto done;\n\n\tresult = sscanf(did, \"%4hx:%4hx:%4hx\", &vendor, &product, &version);\n\tif (result == EOF || result < 2)\n\t\treturn;\n\ndone:\n\tmain_opts.did_source = source;\n\tmain_opts.did_vendor = vendor;\n\tmain_opts.did_product = product;\n\tmain_opts.did_version = version;\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct main_opts main_opts;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstruct main_opts main_opts;\n\nstatic void parse_did(const char *did)\n{\n\tint result;\n\tuint16_t vendor, product, version , source;\n\n\t/* version and source are optional */\n\tversion = 0x0000;\n\tsource = 0x0002;\n\n\tresult = sscanf(did, \"bluetooth:%4hx:%4hx:%4hx\",\n\t\t\t\t\t&vendor, &product, &version);\n\tif (result != EOF && result >= 2) {\n\t\tsource = 0x0001;\n\t\tgoto done;\n\t}\n\n\tresult = sscanf(did, \"usb:%4hx:%4hx:%4hx\",\n\t\t\t\t\t&vendor, &product, &version);\n\tif (result != EOF && result >= 2)\n\t\tgoto done;\n\n\tresult = sscanf(did, \"%4hx:%4hx:%4hx\", &vendor, &product, &version);\n\tif (result == EOF || result < 2)\n\t\treturn;\n\ndone:\n\tmain_opts.did_source = source;\n\tmain_opts.did_vendor = vendor;\n\tmain_opts.did_product = product;\n\tmain_opts.did_version = version;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"deviceid=%s\"",
            "str"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"%s\"",
            "err->message"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_string",
          "args": [
            "config",
            "\"General\"",
            "\"DeviceID\"",
            "&err"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "str"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "str",
            "NULL",
            "16"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"class=%s\"",
            "str"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"%s\"",
            "err->message"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_string",
          "args": [
            "config",
            "\"General\"",
            "\"Class\"",
            "&err"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "main_opts.name"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"name=%s\"",
            "str"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"%s\"",
            "err->message"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_string",
          "args": [
            "config",
            "\"General\"",
            "\"Name\"",
            "&err"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "str"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"Invalid privacy option: %s\"",
            "str"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"privacy=%s\"",
            "str"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"%s\"",
            "err->message"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_string",
          "args": [
            "config",
            "\"General\"",
            "\"Privacy\"",
            "&err"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"pairto=%d\"",
            "val"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"%s\"",
            "err->message"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_integer",
          "args": [
            "config",
            "\"General\"",
            "\"PairableTimeout\"",
            "&err"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"pairable=%s\"",
            "boolean ? \"true\" : \"false\""
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"%s\"",
            "err->message"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_boolean",
          "args": [
            "config",
            "\"General\"",
            "\"AlwaysPairable\"",
            "&err"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"discovto=%d\"",
            "val"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_clear_error",
          "args": [
            "&err"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"%s\"",
            "err->message"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_integer",
          "args": [
            "config",
            "\"General\"",
            "\"DiscoverableTimeout\"",
            "&err"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"parsing %s\"",
            "main_conf_file_path"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_config",
          "args": [
            "config"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "check_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "223-253",
          "snippet": "static void check_config(GKeyFile *config)\n{\n\tchar **keys;\n\tint i;\n\tconst struct group_table *group;\n\n\tif (!config)\n\t\treturn;\n\n\tkeys = g_key_file_get_groups(config, NULL);\n\n\tfor (i = 0; keys != NULL && keys[i] != NULL; i++) {\n\t\tbool match = false;\n\n\t\tfor (group = valid_groups; group && group->name ; group++) {\n\t\t\tif (g_str_equal(keys[i], group->name)) {\n\t\t\t\tmatch = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!match)\n\t\t\twarn(\"Unknown group %s in %s\", keys[i],\n\t\t\t\t\t\tmain_conf_file_path);\n\t}\n\n\tg_strfreev(keys);\n\n\tfor (group = valid_groups; group && group->name; group++)\n\t\tcheck_options(config, group->name, group->options);\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *main_conf_file_path;",
            "static const struct group_table {\n\tconst char *name;\n\tconst char **options;\n} valid_groups[] = {\n\t{ \"General\",\tsupported_options },\n\t{ \"Policy\",\tpolicy_options },\n\t{ \"GATT\",\tgatt_options },\n\t{ }\n};",
            "static GOptionEntry options[] = {\n\t{ \"debug\", 'd', G_OPTION_FLAG_OPTIONAL_ARG,\n\t\t\t\tG_OPTION_ARG_CALLBACK, parse_debug,\n\t\t\t\t\"Specify debug options to enable\", \"DEBUG\" },\n\t{ \"plugin\", 'p', 0, G_OPTION_ARG_STRING, &option_plugin,\n\t\t\t\t\"Specify plugins to load\", \"NAME,..,\" },\n\t{ \"noplugin\", 'P', 0, G_OPTION_ARG_STRING, &option_noplugin,\n\t\t\t\t\"Specify plugins not to load\", \"NAME,...\" },\n\t{ \"configfile\", 'f', 0, G_OPTION_ARG_STRING, &option_configfile,\n\t\t\t\"Specify an explicit path to the config file\", \"FILE\"},\n\t{ \"compat\", 'C', 0, G_OPTION_ARG_NONE, &option_compat,\n\t\t\t\t\"Provide deprecated command line interfaces\" },\n\t{ \"experimental\", 'E', 0, G_OPTION_ARG_NONE, &option_experimental,\n\t\t\t\t\"Enable experimental interfaces\" },\n\t{ \"nodetach\", 'n', G_OPTION_FLAG_REVERSE,\n\t\t\t\tG_OPTION_ARG_NONE, &option_detach,\n\t\t\t\t\"Run with logging in foreground\" },\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ NULL },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic char *main_conf_file_path;\nstatic const struct group_table {\n\tconst char *name;\n\tconst char **options;\n} valid_groups[] = {\n\t{ \"General\",\tsupported_options },\n\t{ \"Policy\",\tpolicy_options },\n\t{ \"GATT\",\tgatt_options },\n\t{ }\n};\nstatic GOptionEntry options[] = {\n\t{ \"debug\", 'd', G_OPTION_FLAG_OPTIONAL_ARG,\n\t\t\t\tG_OPTION_ARG_CALLBACK, parse_debug,\n\t\t\t\t\"Specify debug options to enable\", \"DEBUG\" },\n\t{ \"plugin\", 'p', 0, G_OPTION_ARG_STRING, &option_plugin,\n\t\t\t\t\"Specify plugins to load\", \"NAME,..,\" },\n\t{ \"noplugin\", 'P', 0, G_OPTION_ARG_STRING, &option_noplugin,\n\t\t\t\t\"Specify plugins not to load\", \"NAME,...\" },\n\t{ \"configfile\", 'f', 0, G_OPTION_ARG_STRING, &option_configfile,\n\t\t\t\"Specify an explicit path to the config file\", \"FILE\"},\n\t{ \"compat\", 'C', 0, G_OPTION_ARG_NONE, &option_compat,\n\t\t\t\t\"Provide deprecated command line interfaces\" },\n\t{ \"experimental\", 'E', 0, G_OPTION_ARG_NONE, &option_experimental,\n\t\t\t\t\"Enable experimental interfaces\" },\n\t{ \"nodetach\", 'n', G_OPTION_FLAG_REVERSE,\n\t\t\t\tG_OPTION_ARG_NONE, &option_detach,\n\t\t\t\t\"Run with logging in foreground\" },\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ NULL },\n};\n\nstatic void check_config(GKeyFile *config)\n{\n\tchar **keys;\n\tint i;\n\tconst struct group_table *group;\n\n\tif (!config)\n\t\treturn;\n\n\tkeys = g_key_file_get_groups(config, NULL);\n\n\tfor (i = 0; keys != NULL && keys[i] != NULL; i++) {\n\t\tbool match = false;\n\n\t\tfor (group = valid_groups; group && group->name ; group++) {\n\t\t\tif (g_str_equal(keys[i], group->name)) {\n\t\t\t\tmatch = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!match)\n\t\t\twarn(\"Unknown group %s in %s\", keys[i],\n\t\t\t\t\t\tmain_conf_file_path);\n\t}\n\n\tg_strfreev(keys);\n\n\tfor (group = valid_groups; group && group->name; group++)\n\t\tcheck_options(config, group->name, group->options);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstruct main_opts main_opts;\nstatic char *main_conf_file_path;\nstatic enum {\n\tMPS_OFF,\n\tMPS_SINGLE,\n\tMPS_MULTIPLE,\n} mps = MPS_OFF;\n\nstatic void parse_config(GKeyFile *config)\n{\n\tGError *err = NULL;\n\tchar *str;\n\tint val;\n\tgboolean boolean;\n\n\tif (!config)\n\t\treturn;\n\n\tcheck_config(config);\n\n\tDBG(\"parsing %s\", main_conf_file_path);\n\n\tval = g_key_file_get_integer(config, \"General\",\n\t\t\t\t\t\t\"DiscoverableTimeout\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"discovto=%d\", val);\n\t\tmain_opts.discovto = val;\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"AlwaysPairable\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"pairable=%s\", boolean ? \"true\" : \"false\");\n\t\tmain_opts.pairable = boolean;\n\t}\n\n\tval = g_key_file_get_integer(config, \"General\",\n\t\t\t\t\t\t\"PairableTimeout\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"pairto=%d\", val);\n\t\tmain_opts.pairto = val;\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Privacy\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t\tmain_opts.privacy = 0x00;\n\t} else {\n\t\tDBG(\"privacy=%s\", str);\n\n\t\tif (!strcmp(str, \"device\"))\n\t\t\tmain_opts.privacy = 0x01;\n\t\telse if (!strcmp(str, \"off\"))\n\t\t\tmain_opts.privacy = 0x00;\n\t\telse {\n\t\t\tDBG(\"Invalid privacy option: %s\", str);\n\t\t\tmain_opts.privacy = 0x00;\n\t\t}\n\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Name\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"name=%s\", str);\n\t\tg_free(main_opts.name);\n\t\tmain_opts.name = str;\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"Class\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"class=%s\", str);\n\t\tmain_opts.class = strtol(str, NULL, 16);\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"DeviceID\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"deviceid=%s\", str);\n\t\tparse_did(str);\n\t\tg_free(str);\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"ReverseServiceDiscovery\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else\n\t\tmain_opts.reverse_sdp = boolean;\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"NameResolving\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.name_resolv = boolean;\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"DebugKeys\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.debug_keys = boolean;\n\n\tstr = g_key_file_get_string(config, \"General\", \"ControllerMode\", &err);\n\tif (err) {\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"ControllerMode=%s\", str);\n\t\tmain_opts.mode = get_mode(str);\n\t\tg_free(str);\n\t}\n\n\tstr = g_key_file_get_string(config, \"General\", \"MultiProfile\", &err);\n\tif (err) {\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"MultiProfile=%s\", str);\n\n\t\tif (!strcmp(str, \"single\"))\n\t\t\tmps = MPS_SINGLE;\n\t\telse if (!strcmp(str, \"multiple\"))\n\t\t\tmps = MPS_MULTIPLE;\n\n\t\tg_free(str);\n\t}\n\n\tboolean = g_key_file_get_boolean(config, \"General\",\n\t\t\t\t\t\t\"FastConnectable\", &err);\n\tif (err)\n\t\tg_clear_error(&err);\n\telse\n\t\tmain_opts.fast_conn = boolean;\n\n\tstr = g_key_file_get_string(config, \"GATT\", \"Cache\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tmain_opts.gatt_cache = parse_gatt_cache(str);\n\t\tg_free(str);\n\t}\n\n\tval = g_key_file_get_integer(config, \"GATT\", \"KeySize\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\tDBG(\"KeySize=%d\", val);\n\n\t\tif (val >=7 && val <= 16)\n\t\t\tmain_opts.key_size = val;\n\t}\n\n\tval = g_key_file_get_integer(config, \"GATT\", \"ExchangeMTU\", &err);\n\tif (err) {\n\t\tDBG(\"%s\", err->message);\n\t\tg_clear_error(&err);\n\t} else {\n\t\t/* Ensure the mtu is within a valid range. */\n\t\tval = MIN(val, BT_ATT_MAX_LE_MTU);\n\t\tval = MAX(val, BT_ATT_DEFAULT_LE_MTU);\n\t\tDBG(\"ExchangeMTU=%d\", val);\n\t\tmain_opts.gatt_mtu = val;\n\t}\n}"
  },
  {
    "function_name": "get_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "255-267",
    "snippet": "static int get_mode(const char *str)\n{\n\tif (strcmp(str, \"dual\") == 0)\n\t\treturn BT_MODE_DUAL;\n\telse if (strcmp(str, \"bredr\") == 0)\n\t\treturn BT_MODE_BREDR;\n\telse if (strcmp(str, \"le\") == 0)\n\t\treturn BT_MODE_LE;\n\n\terror(\"Unknown controller mode \\\"%s\\\"\", str);\n\n\treturn BT_MODE_DUAL;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Unknown controller mode \\\"%s\\\"\"",
            "str"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "btd_error_failed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/error.c",
          "lines": "124-128",
          "snippet": "DBusMessage *btd_error_failed(DBusMessage *msg, const char *str)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE\n\t\t\t\t\t\".Failed\", \"%s\", str);\n}",
          "includes": [
            "#include \"error.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"error.h\"\n#include \"gdbus/gdbus.h\"\n#include <config.h>\n\nDBusMessage *btd_error_failed(DBusMessage *msg, const char *str)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE\n\t\t\t\t\t\".Failed\", \"%s\", str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "\"le\""
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "g_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/adapter.c",
          "lines": "1927-1930",
          "snippet": "static gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"advertising.h\"",
            "#include \"gatt-database.h\"",
            "#include \"attrib-server.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"storage.h\"",
            "#include \"agent.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/mgmt.h\"",
            "#include \"textfile.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"bluetooth/sdp_lib.h\"",
            "#include \"bluetooth/sdp.h\"",
            "#include \"bluetooth/hci_lib.h\"",
            "#include \"bluetooth/hci.h\"",
            "#include \"bluetooth/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <sys/ioctl.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <inttypes.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"advertising.h\"\n#include \"gatt-database.h\"\n#include \"attrib-server.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"storage.h\"\n#include \"agent.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/mgmt.h\"\n#include \"textfile.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/mgmt.h\"\n#include \"lib/uuid.h\"\n#include \"bluetooth/sdp_lib.h\"\n#include \"bluetooth/sdp.h\"\n#include \"bluetooth/hci_lib.h\"\n#include \"bluetooth/hci.h\"\n#include \"bluetooth/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <sys/ioctl.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <inttypes.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic int get_mode(const char *str)\n{\n\tif (strcmp(str, \"dual\") == 0)\n\t\treturn BT_MODE_DUAL;\n\telse if (strcmp(str, \"bredr\") == 0)\n\t\treturn BT_MODE_BREDR;\n\telse if (strcmp(str, \"le\") == 0)\n\t\treturn BT_MODE_LE;\n\n\terror(\"Unknown controller mode \\\"%s\\\"\", str);\n\n\treturn BT_MODE_DUAL;\n}"
  },
  {
    "function_name": "check_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "223-253",
    "snippet": "static void check_config(GKeyFile *config)\n{\n\tchar **keys;\n\tint i;\n\tconst struct group_table *group;\n\n\tif (!config)\n\t\treturn;\n\n\tkeys = g_key_file_get_groups(config, NULL);\n\n\tfor (i = 0; keys != NULL && keys[i] != NULL; i++) {\n\t\tbool match = false;\n\n\t\tfor (group = valid_groups; group && group->name ; group++) {\n\t\t\tif (g_str_equal(keys[i], group->name)) {\n\t\t\t\tmatch = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!match)\n\t\t\twarn(\"Unknown group %s in %s\", keys[i],\n\t\t\t\t\t\tmain_conf_file_path);\n\t}\n\n\tg_strfreev(keys);\n\n\tfor (group = valid_groups; group && group->name; group++)\n\t\tcheck_options(config, group->name, group->options);\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *main_conf_file_path;",
      "static const struct group_table {\n\tconst char *name;\n\tconst char **options;\n} valid_groups[] = {\n\t{ \"General\",\tsupported_options },\n\t{ \"Policy\",\tpolicy_options },\n\t{ \"GATT\",\tgatt_options },\n\t{ }\n};",
      "static GOptionEntry options[] = {\n\t{ \"debug\", 'd', G_OPTION_FLAG_OPTIONAL_ARG,\n\t\t\t\tG_OPTION_ARG_CALLBACK, parse_debug,\n\t\t\t\t\"Specify debug options to enable\", \"DEBUG\" },\n\t{ \"plugin\", 'p', 0, G_OPTION_ARG_STRING, &option_plugin,\n\t\t\t\t\"Specify plugins to load\", \"NAME,..,\" },\n\t{ \"noplugin\", 'P', 0, G_OPTION_ARG_STRING, &option_noplugin,\n\t\t\t\t\"Specify plugins not to load\", \"NAME,...\" },\n\t{ \"configfile\", 'f', 0, G_OPTION_ARG_STRING, &option_configfile,\n\t\t\t\"Specify an explicit path to the config file\", \"FILE\"},\n\t{ \"compat\", 'C', 0, G_OPTION_ARG_NONE, &option_compat,\n\t\t\t\t\"Provide deprecated command line interfaces\" },\n\t{ \"experimental\", 'E', 0, G_OPTION_ARG_NONE, &option_experimental,\n\t\t\t\t\"Enable experimental interfaces\" },\n\t{ \"nodetach\", 'n', G_OPTION_FLAG_REVERSE,\n\t\t\t\tG_OPTION_ARG_NONE, &option_detach,\n\t\t\t\t\"Run with logging in foreground\" },\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ NULL },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "check_options",
          "args": [
            "config",
            "group->name",
            "group->options"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "check_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
          "lines": "195-221",
          "snippet": "static void check_options(GKeyFile *config, const char *group,\n\t\t\t\t\t\tconst char **options)\n{\n\tchar **keys;\n\tint i;\n\n\tkeys = g_key_file_get_keys(config, group, NULL, NULL);\n\n\tfor (i = 0; keys != NULL && keys[i] != NULL; i++) {\n\t\tbool found;\n\t\tunsigned int j;\n\n\t\tfound = false;\n\t\tfor (j = 0; options != NULL && options[j] != NULL; j++) {\n\t\t\tif (g_str_equal(keys[i], options[j])) {\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!found)\n\t\t\twarn(\"Unknown key %s for group %s in %s\",\n\t\t\t\t\tkeys[i], group, main_conf_file_path);\n\t}\n\n\tg_strfreev(keys);\n}",
          "includes": [
            "#include \"systemd.h\"",
            "#include \"profile.h\"",
            "#include \"agent.h\"",
            "#include \"dbus-common.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"shared/att-types.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/signalfd.h>",
            "#include <stdbool.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *main_conf_file_path;",
            "static GOptionEntry options[] = {\n\t{ \"debug\", 'd', G_OPTION_FLAG_OPTIONAL_ARG,\n\t\t\t\tG_OPTION_ARG_CALLBACK, parse_debug,\n\t\t\t\t\"Specify debug options to enable\", \"DEBUG\" },\n\t{ \"plugin\", 'p', 0, G_OPTION_ARG_STRING, &option_plugin,\n\t\t\t\t\"Specify plugins to load\", \"NAME,..,\" },\n\t{ \"noplugin\", 'P', 0, G_OPTION_ARG_STRING, &option_noplugin,\n\t\t\t\t\"Specify plugins not to load\", \"NAME,...\" },\n\t{ \"configfile\", 'f', 0, G_OPTION_ARG_STRING, &option_configfile,\n\t\t\t\"Specify an explicit path to the config file\", \"FILE\"},\n\t{ \"compat\", 'C', 0, G_OPTION_ARG_NONE, &option_compat,\n\t\t\t\t\"Provide deprecated command line interfaces\" },\n\t{ \"experimental\", 'E', 0, G_OPTION_ARG_NONE, &option_experimental,\n\t\t\t\t\"Enable experimental interfaces\" },\n\t{ \"nodetach\", 'n', G_OPTION_FLAG_REVERSE,\n\t\t\t\tG_OPTION_ARG_NONE, &option_detach,\n\t\t\t\t\"Run with logging in foreground\" },\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ NULL },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic char *main_conf_file_path;\nstatic GOptionEntry options[] = {\n\t{ \"debug\", 'd', G_OPTION_FLAG_OPTIONAL_ARG,\n\t\t\t\tG_OPTION_ARG_CALLBACK, parse_debug,\n\t\t\t\t\"Specify debug options to enable\", \"DEBUG\" },\n\t{ \"plugin\", 'p', 0, G_OPTION_ARG_STRING, &option_plugin,\n\t\t\t\t\"Specify plugins to load\", \"NAME,..,\" },\n\t{ \"noplugin\", 'P', 0, G_OPTION_ARG_STRING, &option_noplugin,\n\t\t\t\t\"Specify plugins not to load\", \"NAME,...\" },\n\t{ \"configfile\", 'f', 0, G_OPTION_ARG_STRING, &option_configfile,\n\t\t\t\"Specify an explicit path to the config file\", \"FILE\"},\n\t{ \"compat\", 'C', 0, G_OPTION_ARG_NONE, &option_compat,\n\t\t\t\t\"Provide deprecated command line interfaces\" },\n\t{ \"experimental\", 'E', 0, G_OPTION_ARG_NONE, &option_experimental,\n\t\t\t\t\"Enable experimental interfaces\" },\n\t{ \"nodetach\", 'n', G_OPTION_FLAG_REVERSE,\n\t\t\t\tG_OPTION_ARG_NONE, &option_detach,\n\t\t\t\t\"Run with logging in foreground\" },\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ NULL },\n};\n\nstatic void check_options(GKeyFile *config, const char *group,\n\t\t\t\t\t\tconst char **options)\n{\n\tchar **keys;\n\tint i;\n\n\tkeys = g_key_file_get_keys(config, group, NULL, NULL);\n\n\tfor (i = 0; keys != NULL && keys[i] != NULL; i++) {\n\t\tbool found;\n\t\tunsigned int j;\n\n\t\tfound = false;\n\t\tfor (j = 0; options != NULL && options[j] != NULL; j++) {\n\t\t\tif (g_str_equal(keys[i], options[j])) {\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!found)\n\t\t\twarn(\"Unknown key %s for group %s in %s\",\n\t\t\t\t\tkeys[i], group, main_conf_file_path);\n\t}\n\n\tg_strfreev(keys);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strfreev",
          "args": [
            "keys"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "warn",
          "args": [
            "\"Unknown group %s in %s\"",
            "keys[i]",
            "main_conf_file_path"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "btd_warn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "215-229",
          "snippet": "void btd_warn(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_WARNING, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_WARNING, format, ap);\n\tva_end(ap);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_warn(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_WARNING, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_WARNING, format, ap);\n\tva_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_str_equal",
          "args": [
            "keys[i]",
            "group->name"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_groups",
          "args": [
            "config",
            "NULL"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic char *main_conf_file_path;\nstatic const struct group_table {\n\tconst char *name;\n\tconst char **options;\n} valid_groups[] = {\n\t{ \"General\",\tsupported_options },\n\t{ \"Policy\",\tpolicy_options },\n\t{ \"GATT\",\tgatt_options },\n\t{ }\n};\nstatic GOptionEntry options[] = {\n\t{ \"debug\", 'd', G_OPTION_FLAG_OPTIONAL_ARG,\n\t\t\t\tG_OPTION_ARG_CALLBACK, parse_debug,\n\t\t\t\t\"Specify debug options to enable\", \"DEBUG\" },\n\t{ \"plugin\", 'p', 0, G_OPTION_ARG_STRING, &option_plugin,\n\t\t\t\t\"Specify plugins to load\", \"NAME,..,\" },\n\t{ \"noplugin\", 'P', 0, G_OPTION_ARG_STRING, &option_noplugin,\n\t\t\t\t\"Specify plugins not to load\", \"NAME,...\" },\n\t{ \"configfile\", 'f', 0, G_OPTION_ARG_STRING, &option_configfile,\n\t\t\t\"Specify an explicit path to the config file\", \"FILE\"},\n\t{ \"compat\", 'C', 0, G_OPTION_ARG_NONE, &option_compat,\n\t\t\t\t\"Provide deprecated command line interfaces\" },\n\t{ \"experimental\", 'E', 0, G_OPTION_ARG_NONE, &option_experimental,\n\t\t\t\t\"Enable experimental interfaces\" },\n\t{ \"nodetach\", 'n', G_OPTION_FLAG_REVERSE,\n\t\t\t\tG_OPTION_ARG_NONE, &option_detach,\n\t\t\t\t\"Run with logging in foreground\" },\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ NULL },\n};\n\nstatic void check_config(GKeyFile *config)\n{\n\tchar **keys;\n\tint i;\n\tconst struct group_table *group;\n\n\tif (!config)\n\t\treturn;\n\n\tkeys = g_key_file_get_groups(config, NULL);\n\n\tfor (i = 0; keys != NULL && keys[i] != NULL; i++) {\n\t\tbool match = false;\n\n\t\tfor (group = valid_groups; group && group->name ; group++) {\n\t\t\tif (g_str_equal(keys[i], group->name)) {\n\t\t\t\tmatch = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!match)\n\t\t\twarn(\"Unknown group %s in %s\", keys[i],\n\t\t\t\t\t\tmain_conf_file_path);\n\t}\n\n\tg_strfreev(keys);\n\n\tfor (group = valid_groups; group && group->name; group++)\n\t\tcheck_options(config, group->name, group->options);\n}"
  },
  {
    "function_name": "check_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "195-221",
    "snippet": "static void check_options(GKeyFile *config, const char *group,\n\t\t\t\t\t\tconst char **options)\n{\n\tchar **keys;\n\tint i;\n\n\tkeys = g_key_file_get_keys(config, group, NULL, NULL);\n\n\tfor (i = 0; keys != NULL && keys[i] != NULL; i++) {\n\t\tbool found;\n\t\tunsigned int j;\n\n\t\tfound = false;\n\t\tfor (j = 0; options != NULL && options[j] != NULL; j++) {\n\t\t\tif (g_str_equal(keys[i], options[j])) {\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!found)\n\t\t\twarn(\"Unknown key %s for group %s in %s\",\n\t\t\t\t\tkeys[i], group, main_conf_file_path);\n\t}\n\n\tg_strfreev(keys);\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *main_conf_file_path;",
      "static GOptionEntry options[] = {\n\t{ \"debug\", 'd', G_OPTION_FLAG_OPTIONAL_ARG,\n\t\t\t\tG_OPTION_ARG_CALLBACK, parse_debug,\n\t\t\t\t\"Specify debug options to enable\", \"DEBUG\" },\n\t{ \"plugin\", 'p', 0, G_OPTION_ARG_STRING, &option_plugin,\n\t\t\t\t\"Specify plugins to load\", \"NAME,..,\" },\n\t{ \"noplugin\", 'P', 0, G_OPTION_ARG_STRING, &option_noplugin,\n\t\t\t\t\"Specify plugins not to load\", \"NAME,...\" },\n\t{ \"configfile\", 'f', 0, G_OPTION_ARG_STRING, &option_configfile,\n\t\t\t\"Specify an explicit path to the config file\", \"FILE\"},\n\t{ \"compat\", 'C', 0, G_OPTION_ARG_NONE, &option_compat,\n\t\t\t\t\"Provide deprecated command line interfaces\" },\n\t{ \"experimental\", 'E', 0, G_OPTION_ARG_NONE, &option_experimental,\n\t\t\t\t\"Enable experimental interfaces\" },\n\t{ \"nodetach\", 'n', G_OPTION_FLAG_REVERSE,\n\t\t\t\tG_OPTION_ARG_NONE, &option_detach,\n\t\t\t\t\"Run with logging in foreground\" },\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ NULL },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strfreev",
          "args": [
            "keys"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "warn",
          "args": [
            "\"Unknown key %s for group %s in %s\"",
            "keys[i]",
            "group",
            "main_conf_file_path"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "btd_warn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "215-229",
          "snippet": "void btd_warn(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_WARNING, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_WARNING, format, ap);\n\tva_end(ap);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_warn(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_WARNING, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_WARNING, format, ap);\n\tva_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_str_equal",
          "args": [
            "keys[i]",
            "options[j]"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_get_keys",
          "args": [
            "config",
            "group",
            "NULL",
            "NULL"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic char *main_conf_file_path;\nstatic GOptionEntry options[] = {\n\t{ \"debug\", 'd', G_OPTION_FLAG_OPTIONAL_ARG,\n\t\t\t\tG_OPTION_ARG_CALLBACK, parse_debug,\n\t\t\t\t\"Specify debug options to enable\", \"DEBUG\" },\n\t{ \"plugin\", 'p', 0, G_OPTION_ARG_STRING, &option_plugin,\n\t\t\t\t\"Specify plugins to load\", \"NAME,..,\" },\n\t{ \"noplugin\", 'P', 0, G_OPTION_ARG_STRING, &option_noplugin,\n\t\t\t\t\"Specify plugins not to load\", \"NAME,...\" },\n\t{ \"configfile\", 'f', 0, G_OPTION_ARG_STRING, &option_configfile,\n\t\t\t\"Specify an explicit path to the config file\", \"FILE\"},\n\t{ \"compat\", 'C', 0, G_OPTION_ARG_NONE, &option_compat,\n\t\t\t\t\"Provide deprecated command line interfaces\" },\n\t{ \"experimental\", 'E', 0, G_OPTION_ARG_NONE, &option_experimental,\n\t\t\t\t\"Enable experimental interfaces\" },\n\t{ \"nodetach\", 'n', G_OPTION_FLAG_REVERSE,\n\t\t\t\tG_OPTION_ARG_NONE, &option_detach,\n\t\t\t\t\"Run with logging in foreground\" },\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ NULL },\n};\n\nstatic void check_options(GKeyFile *config, const char *group,\n\t\t\t\t\t\tconst char **options)\n{\n\tchar **keys;\n\tint i;\n\n\tkeys = g_key_file_get_keys(config, group, NULL, NULL);\n\n\tfor (i = 0; keys != NULL && keys[i] != NULL; i++) {\n\t\tbool found;\n\t\tunsigned int j;\n\n\t\tfound = false;\n\t\tfor (j = 0; options != NULL && options[j] != NULL; j++) {\n\t\t\tif (g_str_equal(keys[i], options[j])) {\n\t\t\t\tfound = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!found)\n\t\t\twarn(\"Unknown key %s for group %s in %s\",\n\t\t\t\t\tkeys[i], group, main_conf_file_path);\n\t}\n\n\tg_strfreev(keys);\n}"
  },
  {
    "function_name": "parse_gatt_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "181-193",
    "snippet": "static bt_gatt_cache_t parse_gatt_cache(const char *cache)\n{\n\tif (!strcmp(cache, \"always\")) {\n\t\treturn BT_GATT_CACHE_ALWAYS;\n\t} else if (!strcmp(cache, \"yes\")) {\n\t\treturn BT_GATT_CACHE_YES;\n\t} else if (!strcmp(cache, \"no\")) {\n\t\treturn BT_GATT_CACHE_NO;\n\t} else {\n\t\tDBG(\"Invalid value for KeepCache=%s\", cache);\n\t\treturn BT_GATT_CACHE_ALWAYS;\n\t}\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"Invalid value for KeepCache=%s\"",
            "cache"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "cache",
            "\"no\""
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "g_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/adapter.c",
          "lines": "1927-1930",
          "snippet": "static gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"advertising.h\"",
            "#include \"gatt-database.h\"",
            "#include \"attrib-server.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"storage.h\"",
            "#include \"agent.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/mgmt.h\"",
            "#include \"textfile.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"bluetooth/sdp_lib.h\"",
            "#include \"bluetooth/sdp.h\"",
            "#include \"bluetooth/hci_lib.h\"",
            "#include \"bluetooth/hci.h\"",
            "#include \"bluetooth/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <sys/ioctl.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <inttypes.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"advertising.h\"\n#include \"gatt-database.h\"\n#include \"attrib-server.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"storage.h\"\n#include \"agent.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/mgmt.h\"\n#include \"textfile.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/mgmt.h\"\n#include \"lib/uuid.h\"\n#include \"bluetooth/sdp_lib.h\"\n#include \"bluetooth/sdp.h\"\n#include \"bluetooth/hci_lib.h\"\n#include \"bluetooth/hci.h\"\n#include \"bluetooth/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <sys/ioctl.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <inttypes.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic bt_gatt_cache_t parse_gatt_cache(const char *cache)\n{\n\tif (!strcmp(cache, \"always\")) {\n\t\treturn BT_GATT_CACHE_ALWAYS;\n\t} else if (!strcmp(cache, \"yes\")) {\n\t\treturn BT_GATT_CACHE_YES;\n\t} else if (!strcmp(cache, \"no\")) {\n\t\treturn BT_GATT_CACHE_NO;\n\t} else {\n\t\tDBG(\"Invalid value for KeepCache=%s\", cache);\n\t\treturn BT_GATT_CACHE_ALWAYS;\n\t}\n}"
  },
  {
    "function_name": "parse_did",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "149-179",
    "snippet": "static void parse_did(const char *did)\n{\n\tint result;\n\tuint16_t vendor, product, version , source;\n\n\t/* version and source are optional */\n\tversion = 0x0000;\n\tsource = 0x0002;\n\n\tresult = sscanf(did, \"bluetooth:%4hx:%4hx:%4hx\",\n\t\t\t\t\t&vendor, &product, &version);\n\tif (result != EOF && result >= 2) {\n\t\tsource = 0x0001;\n\t\tgoto done;\n\t}\n\n\tresult = sscanf(did, \"usb:%4hx:%4hx:%4hx\",\n\t\t\t\t\t&vendor, &product, &version);\n\tif (result != EOF && result >= 2)\n\t\tgoto done;\n\n\tresult = sscanf(did, \"%4hx:%4hx:%4hx\", &vendor, &product, &version);\n\tif (result == EOF || result < 2)\n\t\treturn;\n\ndone:\n\tmain_opts.did_source = source;\n\tmain_opts.did_vendor = vendor;\n\tmain_opts.did_product = product;\n\tmain_opts.did_version = version;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct main_opts main_opts;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "did",
            "\"%4hx:%4hx:%4hx\"",
            "&vendor",
            "&product",
            "&version"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "did",
            "\"usb:%4hx:%4hx:%4hx\"",
            "&vendor",
            "&product",
            "&version"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "did",
            "\"bluetooth:%4hx:%4hx:%4hx\"",
            "&vendor",
            "&product",
            "&version"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstruct main_opts main_opts;\n\nstatic void parse_did(const char *did)\n{\n\tint result;\n\tuint16_t vendor, product, version , source;\n\n\t/* version and source are optional */\n\tversion = 0x0000;\n\tsource = 0x0002;\n\n\tresult = sscanf(did, \"bluetooth:%4hx:%4hx:%4hx\",\n\t\t\t\t\t&vendor, &product, &version);\n\tif (result != EOF && result >= 2) {\n\t\tsource = 0x0001;\n\t\tgoto done;\n\t}\n\n\tresult = sscanf(did, \"usb:%4hx:%4hx:%4hx\",\n\t\t\t\t\t&vendor, &product, &version);\n\tif (result != EOF && result >= 2)\n\t\tgoto done;\n\n\tresult = sscanf(did, \"%4hx:%4hx:%4hx\", &vendor, &product, &version);\n\tif (result == EOF || result < 2)\n\t\treturn;\n\ndone:\n\tmain_opts.did_source = source;\n\tmain_opts.did_vendor = vendor;\n\tmain_opts.did_product = product;\n\tmain_opts.did_version = version;\n}"
  },
  {
    "function_name": "load_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "129-147",
    "snippet": "static GKeyFile *load_config(const char *file)\n{\n\tGError *err = NULL;\n\tGKeyFile *keyfile;\n\n\tkeyfile = g_key_file_new();\n\n\tg_key_file_set_list_separator(keyfile, ',');\n\n\tif (!g_key_file_load_from_file(keyfile, file, 0, &err)) {\n\t\tif (!g_error_matches(err, G_FILE_ERROR, G_FILE_ERROR_NOENT))\n\t\t\terror(\"Parsing %s failed: %s\", file, err->message);\n\t\tg_error_free(err);\n\t\tg_key_file_free(keyfile);\n\t\treturn NULL;\n\t}\n\n\treturn keyfile;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_key_file_free",
          "args": [
            "keyfile"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_error_free",
          "args": [
            "err"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Parsing %s failed: %s\"",
            "file",
            "err->message"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "btd_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "199-213",
          "snippet": "void btd_error(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_ERR, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_ERR, format, ap);\n\tva_end(ap);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_error(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_ERR, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_ERR, format, ap);\n\tva_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_error_matches",
          "args": [
            "err",
            "G_FILE_ERROR",
            "G_FILE_ERROR_NOENT"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_load_from_file",
          "args": [
            "keyfile",
            "file",
            "0",
            "&err"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_set_list_separator",
          "args": [
            "keyfile",
            "','"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_key_file_new",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic GKeyFile *load_config(const char *file)\n{\n\tGError *err = NULL;\n\tGKeyFile *keyfile;\n\n\tkeyfile = g_key_file_new();\n\n\tg_key_file_set_list_separator(keyfile, ',');\n\n\tif (!g_key_file_load_from_file(keyfile, file, 0, &err)) {\n\t\tif (!g_error_matches(err, G_FILE_ERROR, G_FILE_ERROR_NOENT))\n\t\t\terror(\"Parsing %s failed: %s\", file, err->message);\n\t\tg_error_free(err);\n\t\tg_key_file_free(keyfile);\n\t\treturn NULL;\n\t}\n\n\treturn keyfile;\n}"
  },
  {
    "function_name": "btd_get_main_conf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/main.c",
    "lines": "124-127",
    "snippet": "GKeyFile *btd_get_main_conf(void)\n{\n\treturn main_conf;\n}",
    "includes": [
      "#include \"systemd.h\"",
      "#include \"profile.h\"",
      "#include \"agent.h\"",
      "#include \"dbus-common.h\"",
      "#include \"device.h\"",
      "#include \"adapter.h\"",
      "#include \"sdpd.h\"",
      "#include \"hcid.h\"",
      "#include \"lib/uuid.h\"",
      "#include \"shared/att-types.h\"",
      "#include \"backtrace.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <sys/signalfd.h>",
      "#include <stdbool.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GKeyFile *main_conf;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"systemd.h\"\n#include \"profile.h\"\n#include \"agent.h\"\n#include \"dbus-common.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"lib/uuid.h\"\n#include \"shared/att-types.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/signalfd.h>\n#include <stdbool.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <errno.h>\n#include <config.h>\n\nstatic GKeyFile *main_conf;\n\nGKeyFile *btd_get_main_conf(void)\n{\n\treturn main_conf;\n}"
  }
]