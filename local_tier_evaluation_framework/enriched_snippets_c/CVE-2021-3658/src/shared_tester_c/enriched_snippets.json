[
  {
    "function_name": "tester_run",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "814-841",
    "snippet": "int tester_run(void)\n{\n\tguint signal;\n\tint ret;\n\n\tif (!main_loop)\n\t\treturn EXIT_FAILURE;\n\n\tif (option_list) {\n\t\tg_main_loop_unref(main_loop);\n\t\treturn EXIT_SUCCESS;\n\t}\n\n\tsignal = setup_signalfd();\n\n\tg_idle_add(start_tester, NULL);\n\tg_main_loop_run(main_loop);\n\n\tg_source_remove(signal);\n\n\tg_main_loop_unref(main_loop);\n\n\tret = tester_summarize();\n\n\tg_list_free_full(test_list, test_destroy);\n\n\treturn ret == 0 ? EXIT_SUCCESS : EXIT_FAILURE;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GMainLoop *main_loop;",
      "static GList *test_list;",
      "static gboolean option_list = FALSE;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_list_free_full",
          "args": [
            "test_list",
            "test_destroy"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tester_summarize",
          "args": [],
          "line": 836
        },
        "resolved": true,
        "details": {
          "function_name": "tester_summarize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "275-328",
          "snippet": "static int tester_summarize(void)\n{\n\tunsigned int not_run = 0, passed = 0, failed = 0;\n\tgdouble execution_time;\n\tGList *list;\n\n\tprintf(\"\\n\");\n\tprint_text(COLOR_HIGHLIGHT, \"\");\n\tprint_text(COLOR_HIGHLIGHT, \"Test Summary\");\n\tprint_text(COLOR_HIGHLIGHT, \"------------\");\n\n\tfor (list = g_list_first(test_list); list; list = g_list_next(list)) {\n\t\tstruct test_case *test = list->data;\n\t\tgdouble exec_time;\n\n\t\texec_time = test->end_time - test->start_time;\n\n\t\tswitch (test->result) {\n\t\tcase TEST_RESULT_NOT_RUN:\n\t\t\tprint_summary(test->name, COLOR_YELLOW, \"Not Run\", \"\");\n\t\t\tnot_run++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_PASSED:\n\t\t\tprint_summary(test->name, COLOR_GREEN, \"Passed\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tpassed++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_FAILED:\n\t\t\tprint_summary(test->name, COLOR_RED, \"Failed\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tfailed++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_TIMED_OUT:\n\t\t\tprint_summary(test->name, COLOR_RED, \"Timed out\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tfailed++;\n\t\t\tbreak;\n\t\t}\n        }\n\n\tprintf(\"\\nTotal: %d, \"\n\t\tCOLOR_GREEN \"Passed: %d (%.1f%%)\" COLOR_OFF \", \"\n\t\tCOLOR_RED \"Failed: %d\" COLOR_OFF \", \"\n\t\tCOLOR_YELLOW \"Not Run: %d\" COLOR_OFF \"\\n\",\n\t\t\tnot_run + passed + failed, passed,\n\t\t\t(not_run + passed + failed) ?\n\t\t\t(float) passed * 100 / (not_run + passed + failed) : 0,\n\t\t\tfailed, not_run);\n\n\texecution_time = g_timer_elapsed(test_timer, NULL);\n\tprintf(\"Overall execution time: %.3g seconds\\n\", execution_time);\n\n\treturn failed;\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define COLOR_HIGHLIGHT\t\"\\x1B[1;39m\"",
            "#define COLOR_YELLOW\t\"\\x1B[0;33m\"",
            "#define COLOR_GREEN\t\"\\x1B[0;32m\"",
            "#define COLOR_RED\t\"\\x1B[0;31m\"",
            "#define COLOR_OFF\t\"\\x1B[0m\""
          ],
          "globals_used": [
            "static GList *test_list;",
            "static GTimer *test_timer;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_HIGHLIGHT\t\"\\x1B[1;39m\"\n#define COLOR_YELLOW\t\"\\x1B[0;33m\"\n#define COLOR_GREEN\t\"\\x1B[0;32m\"\n#define COLOR_RED\t\"\\x1B[0;31m\"\n#define COLOR_OFF\t\"\\x1B[0m\"\n\nstatic GList *test_list;\nstatic GTimer *test_timer;\n\nstatic int tester_summarize(void)\n{\n\tunsigned int not_run = 0, passed = 0, failed = 0;\n\tgdouble execution_time;\n\tGList *list;\n\n\tprintf(\"\\n\");\n\tprint_text(COLOR_HIGHLIGHT, \"\");\n\tprint_text(COLOR_HIGHLIGHT, \"Test Summary\");\n\tprint_text(COLOR_HIGHLIGHT, \"------------\");\n\n\tfor (list = g_list_first(test_list); list; list = g_list_next(list)) {\n\t\tstruct test_case *test = list->data;\n\t\tgdouble exec_time;\n\n\t\texec_time = test->end_time - test->start_time;\n\n\t\tswitch (test->result) {\n\t\tcase TEST_RESULT_NOT_RUN:\n\t\t\tprint_summary(test->name, COLOR_YELLOW, \"Not Run\", \"\");\n\t\t\tnot_run++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_PASSED:\n\t\t\tprint_summary(test->name, COLOR_GREEN, \"Passed\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tpassed++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_FAILED:\n\t\t\tprint_summary(test->name, COLOR_RED, \"Failed\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tfailed++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_TIMED_OUT:\n\t\t\tprint_summary(test->name, COLOR_RED, \"Timed out\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tfailed++;\n\t\t\tbreak;\n\t\t}\n        }\n\n\tprintf(\"\\nTotal: %d, \"\n\t\tCOLOR_GREEN \"Passed: %d (%.1f%%)\" COLOR_OFF \", \"\n\t\tCOLOR_RED \"Failed: %d\" COLOR_OFF \", \"\n\t\tCOLOR_YELLOW \"Not Run: %d\" COLOR_OFF \"\\n\",\n\t\t\tnot_run + passed + failed, passed,\n\t\t\t(not_run + passed + failed) ?\n\t\t\t(float) passed * 100 / (not_run + passed + failed) : 0,\n\t\t\tfailed, not_run);\n\n\texecution_time = g_timer_elapsed(test_timer, NULL);\n\tprintf(\"Overall execution time: %.3g seconds\\n\", execution_time);\n\n\treturn failed;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_main_loop_unref",
          "args": [
            "main_loop"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_source_remove",
          "args": [
            "signal"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_main_loop_run",
          "args": [
            "main_loop"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_idle_add",
          "args": [
            "start_tester",
            "NULL"
          ],
          "line": 829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup_signalfd",
          "args": [],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "setup_signalfd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "723-758",
          "snippet": "static guint setup_signalfd(void)\n{\n\tGIOChannel *channel;\n\tguint source;\n\tsigset_t mask;\n\tint fd;\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGTERM);\n\n\tif (sigprocmask(SIG_BLOCK, &mask, NULL) < 0) {\n\t\tperror(\"Failed to set signal mask\");\n\t\treturn 0;\n\t}\n\n\tfd = signalfd(-1, &mask, 0);\n\tif (fd < 0) {\n\t\tperror(\"Failed to create signal descriptor\");\n\t\treturn 0;\n\t}\n\n\tchannel = g_io_channel_unix_new(fd);\n\n\tg_io_channel_set_close_on_unref(channel, TRUE);\n\tg_io_channel_set_encoding(channel, NULL, NULL);\n\tg_io_channel_set_buffered(channel, FALSE);\n\n\tsource = g_io_add_watch(channel,\n\t\t\t\tG_IO_IN | G_IO_HUP | G_IO_ERR | G_IO_NVAL,\n\t\t\t\tsignal_handler, NULL);\n\n\tg_io_channel_unref(channel);\n\n\treturn source;\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic guint setup_signalfd(void)\n{\n\tGIOChannel *channel;\n\tguint source;\n\tsigset_t mask;\n\tint fd;\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGTERM);\n\n\tif (sigprocmask(SIG_BLOCK, &mask, NULL) < 0) {\n\t\tperror(\"Failed to set signal mask\");\n\t\treturn 0;\n\t}\n\n\tfd = signalfd(-1, &mask, 0);\n\tif (fd < 0) {\n\t\tperror(\"Failed to create signal descriptor\");\n\t\treturn 0;\n\t}\n\n\tchannel = g_io_channel_unix_new(fd);\n\n\tg_io_channel_set_close_on_unref(channel, TRUE);\n\tg_io_channel_set_encoding(channel, NULL, NULL);\n\tg_io_channel_set_buffered(channel, FALSE);\n\n\tsource = g_io_add_watch(channel,\n\t\t\t\tG_IO_IN | G_IO_HUP | G_IO_ERR | G_IO_NVAL,\n\t\t\t\tsignal_handler, NULL);\n\n\tg_io_channel_unref(channel);\n\n\treturn source;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_main_loop_unref",
          "args": [
            "main_loop"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GMainLoop *main_loop;\nstatic GList *test_list;\nstatic gboolean option_list = FALSE;\n\nint tester_run(void)\n{\n\tguint signal;\n\tint ret;\n\n\tif (!main_loop)\n\t\treturn EXIT_FAILURE;\n\n\tif (option_list) {\n\t\tg_main_loop_unref(main_loop);\n\t\treturn EXIT_SUCCESS;\n\t}\n\n\tsignal = setup_signalfd();\n\n\tg_idle_add(start_tester, NULL);\n\tg_main_loop_run(main_loop);\n\n\tg_source_remove(signal);\n\n\tg_main_loop_unref(main_loop);\n\n\tret = tester_summarize();\n\n\tg_list_free_full(test_list, test_destroy);\n\n\treturn ret == 0 ? EXIT_SUCCESS : EXIT_FAILURE;\n}"
  },
  {
    "function_name": "tester_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "784-812",
    "snippet": "void tester_init(int *argc, char ***argv)\n{\n\tGOptionContext *context;\n\tGError *error = NULL;\n\n\tcontext = g_option_context_new(NULL);\n\tg_option_context_add_main_entries(context, options, NULL);\n\n\tif (g_option_context_parse(context, argc, argv, &error) == FALSE) {\n\t\tif (error != NULL) {\n\t\t\tg_printerr(\"%s\\n\", error->message);\n\t\t\tg_error_free(error);\n\t\t} else\n\t\t\tg_printerr(\"An unknown error occurred\\n\");\n\t\texit(1);\n\t}\n\n\tg_option_context_free(context);\n\n\tif (option_version == TRUE) {\n\t\tg_print(\"%s\\n\", VERSION);\n\t\texit(EXIT_SUCCESS);\n\t}\n\n\tmain_loop = g_main_loop_new(NULL, FALSE);\n\n\ttest_list = NULL;\n\ttest_current = NULL;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GMainLoop *main_loop;",
      "static GList *test_list;",
      "static GList *test_current;",
      "static gboolean option_version = FALSE;",
      "static GOptionEntry options[] = {\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ \"quiet\", 'q', 0, G_OPTION_ARG_NONE, &option_quiet,\n\t\t\t\t\"Run tests without logging\" },\n\t{ \"debug\", 'd', 0, G_OPTION_ARG_NONE, &option_debug,\n\t\t\t\t\"Run tests with debug output\" },\n\t{ \"list\", 'l', 0, G_OPTION_ARG_NONE, &option_list,\n\t\t\t\t\"Only list the tests to be run\" },\n\t{ \"prefix\", 'p', 0, G_OPTION_ARG_STRING, &option_prefix,\n\t\t\t\t\"Run tests matching provided prefix\" },\n\t{ NULL },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_main_loop_new",
          "args": [
            "NULL",
            "FALSE"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_SUCCESS"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_print",
          "args": [
            "\"%s\\n\"",
            "VERSION"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_option_context_free",
          "args": [
            "context"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_printerr",
          "args": [
            "\"An unknown error occurred\\n\""
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_error_free",
          "args": [
            "error"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_printerr",
          "args": [
            "\"%s\\n\"",
            "error->message"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_option_context_parse",
          "args": [
            "context",
            "argc",
            "argv",
            "&error"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_option_context_add_main_entries",
          "args": [
            "context",
            "options",
            "NULL"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_option_context_new",
          "args": [
            "NULL"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GMainLoop *main_loop;\nstatic GList *test_list;\nstatic GList *test_current;\nstatic gboolean option_version = FALSE;\nstatic GOptionEntry options[] = {\n\t{ \"version\", 'v', 0, G_OPTION_ARG_NONE, &option_version,\n\t\t\t\t\"Show version information and exit\" },\n\t{ \"quiet\", 'q', 0, G_OPTION_ARG_NONE, &option_quiet,\n\t\t\t\t\"Run tests without logging\" },\n\t{ \"debug\", 'd', 0, G_OPTION_ARG_NONE, &option_debug,\n\t\t\t\t\"Run tests with debug output\" },\n\t{ \"list\", 'l', 0, G_OPTION_ARG_NONE, &option_list,\n\t\t\t\t\"Only list the tests to be run\" },\n\t{ \"prefix\", 'p', 0, G_OPTION_ARG_STRING, &option_prefix,\n\t\t\t\t\"Run tests matching provided prefix\" },\n\t{ NULL },\n};\n\nvoid tester_init(int *argc, char ***argv)\n{\n\tGOptionContext *context;\n\tGError *error = NULL;\n\n\tcontext = g_option_context_new(NULL);\n\tg_option_context_add_main_entries(context, options, NULL);\n\n\tif (g_option_context_parse(context, argc, argv, &error) == FALSE) {\n\t\tif (error != NULL) {\n\t\t\tg_printerr(\"%s\\n\", error->message);\n\t\t\tg_error_free(error);\n\t\t} else\n\t\t\tg_printerr(\"An unknown error occurred\\n\");\n\t\texit(1);\n\t}\n\n\tg_option_context_free(context);\n\n\tif (option_version == TRUE) {\n\t\tg_print(\"%s\\n\", VERSION);\n\t\texit(EXIT_SUCCESS);\n\t}\n\n\tmain_loop = g_main_loop_new(NULL, FALSE);\n\n\ttest_list = NULL;\n\ttest_current = NULL;\n}"
  },
  {
    "function_name": "tester_use_debug",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "765-768",
    "snippet": "bool tester_use_debug(void)\n{\n\treturn option_debug == TRUE ? true : false;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static gboolean option_debug = FALSE;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gboolean option_debug = FALSE;\n\nbool tester_use_debug(void)\n{\n\treturn option_debug == TRUE ? true : false;\n}"
  },
  {
    "function_name": "tester_use_quiet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "760-763",
    "snippet": "bool tester_use_quiet(void)\n{\n\treturn option_quiet == TRUE ? true : false;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static gboolean option_quiet = FALSE;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gboolean option_quiet = FALSE;\n\nbool tester_use_quiet(void)\n{\n\treturn option_quiet == TRUE ? true : false;\n}"
  },
  {
    "function_name": "setup_signalfd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "723-758",
    "snippet": "static guint setup_signalfd(void)\n{\n\tGIOChannel *channel;\n\tguint source;\n\tsigset_t mask;\n\tint fd;\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGTERM);\n\n\tif (sigprocmask(SIG_BLOCK, &mask, NULL) < 0) {\n\t\tperror(\"Failed to set signal mask\");\n\t\treturn 0;\n\t}\n\n\tfd = signalfd(-1, &mask, 0);\n\tif (fd < 0) {\n\t\tperror(\"Failed to create signal descriptor\");\n\t\treturn 0;\n\t}\n\n\tchannel = g_io_channel_unix_new(fd);\n\n\tg_io_channel_set_close_on_unref(channel, TRUE);\n\tg_io_channel_set_encoding(channel, NULL, NULL);\n\tg_io_channel_set_buffered(channel, FALSE);\n\n\tsource = g_io_add_watch(channel,\n\t\t\t\tG_IO_IN | G_IO_HUP | G_IO_ERR | G_IO_NVAL,\n\t\t\t\tsignal_handler, NULL);\n\n\tg_io_channel_unref(channel);\n\n\treturn source;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_io_channel_unref",
          "args": [
            "channel"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_add_watch",
          "args": [
            "channel",
            "G_IO_IN | G_IO_HUP | G_IO_ERR | G_IO_NVAL",
            "signal_handler",
            "NULL"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_set_buffered",
          "args": [
            "channel",
            "FALSE"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_set_encoding",
          "args": [
            "channel",
            "NULL",
            "NULL"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_set_close_on_unref",
          "args": [
            "channel",
            "TRUE"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_unix_new",
          "args": [
            "fd"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"Failed to create signal descriptor\""
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signalfd",
          "args": [
            "-1",
            "&mask",
            "0"
          ],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"Failed to set signal mask\""
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigprocmask",
          "args": [
            "SIG_BLOCK",
            "&mask",
            "NULL"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaddset",
          "args": [
            "&mask",
            "SIGTERM"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaddset",
          "args": [
            "&mask",
            "SIGINT"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigemptyset",
          "args": [
            "&mask"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic guint setup_signalfd(void)\n{\n\tGIOChannel *channel;\n\tguint source;\n\tsigset_t mask;\n\tint fd;\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGTERM);\n\n\tif (sigprocmask(SIG_BLOCK, &mask, NULL) < 0) {\n\t\tperror(\"Failed to set signal mask\");\n\t\treturn 0;\n\t}\n\n\tfd = signalfd(-1, &mask, 0);\n\tif (fd < 0) {\n\t\tperror(\"Failed to create signal descriptor\");\n\t\treturn 0;\n\t}\n\n\tchannel = g_io_channel_unix_new(fd);\n\n\tg_io_channel_set_close_on_unref(channel, TRUE);\n\tg_io_channel_set_encoding(channel, NULL, NULL);\n\tg_io_channel_set_buffered(channel, FALSE);\n\n\tsource = g_io_add_watch(channel,\n\t\t\t\tG_IO_IN | G_IO_HUP | G_IO_ERR | G_IO_NVAL,\n\t\t\t\tsignal_handler, NULL);\n\n\tg_io_channel_unref(channel);\n\n\treturn source;\n}"
  },
  {
    "function_name": "signal_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "691-721",
    "snippet": "static gboolean signal_handler(GIOChannel *channel, GIOCondition condition,\n\t\t\t\t\t\t\tgpointer user_data)\n{\n\tstatic bool terminated = false;\n\tstruct signalfd_siginfo si;\n\tssize_t result;\n\tint fd;\n\n\tif (condition & (G_IO_NVAL | G_IO_ERR | G_IO_HUP)) {\n\t\tg_main_loop_quit(main_loop);\n\t\treturn FALSE;\n\t}\n\n\tfd = g_io_channel_unix_get_fd(channel);\n\n\tresult = read(fd, &si, sizeof(si));\n\tif (result != sizeof(si))\n\t\treturn FALSE;\n\n\tswitch (si.ssi_signo) {\n\tcase SIGINT:\n\tcase SIGTERM:\n\t\tif (!terminated)\n\t\t\tg_main_loop_quit(main_loop);\n\n\t\tterminated = true;\n\t\tbreak;\n\t}\n\n\treturn TRUE;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GMainLoop *main_loop;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_main_loop_quit",
          "args": [
            "main_loop"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "&si",
            "sizeof(si)"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "notify_client_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/gatt-client.c",
          "lines": "1221-1250",
          "snippet": "static void notify_client_ready(struct bt_gatt_client *client, bool success,\n\t\t\t\t\t\t\tuint8_t att_ecode)\n{\n\tconst struct queue_entry *entry;\n\n\tif (client->ready)\n\t\treturn;\n\n\tbt_gatt_client_ref(client);\n\tclient->ready = success;\n\n\tfor (entry = queue_get_entries(client->ready_cbs); entry;\n\t\t\t\t\t\t\tentry = entry->next) {\n\t\tstruct ready_cb *ready = entry->data;\n\n\t\tready->callback(success, att_ecode, ready->data);\n\t}\n\n\tqueue_remove_all(client->ready_cbs, NULL, NULL, ready_destroy);\n\n\t/* Notify clones */\n\tfor (entry = queue_get_entries(client->clones); entry;\n\t\t\t\t\t\t\tentry = entry->next) {\n\t\tstruct bt_gatt_client *clone = entry->data;\n\n\t\tnotify_client_ready(clone, success, att_ecode);\n\t}\n\n\tbt_gatt_client_unref(client);\n}",
          "includes": [
            "#include <sys/uio.h>",
            "#include <limits.h>",
            "#include <assert.h>",
            "#include \"src/shared/gatt-client.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/gatt-helpers.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include \"src/shared/att.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/uio.h>\n#include <limits.h>\n#include <assert.h>\n#include \"src/shared/gatt-client.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/gatt-helpers.h\"\n#include \"lib/uuid.h\"\n#include \"lib/bluetooth.h\"\n#include \"src/shared/att.h\"\n#include <config.h>\n\nstatic void notify_client_ready(struct bt_gatt_client *client, bool success,\n\t\t\t\t\t\t\tuint8_t att_ecode)\n{\n\tconst struct queue_entry *entry;\n\n\tif (client->ready)\n\t\treturn;\n\n\tbt_gatt_client_ref(client);\n\tclient->ready = success;\n\n\tfor (entry = queue_get_entries(client->ready_cbs); entry;\n\t\t\t\t\t\t\tentry = entry->next) {\n\t\tstruct ready_cb *ready = entry->data;\n\n\t\tready->callback(success, att_ecode, ready->data);\n\t}\n\n\tqueue_remove_all(client->ready_cbs, NULL, NULL, ready_destroy);\n\n\t/* Notify clones */\n\tfor (entry = queue_get_entries(client->clones); entry;\n\t\t\t\t\t\t\tentry = entry->next) {\n\t\tstruct bt_gatt_client *clone = entry->data;\n\n\t\tnotify_client_ready(clone, success, att_ecode);\n\t}\n\n\tbt_gatt_client_unref(client);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_io_channel_unix_get_fd",
          "args": [
            "channel"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_main_loop_quit",
          "args": [
            "main_loop"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GMainLoop *main_loop;\n\nstatic gboolean signal_handler(GIOChannel *channel, GIOCondition condition,\n\t\t\t\t\t\t\tgpointer user_data)\n{\n\tstatic bool terminated = false;\n\tstruct signalfd_siginfo si;\n\tssize_t result;\n\tint fd;\n\n\tif (condition & (G_IO_NVAL | G_IO_ERR | G_IO_HUP)) {\n\t\tg_main_loop_quit(main_loop);\n\t\treturn FALSE;\n\t}\n\n\tfd = g_io_channel_unix_get_fd(channel);\n\n\tresult = read(fd, &si, sizeof(si));\n\tif (result != sizeof(si))\n\t\treturn FALSE;\n\n\tswitch (si.ssi_signo) {\n\tcase SIGINT:\n\tcase SIGTERM:\n\t\tif (!terminated)\n\t\t\tg_main_loop_quit(main_loop);\n\n\t\tterminated = true;\n\t\tbreak;\n\t}\n\n\treturn TRUE;\n}"
  },
  {
    "function_name": "tester_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "666-689",
    "snippet": "void tester_wait(unsigned int seconds, tester_wait_func_t func,\n\t\t\t\t\t\t\tvoid *user_data)\n{\n\tstruct test_case *test;\n\tstruct wait_data *wait;\n\n\tif (!func || seconds < 1)\n\t\treturn;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\twait = new0(struct wait_data, 1);\n\twait->seconds = seconds;\n\twait->test = test;\n\twait->func = func;\n\twait->user_data = user_data;\n\n\tg_timeout_add(1000, wait_callback, wait);\n\n\tprint_progress(test->name, COLOR_BLACK, \"waiting %u seconds\", seconds);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_BLACK\t\"\\x1B[0;30m\""
    ],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_BLACK",
            "\"waiting %u seconds\"",
            "seconds"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_timeout_add",
          "args": [
            "1000",
            "wait_callback",
            "wait"
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new0",
          "args": [
            "structwait_data",
            "1"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_BLACK\t\"\\x1B[0;30m\"\n\nstatic GList *test_current;\n\nvoid tester_wait(unsigned int seconds, tester_wait_func_t func,\n\t\t\t\t\t\t\tvoid *user_data)\n{\n\tstruct test_case *test;\n\tstruct wait_data *wait;\n\n\tif (!func || seconds < 1)\n\t\treturn;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\twait = new0(struct wait_data, 1);\n\twait->seconds = seconds;\n\twait->test = test;\n\twait->func = func;\n\twait->user_data = user_data;\n\n\tg_timeout_add(1000, wait_callback, wait);\n\n\tprint_progress(test->name, COLOR_BLACK, \"waiting %u seconds\", seconds);\n}"
  },
  {
    "function_name": "wait_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "644-664",
    "snippet": "static gboolean wait_callback(gpointer user_data)\n{\n\tstruct wait_data *wait = user_data;\n\tstruct test_case *test = wait->test;\n\n\twait->seconds--;\n\n\tif (wait->seconds > 0) {\n\t\tprint_progress(test->name, COLOR_BLACK, \"%u seconds left\",\n\t\t\t\t\t\t\t\twait->seconds);\n\t\treturn TRUE;\n\t}\n\n\tprint_progress(test->name, COLOR_BLACK, \"waiting done\");\n\n\twait->func(wait->user_data);\n\n\tfree(wait);\n\n\treturn FALSE;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_BLACK\t\"\\x1B[0;30m\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "wait"
          ],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "bt_att_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/att.c",
          "lines": "956-985",
          "snippet": "static void bt_att_free(struct bt_att *att)\n{\n\tif (att->pending_req)\n\t\tdestroy_att_send_op(att->pending_req);\n\n\tif (att->pending_ind)\n\t\tdestroy_att_send_op(att->pending_ind);\n\n\tio_destroy(att->io);\n\tbt_crypto_unref(att->crypto);\n\n\tqueue_destroy(att->req_queue, NULL);\n\tqueue_destroy(att->ind_queue, NULL);\n\tqueue_destroy(att->write_queue, NULL);\n\tqueue_destroy(att->notify_list, NULL);\n\tqueue_destroy(att->disconn_list, NULL);\n\n\tif (att->timeout_destroy)\n\t\tatt->timeout_destroy(att->timeout_data);\n\n\tif (att->debug_destroy)\n\t\tatt->debug_destroy(att->debug_data);\n\n\tfree(att->local_sign);\n\tfree(att->remote_sign);\n\n\tfree(att->buf);\n\n\tfree(att);\n}",
          "includes": [
            "#include \"src/shared/crypto.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/l2cap.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include \"src/shared/timeout.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/io.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/crypto.h\"\n#include \"src/shared/att.h\"\n#include \"lib/uuid.h\"\n#include \"lib/l2cap.h\"\n#include \"lib/bluetooth.h\"\n#include \"src/shared/timeout.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/io.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic void bt_att_free(struct bt_att *att)\n{\n\tif (att->pending_req)\n\t\tdestroy_att_send_op(att->pending_req);\n\n\tif (att->pending_ind)\n\t\tdestroy_att_send_op(att->pending_ind);\n\n\tio_destroy(att->io);\n\tbt_crypto_unref(att->crypto);\n\n\tqueue_destroy(att->req_queue, NULL);\n\tqueue_destroy(att->ind_queue, NULL);\n\tqueue_destroy(att->write_queue, NULL);\n\tqueue_destroy(att->notify_list, NULL);\n\tqueue_destroy(att->disconn_list, NULL);\n\n\tif (att->timeout_destroy)\n\t\tatt->timeout_destroy(att->timeout_data);\n\n\tif (att->debug_destroy)\n\t\tatt->debug_destroy(att->debug_data);\n\n\tfree(att->local_sign);\n\tfree(att->remote_sign);\n\n\tfree(att->buf);\n\n\tfree(att);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait->func",
          "args": [
            "wait->user_data"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_BLACK",
            "\"waiting done\""
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_BLACK",
            "\"%u seconds left\"",
            "wait->seconds"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_BLACK\t\"\\x1B[0;30m\"\n\nstatic gboolean wait_callback(gpointer user_data)\n{\n\tstruct wait_data *wait = user_data;\n\tstruct test_case *test = wait->test;\n\n\twait->seconds--;\n\n\tif (wait->seconds > 0) {\n\t\tprint_progress(test->name, COLOR_BLACK, \"%u seconds left\",\n\t\t\t\t\t\t\t\twait->seconds);\n\t\treturn TRUE;\n\t}\n\n\tprint_progress(test->name, COLOR_BLACK, \"waiting done\");\n\n\twait->func(wait->user_data);\n\n\tfree(wait);\n\n\treturn FALSE;\n}"
  },
  {
    "function_name": "start_tester",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "628-635",
    "snippet": "static gboolean start_tester(gpointer user_data)\n{\n\ttest_timer = g_timer_new();\n\n\tnext_test_case();\n\n\treturn FALSE;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GTimer *test_timer;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "next_test_case",
          "args": [],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "next_test_case",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "364-394",
          "snippet": "static void next_test_case(void)\n{\n\tstruct test_case *test;\n\n\tif (test_current)\n\t\ttest_current = g_list_next(test_current);\n\telse\n\t\ttest_current = test_list;\n\n\tif (!test_current) {\n\t\tg_timer_stop(test_timer);\n\n\t\tg_main_loop_quit(main_loop);\n\t\treturn;\n\t}\n\n\ttest = test_current->data;\n\n\tprintf(\"\\n\");\n\tprint_progress(test->name, COLOR_BLACK, \"init\");\n\n\ttest->start_time = g_timer_elapsed(test_timer, NULL);\n\n\tif (test->timeout > 0)\n\t\ttest->timeout_id = g_timeout_add_seconds(test->timeout,\n\t\t\t\t\t\t\ttest_timeout, test);\n\n\ttest->stage = TEST_STAGE_PRE_SETUP;\n\n\ttest->pre_setup_func(test->test_data);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define COLOR_BLACK\t\"\\x1B[0;30m\""
          ],
          "globals_used": [
            "static GMainLoop *main_loop;",
            "static GList *test_list;",
            "static GList *test_current;",
            "static GTimer *test_timer;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_BLACK\t\"\\x1B[0;30m\"\n\nstatic GMainLoop *main_loop;\nstatic GList *test_list;\nstatic GList *test_current;\nstatic GTimer *test_timer;\n\nstatic void next_test_case(void)\n{\n\tstruct test_case *test;\n\n\tif (test_current)\n\t\ttest_current = g_list_next(test_current);\n\telse\n\t\ttest_current = test_list;\n\n\tif (!test_current) {\n\t\tg_timer_stop(test_timer);\n\n\t\tg_main_loop_quit(main_loop);\n\t\treturn;\n\t}\n\n\ttest = test_current->data;\n\n\tprintf(\"\\n\");\n\tprint_progress(test->name, COLOR_BLACK, \"init\");\n\n\ttest->start_time = g_timer_elapsed(test_timer, NULL);\n\n\tif (test->timeout > 0)\n\t\ttest->timeout_id = g_timeout_add_seconds(test->timeout,\n\t\t\t\t\t\t\ttest_timeout, test);\n\n\ttest->stage = TEST_STAGE_PRE_SETUP;\n\n\ttest->pre_setup_func(test->test_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_timer_new",
          "args": [],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GTimer *test_timer;\n\nstatic gboolean start_tester(gpointer user_data)\n{\n\ttest_timer = g_timer_new();\n\n\tnext_test_case();\n\n\treturn FALSE;\n}"
  },
  {
    "function_name": "tester_post_teardown_failed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "611-626",
    "snippet": "void tester_post_teardown_failed(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_POST_TEARDOWN)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_RED, \"teardown failed\");\n\n\tg_idle_add(done_callback, test);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_RED\t\"\\x1B[0;31m\""
    ],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_idle_add",
          "args": [
            "done_callback",
            "test"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_RED",
            "\"teardown failed\""
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_RED\t\"\\x1B[0;31m\"\n\nstatic GList *test_current;\n\nvoid tester_post_teardown_failed(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_POST_TEARDOWN)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_RED, \"teardown failed\");\n\n\tg_idle_add(done_callback, test);\n}"
  },
  {
    "function_name": "tester_post_teardown_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "594-609",
    "snippet": "void tester_post_teardown_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_POST_TEARDOWN)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_MAGENTA, \"teardown complete\");\n\n\tg_idle_add(done_callback, test);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_MAGENTA\t\"\\x1B[0;35m\""
    ],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_idle_add",
          "args": [
            "done_callback",
            "test"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_MAGENTA",
            "\"teardown complete\""
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_MAGENTA\t\"\\x1B[0;35m\"\n\nstatic GList *test_current;\n\nvoid tester_post_teardown_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_POST_TEARDOWN)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_MAGENTA, \"teardown complete\");\n\n\tg_idle_add(done_callback, test);\n}"
  },
  {
    "function_name": "tester_teardown_failed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "577-592",
    "snippet": "void tester_teardown_failed(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_TEARDOWN)\n\t\treturn;\n\n\ttest->stage = TEST_STAGE_POST_TEARDOWN;\n\n\ttester_post_teardown_failed();\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "tester_post_teardown_failed",
          "args": [],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "tester_post_teardown_failed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "611-626",
          "snippet": "void tester_post_teardown_failed(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_POST_TEARDOWN)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_RED, \"teardown failed\");\n\n\tg_idle_add(done_callback, test);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define COLOR_RED\t\"\\x1B[0;31m\""
          ],
          "globals_used": [
            "static GList *test_current;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_RED\t\"\\x1B[0;31m\"\n\nstatic GList *test_current;\n\nvoid tester_post_teardown_failed(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_POST_TEARDOWN)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_RED, \"teardown failed\");\n\n\tg_idle_add(done_callback, test);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GList *test_current;\n\nvoid tester_teardown_failed(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_TEARDOWN)\n\t\treturn;\n\n\ttest->stage = TEST_STAGE_POST_TEARDOWN;\n\n\ttester_post_teardown_failed();\n}"
  },
  {
    "function_name": "tester_teardown_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "560-575",
    "snippet": "void tester_teardown_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_TEARDOWN)\n\t\treturn;\n\n\ttest->stage = TEST_STAGE_POST_TEARDOWN;\n\n\ttest->post_teardown_func(test->test_data);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "test->post_teardown_func",
          "args": [
            "test->test_data"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GList *test_current;\n\nvoid tester_teardown_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_TEARDOWN)\n\t\treturn;\n\n\ttest->stage = TEST_STAGE_POST_TEARDOWN;\n\n\ttest->post_teardown_func(test->test_data);\n}"
  },
  {
    "function_name": "tester_test_abort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "555-558",
    "snippet": "void tester_test_abort(void)\n{\n\ttest_result(TEST_RESULT_NOT_RUN);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_result",
          "args": [
            "TEST_RESULT_NOT_RUN"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "test_result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "506-543",
          "snippet": "static void test_result(enum test_result result)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_RUN)\n\t\treturn;\n\n\tif (test->timeout_id > 0) {\n\t\tg_source_remove(test->timeout_id);\n\t\ttest->timeout_id = 0;\n\t}\n\n\ttest->result = result;\n\tswitch (result) {\n\tcase TEST_RESULT_PASSED:\n\t\tprint_progress(test->name, COLOR_GREEN, \"test passed\");\n\t\tbreak;\n\tcase TEST_RESULT_FAILED:\n\t\tprint_progress(test->name, COLOR_RED, \"test failed\");\n\t\tbreak;\n\tcase TEST_RESULT_NOT_RUN:\n\t\tprint_progress(test->name, COLOR_YELLOW, \"test not run\");\n\t\tbreak;\n\tcase TEST_RESULT_TIMED_OUT:\n\t\tprint_progress(test->name, COLOR_RED, \"test timed out\");\n\t\tbreak;\n\t}\n\n\tif (test->teardown_id > 0)\n\t\treturn;\n\n\ttest->teardown_id = g_idle_add(teardown_callback, test);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define COLOR_YELLOW\t\"\\x1B[0;33m\"",
            "#define COLOR_GREEN\t\"\\x1B[0;32m\"",
            "#define COLOR_RED\t\"\\x1B[0;31m\""
          ],
          "globals_used": [
            "static GList *test_current;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_YELLOW\t\"\\x1B[0;33m\"\n#define COLOR_GREEN\t\"\\x1B[0;32m\"\n#define COLOR_RED\t\"\\x1B[0;31m\"\n\nstatic GList *test_current;\n\nstatic void test_result(enum test_result result)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_RUN)\n\t\treturn;\n\n\tif (test->timeout_id > 0) {\n\t\tg_source_remove(test->timeout_id);\n\t\ttest->timeout_id = 0;\n\t}\n\n\ttest->result = result;\n\tswitch (result) {\n\tcase TEST_RESULT_PASSED:\n\t\tprint_progress(test->name, COLOR_GREEN, \"test passed\");\n\t\tbreak;\n\tcase TEST_RESULT_FAILED:\n\t\tprint_progress(test->name, COLOR_RED, \"test failed\");\n\t\tbreak;\n\tcase TEST_RESULT_NOT_RUN:\n\t\tprint_progress(test->name, COLOR_YELLOW, \"test not run\");\n\t\tbreak;\n\tcase TEST_RESULT_TIMED_OUT:\n\t\tprint_progress(test->name, COLOR_RED, \"test timed out\");\n\t\tbreak;\n\t}\n\n\tif (test->teardown_id > 0)\n\t\treturn;\n\n\ttest->teardown_id = g_idle_add(teardown_callback, test);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid tester_test_abort(void)\n{\n\ttest_result(TEST_RESULT_NOT_RUN);\n}"
  },
  {
    "function_name": "tester_test_failed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "550-553",
    "snippet": "void tester_test_failed(void)\n{\n\ttest_result(TEST_RESULT_FAILED);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_result",
          "args": [
            "TEST_RESULT_FAILED"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "test_result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "506-543",
          "snippet": "static void test_result(enum test_result result)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_RUN)\n\t\treturn;\n\n\tif (test->timeout_id > 0) {\n\t\tg_source_remove(test->timeout_id);\n\t\ttest->timeout_id = 0;\n\t}\n\n\ttest->result = result;\n\tswitch (result) {\n\tcase TEST_RESULT_PASSED:\n\t\tprint_progress(test->name, COLOR_GREEN, \"test passed\");\n\t\tbreak;\n\tcase TEST_RESULT_FAILED:\n\t\tprint_progress(test->name, COLOR_RED, \"test failed\");\n\t\tbreak;\n\tcase TEST_RESULT_NOT_RUN:\n\t\tprint_progress(test->name, COLOR_YELLOW, \"test not run\");\n\t\tbreak;\n\tcase TEST_RESULT_TIMED_OUT:\n\t\tprint_progress(test->name, COLOR_RED, \"test timed out\");\n\t\tbreak;\n\t}\n\n\tif (test->teardown_id > 0)\n\t\treturn;\n\n\ttest->teardown_id = g_idle_add(teardown_callback, test);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define COLOR_YELLOW\t\"\\x1B[0;33m\"",
            "#define COLOR_GREEN\t\"\\x1B[0;32m\"",
            "#define COLOR_RED\t\"\\x1B[0;31m\""
          ],
          "globals_used": [
            "static GList *test_current;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_YELLOW\t\"\\x1B[0;33m\"\n#define COLOR_GREEN\t\"\\x1B[0;32m\"\n#define COLOR_RED\t\"\\x1B[0;31m\"\n\nstatic GList *test_current;\n\nstatic void test_result(enum test_result result)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_RUN)\n\t\treturn;\n\n\tif (test->timeout_id > 0) {\n\t\tg_source_remove(test->timeout_id);\n\t\ttest->timeout_id = 0;\n\t}\n\n\ttest->result = result;\n\tswitch (result) {\n\tcase TEST_RESULT_PASSED:\n\t\tprint_progress(test->name, COLOR_GREEN, \"test passed\");\n\t\tbreak;\n\tcase TEST_RESULT_FAILED:\n\t\tprint_progress(test->name, COLOR_RED, \"test failed\");\n\t\tbreak;\n\tcase TEST_RESULT_NOT_RUN:\n\t\tprint_progress(test->name, COLOR_YELLOW, \"test not run\");\n\t\tbreak;\n\tcase TEST_RESULT_TIMED_OUT:\n\t\tprint_progress(test->name, COLOR_RED, \"test timed out\");\n\t\tbreak;\n\t}\n\n\tif (test->teardown_id > 0)\n\t\treturn;\n\n\ttest->teardown_id = g_idle_add(teardown_callback, test);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid tester_test_failed(void)\n{\n\ttest_result(TEST_RESULT_FAILED);\n}"
  },
  {
    "function_name": "tester_test_passed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "545-548",
    "snippet": "void tester_test_passed(void)\n{\n\ttest_result(TEST_RESULT_PASSED);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_result",
          "args": [
            "TEST_RESULT_PASSED"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "test_result",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "506-543",
          "snippet": "static void test_result(enum test_result result)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_RUN)\n\t\treturn;\n\n\tif (test->timeout_id > 0) {\n\t\tg_source_remove(test->timeout_id);\n\t\ttest->timeout_id = 0;\n\t}\n\n\ttest->result = result;\n\tswitch (result) {\n\tcase TEST_RESULT_PASSED:\n\t\tprint_progress(test->name, COLOR_GREEN, \"test passed\");\n\t\tbreak;\n\tcase TEST_RESULT_FAILED:\n\t\tprint_progress(test->name, COLOR_RED, \"test failed\");\n\t\tbreak;\n\tcase TEST_RESULT_NOT_RUN:\n\t\tprint_progress(test->name, COLOR_YELLOW, \"test not run\");\n\t\tbreak;\n\tcase TEST_RESULT_TIMED_OUT:\n\t\tprint_progress(test->name, COLOR_RED, \"test timed out\");\n\t\tbreak;\n\t}\n\n\tif (test->teardown_id > 0)\n\t\treturn;\n\n\ttest->teardown_id = g_idle_add(teardown_callback, test);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define COLOR_YELLOW\t\"\\x1B[0;33m\"",
            "#define COLOR_GREEN\t\"\\x1B[0;32m\"",
            "#define COLOR_RED\t\"\\x1B[0;31m\""
          ],
          "globals_used": [
            "static GList *test_current;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_YELLOW\t\"\\x1B[0;33m\"\n#define COLOR_GREEN\t\"\\x1B[0;32m\"\n#define COLOR_RED\t\"\\x1B[0;31m\"\n\nstatic GList *test_current;\n\nstatic void test_result(enum test_result result)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_RUN)\n\t\treturn;\n\n\tif (test->timeout_id > 0) {\n\t\tg_source_remove(test->timeout_id);\n\t\ttest->timeout_id = 0;\n\t}\n\n\ttest->result = result;\n\tswitch (result) {\n\tcase TEST_RESULT_PASSED:\n\t\tprint_progress(test->name, COLOR_GREEN, \"test passed\");\n\t\tbreak;\n\tcase TEST_RESULT_FAILED:\n\t\tprint_progress(test->name, COLOR_RED, \"test failed\");\n\t\tbreak;\n\tcase TEST_RESULT_NOT_RUN:\n\t\tprint_progress(test->name, COLOR_YELLOW, \"test not run\");\n\t\tbreak;\n\tcase TEST_RESULT_TIMED_OUT:\n\t\tprint_progress(test->name, COLOR_RED, \"test timed out\");\n\t\tbreak;\n\t}\n\n\tif (test->teardown_id > 0)\n\t\treturn;\n\n\ttest->teardown_id = g_idle_add(teardown_callback, test);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid tester_test_passed(void)\n{\n\ttest_result(TEST_RESULT_PASSED);\n}"
  },
  {
    "function_name": "test_result",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "506-543",
    "snippet": "static void test_result(enum test_result result)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_RUN)\n\t\treturn;\n\n\tif (test->timeout_id > 0) {\n\t\tg_source_remove(test->timeout_id);\n\t\ttest->timeout_id = 0;\n\t}\n\n\ttest->result = result;\n\tswitch (result) {\n\tcase TEST_RESULT_PASSED:\n\t\tprint_progress(test->name, COLOR_GREEN, \"test passed\");\n\t\tbreak;\n\tcase TEST_RESULT_FAILED:\n\t\tprint_progress(test->name, COLOR_RED, \"test failed\");\n\t\tbreak;\n\tcase TEST_RESULT_NOT_RUN:\n\t\tprint_progress(test->name, COLOR_YELLOW, \"test not run\");\n\t\tbreak;\n\tcase TEST_RESULT_TIMED_OUT:\n\t\tprint_progress(test->name, COLOR_RED, \"test timed out\");\n\t\tbreak;\n\t}\n\n\tif (test->teardown_id > 0)\n\t\treturn;\n\n\ttest->teardown_id = g_idle_add(teardown_callback, test);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_YELLOW\t\"\\x1B[0;33m\"",
      "#define COLOR_GREEN\t\"\\x1B[0;32m\"",
      "#define COLOR_RED\t\"\\x1B[0;31m\""
    ],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_idle_add",
          "args": [
            "teardown_callback",
            "test"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_RED",
            "\"test timed out\""
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_YELLOW",
            "\"test not run\""
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_RED",
            "\"test failed\""
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_GREEN",
            "\"test passed\""
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_source_remove",
          "args": [
            "test->timeout_id"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_YELLOW\t\"\\x1B[0;33m\"\n#define COLOR_GREEN\t\"\\x1B[0;32m\"\n#define COLOR_RED\t\"\\x1B[0;31m\"\n\nstatic GList *test_current;\n\nstatic void test_result(enum test_result result)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_RUN)\n\t\treturn;\n\n\tif (test->timeout_id > 0) {\n\t\tg_source_remove(test->timeout_id);\n\t\ttest->timeout_id = 0;\n\t}\n\n\ttest->result = result;\n\tswitch (result) {\n\tcase TEST_RESULT_PASSED:\n\t\tprint_progress(test->name, COLOR_GREEN, \"test passed\");\n\t\tbreak;\n\tcase TEST_RESULT_FAILED:\n\t\tprint_progress(test->name, COLOR_RED, \"test failed\");\n\t\tbreak;\n\tcase TEST_RESULT_NOT_RUN:\n\t\tprint_progress(test->name, COLOR_YELLOW, \"test not run\");\n\t\tbreak;\n\tcase TEST_RESULT_TIMED_OUT:\n\t\tprint_progress(test->name, COLOR_RED, \"test timed out\");\n\t\tbreak;\n\t}\n\n\tif (test->teardown_id > 0)\n\t\treturn;\n\n\ttest->teardown_id = g_idle_add(teardown_callback, test);\n}"
  },
  {
    "function_name": "tester_setup_failed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "481-504",
    "snippet": "void tester_setup_failed(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_SETUP)\n\t\treturn;\n\n\ttest->stage = TEST_STAGE_POST_TEARDOWN;\n\n\tif (test->timeout_id > 0) {\n\t\tg_source_remove(test->timeout_id);\n\t\ttest->timeout_id = 0;\n\t}\n\n\tprint_progress(test->name, COLOR_RED, \"setup failed\");\n\tprint_progress(test->name, COLOR_MAGENTA, \"teardown\");\n\n\ttest->post_teardown_func(test->test_data);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_MAGENTA\t\"\\x1B[0;35m\"",
      "#define COLOR_RED\t\"\\x1B[0;31m\""
    ],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "test->post_teardown_func",
          "args": [
            "test->test_data"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_MAGENTA",
            "\"teardown\""
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_RED",
            "\"setup failed\""
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_source_remove",
          "args": [
            "test->timeout_id"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_MAGENTA\t\"\\x1B[0;35m\"\n#define COLOR_RED\t\"\\x1B[0;31m\"\n\nstatic GList *test_current;\n\nvoid tester_setup_failed(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_SETUP)\n\t\treturn;\n\n\ttest->stage = TEST_STAGE_POST_TEARDOWN;\n\n\tif (test->timeout_id > 0) {\n\t\tg_source_remove(test->timeout_id);\n\t\ttest->timeout_id = 0;\n\t}\n\n\tprint_progress(test->name, COLOR_RED, \"setup failed\");\n\tprint_progress(test->name, COLOR_MAGENTA, \"teardown\");\n\n\ttest->post_teardown_func(test->test_data);\n}"
  },
  {
    "function_name": "tester_setup_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "464-479",
    "snippet": "void tester_setup_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_SETUP)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_BLUE, \"setup complete\");\n\n\tg_idle_add(run_callback, test);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_BLUE\t\"\\x1B[0;34m\""
    ],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_idle_add",
          "args": [
            "run_callback",
            "test"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_BLUE",
            "\"setup complete\""
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_BLUE\t\"\\x1B[0;34m\"\n\nstatic GList *test_current;\n\nvoid tester_setup_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_SETUP)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_BLUE, \"setup complete\");\n\n\tg_idle_add(run_callback, test);\n}"
  },
  {
    "function_name": "tester_pre_setup_failed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "447-462",
    "snippet": "void tester_pre_setup_failed(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_PRE_SETUP)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_RED, \"pre setup failed\");\n\n\tg_idle_add(done_callback, test);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_RED\t\"\\x1B[0;31m\""
    ],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_idle_add",
          "args": [
            "done_callback",
            "test"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_RED",
            "\"pre setup failed\""
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_RED\t\"\\x1B[0;31m\"\n\nstatic GList *test_current;\n\nvoid tester_pre_setup_failed(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_PRE_SETUP)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_RED, \"pre setup failed\");\n\n\tg_idle_add(done_callback, test);\n}"
  },
  {
    "function_name": "tester_pre_setup_complete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "432-445",
    "snippet": "void tester_pre_setup_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_PRE_SETUP)\n\t\treturn;\n\n\tg_idle_add(setup_callback, test);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_idle_add",
          "args": [
            "setup_callback",
            "test"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GList *test_current;\n\nvoid tester_pre_setup_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_PRE_SETUP)\n\t\treturn;\n\n\tg_idle_add(setup_callback, test);\n}"
  },
  {
    "function_name": "done_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "420-430",
    "snippet": "static gboolean done_callback(gpointer user_data)\n{\n\tstruct test_case *test = user_data;\n\n\ttest->end_time = g_timer_elapsed(test_timer, NULL);\n\n\tprint_progress(test->name, COLOR_BLACK, \"done\");\n\tnext_test_case();\n\n\treturn FALSE;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_BLACK\t\"\\x1B[0;30m\""
    ],
    "globals_used": [
      "static GTimer *test_timer;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "next_test_case",
          "args": [],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "next_test_case",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "364-394",
          "snippet": "static void next_test_case(void)\n{\n\tstruct test_case *test;\n\n\tif (test_current)\n\t\ttest_current = g_list_next(test_current);\n\telse\n\t\ttest_current = test_list;\n\n\tif (!test_current) {\n\t\tg_timer_stop(test_timer);\n\n\t\tg_main_loop_quit(main_loop);\n\t\treturn;\n\t}\n\n\ttest = test_current->data;\n\n\tprintf(\"\\n\");\n\tprint_progress(test->name, COLOR_BLACK, \"init\");\n\n\ttest->start_time = g_timer_elapsed(test_timer, NULL);\n\n\tif (test->timeout > 0)\n\t\ttest->timeout_id = g_timeout_add_seconds(test->timeout,\n\t\t\t\t\t\t\ttest_timeout, test);\n\n\ttest->stage = TEST_STAGE_PRE_SETUP;\n\n\ttest->pre_setup_func(test->test_data);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define COLOR_BLACK\t\"\\x1B[0;30m\""
          ],
          "globals_used": [
            "static GMainLoop *main_loop;",
            "static GList *test_list;",
            "static GList *test_current;",
            "static GTimer *test_timer;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_BLACK\t\"\\x1B[0;30m\"\n\nstatic GMainLoop *main_loop;\nstatic GList *test_list;\nstatic GList *test_current;\nstatic GTimer *test_timer;\n\nstatic void next_test_case(void)\n{\n\tstruct test_case *test;\n\n\tif (test_current)\n\t\ttest_current = g_list_next(test_current);\n\telse\n\t\ttest_current = test_list;\n\n\tif (!test_current) {\n\t\tg_timer_stop(test_timer);\n\n\t\tg_main_loop_quit(main_loop);\n\t\treturn;\n\t}\n\n\ttest = test_current->data;\n\n\tprintf(\"\\n\");\n\tprint_progress(test->name, COLOR_BLACK, \"init\");\n\n\ttest->start_time = g_timer_elapsed(test_timer, NULL);\n\n\tif (test->timeout > 0)\n\t\ttest->timeout_id = g_timeout_add_seconds(test->timeout,\n\t\t\t\t\t\t\ttest_timeout, test);\n\n\ttest->stage = TEST_STAGE_PRE_SETUP;\n\n\ttest->pre_setup_func(test->test_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_BLACK",
            "\"done\""
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_timer_elapsed",
          "args": [
            "test_timer",
            "NULL"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_BLACK\t\"\\x1B[0;30m\"\n\nstatic GTimer *test_timer;\n\nstatic gboolean done_callback(gpointer user_data)\n{\n\tstruct test_case *test = user_data;\n\n\ttest->end_time = g_timer_elapsed(test_timer, NULL);\n\n\tprint_progress(test->name, COLOR_BLACK, \"done\");\n\tnext_test_case();\n\n\treturn FALSE;\n}"
  },
  {
    "function_name": "run_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "408-418",
    "snippet": "static gboolean run_callback(gpointer user_data)\n{\n\tstruct test_case *test = user_data;\n\n\ttest->stage = TEST_STAGE_RUN;\n\n\tprint_progress(test->name, COLOR_BLACK, \"run\");\n\ttest->test_func(test->test_data);\n\n\treturn FALSE;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_BLACK\t\"\\x1B[0;30m\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test->test_func",
          "args": [
            "test->test_data"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_BLACK",
            "\"run\""
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_BLACK\t\"\\x1B[0;30m\"\n\nstatic gboolean run_callback(gpointer user_data)\n{\n\tstruct test_case *test = user_data;\n\n\ttest->stage = TEST_STAGE_RUN;\n\n\tprint_progress(test->name, COLOR_BLACK, \"run\");\n\ttest->test_func(test->test_data);\n\n\treturn FALSE;\n}"
  },
  {
    "function_name": "setup_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "396-406",
    "snippet": "static gboolean setup_callback(gpointer user_data)\n{\n\tstruct test_case *test = user_data;\n\n\ttest->stage = TEST_STAGE_SETUP;\n\n\tprint_progress(test->name, COLOR_BLUE, \"setup\");\n\ttest->setup_func(test->test_data);\n\n\treturn FALSE;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_BLUE\t\"\\x1B[0;34m\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test->setup_func",
          "args": [
            "test->test_data"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_BLUE",
            "\"setup\""
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_BLUE\t\"\\x1B[0;34m\"\n\nstatic gboolean setup_callback(gpointer user_data)\n{\n\tstruct test_case *test = user_data;\n\n\ttest->stage = TEST_STAGE_SETUP;\n\n\tprint_progress(test->name, COLOR_BLUE, \"setup\");\n\ttest->setup_func(test->test_data);\n\n\treturn FALSE;\n}"
  },
  {
    "function_name": "next_test_case",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "364-394",
    "snippet": "static void next_test_case(void)\n{\n\tstruct test_case *test;\n\n\tif (test_current)\n\t\ttest_current = g_list_next(test_current);\n\telse\n\t\ttest_current = test_list;\n\n\tif (!test_current) {\n\t\tg_timer_stop(test_timer);\n\n\t\tg_main_loop_quit(main_loop);\n\t\treturn;\n\t}\n\n\ttest = test_current->data;\n\n\tprintf(\"\\n\");\n\tprint_progress(test->name, COLOR_BLACK, \"init\");\n\n\ttest->start_time = g_timer_elapsed(test_timer, NULL);\n\n\tif (test->timeout > 0)\n\t\ttest->timeout_id = g_timeout_add_seconds(test->timeout,\n\t\t\t\t\t\t\ttest_timeout, test);\n\n\ttest->stage = TEST_STAGE_PRE_SETUP;\n\n\ttest->pre_setup_func(test->test_data);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_BLACK\t\"\\x1B[0;30m\""
    ],
    "globals_used": [
      "static GMainLoop *main_loop;",
      "static GList *test_list;",
      "static GList *test_current;",
      "static GTimer *test_timer;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "test->pre_setup_func",
          "args": [
            "test->test_data"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_timeout_add_seconds",
          "args": [
            "test->timeout",
            "test_timeout",
            "test"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_timer_elapsed",
          "args": [
            "test_timer",
            "NULL"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_BLACK",
            "\"init\""
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "bt_shell_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/shell.c",
          "lines": "458-498",
          "snippet": "void bt_shell_printf(const char *fmt, ...)\n{\n\tva_list args;\n\tbool save_input;\n\tchar *saved_line;\n\tint saved_point;\n\n\tif (!data.input)\n\t\treturn;\n\n\tif (data.mode) {\n\t\tva_start(args, fmt);\n\t\tvprintf(fmt, args);\n\t\tva_end(args);\n\t\treturn;\n\t}\n\n\tsave_input = !RL_ISSTATE(RL_STATE_DONE);\n\n\tif (save_input) {\n\t\tsaved_point = rl_point;\n\t\tsaved_line = rl_copy_text(0, rl_end);\n\t\tif (!data.saved_prompt)\n\t\t\trl_save_prompt();\n\t\trl_replace_line(\"\", 0);\n\t\trl_redisplay();\n\t}\n\n\tva_start(args, fmt);\n\tvprintf(fmt, args);\n\tva_end(args);\n\n\tif (save_input) {\n\t\tif (!data.saved_prompt)\n\t\t\trl_restore_prompt();\n\t\trl_replace_line(saved_line, 0);\n\t\trl_point = saved_point;\n\t\trl_forced_update_display();\n\t\tfree(saved_line);\n\t}\n}",
          "includes": [
            "#include \"src/shared/shell.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/io.h\"",
            "#include \"src/shared/timeout.h\"",
            "#include \"src/shared/mainloop.h\"",
            "#include <readline/history.h>",
            "#include <readline/readline.h>",
            "#include <getopt.h>",
            "#include <wordexp.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <stdbool.h>",
            "#include <stdarg.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static wordexp_t args;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/shell.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/io.h\"\n#include \"src/shared/timeout.h\"\n#include \"src/shared/mainloop.h\"\n#include <readline/history.h>\n#include <readline/readline.h>\n#include <getopt.h>\n#include <wordexp.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <stdbool.h>\n#include <stdarg.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic wordexp_t args;\n\nvoid bt_shell_printf(const char *fmt, ...)\n{\n\tva_list args;\n\tbool save_input;\n\tchar *saved_line;\n\tint saved_point;\n\n\tif (!data.input)\n\t\treturn;\n\n\tif (data.mode) {\n\t\tva_start(args, fmt);\n\t\tvprintf(fmt, args);\n\t\tva_end(args);\n\t\treturn;\n\t}\n\n\tsave_input = !RL_ISSTATE(RL_STATE_DONE);\n\n\tif (save_input) {\n\t\tsaved_point = rl_point;\n\t\tsaved_line = rl_copy_text(0, rl_end);\n\t\tif (!data.saved_prompt)\n\t\t\trl_save_prompt();\n\t\trl_replace_line(\"\", 0);\n\t\trl_redisplay();\n\t}\n\n\tva_start(args, fmt);\n\tvprintf(fmt, args);\n\tva_end(args);\n\n\tif (save_input) {\n\t\tif (!data.saved_prompt)\n\t\t\trl_restore_prompt();\n\t\trl_replace_line(saved_line, 0);\n\t\trl_point = saved_point;\n\t\trl_forced_update_display();\n\t\tfree(saved_line);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_main_loop_quit",
          "args": [
            "main_loop"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_timer_stop",
          "args": [
            "test_timer"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_list_next",
          "args": [
            "test_current"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_BLACK\t\"\\x1B[0;30m\"\n\nstatic GMainLoop *main_loop;\nstatic GList *test_list;\nstatic GList *test_current;\nstatic GTimer *test_timer;\n\nstatic void next_test_case(void)\n{\n\tstruct test_case *test;\n\n\tif (test_current)\n\t\ttest_current = g_list_next(test_current);\n\telse\n\t\ttest_current = test_list;\n\n\tif (!test_current) {\n\t\tg_timer_stop(test_timer);\n\n\t\tg_main_loop_quit(main_loop);\n\t\treturn;\n\t}\n\n\ttest = test_current->data;\n\n\tprintf(\"\\n\");\n\tprint_progress(test->name, COLOR_BLACK, \"init\");\n\n\ttest->start_time = g_timer_elapsed(test_timer, NULL);\n\n\tif (test->timeout > 0)\n\t\ttest->timeout_id = g_timeout_add_seconds(test->timeout,\n\t\t\t\t\t\t\ttest_timeout, test);\n\n\ttest->stage = TEST_STAGE_PRE_SETUP;\n\n\ttest->pre_setup_func(test->test_data);\n}"
  },
  {
    "function_name": "test_timeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "347-362",
    "snippet": "static gboolean test_timeout(gpointer user_data)\n{\n\tstruct test_case *test = user_data;\n\n\ttest->timeout_id = 0;\n\n\tif (!test_current)\n\t\treturn FALSE;\n\n\ttest->result = TEST_RESULT_TIMED_OUT;\n\tprint_progress(test->name, COLOR_RED, \"test timed out\");\n\n\tg_idle_add(teardown_callback, test);\n\n\treturn FALSE;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_RED\t\"\\x1B[0;31m\""
    ],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_idle_add",
          "args": [
            "teardown_callback",
            "test"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_RED",
            "\"test timed out\""
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_RED\t\"\\x1B[0;31m\"\n\nstatic GList *test_current;\n\nstatic gboolean test_timeout(gpointer user_data)\n{\n\tstruct test_case *test = user_data;\n\n\ttest->timeout_id = 0;\n\n\tif (!test_current)\n\t\treturn FALSE;\n\n\ttest->result = TEST_RESULT_TIMED_OUT;\n\tprint_progress(test->name, COLOR_RED, \"test timed out\");\n\n\tg_idle_add(teardown_callback, test);\n\n\treturn FALSE;\n}"
  },
  {
    "function_name": "teardown_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "330-345",
    "snippet": "static gboolean teardown_callback(gpointer user_data)\n{\n\tstruct test_case *test = user_data;\n\n\ttest->teardown_id = 0;\n\ttest->stage = TEST_STAGE_TEARDOWN;\n\n\tprint_progress(test->name, COLOR_MAGENTA, \"teardown\");\n\ttest->teardown_func(test->test_data);\n\n#ifdef HAVE_VALGRIND_MEMCHECK_H\n\tVALGRIND_DO_ADDED_LEAK_CHECK;\n#endif\n\n\treturn FALSE;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_MAGENTA\t\"\\x1B[0;35m\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test->teardown_func",
          "args": [
            "test->test_data"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_progress",
          "args": [
            "test->name",
            "COLOR_MAGENTA",
            "\"teardown\""
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_MAGENTA\t\"\\x1B[0;35m\"\n\nstatic gboolean teardown_callback(gpointer user_data)\n{\n\tstruct test_case *test = user_data;\n\n\ttest->teardown_id = 0;\n\ttest->stage = TEST_STAGE_TEARDOWN;\n\n\tprint_progress(test->name, COLOR_MAGENTA, \"teardown\");\n\ttest->teardown_func(test->test_data);\n\n#ifdef HAVE_VALGRIND_MEMCHECK_H\n\tVALGRIND_DO_ADDED_LEAK_CHECK;\n#endif\n\n\treturn FALSE;\n}"
  },
  {
    "function_name": "tester_summarize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "275-328",
    "snippet": "static int tester_summarize(void)\n{\n\tunsigned int not_run = 0, passed = 0, failed = 0;\n\tgdouble execution_time;\n\tGList *list;\n\n\tprintf(\"\\n\");\n\tprint_text(COLOR_HIGHLIGHT, \"\");\n\tprint_text(COLOR_HIGHLIGHT, \"Test Summary\");\n\tprint_text(COLOR_HIGHLIGHT, \"------------\");\n\n\tfor (list = g_list_first(test_list); list; list = g_list_next(list)) {\n\t\tstruct test_case *test = list->data;\n\t\tgdouble exec_time;\n\n\t\texec_time = test->end_time - test->start_time;\n\n\t\tswitch (test->result) {\n\t\tcase TEST_RESULT_NOT_RUN:\n\t\t\tprint_summary(test->name, COLOR_YELLOW, \"Not Run\", \"\");\n\t\t\tnot_run++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_PASSED:\n\t\t\tprint_summary(test->name, COLOR_GREEN, \"Passed\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tpassed++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_FAILED:\n\t\t\tprint_summary(test->name, COLOR_RED, \"Failed\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tfailed++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_TIMED_OUT:\n\t\t\tprint_summary(test->name, COLOR_RED, \"Timed out\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tfailed++;\n\t\t\tbreak;\n\t\t}\n        }\n\n\tprintf(\"\\nTotal: %d, \"\n\t\tCOLOR_GREEN \"Passed: %d (%.1f%%)\" COLOR_OFF \", \"\n\t\tCOLOR_RED \"Failed: %d\" COLOR_OFF \", \"\n\t\tCOLOR_YELLOW \"Not Run: %d\" COLOR_OFF \"\\n\",\n\t\t\tnot_run + passed + failed, passed,\n\t\t\t(not_run + passed + failed) ?\n\t\t\t(float) passed * 100 / (not_run + passed + failed) : 0,\n\t\t\tfailed, not_run);\n\n\texecution_time = g_timer_elapsed(test_timer, NULL);\n\tprintf(\"Overall execution time: %.3g seconds\\n\", execution_time);\n\n\treturn failed;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_HIGHLIGHT\t\"\\x1B[1;39m\"",
      "#define COLOR_YELLOW\t\"\\x1B[0;33m\"",
      "#define COLOR_GREEN\t\"\\x1B[0;32m\"",
      "#define COLOR_RED\t\"\\x1B[0;31m\"",
      "#define COLOR_OFF\t\"\\x1B[0m\""
    ],
    "globals_used": [
      "static GList *test_list;",
      "static GTimer *test_timer;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Overall execution time: %.3g seconds\\n\"",
            "execution_time"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "ringbuf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ringbuf.c",
          "lines": "208-218",
          "snippet": "int ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}",
          "includes": [
            "#include \"src/shared/ringbuf.h\"",
            "#include \"src/shared/util.h\"",
            "#include <sys/param.h>",
            "#include <sys/uio.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/ringbuf.h\"\n#include \"src/shared/util.h\"\n#include <sys/param.h>\n#include <sys/uio.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nint ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_timer_elapsed",
          "args": [
            "test_timer",
            "NULL"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_summary",
          "args": [
            "test->name",
            "COLOR_RED",
            "\"Timed out\"",
            "\"%8.3f seconds\"",
            "exec_time"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_summary",
          "args": [
            "test->name",
            "COLOR_RED",
            "\"Failed\"",
            "\"%8.3f seconds\"",
            "exec_time"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_summary",
          "args": [
            "test->name",
            "COLOR_GREEN",
            "\"Passed\"",
            "\"%8.3f seconds\"",
            "exec_time"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_summary",
          "args": [
            "test->name",
            "COLOR_YELLOW",
            "\"Not Run\"",
            "\"\""
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_list_next",
          "args": [
            "list"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_list_first",
          "args": [
            "test_list"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_text",
          "args": [
            "COLOR_HIGHLIGHT",
            "\"------------\""
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_text",
          "args": [
            "COLOR_HIGHLIGHT",
            "\"Test Summary\""
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_text",
          "args": [
            "COLOR_HIGHLIGHT",
            "\"\""
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "bt_shell_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/shell.c",
          "lines": "458-498",
          "snippet": "void bt_shell_printf(const char *fmt, ...)\n{\n\tva_list args;\n\tbool save_input;\n\tchar *saved_line;\n\tint saved_point;\n\n\tif (!data.input)\n\t\treturn;\n\n\tif (data.mode) {\n\t\tva_start(args, fmt);\n\t\tvprintf(fmt, args);\n\t\tva_end(args);\n\t\treturn;\n\t}\n\n\tsave_input = !RL_ISSTATE(RL_STATE_DONE);\n\n\tif (save_input) {\n\t\tsaved_point = rl_point;\n\t\tsaved_line = rl_copy_text(0, rl_end);\n\t\tif (!data.saved_prompt)\n\t\t\trl_save_prompt();\n\t\trl_replace_line(\"\", 0);\n\t\trl_redisplay();\n\t}\n\n\tva_start(args, fmt);\n\tvprintf(fmt, args);\n\tva_end(args);\n\n\tif (save_input) {\n\t\tif (!data.saved_prompt)\n\t\t\trl_restore_prompt();\n\t\trl_replace_line(saved_line, 0);\n\t\trl_point = saved_point;\n\t\trl_forced_update_display();\n\t\tfree(saved_line);\n\t}\n}",
          "includes": [
            "#include \"src/shared/shell.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/io.h\"",
            "#include \"src/shared/timeout.h\"",
            "#include \"src/shared/mainloop.h\"",
            "#include <readline/history.h>",
            "#include <readline/readline.h>",
            "#include <getopt.h>",
            "#include <wordexp.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <stdbool.h>",
            "#include <stdarg.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static wordexp_t args;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/shell.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/io.h\"\n#include \"src/shared/timeout.h\"\n#include \"src/shared/mainloop.h\"\n#include <readline/history.h>\n#include <readline/readline.h>\n#include <getopt.h>\n#include <wordexp.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <stdbool.h>\n#include <stdarg.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic wordexp_t args;\n\nvoid bt_shell_printf(const char *fmt, ...)\n{\n\tva_list args;\n\tbool save_input;\n\tchar *saved_line;\n\tint saved_point;\n\n\tif (!data.input)\n\t\treturn;\n\n\tif (data.mode) {\n\t\tva_start(args, fmt);\n\t\tvprintf(fmt, args);\n\t\tva_end(args);\n\t\treturn;\n\t}\n\n\tsave_input = !RL_ISSTATE(RL_STATE_DONE);\n\n\tif (save_input) {\n\t\tsaved_point = rl_point;\n\t\tsaved_line = rl_copy_text(0, rl_end);\n\t\tif (!data.saved_prompt)\n\t\t\trl_save_prompt();\n\t\trl_replace_line(\"\", 0);\n\t\trl_redisplay();\n\t}\n\n\tva_start(args, fmt);\n\tvprintf(fmt, args);\n\tva_end(args);\n\n\tif (save_input) {\n\t\tif (!data.saved_prompt)\n\t\t\trl_restore_prompt();\n\t\trl_replace_line(saved_line, 0);\n\t\trl_point = saved_point;\n\t\trl_forced_update_display();\n\t\tfree(saved_line);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_HIGHLIGHT\t\"\\x1B[1;39m\"\n#define COLOR_YELLOW\t\"\\x1B[0;33m\"\n#define COLOR_GREEN\t\"\\x1B[0;32m\"\n#define COLOR_RED\t\"\\x1B[0;31m\"\n#define COLOR_OFF\t\"\\x1B[0m\"\n\nstatic GList *test_list;\nstatic GTimer *test_timer;\n\nstatic int tester_summarize(void)\n{\n\tunsigned int not_run = 0, passed = 0, failed = 0;\n\tgdouble execution_time;\n\tGList *list;\n\n\tprintf(\"\\n\");\n\tprint_text(COLOR_HIGHLIGHT, \"\");\n\tprint_text(COLOR_HIGHLIGHT, \"Test Summary\");\n\tprint_text(COLOR_HIGHLIGHT, \"------------\");\n\n\tfor (list = g_list_first(test_list); list; list = g_list_next(list)) {\n\t\tstruct test_case *test = list->data;\n\t\tgdouble exec_time;\n\n\t\texec_time = test->end_time - test->start_time;\n\n\t\tswitch (test->result) {\n\t\tcase TEST_RESULT_NOT_RUN:\n\t\t\tprint_summary(test->name, COLOR_YELLOW, \"Not Run\", \"\");\n\t\t\tnot_run++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_PASSED:\n\t\t\tprint_summary(test->name, COLOR_GREEN, \"Passed\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tpassed++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_FAILED:\n\t\t\tprint_summary(test->name, COLOR_RED, \"Failed\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tfailed++;\n\t\t\tbreak;\n\t\tcase TEST_RESULT_TIMED_OUT:\n\t\t\tprint_summary(test->name, COLOR_RED, \"Timed out\",\n\t\t\t\t\t\t\"%8.3f seconds\", exec_time);\n\t\t\tfailed++;\n\t\t\tbreak;\n\t\t}\n        }\n\n\tprintf(\"\\nTotal: %d, \"\n\t\tCOLOR_GREEN \"Passed: %d (%.1f%%)\" COLOR_OFF \", \"\n\t\tCOLOR_RED \"Failed: %d\" COLOR_OFF \", \"\n\t\tCOLOR_YELLOW \"Not Run: %d\" COLOR_OFF \"\\n\",\n\t\t\tnot_run + passed + failed, passed,\n\t\t\t(not_run + passed + failed) ?\n\t\t\t(float) passed * 100 / (not_run + passed + failed) : 0,\n\t\t\tfailed, not_run);\n\n\texecution_time = g_timer_elapsed(test_timer, NULL);\n\tprintf(\"Overall execution time: %.3g seconds\\n\", execution_time);\n\n\treturn failed;\n}"
  },
  {
    "function_name": "tester_get_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "263-273",
    "snippet": "void *tester_get_data(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn NULL;\n\n\ttest = test_current->data;\n\n\treturn test->user_data;\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GList *test_current;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GList *test_current;\n\nvoid *tester_get_data(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn NULL;\n\n\ttest = test_current->data;\n\n\treturn test->user_data;\n}"
  },
  {
    "function_name": "tester_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "254-261",
    "snippet": "void tester_add(const char *name, const void *test_data,\n\t\t\t\t\ttester_data_func_t setup_func,\n\t\t\t\t\ttester_data_func_t test_func,\n\t\t\t\t\ttester_data_func_t teardown_func)\n{\n\ttester_add_full(name, test_data, NULL, setup_func, test_func,\n\t\t\t\t\tteardown_func, NULL, 0, NULL, NULL);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tester_add_full",
          "args": [
            "name",
            "test_data",
            "NULL",
            "setup_func",
            "test_func",
            "teardown_func",
            "NULL",
            "0",
            "NULL",
            "NULL"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "tester_add_full",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "190-252",
          "snippet": "void tester_add_full(const char *name, const void *test_data,\n\t\t\t\ttester_data_func_t pre_setup_func,\n\t\t\t\ttester_data_func_t setup_func,\n\t\t\t\ttester_data_func_t test_func,\n\t\t\t\ttester_data_func_t teardown_func,\n\t\t\t\ttester_data_func_t post_teardown_func,\n\t\t\t\tunsigned int timeout,\n\t\t\t\tvoid *user_data, tester_destroy_func_t destroy)\n{\n\tstruct test_case *test;\n\n\tif (!test_func)\n\t\treturn;\n\n\tif (option_prefix && !g_str_has_prefix(name, option_prefix)) {\n\t\tif (destroy)\n\t\t\tdestroy(user_data);\n\t\treturn;\n\t}\n\n\tif (option_list) {\n\t\tprintf(\"%s\\n\", name);\n\t\tif (destroy)\n\t\t\tdestroy(user_data);\n\t\treturn;\n\t}\n\n\ttest = new0(struct test_case, 1);\n\ttest->name = strdup(name);\n\ttest->result = TEST_RESULT_NOT_RUN;\n\ttest->stage = TEST_STAGE_INVALID;\n\n\ttest->test_data = test_data;\n\n\tif (pre_setup_func)\n\t\ttest->pre_setup_func = pre_setup_func;\n\telse\n\t\ttest->pre_setup_func = default_pre_setup;\n\n\tif (setup_func)\n\t\ttest->setup_func = setup_func;\n\telse\n\t\ttest->setup_func = default_setup;\n\n\ttest->test_func = test_func;\n\n\tif (teardown_func)\n\t\ttest->teardown_func = teardown_func;\n\telse\n\t\ttest->teardown_func = default_teardown;\n\n\tif (post_teardown_func)\n\t\ttest->post_teardown_func = post_teardown_func;\n\telse\n\t\ttest->post_teardown_func = default_post_teardown;\n\n\ttest->timeout = timeout;\n\n\ttest->destroy = destroy;\n\ttest->user_data = user_data;\n\n\ttest_list = g_list_append(test_list, test);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static GList *test_list;",
            "static gboolean option_list = FALSE;",
            "static const char *option_prefix = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GList *test_list;\nstatic gboolean option_list = FALSE;\nstatic const char *option_prefix = NULL;\n\nvoid tester_add_full(const char *name, const void *test_data,\n\t\t\t\ttester_data_func_t pre_setup_func,\n\t\t\t\ttester_data_func_t setup_func,\n\t\t\t\ttester_data_func_t test_func,\n\t\t\t\ttester_data_func_t teardown_func,\n\t\t\t\ttester_data_func_t post_teardown_func,\n\t\t\t\tunsigned int timeout,\n\t\t\t\tvoid *user_data, tester_destroy_func_t destroy)\n{\n\tstruct test_case *test;\n\n\tif (!test_func)\n\t\treturn;\n\n\tif (option_prefix && !g_str_has_prefix(name, option_prefix)) {\n\t\tif (destroy)\n\t\t\tdestroy(user_data);\n\t\treturn;\n\t}\n\n\tif (option_list) {\n\t\tprintf(\"%s\\n\", name);\n\t\tif (destroy)\n\t\t\tdestroy(user_data);\n\t\treturn;\n\t}\n\n\ttest = new0(struct test_case, 1);\n\ttest->name = strdup(name);\n\ttest->result = TEST_RESULT_NOT_RUN;\n\ttest->stage = TEST_STAGE_INVALID;\n\n\ttest->test_data = test_data;\n\n\tif (pre_setup_func)\n\t\ttest->pre_setup_func = pre_setup_func;\n\telse\n\t\ttest->pre_setup_func = default_pre_setup;\n\n\tif (setup_func)\n\t\ttest->setup_func = setup_func;\n\telse\n\t\ttest->setup_func = default_setup;\n\n\ttest->test_func = test_func;\n\n\tif (teardown_func)\n\t\ttest->teardown_func = teardown_func;\n\telse\n\t\ttest->teardown_func = default_teardown;\n\n\tif (post_teardown_func)\n\t\ttest->post_teardown_func = post_teardown_func;\n\telse\n\t\ttest->post_teardown_func = default_post_teardown;\n\n\ttest->timeout = timeout;\n\n\ttest->destroy = destroy;\n\ttest->user_data = user_data;\n\n\ttest_list = g_list_append(test_list, test);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid tester_add(const char *name, const void *test_data,\n\t\t\t\t\ttester_data_func_t setup_func,\n\t\t\t\t\ttester_data_func_t test_func,\n\t\t\t\t\ttester_data_func_t teardown_func)\n{\n\ttester_add_full(name, test_data, NULL, setup_func, test_func,\n\t\t\t\t\tteardown_func, NULL, 0, NULL, NULL);\n}"
  },
  {
    "function_name": "tester_add_full",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "190-252",
    "snippet": "void tester_add_full(const char *name, const void *test_data,\n\t\t\t\ttester_data_func_t pre_setup_func,\n\t\t\t\ttester_data_func_t setup_func,\n\t\t\t\ttester_data_func_t test_func,\n\t\t\t\ttester_data_func_t teardown_func,\n\t\t\t\ttester_data_func_t post_teardown_func,\n\t\t\t\tunsigned int timeout,\n\t\t\t\tvoid *user_data, tester_destroy_func_t destroy)\n{\n\tstruct test_case *test;\n\n\tif (!test_func)\n\t\treturn;\n\n\tif (option_prefix && !g_str_has_prefix(name, option_prefix)) {\n\t\tif (destroy)\n\t\t\tdestroy(user_data);\n\t\treturn;\n\t}\n\n\tif (option_list) {\n\t\tprintf(\"%s\\n\", name);\n\t\tif (destroy)\n\t\t\tdestroy(user_data);\n\t\treturn;\n\t}\n\n\ttest = new0(struct test_case, 1);\n\ttest->name = strdup(name);\n\ttest->result = TEST_RESULT_NOT_RUN;\n\ttest->stage = TEST_STAGE_INVALID;\n\n\ttest->test_data = test_data;\n\n\tif (pre_setup_func)\n\t\ttest->pre_setup_func = pre_setup_func;\n\telse\n\t\ttest->pre_setup_func = default_pre_setup;\n\n\tif (setup_func)\n\t\ttest->setup_func = setup_func;\n\telse\n\t\ttest->setup_func = default_setup;\n\n\ttest->test_func = test_func;\n\n\tif (teardown_func)\n\t\ttest->teardown_func = teardown_func;\n\telse\n\t\ttest->teardown_func = default_teardown;\n\n\tif (post_teardown_func)\n\t\ttest->post_teardown_func = post_teardown_func;\n\telse\n\t\ttest->post_teardown_func = default_post_teardown;\n\n\ttest->timeout = timeout;\n\n\ttest->destroy = destroy;\n\ttest->user_data = user_data;\n\n\ttest_list = g_list_append(test_list, test);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GList *test_list;",
      "static gboolean option_list = FALSE;",
      "static const char *option_prefix = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_list_append",
          "args": [
            "test_list",
            "test"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "name"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new0",
          "args": [
            "structtest_case",
            "1"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "destroy",
          "args": [
            "user_data"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "test_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "114-129",
          "snippet": "static void test_destroy(gpointer data)\n{\n\tstruct test_case *test = data;\n\n\tif (test->timeout_id > 0)\n\t\tg_source_remove(test->timeout_id);\n\n\tif (test->teardown_id > 0)\n\t\tg_source_remove(test->teardown_id);\n\n\tif (test->destroy)\n\t\ttest->destroy(test->user_data);\n\n\tfree(test->name);\n\tfree(test);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void test_destroy(gpointer data)\n{\n\tstruct test_case *test = data;\n\n\tif (test->timeout_id > 0)\n\t\tg_source_remove(test->timeout_id);\n\n\tif (test->teardown_id > 0)\n\t\tg_source_remove(test->teardown_id);\n\n\tif (test->destroy)\n\t\ttest->destroy(test->user_data);\n\n\tfree(test->name);\n\tfree(test);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "name"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "ringbuf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ringbuf.c",
          "lines": "208-218",
          "snippet": "int ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}",
          "includes": [
            "#include \"src/shared/ringbuf.h\"",
            "#include \"src/shared/util.h\"",
            "#include <sys/param.h>",
            "#include <sys/uio.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/ringbuf.h\"\n#include \"src/shared/util.h\"\n#include <sys/param.h>\n#include <sys/uio.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nint ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_str_has_prefix",
          "args": [
            "name",
            "option_prefix"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GList *test_list;\nstatic gboolean option_list = FALSE;\nstatic const char *option_prefix = NULL;\n\nvoid tester_add_full(const char *name, const void *test_data,\n\t\t\t\ttester_data_func_t pre_setup_func,\n\t\t\t\ttester_data_func_t setup_func,\n\t\t\t\ttester_data_func_t test_func,\n\t\t\t\ttester_data_func_t teardown_func,\n\t\t\t\ttester_data_func_t post_teardown_func,\n\t\t\t\tunsigned int timeout,\n\t\t\t\tvoid *user_data, tester_destroy_func_t destroy)\n{\n\tstruct test_case *test;\n\n\tif (!test_func)\n\t\treturn;\n\n\tif (option_prefix && !g_str_has_prefix(name, option_prefix)) {\n\t\tif (destroy)\n\t\t\tdestroy(user_data);\n\t\treturn;\n\t}\n\n\tif (option_list) {\n\t\tprintf(\"%s\\n\", name);\n\t\tif (destroy)\n\t\t\tdestroy(user_data);\n\t\treturn;\n\t}\n\n\ttest = new0(struct test_case, 1);\n\ttest->name = strdup(name);\n\ttest->result = TEST_RESULT_NOT_RUN;\n\ttest->stage = TEST_STAGE_INVALID;\n\n\ttest->test_data = test_data;\n\n\tif (pre_setup_func)\n\t\ttest->pre_setup_func = pre_setup_func;\n\telse\n\t\ttest->pre_setup_func = default_pre_setup;\n\n\tif (setup_func)\n\t\ttest->setup_func = setup_func;\n\telse\n\t\ttest->setup_func = default_setup;\n\n\ttest->test_func = test_func;\n\n\tif (teardown_func)\n\t\ttest->teardown_func = teardown_func;\n\telse\n\t\ttest->teardown_func = default_teardown;\n\n\tif (post_teardown_func)\n\t\ttest->post_teardown_func = post_teardown_func;\n\telse\n\t\ttest->post_teardown_func = default_post_teardown;\n\n\ttest->timeout = timeout;\n\n\ttest->destroy = destroy;\n\ttest->user_data = user_data;\n\n\ttest_list = g_list_append(test_list, test);\n}"
  },
  {
    "function_name": "default_post_teardown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "185-188",
    "snippet": "static void default_post_teardown(const void *test_data)\n{\n\ttester_post_teardown_complete();\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tester_post_teardown_complete",
          "args": [],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "tester_post_teardown_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "594-609",
          "snippet": "void tester_post_teardown_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_POST_TEARDOWN)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_MAGENTA, \"teardown complete\");\n\n\tg_idle_add(done_callback, test);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define COLOR_MAGENTA\t\"\\x1B[0;35m\""
          ],
          "globals_used": [
            "static GList *test_current;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_MAGENTA\t\"\\x1B[0;35m\"\n\nstatic GList *test_current;\n\nvoid tester_post_teardown_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_POST_TEARDOWN)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_MAGENTA, \"teardown complete\");\n\n\tg_idle_add(done_callback, test);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void default_post_teardown(const void *test_data)\n{\n\ttester_post_teardown_complete();\n}"
  },
  {
    "function_name": "default_teardown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "180-183",
    "snippet": "static void default_teardown(const void *test_data)\n{\n\ttester_teardown_complete();\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tester_teardown_complete",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "tester_teardown_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "560-575",
          "snippet": "void tester_teardown_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_TEARDOWN)\n\t\treturn;\n\n\ttest->stage = TEST_STAGE_POST_TEARDOWN;\n\n\ttest->post_teardown_func(test->test_data);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static GList *test_current;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GList *test_current;\n\nvoid tester_teardown_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_TEARDOWN)\n\t\treturn;\n\n\ttest->stage = TEST_STAGE_POST_TEARDOWN;\n\n\ttest->post_teardown_func(test->test_data);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void default_teardown(const void *test_data)\n{\n\ttester_teardown_complete();\n}"
  },
  {
    "function_name": "default_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "175-178",
    "snippet": "static void default_setup(const void *test_data)\n{\n\ttester_setup_complete();\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tester_setup_complete",
          "args": [],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "tester_setup_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "464-479",
          "snippet": "void tester_setup_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_SETUP)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_BLUE, \"setup complete\");\n\n\tg_idle_add(run_callback, test);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define COLOR_BLUE\t\"\\x1B[0;34m\""
          ],
          "globals_used": [
            "static GList *test_current;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_BLUE\t\"\\x1B[0;34m\"\n\nstatic GList *test_current;\n\nvoid tester_setup_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_SETUP)\n\t\treturn;\n\n\tprint_progress(test->name, COLOR_BLUE, \"setup complete\");\n\n\tg_idle_add(run_callback, test);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void default_setup(const void *test_data)\n{\n\ttester_setup_complete();\n}"
  },
  {
    "function_name": "default_pre_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "170-173",
    "snippet": "static void default_pre_setup(const void *test_data)\n{\n\ttester_pre_setup_complete();\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tester_pre_setup_complete",
          "args": [],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "tester_pre_setup_complete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "432-445",
          "snippet": "void tester_pre_setup_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_PRE_SETUP)\n\t\treturn;\n\n\tg_idle_add(setup_callback, test);\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static GList *test_current;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GList *test_current;\n\nvoid tester_pre_setup_complete(void)\n{\n\tstruct test_case *test;\n\n\tif (!test_current)\n\t\treturn;\n\n\ttest = test_current->data;\n\n\tif (test->stage != TEST_STAGE_PRE_SETUP)\n\t\treturn;\n\n\tg_idle_add(setup_callback, test);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void default_pre_setup(const void *test_data)\n{\n\ttester_pre_setup_complete();\n}"
  },
  {
    "function_name": "tester_warn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "159-168",
    "snippet": "void tester_warn(const char *format, ...)\n{\n\tva_list ap;\n\n\tprintf(\"  %s\", COLOR_WHITE);\n\tva_start(ap, format);\n\tvprintf(format, ap);\n\tva_end(ap);\n\tprintf(\"%s\\n\", COLOR_OFF);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_WHITE\t\"\\x1B[0;37m\"",
      "#define COLOR_OFF\t\"\\x1B[0m\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "COLOR_OFF"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "ringbuf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ringbuf.c",
          "lines": "208-218",
          "snippet": "int ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}",
          "includes": [
            "#include \"src/shared/ringbuf.h\"",
            "#include \"src/shared/util.h\"",
            "#include <sys/param.h>",
            "#include <sys/uio.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/ringbuf.h\"\n#include \"src/shared/util.h\"\n#include <sys/param.h>\n#include <sys/uio.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nint ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vprintf",
          "args": [
            "format",
            "ap"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_WHITE\t\"\\x1B[0;37m\"\n#define COLOR_OFF\t\"\\x1B[0m\"\n\nvoid tester_warn(const char *format, ...)\n{\n\tva_list ap;\n\n\tprintf(\"  %s\", COLOR_WHITE);\n\tva_start(ap, format);\n\tvprintf(format, ap);\n\tva_end(ap);\n\tprintf(\"%s\\n\", COLOR_OFF);\n}"
  },
  {
    "function_name": "tester_debug",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "145-157",
    "snippet": "void tester_debug(const char *format, ...)\n{\n\tva_list ap;\n\n\tif (!tester_use_debug())\n\t\treturn;\n\n\tprintf(\"  %s\", COLOR_WHITE);\n\tva_start(ap, format);\n\tvprintf(format, ap);\n\tva_end(ap);\n\tprintf(\"%s\\n\", COLOR_OFF);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_WHITE\t\"\\x1B[0;37m\"",
      "#define COLOR_OFF\t\"\\x1B[0m\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "COLOR_OFF"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "ringbuf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ringbuf.c",
          "lines": "208-218",
          "snippet": "int ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}",
          "includes": [
            "#include \"src/shared/ringbuf.h\"",
            "#include \"src/shared/util.h\"",
            "#include <sys/param.h>",
            "#include <sys/uio.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/ringbuf.h\"\n#include \"src/shared/util.h\"\n#include <sys/param.h>\n#include <sys/uio.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nint ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vprintf",
          "args": [
            "format",
            "ap"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tester_use_debug",
          "args": [],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "tester_use_debug",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "765-768",
          "snippet": "bool tester_use_debug(void)\n{\n\treturn option_debug == TRUE ? true : false;\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static gboolean option_debug = FALSE;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gboolean option_debug = FALSE;\n\nbool tester_use_debug(void)\n{\n\treturn option_debug == TRUE ? true : false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_WHITE\t\"\\x1B[0;37m\"\n#define COLOR_OFF\t\"\\x1B[0m\"\n\nvoid tester_debug(const char *format, ...)\n{\n\tva_list ap;\n\n\tif (!tester_use_debug())\n\t\treturn;\n\n\tprintf(\"  %s\", COLOR_WHITE);\n\tva_start(ap, format);\n\tvprintf(format, ap);\n\tva_end(ap);\n\tprintf(\"%s\\n\", COLOR_OFF);\n}"
  },
  {
    "function_name": "tester_print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "131-143",
    "snippet": "void tester_print(const char *format, ...)\n{\n\tva_list ap;\n\n\tif (tester_use_quiet())\n\t\treturn;\n\n\tprintf(\"  %s\", COLOR_WHITE);\n\tva_start(ap, format);\n\tvprintf(format, ap);\n\tva_end(ap);\n\tprintf(\"%s\\n\", COLOR_OFF);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define COLOR_WHITE\t\"\\x1B[0;37m\"",
      "#define COLOR_OFF\t\"\\x1B[0m\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "COLOR_OFF"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "ringbuf_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ringbuf.c",
          "lines": "208-218",
          "snippet": "int ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}",
          "includes": [
            "#include \"src/shared/ringbuf.h\"",
            "#include \"src/shared/util.h\"",
            "#include <sys/param.h>",
            "#include <sys/uio.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/ringbuf.h\"\n#include \"src/shared/util.h\"\n#include <sys/param.h>\n#include <sys/uio.h>\n#include <string.h>\n#include <stdio.h>\n#include <config.h>\n\nint ringbuf_printf(struct ringbuf *ringbuf, const char *format, ...)\n{\n\tva_list ap;\n\tint len;\n\n\tva_start(ap, format);\n\tlen = ringbuf_vprintf(ringbuf, format, ap);\n\tva_end(ap);\n\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vprintf",
          "args": [
            "format",
            "ap"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tester_use_quiet",
          "args": [],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "tester_use_quiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
          "lines": "760-763",
          "snippet": "bool tester_use_quiet(void)\n{\n\treturn option_quiet == TRUE ? true : false;\n}",
          "includes": [
            "#include \"src/shared/tester.h\"",
            "#include \"src/shared/util.h\"",
            "#include <valgrind/memcheck.h>",
            "#include <glib.h>",
            "#include <sys/signalfd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static gboolean option_quiet = FALSE;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gboolean option_quiet = FALSE;\n\nbool tester_use_quiet(void)\n{\n\treturn option_quiet == TRUE ? true : false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define COLOR_WHITE\t\"\\x1B[0;37m\"\n#define COLOR_OFF\t\"\\x1B[0m\"\n\nvoid tester_print(const char *format, ...)\n{\n\tva_list ap;\n\n\tif (tester_use_quiet())\n\t\treturn;\n\n\tprintf(\"  %s\", COLOR_WHITE);\n\tva_start(ap, format);\n\tvprintf(format, ap);\n\tva_end(ap);\n\tprintf(\"%s\\n\", COLOR_OFF);\n}"
  },
  {
    "function_name": "test_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/tester.c",
    "lines": "114-129",
    "snippet": "static void test_destroy(gpointer data)\n{\n\tstruct test_case *test = data;\n\n\tif (test->timeout_id > 0)\n\t\tg_source_remove(test->timeout_id);\n\n\tif (test->teardown_id > 0)\n\t\tg_source_remove(test->teardown_id);\n\n\tif (test->destroy)\n\t\ttest->destroy(test->user_data);\n\n\tfree(test->name);\n\tfree(test);\n}",
    "includes": [
      "#include \"src/shared/tester.h\"",
      "#include \"src/shared/util.h\"",
      "#include <valgrind/memcheck.h>",
      "#include <glib.h>",
      "#include <sys/signalfd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "test"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "bt_att_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/att.c",
          "lines": "956-985",
          "snippet": "static void bt_att_free(struct bt_att *att)\n{\n\tif (att->pending_req)\n\t\tdestroy_att_send_op(att->pending_req);\n\n\tif (att->pending_ind)\n\t\tdestroy_att_send_op(att->pending_ind);\n\n\tio_destroy(att->io);\n\tbt_crypto_unref(att->crypto);\n\n\tqueue_destroy(att->req_queue, NULL);\n\tqueue_destroy(att->ind_queue, NULL);\n\tqueue_destroy(att->write_queue, NULL);\n\tqueue_destroy(att->notify_list, NULL);\n\tqueue_destroy(att->disconn_list, NULL);\n\n\tif (att->timeout_destroy)\n\t\tatt->timeout_destroy(att->timeout_data);\n\n\tif (att->debug_destroy)\n\t\tatt->debug_destroy(att->debug_data);\n\n\tfree(att->local_sign);\n\tfree(att->remote_sign);\n\n\tfree(att->buf);\n\n\tfree(att);\n}",
          "includes": [
            "#include \"src/shared/crypto.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/l2cap.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include \"src/shared/timeout.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/io.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/crypto.h\"\n#include \"src/shared/att.h\"\n#include \"lib/uuid.h\"\n#include \"lib/l2cap.h\"\n#include \"lib/bluetooth.h\"\n#include \"src/shared/timeout.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/io.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic void bt_att_free(struct bt_att *att)\n{\n\tif (att->pending_req)\n\t\tdestroy_att_send_op(att->pending_req);\n\n\tif (att->pending_ind)\n\t\tdestroy_att_send_op(att->pending_ind);\n\n\tio_destroy(att->io);\n\tbt_crypto_unref(att->crypto);\n\n\tqueue_destroy(att->req_queue, NULL);\n\tqueue_destroy(att->ind_queue, NULL);\n\tqueue_destroy(att->write_queue, NULL);\n\tqueue_destroy(att->notify_list, NULL);\n\tqueue_destroy(att->disconn_list, NULL);\n\n\tif (att->timeout_destroy)\n\t\tatt->timeout_destroy(att->timeout_data);\n\n\tif (att->debug_destroy)\n\t\tatt->debug_destroy(att->debug_data);\n\n\tfree(att->local_sign);\n\tfree(att->remote_sign);\n\n\tfree(att->buf);\n\n\tfree(att);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test->destroy",
          "args": [
            "test->user_data"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_source_remove",
          "args": [
            "test->teardown_id"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_source_remove",
          "args": [
            "test->timeout_id"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/tester.h\"\n#include \"src/shared/util.h\"\n#include <valgrind/memcheck.h>\n#include <glib.h>\n#include <sys/signalfd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void test_destroy(gpointer data)\n{\n\tstruct test_case *test = data;\n\n\tif (test->timeout_id > 0)\n\t\tg_source_remove(test->timeout_id);\n\n\tif (test->teardown_id > 0)\n\t\tg_source_remove(test->teardown_id);\n\n\tif (test->destroy)\n\t\ttest->destroy(test->user_data);\n\n\tfree(test->name);\n\tfree(test);\n}"
  }
]