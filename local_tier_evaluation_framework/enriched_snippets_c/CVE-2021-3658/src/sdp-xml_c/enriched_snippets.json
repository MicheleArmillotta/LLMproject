[
  {
    "function_name": "convert_sdp_record_to_xml",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "999-1014",
    "snippet": "void convert_sdp_record_to_xml(sdp_record_t *rec,\n\t\t\tvoid *data, void (*appender)(void *, const char *))\n{\n\tstruct conversion_data cd;\n\n\tcd.data = data;\n\tcd.appender = appender;\n\n\tif (rec && rec->attrlist) {\n\t\tappender(data, \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n\\n\");\n\t\tappender(data, \"<record>\\n\");\n\t\tsdp_list_foreach(rec->attrlist,\n\t\t\t\t convert_raw_attr_to_xml_func, &cd);\n\t\tappender(data, \"</record>\\n\");\n\t}\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"</record>\\n\""
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_list_foreach",
          "args": [
            "rec->attrlist",
            "convert_raw_attr_to_xml_func",
            "&cd"
          ],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<record>\\n\""
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n\\n\""
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid convert_sdp_record_to_xml(sdp_record_t *rec,\n\t\t\tvoid *data, void (*appender)(void *, const char *))\n{\n\tstruct conversion_data cd;\n\n\tcd.data = data;\n\tcd.appender = appender;\n\n\tif (rec && rec->attrlist) {\n\t\tappender(data, \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\" ?>\\n\\n\");\n\t\tappender(data, \"<record>\\n\");\n\t\tsdp_list_foreach(rec->attrlist,\n\t\t\t\t convert_raw_attr_to_xml_func, &cd);\n\t\tappender(data, \"</record>\\n\");\n\t}\n}"
  },
  {
    "function_name": "convert_raw_attr_to_xml_func",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "977-991",
    "snippet": "static void convert_raw_attr_to_xml_func(void *val, void *data)\n{\n\tstruct conversion_data *cd = data;\n\tsdp_data_t *value = val;\n\tchar buf[STRBUFSIZE];\n\n\tbuf[STRBUFSIZE - 1] = '\\0';\n\tsnprintf(buf, STRBUFSIZE - 1, \"\\t<attribute id=\\\"0x%04x\\\">\\n\",\n\t\t value->attrId);\n\tcd->appender(cd->data, buf);\n\n\tconvert_raw_data_to_xml(value, 2, cd->data, cd->appender);\n\n\tcd->appender(cd->data, \"\\t</attribute>\\n\");\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define STRBUFSIZE 1024"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cd->appender",
          "args": [
            "cd->data",
            "\"\\t</attribute>\\n\""
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_raw_data_to_xml",
          "args": [
            "value",
            "2",
            "cd->data",
            "cd->appender"
          ],
          "line": 988
        },
        "resolved": true,
        "details": {
          "function_name": "convert_raw_data_to_xml",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "649-970",
          "snippet": "static void convert_raw_data_to_xml(sdp_data_t *value, int indent_level,\n\t\tvoid *data, void (*appender)(void *, const char *))\n{\n\tint i, hex;\n\tchar buf[STRBUFSIZE];\n\tchar indent[MAXINDENT];\n\n\tif (!value)\n\t\treturn;\n\n\tif (indent_level >= MAXINDENT)\n\t\tindent_level = MAXINDENT - 2;\n\n\tfor (i = 0; i < indent_level; i++)\n\t\tindent[i] = '\\t';\n\n\tindent[i] = '\\0';\n\tbuf[STRBUFSIZE - 1] = '\\0';\n\n\tswitch (value->dtd) {\n\tcase SDP_DATA_NIL:\n\t\tappender(data, indent);\n\t\tappender(data, \"<nil/>\\n\");\n\t\tbreak;\n\n\tcase SDP_BOOL:\n\t\tappender(data, indent);\n\t\tappender(data, \"<boolean value=\\\"\");\n\t\tappender(data, value->val.uint8 ? \"true\" : \"false\");\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT8:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint8 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%02x\", value->val.uint8);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint16 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%04x\", value->val.uint16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint32 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%08x\", value->val.uint32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT64:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint64 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%016jx\", value->val.uint64);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint128 value=\\\"\");\n\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tsprintf(&buf[i * 2], \"%02x\",\n\t\t\t\t(unsigned char) value->val.uint128.data[i]);\n\t\t}\n\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT8:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int8 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int8);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int16 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int32 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT64:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int64 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%jd\", value->val.int64);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int128 value=\\\"\");\n\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tsprintf(&buf[i * 2], \"%02x\",\n\t\t\t\t(unsigned char) value->val.int128.data[i]);\n\t\t}\n\t\tappender(data, buf);\n\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%04x\", value->val.uuid.value.uuid16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%08x\", value->val.uuid.value.uuid32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\n\t\tsnprintf(buf, STRBUFSIZE - 1,\n\t\t\t \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[0],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[1],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[2],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[3],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[4],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[5],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[6],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[7],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[8],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[9],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[10],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[11],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[12],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[13],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[14],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[15]);\n\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_TEXT_STR8:\n\tcase SDP_TEXT_STR16:\n\tcase SDP_TEXT_STR32:\n\t{\n\t\tint num_chars_to_escape = 0;\n\t\tint length = value->unitSize - 1;\n\t\tchar *strBuf;\n\n\t\thex = 0;\n\n\t\tfor (i = 0; i < length; i++) {\n\t\t\tif (!isprint(value->val.str[i]) &&\n\t\t\t\t\tvalue->val.str[i] != '\\0') {\n\t\t\t\thex = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* XML is evil, must do this... */\n\t\t\tif ((value->val.str[i] == '<') ||\n\t\t\t\t\t(value->val.str[i] == '>') ||\n\t\t\t\t\t(value->val.str[i] == '\"') ||\n\t\t\t\t\t(value->val.str[i] == '&'))\n\t\t\t\tnum_chars_to_escape++;\n\t\t}\n\n\t\tappender(data, indent);\n\n\t\tappender(data, \"<text \");\n\n\t\tif (hex) {\n\t\t\tappender(data, \"encoding=\\\"hex\\\" \");\n\t\t\tstrBuf = malloc(sizeof(char)\n\t\t\t\t\t\t * ((value->unitSize-1) * 2 + 1));\n\t\t\tif (!strBuf) {\n\t\t\t\tDBG(\"No memory to convert raw data to xml\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/* Unit Size seems to include the size for dtd\n\t\t\t   It is thus off by 1\n\t\t\t   This is safe for Normal strings, but not\n\t\t\t   hex encoded data */\n\t\t\tfor (i = 0; i < (value->unitSize-1); i++)\n\t\t\t\tsprintf(&strBuf[i*sizeof(char)*2],\n\t\t\t\t\t\"%02x\",\n\t\t\t\t\t(unsigned char) value->val.str[i]);\n\n\t\t\tstrBuf[(value->unitSize-1) * 2] = '\\0';\n\t\t} else {\n\t\t\tint j;\n\t\t\t/* escape the XML disallowed chars */\n\t\t\tstrBuf = malloc(sizeof(char) *\n\t\t\t\t\t(value->unitSize + 1 + num_chars_to_escape * 4));\n\t\t\tif (!strBuf) {\n\t\t\t\tDBG(\"No memory to convert raw data to xml\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfor (i = 0, j = 0; i < length; i++) {\n\t\t\t\tif (value->val.str[i] == '&') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'a';\n\t\t\t\t\tstrBuf[j++] = 'm';\n\t\t\t\t\tstrBuf[j++] = 'p';\n\t\t\t\t} else if (value->val.str[i] == '<') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'l';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '>') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'g';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '\"') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'q';\n\t\t\t\t\tstrBuf[j++] = 'u';\n\t\t\t\t\tstrBuf[j++] = 'o';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '\\0') {\n\t\t\t\t\tstrBuf[j++] = ' ';\n\t\t\t\t} else {\n\t\t\t\t\tstrBuf[j++] = value->val.str[i];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tstrBuf[j] = '\\0';\n\t\t}\n\n\t\tappender(data, \"value=\\\"\");\n\t\tappender(data, strBuf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tfree(strBuf);\n\t\tbreak;\n\t}\n\n\tcase SDP_URL_STR8:\n\tcase SDP_URL_STR16:\n\tcase SDP_URL_STR32:\n\t{\n\t\tchar *strBuf;\n\n\t\tappender(data, indent);\n\t\tappender(data, \"<url value=\\\"\");\n\t\tstrBuf = strndup(value->val.str, value->unitSize - 1);\n\t\tappender(data, strBuf);\n\t\tfree(strBuf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\t}\n\n\tcase SDP_SEQ8:\n\tcase SDP_SEQ16:\n\tcase SDP_SEQ32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<sequence>\\n\");\n\n\t\tconvert_raw_data_to_xml(value->val.dataseq,\n\t\t\t\t\tindent_level + 1, data, appender);\n\n\t\tappender(data, indent);\n\t\tappender(data, \"</sequence>\\n\");\n\n\t\tbreak;\n\n\tcase SDP_ALT8:\n\tcase SDP_ALT16:\n\tcase SDP_ALT32:\n\t\tappender(data, indent);\n\n\t\tappender(data, \"<alternate>\\n\");\n\n\t\tconvert_raw_data_to_xml(value->val.dataseq,\n\t\t\t\t\tindent_level + 1, data, appender);\n\t\tappender(data, indent);\n\n\t\tappender(data, \"</alternate>\\n\");\n\n\t\tbreak;\n\t}\n\n\tconvert_raw_data_to_xml(value->next, indent_level, data, appender);\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAXINDENT 64",
            "#define STRBUFSIZE 1024"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define MAXINDENT 64\n#define STRBUFSIZE 1024\n\nstatic void convert_raw_data_to_xml(sdp_data_t *value, int indent_level,\n\t\tvoid *data, void (*appender)(void *, const char *))\n{\n\tint i, hex;\n\tchar buf[STRBUFSIZE];\n\tchar indent[MAXINDENT];\n\n\tif (!value)\n\t\treturn;\n\n\tif (indent_level >= MAXINDENT)\n\t\tindent_level = MAXINDENT - 2;\n\n\tfor (i = 0; i < indent_level; i++)\n\t\tindent[i] = '\\t';\n\n\tindent[i] = '\\0';\n\tbuf[STRBUFSIZE - 1] = '\\0';\n\n\tswitch (value->dtd) {\n\tcase SDP_DATA_NIL:\n\t\tappender(data, indent);\n\t\tappender(data, \"<nil/>\\n\");\n\t\tbreak;\n\n\tcase SDP_BOOL:\n\t\tappender(data, indent);\n\t\tappender(data, \"<boolean value=\\\"\");\n\t\tappender(data, value->val.uint8 ? \"true\" : \"false\");\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT8:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint8 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%02x\", value->val.uint8);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint16 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%04x\", value->val.uint16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint32 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%08x\", value->val.uint32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT64:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint64 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%016jx\", value->val.uint64);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint128 value=\\\"\");\n\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tsprintf(&buf[i * 2], \"%02x\",\n\t\t\t\t(unsigned char) value->val.uint128.data[i]);\n\t\t}\n\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT8:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int8 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int8);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int16 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int32 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT64:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int64 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%jd\", value->val.int64);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int128 value=\\\"\");\n\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tsprintf(&buf[i * 2], \"%02x\",\n\t\t\t\t(unsigned char) value->val.int128.data[i]);\n\t\t}\n\t\tappender(data, buf);\n\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%04x\", value->val.uuid.value.uuid16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%08x\", value->val.uuid.value.uuid32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\n\t\tsnprintf(buf, STRBUFSIZE - 1,\n\t\t\t \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[0],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[1],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[2],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[3],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[4],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[5],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[6],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[7],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[8],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[9],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[10],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[11],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[12],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[13],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[14],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[15]);\n\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_TEXT_STR8:\n\tcase SDP_TEXT_STR16:\n\tcase SDP_TEXT_STR32:\n\t{\n\t\tint num_chars_to_escape = 0;\n\t\tint length = value->unitSize - 1;\n\t\tchar *strBuf;\n\n\t\thex = 0;\n\n\t\tfor (i = 0; i < length; i++) {\n\t\t\tif (!isprint(value->val.str[i]) &&\n\t\t\t\t\tvalue->val.str[i] != '\\0') {\n\t\t\t\thex = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* XML is evil, must do this... */\n\t\t\tif ((value->val.str[i] == '<') ||\n\t\t\t\t\t(value->val.str[i] == '>') ||\n\t\t\t\t\t(value->val.str[i] == '\"') ||\n\t\t\t\t\t(value->val.str[i] == '&'))\n\t\t\t\tnum_chars_to_escape++;\n\t\t}\n\n\t\tappender(data, indent);\n\n\t\tappender(data, \"<text \");\n\n\t\tif (hex) {\n\t\t\tappender(data, \"encoding=\\\"hex\\\" \");\n\t\t\tstrBuf = malloc(sizeof(char)\n\t\t\t\t\t\t * ((value->unitSize-1) * 2 + 1));\n\t\t\tif (!strBuf) {\n\t\t\t\tDBG(\"No memory to convert raw data to xml\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/* Unit Size seems to include the size for dtd\n\t\t\t   It is thus off by 1\n\t\t\t   This is safe for Normal strings, but not\n\t\t\t   hex encoded data */\n\t\t\tfor (i = 0; i < (value->unitSize-1); i++)\n\t\t\t\tsprintf(&strBuf[i*sizeof(char)*2],\n\t\t\t\t\t\"%02x\",\n\t\t\t\t\t(unsigned char) value->val.str[i]);\n\n\t\t\tstrBuf[(value->unitSize-1) * 2] = '\\0';\n\t\t} else {\n\t\t\tint j;\n\t\t\t/* escape the XML disallowed chars */\n\t\t\tstrBuf = malloc(sizeof(char) *\n\t\t\t\t\t(value->unitSize + 1 + num_chars_to_escape * 4));\n\t\t\tif (!strBuf) {\n\t\t\t\tDBG(\"No memory to convert raw data to xml\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfor (i = 0, j = 0; i < length; i++) {\n\t\t\t\tif (value->val.str[i] == '&') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'a';\n\t\t\t\t\tstrBuf[j++] = 'm';\n\t\t\t\t\tstrBuf[j++] = 'p';\n\t\t\t\t} else if (value->val.str[i] == '<') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'l';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '>') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'g';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '\"') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'q';\n\t\t\t\t\tstrBuf[j++] = 'u';\n\t\t\t\t\tstrBuf[j++] = 'o';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '\\0') {\n\t\t\t\t\tstrBuf[j++] = ' ';\n\t\t\t\t} else {\n\t\t\t\t\tstrBuf[j++] = value->val.str[i];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tstrBuf[j] = '\\0';\n\t\t}\n\n\t\tappender(data, \"value=\\\"\");\n\t\tappender(data, strBuf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tfree(strBuf);\n\t\tbreak;\n\t}\n\n\tcase SDP_URL_STR8:\n\tcase SDP_URL_STR16:\n\tcase SDP_URL_STR32:\n\t{\n\t\tchar *strBuf;\n\n\t\tappender(data, indent);\n\t\tappender(data, \"<url value=\\\"\");\n\t\tstrBuf = strndup(value->val.str, value->unitSize - 1);\n\t\tappender(data, strBuf);\n\t\tfree(strBuf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\t}\n\n\tcase SDP_SEQ8:\n\tcase SDP_SEQ16:\n\tcase SDP_SEQ32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<sequence>\\n\");\n\n\t\tconvert_raw_data_to_xml(value->val.dataseq,\n\t\t\t\t\tindent_level + 1, data, appender);\n\n\t\tappender(data, indent);\n\t\tappender(data, \"</sequence>\\n\");\n\n\t\tbreak;\n\n\tcase SDP_ALT8:\n\tcase SDP_ALT16:\n\tcase SDP_ALT32:\n\t\tappender(data, indent);\n\n\t\tappender(data, \"<alternate>\\n\");\n\n\t\tconvert_raw_data_to_xml(value->val.dataseq,\n\t\t\t\t\tindent_level + 1, data, appender);\n\t\tappender(data, indent);\n\n\t\tappender(data, \"</alternate>\\n\");\n\n\t\tbreak;\n\t}\n\n\tconvert_raw_data_to_xml(value->next, indent_level, data, appender);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cd->appender",
          "args": [
            "cd->data",
            "buf"
          ],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"\\t<attribute id=\\\"0x%04x\\\">\\n\"",
            "value->attrId"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define STRBUFSIZE 1024\n\nstatic void convert_raw_attr_to_xml_func(void *val, void *data)\n{\n\tstruct conversion_data *cd = data;\n\tsdp_data_t *value = val;\n\tchar buf[STRBUFSIZE];\n\n\tbuf[STRBUFSIZE - 1] = '\\0';\n\tsnprintf(buf, STRBUFSIZE - 1, \"\\t<attribute id=\\\"0x%04x\\\">\\n\",\n\t\t value->attrId);\n\tcd->appender(cd->data, buf);\n\n\tconvert_raw_data_to_xml(value, 2, cd->data, cd->appender);\n\n\tcd->appender(cd->data, \"\\t</attribute>\\n\");\n}"
  },
  {
    "function_name": "convert_raw_data_to_xml",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "649-970",
    "snippet": "static void convert_raw_data_to_xml(sdp_data_t *value, int indent_level,\n\t\tvoid *data, void (*appender)(void *, const char *))\n{\n\tint i, hex;\n\tchar buf[STRBUFSIZE];\n\tchar indent[MAXINDENT];\n\n\tif (!value)\n\t\treturn;\n\n\tif (indent_level >= MAXINDENT)\n\t\tindent_level = MAXINDENT - 2;\n\n\tfor (i = 0; i < indent_level; i++)\n\t\tindent[i] = '\\t';\n\n\tindent[i] = '\\0';\n\tbuf[STRBUFSIZE - 1] = '\\0';\n\n\tswitch (value->dtd) {\n\tcase SDP_DATA_NIL:\n\t\tappender(data, indent);\n\t\tappender(data, \"<nil/>\\n\");\n\t\tbreak;\n\n\tcase SDP_BOOL:\n\t\tappender(data, indent);\n\t\tappender(data, \"<boolean value=\\\"\");\n\t\tappender(data, value->val.uint8 ? \"true\" : \"false\");\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT8:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint8 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%02x\", value->val.uint8);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint16 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%04x\", value->val.uint16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint32 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%08x\", value->val.uint32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT64:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint64 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%016jx\", value->val.uint64);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint128 value=\\\"\");\n\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tsprintf(&buf[i * 2], \"%02x\",\n\t\t\t\t(unsigned char) value->val.uint128.data[i]);\n\t\t}\n\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT8:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int8 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int8);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int16 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int32 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT64:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int64 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%jd\", value->val.int64);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int128 value=\\\"\");\n\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tsprintf(&buf[i * 2], \"%02x\",\n\t\t\t\t(unsigned char) value->val.int128.data[i]);\n\t\t}\n\t\tappender(data, buf);\n\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%04x\", value->val.uuid.value.uuid16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%08x\", value->val.uuid.value.uuid32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\n\t\tsnprintf(buf, STRBUFSIZE - 1,\n\t\t\t \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[0],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[1],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[2],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[3],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[4],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[5],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[6],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[7],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[8],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[9],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[10],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[11],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[12],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[13],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[14],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[15]);\n\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_TEXT_STR8:\n\tcase SDP_TEXT_STR16:\n\tcase SDP_TEXT_STR32:\n\t{\n\t\tint num_chars_to_escape = 0;\n\t\tint length = value->unitSize - 1;\n\t\tchar *strBuf;\n\n\t\thex = 0;\n\n\t\tfor (i = 0; i < length; i++) {\n\t\t\tif (!isprint(value->val.str[i]) &&\n\t\t\t\t\tvalue->val.str[i] != '\\0') {\n\t\t\t\thex = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* XML is evil, must do this... */\n\t\t\tif ((value->val.str[i] == '<') ||\n\t\t\t\t\t(value->val.str[i] == '>') ||\n\t\t\t\t\t(value->val.str[i] == '\"') ||\n\t\t\t\t\t(value->val.str[i] == '&'))\n\t\t\t\tnum_chars_to_escape++;\n\t\t}\n\n\t\tappender(data, indent);\n\n\t\tappender(data, \"<text \");\n\n\t\tif (hex) {\n\t\t\tappender(data, \"encoding=\\\"hex\\\" \");\n\t\t\tstrBuf = malloc(sizeof(char)\n\t\t\t\t\t\t * ((value->unitSize-1) * 2 + 1));\n\t\t\tif (!strBuf) {\n\t\t\t\tDBG(\"No memory to convert raw data to xml\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/* Unit Size seems to include the size for dtd\n\t\t\t   It is thus off by 1\n\t\t\t   This is safe for Normal strings, but not\n\t\t\t   hex encoded data */\n\t\t\tfor (i = 0; i < (value->unitSize-1); i++)\n\t\t\t\tsprintf(&strBuf[i*sizeof(char)*2],\n\t\t\t\t\t\"%02x\",\n\t\t\t\t\t(unsigned char) value->val.str[i]);\n\n\t\t\tstrBuf[(value->unitSize-1) * 2] = '\\0';\n\t\t} else {\n\t\t\tint j;\n\t\t\t/* escape the XML disallowed chars */\n\t\t\tstrBuf = malloc(sizeof(char) *\n\t\t\t\t\t(value->unitSize + 1 + num_chars_to_escape * 4));\n\t\t\tif (!strBuf) {\n\t\t\t\tDBG(\"No memory to convert raw data to xml\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfor (i = 0, j = 0; i < length; i++) {\n\t\t\t\tif (value->val.str[i] == '&') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'a';\n\t\t\t\t\tstrBuf[j++] = 'm';\n\t\t\t\t\tstrBuf[j++] = 'p';\n\t\t\t\t} else if (value->val.str[i] == '<') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'l';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '>') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'g';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '\"') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'q';\n\t\t\t\t\tstrBuf[j++] = 'u';\n\t\t\t\t\tstrBuf[j++] = 'o';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '\\0') {\n\t\t\t\t\tstrBuf[j++] = ' ';\n\t\t\t\t} else {\n\t\t\t\t\tstrBuf[j++] = value->val.str[i];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tstrBuf[j] = '\\0';\n\t\t}\n\n\t\tappender(data, \"value=\\\"\");\n\t\tappender(data, strBuf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tfree(strBuf);\n\t\tbreak;\n\t}\n\n\tcase SDP_URL_STR8:\n\tcase SDP_URL_STR16:\n\tcase SDP_URL_STR32:\n\t{\n\t\tchar *strBuf;\n\n\t\tappender(data, indent);\n\t\tappender(data, \"<url value=\\\"\");\n\t\tstrBuf = strndup(value->val.str, value->unitSize - 1);\n\t\tappender(data, strBuf);\n\t\tfree(strBuf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\t}\n\n\tcase SDP_SEQ8:\n\tcase SDP_SEQ16:\n\tcase SDP_SEQ32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<sequence>\\n\");\n\n\t\tconvert_raw_data_to_xml(value->val.dataseq,\n\t\t\t\t\tindent_level + 1, data, appender);\n\n\t\tappender(data, indent);\n\t\tappender(data, \"</sequence>\\n\");\n\n\t\tbreak;\n\n\tcase SDP_ALT8:\n\tcase SDP_ALT16:\n\tcase SDP_ALT32:\n\t\tappender(data, indent);\n\n\t\tappender(data, \"<alternate>\\n\");\n\n\t\tconvert_raw_data_to_xml(value->val.dataseq,\n\t\t\t\t\tindent_level + 1, data, appender);\n\t\tappender(data, indent);\n\n\t\tappender(data, \"</alternate>\\n\");\n\n\t\tbreak;\n\t}\n\n\tconvert_raw_data_to_xml(value->next, indent_level, data, appender);\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define MAXINDENT 64",
      "#define STRBUFSIZE 1024"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_raw_data_to_xml",
          "args": [
            "value->next",
            "indent_level",
            "data",
            "appender"
          ],
          "line": 969
        },
        "resolved": true,
        "details": {
          "function_name": "convert_raw_data_to_xml",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "649-970",
          "snippet": "static void convert_raw_data_to_xml(sdp_data_t *value, int indent_level,\n\t\tvoid *data, void (*appender)(void *, const char *))\n{\n\tint i, hex;\n\tchar buf[STRBUFSIZE];\n\tchar indent[MAXINDENT];\n\n\tif (!value)\n\t\treturn;\n\n\tif (indent_level >= MAXINDENT)\n\t\tindent_level = MAXINDENT - 2;\n\n\tfor (i = 0; i < indent_level; i++)\n\t\tindent[i] = '\\t';\n\n\tindent[i] = '\\0';\n\tbuf[STRBUFSIZE - 1] = '\\0';\n\n\tswitch (value->dtd) {\n\tcase SDP_DATA_NIL:\n\t\tappender(data, indent);\n\t\tappender(data, \"<nil/>\\n\");\n\t\tbreak;\n\n\tcase SDP_BOOL:\n\t\tappender(data, indent);\n\t\tappender(data, \"<boolean value=\\\"\");\n\t\tappender(data, value->val.uint8 ? \"true\" : \"false\");\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT8:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint8 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%02x\", value->val.uint8);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint16 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%04x\", value->val.uint16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint32 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%08x\", value->val.uint32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT64:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint64 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%016jx\", value->val.uint64);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint128 value=\\\"\");\n\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tsprintf(&buf[i * 2], \"%02x\",\n\t\t\t\t(unsigned char) value->val.uint128.data[i]);\n\t\t}\n\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT8:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int8 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int8);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int16 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int32 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT64:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int64 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%jd\", value->val.int64);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int128 value=\\\"\");\n\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tsprintf(&buf[i * 2], \"%02x\",\n\t\t\t\t(unsigned char) value->val.int128.data[i]);\n\t\t}\n\t\tappender(data, buf);\n\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%04x\", value->val.uuid.value.uuid16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%08x\", value->val.uuid.value.uuid32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\n\t\tsnprintf(buf, STRBUFSIZE - 1,\n\t\t\t \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[0],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[1],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[2],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[3],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[4],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[5],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[6],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[7],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[8],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[9],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[10],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[11],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[12],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[13],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[14],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[15]);\n\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_TEXT_STR8:\n\tcase SDP_TEXT_STR16:\n\tcase SDP_TEXT_STR32:\n\t{\n\t\tint num_chars_to_escape = 0;\n\t\tint length = value->unitSize - 1;\n\t\tchar *strBuf;\n\n\t\thex = 0;\n\n\t\tfor (i = 0; i < length; i++) {\n\t\t\tif (!isprint(value->val.str[i]) &&\n\t\t\t\t\tvalue->val.str[i] != '\\0') {\n\t\t\t\thex = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* XML is evil, must do this... */\n\t\t\tif ((value->val.str[i] == '<') ||\n\t\t\t\t\t(value->val.str[i] == '>') ||\n\t\t\t\t\t(value->val.str[i] == '\"') ||\n\t\t\t\t\t(value->val.str[i] == '&'))\n\t\t\t\tnum_chars_to_escape++;\n\t\t}\n\n\t\tappender(data, indent);\n\n\t\tappender(data, \"<text \");\n\n\t\tif (hex) {\n\t\t\tappender(data, \"encoding=\\\"hex\\\" \");\n\t\t\tstrBuf = malloc(sizeof(char)\n\t\t\t\t\t\t * ((value->unitSize-1) * 2 + 1));\n\t\t\tif (!strBuf) {\n\t\t\t\tDBG(\"No memory to convert raw data to xml\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/* Unit Size seems to include the size for dtd\n\t\t\t   It is thus off by 1\n\t\t\t   This is safe for Normal strings, but not\n\t\t\t   hex encoded data */\n\t\t\tfor (i = 0; i < (value->unitSize-1); i++)\n\t\t\t\tsprintf(&strBuf[i*sizeof(char)*2],\n\t\t\t\t\t\"%02x\",\n\t\t\t\t\t(unsigned char) value->val.str[i]);\n\n\t\t\tstrBuf[(value->unitSize-1) * 2] = '\\0';\n\t\t} else {\n\t\t\tint j;\n\t\t\t/* escape the XML disallowed chars */\n\t\t\tstrBuf = malloc(sizeof(char) *\n\t\t\t\t\t(value->unitSize + 1 + num_chars_to_escape * 4));\n\t\t\tif (!strBuf) {\n\t\t\t\tDBG(\"No memory to convert raw data to xml\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfor (i = 0, j = 0; i < length; i++) {\n\t\t\t\tif (value->val.str[i] == '&') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'a';\n\t\t\t\t\tstrBuf[j++] = 'm';\n\t\t\t\t\tstrBuf[j++] = 'p';\n\t\t\t\t} else if (value->val.str[i] == '<') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'l';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '>') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'g';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '\"') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'q';\n\t\t\t\t\tstrBuf[j++] = 'u';\n\t\t\t\t\tstrBuf[j++] = 'o';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '\\0') {\n\t\t\t\t\tstrBuf[j++] = ' ';\n\t\t\t\t} else {\n\t\t\t\t\tstrBuf[j++] = value->val.str[i];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tstrBuf[j] = '\\0';\n\t\t}\n\n\t\tappender(data, \"value=\\\"\");\n\t\tappender(data, strBuf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tfree(strBuf);\n\t\tbreak;\n\t}\n\n\tcase SDP_URL_STR8:\n\tcase SDP_URL_STR16:\n\tcase SDP_URL_STR32:\n\t{\n\t\tchar *strBuf;\n\n\t\tappender(data, indent);\n\t\tappender(data, \"<url value=\\\"\");\n\t\tstrBuf = strndup(value->val.str, value->unitSize - 1);\n\t\tappender(data, strBuf);\n\t\tfree(strBuf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\t}\n\n\tcase SDP_SEQ8:\n\tcase SDP_SEQ16:\n\tcase SDP_SEQ32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<sequence>\\n\");\n\n\t\tconvert_raw_data_to_xml(value->val.dataseq,\n\t\t\t\t\tindent_level + 1, data, appender);\n\n\t\tappender(data, indent);\n\t\tappender(data, \"</sequence>\\n\");\n\n\t\tbreak;\n\n\tcase SDP_ALT8:\n\tcase SDP_ALT16:\n\tcase SDP_ALT32:\n\t\tappender(data, indent);\n\n\t\tappender(data, \"<alternate>\\n\");\n\n\t\tconvert_raw_data_to_xml(value->val.dataseq,\n\t\t\t\t\tindent_level + 1, data, appender);\n\t\tappender(data, indent);\n\n\t\tappender(data, \"</alternate>\\n\");\n\n\t\tbreak;\n\t}\n\n\tconvert_raw_data_to_xml(value->next, indent_level, data, appender);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"</alternate>\\n\""
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<alternate>\\n\""
          ],
          "line": 958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"</sequence>\\n\""
          ],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<sequence>\\n\""
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "strBuf"
          ],
          "line": 934
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_data_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "518-526",
          "snippet": "static void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "strBuf"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strndup",
          "args": [
            "value->val.str",
            "value->unitSize - 1"
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<url value=\\\"\""
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "strBuf"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"value=\\\"\""
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"No memory to convert raw data to xml\""
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(char) *\n\t\t\t\t\t(value->unitSize + 1 + num_chars_to_escape * 4)"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "btd_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.c",
          "lines": "41-55",
          "snippet": "void *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"src/shared/util.h\"",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <stdbool.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/util.h\"\n#include <string.h>\n#include <limits.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <stdbool.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "&strBuf[i*sizeof(char)*2]",
            "\"%02x\"",
            "(unsigned char) value->val.str[i]"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"No memory to convert raw data to xml\""
          ],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"encoding=\\\"hex\\\" \""
          ],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<text \""
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isprint",
          "args": [
            "value->val.str[i]"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\"",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[0]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[1]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[2]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[3]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[4]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[5]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[6]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[7]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[8]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[9]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[10]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[11]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[12]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[13]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[14]",
            "(unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[15]"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<uuid value=\\\"\""
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"0x%08x\"",
            "value->val.uuid.value.uuid32"
          ],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<uuid value=\\\"\""
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"0x%04x\"",
            "value->val.uuid.value.uuid16"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<uuid value=\\\"\""
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "&buf[i * 2]",
            "\"%02x\"",
            "(unsigned char) value->val.int128.data[i]"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<int128 value=\\\"\""
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"%jd\"",
            "value->val.int64"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<int64 value=\\\"\""
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"%d\"",
            "value->val.int32"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<int32 value=\\\"\""
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"%d\"",
            "value->val.int16"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<int16 value=\\\"\""
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"%d\"",
            "value->val.int8"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<int8 value=\\\"\""
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "&buf[i * 2]",
            "\"%02x\"",
            "(unsigned char) value->val.uint128.data[i]"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<uint128 value=\\\"\""
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"0x%016jx\"",
            "value->val.uint64"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<uint64 value=\\\"\""
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"0x%08x\"",
            "value->val.uint32"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<uint32 value=\\\"\""
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"0x%04x\"",
            "value->val.uint16"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<uint16 value=\\\"\""
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "buf"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "STRBUFSIZE - 1",
            "\"0x%02x\"",
            "value->val.uint8"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<uint8 value=\\\"\""
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"\\\" />\\n\""
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "value->val.uint8 ? \"true\" : \"false\""
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<boolean value=\\\"\""
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "\"<nil/>\\n\""
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender",
          "args": [
            "data",
            "indent"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define MAXINDENT 64\n#define STRBUFSIZE 1024\n\nstatic void convert_raw_data_to_xml(sdp_data_t *value, int indent_level,\n\t\tvoid *data, void (*appender)(void *, const char *))\n{\n\tint i, hex;\n\tchar buf[STRBUFSIZE];\n\tchar indent[MAXINDENT];\n\n\tif (!value)\n\t\treturn;\n\n\tif (indent_level >= MAXINDENT)\n\t\tindent_level = MAXINDENT - 2;\n\n\tfor (i = 0; i < indent_level; i++)\n\t\tindent[i] = '\\t';\n\n\tindent[i] = '\\0';\n\tbuf[STRBUFSIZE - 1] = '\\0';\n\n\tswitch (value->dtd) {\n\tcase SDP_DATA_NIL:\n\t\tappender(data, indent);\n\t\tappender(data, \"<nil/>\\n\");\n\t\tbreak;\n\n\tcase SDP_BOOL:\n\t\tappender(data, indent);\n\t\tappender(data, \"<boolean value=\\\"\");\n\t\tappender(data, value->val.uint8 ? \"true\" : \"false\");\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT8:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint8 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%02x\", value->val.uint8);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint16 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%04x\", value->val.uint16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint32 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%08x\", value->val.uint32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT64:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint64 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%016jx\", value->val.uint64);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UINT128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uint128 value=\\\"\");\n\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tsprintf(&buf[i * 2], \"%02x\",\n\t\t\t\t(unsigned char) value->val.uint128.data[i]);\n\t\t}\n\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT8:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int8 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int8);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int16 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int32 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%d\", value->val.int32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT64:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int64 value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"%jd\", value->val.int64);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_INT128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<int128 value=\\\"\");\n\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\tsprintf(&buf[i * 2], \"%02x\",\n\t\t\t\t(unsigned char) value->val.int128.data[i]);\n\t\t}\n\t\tappender(data, buf);\n\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID16:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%04x\", value->val.uuid.value.uuid16);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\t\tsnprintf(buf, STRBUFSIZE - 1, \"0x%08x\", value->val.uuid.value.uuid32);\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_UUID128:\n\t\tappender(data, indent);\n\t\tappender(data, \"<uuid value=\\\"\");\n\n\t\tsnprintf(buf, STRBUFSIZE - 1,\n\t\t\t \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[0],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[1],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[2],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[3],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[4],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[5],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[6],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[7],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[8],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[9],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[10],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[11],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[12],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[13],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[14],\n\t\t\t (unsigned char) value->val.uuid.value.\n\t\t\t uuid128.data[15]);\n\n\t\tappender(data, buf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\n\tcase SDP_TEXT_STR8:\n\tcase SDP_TEXT_STR16:\n\tcase SDP_TEXT_STR32:\n\t{\n\t\tint num_chars_to_escape = 0;\n\t\tint length = value->unitSize - 1;\n\t\tchar *strBuf;\n\n\t\thex = 0;\n\n\t\tfor (i = 0; i < length; i++) {\n\t\t\tif (!isprint(value->val.str[i]) &&\n\t\t\t\t\tvalue->val.str[i] != '\\0') {\n\t\t\t\thex = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* XML is evil, must do this... */\n\t\t\tif ((value->val.str[i] == '<') ||\n\t\t\t\t\t(value->val.str[i] == '>') ||\n\t\t\t\t\t(value->val.str[i] == '\"') ||\n\t\t\t\t\t(value->val.str[i] == '&'))\n\t\t\t\tnum_chars_to_escape++;\n\t\t}\n\n\t\tappender(data, indent);\n\n\t\tappender(data, \"<text \");\n\n\t\tif (hex) {\n\t\t\tappender(data, \"encoding=\\\"hex\\\" \");\n\t\t\tstrBuf = malloc(sizeof(char)\n\t\t\t\t\t\t * ((value->unitSize-1) * 2 + 1));\n\t\t\tif (!strBuf) {\n\t\t\t\tDBG(\"No memory to convert raw data to xml\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/* Unit Size seems to include the size for dtd\n\t\t\t   It is thus off by 1\n\t\t\t   This is safe for Normal strings, but not\n\t\t\t   hex encoded data */\n\t\t\tfor (i = 0; i < (value->unitSize-1); i++)\n\t\t\t\tsprintf(&strBuf[i*sizeof(char)*2],\n\t\t\t\t\t\"%02x\",\n\t\t\t\t\t(unsigned char) value->val.str[i]);\n\n\t\t\tstrBuf[(value->unitSize-1) * 2] = '\\0';\n\t\t} else {\n\t\t\tint j;\n\t\t\t/* escape the XML disallowed chars */\n\t\t\tstrBuf = malloc(sizeof(char) *\n\t\t\t\t\t(value->unitSize + 1 + num_chars_to_escape * 4));\n\t\t\tif (!strBuf) {\n\t\t\t\tDBG(\"No memory to convert raw data to xml\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfor (i = 0, j = 0; i < length; i++) {\n\t\t\t\tif (value->val.str[i] == '&') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'a';\n\t\t\t\t\tstrBuf[j++] = 'm';\n\t\t\t\t\tstrBuf[j++] = 'p';\n\t\t\t\t} else if (value->val.str[i] == '<') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'l';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '>') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'g';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '\"') {\n\t\t\t\t\tstrBuf[j++] = '&';\n\t\t\t\t\tstrBuf[j++] = 'q';\n\t\t\t\t\tstrBuf[j++] = 'u';\n\t\t\t\t\tstrBuf[j++] = 'o';\n\t\t\t\t\tstrBuf[j++] = 't';\n\t\t\t\t} else if (value->val.str[i] == '\\0') {\n\t\t\t\t\tstrBuf[j++] = ' ';\n\t\t\t\t} else {\n\t\t\t\t\tstrBuf[j++] = value->val.str[i];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tstrBuf[j] = '\\0';\n\t\t}\n\n\t\tappender(data, \"value=\\\"\");\n\t\tappender(data, strBuf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tfree(strBuf);\n\t\tbreak;\n\t}\n\n\tcase SDP_URL_STR8:\n\tcase SDP_URL_STR16:\n\tcase SDP_URL_STR32:\n\t{\n\t\tchar *strBuf;\n\n\t\tappender(data, indent);\n\t\tappender(data, \"<url value=\\\"\");\n\t\tstrBuf = strndup(value->val.str, value->unitSize - 1);\n\t\tappender(data, strBuf);\n\t\tfree(strBuf);\n\t\tappender(data, \"\\\" />\\n\");\n\t\tbreak;\n\t}\n\n\tcase SDP_SEQ8:\n\tcase SDP_SEQ16:\n\tcase SDP_SEQ32:\n\t\tappender(data, indent);\n\t\tappender(data, \"<sequence>\\n\");\n\n\t\tconvert_raw_data_to_xml(value->val.dataseq,\n\t\t\t\t\tindent_level + 1, data, appender);\n\n\t\tappender(data, indent);\n\t\tappender(data, \"</sequence>\\n\");\n\n\t\tbreak;\n\n\tcase SDP_ALT8:\n\tcase SDP_ALT16:\n\tcase SDP_ALT32:\n\t\tappender(data, indent);\n\n\t\tappender(data, \"<alternate>\\n\");\n\n\t\tconvert_raw_data_to_xml(value->val.dataseq,\n\t\t\t\t\tindent_level + 1, data, appender);\n\t\tappender(data, indent);\n\n\t\tappender(data, \"</alternate>\\n\");\n\n\t\tbreak;\n\t}\n\n\tconvert_raw_data_to_xml(value->next, indent_level, data, appender);\n}"
  },
  {
    "function_name": "sdp_xml_parse_record",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "612-646",
    "snippet": "sdp_record_t *sdp_xml_parse_record(const char *data, int size)\n{\n\tGMarkupParseContext *ctx;\n\tstruct context_data *ctx_data;\n\tsdp_record_t *record;\n\n\tctx_data = malloc(sizeof(*ctx_data));\n\tif (!ctx_data)\n\t\treturn NULL;\n\n\trecord = sdp_record_alloc();\n\tif (!record) {\n\t\tfree(ctx_data);\n\t\treturn NULL;\n\t}\n\n\tmemset(ctx_data, 0, sizeof(*ctx_data));\n\tctx_data->record = record;\n\n\tctx = g_markup_parse_context_new(&parser, 0, ctx_data, NULL);\n\n\tif (g_markup_parse_context_parse(ctx, data, size, NULL) == FALSE) {\n\t\terror(\"XML parsing error\");\n\t\tg_markup_parse_context_free(ctx);\n\t\tsdp_record_free(record);\n\t\tfree(ctx_data);\n\t\treturn NULL;\n\t}\n\n\tg_markup_parse_context_free(ctx);\n\n\tfree(ctx_data);\n\n\treturn record;\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GMarkupParser parser = {\n\telement_start, element_end, NULL, NULL, NULL\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ctx_data"
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_data_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "518-526",
          "snippet": "static void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_markup_parse_context_free",
          "args": [
            "ctx"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_record_free",
          "args": [
            "record"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_markup_parse_context_free",
          "args": [
            "ctx"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"XML parsing error\""
          ],
          "line": 634
        },
        "resolved": true,
        "details": {
          "function_name": "btd_error_not_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/error.c",
          "lines": "118-122",
          "snippet": "DBusMessage *btd_error_not_ready(DBusMessage *msg)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE \".NotReady\",\n\t\t\t\t\t\"Resource Not Ready\");\n}",
          "includes": [
            "#include \"error.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"error.h\"\n#include \"gdbus/gdbus.h\"\n#include <config.h>\n\nDBusMessage *btd_error_not_ready(DBusMessage *msg)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE \".NotReady\",\n\t\t\t\t\t\"Resource Not Ready\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_markup_parse_context_parse",
          "args": [
            "ctx",
            "data",
            "size",
            "NULL"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_markup_parse_context_new",
          "args": [
            "&parser",
            "0",
            "ctx_data",
            "NULL"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ctx_data",
            "0",
            "sizeof(*ctx_data)"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_record_alloc",
          "args": [],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*ctx_data)"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "btd_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.c",
          "lines": "41-55",
          "snippet": "void *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"src/shared/util.h\"",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <stdbool.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/util.h\"\n#include <string.h>\n#include <limits.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <stdbool.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic GMarkupParser parser = {\n\telement_start, element_end, NULL, NULL, NULL\n};\n\nsdp_record_t *sdp_xml_parse_record(const char *data, int size)\n{\n\tGMarkupParseContext *ctx;\n\tstruct context_data *ctx_data;\n\tsdp_record_t *record;\n\n\tctx_data = malloc(sizeof(*ctx_data));\n\tif (!ctx_data)\n\t\treturn NULL;\n\n\trecord = sdp_record_alloc();\n\tif (!record) {\n\t\tfree(ctx_data);\n\t\treturn NULL;\n\t}\n\n\tmemset(ctx_data, 0, sizeof(*ctx_data));\n\tctx_data->record = record;\n\n\tctx = g_markup_parse_context_new(&parser, 0, ctx_data, NULL);\n\n\tif (g_markup_parse_context_parse(ctx, data, size, NULL) == FALSE) {\n\t\terror(\"XML parsing error\");\n\t\tg_markup_parse_context_free(ctx);\n\t\tsdp_record_free(record);\n\t\tfree(ctx_data);\n\t\treturn NULL;\n\t}\n\n\tg_markup_parse_context_free(ctx);\n\n\tfree(ctx_data);\n\n\treturn record;\n}"
  },
  {
    "function_name": "element_end",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "528-606",
    "snippet": "static void element_end(GMarkupParseContext *context,\n\t\tconst char *element_name, gpointer user_data, GError **err)\n{\n\tstruct context_data *ctx_data = user_data;\n\tstruct sdp_xml_data *elem;\n\n\tif (!strcmp(element_name, \"record\"))\n\t\treturn;\n\n\tif (!strcmp(element_name, \"attribute\")) {\n\t\tif (ctx_data->stack_head && ctx_data->stack_head->data) {\n\t\t\tint ret = sdp_attr_add(ctx_data->record, ctx_data->attr_id,\n\t\t\t\t\t\t\tctx_data->stack_head->data);\n\t\t\tif (ret == -1)\n\t\t\t\tDBG(\"Could not add attribute 0x%04x\",\n\t\t\t\t\t\t\tctx_data->attr_id);\n\n\t\t\tctx_data->stack_head->data = NULL;\n\t\t\tsdp_xml_data_free(ctx_data->stack_head);\n\t\t\tctx_data->stack_head = NULL;\n\t\t} else {\n\t\t\tDBG(\"No data for attribute 0x%04x\", ctx_data->attr_id);\n\t\t}\n\t\treturn;\n\t}\n\n\tif (!ctx_data->stack_head || !ctx_data->stack_head->data) {\n\t\tDBG(\"No data for %s\", element_name);\n\t\treturn;\n\t}\n\n\tif (!strcmp(element_name, \"sequence\")) {\n\t\tctx_data->stack_head->data->unitSize = compute_seq_size(ctx_data->stack_head->data);\n\n\t\tif (ctx_data->stack_head->data->unitSize > USHRT_MAX) {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint32_t);\n\t\t\tctx_data->stack_head->data->dtd = SDP_SEQ32;\n\t\t} else if (ctx_data->stack_head->data->unitSize > UCHAR_MAX) {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint16_t);\n\t\t\tctx_data->stack_head->data->dtd = SDP_SEQ16;\n\t\t} else {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint8_t);\n\t\t}\n\t} else if (!strcmp(element_name, \"alternate\")) {\n\t\tctx_data->stack_head->data->unitSize = compute_seq_size(ctx_data->stack_head->data);\n\n\t\tif (ctx_data->stack_head->data->unitSize > USHRT_MAX) {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint32_t);\n\t\t\tctx_data->stack_head->data->dtd = SDP_ALT32;\n\t\t} else if (ctx_data->stack_head->data->unitSize > UCHAR_MAX) {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint16_t);\n\t\t\tctx_data->stack_head->data->dtd = SDP_ALT16;\n\t\t} else {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint8_t);\n\t\t}\n\t}\n\n\tif (ctx_data->stack_head->next && ctx_data->stack_head->data &&\n\t\t\t\t\tctx_data->stack_head->next->data) {\n\t\tswitch (ctx_data->stack_head->next->data->dtd) {\n\t\tcase SDP_SEQ8:\n\t\tcase SDP_SEQ16:\n\t\tcase SDP_SEQ32:\n\t\tcase SDP_ALT8:\n\t\tcase SDP_ALT16:\n\t\tcase SDP_ALT32:\n\t\t\tctx_data->stack_head->next->data->val.dataseq =\n\t\t\t\tsdp_seq_append(ctx_data->stack_head->next->data->val.dataseq,\n\t\t\t\t\t\t\t\tctx_data->stack_head->data);\n\t\t\tctx_data->stack_head->data = NULL;\n\t\t\tbreak;\n\t\t}\n\n\t\telem = ctx_data->stack_head;\n\t\tctx_data->stack_head = ctx_data->stack_head->next;\n\n\t\tsdp_xml_data_free(elem);\n\t}\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp_xml_data_free",
          "args": [
            "elem"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_data_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "518-526",
          "snippet": "static void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_seq_append",
          "args": [
            "ctx_data->stack_head->next->data->val.dataseq",
            "ctx_data->stack_head->data"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compute_seq_size",
          "args": [
            "ctx_data->stack_head->data"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "compute_seq_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "68-77",
          "snippet": "static int compute_seq_size(sdp_data_t *data)\n{\n\tint unit_size = data->unitSize;\n\tsdp_data_t *seq = data->val.dataseq;\n\n\tfor (; seq; seq = seq->next)\n\t\tunit_size += seq->unitSize;\n\n\treturn unit_size;\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int compute_seq_size(sdp_data_t *data)\n{\n\tint unit_size = data->unitSize;\n\tsdp_data_t *seq = data->val.dataseq;\n\n\tfor (; seq; seq = seq->next)\n\t\tunit_size += seq->unitSize;\n\n\treturn unit_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "element_name",
            "\"alternate\""
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "g_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/adapter.c",
          "lines": "1927-1930",
          "snippet": "static gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"advertising.h\"",
            "#include \"gatt-database.h\"",
            "#include \"attrib-server.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"storage.h\"",
            "#include \"agent.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/mgmt.h\"",
            "#include \"textfile.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"bluetooth/sdp_lib.h\"",
            "#include \"bluetooth/sdp.h\"",
            "#include \"bluetooth/hci_lib.h\"",
            "#include \"bluetooth/hci.h\"",
            "#include \"bluetooth/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <sys/ioctl.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <inttypes.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"advertising.h\"\n#include \"gatt-database.h\"\n#include \"attrib-server.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"storage.h\"\n#include \"agent.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/mgmt.h\"\n#include \"textfile.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/mgmt.h\"\n#include \"lib/uuid.h\"\n#include \"bluetooth/sdp_lib.h\"\n#include \"bluetooth/sdp.h\"\n#include \"bluetooth/hci_lib.h\"\n#include \"bluetooth/hci.h\"\n#include \"bluetooth/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <sys/ioctl.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <inttypes.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"No data for %s\"",
            "element_name"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"No data for attribute 0x%04x\"",
            "ctx_data->attr_id"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"Could not add attribute 0x%04x\"",
            "ctx_data->attr_id"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_attr_add",
          "args": [
            "ctx_data->record",
            "ctx_data->attr_id",
            "ctx_data->stack_head->data"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void element_end(GMarkupParseContext *context,\n\t\tconst char *element_name, gpointer user_data, GError **err)\n{\n\tstruct context_data *ctx_data = user_data;\n\tstruct sdp_xml_data *elem;\n\n\tif (!strcmp(element_name, \"record\"))\n\t\treturn;\n\n\tif (!strcmp(element_name, \"attribute\")) {\n\t\tif (ctx_data->stack_head && ctx_data->stack_head->data) {\n\t\t\tint ret = sdp_attr_add(ctx_data->record, ctx_data->attr_id,\n\t\t\t\t\t\t\tctx_data->stack_head->data);\n\t\t\tif (ret == -1)\n\t\t\t\tDBG(\"Could not add attribute 0x%04x\",\n\t\t\t\t\t\t\tctx_data->attr_id);\n\n\t\t\tctx_data->stack_head->data = NULL;\n\t\t\tsdp_xml_data_free(ctx_data->stack_head);\n\t\t\tctx_data->stack_head = NULL;\n\t\t} else {\n\t\t\tDBG(\"No data for attribute 0x%04x\", ctx_data->attr_id);\n\t\t}\n\t\treturn;\n\t}\n\n\tif (!ctx_data->stack_head || !ctx_data->stack_head->data) {\n\t\tDBG(\"No data for %s\", element_name);\n\t\treturn;\n\t}\n\n\tif (!strcmp(element_name, \"sequence\")) {\n\t\tctx_data->stack_head->data->unitSize = compute_seq_size(ctx_data->stack_head->data);\n\n\t\tif (ctx_data->stack_head->data->unitSize > USHRT_MAX) {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint32_t);\n\t\t\tctx_data->stack_head->data->dtd = SDP_SEQ32;\n\t\t} else if (ctx_data->stack_head->data->unitSize > UCHAR_MAX) {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint16_t);\n\t\t\tctx_data->stack_head->data->dtd = SDP_SEQ16;\n\t\t} else {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint8_t);\n\t\t}\n\t} else if (!strcmp(element_name, \"alternate\")) {\n\t\tctx_data->stack_head->data->unitSize = compute_seq_size(ctx_data->stack_head->data);\n\n\t\tif (ctx_data->stack_head->data->unitSize > USHRT_MAX) {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint32_t);\n\t\t\tctx_data->stack_head->data->dtd = SDP_ALT32;\n\t\t} else if (ctx_data->stack_head->data->unitSize > UCHAR_MAX) {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint16_t);\n\t\t\tctx_data->stack_head->data->dtd = SDP_ALT16;\n\t\t} else {\n\t\t\tctx_data->stack_head->data->unitSize += sizeof(uint8_t);\n\t\t}\n\t}\n\n\tif (ctx_data->stack_head->next && ctx_data->stack_head->data &&\n\t\t\t\t\tctx_data->stack_head->next->data) {\n\t\tswitch (ctx_data->stack_head->next->data->dtd) {\n\t\tcase SDP_SEQ8:\n\t\tcase SDP_SEQ16:\n\t\tcase SDP_SEQ32:\n\t\tcase SDP_ALT8:\n\t\tcase SDP_ALT16:\n\t\tcase SDP_ALT32:\n\t\t\tctx_data->stack_head->next->data->val.dataseq =\n\t\t\t\tsdp_seq_append(ctx_data->stack_head->next->data->val.dataseq,\n\t\t\t\t\t\t\t\tctx_data->stack_head->data);\n\t\t\tctx_data->stack_head->data = NULL;\n\t\t\tbreak;\n\t\t}\n\n\t\telem = ctx_data->stack_head;\n\t\tctx_data->stack_head = ctx_data->stack_head->next;\n\n\t\tsdp_xml_data_free(elem);\n\t}\n}"
  },
  {
    "function_name": "sdp_xml_data_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "518-526",
    "snippet": "static void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "elem"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_data_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "518-526",
          "snippet": "static void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "sdp_data_free",
          "args": [
            "elem->data"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}"
  },
  {
    "function_name": "element_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "450-516",
    "snippet": "static void element_start(GMarkupParseContext *context,\n\t\tconst char *element_name, const char **attribute_names,\n\t\tconst char **attribute_values, gpointer user_data, GError **err)\n{\n\tstruct context_data *ctx_data = user_data;\n\n\tif (!strcmp(element_name, \"record\"))\n\t\treturn;\n\n\tif (!strcmp(element_name, \"attribute\")) {\n\t\tint i;\n\t\tfor (i = 0; attribute_names[i]; i++) {\n\t\t\tif (!strcmp(attribute_names[i], \"id\")) {\n\t\t\t\tctx_data->attr_id = strtol(attribute_values[i], 0, 0);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tDBG(\"New attribute 0x%04x\", ctx_data->attr_id);\n\t\treturn;\n\t}\n\n\tif (ctx_data->stack_head) {\n\t\tstruct sdp_xml_data *newelem = sdp_xml_data_alloc();\n\t\tnewelem->next = ctx_data->stack_head;\n\t\tctx_data->stack_head = newelem;\n\t} else {\n\t\tctx_data->stack_head = sdp_xml_data_alloc();\n\t\tctx_data->stack_head->next = NULL;\n\t}\n\n\tif (!strcmp(element_name, \"sequence\"))\n\t\tctx_data->stack_head->data = sdp_data_alloc(SDP_SEQ8, NULL);\n\telse if (!strcmp(element_name, \"alternate\"))\n\t\tctx_data->stack_head->data = sdp_data_alloc(SDP_ALT8, NULL);\n\telse {\n\t\tint i;\n\t\t/* Parse value, name, encoding */\n\t\tfor (i = 0; attribute_names[i]; i++) {\n\t\t\tif (!strcmp(attribute_names[i], \"value\")) {\n\t\t\t\tint curlen = strlen(ctx_data->stack_head->text);\n\t\t\t\tint attrlen = strlen(attribute_values[i]);\n\n\t\t\t\t/* Ensure we're big enough */\n\t\t\t\twhile ((curlen + 1 + attrlen) > ctx_data->stack_head->size)\n\t\t\t\t\tsdp_xml_data_expand(ctx_data->stack_head);\n\n\t\t\t\tmemcpy(ctx_data->stack_head->text + curlen,\n\t\t\t\t\t\tattribute_values[i], attrlen);\n\t\t\t\tctx_data->stack_head->text[curlen + attrlen] = '\\0';\n\t\t\t}\n\n\t\t\tif (!strcmp(attribute_names[i], \"encoding\")) {\n\t\t\t\tif (!strcmp(attribute_values[i], \"hex\"))\n\t\t\t\t\tctx_data->stack_head->type = 1;\n\t\t\t}\n\n\t\t\tif (!strcmp(attribute_names[i], \"name\"))\n\t\t\t\tctx_data->stack_head->name = strdup(attribute_values[i]);\n\t\t}\n\n\t\tctx_data->stack_head->data = sdp_xml_parse_datatype(element_name,\n\t\t\t\tctx_data->stack_head, ctx_data->record);\n\n\t\tif (ctx_data->stack_head->data == NULL)\n\t\t\terror(\"Can't parse element %s\", element_name);\n\t}\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"Can't parse element %s\"",
            "element_name"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "btd_error_failed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/error.c",
          "lines": "124-128",
          "snippet": "DBusMessage *btd_error_failed(DBusMessage *msg, const char *str)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE\n\t\t\t\t\t\".Failed\", \"%s\", str);\n}",
          "includes": [
            "#include \"error.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"error.h\"\n#include \"gdbus/gdbus.h\"\n#include <config.h>\n\nDBusMessage *btd_error_failed(DBusMessage *msg, const char *str)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE\n\t\t\t\t\t\".Failed\", \"%s\", str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_xml_parse_datatype",
          "args": [
            "element_name",
            "ctx_data->stack_head",
            "ctx_data->record"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_parse_datatype",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "411-449",
          "snippet": "static sdp_data_t *sdp_xml_parse_datatype(const char *el,\n\t\t\t\t\t\tstruct sdp_xml_data *elem,\n\t\t\t\t\t\tsdp_record_t *record)\n{\n\tconst char *data = elem->text;\n\n\tif (!strcmp(el, \"boolean\"))\n\t\treturn sdp_xml_parse_int(data, SDP_BOOL);\n\telse if (!strcmp(el, \"uint8\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT8);\n\telse if (!strcmp(el, \"uint16\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT16);\n\telse if (!strcmp(el, \"uint32\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT32);\n\telse if (!strcmp(el, \"uint64\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT64);\n\telse if (!strcmp(el, \"uint128\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT128);\n\telse if (!strcmp(el, \"int8\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT8);\n\telse if (!strcmp(el, \"int16\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT16);\n\telse if (!strcmp(el, \"int32\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT32);\n\telse if (!strcmp(el, \"int64\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT64);\n\telse if (!strcmp(el, \"int128\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT128);\n\telse if (!strcmp(el, \"uuid\"))\n\t\treturn sdp_xml_parse_uuid(data, record);\n\telse if (!strcmp(el, \"url\"))\n\t\treturn sdp_xml_parse_url(data);\n\telse if (!strcmp(el, \"text\"))\n\t\treturn sdp_xml_parse_text(data, elem->type);\n\telse if (!strcmp(el, \"nil\"))\n\t\treturn sdp_xml_parse_nil(data);\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_datatype(const char *el,\n\t\t\t\t\t\tstruct sdp_xml_data *elem,\n\t\t\t\t\t\tsdp_record_t *record)\n{\n\tconst char *data = elem->text;\n\n\tif (!strcmp(el, \"boolean\"))\n\t\treturn sdp_xml_parse_int(data, SDP_BOOL);\n\telse if (!strcmp(el, \"uint8\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT8);\n\telse if (!strcmp(el, \"uint16\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT16);\n\telse if (!strcmp(el, \"uint32\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT32);\n\telse if (!strcmp(el, \"uint64\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT64);\n\telse if (!strcmp(el, \"uint128\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT128);\n\telse if (!strcmp(el, \"int8\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT8);\n\telse if (!strcmp(el, \"int16\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT16);\n\telse if (!strcmp(el, \"int32\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT32);\n\telse if (!strcmp(el, \"int64\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT64);\n\telse if (!strcmp(el, \"int128\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT128);\n\telse if (!strcmp(el, \"uuid\"))\n\t\treturn sdp_xml_parse_uuid(data, record);\n\telse if (!strcmp(el, \"url\"))\n\t\treturn sdp_xml_parse_url(data);\n\telse if (!strcmp(el, \"text\"))\n\t\treturn sdp_xml_parse_text(data, elem->type);\n\telse if (!strcmp(el, \"nil\"))\n\t\treturn sdp_xml_parse_nil(data);\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "attribute_values[i]"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "attribute_names[i]",
            "\"name\""
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "g_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/adapter.c",
          "lines": "1927-1930",
          "snippet": "static gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"advertising.h\"",
            "#include \"gatt-database.h\"",
            "#include \"attrib-server.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"storage.h\"",
            "#include \"agent.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/mgmt.h\"",
            "#include \"textfile.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"bluetooth/sdp_lib.h\"",
            "#include \"bluetooth/sdp.h\"",
            "#include \"bluetooth/hci_lib.h\"",
            "#include \"bluetooth/hci.h\"",
            "#include \"bluetooth/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <sys/ioctl.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <inttypes.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"advertising.h\"\n#include \"gatt-database.h\"\n#include \"attrib-server.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"storage.h\"\n#include \"agent.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/mgmt.h\"\n#include \"textfile.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/mgmt.h\"\n#include \"lib/uuid.h\"\n#include \"bluetooth/sdp_lib.h\"\n#include \"bluetooth/sdp.h\"\n#include \"bluetooth/hci_lib.h\"\n#include \"bluetooth/hci.h\"\n#include \"bluetooth/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <sys/ioctl.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <inttypes.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ctx_data->stack_head->text + curlen",
            "attribute_values[i]",
            "attrlen"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_xml_data_expand",
          "args": [
            "ctx_data->stack_head"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_data_expand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "103-118",
          "snippet": "static struct sdp_xml_data *sdp_xml_data_expand(struct sdp_xml_data *elem)\n{\n\tchar *newbuf;\n\n\tnewbuf = malloc(elem->size * 2);\n\tif (!newbuf)\n\t\treturn NULL;\n\n\tmemcpy(newbuf, elem->text, elem->size);\n\telem->size *= 2;\n\tfree(elem->text);\n\n\telem->text = newbuf;\n\n\treturn elem;\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic struct sdp_xml_data *sdp_xml_data_expand(struct sdp_xml_data *elem)\n{\n\tchar *newbuf;\n\n\tnewbuf = malloc(elem->size * 2);\n\tif (!newbuf)\n\t\treturn NULL;\n\n\tmemcpy(newbuf, elem->text, elem->size);\n\telem->size *= 2;\n\tfree(elem->text);\n\n\telem->text = newbuf;\n\n\treturn elem;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "attribute_values[i]"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "ctx_data->stack_head->text"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "SDP_ALT8",
            "NULL"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "SDP_SEQ8",
            "NULL"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_xml_data_alloc",
          "args": [],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_data_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "81-101",
          "snippet": "static struct sdp_xml_data *sdp_xml_data_alloc(void)\n{\n\tstruct sdp_xml_data *elem;\n\n\telem = malloc(sizeof(struct sdp_xml_data));\n\tif (!elem)\n\t\treturn NULL;\n\n\tmemset(elem, 0, sizeof(struct sdp_xml_data));\n\n\t/* Null terminate the text */\n\telem->size = DEFAULT_XML_DATA_SIZE;\n\telem->text = malloc(DEFAULT_XML_DATA_SIZE);\n\tif (!elem->text) {\n\t\tfree(elem);\n\t\treturn NULL;\n\t}\n\telem->text[0] = '\\0';\n\n\treturn elem;\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define DEFAULT_XML_DATA_SIZE 1024"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define DEFAULT_XML_DATA_SIZE 1024\n\nstatic struct sdp_xml_data *sdp_xml_data_alloc(void)\n{\n\tstruct sdp_xml_data *elem;\n\n\telem = malloc(sizeof(struct sdp_xml_data));\n\tif (!elem)\n\t\treturn NULL;\n\n\tmemset(elem, 0, sizeof(struct sdp_xml_data));\n\n\t/* Null terminate the text */\n\telem->size = DEFAULT_XML_DATA_SIZE;\n\telem->text = malloc(DEFAULT_XML_DATA_SIZE);\n\tif (!elem->text) {\n\t\tfree(elem);\n\t\treturn NULL;\n\t}\n\telem->text[0] = '\\0';\n\n\treturn elem;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DBG",
          "args": [
            "\"New attribute 0x%04x\"",
            "ctx_data->attr_id"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "attribute_values[i]",
            "0",
            "0"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void element_start(GMarkupParseContext *context,\n\t\tconst char *element_name, const char **attribute_names,\n\t\tconst char **attribute_values, gpointer user_data, GError **err)\n{\n\tstruct context_data *ctx_data = user_data;\n\n\tif (!strcmp(element_name, \"record\"))\n\t\treturn;\n\n\tif (!strcmp(element_name, \"attribute\")) {\n\t\tint i;\n\t\tfor (i = 0; attribute_names[i]; i++) {\n\t\t\tif (!strcmp(attribute_names[i], \"id\")) {\n\t\t\t\tctx_data->attr_id = strtol(attribute_values[i], 0, 0);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tDBG(\"New attribute 0x%04x\", ctx_data->attr_id);\n\t\treturn;\n\t}\n\n\tif (ctx_data->stack_head) {\n\t\tstruct sdp_xml_data *newelem = sdp_xml_data_alloc();\n\t\tnewelem->next = ctx_data->stack_head;\n\t\tctx_data->stack_head = newelem;\n\t} else {\n\t\tctx_data->stack_head = sdp_xml_data_alloc();\n\t\tctx_data->stack_head->next = NULL;\n\t}\n\n\tif (!strcmp(element_name, \"sequence\"))\n\t\tctx_data->stack_head->data = sdp_data_alloc(SDP_SEQ8, NULL);\n\telse if (!strcmp(element_name, \"alternate\"))\n\t\tctx_data->stack_head->data = sdp_data_alloc(SDP_ALT8, NULL);\n\telse {\n\t\tint i;\n\t\t/* Parse value, name, encoding */\n\t\tfor (i = 0; attribute_names[i]; i++) {\n\t\t\tif (!strcmp(attribute_names[i], \"value\")) {\n\t\t\t\tint curlen = strlen(ctx_data->stack_head->text);\n\t\t\t\tint attrlen = strlen(attribute_values[i]);\n\n\t\t\t\t/* Ensure we're big enough */\n\t\t\t\twhile ((curlen + 1 + attrlen) > ctx_data->stack_head->size)\n\t\t\t\t\tsdp_xml_data_expand(ctx_data->stack_head);\n\n\t\t\t\tmemcpy(ctx_data->stack_head->text + curlen,\n\t\t\t\t\t\tattribute_values[i], attrlen);\n\t\t\t\tctx_data->stack_head->text[curlen + attrlen] = '\\0';\n\t\t\t}\n\n\t\t\tif (!strcmp(attribute_names[i], \"encoding\")) {\n\t\t\t\tif (!strcmp(attribute_values[i], \"hex\"))\n\t\t\t\t\tctx_data->stack_head->type = 1;\n\t\t\t}\n\n\t\t\tif (!strcmp(attribute_names[i], \"name\"))\n\t\t\t\tctx_data->stack_head->name = strdup(attribute_values[i]);\n\t\t}\n\n\t\tctx_data->stack_head->data = sdp_xml_parse_datatype(element_name,\n\t\t\t\tctx_data->stack_head, ctx_data->record);\n\n\t\tif (ctx_data->stack_head->data == NULL)\n\t\t\terror(\"Can't parse element %s\", element_name);\n\t}\n}"
  },
  {
    "function_name": "sdp_xml_parse_datatype",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "411-449",
    "snippet": "static sdp_data_t *sdp_xml_parse_datatype(const char *el,\n\t\t\t\t\t\tstruct sdp_xml_data *elem,\n\t\t\t\t\t\tsdp_record_t *record)\n{\n\tconst char *data = elem->text;\n\n\tif (!strcmp(el, \"boolean\"))\n\t\treturn sdp_xml_parse_int(data, SDP_BOOL);\n\telse if (!strcmp(el, \"uint8\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT8);\n\telse if (!strcmp(el, \"uint16\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT16);\n\telse if (!strcmp(el, \"uint32\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT32);\n\telse if (!strcmp(el, \"uint64\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT64);\n\telse if (!strcmp(el, \"uint128\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT128);\n\telse if (!strcmp(el, \"int8\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT8);\n\telse if (!strcmp(el, \"int16\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT16);\n\telse if (!strcmp(el, \"int32\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT32);\n\telse if (!strcmp(el, \"int64\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT64);\n\telse if (!strcmp(el, \"int128\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT128);\n\telse if (!strcmp(el, \"uuid\"))\n\t\treturn sdp_xml_parse_uuid(data, record);\n\telse if (!strcmp(el, \"url\"))\n\t\treturn sdp_xml_parse_url(data);\n\telse if (!strcmp(el, \"text\"))\n\t\treturn sdp_xml_parse_text(data, elem->type);\n\telse if (!strcmp(el, \"nil\"))\n\t\treturn sdp_xml_parse_nil(data);\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp_xml_parse_nil",
          "args": [
            "data"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_parse_nil",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "406-409",
          "snippet": "static sdp_data_t *sdp_xml_parse_nil(const char *data)\n{\n\treturn sdp_data_alloc(SDP_DATA_NIL, 0);\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_nil(const char *data)\n{\n\treturn sdp_data_alloc(SDP_DATA_NIL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "el",
            "\"nil\""
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "g_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/adapter.c",
          "lines": "1927-1930",
          "snippet": "static gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"advertising.h\"",
            "#include \"gatt-database.h\"",
            "#include \"attrib-server.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"storage.h\"",
            "#include \"agent.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/mgmt.h\"",
            "#include \"textfile.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"bluetooth/sdp_lib.h\"",
            "#include \"bluetooth/sdp.h\"",
            "#include \"bluetooth/hci_lib.h\"",
            "#include \"bluetooth/hci.h\"",
            "#include \"bluetooth/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <sys/ioctl.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <inttypes.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"advertising.h\"\n#include \"gatt-database.h\"\n#include \"attrib-server.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"storage.h\"\n#include \"agent.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/mgmt.h\"\n#include \"textfile.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/mgmt.h\"\n#include \"lib/uuid.h\"\n#include \"bluetooth/sdp_lib.h\"\n#include \"bluetooth/sdp.h\"\n#include \"bluetooth/hci_lib.h\"\n#include \"bluetooth/hci.h\"\n#include \"bluetooth/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <sys/ioctl.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <inttypes.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_xml_parse_text",
          "args": [
            "data",
            "elem->type"
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_parse_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "385-404",
          "snippet": "static sdp_data_t *sdp_xml_parse_text(const char *data, char encoding)\n{\n\tuint8_t dtd = SDP_TEXT_STR8;\n\tchar *text;\n\tuint32_t length;\n\tsdp_data_t *ret;\n\n\ttext = sdp_xml_parse_string_decode(data, encoding, &length);\n\tif (!text)\n\t\treturn NULL;\n\n\tif (length > UCHAR_MAX)\n\t\tdtd = SDP_TEXT_STR16;\n\n\tret = sdp_data_alloc_with_length(dtd, text, length);\n\n\tfree(text);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_text(const char *data, char encoding)\n{\n\tuint8_t dtd = SDP_TEXT_STR8;\n\tchar *text;\n\tuint32_t length;\n\tsdp_data_t *ret;\n\n\ttext = sdp_xml_parse_string_decode(data, encoding, &length);\n\tif (!text)\n\t\treturn NULL;\n\n\tif (length > UCHAR_MAX)\n\t\tdtd = SDP_TEXT_STR16;\n\n\tret = sdp_data_alloc_with_length(dtd, text, length);\n\n\tfree(text);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_xml_parse_url",
          "args": [
            "data"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_parse_url",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "363-383",
          "snippet": "static sdp_data_t *sdp_xml_parse_url(const char *data)\n{\n\tuint8_t dtd = SDP_URL_STR8;\n\tchar *url;\n\tuint32_t length;\n\tsdp_data_t *ret;\n\n\turl = sdp_xml_parse_string_decode(data,\n\t\t\t\tSDP_XML_ENCODING_NORMAL, &length);\n\tif (!url)\n\t\treturn NULL;\n\n\tif (length > UCHAR_MAX)\n\t\tdtd = SDP_URL_STR16;\n\n\tret = sdp_data_alloc_with_length(dtd, url, length);\n\n\tfree(url);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SDP_XML_ENCODING_NORMAL\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define SDP_XML_ENCODING_NORMAL\t0\n\nstatic sdp_data_t *sdp_xml_parse_url(const char *data)\n{\n\tuint8_t dtd = SDP_URL_STR8;\n\tchar *url;\n\tuint32_t length;\n\tsdp_data_t *ret;\n\n\turl = sdp_xml_parse_string_decode(data,\n\t\t\t\tSDP_XML_ENCODING_NORMAL, &length);\n\tif (!url)\n\t\treturn NULL;\n\n\tif (length > UCHAR_MAX)\n\t\tdtd = SDP_URL_STR16;\n\n\tret = sdp_data_alloc_with_length(dtd, url, length);\n\n\tfree(url);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_xml_parse_uuid",
          "args": [
            "data",
            "record"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_parse_uuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "147-182",
          "snippet": "static sdp_data_t *sdp_xml_parse_uuid(const char *data, sdp_record_t *record)\n{\n\tsdp_data_t *ret;\n\tchar *endptr;\n\tuint32_t val;\n\tuint16_t val2;\n\tint len;\n\n\tlen = strlen(data);\n\n\tif (len == 36) {\n\t\tret = sdp_xml_parse_uuid128(data);\n\t\tgoto result;\n\t}\n\n\tval = strtoll(data, &endptr, 16);\n\n\t/* Couldn't parse */\n\tif (*endptr != '\\0')\n\t\treturn NULL;\n\n\tif (val > USHRT_MAX) {\n\t\tret = sdp_data_alloc(SDP_UUID32, &val);\n\t\tgoto result;\n\t}\n\n\tval2 = val;\n\n\tret = sdp_data_alloc(SDP_UUID16, &val2);\n\nresult:\n\tif (record && ret)\n\t\tsdp_pattern_add_uuid(record, &ret->val.uuid);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_uuid(const char *data, sdp_record_t *record)\n{\n\tsdp_data_t *ret;\n\tchar *endptr;\n\tuint32_t val;\n\tuint16_t val2;\n\tint len;\n\n\tlen = strlen(data);\n\n\tif (len == 36) {\n\t\tret = sdp_xml_parse_uuid128(data);\n\t\tgoto result;\n\t}\n\n\tval = strtoll(data, &endptr, 16);\n\n\t/* Couldn't parse */\n\tif (*endptr != '\\0')\n\t\treturn NULL;\n\n\tif (val > USHRT_MAX) {\n\t\tret = sdp_data_alloc(SDP_UUID32, &val);\n\t\tgoto result;\n\t}\n\n\tval2 = val;\n\n\tret = sdp_data_alloc(SDP_UUID16, &val2);\n\nresult:\n\tif (record && ret)\n\t\tsdp_pattern_add_uuid(record, &ret->val.uuid);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_xml_parse_int",
          "args": [
            "data",
            "SDP_INT128"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_parse_int",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "184-324",
          "snippet": "static sdp_data_t *sdp_xml_parse_int(const char *data, uint8_t dtd)\n{\n\tchar *endptr;\n\tsdp_data_t *ret = NULL;\n\n\tswitch (dtd) {\n\tcase SDP_BOOL:\n\t{\n\t\tuint8_t val = 0;\n\n\t\tif (!strcmp(\"true\", data))\n\t\t\tval = 1;\n\t\telse if (!strcmp(\"false\", data))\n\t\t\tval = 0;\n\t\telse\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT8:\n\t{\n\t\tint8_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT8:\n\t{\n\t\tuint8_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT16:\n\t{\n\t\tint16_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT16:\n\t{\n\t\tuint16_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT32:\n\t{\n\t\tint32_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT32:\n\t{\n\t\tuint32_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT64:\n\t{\n\t\tint64_t val = strtoull(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT64:\n\t{\n\t\tuint64_t val = strtoull(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT128:\n\tcase SDP_UINT128:\n\t{\n\t\tuint128_t val;\n\t\tint i = 0;\n\t\tchar buf[3];\n\n\t\tbuf[2] = '\\0';\n\n\t\tfor (; i < 32; i += 2) {\n\t\t\tbuf[0] = data[i];\n\t\t\tbuf[1] = data[i + 1];\n\n\t\t\tval.data[i >> 1] = strtoul(buf, 0, 16);\n\t\t}\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\t};\n\n\treturn ret;\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_int(const char *data, uint8_t dtd)\n{\n\tchar *endptr;\n\tsdp_data_t *ret = NULL;\n\n\tswitch (dtd) {\n\tcase SDP_BOOL:\n\t{\n\t\tuint8_t val = 0;\n\n\t\tif (!strcmp(\"true\", data))\n\t\t\tval = 1;\n\t\telse if (!strcmp(\"false\", data))\n\t\t\tval = 0;\n\t\telse\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT8:\n\t{\n\t\tint8_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT8:\n\t{\n\t\tuint8_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT16:\n\t{\n\t\tint16_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT16:\n\t{\n\t\tuint16_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT32:\n\t{\n\t\tint32_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT32:\n\t{\n\t\tuint32_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT64:\n\t{\n\t\tint64_t val = strtoull(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT64:\n\t{\n\t\tuint64_t val = strtoull(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT128:\n\tcase SDP_UINT128:\n\t{\n\t\tuint128_t val;\n\t\tint i = 0;\n\t\tchar buf[3];\n\n\t\tbuf[2] = '\\0';\n\n\t\tfor (; i < 32; i += 2) {\n\t\t\tbuf[0] = data[i];\n\t\t\tbuf[1] = data[i + 1];\n\n\t\t\tval.data[i >> 1] = strtoul(buf, 0, 16);\n\t\t}\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\t};\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_datatype(const char *el,\n\t\t\t\t\t\tstruct sdp_xml_data *elem,\n\t\t\t\t\t\tsdp_record_t *record)\n{\n\tconst char *data = elem->text;\n\n\tif (!strcmp(el, \"boolean\"))\n\t\treturn sdp_xml_parse_int(data, SDP_BOOL);\n\telse if (!strcmp(el, \"uint8\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT8);\n\telse if (!strcmp(el, \"uint16\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT16);\n\telse if (!strcmp(el, \"uint32\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT32);\n\telse if (!strcmp(el, \"uint64\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT64);\n\telse if (!strcmp(el, \"uint128\"))\n\t\treturn sdp_xml_parse_int(data, SDP_UINT128);\n\telse if (!strcmp(el, \"int8\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT8);\n\telse if (!strcmp(el, \"int16\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT16);\n\telse if (!strcmp(el, \"int32\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT32);\n\telse if (!strcmp(el, \"int64\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT64);\n\telse if (!strcmp(el, \"int128\"))\n\t\treturn sdp_xml_parse_int(data, SDP_INT128);\n\telse if (!strcmp(el, \"uuid\"))\n\t\treturn sdp_xml_parse_uuid(data, record);\n\telse if (!strcmp(el, \"url\"))\n\t\treturn sdp_xml_parse_url(data);\n\telse if (!strcmp(el, \"text\"))\n\t\treturn sdp_xml_parse_text(data, elem->type);\n\telse if (!strcmp(el, \"nil\"))\n\t\treturn sdp_xml_parse_nil(data);\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "sdp_xml_parse_nil",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "406-409",
    "snippet": "static sdp_data_t *sdp_xml_parse_nil(const char *data)\n{\n\treturn sdp_data_alloc(SDP_DATA_NIL, 0);\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "SDP_DATA_NIL",
            "0"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_nil(const char *data)\n{\n\treturn sdp_data_alloc(SDP_DATA_NIL, 0);\n}"
  },
  {
    "function_name": "sdp_xml_parse_text",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "385-404",
    "snippet": "static sdp_data_t *sdp_xml_parse_text(const char *data, char encoding)\n{\n\tuint8_t dtd = SDP_TEXT_STR8;\n\tchar *text;\n\tuint32_t length;\n\tsdp_data_t *ret;\n\n\ttext = sdp_xml_parse_string_decode(data, encoding, &length);\n\tif (!text)\n\t\treturn NULL;\n\n\tif (length > UCHAR_MAX)\n\t\tdtd = SDP_TEXT_STR16;\n\n\tret = sdp_data_alloc_with_length(dtd, text, length);\n\n\tfree(text);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "text"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_data_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "518-526",
          "snippet": "static void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc_with_length",
          "args": [
            "dtd",
            "text",
            "length"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_xml_parse_string_decode",
          "args": [
            "data",
            "encoding",
            "&length"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_parse_string_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "326-361",
          "snippet": "static char *sdp_xml_parse_string_decode(const char *data, char encoding,\n\t\t\t\t\t\t\tuint32_t *length)\n{\n\tint len = strlen(data);\n\tchar *text;\n\n\tif (encoding == SDP_XML_ENCODING_NORMAL) {\n\t\ttext = strdup(data);\n\t\t*length = len;\n\t} else {\n\t\tchar buf[3], *decoded;\n\t\tint i;\n\n\t\tdecoded = malloc((len >> 1) + 1);\n\t\tif (!decoded)\n\t\t\treturn NULL;\n\n\t\t/* Ensure the string is a power of 2 */\n\t\tlen = (len >> 1) << 1;\n\n\t\tbuf[2] = '\\0';\n\n\t\tfor (i = 0; i < len; i += 2) {\n\t\t\tbuf[0] = data[i];\n\t\t\tbuf[1] = data[i + 1];\n\n\t\t\tdecoded[i >> 1] = strtoul(buf, 0, 16);\n\t\t}\n\n\t\tdecoded[len >> 1] = '\\0';\n\t\ttext = decoded;\n\t\t*length = len >> 1;\n\t}\n\n\treturn text;\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SDP_XML_ENCODING_NORMAL\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define SDP_XML_ENCODING_NORMAL\t0\n\nstatic char *sdp_xml_parse_string_decode(const char *data, char encoding,\n\t\t\t\t\t\t\tuint32_t *length)\n{\n\tint len = strlen(data);\n\tchar *text;\n\n\tif (encoding == SDP_XML_ENCODING_NORMAL) {\n\t\ttext = strdup(data);\n\t\t*length = len;\n\t} else {\n\t\tchar buf[3], *decoded;\n\t\tint i;\n\n\t\tdecoded = malloc((len >> 1) + 1);\n\t\tif (!decoded)\n\t\t\treturn NULL;\n\n\t\t/* Ensure the string is a power of 2 */\n\t\tlen = (len >> 1) << 1;\n\n\t\tbuf[2] = '\\0';\n\n\t\tfor (i = 0; i < len; i += 2) {\n\t\t\tbuf[0] = data[i];\n\t\t\tbuf[1] = data[i + 1];\n\n\t\t\tdecoded[i >> 1] = strtoul(buf, 0, 16);\n\t\t}\n\n\t\tdecoded[len >> 1] = '\\0';\n\t\ttext = decoded;\n\t\t*length = len >> 1;\n\t}\n\n\treturn text;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_text(const char *data, char encoding)\n{\n\tuint8_t dtd = SDP_TEXT_STR8;\n\tchar *text;\n\tuint32_t length;\n\tsdp_data_t *ret;\n\n\ttext = sdp_xml_parse_string_decode(data, encoding, &length);\n\tif (!text)\n\t\treturn NULL;\n\n\tif (length > UCHAR_MAX)\n\t\tdtd = SDP_TEXT_STR16;\n\n\tret = sdp_data_alloc_with_length(dtd, text, length);\n\n\tfree(text);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "sdp_xml_parse_url",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "363-383",
    "snippet": "static sdp_data_t *sdp_xml_parse_url(const char *data)\n{\n\tuint8_t dtd = SDP_URL_STR8;\n\tchar *url;\n\tuint32_t length;\n\tsdp_data_t *ret;\n\n\turl = sdp_xml_parse_string_decode(data,\n\t\t\t\tSDP_XML_ENCODING_NORMAL, &length);\n\tif (!url)\n\t\treturn NULL;\n\n\tif (length > UCHAR_MAX)\n\t\tdtd = SDP_URL_STR16;\n\n\tret = sdp_data_alloc_with_length(dtd, url, length);\n\n\tfree(url);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SDP_XML_ENCODING_NORMAL\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "url"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_data_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "518-526",
          "snippet": "static void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc_with_length",
          "args": [
            "dtd",
            "url",
            "length"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_xml_parse_string_decode",
          "args": [
            "data",
            "SDP_XML_ENCODING_NORMAL",
            "&length"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_parse_string_decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "326-361",
          "snippet": "static char *sdp_xml_parse_string_decode(const char *data, char encoding,\n\t\t\t\t\t\t\tuint32_t *length)\n{\n\tint len = strlen(data);\n\tchar *text;\n\n\tif (encoding == SDP_XML_ENCODING_NORMAL) {\n\t\ttext = strdup(data);\n\t\t*length = len;\n\t} else {\n\t\tchar buf[3], *decoded;\n\t\tint i;\n\n\t\tdecoded = malloc((len >> 1) + 1);\n\t\tif (!decoded)\n\t\t\treturn NULL;\n\n\t\t/* Ensure the string is a power of 2 */\n\t\tlen = (len >> 1) << 1;\n\n\t\tbuf[2] = '\\0';\n\n\t\tfor (i = 0; i < len; i += 2) {\n\t\t\tbuf[0] = data[i];\n\t\t\tbuf[1] = data[i + 1];\n\n\t\t\tdecoded[i >> 1] = strtoul(buf, 0, 16);\n\t\t}\n\n\t\tdecoded[len >> 1] = '\\0';\n\t\ttext = decoded;\n\t\t*length = len >> 1;\n\t}\n\n\treturn text;\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SDP_XML_ENCODING_NORMAL\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define SDP_XML_ENCODING_NORMAL\t0\n\nstatic char *sdp_xml_parse_string_decode(const char *data, char encoding,\n\t\t\t\t\t\t\tuint32_t *length)\n{\n\tint len = strlen(data);\n\tchar *text;\n\n\tif (encoding == SDP_XML_ENCODING_NORMAL) {\n\t\ttext = strdup(data);\n\t\t*length = len;\n\t} else {\n\t\tchar buf[3], *decoded;\n\t\tint i;\n\n\t\tdecoded = malloc((len >> 1) + 1);\n\t\tif (!decoded)\n\t\t\treturn NULL;\n\n\t\t/* Ensure the string is a power of 2 */\n\t\tlen = (len >> 1) << 1;\n\n\t\tbuf[2] = '\\0';\n\n\t\tfor (i = 0; i < len; i += 2) {\n\t\t\tbuf[0] = data[i];\n\t\t\tbuf[1] = data[i + 1];\n\n\t\t\tdecoded[i >> 1] = strtoul(buf, 0, 16);\n\t\t}\n\n\t\tdecoded[len >> 1] = '\\0';\n\t\ttext = decoded;\n\t\t*length = len >> 1;\n\t}\n\n\treturn text;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define SDP_XML_ENCODING_NORMAL\t0\n\nstatic sdp_data_t *sdp_xml_parse_url(const char *data)\n{\n\tuint8_t dtd = SDP_URL_STR8;\n\tchar *url;\n\tuint32_t length;\n\tsdp_data_t *ret;\n\n\turl = sdp_xml_parse_string_decode(data,\n\t\t\t\tSDP_XML_ENCODING_NORMAL, &length);\n\tif (!url)\n\t\treturn NULL;\n\n\tif (length > UCHAR_MAX)\n\t\tdtd = SDP_URL_STR16;\n\n\tret = sdp_data_alloc_with_length(dtd, url, length);\n\n\tfree(url);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "sdp_xml_parse_string_decode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "326-361",
    "snippet": "static char *sdp_xml_parse_string_decode(const char *data, char encoding,\n\t\t\t\t\t\t\tuint32_t *length)\n{\n\tint len = strlen(data);\n\tchar *text;\n\n\tif (encoding == SDP_XML_ENCODING_NORMAL) {\n\t\ttext = strdup(data);\n\t\t*length = len;\n\t} else {\n\t\tchar buf[3], *decoded;\n\t\tint i;\n\n\t\tdecoded = malloc((len >> 1) + 1);\n\t\tif (!decoded)\n\t\t\treturn NULL;\n\n\t\t/* Ensure the string is a power of 2 */\n\t\tlen = (len >> 1) << 1;\n\n\t\tbuf[2] = '\\0';\n\n\t\tfor (i = 0; i < len; i += 2) {\n\t\t\tbuf[0] = data[i];\n\t\t\tbuf[1] = data[i + 1];\n\n\t\t\tdecoded[i >> 1] = strtoul(buf, 0, 16);\n\t\t}\n\n\t\tdecoded[len >> 1] = '\\0';\n\t\ttext = decoded;\n\t\t*length = len >> 1;\n\t}\n\n\treturn text;\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SDP_XML_ENCODING_NORMAL\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "buf",
            "0",
            "16"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "(len >> 1) + 1"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "btd_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.c",
          "lines": "41-55",
          "snippet": "void *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"src/shared/util.h\"",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <stdbool.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/util.h\"\n#include <string.h>\n#include <limits.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <stdbool.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "data"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "data"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define SDP_XML_ENCODING_NORMAL\t0\n\nstatic char *sdp_xml_parse_string_decode(const char *data, char encoding,\n\t\t\t\t\t\t\tuint32_t *length)\n{\n\tint len = strlen(data);\n\tchar *text;\n\n\tif (encoding == SDP_XML_ENCODING_NORMAL) {\n\t\ttext = strdup(data);\n\t\t*length = len;\n\t} else {\n\t\tchar buf[3], *decoded;\n\t\tint i;\n\n\t\tdecoded = malloc((len >> 1) + 1);\n\t\tif (!decoded)\n\t\t\treturn NULL;\n\n\t\t/* Ensure the string is a power of 2 */\n\t\tlen = (len >> 1) << 1;\n\n\t\tbuf[2] = '\\0';\n\n\t\tfor (i = 0; i < len; i += 2) {\n\t\t\tbuf[0] = data[i];\n\t\t\tbuf[1] = data[i + 1];\n\n\t\t\tdecoded[i >> 1] = strtoul(buf, 0, 16);\n\t\t}\n\n\t\tdecoded[len >> 1] = '\\0';\n\t\ttext = decoded;\n\t\t*length = len >> 1;\n\t}\n\n\treturn text;\n}"
  },
  {
    "function_name": "sdp_xml_parse_int",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "184-324",
    "snippet": "static sdp_data_t *sdp_xml_parse_int(const char *data, uint8_t dtd)\n{\n\tchar *endptr;\n\tsdp_data_t *ret = NULL;\n\n\tswitch (dtd) {\n\tcase SDP_BOOL:\n\t{\n\t\tuint8_t val = 0;\n\n\t\tif (!strcmp(\"true\", data))\n\t\t\tval = 1;\n\t\telse if (!strcmp(\"false\", data))\n\t\t\tval = 0;\n\t\telse\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT8:\n\t{\n\t\tint8_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT8:\n\t{\n\t\tuint8_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT16:\n\t{\n\t\tint16_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT16:\n\t{\n\t\tuint16_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT32:\n\t{\n\t\tint32_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT32:\n\t{\n\t\tuint32_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT64:\n\t{\n\t\tint64_t val = strtoull(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT64:\n\t{\n\t\tuint64_t val = strtoull(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT128:\n\tcase SDP_UINT128:\n\t{\n\t\tuint128_t val;\n\t\tint i = 0;\n\t\tchar buf[3];\n\n\t\tbuf[2] = '\\0';\n\n\t\tfor (; i < 32; i += 2) {\n\t\t\tbuf[0] = data[i];\n\t\t\tbuf[1] = data[i + 1];\n\n\t\t\tval.data[i >> 1] = strtoul(buf, 0, 16);\n\t\t}\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\t};\n\n\treturn ret;\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "dtd",
            "&val"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "buf",
            "0",
            "16"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "dtd",
            "&val"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoull",
          "args": [
            "data",
            "&endptr",
            "0"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "dtd",
            "&val"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoull",
          "args": [
            "data",
            "&endptr",
            "0"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "dtd",
            "&val"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "data",
            "&endptr",
            "0"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "dtd",
            "&val"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "data",
            "&endptr",
            "0"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "dtd",
            "&val"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "data",
            "&endptr",
            "0"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "dtd",
            "&val"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "data",
            "&endptr",
            "0"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "dtd",
            "&val"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "data",
            "&endptr",
            "0"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "dtd",
            "&val"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "data",
            "&endptr",
            "0"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "dtd",
            "&val"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "\"false\"",
            "data"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "g_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/adapter.c",
          "lines": "1927-1930",
          "snippet": "static gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"advertising.h\"",
            "#include \"gatt-database.h\"",
            "#include \"attrib-server.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"storage.h\"",
            "#include \"agent.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/mgmt.h\"",
            "#include \"textfile.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"bluetooth/sdp_lib.h\"",
            "#include \"bluetooth/sdp.h\"",
            "#include \"bluetooth/hci_lib.h\"",
            "#include \"bluetooth/hci.h\"",
            "#include \"bluetooth/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <sys/ioctl.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <inttypes.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"advertising.h\"\n#include \"gatt-database.h\"\n#include \"attrib-server.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"storage.h\"\n#include \"agent.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/mgmt.h\"\n#include \"textfile.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/mgmt.h\"\n#include \"lib/uuid.h\"\n#include \"bluetooth/sdp_lib.h\"\n#include \"bluetooth/sdp.h\"\n#include \"bluetooth/hci_lib.h\"\n#include \"bluetooth/hci.h\"\n#include \"bluetooth/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <sys/ioctl.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <inttypes.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_int(const char *data, uint8_t dtd)\n{\n\tchar *endptr;\n\tsdp_data_t *ret = NULL;\n\n\tswitch (dtd) {\n\tcase SDP_BOOL:\n\t{\n\t\tuint8_t val = 0;\n\n\t\tif (!strcmp(\"true\", data))\n\t\t\tval = 1;\n\t\telse if (!strcmp(\"false\", data))\n\t\t\tval = 0;\n\t\telse\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT8:\n\t{\n\t\tint8_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT8:\n\t{\n\t\tuint8_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT16:\n\t{\n\t\tint16_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT16:\n\t{\n\t\tuint16_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT32:\n\t{\n\t\tint32_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT32:\n\t{\n\t\tuint32_t val = strtoul(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT64:\n\t{\n\t\tint64_t val = strtoull(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_UINT64:\n\t{\n\t\tuint64_t val = strtoull(data, &endptr, 0);\n\n\t\t/* Failed to parse */\n\t\tif ((endptr != data) && (*endptr != '\\0'))\n\t\t\treturn NULL;\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\tcase SDP_INT128:\n\tcase SDP_UINT128:\n\t{\n\t\tuint128_t val;\n\t\tint i = 0;\n\t\tchar buf[3];\n\n\t\tbuf[2] = '\\0';\n\n\t\tfor (; i < 32; i += 2) {\n\t\t\tbuf[0] = data[i];\n\t\t\tbuf[1] = data[i + 1];\n\n\t\t\tval.data[i >> 1] = strtoul(buf, 0, 16);\n\t\t}\n\n\t\tret = sdp_data_alloc(dtd, &val);\n\t\tbreak;\n\t}\n\n\t};\n\n\treturn ret;\n}"
  },
  {
    "function_name": "sdp_xml_parse_uuid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "147-182",
    "snippet": "static sdp_data_t *sdp_xml_parse_uuid(const char *data, sdp_record_t *record)\n{\n\tsdp_data_t *ret;\n\tchar *endptr;\n\tuint32_t val;\n\tuint16_t val2;\n\tint len;\n\n\tlen = strlen(data);\n\n\tif (len == 36) {\n\t\tret = sdp_xml_parse_uuid128(data);\n\t\tgoto result;\n\t}\n\n\tval = strtoll(data, &endptr, 16);\n\n\t/* Couldn't parse */\n\tif (*endptr != '\\0')\n\t\treturn NULL;\n\n\tif (val > USHRT_MAX) {\n\t\tret = sdp_data_alloc(SDP_UUID32, &val);\n\t\tgoto result;\n\t}\n\n\tval2 = val;\n\n\tret = sdp_data_alloc(SDP_UUID16, &val2);\n\nresult:\n\tif (record && ret)\n\t\tsdp_pattern_add_uuid(record, &ret->val.uuid);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp_pattern_add_uuid",
          "args": [
            "record",
            "&ret->val.uuid"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "SDP_UUID16",
            "&val2"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "SDP_UUID32",
            "&val"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoll",
          "args": [
            "data",
            "&endptr",
            "16"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_xml_parse_uuid128",
          "args": [
            "data"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_parse_uuid128",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "120-145",
          "snippet": "static sdp_data_t *sdp_xml_parse_uuid128(const char *data)\n{\n\tuint128_t val;\n\tunsigned int i, j;\n\n\tchar buf[3];\n\n\tmemset(&val, 0, sizeof(val));\n\n\tbuf[2] = '\\0';\n\n\tfor (j = 0, i = 0; i < strlen(data);) {\n\t\tif (data[i] == '-') {\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tbuf[0] = data[i];\n\t\tbuf[1] = data[i + 1];\n\n\t\tval.data[j++] = strtoul(buf, 0, 16);\n\t\ti += 2;\n\t}\n\n\treturn sdp_data_alloc(SDP_UUID128, &val);\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_uuid128(const char *data)\n{\n\tuint128_t val;\n\tunsigned int i, j;\n\n\tchar buf[3];\n\n\tmemset(&val, 0, sizeof(val));\n\n\tbuf[2] = '\\0';\n\n\tfor (j = 0, i = 0; i < strlen(data);) {\n\t\tif (data[i] == '-') {\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tbuf[0] = data[i];\n\t\tbuf[1] = data[i + 1];\n\n\t\tval.data[j++] = strtoul(buf, 0, 16);\n\t\ti += 2;\n\t}\n\n\treturn sdp_data_alloc(SDP_UUID128, &val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "data"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_uuid(const char *data, sdp_record_t *record)\n{\n\tsdp_data_t *ret;\n\tchar *endptr;\n\tuint32_t val;\n\tuint16_t val2;\n\tint len;\n\n\tlen = strlen(data);\n\n\tif (len == 36) {\n\t\tret = sdp_xml_parse_uuid128(data);\n\t\tgoto result;\n\t}\n\n\tval = strtoll(data, &endptr, 16);\n\n\t/* Couldn't parse */\n\tif (*endptr != '\\0')\n\t\treturn NULL;\n\n\tif (val > USHRT_MAX) {\n\t\tret = sdp_data_alloc(SDP_UUID32, &val);\n\t\tgoto result;\n\t}\n\n\tval2 = val;\n\n\tret = sdp_data_alloc(SDP_UUID16, &val2);\n\nresult:\n\tif (record && ret)\n\t\tsdp_pattern_add_uuid(record, &ret->val.uuid);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "sdp_xml_parse_uuid128",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "120-145",
    "snippet": "static sdp_data_t *sdp_xml_parse_uuid128(const char *data)\n{\n\tuint128_t val;\n\tunsigned int i, j;\n\n\tchar buf[3];\n\n\tmemset(&val, 0, sizeof(val));\n\n\tbuf[2] = '\\0';\n\n\tfor (j = 0, i = 0; i < strlen(data);) {\n\t\tif (data[i] == '-') {\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tbuf[0] = data[i];\n\t\tbuf[1] = data[i + 1];\n\n\t\tval.data[j++] = strtoul(buf, 0, 16);\n\t\ti += 2;\n\t}\n\n\treturn sdp_data_alloc(SDP_UUID128, &val);\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp_data_alloc",
          "args": [
            "SDP_UUID128",
            "&val"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "buf",
            "0",
            "16"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "data"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&val",
            "0",
            "sizeof(val)"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic sdp_data_t *sdp_xml_parse_uuid128(const char *data)\n{\n\tuint128_t val;\n\tunsigned int i, j;\n\n\tchar buf[3];\n\n\tmemset(&val, 0, sizeof(val));\n\n\tbuf[2] = '\\0';\n\n\tfor (j = 0, i = 0; i < strlen(data);) {\n\t\tif (data[i] == '-') {\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\n\t\tbuf[0] = data[i];\n\t\tbuf[1] = data[i + 1];\n\n\t\tval.data[j++] = strtoul(buf, 0, 16);\n\t\ti += 2;\n\t}\n\n\treturn sdp_data_alloc(SDP_UUID128, &val);\n}"
  },
  {
    "function_name": "sdp_xml_data_expand",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "103-118",
    "snippet": "static struct sdp_xml_data *sdp_xml_data_expand(struct sdp_xml_data *elem)\n{\n\tchar *newbuf;\n\n\tnewbuf = malloc(elem->size * 2);\n\tif (!newbuf)\n\t\treturn NULL;\n\n\tmemcpy(newbuf, elem->text, elem->size);\n\telem->size *= 2;\n\tfree(elem->text);\n\n\telem->text = newbuf;\n\n\treturn elem;\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "elem->text"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_data_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "518-526",
          "snippet": "static void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "newbuf",
            "elem->text",
            "elem->size"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "elem->size * 2"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "btd_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.c",
          "lines": "41-55",
          "snippet": "void *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"src/shared/util.h\"",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <stdbool.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/util.h\"\n#include <string.h>\n#include <limits.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <stdbool.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic struct sdp_xml_data *sdp_xml_data_expand(struct sdp_xml_data *elem)\n{\n\tchar *newbuf;\n\n\tnewbuf = malloc(elem->size * 2);\n\tif (!newbuf)\n\t\treturn NULL;\n\n\tmemcpy(newbuf, elem->text, elem->size);\n\telem->size *= 2;\n\tfree(elem->text);\n\n\telem->text = newbuf;\n\n\treturn elem;\n}"
  },
  {
    "function_name": "sdp_xml_data_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "81-101",
    "snippet": "static struct sdp_xml_data *sdp_xml_data_alloc(void)\n{\n\tstruct sdp_xml_data *elem;\n\n\telem = malloc(sizeof(struct sdp_xml_data));\n\tif (!elem)\n\t\treturn NULL;\n\n\tmemset(elem, 0, sizeof(struct sdp_xml_data));\n\n\t/* Null terminate the text */\n\telem->size = DEFAULT_XML_DATA_SIZE;\n\telem->text = malloc(DEFAULT_XML_DATA_SIZE);\n\tif (!elem->text) {\n\t\tfree(elem);\n\t\treturn NULL;\n\t}\n\telem->text[0] = '\\0';\n\n\treturn elem;\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define DEFAULT_XML_DATA_SIZE 1024"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "elem"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "sdp_xml_data_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
          "lines": "518-526",
          "snippet": "static void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}",
          "includes": [
            "#include \"sdp-xml.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include <glib.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic void sdp_xml_data_free(struct sdp_xml_data *elem)\n{\n\tif (elem->data)\n\t\tsdp_data_free(elem->data);\n\n\tfree(elem->name);\n\tfree(elem->text);\n\tfree(elem);\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "DEFAULT_XML_DATA_SIZE"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "btd_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.c",
          "lines": "41-55",
          "snippet": "void *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"src/shared/util.h\"",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <stdbool.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/util.h\"\n#include <string.h>\n#include <limits.h>\n#include <dirent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <stdbool.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid *btd_malloc(size_t size)\n{\n\tif (__builtin_expect(!!size, 1)) {\n\t\tvoid *ptr;\n\n\t\tptr = malloc(size);\n\t\tif (ptr)\n\t\t\treturn ptr;\n\n\t\tfprintf(stderr, \"failed to allocate %zu bytes\\n\", size);\n\t\tabort();\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "elem",
            "0",
            "sizeof(struct sdp_xml_data)"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define DEFAULT_XML_DATA_SIZE 1024\n\nstatic struct sdp_xml_data *sdp_xml_data_alloc(void)\n{\n\tstruct sdp_xml_data *elem;\n\n\telem = malloc(sizeof(struct sdp_xml_data));\n\tif (!elem)\n\t\treturn NULL;\n\n\tmemset(elem, 0, sizeof(struct sdp_xml_data));\n\n\t/* Null terminate the text */\n\telem->size = DEFAULT_XML_DATA_SIZE;\n\telem->text = malloc(DEFAULT_XML_DATA_SIZE);\n\tif (!elem->text) {\n\t\tfree(elem);\n\t\treturn NULL;\n\t}\n\telem->text[0] = '\\0';\n\n\treturn elem;\n}"
  },
  {
    "function_name": "compute_seq_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/sdp-xml.c",
    "lines": "68-77",
    "snippet": "static int compute_seq_size(sdp_data_t *data)\n{\n\tint unit_size = data->unitSize;\n\tsdp_data_t *seq = data->val.dataseq;\n\n\tfor (; seq; seq = seq->next)\n\t\tunit_size += seq->unitSize;\n\n\treturn unit_size;\n}",
    "includes": [
      "#include \"sdp-xml.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include <glib.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sdp-xml.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include <glib.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <string.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int compute_seq_size(sdp_data_t *data)\n{\n\tint unit_size = data->unitSize;\n\tsdp_data_t *seq = data->val.dataseq;\n\n\tfor (; seq; seq = seq->next)\n\t\tunit_size += seq->unitSize;\n\n\treturn unit_size;\n}"
  }
]