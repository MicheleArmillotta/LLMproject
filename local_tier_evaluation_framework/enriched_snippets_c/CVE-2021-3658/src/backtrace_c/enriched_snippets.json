[
  {
    "function_name": "btd_assertion_message_expr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/backtrace.c",
    "lines": "129-135",
    "snippet": "void btd_assertion_message_expr(const char *file, int line,\n\t\t\t\t\tconst char *func, const char *expr)\n{\n\tbtd_error(0xffff, \"Assertion failed: (%s) %s:%d in %s\",\n\t\t\t\t\t\texpr, file, line, func);\n\tbtd_backtrace(0xffff);\n}",
    "includes": [
      "#include \"src/backtrace.h\"",
      "#include \"src/log.h\"",
      "#include <elfutils/libdwfl.h>",
      "#include <execinfo.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "btd_backtrace",
          "args": [
            "0xffff"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "btd_backtrace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/backtrace.c",
          "lines": "52-127",
          "snippet": "void btd_backtrace(uint16_t index)\n{\n#ifdef HAVE_BACKTRACE_SUPPORT\n\tchar *debuginfo_path = NULL;\n\tconst Dwfl_Callbacks callbacks = {\n\t\t.find_debuginfo = dwfl_standard_find_debuginfo,\n\t\t.find_elf = dwfl_linux_proc_find_elf,\n\t\t.debuginfo_path = &debuginfo_path,\n\t};\n\tDwfl *dwfl;\n\tvoid *frames[48];\n\tint n, n_ptrs;\n\n\tdwfl = dwfl_begin(&callbacks);\n\n\tif (dwfl_linux_proc_report(dwfl, getpid()))\n\t\tgoto done;\n\n\tdwfl_report_end(dwfl, NULL, NULL);\n\n\tn_ptrs = backtrace(frames, 48);\n\tif (n_ptrs < 1)\n\t\tgoto done;\n\n\tbtd_error(index, \"++++++++ backtrace ++++++++\");\n\n\tfor (n = 1; n < n_ptrs; n++) {\n\t\tGElf_Addr addr = (uintptr_t) frames[n];\n\t\tGElf_Sym sym;\n\t\tGElf_Word shndx;\n\t\tDwfl_Module *module = dwfl_addrmodule(dwfl, addr);\n\t\tDwfl_Line *line;\n\t\tconst char *name, *modname;\n\n\t\tif (!module) {\n\t\t\tbtd_error(index, \"#%-2u ?? [%#\" PRIx64 \"]\", n, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tname = dwfl_module_addrsym(module, addr, &sym, &shndx);\n\t\tif (!name) {\n\t\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\t\tbtd_error(index, \"#%-2u ?? (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\t\tn, modname, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tline = dwfl_module_getsrc(module, addr);\n\t\tif (line) {\n\t\t\tint lineno;\n\t\t\tconst char *src = dwfl_lineinfo(line, NULL, &lineno,\n\t\t\t\t\t\t\tNULL, NULL, NULL);\n\n\t\t\tif (src) {\n\t\t\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" \"\n\t\t\t\t\t\t\"(%s:%d) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\tsrc, lineno, addr);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\t\tmodname, addr);\n\t}\n\n\tbtd_error(index, \"+++++++++++++++++++++++++++\");\n\ndone:\n\tdwfl_end(dwfl);\n#endif\n}",
          "includes": [
            "#include \"src/backtrace.h\"",
            "#include \"src/log.h\"",
            "#include <elfutils/libdwfl.h>",
            "#include <execinfo.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/backtrace.h\"\n#include \"src/log.h\"\n#include <elfutils/libdwfl.h>\n#include <execinfo.h>\n#include <inttypes.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid btd_backtrace(uint16_t index)\n{\n#ifdef HAVE_BACKTRACE_SUPPORT\n\tchar *debuginfo_path = NULL;\n\tconst Dwfl_Callbacks callbacks = {\n\t\t.find_debuginfo = dwfl_standard_find_debuginfo,\n\t\t.find_elf = dwfl_linux_proc_find_elf,\n\t\t.debuginfo_path = &debuginfo_path,\n\t};\n\tDwfl *dwfl;\n\tvoid *frames[48];\n\tint n, n_ptrs;\n\n\tdwfl = dwfl_begin(&callbacks);\n\n\tif (dwfl_linux_proc_report(dwfl, getpid()))\n\t\tgoto done;\n\n\tdwfl_report_end(dwfl, NULL, NULL);\n\n\tn_ptrs = backtrace(frames, 48);\n\tif (n_ptrs < 1)\n\t\tgoto done;\n\n\tbtd_error(index, \"++++++++ backtrace ++++++++\");\n\n\tfor (n = 1; n < n_ptrs; n++) {\n\t\tGElf_Addr addr = (uintptr_t) frames[n];\n\t\tGElf_Sym sym;\n\t\tGElf_Word shndx;\n\t\tDwfl_Module *module = dwfl_addrmodule(dwfl, addr);\n\t\tDwfl_Line *line;\n\t\tconst char *name, *modname;\n\n\t\tif (!module) {\n\t\t\tbtd_error(index, \"#%-2u ?? [%#\" PRIx64 \"]\", n, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tname = dwfl_module_addrsym(module, addr, &sym, &shndx);\n\t\tif (!name) {\n\t\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\t\tbtd_error(index, \"#%-2u ?? (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\t\tn, modname, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tline = dwfl_module_getsrc(module, addr);\n\t\tif (line) {\n\t\t\tint lineno;\n\t\t\tconst char *src = dwfl_lineinfo(line, NULL, &lineno,\n\t\t\t\t\t\t\tNULL, NULL, NULL);\n\n\t\t\tif (src) {\n\t\t\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" \"\n\t\t\t\t\t\t\"(%s:%d) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\tsrc, lineno, addr);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\t\tmodname, addr);\n\t}\n\n\tbtd_error(index, \"+++++++++++++++++++++++++++\");\n\ndone:\n\tdwfl_end(dwfl);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "btd_error",
          "args": [
            "0xffff",
            "\"Assertion failed: (%s) %s:%d in %s\"",
            "expr",
            "file",
            "line",
            "func"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "btd_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "199-213",
          "snippet": "void btd_error(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_ERR, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_ERR, format, ap);\n\tva_end(ap);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_error(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_ERR, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_ERR, format, ap);\n\tva_end(ap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/backtrace.h\"\n#include \"src/log.h\"\n#include <elfutils/libdwfl.h>\n#include <execinfo.h>\n#include <inttypes.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid btd_assertion_message_expr(const char *file, int line,\n\t\t\t\t\tconst char *func, const char *expr)\n{\n\tbtd_error(0xffff, \"Assertion failed: (%s) %s:%d in %s\",\n\t\t\t\t\t\texpr, file, line, func);\n\tbtd_backtrace(0xffff);\n}"
  },
  {
    "function_name": "btd_backtrace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/backtrace.c",
    "lines": "52-127",
    "snippet": "void btd_backtrace(uint16_t index)\n{\n#ifdef HAVE_BACKTRACE_SUPPORT\n\tchar *debuginfo_path = NULL;\n\tconst Dwfl_Callbacks callbacks = {\n\t\t.find_debuginfo = dwfl_standard_find_debuginfo,\n\t\t.find_elf = dwfl_linux_proc_find_elf,\n\t\t.debuginfo_path = &debuginfo_path,\n\t};\n\tDwfl *dwfl;\n\tvoid *frames[48];\n\tint n, n_ptrs;\n\n\tdwfl = dwfl_begin(&callbacks);\n\n\tif (dwfl_linux_proc_report(dwfl, getpid()))\n\t\tgoto done;\n\n\tdwfl_report_end(dwfl, NULL, NULL);\n\n\tn_ptrs = backtrace(frames, 48);\n\tif (n_ptrs < 1)\n\t\tgoto done;\n\n\tbtd_error(index, \"++++++++ backtrace ++++++++\");\n\n\tfor (n = 1; n < n_ptrs; n++) {\n\t\tGElf_Addr addr = (uintptr_t) frames[n];\n\t\tGElf_Sym sym;\n\t\tGElf_Word shndx;\n\t\tDwfl_Module *module = dwfl_addrmodule(dwfl, addr);\n\t\tDwfl_Line *line;\n\t\tconst char *name, *modname;\n\n\t\tif (!module) {\n\t\t\tbtd_error(index, \"#%-2u ?? [%#\" PRIx64 \"]\", n, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tname = dwfl_module_addrsym(module, addr, &sym, &shndx);\n\t\tif (!name) {\n\t\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\t\tbtd_error(index, \"#%-2u ?? (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\t\tn, modname, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tline = dwfl_module_getsrc(module, addr);\n\t\tif (line) {\n\t\t\tint lineno;\n\t\t\tconst char *src = dwfl_lineinfo(line, NULL, &lineno,\n\t\t\t\t\t\t\tNULL, NULL, NULL);\n\n\t\t\tif (src) {\n\t\t\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" \"\n\t\t\t\t\t\t\"(%s:%d) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\tsrc, lineno, addr);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\t\tmodname, addr);\n\t}\n\n\tbtd_error(index, \"+++++++++++++++++++++++++++\");\n\ndone:\n\tdwfl_end(dwfl);\n#endif\n}",
    "includes": [
      "#include \"src/backtrace.h\"",
      "#include \"src/log.h\"",
      "#include <elfutils/libdwfl.h>",
      "#include <execinfo.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dwfl_end",
          "args": [
            "dwfl"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "btd_error",
          "args": [
            "index",
            "\"+++++++++++++++++++++++++++\""
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "btd_error_failed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/error.c",
          "lines": "124-128",
          "snippet": "DBusMessage *btd_error_failed(DBusMessage *msg, const char *str)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE\n\t\t\t\t\t\".Failed\", \"%s\", str);\n}",
          "includes": [
            "#include \"error.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"error.h\"\n#include \"gdbus/gdbus.h\"\n#include <config.h>\n\nDBusMessage *btd_error_failed(DBusMessage *msg, const char *str)\n{\n\treturn g_dbus_create_error(msg, ERROR_INTERFACE\n\t\t\t\t\t\".Failed\", \"%s\", str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btd_error",
          "args": [
            "index",
            "\"#%-2u %s+%#\" PRIx64 \" (%s) [%#\" PRIx64 \"]\"",
            "n",
            "name",
            "addr - sym.st_value",
            "modname",
            "addr"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "btd_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "199-213",
          "snippet": "void btd_error(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_ERR, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_ERR, format, ap);\n\tva_end(ap);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_error(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_ERR, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_ERR, format, ap);\n\tva_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dwfl_module_info",
          "args": [
            "module",
            "NULL",
            "NULL",
            "NULL",
            "NULL",
            "NULL",
            "NULL",
            "NULL"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dwfl_lineinfo",
          "args": [
            "line",
            "NULL",
            "&lineno",
            "NULL",
            "NULL",
            "NULL"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dwfl_module_getsrc",
          "args": [
            "module",
            "addr"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dwfl_module_info",
          "args": [
            "module",
            "NULL",
            "NULL",
            "NULL",
            "NULL",
            "NULL",
            "NULL",
            "NULL"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dwfl_module_addrsym",
          "args": [
            "module",
            "addr",
            "&sym",
            "&shndx"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dwfl_addrmodule",
          "args": [
            "dwfl",
            "addr"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backtrace",
          "args": [
            "frames",
            "48"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dwfl_report_end",
          "args": [
            "dwfl",
            "NULL",
            "NULL"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dwfl_linux_proc_report",
          "args": [
            "dwfl",
            "getpid()"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dwfl_begin",
          "args": [
            "&callbacks"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/backtrace.h\"\n#include \"src/log.h\"\n#include <elfutils/libdwfl.h>\n#include <execinfo.h>\n#include <inttypes.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid btd_backtrace(uint16_t index)\n{\n#ifdef HAVE_BACKTRACE_SUPPORT\n\tchar *debuginfo_path = NULL;\n\tconst Dwfl_Callbacks callbacks = {\n\t\t.find_debuginfo = dwfl_standard_find_debuginfo,\n\t\t.find_elf = dwfl_linux_proc_find_elf,\n\t\t.debuginfo_path = &debuginfo_path,\n\t};\n\tDwfl *dwfl;\n\tvoid *frames[48];\n\tint n, n_ptrs;\n\n\tdwfl = dwfl_begin(&callbacks);\n\n\tif (dwfl_linux_proc_report(dwfl, getpid()))\n\t\tgoto done;\n\n\tdwfl_report_end(dwfl, NULL, NULL);\n\n\tn_ptrs = backtrace(frames, 48);\n\tif (n_ptrs < 1)\n\t\tgoto done;\n\n\tbtd_error(index, \"++++++++ backtrace ++++++++\");\n\n\tfor (n = 1; n < n_ptrs; n++) {\n\t\tGElf_Addr addr = (uintptr_t) frames[n];\n\t\tGElf_Sym sym;\n\t\tGElf_Word shndx;\n\t\tDwfl_Module *module = dwfl_addrmodule(dwfl, addr);\n\t\tDwfl_Line *line;\n\t\tconst char *name, *modname;\n\n\t\tif (!module) {\n\t\t\tbtd_error(index, \"#%-2u ?? [%#\" PRIx64 \"]\", n, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tname = dwfl_module_addrsym(module, addr, &sym, &shndx);\n\t\tif (!name) {\n\t\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\t\tbtd_error(index, \"#%-2u ?? (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\t\tn, modname, addr);\n\t\t\tcontinue;\n\t\t}\n\n\t\tline = dwfl_module_getsrc(module, addr);\n\t\tif (line) {\n\t\t\tint lineno;\n\t\t\tconst char *src = dwfl_lineinfo(line, NULL, &lineno,\n\t\t\t\t\t\t\tNULL, NULL, NULL);\n\n\t\t\tif (src) {\n\t\t\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" \"\n\t\t\t\t\t\t\"(%s:%d) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\tsrc, lineno, addr);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tmodname = dwfl_module_info(module, NULL, NULL, NULL,\n\t\t\t\t\t\tNULL, NULL, NULL, NULL);\n\t\tbtd_error(index, \"#%-2u %s+%#\" PRIx64 \" (%s) [%#\" PRIx64 \"]\",\n\t\t\t\t\t\tn, name, addr - sym.st_value,\n\t\t\t\t\t\t\t\tmodname, addr);\n\t}\n\n\tbtd_error(index, \"+++++++++++++++++++++++++++\");\n\ndone:\n\tdwfl_end(dwfl);\n#endif\n}"
  },
  {
    "function_name": "btd_backtrace_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/backtrace.c",
    "lines": "39-50",
    "snippet": "void btd_backtrace_init(void)\n{\n#ifdef HAVE_BACKTRACE_SUPPORT\n\tvoid *frames[1];\n\n\t/*\n\t * initialize the backtracer, since the ctor calls dlopen(), which\n\t * calls malloc(), which isn't signal-safe.\n\t */\n\tbacktrace(frames, 1);\n#endif\n}",
    "includes": [
      "#include \"src/backtrace.h\"",
      "#include \"src/log.h\"",
      "#include <elfutils/libdwfl.h>",
      "#include <execinfo.h>",
      "#include <inttypes.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "backtrace",
          "args": [
            "frames",
            "1"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/backtrace.h\"\n#include \"src/log.h\"\n#include <elfutils/libdwfl.h>\n#include <execinfo.h>\n#include <inttypes.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid btd_backtrace_init(void)\n{\n#ifdef HAVE_BACKTRACE_SUPPORT\n\tvoid *frames[1];\n\n\t/*\n\t * initialize the backtracer, since the ctor calls dlopen(), which\n\t * calls malloc(), which isn't signal-safe.\n\t */\n\tbacktrace(frames, 1);\n#endif\n}"
  }
]