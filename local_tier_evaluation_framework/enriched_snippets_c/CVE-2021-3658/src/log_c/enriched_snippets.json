[
  {
    "function_name": "__btd_log_cleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "324-331",
    "snippet": "void __btd_log_cleanup(void)\n{\n\tcloselog();\n\n\tlogging_close();\n\n\tg_strfreev(enabled);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char **enabled = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strfreev",
          "args": [
            "enabled"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logging_close",
          "args": [],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "logging_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "84-90",
          "snippet": "static void logging_close(void)\n{\n\tif (logging_fd >= 0) {\n\t\tclose(logging_fd);\n\t\tlogging_fd = -1;\n\t}\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nstatic void logging_close(void)\n{\n\tif (logging_fd >= 0) {\n\t\tclose(logging_fd);\n\t\tlogging_fd = -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "closelog",
          "args": [],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic char **enabled = NULL;\n\nvoid __btd_log_cleanup(void)\n{\n\tcloselog();\n\n\tlogging_close();\n\n\tg_strfreev(enabled);\n}"
  },
  {
    "function_name": "__btd_log_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "305-322",
    "snippet": "void __btd_log_init(const char *debug, int detach)\n{\n\tint option = LOG_NDELAY | LOG_PID;\n\n\tif (debug != NULL)\n\t\tenabled = g_strsplit_set(debug, \":, \", 0);\n\n\t__btd_enable_debug(__start___debug, __stop___debug);\n\n\tlogging_open();\n\n\tif (!detach)\n\t\toption |= LOG_PERROR;\n\n\topenlog(LOG_IDENT, option, LOG_DAEMON);\n\n\tinfo(\"Bluetooth daemon %s\", VERSION);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define LOG_IDENT \"bluetoothd\""
    ],
    "globals_used": [
      "extern struct btd_debug_desc __start___debug[];",
      "extern struct btd_debug_desc __stop___debug[];",
      "static char **enabled = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "info",
          "args": [
            "\"Bluetooth daemon %s\"",
            "VERSION"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "btd_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "231-245",
          "snippet": "void btd_info(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_INFO, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_INFO, format, ap);\n\tva_end(ap);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_info(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_INFO, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_INFO, format, ap);\n\tva_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openlog",
          "args": [
            "LOG_IDENT",
            "option",
            "LOG_DAEMON"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logging_open",
          "args": [],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "logging_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "59-82",
          "snippet": "static void logging_open(void)\n{\n\tstruct sockaddr_hci addr;\n\tint fd;\n\n\tif (logging_fd >= 0)\n\t\treturn;\n\n\tfd = socket(PF_BLUETOOTH, SOCK_RAW, BTPROTO_HCI);\n\tif (fd < 0)\n\t\treturn;\n\n\tmemset(&addr, 0, sizeof(addr));\n\taddr.hci_family = AF_BLUETOOTH;\n\taddr.hci_dev = HCI_DEV_NONE;\n\taddr.hci_channel = HCI_CHANNEL_LOGGING;\n\n\tif (bind(fd, (struct sockaddr *) &addr, sizeof(addr)) < 0) {\n\t\tclose(fd);\n\t\treturn;\n\t}\n\n\tlogging_fd = fd;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nstatic void logging_open(void)\n{\n\tstruct sockaddr_hci addr;\n\tint fd;\n\n\tif (logging_fd >= 0)\n\t\treturn;\n\n\tfd = socket(PF_BLUETOOTH, SOCK_RAW, BTPROTO_HCI);\n\tif (fd < 0)\n\t\treturn;\n\n\tmemset(&addr, 0, sizeof(addr));\n\taddr.hci_family = AF_BLUETOOTH;\n\taddr.hci_dev = HCI_DEV_NONE;\n\taddr.hci_channel = HCI_CHANNEL_LOGGING;\n\n\tif (bind(fd, (struct sockaddr *) &addr, sizeof(addr)) < 0) {\n\t\tclose(fd);\n\t\treturn;\n\t}\n\n\tlogging_fd = fd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__btd_enable_debug",
          "args": [
            "__start___debug",
            "__stop___debug"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "__btd_enable_debug",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "283-295",
          "snippet": "void __btd_enable_debug(struct btd_debug_desc *start,\n\t\t\t\t\tstruct btd_debug_desc *stop)\n{\n\tstruct btd_debug_desc *desc;\n\n\tif (start == NULL || stop == NULL)\n\t\treturn;\n\n\tfor (desc = start; desc < stop; desc++) {\n\t\tif (is_enabled(desc))\n\t\t\tdesc->flags |= BTD_DEBUG_FLAG_PRINT;\n\t}\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid __btd_enable_debug(struct btd_debug_desc *start,\n\t\t\t\t\tstruct btd_debug_desc *stop)\n{\n\tstruct btd_debug_desc *desc;\n\n\tif (start == NULL || stop == NULL)\n\t\treturn;\n\n\tfor (desc = start; desc < stop; desc++) {\n\t\tif (is_enabled(desc))\n\t\t\tdesc->flags |= BTD_DEBUG_FLAG_PRINT;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strsplit_set",
          "args": [
            "debug",
            "\":, \"",
            "0"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define LOG_IDENT \"bluetoothd\"\n\nextern struct btd_debug_desc __start___debug[];\nextern struct btd_debug_desc __stop___debug[];\nstatic char **enabled = NULL;\n\nvoid __btd_log_init(const char *debug, int detach)\n{\n\tint option = LOG_NDELAY | LOG_PID;\n\n\tif (debug != NULL)\n\t\tenabled = g_strsplit_set(debug, \":, \", 0);\n\n\t__btd_enable_debug(__start___debug, __stop___debug);\n\n\tlogging_open();\n\n\tif (!detach)\n\t\toption |= LOG_PERROR;\n\n\topenlog(LOG_IDENT, option, LOG_DAEMON);\n\n\tinfo(\"Bluetooth daemon %s\", VERSION);\n}"
  },
  {
    "function_name": "__btd_toggle_debug",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "297-303",
    "snippet": "void __btd_toggle_debug(void)\n{\n\tstruct btd_debug_desc *desc;\n\n\tfor (desc = __start___debug; desc < __stop___debug; desc++)\n\t\tdesc->flags |= BTD_DEBUG_FLAG_PRINT;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct btd_debug_desc __start___debug[];",
      "extern struct btd_debug_desc __stop___debug[];"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nextern struct btd_debug_desc __start___debug[];\nextern struct btd_debug_desc __stop___debug[];\n\nvoid __btd_toggle_debug(void)\n{\n\tstruct btd_debug_desc *desc;\n\n\tfor (desc = __start___debug; desc < __stop___debug; desc++)\n\t\tdesc->flags |= BTD_DEBUG_FLAG_PRINT;\n}"
  },
  {
    "function_name": "__btd_enable_debug",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "283-295",
    "snippet": "void __btd_enable_debug(struct btd_debug_desc *start,\n\t\t\t\t\tstruct btd_debug_desc *stop)\n{\n\tstruct btd_debug_desc *desc;\n\n\tif (start == NULL || stop == NULL)\n\t\treturn;\n\n\tfor (desc = start; desc < stop; desc++) {\n\t\tif (is_enabled(desc))\n\t\t\tdesc->flags |= BTD_DEBUG_FLAG_PRINT;\n\t}\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_enabled",
          "args": [
            "desc"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "is_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "268-281",
          "snippet": "static gboolean is_enabled(struct btd_debug_desc *desc)\n{\n\tint i;\n\n\tif (enabled == NULL)\n\t\treturn 0;\n\n\tfor (i = 0; enabled[i] != NULL; i++)\n\t\tif (desc->file != NULL && g_pattern_match_simple(enabled[i],\n\t\t\t\t\t\t\tdesc->file) == TRUE)\n\t\t\treturn 1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char **enabled = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic char **enabled = NULL;\n\nstatic gboolean is_enabled(struct btd_debug_desc *desc)\n{\n\tint i;\n\n\tif (enabled == NULL)\n\t\treturn 0;\n\n\tfor (i = 0; enabled[i] != NULL; i++)\n\t\tif (desc->file != NULL && g_pattern_match_simple(enabled[i],\n\t\t\t\t\t\t\tdesc->file) == TRUE)\n\t\t\treturn 1;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid __btd_enable_debug(struct btd_debug_desc *start,\n\t\t\t\t\tstruct btd_debug_desc *stop)\n{\n\tstruct btd_debug_desc *desc;\n\n\tif (start == NULL || stop == NULL)\n\t\treturn;\n\n\tfor (desc = start; desc < stop; desc++) {\n\t\tif (is_enabled(desc))\n\t\t\tdesc->flags |= BTD_DEBUG_FLAG_PRINT;\n\t}\n}"
  },
  {
    "function_name": "is_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "268-281",
    "snippet": "static gboolean is_enabled(struct btd_debug_desc *desc)\n{\n\tint i;\n\n\tif (enabled == NULL)\n\t\treturn 0;\n\n\tfor (i = 0; enabled[i] != NULL; i++)\n\t\tif (desc->file != NULL && g_pattern_match_simple(enabled[i],\n\t\t\t\t\t\t\tdesc->file) == TRUE)\n\t\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char **enabled = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_pattern_match_simple",
          "args": [
            "enabled[i]",
            "desc->file"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic char **enabled = NULL;\n\nstatic gboolean is_enabled(struct btd_debug_desc *desc)\n{\n\tint i;\n\n\tif (enabled == NULL)\n\t\treturn 0;\n\n\tfor (i = 0; enabled[i] != NULL; i++)\n\t\tif (desc->file != NULL && g_pattern_match_simple(enabled[i],\n\t\t\t\t\t\t\tdesc->file) == TRUE)\n\t\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "btd_debug",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "247-261",
    "snippet": "void btd_debug(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_DEBUG, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_DEBUG, format, ap);\n\tva_end(ap);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int logging_fd = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logging_log",
          "args": [
            "index",
            "LOG_DEBUG",
            "format",
            "ap"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "logging_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "92-133",
          "snippet": "static void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LOG_IDENT_LEN sizeof(LOG_IDENT)",
            "#define LOG_IDENT \"bluetoothd\""
          ],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define LOG_IDENT_LEN sizeof(LOG_IDENT)\n#define LOG_IDENT \"bluetoothd\"\n\nstatic int logging_fd = -1;\n\nstatic void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsyslog",
          "args": [
            "LOG_DEBUG",
            "format",
            "ap"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_debug(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_DEBUG, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_DEBUG, format, ap);\n\tva_end(ap);\n}"
  },
  {
    "function_name": "btd_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "231-245",
    "snippet": "void btd_info(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_INFO, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_INFO, format, ap);\n\tva_end(ap);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int logging_fd = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logging_log",
          "args": [
            "index",
            "LOG_INFO",
            "format",
            "ap"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "logging_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "92-133",
          "snippet": "static void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LOG_IDENT_LEN sizeof(LOG_IDENT)",
            "#define LOG_IDENT \"bluetoothd\""
          ],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define LOG_IDENT_LEN sizeof(LOG_IDENT)\n#define LOG_IDENT \"bluetoothd\"\n\nstatic int logging_fd = -1;\n\nstatic void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsyslog",
          "args": [
            "LOG_INFO",
            "format",
            "ap"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_info(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_INFO, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_INFO, format, ap);\n\tva_end(ap);\n}"
  },
  {
    "function_name": "btd_warn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "215-229",
    "snippet": "void btd_warn(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_WARNING, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_WARNING, format, ap);\n\tva_end(ap);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int logging_fd = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logging_log",
          "args": [
            "index",
            "LOG_WARNING",
            "format",
            "ap"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "logging_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "92-133",
          "snippet": "static void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LOG_IDENT_LEN sizeof(LOG_IDENT)",
            "#define LOG_IDENT \"bluetoothd\""
          ],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define LOG_IDENT_LEN sizeof(LOG_IDENT)\n#define LOG_IDENT \"bluetoothd\"\n\nstatic int logging_fd = -1;\n\nstatic void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsyslog",
          "args": [
            "LOG_WARNING",
            "format",
            "ap"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_warn(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_WARNING, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_WARNING, format, ap);\n\tva_end(ap);\n}"
  },
  {
    "function_name": "btd_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "199-213",
    "snippet": "void btd_error(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_ERR, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_ERR, format, ap);\n\tva_end(ap);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int logging_fd = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logging_log",
          "args": [
            "index",
            "LOG_ERR",
            "format",
            "ap"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "logging_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "92-133",
          "snippet": "static void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LOG_IDENT_LEN sizeof(LOG_IDENT)",
            "#define LOG_IDENT \"bluetoothd\""
          ],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define LOG_IDENT_LEN sizeof(LOG_IDENT)\n#define LOG_IDENT \"bluetoothd\"\n\nstatic int logging_fd = -1;\n\nstatic void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsyslog",
          "args": [
            "LOG_ERR",
            "format",
            "ap"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_error(uint16_t index, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_ERR, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, LOG_ERR, format, ap);\n\tva_end(ap);\n}"
  },
  {
    "function_name": "btd_log",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "183-197",
    "snippet": "void btd_log(uint16_t index, int priority, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(priority, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, priority, format, ap);\n\tva_end(ap);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int logging_fd = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logging_log",
          "args": [
            "index",
            "priority",
            "format",
            "ap"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "logging_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "92-133",
          "snippet": "static void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LOG_IDENT_LEN sizeof(LOG_IDENT)",
            "#define LOG_IDENT \"bluetoothd\""
          ],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define LOG_IDENT_LEN sizeof(LOG_IDENT)\n#define LOG_IDENT \"bluetoothd\"\n\nstatic int logging_fd = -1;\n\nstatic void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsyslog",
          "args": [
            "priority",
            "format",
            "ap"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid btd_log(uint16_t index, int priority, const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(priority, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(index, priority, format, ap);\n\tva_end(ap);\n}"
  },
  {
    "function_name": "info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "167-181",
    "snippet": "void info(const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_INFO, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(HCI_DEV_NONE, LOG_INFO, format, ap);\n\tva_end(ap);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int logging_fd = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logging_log",
          "args": [
            "HCI_DEV_NONE",
            "LOG_INFO",
            "format",
            "ap"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "logging_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "92-133",
          "snippet": "static void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LOG_IDENT_LEN sizeof(LOG_IDENT)",
            "#define LOG_IDENT \"bluetoothd\""
          ],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define LOG_IDENT_LEN sizeof(LOG_IDENT)\n#define LOG_IDENT \"bluetoothd\"\n\nstatic int logging_fd = -1;\n\nstatic void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsyslog",
          "args": [
            "LOG_INFO",
            "format",
            "ap"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid info(const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_INFO, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(HCI_DEV_NONE, LOG_INFO, format, ap);\n\tva_end(ap);\n}"
  },
  {
    "function_name": "warn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "151-165",
    "snippet": "void warn(const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_WARNING, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(HCI_DEV_NONE, LOG_WARNING, format, ap);\n\tva_end(ap);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int logging_fd = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logging_log",
          "args": [
            "HCI_DEV_NONE",
            "LOG_WARNING",
            "format",
            "ap"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "logging_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "92-133",
          "snippet": "static void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LOG_IDENT_LEN sizeof(LOG_IDENT)",
            "#define LOG_IDENT \"bluetoothd\""
          ],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define LOG_IDENT_LEN sizeof(LOG_IDENT)\n#define LOG_IDENT \"bluetoothd\"\n\nstatic int logging_fd = -1;\n\nstatic void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsyslog",
          "args": [
            "LOG_WARNING",
            "format",
            "ap"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid warn(const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_WARNING, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(HCI_DEV_NONE, LOG_WARNING, format, ap);\n\tva_end(ap);\n}"
  },
  {
    "function_name": "error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "135-149",
    "snippet": "void error(const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_ERR, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(HCI_DEV_NONE, LOG_ERR, format, ap);\n\tva_end(ap);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int logging_fd = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logging_log",
          "args": [
            "HCI_DEV_NONE",
            "LOG_ERR",
            "format",
            "ap"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "logging_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
          "lines": "92-133",
          "snippet": "static void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <sys/socket.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LOG_IDENT_LEN sizeof(LOG_IDENT)",
            "#define LOG_IDENT \"bluetoothd\""
          ],
          "globals_used": [
            "static int logging_fd = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define LOG_IDENT_LEN sizeof(LOG_IDENT)\n#define LOG_IDENT \"bluetoothd\"\n\nstatic int logging_fd = -1;\n\nstatic void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsyslog",
          "args": [
            "LOG_ERR",
            "format",
            "ap"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nvoid error(const char *format, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, format);\n\tvsyslog(LOG_ERR, format, ap);\n\tva_end(ap);\n\n\tif (logging_fd < 0)\n\t\treturn;\n\n\tva_start(ap, format);\n\tlogging_log(HCI_DEV_NONE, LOG_ERR, format, ap);\n\tva_end(ap);\n}"
  },
  {
    "function_name": "logging_log",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "92-133",
    "snippet": "static void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define LOG_IDENT_LEN sizeof(LOG_IDENT)",
      "#define LOG_IDENT \"bluetoothd\""
    ],
    "globals_used": [
      "static int logging_fd = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "str"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "gatt_server_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/attrib-server.c",
          "lines": "123-150",
          "snippet": "static void gatt_server_free(struct gatt_server *server)\n{\n\tg_list_free_full(server->database, attrib_free);\n\n\tif (server->l2cap_io != NULL) {\n\t\tg_io_channel_shutdown(server->l2cap_io, FALSE, NULL);\n\t\tg_io_channel_unref(server->l2cap_io);\n\t}\n\n\tif (server->le_io != NULL) {\n\t\tg_io_channel_shutdown(server->le_io, FALSE, NULL);\n\t\tg_io_channel_unref(server->le_io);\n\t}\n\n\tg_slist_free_full(server->clients, (GDestroyNotify) channel_free);\n\n\tif (server->gatt_sdp_handle > 0)\n\t\tadapter_service_remove(server->adapter,\n\t\t\t\t\tserver->gatt_sdp_handle);\n\n\tif (server->gap_sdp_handle > 0)\n\t\tadapter_service_remove(server->adapter, server->gap_sdp_handle);\n\n\tif (server->adapter != NULL)\n\t\tbtd_adapter_unref(server->adapter);\n\n\tg_free(server);\n}",
          "includes": [
            "#include \"attrib-server.h\"",
            "#include \"storage.h\"",
            "#include \"textfile.h\"",
            "#include \"attrib/att-database.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"btio/btio.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <sys/stat.h>",
            "#include <glib.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"attrib-server.h\"\n#include \"storage.h\"\n#include \"textfile.h\"\n#include \"attrib/att-database.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"src/shared/util.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"btio/btio.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <sys/stat.h>\n#include <glib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void gatt_server_free(struct gatt_server *server)\n{\n\tg_list_free_full(server->database, attrib_free);\n\n\tif (server->l2cap_io != NULL) {\n\t\tg_io_channel_shutdown(server->l2cap_io, FALSE, NULL);\n\t\tg_io_channel_unref(server->l2cap_io);\n\t}\n\n\tif (server->le_io != NULL) {\n\t\tg_io_channel_shutdown(server->le_io, FALSE, NULL);\n\t\tg_io_channel_unref(server->le_io);\n\t}\n\n\tg_slist_free_full(server->clients, (GDestroyNotify) channel_free);\n\n\tif (server->gatt_sdp_handle > 0)\n\t\tadapter_service_remove(server->adapter,\n\t\t\t\t\tserver->gatt_sdp_handle);\n\n\tif (server->gap_sdp_handle > 0)\n\t\tadapter_service_remove(server->adapter, server->gap_sdp_handle);\n\n\tif (server->adapter != NULL)\n\t\tbtd_adapter_unref(server->adapter);\n\n\tg_free(server);\n}"
        }
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "logging_fd"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "hfp_context_close_container",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/hfp.c",
          "lines": "334-347",
          "snippet": "bool hfp_context_close_container(struct hfp_context *context)\n{\n\tskip_whitespace(context);\n\n\t/* The list shall be followed by a right parenthesis (\")\" V250 5.7.3.1*/\n\tif (context->data[context->offset] != ')')\n\t\treturn false;\n\n\tcontext->offset++;\n\n\tnext_field(context);\n\n\treturn true;\n}",
          "includes": [
            "#include \"src/shared/hfp.h\"",
            "#include \"src/shared/io.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/ringbuf.h\"",
            "#include \"src/shared/util.h\"",
            "#include <ctype.h>",
            "#include <stdarg.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/hfp.h\"\n#include \"src/shared/io.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/ringbuf.h\"\n#include \"src/shared/util.h\"\n#include <ctype.h>\n#include <stdarg.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <config.h>\n\nbool hfp_context_close_container(struct hfp_context *context)\n{\n\tskip_whitespace(context);\n\n\t/* The list shall be followed by a right parenthesis (\")\" V250 5.7.3.1*/\n\tif (context->data[context->offset] != ')')\n\t\treturn false;\n\n\tcontext->offset++;\n\n\tnext_field(context);\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sendmsg",
          "args": [
            "logging_fd",
            "&msg",
            "0"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&msg",
            "0",
            "sizeof(msg)"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "2 + LOG_IDENT_LEN + len"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "index"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_to_le16",
          "args": [
            "0x0000"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vasprintf",
          "args": [
            "&str",
            "format",
            "ap"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\n#define LOG_IDENT_LEN sizeof(LOG_IDENT)\n#define LOG_IDENT \"bluetoothd\"\n\nstatic int logging_fd = -1;\n\nstatic void logging_log(uint16_t index, int priority,\n\t\t\t\t\tconst char *format, va_list ap)\n{\n\tstruct log_hdr hdr;\n\tstruct msghdr msg;\n\tstruct iovec iov[3];\n\tuint16_t len;\n\tchar *str;\n\n\tif (vasprintf(&str, format, ap) < 0)\n\t\treturn;\n\n\tlen = strlen(str) + 1;\n\n\thdr.opcode = cpu_to_le16(0x0000);\n\thdr.index = cpu_to_le16(index);\n\thdr.len = cpu_to_le16(2 + LOG_IDENT_LEN + len);\n\thdr.priority = priority;\n\thdr.ident_len = LOG_IDENT_LEN;\n\n\tiov[0].iov_base = &hdr;\n\tiov[0].iov_len = sizeof(hdr);\n\n\tiov[1].iov_base = LOG_IDENT;\n\tiov[1].iov_len = LOG_IDENT_LEN;\n\n\tiov[2].iov_base = str;\n\tiov[2].iov_len = len;\n\n\tmemset(&msg, 0, sizeof(msg));\n\tmsg.msg_iov = iov;\n\tmsg.msg_iovlen = 3;\n\n\tif (sendmsg(logging_fd, &msg, 0) < 0) {\n\t\tif (errno != ENODEV) {\n\t\t\tclose(logging_fd);\n\t\t\tlogging_fd = -1;\n\t\t}\n\t}\n\n\tfree(str);\n}"
  },
  {
    "function_name": "logging_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "84-90",
    "snippet": "static void logging_close(void)\n{\n\tif (logging_fd >= 0) {\n\t\tclose(logging_fd);\n\t\tlogging_fd = -1;\n\t}\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int logging_fd = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "logging_fd"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "hfp_context_close_container",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/hfp.c",
          "lines": "334-347",
          "snippet": "bool hfp_context_close_container(struct hfp_context *context)\n{\n\tskip_whitespace(context);\n\n\t/* The list shall be followed by a right parenthesis (\")\" V250 5.7.3.1*/\n\tif (context->data[context->offset] != ')')\n\t\treturn false;\n\n\tcontext->offset++;\n\n\tnext_field(context);\n\n\treturn true;\n}",
          "includes": [
            "#include \"src/shared/hfp.h\"",
            "#include \"src/shared/io.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/ringbuf.h\"",
            "#include \"src/shared/util.h\"",
            "#include <ctype.h>",
            "#include <stdarg.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/hfp.h\"\n#include \"src/shared/io.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/ringbuf.h\"\n#include \"src/shared/util.h\"\n#include <ctype.h>\n#include <stdarg.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <config.h>\n\nbool hfp_context_close_container(struct hfp_context *context)\n{\n\tskip_whitespace(context);\n\n\t/* The list shall be followed by a right parenthesis (\")\" V250 5.7.3.1*/\n\tif (context->data[context->offset] != ')')\n\t\treturn false;\n\n\tcontext->offset++;\n\n\tnext_field(context);\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nstatic void logging_close(void)\n{\n\tif (logging_fd >= 0) {\n\t\tclose(logging_fd);\n\t\tlogging_fd = -1;\n\t}\n}"
  },
  {
    "function_name": "logging_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/log.c",
    "lines": "59-82",
    "snippet": "static void logging_open(void)\n{\n\tstruct sockaddr_hci addr;\n\tint fd;\n\n\tif (logging_fd >= 0)\n\t\treturn;\n\n\tfd = socket(PF_BLUETOOTH, SOCK_RAW, BTPROTO_HCI);\n\tif (fd < 0)\n\t\treturn;\n\n\tmemset(&addr, 0, sizeof(addr));\n\taddr.hci_family = AF_BLUETOOTH;\n\taddr.hci_dev = HCI_DEV_NONE;\n\taddr.hci_channel = HCI_CHANNEL_LOGGING;\n\n\tif (bind(fd, (struct sockaddr *) &addr, sizeof(addr)) < 0) {\n\t\tclose(fd);\n\t\treturn;\n\t}\n\n\tlogging_fd = fd;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <sys/socket.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <errno.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int logging_fd = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "hfp_context_close_container",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/hfp.c",
          "lines": "334-347",
          "snippet": "bool hfp_context_close_container(struct hfp_context *context)\n{\n\tskip_whitespace(context);\n\n\t/* The list shall be followed by a right parenthesis (\")\" V250 5.7.3.1*/\n\tif (context->data[context->offset] != ')')\n\t\treturn false;\n\n\tcontext->offset++;\n\n\tnext_field(context);\n\n\treturn true;\n}",
          "includes": [
            "#include \"src/shared/hfp.h\"",
            "#include \"src/shared/io.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/ringbuf.h\"",
            "#include \"src/shared/util.h\"",
            "#include <ctype.h>",
            "#include <stdarg.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/hfp.h\"\n#include \"src/shared/io.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/ringbuf.h\"\n#include \"src/shared/util.h\"\n#include <ctype.h>\n#include <stdarg.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <config.h>\n\nbool hfp_context_close_container(struct hfp_context *context)\n{\n\tskip_whitespace(context);\n\n\t/* The list shall be followed by a right parenthesis (\")\" V250 5.7.3.1*/\n\tif (context->data[context->offset] != ')')\n\t\treturn false;\n\n\tcontext->offset++;\n\n\tnext_field(context);\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bind",
          "args": [
            "fd",
            "(struct sockaddr *) &addr",
            "sizeof(addr)"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&addr",
            "0",
            "sizeof(addr)"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket",
          "args": [
            "PF_BLUETOOTH",
            "SOCK_RAW",
            "BTPROTO_HCI"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include \"src/shared/util.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <sys/socket.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <errno.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic int logging_fd = -1;\n\nstatic void logging_open(void)\n{\n\tstruct sockaddr_hci addr;\n\tint fd;\n\n\tif (logging_fd >= 0)\n\t\treturn;\n\n\tfd = socket(PF_BLUETOOTH, SOCK_RAW, BTPROTO_HCI);\n\tif (fd < 0)\n\t\treturn;\n\n\tmemset(&addr, 0, sizeof(addr));\n\taddr.hci_family = AF_BLUETOOTH;\n\taddr.hci_dev = HCI_DEV_NONE;\n\taddr.hci_channel = HCI_CHANNEL_LOGGING;\n\n\tif (bind(fd, (struct sockaddr *) &addr, sizeof(addr)) < 0) {\n\t\tclose(fd);\n\t\treturn;\n\t}\n\n\tlogging_fd = fd;\n}"
  }
]