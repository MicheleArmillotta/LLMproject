[
  {
    "function_name": "gap_appearance_to_icon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/dbus-common.c",
    "lines": "130-163",
    "snippet": "const char *gap_appearance_to_icon(uint16_t appearance)\n{\n\tswitch ((appearance & 0xffc0) >> 6) {\n\tcase 0x00:\n\t\treturn \"unknown\";\n\tcase 0x01:\n\t\treturn \"phone\";\n\tcase 0x02:\n\t\treturn \"computer\";\n\tcase 0x05:\n\t\treturn \"video-display\";\n\tcase 0x0a:\n\t\treturn \"multimedia-player\";\n\tcase 0x0b:\n\t\treturn \"scanner\";\n\tcase 0x0f: /* HID Generic */\n\t\tswitch (appearance & 0x3f) {\n\t\tcase 0x01:\n\t\t\treturn \"input-keyboard\";\n\t\tcase 0x02:\n\t\t\treturn \"input-mouse\";\n\t\tcase 0x03:\n\t\tcase 0x04:\n\t\t\treturn \"input-gaming\";\n\t\tcase 0x05:\n\t\t\treturn \"input-tablet\";\n\t\tcase 0x08:\n\t\t\treturn \"scanner\";\n\t\t}\n\t\tbreak;\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"dbus-common.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dbus-common.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <config.h>\n\nconst char *gap_appearance_to_icon(uint16_t appearance)\n{\n\tswitch ((appearance & 0xffc0) >> 6) {\n\tcase 0x00:\n\t\treturn \"unknown\";\n\tcase 0x01:\n\t\treturn \"phone\";\n\tcase 0x02:\n\t\treturn \"computer\";\n\tcase 0x05:\n\t\treturn \"video-display\";\n\tcase 0x0a:\n\t\treturn \"multimedia-player\";\n\tcase 0x0b:\n\t\treturn \"scanner\";\n\tcase 0x0f: /* HID Generic */\n\t\tswitch (appearance & 0x3f) {\n\t\tcase 0x01:\n\t\t\treturn \"input-keyboard\";\n\t\tcase 0x02:\n\t\t\treturn \"input-mouse\";\n\t\tcase 0x03:\n\t\tcase 0x04:\n\t\t\treturn \"input-gaming\";\n\t\tcase 0x05:\n\t\t\treturn \"input-tablet\";\n\t\tcase 0x08:\n\t\t\treturn \"scanner\";\n\t\t}\n\t\tbreak;\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "class_to_icon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/dbus-common.c",
    "lines": "66-128",
    "snippet": "const char *class_to_icon(uint32_t class)\n{\n\tswitch ((class & 0x1f00) >> 8) {\n\tcase 0x01:\n\t\treturn \"computer\";\n\tcase 0x02:\n\t\tswitch ((class & 0xfc) >> 2) {\n\t\tcase 0x01:\n\t\tcase 0x02:\n\t\tcase 0x03:\n\t\tcase 0x05:\n\t\t\treturn \"phone\";\n\t\tcase 0x04:\n\t\t\treturn \"modem\";\n\t\t}\n\t\tbreak;\n\tcase 0x03:\n\t\treturn \"network-wireless\";\n\tcase 0x04:\n\t\tswitch ((class & 0xfc) >> 2) {\n\t\tcase 0x01:\n\t\tcase 0x02:\n\t\t\treturn \"audio-card\";\t/* Headset */\n\t\tcase 0x06:\n\t\t\treturn \"audio-card\";\t/* Headphone */\n\t\tcase 0x0b: /* VCR */\n\t\tcase 0x0c: /* Video Camera */\n\t\tcase 0x0d: /* Camcorder */\n\t\t\treturn \"camera-video\";\n\t\tdefault:\n\t\t\treturn \"audio-card\";\t/* Other audio device */\n\t\t}\n\t\tbreak;\n\tcase 0x05:\n\t\tswitch ((class & 0xc0) >> 6) {\n\t\tcase 0x00:\n\t\t\tswitch ((class & 0x1e) >> 2) {\n\t\t\tcase 0x01:\n\t\t\tcase 0x02:\n\t\t\t\treturn \"input-gaming\";\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 0x01:\n\t\t\treturn \"input-keyboard\";\n\t\tcase 0x02:\n\t\t\tswitch ((class & 0x1e) >> 2) {\n\t\t\tcase 0x05:\n\t\t\t\treturn \"input-tablet\";\n\t\t\tdefault:\n\t\t\t\treturn \"input-mouse\";\n\t\t\t}\n\t\t}\n\t\tbreak;\n\tcase 0x06:\n\t\tif (class & 0x80)\n\t\t\treturn \"printer\";\n\t\tif (class & 0x20)\n\t\t\treturn \"camera-photo\";\n\t\tbreak;\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"dbus-common.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"dbus-common.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <config.h>\n\nconst char *class_to_icon(uint32_t class)\n{\n\tswitch ((class & 0x1f00) >> 8) {\n\tcase 0x01:\n\t\treturn \"computer\";\n\tcase 0x02:\n\t\tswitch ((class & 0xfc) >> 2) {\n\t\tcase 0x01:\n\t\tcase 0x02:\n\t\tcase 0x03:\n\t\tcase 0x05:\n\t\t\treturn \"phone\";\n\t\tcase 0x04:\n\t\t\treturn \"modem\";\n\t\t}\n\t\tbreak;\n\tcase 0x03:\n\t\treturn \"network-wireless\";\n\tcase 0x04:\n\t\tswitch ((class & 0xfc) >> 2) {\n\t\tcase 0x01:\n\t\tcase 0x02:\n\t\t\treturn \"audio-card\";\t/* Headset */\n\t\tcase 0x06:\n\t\t\treturn \"audio-card\";\t/* Headphone */\n\t\tcase 0x0b: /* VCR */\n\t\tcase 0x0c: /* Video Camera */\n\t\tcase 0x0d: /* Camcorder */\n\t\t\treturn \"camera-video\";\n\t\tdefault:\n\t\t\treturn \"audio-card\";\t/* Other audio device */\n\t\t}\n\t\tbreak;\n\tcase 0x05:\n\t\tswitch ((class & 0xc0) >> 6) {\n\t\tcase 0x00:\n\t\t\tswitch ((class & 0x1e) >> 2) {\n\t\t\tcase 0x01:\n\t\t\tcase 0x02:\n\t\t\t\treturn \"input-gaming\";\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 0x01:\n\t\t\treturn \"input-keyboard\";\n\t\tcase 0x02:\n\t\t\tswitch ((class & 0x1e) >> 2) {\n\t\t\tcase 0x05:\n\t\t\t\treturn \"input-tablet\";\n\t\t\tdefault:\n\t\t\t\treturn \"input-mouse\";\n\t\t\t}\n\t\t}\n\t\tbreak;\n\tcase 0x06:\n\t\tif (class & 0x80)\n\t\t\treturn \"printer\";\n\t\tif (class & 0x20)\n\t\t\treturn \"camera-photo\";\n\t\tbreak;\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "btd_get_dbus_connection",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/dbus-common.c",
    "lines": "61-64",
    "snippet": "DBusConnection *btd_get_dbus_connection(void)\n{\n\treturn connection;\n}",
    "includes": [
      "#include \"dbus-common.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DBusConnection *connection = NULL;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"dbus-common.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic DBusConnection *connection = NULL;\n\nDBusConnection *btd_get_dbus_connection(void)\n{\n\treturn connection;\n}"
  },
  {
    "function_name": "set_dbus_connection",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/dbus-common.c",
    "lines": "56-59",
    "snippet": "void set_dbus_connection(DBusConnection *conn)\n{\n\tconnection = conn;\n}",
    "includes": [
      "#include \"dbus-common.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DBusConnection *connection = NULL;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"dbus-common.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic DBusConnection *connection = NULL;\n\nvoid set_dbus_connection(DBusConnection *conn)\n{\n\tconnection = conn;\n}"
  },
  {
    "function_name": "dict_append_array",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/dbus-common.c",
    "lines": "50-54",
    "snippet": "void dict_append_array(DBusMessageIter *dict, const char *key, int type,\n\t\t\tvoid *val, int n_elements)\n{\n\tg_dbus_dict_append_array(dict, key, type, val, n_elements);\n}",
    "includes": [
      "#include \"dbus-common.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_dbus_dict_append_array",
          "args": [
            "dict",
            "key",
            "type",
            "val",
            "n_elements"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dbus-common.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid dict_append_array(DBusMessageIter *dict, const char *key, int type,\n\t\t\tvoid *val, int n_elements)\n{\n\tg_dbus_dict_append_array(dict, key, type, val, n_elements);\n}"
  },
  {
    "function_name": "dict_append_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/dbus-common.c",
    "lines": "44-48",
    "snippet": "void dict_append_entry(DBusMessageIter *dict,\n\t\t\tconst char *key, int type, void *val)\n{\n\tg_dbus_dict_append_entry(dict, key, type, val);\n}",
    "includes": [
      "#include \"dbus-common.h\"",
      "#include \"log.h\"",
      "#include \"gdbus/gdbus.h\"",
      "#include <dbus/dbus.h>",
      "#include <glib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_dbus_dict_append_entry",
          "args": [
            "dict",
            "key",
            "type",
            "val"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"dbus-common.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <config.h>\n\nvoid dict_append_entry(DBusMessageIter *dict,\n\t\t\tconst char *key, int type, void *val)\n{\n\tg_dbus_dict_append_entry(dict, key, type, val);\n}"
  }
]