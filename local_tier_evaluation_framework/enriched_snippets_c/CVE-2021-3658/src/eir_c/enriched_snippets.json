[
  {
    "function_name": "eir_create_oob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "465-613",
    "snippet": "int eir_create_oob(const bdaddr_t *addr, const char *name, uint32_t cod,\n\t\t\tconst uint8_t *hash, const uint8_t *randomizer,\n\t\t\tuint16_t did_vendor, uint16_t did_product,\n\t\t\tuint16_t did_version, uint16_t did_source,\n\t\t\tsdp_list_t *uuids, uint8_t *data)\n{\n\tsdp_list_t *l;\n\tuint8_t *ptr = data;\n\tuint16_t eir_optional_len = 0;\n\tuint16_t eir_total_len;\n\tuint16_t uuid16[HCI_MAX_EIR_LENGTH / 2];\n\tint i, uuid_count = 0;\n\tbool truncated = false;\n\tsize_t name_len;\n\n\teir_total_len =  sizeof(uint16_t) + sizeof(bdaddr_t);\n\tptr += sizeof(uint16_t);\n\n\tmemcpy(ptr, addr, sizeof(bdaddr_t));\n\tptr += sizeof(bdaddr_t);\n\n\tif (cod > 0) {\n\t\tuint8_t class[3];\n\n\t\tclass[0] = (uint8_t) cod;\n\t\tclass[1] = (uint8_t) (cod >> 8);\n\t\tclass[2] = (uint8_t) (cod >> 16);\n\n\t\t*ptr++ = 4;\n\t\t*ptr++ = EIR_CLASS_OF_DEV;\n\n\t\tmemcpy(ptr, class, sizeof(class));\n\t\tptr += sizeof(class);\n\n\t\teir_optional_len += sizeof(class) + 2;\n\t}\n\n\tif (hash) {\n\t\t*ptr++ = 17;\n\t\t*ptr++ = EIR_SSP_HASH;\n\n\t\tmemcpy(ptr, hash, 16);\n\t\tptr += 16;\n\n\t\teir_optional_len += 16 + 2;\n\t}\n\n\tif (randomizer) {\n\t\t*ptr++ = 17;\n\t\t*ptr++ = EIR_SSP_RANDOMIZER;\n\n\t\tmemcpy(ptr, randomizer, 16);\n\t\tptr += 16;\n\n\t\teir_optional_len += 16 + 2;\n\t}\n\n\tname_len = strlen(name);\n\n\tif (name_len > 0) {\n\t\t/* EIR Data type */\n\t\tif (name_len > 48) {\n\t\t\tname_len = 48;\n\t\t\tptr[1] = EIR_NAME_SHORT;\n\t\t} else\n\t\t\tptr[1] = EIR_NAME_COMPLETE;\n\n\t\t/* EIR Data length */\n\t\tptr[0] = name_len + 1;\n\n\t\tmemcpy(ptr + 2, name, name_len);\n\n\t\teir_optional_len += (name_len + 2);\n\t\tptr += (name_len + 2);\n\t}\n\n\tif (did_vendor != 0x0000) {\n\t\t*ptr++ = 9;\n\t\t*ptr++ = EIR_DEVICE_ID;\n\t\t*ptr++ = (did_source & 0x00ff);\n\t\t*ptr++ = (did_source & 0xff00) >> 8;\n\t\t*ptr++ = (did_vendor & 0x00ff);\n\t\t*ptr++ = (did_vendor & 0xff00) >> 8;\n\t\t*ptr++ = (did_product & 0x00ff);\n\t\t*ptr++ = (did_product & 0xff00) >> 8;\n\t\t*ptr++ = (did_version & 0x00ff);\n\t\t*ptr++ = (did_version & 0xff00) >> 8;\n\t\teir_optional_len += 10;\n\t}\n\n\t/* Group all UUID16 types */\n\tfor (l = uuids; l != NULL; l = l->next) {\n\t\tsdp_record_t *rec = l->data;\n\t\tuuid_t *uuid = &rec->svclass;\n\n\t\tif (uuid->type != SDP_UUID16)\n\t\t\tcontinue;\n\n\t\tif (uuid->value.uuid16 < 0x1100)\n\t\t\tcontinue;\n\n\t\tif (uuid->value.uuid16 == PNP_INFO_SVCLASS_ID)\n\t\t\tcontinue;\n\n\t\t/* Stop if not enough space to put next UUID16 */\n\t\tif ((eir_optional_len + 2 + sizeof(uint16_t)) >\n\t\t\t\tHCI_MAX_EIR_LENGTH) {\n\t\t\ttruncated = true;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Check for duplicates */\n\t\tfor (i = 0; i < uuid_count; i++)\n\t\t\tif (uuid16[i] == uuid->value.uuid16)\n\t\t\t\tbreak;\n\n\t\tif (i < uuid_count)\n\t\t\tcontinue;\n\n\t\tuuid16[uuid_count++] = uuid->value.uuid16;\n\t\teir_optional_len += sizeof(uint16_t);\n\t}\n\n\tif (uuid_count > 0) {\n\t\t/* EIR Data length */\n\t\tptr[0] = (uuid_count * sizeof(uint16_t)) + 1;\n\t\t/* EIR Data type */\n\t\tptr[1] = truncated ? EIR_UUID16_SOME : EIR_UUID16_ALL;\n\n\t\tptr += 2;\n\t\teir_optional_len += 2;\n\n\t\tfor (i = 0; i < uuid_count; i++) {\n\t\t\t*ptr++ = (uuid16[i] & 0x00ff);\n\t\t\t*ptr++ = (uuid16[i] & 0xff00) >> 8;\n\t\t}\n\t}\n\n\t/* Group all UUID128 types */\n\tif (eir_optional_len <= HCI_MAX_EIR_LENGTH - 2)\n\t\teir_generate_uuid128(uuids, ptr, &eir_optional_len);\n\n\teir_total_len += eir_optional_len;\n\n\t/* store total length */\n\tput_le16(eir_total_len, data);\n\n\treturn eir_total_len;\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_le16",
          "args": [
            "eir_total_len",
            "data"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "put_le16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.h",
          "lines": "159-162",
          "snippet": "static inline void put_le16(uint16_t val, void *dst)\n{\n\tput_unaligned(cpu_to_le16(val), (uint16_t *) dst);\n}",
          "includes": [
            "#include <string.h>",
            "#include <byteswap.h>",
            "#include <alloca.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <byteswap.h>\n#include <alloca.h>\n#include <stdlib.h>\n#include <stdint.h>\n\nstatic inline void put_le16(uint16_t val, void *dst)\n{\n\tput_unaligned(cpu_to_le16(val), (uint16_t *) dst);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eir_generate_uuid128",
          "args": [
            "uuids",
            "ptr",
            "&eir_optional_len"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "eir_generate_uuid128",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "407-463",
          "snippet": "static void eir_generate_uuid128(sdp_list_t *list, uint8_t *ptr,\n\t\t\t\t\t\t\tuint16_t *eir_len)\n{\n\tint i, k, uuid_count = 0;\n\tuint16_t len = *eir_len;\n\tuint8_t *uuid128;\n\tbool truncated = false;\n\n\t/* Store UUIDs in place, skip 2 bytes to write type and length later */\n\tuuid128 = ptr + 2;\n\n\tfor (; list; list = list->next) {\n\t\tsdp_record_t *rec = list->data;\n\t\tuuid_t *uuid = &rec->svclass;\n\t\tuint8_t *uuid128_data = uuid->value.uuid128.data;\n\n\t\tif (uuid->type != SDP_UUID128)\n\t\t\tcontinue;\n\n\t\t/* Stop if not enough space to put next UUID128 */\n\t\tif ((len + 2 + SIZEOF_UUID128) > HCI_MAX_EIR_LENGTH) {\n\t\t\ttruncated = true;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Check for duplicates, EIR data is Little Endian */\n\t\tfor (i = 0; i < uuid_count; i++) {\n\t\t\tfor (k = 0; k < SIZEOF_UUID128; k++) {\n\t\t\t\tif (uuid128[i * SIZEOF_UUID128 + k] !=\n\t\t\t\t\tuuid128_data[SIZEOF_UUID128 - 1 - k])\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (k == SIZEOF_UUID128)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i < uuid_count)\n\t\t\tcontinue;\n\n\t\t/* EIR data is Little Endian */\n\t\tfor (k = 0; k < SIZEOF_UUID128; k++)\n\t\t\tuuid128[uuid_count * SIZEOF_UUID128 + k] =\n\t\t\t\tuuid128_data[SIZEOF_UUID128 - 1 - k];\n\n\t\tlen += SIZEOF_UUID128;\n\t\tuuid_count++;\n\t}\n\n\tif (uuid_count > 0 || truncated) {\n\t\t/* EIR Data length */\n\t\tptr[0] = (uuid_count * SIZEOF_UUID128) + 1;\n\t\t/* EIR Data type */\n\t\tptr[1] = truncated ? EIR_UUID128_SOME : EIR_UUID128_ALL;\n\t\tlen += 2;\n\t\t*eir_len = len;\n\t}\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SIZEOF_UUID128 16"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\n#define SIZEOF_UUID128 16\n\nstatic void eir_generate_uuid128(sdp_list_t *list, uint8_t *ptr,\n\t\t\t\t\t\t\tuint16_t *eir_len)\n{\n\tint i, k, uuid_count = 0;\n\tuint16_t len = *eir_len;\n\tuint8_t *uuid128;\n\tbool truncated = false;\n\n\t/* Store UUIDs in place, skip 2 bytes to write type and length later */\n\tuuid128 = ptr + 2;\n\n\tfor (; list; list = list->next) {\n\t\tsdp_record_t *rec = list->data;\n\t\tuuid_t *uuid = &rec->svclass;\n\t\tuint8_t *uuid128_data = uuid->value.uuid128.data;\n\n\t\tif (uuid->type != SDP_UUID128)\n\t\t\tcontinue;\n\n\t\t/* Stop if not enough space to put next UUID128 */\n\t\tif ((len + 2 + SIZEOF_UUID128) > HCI_MAX_EIR_LENGTH) {\n\t\t\ttruncated = true;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Check for duplicates, EIR data is Little Endian */\n\t\tfor (i = 0; i < uuid_count; i++) {\n\t\t\tfor (k = 0; k < SIZEOF_UUID128; k++) {\n\t\t\t\tif (uuid128[i * SIZEOF_UUID128 + k] !=\n\t\t\t\t\tuuid128_data[SIZEOF_UUID128 - 1 - k])\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (k == SIZEOF_UUID128)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i < uuid_count)\n\t\t\tcontinue;\n\n\t\t/* EIR data is Little Endian */\n\t\tfor (k = 0; k < SIZEOF_UUID128; k++)\n\t\t\tuuid128[uuid_count * SIZEOF_UUID128 + k] =\n\t\t\t\tuuid128_data[SIZEOF_UUID128 - 1 - k];\n\n\t\tlen += SIZEOF_UUID128;\n\t\tuuid_count++;\n\t}\n\n\tif (uuid_count > 0 || truncated) {\n\t\t/* EIR Data length */\n\t\tptr[0] = (uuid_count * SIZEOF_UUID128) + 1;\n\t\t/* EIR Data type */\n\t\tptr[1] = truncated ? EIR_UUID128_SOME : EIR_UUID128_ALL;\n\t\tlen += 2;\n\t\t*eir_len = len;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ptr + 2",
            "name",
            "name_len"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ptr",
            "randomizer",
            "16"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ptr",
            "hash",
            "16"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ptr",
            "class",
            "sizeof(class)"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ptr",
            "addr",
            "sizeof(bdaddr_t)"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nint eir_create_oob(const bdaddr_t *addr, const char *name, uint32_t cod,\n\t\t\tconst uint8_t *hash, const uint8_t *randomizer,\n\t\t\tuint16_t did_vendor, uint16_t did_product,\n\t\t\tuint16_t did_version, uint16_t did_source,\n\t\t\tsdp_list_t *uuids, uint8_t *data)\n{\n\tsdp_list_t *l;\n\tuint8_t *ptr = data;\n\tuint16_t eir_optional_len = 0;\n\tuint16_t eir_total_len;\n\tuint16_t uuid16[HCI_MAX_EIR_LENGTH / 2];\n\tint i, uuid_count = 0;\n\tbool truncated = false;\n\tsize_t name_len;\n\n\teir_total_len =  sizeof(uint16_t) + sizeof(bdaddr_t);\n\tptr += sizeof(uint16_t);\n\n\tmemcpy(ptr, addr, sizeof(bdaddr_t));\n\tptr += sizeof(bdaddr_t);\n\n\tif (cod > 0) {\n\t\tuint8_t class[3];\n\n\t\tclass[0] = (uint8_t) cod;\n\t\tclass[1] = (uint8_t) (cod >> 8);\n\t\tclass[2] = (uint8_t) (cod >> 16);\n\n\t\t*ptr++ = 4;\n\t\t*ptr++ = EIR_CLASS_OF_DEV;\n\n\t\tmemcpy(ptr, class, sizeof(class));\n\t\tptr += sizeof(class);\n\n\t\teir_optional_len += sizeof(class) + 2;\n\t}\n\n\tif (hash) {\n\t\t*ptr++ = 17;\n\t\t*ptr++ = EIR_SSP_HASH;\n\n\t\tmemcpy(ptr, hash, 16);\n\t\tptr += 16;\n\n\t\teir_optional_len += 16 + 2;\n\t}\n\n\tif (randomizer) {\n\t\t*ptr++ = 17;\n\t\t*ptr++ = EIR_SSP_RANDOMIZER;\n\n\t\tmemcpy(ptr, randomizer, 16);\n\t\tptr += 16;\n\n\t\teir_optional_len += 16 + 2;\n\t}\n\n\tname_len = strlen(name);\n\n\tif (name_len > 0) {\n\t\t/* EIR Data type */\n\t\tif (name_len > 48) {\n\t\t\tname_len = 48;\n\t\t\tptr[1] = EIR_NAME_SHORT;\n\t\t} else\n\t\t\tptr[1] = EIR_NAME_COMPLETE;\n\n\t\t/* EIR Data length */\n\t\tptr[0] = name_len + 1;\n\n\t\tmemcpy(ptr + 2, name, name_len);\n\n\t\teir_optional_len += (name_len + 2);\n\t\tptr += (name_len + 2);\n\t}\n\n\tif (did_vendor != 0x0000) {\n\t\t*ptr++ = 9;\n\t\t*ptr++ = EIR_DEVICE_ID;\n\t\t*ptr++ = (did_source & 0x00ff);\n\t\t*ptr++ = (did_source & 0xff00) >> 8;\n\t\t*ptr++ = (did_vendor & 0x00ff);\n\t\t*ptr++ = (did_vendor & 0xff00) >> 8;\n\t\t*ptr++ = (did_product & 0x00ff);\n\t\t*ptr++ = (did_product & 0xff00) >> 8;\n\t\t*ptr++ = (did_version & 0x00ff);\n\t\t*ptr++ = (did_version & 0xff00) >> 8;\n\t\teir_optional_len += 10;\n\t}\n\n\t/* Group all UUID16 types */\n\tfor (l = uuids; l != NULL; l = l->next) {\n\t\tsdp_record_t *rec = l->data;\n\t\tuuid_t *uuid = &rec->svclass;\n\n\t\tif (uuid->type != SDP_UUID16)\n\t\t\tcontinue;\n\n\t\tif (uuid->value.uuid16 < 0x1100)\n\t\t\tcontinue;\n\n\t\tif (uuid->value.uuid16 == PNP_INFO_SVCLASS_ID)\n\t\t\tcontinue;\n\n\t\t/* Stop if not enough space to put next UUID16 */\n\t\tif ((eir_optional_len + 2 + sizeof(uint16_t)) >\n\t\t\t\tHCI_MAX_EIR_LENGTH) {\n\t\t\ttruncated = true;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Check for duplicates */\n\t\tfor (i = 0; i < uuid_count; i++)\n\t\t\tif (uuid16[i] == uuid->value.uuid16)\n\t\t\t\tbreak;\n\n\t\tif (i < uuid_count)\n\t\t\tcontinue;\n\n\t\tuuid16[uuid_count++] = uuid->value.uuid16;\n\t\teir_optional_len += sizeof(uint16_t);\n\t}\n\n\tif (uuid_count > 0) {\n\t\t/* EIR Data length */\n\t\tptr[0] = (uuid_count * sizeof(uint16_t)) + 1;\n\t\t/* EIR Data type */\n\t\tptr[1] = truncated ? EIR_UUID16_SOME : EIR_UUID16_ALL;\n\n\t\tptr += 2;\n\t\teir_optional_len += 2;\n\n\t\tfor (i = 0; i < uuid_count; i++) {\n\t\t\t*ptr++ = (uuid16[i] & 0x00ff);\n\t\t\t*ptr++ = (uuid16[i] & 0xff00) >> 8;\n\t\t}\n\t}\n\n\t/* Group all UUID128 types */\n\tif (eir_optional_len <= HCI_MAX_EIR_LENGTH - 2)\n\t\teir_generate_uuid128(uuids, ptr, &eir_optional_len);\n\n\teir_total_len += eir_optional_len;\n\n\t/* store total length */\n\tput_le16(eir_total_len, data);\n\n\treturn eir_total_len;\n}"
  },
  {
    "function_name": "eir_generate_uuid128",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "407-463",
    "snippet": "static void eir_generate_uuid128(sdp_list_t *list, uint8_t *ptr,\n\t\t\t\t\t\t\tuint16_t *eir_len)\n{\n\tint i, k, uuid_count = 0;\n\tuint16_t len = *eir_len;\n\tuint8_t *uuid128;\n\tbool truncated = false;\n\n\t/* Store UUIDs in place, skip 2 bytes to write type and length later */\n\tuuid128 = ptr + 2;\n\n\tfor (; list; list = list->next) {\n\t\tsdp_record_t *rec = list->data;\n\t\tuuid_t *uuid = &rec->svclass;\n\t\tuint8_t *uuid128_data = uuid->value.uuid128.data;\n\n\t\tif (uuid->type != SDP_UUID128)\n\t\t\tcontinue;\n\n\t\t/* Stop if not enough space to put next UUID128 */\n\t\tif ((len + 2 + SIZEOF_UUID128) > HCI_MAX_EIR_LENGTH) {\n\t\t\ttruncated = true;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Check for duplicates, EIR data is Little Endian */\n\t\tfor (i = 0; i < uuid_count; i++) {\n\t\t\tfor (k = 0; k < SIZEOF_UUID128; k++) {\n\t\t\t\tif (uuid128[i * SIZEOF_UUID128 + k] !=\n\t\t\t\t\tuuid128_data[SIZEOF_UUID128 - 1 - k])\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (k == SIZEOF_UUID128)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i < uuid_count)\n\t\t\tcontinue;\n\n\t\t/* EIR data is Little Endian */\n\t\tfor (k = 0; k < SIZEOF_UUID128; k++)\n\t\t\tuuid128[uuid_count * SIZEOF_UUID128 + k] =\n\t\t\t\tuuid128_data[SIZEOF_UUID128 - 1 - k];\n\n\t\tlen += SIZEOF_UUID128;\n\t\tuuid_count++;\n\t}\n\n\tif (uuid_count > 0 || truncated) {\n\t\t/* EIR Data length */\n\t\tptr[0] = (uuid_count * SIZEOF_UUID128) + 1;\n\t\t/* EIR Data type */\n\t\tptr[1] = truncated ? EIR_UUID128_SOME : EIR_UUID128_ALL;\n\t\tlen += 2;\n\t\t*eir_len = len;\n\t}\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SIZEOF_UUID128 16"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\n#define SIZEOF_UUID128 16\n\nstatic void eir_generate_uuid128(sdp_list_t *list, uint8_t *ptr,\n\t\t\t\t\t\t\tuint16_t *eir_len)\n{\n\tint i, k, uuid_count = 0;\n\tuint16_t len = *eir_len;\n\tuint8_t *uuid128;\n\tbool truncated = false;\n\n\t/* Store UUIDs in place, skip 2 bytes to write type and length later */\n\tuuid128 = ptr + 2;\n\n\tfor (; list; list = list->next) {\n\t\tsdp_record_t *rec = list->data;\n\t\tuuid_t *uuid = &rec->svclass;\n\t\tuint8_t *uuid128_data = uuid->value.uuid128.data;\n\n\t\tif (uuid->type != SDP_UUID128)\n\t\t\tcontinue;\n\n\t\t/* Stop if not enough space to put next UUID128 */\n\t\tif ((len + 2 + SIZEOF_UUID128) > HCI_MAX_EIR_LENGTH) {\n\t\t\ttruncated = true;\n\t\t\tbreak;\n\t\t}\n\n\t\t/* Check for duplicates, EIR data is Little Endian */\n\t\tfor (i = 0; i < uuid_count; i++) {\n\t\t\tfor (k = 0; k < SIZEOF_UUID128; k++) {\n\t\t\t\tif (uuid128[i * SIZEOF_UUID128 + k] !=\n\t\t\t\t\tuuid128_data[SIZEOF_UUID128 - 1 - k])\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (k == SIZEOF_UUID128)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (i < uuid_count)\n\t\t\tcontinue;\n\n\t\t/* EIR data is Little Endian */\n\t\tfor (k = 0; k < SIZEOF_UUID128; k++)\n\t\t\tuuid128[uuid_count * SIZEOF_UUID128 + k] =\n\t\t\t\tuuid128_data[SIZEOF_UUID128 - 1 - k];\n\n\t\tlen += SIZEOF_UUID128;\n\t\tuuid_count++;\n\t}\n\n\tif (uuid_count > 0 || truncated) {\n\t\t/* EIR Data length */\n\t\tptr[0] = (uuid_count * SIZEOF_UUID128) + 1;\n\t\t/* EIR Data type */\n\t\tptr[1] = truncated ? EIR_UUID128_SOME : EIR_UUID128_ALL;\n\t\tlen += 2;\n\t\t*eir_len = len;\n\t}\n}"
  },
  {
    "function_name": "eir_parse_oob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "382-403",
    "snippet": "int eir_parse_oob(struct eir_data *eir, uint8_t *eir_data, uint16_t eir_len)\n{\n\n\tif (eir_len < EIR_OOB_MIN)\n\t\treturn -1;\n\n\tif (eir_len != get_le16(eir_data))\n\t\treturn -1;\n\n\teir_data += sizeof(uint16_t);\n\teir_len -= sizeof(uint16_t);\n\n\tmemcpy(&eir->addr, eir_data, sizeof(bdaddr_t));\n\teir_data += sizeof(bdaddr_t);\n\teir_len -= sizeof(bdaddr_t);\n\n\t/* optional OOB EIR data */\n\tif (eir_len > 0)\n\t\teir_parse(eir, eir_data, eir_len);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define EIR_OOB_MIN (2 + 6)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eir_parse",
          "args": [
            "eir",
            "eir_data",
            "eir_len"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "eir_parse_oob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "382-403",
          "snippet": "int eir_parse_oob(struct eir_data *eir, uint8_t *eir_data, uint16_t eir_len)\n{\n\n\tif (eir_len < EIR_OOB_MIN)\n\t\treturn -1;\n\n\tif (eir_len != get_le16(eir_data))\n\t\treturn -1;\n\n\teir_data += sizeof(uint16_t);\n\teir_len -= sizeof(uint16_t);\n\n\tmemcpy(&eir->addr, eir_data, sizeof(bdaddr_t));\n\teir_data += sizeof(bdaddr_t);\n\teir_len -= sizeof(bdaddr_t);\n\n\t/* optional OOB EIR data */\n\tif (eir_len > 0)\n\t\teir_parse(eir, eir_data, eir_len);\n\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&eir->addr",
            "eir_data",
            "sizeof(bdaddr_t)"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_le16",
          "args": [
            "eir_data"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "get_le16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.h",
          "lines": "129-132",
          "snippet": "static inline uint16_t get_le16(const void *ptr)\n{\n\treturn le16_to_cpu(get_unaligned((const uint16_t *) ptr));\n}",
          "includes": [
            "#include <string.h>",
            "#include <byteswap.h>",
            "#include <alloca.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <byteswap.h>\n#include <alloca.h>\n#include <stdlib.h>\n#include <stdint.h>\n\nstatic inline uint16_t get_le16(const void *ptr)\n{\n\treturn le16_to_cpu(get_unaligned((const uint16_t *) ptr));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\n#define EIR_OOB_MIN (2 + 6)\n\nint eir_parse_oob(struct eir_data *eir, uint8_t *eir_data, uint16_t eir_len)\n{\n\n\tif (eir_len < EIR_OOB_MIN)\n\t\treturn -1;\n\n\tif (eir_len != get_le16(eir_data))\n\t\treturn -1;\n\n\teir_data += sizeof(uint16_t);\n\teir_len -= sizeof(uint16_t);\n\n\tmemcpy(&eir->addr, eir_data, sizeof(bdaddr_t));\n\teir_data += sizeof(bdaddr_t);\n\teir_len -= sizeof(bdaddr_t);\n\n\t/* optional OOB EIR data */\n\tif (eir_len > 0)\n\t\teir_parse(eir, eir_data, eir_len);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "eir_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "253-380",
    "snippet": "void eir_parse(struct eir_data *eir, const uint8_t *eir_data, uint8_t eir_len)\n{\n\tuint16_t len = 0;\n\n\teir->flags = 0;\n\teir->tx_power = 127;\n\n\t/* No EIR data to parse */\n\tif (eir_data == NULL)\n\t\treturn;\n\n\twhile (len < eir_len - 1) {\n\t\tuint8_t field_len = eir_data[0];\n\t\tconst uint8_t *data;\n\t\tuint8_t data_len;\n\n\t\t/* Check for the end of EIR */\n\t\tif (field_len == 0)\n\t\t\tbreak;\n\n\t\tlen += field_len + 1;\n\n\t\t/* Do not continue EIR Data parsing if got incorrect length */\n\t\tif (len > eir_len)\n\t\t\tbreak;\n\n\t\tdata = &eir_data[2];\n\t\tdata_len = field_len - 1;\n\n\t\tswitch (eir_data[1]) {\n\t\tcase EIR_UUID16_SOME:\n\t\tcase EIR_UUID16_ALL:\n\t\t\teir_parse_uuid16(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_UUID32_SOME:\n\t\tcase EIR_UUID32_ALL:\n\t\t\teir_parse_uuid32(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_UUID128_SOME:\n\t\tcase EIR_UUID128_ALL:\n\t\t\teir_parse_uuid128(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_FLAGS:\n\t\t\tif (data_len > 0)\n\t\t\t\teir->flags = *data;\n\t\t\tbreak;\n\n\t\tcase EIR_NAME_SHORT:\n\t\tcase EIR_NAME_COMPLETE:\n\t\t\t/* Some vendors put a NUL byte terminator into\n\t\t\t * the name */\n\t\t\twhile (data_len > 0 && data[data_len - 1] == '\\0')\n\t\t\t\tdata_len--;\n\n\t\t\tg_free(eir->name);\n\n\t\t\teir->name = name2utf8(data, data_len);\n\t\t\teir->name_complete = eir_data[1] == EIR_NAME_COMPLETE;\n\t\t\tbreak;\n\n\t\tcase EIR_TX_POWER:\n\t\t\tif (data_len < 1)\n\t\t\t\tbreak;\n\t\t\teir->tx_power = (int8_t) data[0];\n\t\t\tbreak;\n\n\t\tcase EIR_CLASS_OF_DEV:\n\t\t\tif (data_len < 3)\n\t\t\t\tbreak;\n\t\t\teir->class = data[0] | (data[1] << 8) |\n\t\t\t\t\t\t\t(data[2] << 16);\n\t\t\tbreak;\n\n\t\tcase EIR_GAP_APPEARANCE:\n\t\t\tif (data_len < 2)\n\t\t\t\tbreak;\n\t\t\teir->appearance = get_le16(data);\n\t\t\tbreak;\n\n\t\tcase EIR_SSP_HASH:\n\t\t\tif (data_len < 16)\n\t\t\t\tbreak;\n\t\t\teir->hash = g_memdup(data, 16);\n\t\t\tbreak;\n\n\t\tcase EIR_SSP_RANDOMIZER:\n\t\t\tif (data_len < 16)\n\t\t\t\tbreak;\n\t\t\teir->randomizer = g_memdup(data, 16);\n\t\t\tbreak;\n\n\t\tcase EIR_DEVICE_ID:\n\t\t\tif (data_len < 8)\n\t\t\t\tbreak;\n\n\t\t\teir->did_source = data[0] | (data[1] << 8);\n\t\t\teir->did_vendor = data[2] | (data[3] << 8);\n\t\t\teir->did_product = data[4] | (data[5] << 8);\n\t\t\teir->did_version = data[6] | (data[7] << 8);\n\t\t\tbreak;\n\n\t\tcase EIR_SVC_DATA16:\n\t\t\teir_parse_uuid16_data(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_SVC_DATA32:\n\t\t\teir_parse_uuid32_data(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_SVC_DATA128:\n\t\t\teir_parse_uuid128_data(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_MANUFACTURER_DATA:\n\t\t\teir_parse_msd(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\teir_parse_data(eir, eir_data[1], data, data_len);\n\t\t\tbreak;\n\t\t}\n\n\t\teir_data += field_len + 1;\n\t}\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eir_parse_data",
          "args": [
            "eir",
            "eir_data[1]",
            "data",
            "data_len"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "eir_parse_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "239-251",
          "snippet": "static void eir_parse_data(struct eir_data *eir, uint8_t type,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_ad *ad;\n\n\tad = g_malloc(sizeof(*ad));\n\tad->type = type;\n\tad->len = len;\n\tad->data = g_malloc(len);\n\tmemcpy(ad->data, data, len);\n\n\teir->data_list = g_slist_append(eir->data_list, ad);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_data(struct eir_data *eir, uint8_t type,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_ad *ad;\n\n\tad = g_malloc(sizeof(*ad));\n\tad->type = type;\n\tad->len = len;\n\tad->data = g_malloc(len);\n\tmemcpy(ad->data, data, len);\n\n\teir->data_list = g_slist_append(eir->data_list, ad);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eir_parse_msd",
          "args": [
            "eir",
            "data",
            "data_len"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "eir_parse_msd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "162-176",
          "snippet": "static void eir_parse_msd(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tstruct eir_msd *msd;\n\n\tif (len < 2 || len > 2 + sizeof(msd->data))\n\t\treturn;\n\n\tmsd = g_malloc(sizeof(*msd));\n\tmsd->company = get_le16(data);\n\tmsd->data_len = len - 2;\n\tmemcpy(&msd->data, data + 2, msd->data_len);\n\n\teir->msd_list = g_slist_append(eir->msd_list, msd);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_msd(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tstruct eir_msd *msd;\n\n\tif (len < 2 || len > 2 + sizeof(msd->data))\n\t\treturn;\n\n\tmsd = g_malloc(sizeof(*msd));\n\tmsd->company = get_le16(data);\n\tmsd->data_len = len - 2;\n\tmemcpy(&msd->data, data + 2, msd->data_len);\n\n\teir->msd_list = g_slist_append(eir->msd_list, msd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eir_parse_uuid128_data",
          "args": [
            "eir",
            "data",
            "data_len"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "eir_parse_uuid128_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "222-237",
          "snippet": "static void eir_parse_uuid128_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\tint k;\n\n\tif (len < 16 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID128;\n\n\tfor (k = 0; k < 16; k++)\n\t\tservice.value.uuid128.data[k] = data[16 - k - 1];\n\n\teir_parse_sd(eir, &service, data + 16, len - 16);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_uuid128_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\tint k;\n\n\tif (len < 16 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID128;\n\n\tfor (k = 0; k < 16; k++)\n\t\tservice.value.uuid128.data[k] = data[16 - k - 1];\n\n\teir_parse_sd(eir, &service, data + 16, len - 16);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eir_parse_uuid32_data",
          "args": [
            "eir",
            "data",
            "data_len"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "eir_parse_uuid32_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "209-220",
          "snippet": "static void eir_parse_uuid32_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\n\tif (len < 4 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID32;\n\tservice.value.uuid32 = get_le32(data);\n\teir_parse_sd(eir, &service, data + 4, len - 4);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_uuid32_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\n\tif (len < 4 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID32;\n\tservice.value.uuid32 = get_le32(data);\n\teir_parse_sd(eir, &service, data + 4, len - 4);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eir_parse_uuid16_data",
          "args": [
            "eir",
            "data",
            "data_len"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "eir_parse_uuid16_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "196-207",
          "snippet": "static void eir_parse_uuid16_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\n\tif (len < 2 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID16;\n\tservice.value.uuid16 = get_le16(data);\n\teir_parse_sd(eir, &service, data + 2, len - 2);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_uuid16_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\n\tif (len < 2 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID16;\n\tservice.value.uuid16 = get_le16(data);\n\teir_parse_sd(eir, &service, data + 2, len - 2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_memdup",
          "args": [
            "data",
            "16"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_memdup",
          "args": [
            "data",
            "16"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_le16",
          "args": [
            "data"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "get_le16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.h",
          "lines": "129-132",
          "snippet": "static inline uint16_t get_le16(const void *ptr)\n{\n\treturn le16_to_cpu(get_unaligned((const uint16_t *) ptr));\n}",
          "includes": [
            "#include <string.h>",
            "#include <byteswap.h>",
            "#include <alloca.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <byteswap.h>\n#include <alloca.h>\n#include <stdlib.h>\n#include <stdint.h>\n\nstatic inline uint16_t get_le16(const void *ptr)\n{\n\treturn le16_to_cpu(get_unaligned((const uint16_t *) ptr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "name2utf8",
          "args": [
            "data",
            "data_len"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "name2utf8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "139-160",
          "snippet": "static char *name2utf8(const uint8_t *name, uint8_t len)\n{\n\tchar utf8_name[HCI_MAX_NAME_LENGTH + 2];\n\tint i;\n\n\tif (g_utf8_validate((const char *) name, len, NULL))\n\t\treturn g_strndup((char *) name, len);\n\n\tmemset(utf8_name, 0, sizeof(utf8_name));\n\tstrncpy(utf8_name, (char *) name, len);\n\n\t/* Assume ASCII, and replace all non-ASCII with spaces */\n\tfor (i = 0; utf8_name[i] != '\\0'; i++) {\n\t\tif (!isascii(utf8_name[i]))\n\t\t\tutf8_name[i] = ' ';\n\t}\n\n\t/* Remove leading and trailing whitespace characters */\n\tg_strstrip(utf8_name);\n\n\treturn g_strdup(utf8_name);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic char *name2utf8(const uint8_t *name, uint8_t len)\n{\n\tchar utf8_name[HCI_MAX_NAME_LENGTH + 2];\n\tint i;\n\n\tif (g_utf8_validate((const char *) name, len, NULL))\n\t\treturn g_strndup((char *) name, len);\n\n\tmemset(utf8_name, 0, sizeof(utf8_name));\n\tstrncpy(utf8_name, (char *) name, len);\n\n\t/* Assume ASCII, and replace all non-ASCII with spaces */\n\tfor (i = 0; utf8_name[i] != '\\0'; i++) {\n\t\tif (!isascii(utf8_name[i]))\n\t\t\tutf8_name[i] = ' ';\n\t}\n\n\t/* Remove leading and trailing whitespace characters */\n\tg_strstrip(utf8_name);\n\n\treturn g_strdup(utf8_name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "eir->name"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nvoid eir_parse(struct eir_data *eir, const uint8_t *eir_data, uint8_t eir_len)\n{\n\tuint16_t len = 0;\n\n\teir->flags = 0;\n\teir->tx_power = 127;\n\n\t/* No EIR data to parse */\n\tif (eir_data == NULL)\n\t\treturn;\n\n\twhile (len < eir_len - 1) {\n\t\tuint8_t field_len = eir_data[0];\n\t\tconst uint8_t *data;\n\t\tuint8_t data_len;\n\n\t\t/* Check for the end of EIR */\n\t\tif (field_len == 0)\n\t\t\tbreak;\n\n\t\tlen += field_len + 1;\n\n\t\t/* Do not continue EIR Data parsing if got incorrect length */\n\t\tif (len > eir_len)\n\t\t\tbreak;\n\n\t\tdata = &eir_data[2];\n\t\tdata_len = field_len - 1;\n\n\t\tswitch (eir_data[1]) {\n\t\tcase EIR_UUID16_SOME:\n\t\tcase EIR_UUID16_ALL:\n\t\t\teir_parse_uuid16(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_UUID32_SOME:\n\t\tcase EIR_UUID32_ALL:\n\t\t\teir_parse_uuid32(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_UUID128_SOME:\n\t\tcase EIR_UUID128_ALL:\n\t\t\teir_parse_uuid128(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_FLAGS:\n\t\t\tif (data_len > 0)\n\t\t\t\teir->flags = *data;\n\t\t\tbreak;\n\n\t\tcase EIR_NAME_SHORT:\n\t\tcase EIR_NAME_COMPLETE:\n\t\t\t/* Some vendors put a NUL byte terminator into\n\t\t\t * the name */\n\t\t\twhile (data_len > 0 && data[data_len - 1] == '\\0')\n\t\t\t\tdata_len--;\n\n\t\t\tg_free(eir->name);\n\n\t\t\teir->name = name2utf8(data, data_len);\n\t\t\teir->name_complete = eir_data[1] == EIR_NAME_COMPLETE;\n\t\t\tbreak;\n\n\t\tcase EIR_TX_POWER:\n\t\t\tif (data_len < 1)\n\t\t\t\tbreak;\n\t\t\teir->tx_power = (int8_t) data[0];\n\t\t\tbreak;\n\n\t\tcase EIR_CLASS_OF_DEV:\n\t\t\tif (data_len < 3)\n\t\t\t\tbreak;\n\t\t\teir->class = data[0] | (data[1] << 8) |\n\t\t\t\t\t\t\t(data[2] << 16);\n\t\t\tbreak;\n\n\t\tcase EIR_GAP_APPEARANCE:\n\t\t\tif (data_len < 2)\n\t\t\t\tbreak;\n\t\t\teir->appearance = get_le16(data);\n\t\t\tbreak;\n\n\t\tcase EIR_SSP_HASH:\n\t\t\tif (data_len < 16)\n\t\t\t\tbreak;\n\t\t\teir->hash = g_memdup(data, 16);\n\t\t\tbreak;\n\n\t\tcase EIR_SSP_RANDOMIZER:\n\t\t\tif (data_len < 16)\n\t\t\t\tbreak;\n\t\t\teir->randomizer = g_memdup(data, 16);\n\t\t\tbreak;\n\n\t\tcase EIR_DEVICE_ID:\n\t\t\tif (data_len < 8)\n\t\t\t\tbreak;\n\n\t\t\teir->did_source = data[0] | (data[1] << 8);\n\t\t\teir->did_vendor = data[2] | (data[3] << 8);\n\t\t\teir->did_product = data[4] | (data[5] << 8);\n\t\t\teir->did_version = data[6] | (data[7] << 8);\n\t\t\tbreak;\n\n\t\tcase EIR_SVC_DATA16:\n\t\t\teir_parse_uuid16_data(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_SVC_DATA32:\n\t\t\teir_parse_uuid32_data(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_SVC_DATA128:\n\t\t\teir_parse_uuid128_data(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tcase EIR_MANUFACTURER_DATA:\n\t\t\teir_parse_msd(eir, data, data_len);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\teir_parse_data(eir, eir_data[1], data, data_len);\n\t\t\tbreak;\n\t\t}\n\n\t\teir_data += field_len + 1;\n\t}\n}"
  },
  {
    "function_name": "eir_parse_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "239-251",
    "snippet": "static void eir_parse_data(struct eir_data *eir, uint8_t type,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_ad *ad;\n\n\tad = g_malloc(sizeof(*ad));\n\tad->type = type;\n\tad->len = len;\n\tad->data = g_malloc(len);\n\tmemcpy(ad->data, data, len);\n\n\teir->data_list = g_slist_append(eir->data_list, ad);\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_slist_append",
          "args": [
            "eir->data_list",
            "ad"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ad->data",
            "data",
            "len"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_malloc",
          "args": [
            "len"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_malloc",
          "args": [
            "sizeof(*ad)"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_data(struct eir_data *eir, uint8_t type,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_ad *ad;\n\n\tad = g_malloc(sizeof(*ad));\n\tad->type = type;\n\tad->len = len;\n\tad->data = g_malloc(len);\n\tmemcpy(ad->data, data, len);\n\n\teir->data_list = g_slist_append(eir->data_list, ad);\n}"
  },
  {
    "function_name": "eir_parse_uuid128_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "222-237",
    "snippet": "static void eir_parse_uuid128_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\tint k;\n\n\tif (len < 16 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID128;\n\n\tfor (k = 0; k < 16; k++)\n\t\tservice.value.uuid128.data[k] = data[16 - k - 1];\n\n\teir_parse_sd(eir, &service, data + 16, len - 16);\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eir_parse_sd",
          "args": [
            "eir",
            "&service",
            "data + 16",
            "len - 16"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "eir_parse_sd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "178-194",
          "snippet": "static void eir_parse_sd(struct eir_data *eir, uuid_t *service,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_sd *sd;\n\tchar *uuid;\n\n\tuuid = bt_uuid2string(service);\n\tif (!uuid)\n\t\treturn;\n\n\tsd = g_malloc(sizeof(*sd));\n\tsd->uuid = uuid;\n\tsd->data_len = len;\n\tmemcpy(&sd->data, data, sd->data_len);\n\n\teir->sd_list = g_slist_append(eir->sd_list, sd);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_sd(struct eir_data *eir, uuid_t *service,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_sd *sd;\n\tchar *uuid;\n\n\tuuid = bt_uuid2string(service);\n\tif (!uuid)\n\t\treturn;\n\n\tsd = g_malloc(sizeof(*sd));\n\tsd->uuid = uuid;\n\tsd->data_len = len;\n\tmemcpy(&sd->data, data, sd->data_len);\n\n\teir->sd_list = g_slist_append(eir->sd_list, sd);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_uuid128_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\tint k;\n\n\tif (len < 16 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID128;\n\n\tfor (k = 0; k < 16; k++)\n\t\tservice.value.uuid128.data[k] = data[16 - k - 1];\n\n\teir_parse_sd(eir, &service, data + 16, len - 16);\n}"
  },
  {
    "function_name": "eir_parse_uuid32_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "209-220",
    "snippet": "static void eir_parse_uuid32_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\n\tif (len < 4 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID32;\n\tservice.value.uuid32 = get_le32(data);\n\teir_parse_sd(eir, &service, data + 4, len - 4);\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eir_parse_sd",
          "args": [
            "eir",
            "&service",
            "data + 4",
            "len - 4"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "eir_parse_sd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "178-194",
          "snippet": "static void eir_parse_sd(struct eir_data *eir, uuid_t *service,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_sd *sd;\n\tchar *uuid;\n\n\tuuid = bt_uuid2string(service);\n\tif (!uuid)\n\t\treturn;\n\n\tsd = g_malloc(sizeof(*sd));\n\tsd->uuid = uuid;\n\tsd->data_len = len;\n\tmemcpy(&sd->data, data, sd->data_len);\n\n\teir->sd_list = g_slist_append(eir->sd_list, sd);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_sd(struct eir_data *eir, uuid_t *service,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_sd *sd;\n\tchar *uuid;\n\n\tuuid = bt_uuid2string(service);\n\tif (!uuid)\n\t\treturn;\n\n\tsd = g_malloc(sizeof(*sd));\n\tsd->uuid = uuid;\n\tsd->data_len = len;\n\tmemcpy(&sd->data, data, sd->data_len);\n\n\teir->sd_list = g_slist_append(eir->sd_list, sd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_le32",
          "args": [
            "data"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "get_le32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.h",
          "lines": "139-142",
          "snippet": "static inline uint32_t get_le32(const void *ptr)\n{\n\treturn le32_to_cpu(get_unaligned((const uint32_t *) ptr));\n}",
          "includes": [
            "#include <string.h>",
            "#include <byteswap.h>",
            "#include <alloca.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <byteswap.h>\n#include <alloca.h>\n#include <stdlib.h>\n#include <stdint.h>\n\nstatic inline uint32_t get_le32(const void *ptr)\n{\n\treturn le32_to_cpu(get_unaligned((const uint32_t *) ptr));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_uuid32_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\n\tif (len < 4 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID32;\n\tservice.value.uuid32 = get_le32(data);\n\teir_parse_sd(eir, &service, data + 4, len - 4);\n}"
  },
  {
    "function_name": "eir_parse_uuid16_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "196-207",
    "snippet": "static void eir_parse_uuid16_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\n\tif (len < 2 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID16;\n\tservice.value.uuid16 = get_le16(data);\n\teir_parse_sd(eir, &service, data + 2, len - 2);\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eir_parse_sd",
          "args": [
            "eir",
            "&service",
            "data + 2",
            "len - 2"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "eir_parse_sd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "178-194",
          "snippet": "static void eir_parse_sd(struct eir_data *eir, uuid_t *service,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_sd *sd;\n\tchar *uuid;\n\n\tuuid = bt_uuid2string(service);\n\tif (!uuid)\n\t\treturn;\n\n\tsd = g_malloc(sizeof(*sd));\n\tsd->uuid = uuid;\n\tsd->data_len = len;\n\tmemcpy(&sd->data, data, sd->data_len);\n\n\teir->sd_list = g_slist_append(eir->sd_list, sd);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_sd(struct eir_data *eir, uuid_t *service,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_sd *sd;\n\tchar *uuid;\n\n\tuuid = bt_uuid2string(service);\n\tif (!uuid)\n\t\treturn;\n\n\tsd = g_malloc(sizeof(*sd));\n\tsd->uuid = uuid;\n\tsd->data_len = len;\n\tmemcpy(&sd->data, data, sd->data_len);\n\n\teir->sd_list = g_slist_append(eir->sd_list, sd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_le16",
          "args": [
            "data"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "get_le16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.h",
          "lines": "129-132",
          "snippet": "static inline uint16_t get_le16(const void *ptr)\n{\n\treturn le16_to_cpu(get_unaligned((const uint16_t *) ptr));\n}",
          "includes": [
            "#include <string.h>",
            "#include <byteswap.h>",
            "#include <alloca.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <byteswap.h>\n#include <alloca.h>\n#include <stdlib.h>\n#include <stdint.h>\n\nstatic inline uint16_t get_le16(const void *ptr)\n{\n\treturn le16_to_cpu(get_unaligned((const uint16_t *) ptr));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_uuid16_data(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tuuid_t service;\n\n\tif (len < 2 || len > EIR_SD_MAX_LEN)\n\t\treturn;\n\n\tservice.type = SDP_UUID16;\n\tservice.value.uuid16 = get_le16(data);\n\teir_parse_sd(eir, &service, data + 2, len - 2);\n}"
  },
  {
    "function_name": "eir_parse_sd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "178-194",
    "snippet": "static void eir_parse_sd(struct eir_data *eir, uuid_t *service,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_sd *sd;\n\tchar *uuid;\n\n\tuuid = bt_uuid2string(service);\n\tif (!uuid)\n\t\treturn;\n\n\tsd = g_malloc(sizeof(*sd));\n\tsd->uuid = uuid;\n\tsd->data_len = len;\n\tmemcpy(&sd->data, data, sd->data_len);\n\n\teir->sd_list = g_slist_append(eir->sd_list, sd);\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_slist_append",
          "args": [
            "eir->sd_list",
            "sd"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&sd->data",
            "data",
            "sd->data_len"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_malloc",
          "args": [
            "sizeof(*sd)"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bt_uuid2string",
          "args": [
            "service"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "bt_uuid2string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
          "lines": "65-110",
          "snippet": "char *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}",
          "includes": [
            "#include \"uuid-helper.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <arpa/inet.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_sd(struct eir_data *eir, uuid_t *service,\n\t\t\t\t\tconst uint8_t *data, uint8_t len)\n{\n\tstruct eir_sd *sd;\n\tchar *uuid;\n\n\tuuid = bt_uuid2string(service);\n\tif (!uuid)\n\t\treturn;\n\n\tsd = g_malloc(sizeof(*sd));\n\tsd->uuid = uuid;\n\tsd->data_len = len;\n\tmemcpy(&sd->data, data, sd->data_len);\n\n\teir->sd_list = g_slist_append(eir->sd_list, sd);\n}"
  },
  {
    "function_name": "eir_parse_msd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "162-176",
    "snippet": "static void eir_parse_msd(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tstruct eir_msd *msd;\n\n\tif (len < 2 || len > 2 + sizeof(msd->data))\n\t\treturn;\n\n\tmsd = g_malloc(sizeof(*msd));\n\tmsd->company = get_le16(data);\n\tmsd->data_len = len - 2;\n\tmemcpy(&msd->data, data + 2, msd->data_len);\n\n\teir->msd_list = g_slist_append(eir->msd_list, msd);\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_slist_append",
          "args": [
            "eir->msd_list",
            "msd"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&msd->data",
            "data + 2",
            "msd->data_len"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_le16",
          "args": [
            "data"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "get_le16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.h",
          "lines": "129-132",
          "snippet": "static inline uint16_t get_le16(const void *ptr)\n{\n\treturn le16_to_cpu(get_unaligned((const uint16_t *) ptr));\n}",
          "includes": [
            "#include <string.h>",
            "#include <byteswap.h>",
            "#include <alloca.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <byteswap.h>\n#include <alloca.h>\n#include <stdlib.h>\n#include <stdint.h>\n\nstatic inline uint16_t get_le16(const void *ptr)\n{\n\treturn le16_to_cpu(get_unaligned((const uint16_t *) ptr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_malloc",
          "args": [
            "sizeof(*msd)"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_msd(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tstruct eir_msd *msd;\n\n\tif (len < 2 || len > 2 + sizeof(msd->data))\n\t\treturn;\n\n\tmsd = g_malloc(sizeof(*msd));\n\tmsd->company = get_le16(data);\n\tmsd->data_len = len - 2;\n\tmemcpy(&msd->data, data + 2, msd->data_len);\n\n\teir->msd_list = g_slist_append(eir->msd_list, msd);\n}"
  },
  {
    "function_name": "name2utf8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "139-160",
    "snippet": "static char *name2utf8(const uint8_t *name, uint8_t len)\n{\n\tchar utf8_name[HCI_MAX_NAME_LENGTH + 2];\n\tint i;\n\n\tif (g_utf8_validate((const char *) name, len, NULL))\n\t\treturn g_strndup((char *) name, len);\n\n\tmemset(utf8_name, 0, sizeof(utf8_name));\n\tstrncpy(utf8_name, (char *) name, len);\n\n\t/* Assume ASCII, and replace all non-ASCII with spaces */\n\tfor (i = 0; utf8_name[i] != '\\0'; i++) {\n\t\tif (!isascii(utf8_name[i]))\n\t\t\tutf8_name[i] = ' ';\n\t}\n\n\t/* Remove leading and trailing whitespace characters */\n\tg_strstrip(utf8_name);\n\n\treturn g_strdup(utf8_name);\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "utf8_name"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strstrip",
          "args": [
            "utf8_name"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isascii",
          "args": [
            "utf8_name[i]"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "utf8_name",
            "(char *) name",
            "len"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "utf8_name",
            "0",
            "sizeof(utf8_name)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "(char *) name",
            "len"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_utf8_validate",
          "args": [
            "(const char *) name",
            "len",
            "NULL"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic char *name2utf8(const uint8_t *name, uint8_t len)\n{\n\tchar utf8_name[HCI_MAX_NAME_LENGTH + 2];\n\tint i;\n\n\tif (g_utf8_validate((const char *) name, len, NULL))\n\t\treturn g_strndup((char *) name, len);\n\n\tmemset(utf8_name, 0, sizeof(utf8_name));\n\tstrncpy(utf8_name, (char *) name, len);\n\n\t/* Assume ASCII, and replace all non-ASCII with spaces */\n\tfor (i = 0; utf8_name[i] != '\\0'; i++) {\n\t\tif (!isascii(utf8_name[i]))\n\t\t\tutf8_name[i] = ' ';\n\t}\n\n\t/* Remove leading and trailing whitespace characters */\n\tg_strstrip(utf8_name);\n\n\treturn g_strdup(utf8_name);\n}"
  },
  {
    "function_name": "eir_parse_uuid128",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "118-137",
    "snippet": "static void eir_parse_uuid128(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tconst uint8_t *uuid_ptr = data;\n\tuuid_t service;\n\tchar *uuid_str;\n\tunsigned int i;\n\tint k;\n\n\tservice.type = SDP_UUID128;\n\tfor (i = 0; i < len / 16; i++) {\n\t\tfor (k = 0; k < 16; k++)\n\t\t\tservice.value.uuid128.data[k] = uuid_ptr[16 - k - 1];\n\t\tuuid_str = bt_uuid2string(&service);\n\t\tif (!uuid_str)\n\t\t\tcontinue;\n\t\teir->services = g_slist_append(eir->services, uuid_str);\n\t\tuuid_ptr += 16;\n\t}\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_slist_append",
          "args": [
            "eir->services",
            "uuid_str"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bt_uuid2string",
          "args": [
            "&service"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "bt_uuid2string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
          "lines": "65-110",
          "snippet": "char *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}",
          "includes": [
            "#include \"uuid-helper.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <arpa/inet.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_uuid128(struct eir_data *eir, const uint8_t *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tconst uint8_t *uuid_ptr = data;\n\tuuid_t service;\n\tchar *uuid_str;\n\tunsigned int i;\n\tint k;\n\n\tservice.type = SDP_UUID128;\n\tfor (i = 0; i < len / 16; i++) {\n\t\tfor (k = 0; k < 16; k++)\n\t\t\tservice.value.uuid128.data[k] = uuid_ptr[16 - k - 1];\n\t\tuuid_str = bt_uuid2string(&service);\n\t\tif (!uuid_str)\n\t\t\tcontinue;\n\t\teir->services = g_slist_append(eir->services, uuid_str);\n\t\tuuid_ptr += 16;\n\t}\n}"
  },
  {
    "function_name": "eir_parse_uuid32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "99-116",
    "snippet": "static void eir_parse_uuid32(struct eir_data *eir, const void *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tconst uint32_t *uuid32 = data;\n\tuuid_t service;\n\tchar *uuid_str;\n\tunsigned int i;\n\n\tservice.type = SDP_UUID32;\n\tfor (i = 0; i < len / 4; i++, uuid32++) {\n\t\tservice.value.uuid32 = get_le32(uuid32);\n\n\t\tuuid_str = bt_uuid2string(&service);\n\t\tif (!uuid_str)\n\t\t\tcontinue;\n\t\teir->services = g_slist_append(eir->services, uuid_str);\n\t}\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_slist_append",
          "args": [
            "eir->services",
            "uuid_str"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bt_uuid2string",
          "args": [
            "&service"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "bt_uuid2string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
          "lines": "65-110",
          "snippet": "char *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}",
          "includes": [
            "#include \"uuid-helper.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <arpa/inet.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_le32",
          "args": [
            "uuid32"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "get_le32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.h",
          "lines": "139-142",
          "snippet": "static inline uint32_t get_le32(const void *ptr)\n{\n\treturn le32_to_cpu(get_unaligned((const uint32_t *) ptr));\n}",
          "includes": [
            "#include <string.h>",
            "#include <byteswap.h>",
            "#include <alloca.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <byteswap.h>\n#include <alloca.h>\n#include <stdlib.h>\n#include <stdint.h>\n\nstatic inline uint32_t get_le32(const void *ptr)\n{\n\treturn le32_to_cpu(get_unaligned((const uint32_t *) ptr));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_uuid32(struct eir_data *eir, const void *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tconst uint32_t *uuid32 = data;\n\tuuid_t service;\n\tchar *uuid_str;\n\tunsigned int i;\n\n\tservice.type = SDP_UUID32;\n\tfor (i = 0; i < len / 4; i++, uuid32++) {\n\t\tservice.value.uuid32 = get_le32(uuid32);\n\n\t\tuuid_str = bt_uuid2string(&service);\n\t\tif (!uuid_str)\n\t\t\tcontinue;\n\t\teir->services = g_slist_append(eir->services, uuid_str);\n\t}\n}"
  },
  {
    "function_name": "eir_parse_uuid16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "80-97",
    "snippet": "static void eir_parse_uuid16(struct eir_data *eir, const void *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tconst uint16_t *uuid16 = data;\n\tuuid_t service;\n\tchar *uuid_str;\n\tunsigned int i;\n\n\tservice.type = SDP_UUID16;\n\tfor (i = 0; i < len / 2; i++, uuid16++) {\n\t\tservice.value.uuid16 = get_le16(uuid16);\n\n\t\tuuid_str = bt_uuid2string(&service);\n\t\tif (!uuid_str)\n\t\t\tcontinue;\n\t\teir->services = g_slist_append(eir->services, uuid_str);\n\t}\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_slist_append",
          "args": [
            "eir->services",
            "uuid_str"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bt_uuid2string",
          "args": [
            "&service"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "bt_uuid2string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
          "lines": "65-110",
          "snippet": "char *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}",
          "includes": [
            "#include \"uuid-helper.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <arpa/inet.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_le16",
          "args": [
            "uuid16"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "get_le16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/util.h",
          "lines": "129-132",
          "snippet": "static inline uint16_t get_le16(const void *ptr)\n{\n\treturn le16_to_cpu(get_unaligned((const uint16_t *) ptr));\n}",
          "includes": [
            "#include <string.h>",
            "#include <byteswap.h>",
            "#include <alloca.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <byteswap.h>\n#include <alloca.h>\n#include <stdlib.h>\n#include <stdint.h>\n\nstatic inline uint16_t get_le16(const void *ptr)\n{\n\treturn le16_to_cpu(get_unaligned((const uint16_t *) ptr));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void eir_parse_uuid16(struct eir_data *eir, const void *data,\n\t\t\t\t\t\t\t\tuint8_t len)\n{\n\tconst uint16_t *uuid16 = data;\n\tuuid_t service;\n\tchar *uuid_str;\n\tunsigned int i;\n\n\tservice.type = SDP_UUID16;\n\tfor (i = 0; i < len / 2; i++, uuid16++) {\n\t\tservice.value.uuid16 = get_le16(uuid16);\n\n\t\tuuid_str = bt_uuid2string(&service);\n\t\tif (!uuid_str)\n\t\t\tcontinue;\n\t\teir->services = g_slist_append(eir->services, uuid_str);\n\t}\n}"
  },
  {
    "function_name": "eir_data_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "62-78",
    "snippet": "void eir_data_free(struct eir_data *eir)\n{\n\tg_slist_free_full(eir->services, free);\n\teir->services = NULL;\n\tg_free(eir->name);\n\teir->name = NULL;\n\tg_free(eir->hash);\n\teir->hash = NULL;\n\tg_free(eir->randomizer);\n\teir->randomizer = NULL;\n\tg_slist_free_full(eir->msd_list, g_free);\n\teir->msd_list = NULL;\n\tg_slist_free_full(eir->sd_list, sd_free);\n\teir->sd_list = NULL;\n\tg_slist_free_full(eir->data_list, data_free);\n\teir->data_list = NULL;\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_slist_free_full",
          "args": [
            "eir->data_list",
            "data_free"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_slist_free_full",
          "args": [
            "eir->sd_list",
            "sd_free"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_slist_free_full",
          "args": [
            "eir->msd_list",
            "g_free"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "eir->randomizer"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "eir->hash"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "eir->name"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_slist_free_full",
          "args": [
            "eir->services",
            "free"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nvoid eir_data_free(struct eir_data *eir)\n{\n\tg_slist_free_full(eir->services, free);\n\teir->services = NULL;\n\tg_free(eir->name);\n\teir->name = NULL;\n\tg_free(eir->hash);\n\teir->hash = NULL;\n\tg_free(eir->randomizer);\n\teir->randomizer = NULL;\n\tg_slist_free_full(eir->msd_list, g_free);\n\teir->msd_list = NULL;\n\tg_slist_free_full(eir->sd_list, sd_free);\n\teir->sd_list = NULL;\n\tg_slist_free_full(eir->data_list, data_free);\n\teir->data_list = NULL;\n}"
  },
  {
    "function_name": "data_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "54-60",
    "snippet": "static void data_free(void *data)\n{\n\tstruct eir_ad *ad = data;\n\n\tg_free(ad->data);\n\tg_free(ad);\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "ad"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "ad->data"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void data_free(void *data)\n{\n\tstruct eir_ad *ad = data;\n\n\tg_free(ad->data);\n\tg_free(ad);\n}"
  },
  {
    "function_name": "sd_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
    "lines": "46-52",
    "snippet": "static void sd_free(void *data)\n{\n\tstruct eir_sd *sd = data;\n\n\tfree(sd->uuid);\n\tg_free(sd);\n}",
    "includes": [
      "#include \"eir.h\"",
      "#include \"uuid-helper.h\"",
      "#include \"src/shared/util.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/hci.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <glib.h>",
      "#include <stdbool.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "sd"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "sd->uuid"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "eir_data_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/eir.c",
          "lines": "62-78",
          "snippet": "void eir_data_free(struct eir_data *eir)\n{\n\tg_slist_free_full(eir->services, free);\n\teir->services = NULL;\n\tg_free(eir->name);\n\teir->name = NULL;\n\tg_free(eir->hash);\n\teir->hash = NULL;\n\tg_free(eir->randomizer);\n\teir->randomizer = NULL;\n\tg_slist_free_full(eir->msd_list, g_free);\n\teir->msd_list = NULL;\n\tg_slist_free_full(eir->sd_list, sd_free);\n\teir->sd_list = NULL;\n\tg_slist_free_full(eir->data_list, data_free);\n\teir->data_list = NULL;\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/hci.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <glib.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nvoid eir_data_free(struct eir_data *eir)\n{\n\tg_slist_free_full(eir->services, free);\n\teir->services = NULL;\n\tg_free(eir->name);\n\teir->name = NULL;\n\tg_free(eir->hash);\n\teir->hash = NULL;\n\tg_free(eir->randomizer);\n\teir->randomizer = NULL;\n\tg_slist_free_full(eir->msd_list, g_free);\n\teir->msd_list = NULL;\n\tg_slist_free_full(eir->sd_list, sd_free);\n\teir->sd_list = NULL;\n\tg_slist_free_full(eir->data_list, data_free);\n\teir->data_list = NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"eir.h\"\n#include \"uuid-helper.h\"\n#include \"src/shared/util.h\"\n#include \"lib/sdp.h\"\n#include \"lib/hci.h\"\n#include \"lib/bluetooth.h\"\n#include <glib.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void sd_free(void *data)\n{\n\tstruct eir_sd *sd = data;\n\n\tfree(sd->uuid);\n\tg_free(sd);\n}"
  }
]