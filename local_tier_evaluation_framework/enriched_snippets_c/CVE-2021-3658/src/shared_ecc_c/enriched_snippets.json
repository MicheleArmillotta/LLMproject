[
  {
    "function_name": "ecdh_shared_secret",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "921-945",
    "snippet": "bool ecdh_shared_secret(const uint8_t public_key[64],\n\t\t\t\tconst uint8_t private_key[32],\n\t\t\t\tuint8_t secret[32])\n{\n\tuint64_t priv[NUM_ECC_DIGITS];\n\tuint64_t rand[NUM_ECC_DIGITS];\n\tstruct ecc_point product, pk;\n\n\tif (!get_random_number(rand))\n\t\treturn false;\n\n\tecc_bytes2native(public_key, pk.x);\n\tecc_bytes2native(&public_key[32], pk.y);\n\n\tif (!ecc_valid_point(&pk))\n\t\treturn false;\n\n\tecc_bytes2native(private_key, priv);\n\n\tecc_point_mult(&product, &pk, priv, rand, vli_num_bits(priv));\n\n\tecc_native2bytes(product.x, secret);\n\n\treturn !ecc_point_is_zero(&product);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ecc_point_is_zero",
          "args": [
            "&product"
          ],
          "line": 944
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_point_is_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "598-601",
          "snippet": "static bool ecc_point_is_zero(const struct ecc_point *point)\n{\n\treturn (vli_is_zero(point->x) && vli_is_zero(point->y));\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic bool ecc_point_is_zero(const struct ecc_point *point)\n{\n\treturn (vli_is_zero(point->x) && vli_is_zero(point->y));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_native2bytes",
          "args": [
            "product.x",
            "secret"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_native2bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "840-857",
          "snippet": "static void ecc_native2bytes(const uint64_t native[NUM_ECC_DIGITS],\n\t\t\t\t\t\tuint8_t bytes[ECC_BYTES])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tdigit[0] = native[NUM_ECC_DIGITS - 1 - i] >> 0;\n\t\tdigit[1] = native[NUM_ECC_DIGITS - 1 - i] >> 8;\n\t\tdigit[2] = native[NUM_ECC_DIGITS - 1 - i] >> 16;\n\t\tdigit[3] = native[NUM_ECC_DIGITS - 1 - i] >> 24;\n\t\tdigit[4] = native[NUM_ECC_DIGITS - 1 - i] >> 32;\n\t\tdigit[5] = native[NUM_ECC_DIGITS - 1 - i] >> 40;\n\t\tdigit[6] = native[NUM_ECC_DIGITS - 1 - i] >> 48;\n\t\tdigit[7] = native[NUM_ECC_DIGITS - 1 - i] >> 56;\n\t}\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)",
            "#define ECC_BYTES 32"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n#define ECC_BYTES 32\n\nstatic void ecc_native2bytes(const uint64_t native[NUM_ECC_DIGITS],\n\t\t\t\t\t\tuint8_t bytes[ECC_BYTES])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tdigit[0] = native[NUM_ECC_DIGITS - 1 - i] >> 0;\n\t\tdigit[1] = native[NUM_ECC_DIGITS - 1 - i] >> 8;\n\t\tdigit[2] = native[NUM_ECC_DIGITS - 1 - i] >> 16;\n\t\tdigit[3] = native[NUM_ECC_DIGITS - 1 - i] >> 24;\n\t\tdigit[4] = native[NUM_ECC_DIGITS - 1 - i] >> 32;\n\t\tdigit[5] = native[NUM_ECC_DIGITS - 1 - i] >> 40;\n\t\tdigit[6] = native[NUM_ECC_DIGITS - 1 - i] >> 48;\n\t\tdigit[7] = native[NUM_ECC_DIGITS - 1 - i] >> 56;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_point_mult",
          "args": [
            "&product",
            "&pk",
            "priv",
            "rand",
            "vli_num_bits(priv)"
          ],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_point_mult",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "748-788",
          "snippet": "static void ecc_point_mult(struct ecc_point *result,\n\t\t\t\tconst struct ecc_point *point,\n\t\t\t\tuint64_t *scalar, uint64_t *initial_z,\n\t\t\t\tint num_bits)\n{\n\t/* R0 and R1 */\n\tuint64_t rx[2][NUM_ECC_DIGITS];\n\tuint64_t ry[2][NUM_ECC_DIGITS];\n\tuint64_t z[NUM_ECC_DIGITS];\n\tint i, nb;\n\n\tvli_set(rx[1], point->x);\n\tvli_set(ry[1], point->y);\n\n\txycz_initial_double(rx[1], ry[1], rx[0], ry[0], initial_z);\n\n\tfor (i = num_bits - 2; i > 0; i--) {\n\t\tnb = !vli_test_bit(scalar, i);\n\t\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\t\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\t}\n\n\tnb = !vli_test_bit(scalar, 0);\n\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\n\t/* Find final 1/Z value. */\n\tvli_mod_sub(z, rx[1], rx[0], curve_p); /* X1 - X0 */\n\tvli_mod_mult_fast(z, z, ry[1 - nb]); /* Yb * (X1 - X0) */\n\tvli_mod_mult_fast(z, z, point->x);   /* xP * Yb * (X1 - X0) */\n\tvli_mod_inv(z, z, curve_p);          /* 1 / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, point->y);   /* yP / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, rx[1 - nb]); /* Xb * yP / (xP * Yb * (X1 - X0)) */\n\t/* End 1/Z calculation */\n\n\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\n\tapply_z(rx[0], ry[0], z);\n\n\tvli_set(result->x, rx[0]);\n\tvli_set(result->y, ry[0]);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [
            "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void ecc_point_mult(struct ecc_point *result,\n\t\t\t\tconst struct ecc_point *point,\n\t\t\t\tuint64_t *scalar, uint64_t *initial_z,\n\t\t\t\tint num_bits)\n{\n\t/* R0 and R1 */\n\tuint64_t rx[2][NUM_ECC_DIGITS];\n\tuint64_t ry[2][NUM_ECC_DIGITS];\n\tuint64_t z[NUM_ECC_DIGITS];\n\tint i, nb;\n\n\tvli_set(rx[1], point->x);\n\tvli_set(ry[1], point->y);\n\n\txycz_initial_double(rx[1], ry[1], rx[0], ry[0], initial_z);\n\n\tfor (i = num_bits - 2; i > 0; i--) {\n\t\tnb = !vli_test_bit(scalar, i);\n\t\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\t\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\t}\n\n\tnb = !vli_test_bit(scalar, 0);\n\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\n\t/* Find final 1/Z value. */\n\tvli_mod_sub(z, rx[1], rx[0], curve_p); /* X1 - X0 */\n\tvli_mod_mult_fast(z, z, ry[1 - nb]); /* Yb * (X1 - X0) */\n\tvli_mod_mult_fast(z, z, point->x);   /* xP * Yb * (X1 - X0) */\n\tvli_mod_inv(z, z, curve_p);          /* 1 / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, point->y);   /* yP / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, rx[1 - nb]); /* Xb * yP / (xP * Yb * (X1 - X0)) */\n\t/* End 1/Z calculation */\n\n\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\n\tapply_z(rx[0], ry[0], z);\n\n\tvli_set(result->x, rx[0]);\n\tvli_set(result->y, ry[0]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_num_bits",
          "args": [
            "priv"
          ],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "vli_num_bits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "150-164",
          "snippet": "static unsigned int vli_num_bits(const uint64_t *vli)\n{\n\tunsigned int i, num_digits;\n\tuint64_t digit;\n\n\tnum_digits = vli_num_digits(vli);\n\tif (num_digits == 0)\n\t\treturn 0;\n\n\tdigit = vli[num_digits - 1];\n\tfor (i = 0; digit; i++)\n\t\tdigit >>= 1;\n\n\treturn ((num_digits - 1) * 64 + i);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic unsigned int vli_num_bits(const uint64_t *vli)\n{\n\tunsigned int i, num_digits;\n\tuint64_t digit;\n\n\tnum_digits = vli_num_digits(vli);\n\tif (num_digits == 0)\n\t\treturn 0;\n\n\tdigit = vli[num_digits - 1];\n\tfor (i = 0; digit; i++)\n\t\tdigit >>= 1;\n\n\treturn ((num_digits - 1) * 64 + i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_bytes2native",
          "args": [
            "private_key",
            "priv"
          ],
          "line": 938
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_bytes2native",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "819-837",
          "snippet": "static void ecc_bytes2native(const uint8_t bytes[ECC_BYTES],\n\t\t\t\t\t\tuint64_t native[NUM_ECC_DIGITS])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tconst uint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tnative[NUM_ECC_DIGITS - 1 - i] =\n\t\t\t\t\t((uint64_t) digit[0] << 0) |\n\t\t\t\t\t((uint64_t) digit[1] << 8) |\n\t\t\t\t\t((uint64_t) digit[2] << 16) |\n\t\t\t\t\t((uint64_t) digit[3] << 24) |\n\t\t\t\t\t((uint64_t) digit[4] << 32) |\n\t\t\t\t\t((uint64_t) digit[5] << 40) |\n\t\t\t\t\t((uint64_t) digit[6] << 48) |\n\t\t\t\t\t((uint64_t) digit[7] << 56);\n\t}\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)",
            "#define ECC_BYTES 32"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n#define ECC_BYTES 32\n\nstatic void ecc_bytes2native(const uint8_t bytes[ECC_BYTES],\n\t\t\t\t\t\tuint64_t native[NUM_ECC_DIGITS])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tconst uint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tnative[NUM_ECC_DIGITS - 1 - i] =\n\t\t\t\t\t((uint64_t) digit[0] << 0) |\n\t\t\t\t\t((uint64_t) digit[1] << 8) |\n\t\t\t\t\t((uint64_t) digit[2] << 16) |\n\t\t\t\t\t((uint64_t) digit[3] << 24) |\n\t\t\t\t\t((uint64_t) digit[4] << 32) |\n\t\t\t\t\t((uint64_t) digit[5] << 40) |\n\t\t\t\t\t((uint64_t) digit[6] << 48) |\n\t\t\t\t\t((uint64_t) digit[7] << 56);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_valid_point",
          "args": [
            "&pk"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_valid_point",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "790-816",
          "snippet": "static bool ecc_valid_point(const struct ecc_point *point)\n{\n\tuint64_t tmp1[NUM_ECC_DIGITS];\n\tuint64_t tmp2[NUM_ECC_DIGITS];\n\tuint64_t _3[NUM_ECC_DIGITS] = { 3 };\t/* -a = 3 */\n\n\t/* The point at infinity is invalid. */\n\tif (ecc_point_is_zero(point))\n\t\treturn false;\n\n\t/* x and y must be smaller than p. */\n\tif (vli_cmp(curve_p, point->x) != 1 ||\n\t\t\tvli_cmp(curve_p, point->y) != 1)\n\t\treturn false;\n\n\t/* Computes result = y^2. */\n\tvli_mod_square_fast(tmp1, point->y);\n\n\t/* Computes result = x^3 + ax + b. result must not overlap x. */\n\tvli_mod_square_fast(tmp2, point->x);\t\t/* r = x^2 */\n\tvli_mod_sub(tmp2, tmp2, _3, curve_p);\t\t/* r = x^2 - 3 */\n\tvli_mod_mult_fast(tmp2, tmp2, point->x);\t/* r = x^3 - 3x */\n\tvli_mod_add(tmp2, tmp2, curve_b, curve_p);\t/* r = x^3 - 3x + b */\n\n\t/* Make sure that y^2 == x^3 + ax + b */\n\treturn vli_equal(tmp1, tmp2);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [
            "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;",
            "static uint64_t curve_b[NUM_ECC_DIGITS] = CURVE_B_32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\nstatic uint64_t curve_b[NUM_ECC_DIGITS] = CURVE_B_32;\n\nstatic bool ecc_valid_point(const struct ecc_point *point)\n{\n\tuint64_t tmp1[NUM_ECC_DIGITS];\n\tuint64_t tmp2[NUM_ECC_DIGITS];\n\tuint64_t _3[NUM_ECC_DIGITS] = { 3 };\t/* -a = 3 */\n\n\t/* The point at infinity is invalid. */\n\tif (ecc_point_is_zero(point))\n\t\treturn false;\n\n\t/* x and y must be smaller than p. */\n\tif (vli_cmp(curve_p, point->x) != 1 ||\n\t\t\tvli_cmp(curve_p, point->y) != 1)\n\t\treturn false;\n\n\t/* Computes result = y^2. */\n\tvli_mod_square_fast(tmp1, point->y);\n\n\t/* Computes result = x^3 + ax + b. result must not overlap x. */\n\tvli_mod_square_fast(tmp2, point->x);\t\t/* r = x^2 */\n\tvli_mod_sub(tmp2, tmp2, _3, curve_p);\t\t/* r = x^2 - 3 */\n\tvli_mod_mult_fast(tmp2, tmp2, point->x);\t/* r = x^3 - 3x */\n\tvli_mod_add(tmp2, tmp2, curve_b, curve_p);\t/* r = x^3 - 3x + b */\n\n\t/* Make sure that y^2 == x^3 + ax + b */\n\treturn vli_equal(tmp1, tmp2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_random_number",
          "args": [
            "rand"
          ],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "get_random_number",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "77-106",
          "snippet": "static bool get_random_number(uint64_t *vli)\n{\n\tchar *ptr = (char *) vli;\n\tsize_t left = ECC_BYTES;\n\tint fd;\n\n\tfd = open(\"/dev/urandom\", O_RDONLY | O_CLOEXEC);\n\tif (fd < 0) {\n\t\tfd = open(\"/dev/random\", O_RDONLY | O_CLOEXEC);\n\t\tif (fd < 0)\n\t\t\treturn false;\n\t}\n\n\twhile (left > 0) {\n\t\tssize_t ret;\n\n\t\tret = read(fd, ptr, left);\n\t\tif (ret <= 0) {\n\t\t\tclose(fd);\n\t\t\treturn false;\n\t\t}\n\n\t\tleft -= ret;\n\t\tptr += ret;\n\t}\n\n\tclose(fd);\n\n\treturn true;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define ECC_BYTES 32"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define ECC_BYTES 32\n\nstatic bool get_random_number(uint64_t *vli)\n{\n\tchar *ptr = (char *) vli;\n\tsize_t left = ECC_BYTES;\n\tint fd;\n\n\tfd = open(\"/dev/urandom\", O_RDONLY | O_CLOEXEC);\n\tif (fd < 0) {\n\t\tfd = open(\"/dev/random\", O_RDONLY | O_CLOEXEC);\n\t\tif (fd < 0)\n\t\t\treturn false;\n\t}\n\n\twhile (left > 0) {\n\t\tssize_t ret;\n\n\t\tret = read(fd, ptr, left);\n\t\tif (ret <= 0) {\n\t\t\tclose(fd);\n\t\t\treturn false;\n\t\t}\n\n\t\tleft -= ret;\n\t\tptr += ret;\n\t}\n\n\tclose(fd);\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nbool ecdh_shared_secret(const uint8_t public_key[64],\n\t\t\t\tconst uint8_t private_key[32],\n\t\t\t\tuint8_t secret[32])\n{\n\tuint64_t priv[NUM_ECC_DIGITS];\n\tuint64_t rand[NUM_ECC_DIGITS];\n\tstruct ecc_point product, pk;\n\n\tif (!get_random_number(rand))\n\t\treturn false;\n\n\tecc_bytes2native(public_key, pk.x);\n\tecc_bytes2native(&public_key[32], pk.y);\n\n\tif (!ecc_valid_point(&pk))\n\t\treturn false;\n\n\tecc_bytes2native(private_key, priv);\n\n\tecc_point_mult(&product, &pk, priv, rand, vli_num_bits(priv));\n\n\tecc_native2bytes(product.x, secret);\n\n\treturn !ecc_point_is_zero(&product);\n}"
  },
  {
    "function_name": "ecc_valid_public_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "911-919",
    "snippet": "bool ecc_valid_public_key(const uint8_t public_key[64])\n{\n\tstruct ecc_point pk;\n\n\tecc_bytes2native(public_key, pk.x);\n\tecc_bytes2native(&public_key[32], pk.y);\n\n\treturn ecc_valid_point(&pk);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ecc_valid_point",
          "args": [
            "&pk"
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_valid_point",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "790-816",
          "snippet": "static bool ecc_valid_point(const struct ecc_point *point)\n{\n\tuint64_t tmp1[NUM_ECC_DIGITS];\n\tuint64_t tmp2[NUM_ECC_DIGITS];\n\tuint64_t _3[NUM_ECC_DIGITS] = { 3 };\t/* -a = 3 */\n\n\t/* The point at infinity is invalid. */\n\tif (ecc_point_is_zero(point))\n\t\treturn false;\n\n\t/* x and y must be smaller than p. */\n\tif (vli_cmp(curve_p, point->x) != 1 ||\n\t\t\tvli_cmp(curve_p, point->y) != 1)\n\t\treturn false;\n\n\t/* Computes result = y^2. */\n\tvli_mod_square_fast(tmp1, point->y);\n\n\t/* Computes result = x^3 + ax + b. result must not overlap x. */\n\tvli_mod_square_fast(tmp2, point->x);\t\t/* r = x^2 */\n\tvli_mod_sub(tmp2, tmp2, _3, curve_p);\t\t/* r = x^2 - 3 */\n\tvli_mod_mult_fast(tmp2, tmp2, point->x);\t/* r = x^3 - 3x */\n\tvli_mod_add(tmp2, tmp2, curve_b, curve_p);\t/* r = x^3 - 3x + b */\n\n\t/* Make sure that y^2 == x^3 + ax + b */\n\treturn vli_equal(tmp1, tmp2);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [
            "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;",
            "static uint64_t curve_b[NUM_ECC_DIGITS] = CURVE_B_32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\nstatic uint64_t curve_b[NUM_ECC_DIGITS] = CURVE_B_32;\n\nstatic bool ecc_valid_point(const struct ecc_point *point)\n{\n\tuint64_t tmp1[NUM_ECC_DIGITS];\n\tuint64_t tmp2[NUM_ECC_DIGITS];\n\tuint64_t _3[NUM_ECC_DIGITS] = { 3 };\t/* -a = 3 */\n\n\t/* The point at infinity is invalid. */\n\tif (ecc_point_is_zero(point))\n\t\treturn false;\n\n\t/* x and y must be smaller than p. */\n\tif (vli_cmp(curve_p, point->x) != 1 ||\n\t\t\tvli_cmp(curve_p, point->y) != 1)\n\t\treturn false;\n\n\t/* Computes result = y^2. */\n\tvli_mod_square_fast(tmp1, point->y);\n\n\t/* Computes result = x^3 + ax + b. result must not overlap x. */\n\tvli_mod_square_fast(tmp2, point->x);\t\t/* r = x^2 */\n\tvli_mod_sub(tmp2, tmp2, _3, curve_p);\t\t/* r = x^2 - 3 */\n\tvli_mod_mult_fast(tmp2, tmp2, point->x);\t/* r = x^3 - 3x */\n\tvli_mod_add(tmp2, tmp2, curve_b, curve_p);\t/* r = x^3 - 3x + b */\n\n\t/* Make sure that y^2 == x^3 + ax + b */\n\treturn vli_equal(tmp1, tmp2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_bytes2native",
          "args": [
            "&public_key[32]",
            "pk.y"
          ],
          "line": 916
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_bytes2native",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "819-837",
          "snippet": "static void ecc_bytes2native(const uint8_t bytes[ECC_BYTES],\n\t\t\t\t\t\tuint64_t native[NUM_ECC_DIGITS])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tconst uint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tnative[NUM_ECC_DIGITS - 1 - i] =\n\t\t\t\t\t((uint64_t) digit[0] << 0) |\n\t\t\t\t\t((uint64_t) digit[1] << 8) |\n\t\t\t\t\t((uint64_t) digit[2] << 16) |\n\t\t\t\t\t((uint64_t) digit[3] << 24) |\n\t\t\t\t\t((uint64_t) digit[4] << 32) |\n\t\t\t\t\t((uint64_t) digit[5] << 40) |\n\t\t\t\t\t((uint64_t) digit[6] << 48) |\n\t\t\t\t\t((uint64_t) digit[7] << 56);\n\t}\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)",
            "#define ECC_BYTES 32"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n#define ECC_BYTES 32\n\nstatic void ecc_bytes2native(const uint8_t bytes[ECC_BYTES],\n\t\t\t\t\t\tuint64_t native[NUM_ECC_DIGITS])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tconst uint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tnative[NUM_ECC_DIGITS - 1 - i] =\n\t\t\t\t\t((uint64_t) digit[0] << 0) |\n\t\t\t\t\t((uint64_t) digit[1] << 8) |\n\t\t\t\t\t((uint64_t) digit[2] << 16) |\n\t\t\t\t\t((uint64_t) digit[3] << 24) |\n\t\t\t\t\t((uint64_t) digit[4] << 32) |\n\t\t\t\t\t((uint64_t) digit[5] << 40) |\n\t\t\t\t\t((uint64_t) digit[6] << 48) |\n\t\t\t\t\t((uint64_t) digit[7] << 56);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool ecc_valid_public_key(const uint8_t public_key[64])\n{\n\tstruct ecc_point pk;\n\n\tecc_bytes2native(public_key, pk.x);\n\tecc_bytes2native(&public_key[32], pk.y);\n\n\treturn ecc_valid_point(&pk);\n}"
  },
  {
    "function_name": "ecc_make_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "884-909",
    "snippet": "bool ecc_make_key(uint8_t public_key[64], uint8_t private_key[32])\n{\n\tstruct ecc_point pk;\n\tuint64_t priv[NUM_ECC_DIGITS];\n\tunsigned int tries = 0;\n\n\tdo {\n\t\tif (!get_random_number(priv) || (tries++ >= MAX_TRIES))\n\t\t\treturn false;\n\n\t\tif (vli_is_zero(priv))\n\t\t\tcontinue;\n\n\t\t/* Make sure the private key is in the range [1, n-1]. */\n\t\tif (vli_cmp(curve_n, priv) != 1)\n\t\t\tcontinue;\n\n\t\tecc_point_mult(&pk, &curve_g, priv, NULL, vli_num_bits(priv));\n\t} while (ecc_point_is_zero(&pk));\n\n\tecc_native2bytes(priv, private_key);\n\tecc_native2bytes(pk.x, public_key);\n\tecc_native2bytes(pk.y, &public_key[32]);\n\n\treturn true;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define MAX_TRIES 16",
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [
      "static struct ecc_point curve_g = CURVE_G_32;",
      "static uint64_t curve_n[NUM_ECC_DIGITS] = CURVE_N_32;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ecc_native2bytes",
          "args": [
            "pk.y",
            "&public_key[32]"
          ],
          "line": 906
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_native2bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "840-857",
          "snippet": "static void ecc_native2bytes(const uint64_t native[NUM_ECC_DIGITS],\n\t\t\t\t\t\tuint8_t bytes[ECC_BYTES])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tdigit[0] = native[NUM_ECC_DIGITS - 1 - i] >> 0;\n\t\tdigit[1] = native[NUM_ECC_DIGITS - 1 - i] >> 8;\n\t\tdigit[2] = native[NUM_ECC_DIGITS - 1 - i] >> 16;\n\t\tdigit[3] = native[NUM_ECC_DIGITS - 1 - i] >> 24;\n\t\tdigit[4] = native[NUM_ECC_DIGITS - 1 - i] >> 32;\n\t\tdigit[5] = native[NUM_ECC_DIGITS - 1 - i] >> 40;\n\t\tdigit[6] = native[NUM_ECC_DIGITS - 1 - i] >> 48;\n\t\tdigit[7] = native[NUM_ECC_DIGITS - 1 - i] >> 56;\n\t}\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)",
            "#define ECC_BYTES 32"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n#define ECC_BYTES 32\n\nstatic void ecc_native2bytes(const uint64_t native[NUM_ECC_DIGITS],\n\t\t\t\t\t\tuint8_t bytes[ECC_BYTES])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tdigit[0] = native[NUM_ECC_DIGITS - 1 - i] >> 0;\n\t\tdigit[1] = native[NUM_ECC_DIGITS - 1 - i] >> 8;\n\t\tdigit[2] = native[NUM_ECC_DIGITS - 1 - i] >> 16;\n\t\tdigit[3] = native[NUM_ECC_DIGITS - 1 - i] >> 24;\n\t\tdigit[4] = native[NUM_ECC_DIGITS - 1 - i] >> 32;\n\t\tdigit[5] = native[NUM_ECC_DIGITS - 1 - i] >> 40;\n\t\tdigit[6] = native[NUM_ECC_DIGITS - 1 - i] >> 48;\n\t\tdigit[7] = native[NUM_ECC_DIGITS - 1 - i] >> 56;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_point_is_zero",
          "args": [
            "&pk"
          ],
          "line": 902
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_point_is_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "598-601",
          "snippet": "static bool ecc_point_is_zero(const struct ecc_point *point)\n{\n\treturn (vli_is_zero(point->x) && vli_is_zero(point->y));\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic bool ecc_point_is_zero(const struct ecc_point *point)\n{\n\treturn (vli_is_zero(point->x) && vli_is_zero(point->y));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_point_mult",
          "args": [
            "&pk",
            "&curve_g",
            "priv",
            "NULL",
            "vli_num_bits(priv)"
          ],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_point_mult",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "748-788",
          "snippet": "static void ecc_point_mult(struct ecc_point *result,\n\t\t\t\tconst struct ecc_point *point,\n\t\t\t\tuint64_t *scalar, uint64_t *initial_z,\n\t\t\t\tint num_bits)\n{\n\t/* R0 and R1 */\n\tuint64_t rx[2][NUM_ECC_DIGITS];\n\tuint64_t ry[2][NUM_ECC_DIGITS];\n\tuint64_t z[NUM_ECC_DIGITS];\n\tint i, nb;\n\n\tvli_set(rx[1], point->x);\n\tvli_set(ry[1], point->y);\n\n\txycz_initial_double(rx[1], ry[1], rx[0], ry[0], initial_z);\n\n\tfor (i = num_bits - 2; i > 0; i--) {\n\t\tnb = !vli_test_bit(scalar, i);\n\t\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\t\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\t}\n\n\tnb = !vli_test_bit(scalar, 0);\n\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\n\t/* Find final 1/Z value. */\n\tvli_mod_sub(z, rx[1], rx[0], curve_p); /* X1 - X0 */\n\tvli_mod_mult_fast(z, z, ry[1 - nb]); /* Yb * (X1 - X0) */\n\tvli_mod_mult_fast(z, z, point->x);   /* xP * Yb * (X1 - X0) */\n\tvli_mod_inv(z, z, curve_p);          /* 1 / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, point->y);   /* yP / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, rx[1 - nb]); /* Xb * yP / (xP * Yb * (X1 - X0)) */\n\t/* End 1/Z calculation */\n\n\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\n\tapply_z(rx[0], ry[0], z);\n\n\tvli_set(result->x, rx[0]);\n\tvli_set(result->y, ry[0]);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [
            "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void ecc_point_mult(struct ecc_point *result,\n\t\t\t\tconst struct ecc_point *point,\n\t\t\t\tuint64_t *scalar, uint64_t *initial_z,\n\t\t\t\tint num_bits)\n{\n\t/* R0 and R1 */\n\tuint64_t rx[2][NUM_ECC_DIGITS];\n\tuint64_t ry[2][NUM_ECC_DIGITS];\n\tuint64_t z[NUM_ECC_DIGITS];\n\tint i, nb;\n\n\tvli_set(rx[1], point->x);\n\tvli_set(ry[1], point->y);\n\n\txycz_initial_double(rx[1], ry[1], rx[0], ry[0], initial_z);\n\n\tfor (i = num_bits - 2; i > 0; i--) {\n\t\tnb = !vli_test_bit(scalar, i);\n\t\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\t\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\t}\n\n\tnb = !vli_test_bit(scalar, 0);\n\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\n\t/* Find final 1/Z value. */\n\tvli_mod_sub(z, rx[1], rx[0], curve_p); /* X1 - X0 */\n\tvli_mod_mult_fast(z, z, ry[1 - nb]); /* Yb * (X1 - X0) */\n\tvli_mod_mult_fast(z, z, point->x);   /* xP * Yb * (X1 - X0) */\n\tvli_mod_inv(z, z, curve_p);          /* 1 / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, point->y);   /* yP / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, rx[1 - nb]); /* Xb * yP / (xP * Yb * (X1 - X0)) */\n\t/* End 1/Z calculation */\n\n\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\n\tapply_z(rx[0], ry[0], z);\n\n\tvli_set(result->x, rx[0]);\n\tvli_set(result->y, ry[0]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_num_bits",
          "args": [
            "priv"
          ],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "vli_num_bits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "150-164",
          "snippet": "static unsigned int vli_num_bits(const uint64_t *vli)\n{\n\tunsigned int i, num_digits;\n\tuint64_t digit;\n\n\tnum_digits = vli_num_digits(vli);\n\tif (num_digits == 0)\n\t\treturn 0;\n\n\tdigit = vli[num_digits - 1];\n\tfor (i = 0; digit; i++)\n\t\tdigit >>= 1;\n\n\treturn ((num_digits - 1) * 64 + i);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic unsigned int vli_num_bits(const uint64_t *vli)\n{\n\tunsigned int i, num_digits;\n\tuint64_t digit;\n\n\tnum_digits = vli_num_digits(vli);\n\tif (num_digits == 0)\n\t\treturn 0;\n\n\tdigit = vli[num_digits - 1];\n\tfor (i = 0; digit; i++)\n\t\tdigit >>= 1;\n\n\treturn ((num_digits - 1) * 64 + i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_cmp",
          "args": [
            "curve_n",
            "priv"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "vli_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "176-188",
          "snippet": "static int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_is_zero",
          "args": [
            "priv"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "vli_is_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "117-127",
          "snippet": "static bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_random_number",
          "args": [
            "priv"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "get_random_number",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "77-106",
          "snippet": "static bool get_random_number(uint64_t *vli)\n{\n\tchar *ptr = (char *) vli;\n\tsize_t left = ECC_BYTES;\n\tint fd;\n\n\tfd = open(\"/dev/urandom\", O_RDONLY | O_CLOEXEC);\n\tif (fd < 0) {\n\t\tfd = open(\"/dev/random\", O_RDONLY | O_CLOEXEC);\n\t\tif (fd < 0)\n\t\t\treturn false;\n\t}\n\n\twhile (left > 0) {\n\t\tssize_t ret;\n\n\t\tret = read(fd, ptr, left);\n\t\tif (ret <= 0) {\n\t\t\tclose(fd);\n\t\t\treturn false;\n\t\t}\n\n\t\tleft -= ret;\n\t\tptr += ret;\n\t}\n\n\tclose(fd);\n\n\treturn true;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define ECC_BYTES 32"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define ECC_BYTES 32\n\nstatic bool get_random_number(uint64_t *vli)\n{\n\tchar *ptr = (char *) vli;\n\tsize_t left = ECC_BYTES;\n\tint fd;\n\n\tfd = open(\"/dev/urandom\", O_RDONLY | O_CLOEXEC);\n\tif (fd < 0) {\n\t\tfd = open(\"/dev/random\", O_RDONLY | O_CLOEXEC);\n\t\tif (fd < 0)\n\t\t\treturn false;\n\t}\n\n\twhile (left > 0) {\n\t\tssize_t ret;\n\n\t\tret = read(fd, ptr, left);\n\t\tif (ret <= 0) {\n\t\t\tclose(fd);\n\t\t\treturn false;\n\t\t}\n\n\t\tleft -= ret;\n\t\tptr += ret;\n\t}\n\n\tclose(fd);\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define MAX_TRIES 16\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic struct ecc_point curve_g = CURVE_G_32;\nstatic uint64_t curve_n[NUM_ECC_DIGITS] = CURVE_N_32;\n\nbool ecc_make_key(uint8_t public_key[64], uint8_t private_key[32])\n{\n\tstruct ecc_point pk;\n\tuint64_t priv[NUM_ECC_DIGITS];\n\tunsigned int tries = 0;\n\n\tdo {\n\t\tif (!get_random_number(priv) || (tries++ >= MAX_TRIES))\n\t\t\treturn false;\n\n\t\tif (vli_is_zero(priv))\n\t\t\tcontinue;\n\n\t\t/* Make sure the private key is in the range [1, n-1]. */\n\t\tif (vli_cmp(curve_n, priv) != 1)\n\t\t\tcontinue;\n\n\t\tecc_point_mult(&pk, &curve_g, priv, NULL, vli_num_bits(priv));\n\t} while (ecc_point_is_zero(&pk));\n\n\tecc_native2bytes(priv, private_key);\n\tecc_native2bytes(pk.x, public_key);\n\tecc_native2bytes(pk.y, &public_key[32]);\n\n\treturn true;\n}"
  },
  {
    "function_name": "ecc_make_public_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "859-882",
    "snippet": "bool ecc_make_public_key(const uint8_t private_key[32], uint8_t public_key[64])\n{\n\tstruct ecc_point pk;\n\tuint64_t priv[NUM_ECC_DIGITS];\n\n\tecc_bytes2native(private_key, priv);\n\n\tif (vli_is_zero(priv))\n\t\treturn false;\n\n\t/* Make sure the private key is in the range [1, n-1]. */\n\tif (vli_cmp(curve_n, priv) != 1)\n\t\treturn false;\n\n\tecc_point_mult(&pk, &curve_g, priv, NULL, vli_num_bits(priv));\n\n\tif (ecc_point_is_zero(&pk))\n\t\treturn false;\n\n\tecc_native2bytes(pk.x, public_key);\n\tecc_native2bytes(pk.y, &public_key[32]);\n\n\treturn true;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [
      "static struct ecc_point curve_g = CURVE_G_32;",
      "static uint64_t curve_n[NUM_ECC_DIGITS] = CURVE_N_32;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ecc_native2bytes",
          "args": [
            "pk.y",
            "&public_key[32]"
          ],
          "line": 879
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_native2bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "840-857",
          "snippet": "static void ecc_native2bytes(const uint64_t native[NUM_ECC_DIGITS],\n\t\t\t\t\t\tuint8_t bytes[ECC_BYTES])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tdigit[0] = native[NUM_ECC_DIGITS - 1 - i] >> 0;\n\t\tdigit[1] = native[NUM_ECC_DIGITS - 1 - i] >> 8;\n\t\tdigit[2] = native[NUM_ECC_DIGITS - 1 - i] >> 16;\n\t\tdigit[3] = native[NUM_ECC_DIGITS - 1 - i] >> 24;\n\t\tdigit[4] = native[NUM_ECC_DIGITS - 1 - i] >> 32;\n\t\tdigit[5] = native[NUM_ECC_DIGITS - 1 - i] >> 40;\n\t\tdigit[6] = native[NUM_ECC_DIGITS - 1 - i] >> 48;\n\t\tdigit[7] = native[NUM_ECC_DIGITS - 1 - i] >> 56;\n\t}\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)",
            "#define ECC_BYTES 32"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n#define ECC_BYTES 32\n\nstatic void ecc_native2bytes(const uint64_t native[NUM_ECC_DIGITS],\n\t\t\t\t\t\tuint8_t bytes[ECC_BYTES])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tdigit[0] = native[NUM_ECC_DIGITS - 1 - i] >> 0;\n\t\tdigit[1] = native[NUM_ECC_DIGITS - 1 - i] >> 8;\n\t\tdigit[2] = native[NUM_ECC_DIGITS - 1 - i] >> 16;\n\t\tdigit[3] = native[NUM_ECC_DIGITS - 1 - i] >> 24;\n\t\tdigit[4] = native[NUM_ECC_DIGITS - 1 - i] >> 32;\n\t\tdigit[5] = native[NUM_ECC_DIGITS - 1 - i] >> 40;\n\t\tdigit[6] = native[NUM_ECC_DIGITS - 1 - i] >> 48;\n\t\tdigit[7] = native[NUM_ECC_DIGITS - 1 - i] >> 56;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_point_is_zero",
          "args": [
            "&pk"
          ],
          "line": 875
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_point_is_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "598-601",
          "snippet": "static bool ecc_point_is_zero(const struct ecc_point *point)\n{\n\treturn (vli_is_zero(point->x) && vli_is_zero(point->y));\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic bool ecc_point_is_zero(const struct ecc_point *point)\n{\n\treturn (vli_is_zero(point->x) && vli_is_zero(point->y));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_point_mult",
          "args": [
            "&pk",
            "&curve_g",
            "priv",
            "NULL",
            "vli_num_bits(priv)"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_point_mult",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "748-788",
          "snippet": "static void ecc_point_mult(struct ecc_point *result,\n\t\t\t\tconst struct ecc_point *point,\n\t\t\t\tuint64_t *scalar, uint64_t *initial_z,\n\t\t\t\tint num_bits)\n{\n\t/* R0 and R1 */\n\tuint64_t rx[2][NUM_ECC_DIGITS];\n\tuint64_t ry[2][NUM_ECC_DIGITS];\n\tuint64_t z[NUM_ECC_DIGITS];\n\tint i, nb;\n\n\tvli_set(rx[1], point->x);\n\tvli_set(ry[1], point->y);\n\n\txycz_initial_double(rx[1], ry[1], rx[0], ry[0], initial_z);\n\n\tfor (i = num_bits - 2; i > 0; i--) {\n\t\tnb = !vli_test_bit(scalar, i);\n\t\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\t\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\t}\n\n\tnb = !vli_test_bit(scalar, 0);\n\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\n\t/* Find final 1/Z value. */\n\tvli_mod_sub(z, rx[1], rx[0], curve_p); /* X1 - X0 */\n\tvli_mod_mult_fast(z, z, ry[1 - nb]); /* Yb * (X1 - X0) */\n\tvli_mod_mult_fast(z, z, point->x);   /* xP * Yb * (X1 - X0) */\n\tvli_mod_inv(z, z, curve_p);          /* 1 / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, point->y);   /* yP / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, rx[1 - nb]); /* Xb * yP / (xP * Yb * (X1 - X0)) */\n\t/* End 1/Z calculation */\n\n\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\n\tapply_z(rx[0], ry[0], z);\n\n\tvli_set(result->x, rx[0]);\n\tvli_set(result->y, ry[0]);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [
            "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void ecc_point_mult(struct ecc_point *result,\n\t\t\t\tconst struct ecc_point *point,\n\t\t\t\tuint64_t *scalar, uint64_t *initial_z,\n\t\t\t\tint num_bits)\n{\n\t/* R0 and R1 */\n\tuint64_t rx[2][NUM_ECC_DIGITS];\n\tuint64_t ry[2][NUM_ECC_DIGITS];\n\tuint64_t z[NUM_ECC_DIGITS];\n\tint i, nb;\n\n\tvli_set(rx[1], point->x);\n\tvli_set(ry[1], point->y);\n\n\txycz_initial_double(rx[1], ry[1], rx[0], ry[0], initial_z);\n\n\tfor (i = num_bits - 2; i > 0; i--) {\n\t\tnb = !vli_test_bit(scalar, i);\n\t\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\t\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\t}\n\n\tnb = !vli_test_bit(scalar, 0);\n\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\n\t/* Find final 1/Z value. */\n\tvli_mod_sub(z, rx[1], rx[0], curve_p); /* X1 - X0 */\n\tvli_mod_mult_fast(z, z, ry[1 - nb]); /* Yb * (X1 - X0) */\n\tvli_mod_mult_fast(z, z, point->x);   /* xP * Yb * (X1 - X0) */\n\tvli_mod_inv(z, z, curve_p);          /* 1 / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, point->y);   /* yP / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, rx[1 - nb]); /* Xb * yP / (xP * Yb * (X1 - X0)) */\n\t/* End 1/Z calculation */\n\n\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\n\tapply_z(rx[0], ry[0], z);\n\n\tvli_set(result->x, rx[0]);\n\tvli_set(result->y, ry[0]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_num_bits",
          "args": [
            "priv"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "vli_num_bits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "150-164",
          "snippet": "static unsigned int vli_num_bits(const uint64_t *vli)\n{\n\tunsigned int i, num_digits;\n\tuint64_t digit;\n\n\tnum_digits = vli_num_digits(vli);\n\tif (num_digits == 0)\n\t\treturn 0;\n\n\tdigit = vli[num_digits - 1];\n\tfor (i = 0; digit; i++)\n\t\tdigit >>= 1;\n\n\treturn ((num_digits - 1) * 64 + i);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic unsigned int vli_num_bits(const uint64_t *vli)\n{\n\tunsigned int i, num_digits;\n\tuint64_t digit;\n\n\tnum_digits = vli_num_digits(vli);\n\tif (num_digits == 0)\n\t\treturn 0;\n\n\tdigit = vli[num_digits - 1];\n\tfor (i = 0; digit; i++)\n\t\tdigit >>= 1;\n\n\treturn ((num_digits - 1) * 64 + i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_cmp",
          "args": [
            "curve_n",
            "priv"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "vli_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "176-188",
          "snippet": "static int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_is_zero",
          "args": [
            "priv"
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "vli_is_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "117-127",
          "snippet": "static bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_bytes2native",
          "args": [
            "private_key",
            "priv"
          ],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_bytes2native",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "819-837",
          "snippet": "static void ecc_bytes2native(const uint8_t bytes[ECC_BYTES],\n\t\t\t\t\t\tuint64_t native[NUM_ECC_DIGITS])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tconst uint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tnative[NUM_ECC_DIGITS - 1 - i] =\n\t\t\t\t\t((uint64_t) digit[0] << 0) |\n\t\t\t\t\t((uint64_t) digit[1] << 8) |\n\t\t\t\t\t((uint64_t) digit[2] << 16) |\n\t\t\t\t\t((uint64_t) digit[3] << 24) |\n\t\t\t\t\t((uint64_t) digit[4] << 32) |\n\t\t\t\t\t((uint64_t) digit[5] << 40) |\n\t\t\t\t\t((uint64_t) digit[6] << 48) |\n\t\t\t\t\t((uint64_t) digit[7] << 56);\n\t}\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)",
            "#define ECC_BYTES 32"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n#define ECC_BYTES 32\n\nstatic void ecc_bytes2native(const uint8_t bytes[ECC_BYTES],\n\t\t\t\t\t\tuint64_t native[NUM_ECC_DIGITS])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tconst uint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tnative[NUM_ECC_DIGITS - 1 - i] =\n\t\t\t\t\t((uint64_t) digit[0] << 0) |\n\t\t\t\t\t((uint64_t) digit[1] << 8) |\n\t\t\t\t\t((uint64_t) digit[2] << 16) |\n\t\t\t\t\t((uint64_t) digit[3] << 24) |\n\t\t\t\t\t((uint64_t) digit[4] << 32) |\n\t\t\t\t\t((uint64_t) digit[5] << 40) |\n\t\t\t\t\t((uint64_t) digit[6] << 48) |\n\t\t\t\t\t((uint64_t) digit[7] << 56);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic struct ecc_point curve_g = CURVE_G_32;\nstatic uint64_t curve_n[NUM_ECC_DIGITS] = CURVE_N_32;\n\nbool ecc_make_public_key(const uint8_t private_key[32], uint8_t public_key[64])\n{\n\tstruct ecc_point pk;\n\tuint64_t priv[NUM_ECC_DIGITS];\n\n\tecc_bytes2native(private_key, priv);\n\n\tif (vli_is_zero(priv))\n\t\treturn false;\n\n\t/* Make sure the private key is in the range [1, n-1]. */\n\tif (vli_cmp(curve_n, priv) != 1)\n\t\treturn false;\n\n\tecc_point_mult(&pk, &curve_g, priv, NULL, vli_num_bits(priv));\n\n\tif (ecc_point_is_zero(&pk))\n\t\treturn false;\n\n\tecc_native2bytes(pk.x, public_key);\n\tecc_native2bytes(pk.y, &public_key[32]);\n\n\treturn true;\n}"
  },
  {
    "function_name": "ecc_native2bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "840-857",
    "snippet": "static void ecc_native2bytes(const uint64_t native[NUM_ECC_DIGITS],\n\t\t\t\t\t\tuint8_t bytes[ECC_BYTES])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tdigit[0] = native[NUM_ECC_DIGITS - 1 - i] >> 0;\n\t\tdigit[1] = native[NUM_ECC_DIGITS - 1 - i] >> 8;\n\t\tdigit[2] = native[NUM_ECC_DIGITS - 1 - i] >> 16;\n\t\tdigit[3] = native[NUM_ECC_DIGITS - 1 - i] >> 24;\n\t\tdigit[4] = native[NUM_ECC_DIGITS - 1 - i] >> 32;\n\t\tdigit[5] = native[NUM_ECC_DIGITS - 1 - i] >> 40;\n\t\tdigit[6] = native[NUM_ECC_DIGITS - 1 - i] >> 48;\n\t\tdigit[7] = native[NUM_ECC_DIGITS - 1 - i] >> 56;\n\t}\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)",
      "#define ECC_BYTES 32"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n#define ECC_BYTES 32\n\nstatic void ecc_native2bytes(const uint64_t native[NUM_ECC_DIGITS],\n\t\t\t\t\t\tuint8_t bytes[ECC_BYTES])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tdigit[0] = native[NUM_ECC_DIGITS - 1 - i] >> 0;\n\t\tdigit[1] = native[NUM_ECC_DIGITS - 1 - i] >> 8;\n\t\tdigit[2] = native[NUM_ECC_DIGITS - 1 - i] >> 16;\n\t\tdigit[3] = native[NUM_ECC_DIGITS - 1 - i] >> 24;\n\t\tdigit[4] = native[NUM_ECC_DIGITS - 1 - i] >> 32;\n\t\tdigit[5] = native[NUM_ECC_DIGITS - 1 - i] >> 40;\n\t\tdigit[6] = native[NUM_ECC_DIGITS - 1 - i] >> 48;\n\t\tdigit[7] = native[NUM_ECC_DIGITS - 1 - i] >> 56;\n\t}\n}"
  },
  {
    "function_name": "ecc_bytes2native",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "819-837",
    "snippet": "static void ecc_bytes2native(const uint8_t bytes[ECC_BYTES],\n\t\t\t\t\t\tuint64_t native[NUM_ECC_DIGITS])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tconst uint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tnative[NUM_ECC_DIGITS - 1 - i] =\n\t\t\t\t\t((uint64_t) digit[0] << 0) |\n\t\t\t\t\t((uint64_t) digit[1] << 8) |\n\t\t\t\t\t((uint64_t) digit[2] << 16) |\n\t\t\t\t\t((uint64_t) digit[3] << 24) |\n\t\t\t\t\t((uint64_t) digit[4] << 32) |\n\t\t\t\t\t((uint64_t) digit[5] << 40) |\n\t\t\t\t\t((uint64_t) digit[6] << 48) |\n\t\t\t\t\t((uint64_t) digit[7] << 56);\n\t}\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)",
      "#define ECC_BYTES 32"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n#define ECC_BYTES 32\n\nstatic void ecc_bytes2native(const uint8_t bytes[ECC_BYTES],\n\t\t\t\t\t\tuint64_t native[NUM_ECC_DIGITS])\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tconst uint8_t *digit = bytes + 8 * (NUM_ECC_DIGITS - 1 - i);\n\n\t\tnative[NUM_ECC_DIGITS - 1 - i] =\n\t\t\t\t\t((uint64_t) digit[0] << 0) |\n\t\t\t\t\t((uint64_t) digit[1] << 8) |\n\t\t\t\t\t((uint64_t) digit[2] << 16) |\n\t\t\t\t\t((uint64_t) digit[3] << 24) |\n\t\t\t\t\t((uint64_t) digit[4] << 32) |\n\t\t\t\t\t((uint64_t) digit[5] << 40) |\n\t\t\t\t\t((uint64_t) digit[6] << 48) |\n\t\t\t\t\t((uint64_t) digit[7] << 56);\n\t}\n}"
  },
  {
    "function_name": "ecc_valid_point",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "790-816",
    "snippet": "static bool ecc_valid_point(const struct ecc_point *point)\n{\n\tuint64_t tmp1[NUM_ECC_DIGITS];\n\tuint64_t tmp2[NUM_ECC_DIGITS];\n\tuint64_t _3[NUM_ECC_DIGITS] = { 3 };\t/* -a = 3 */\n\n\t/* The point at infinity is invalid. */\n\tif (ecc_point_is_zero(point))\n\t\treturn false;\n\n\t/* x and y must be smaller than p. */\n\tif (vli_cmp(curve_p, point->x) != 1 ||\n\t\t\tvli_cmp(curve_p, point->y) != 1)\n\t\treturn false;\n\n\t/* Computes result = y^2. */\n\tvli_mod_square_fast(tmp1, point->y);\n\n\t/* Computes result = x^3 + ax + b. result must not overlap x. */\n\tvli_mod_square_fast(tmp2, point->x);\t\t/* r = x^2 */\n\tvli_mod_sub(tmp2, tmp2, _3, curve_p);\t\t/* r = x^2 - 3 */\n\tvli_mod_mult_fast(tmp2, tmp2, point->x);\t/* r = x^3 - 3x */\n\tvli_mod_add(tmp2, tmp2, curve_b, curve_p);\t/* r = x^3 - 3x + b */\n\n\t/* Make sure that y^2 == x^3 + ax + b */\n\treturn vli_equal(tmp1, tmp2);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [
      "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;",
      "static uint64_t curve_b[NUM_ECC_DIGITS] = CURVE_B_32;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_equal",
          "args": [
            "tmp1",
            "tmp2"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "vli_equal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "192-201",
          "snippet": "static bool vli_equal(const uint64_t *left, const uint64_t *right)\n{\n\tuint64_t diff = 0;\n\tint i;\n\n\tfor (i = NUM_ECC_DIGITS - 1; i >= 0; --i)\n\t\tdiff |= (left[i] ^ right[i]);\n\n\treturn (diff == 0);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic bool vli_equal(const uint64_t *left, const uint64_t *right)\n{\n\tuint64_t diff = 0;\n\tint i;\n\n\tfor (i = NUM_ECC_DIGITS - 1; i >= 0; --i)\n\t\tdiff |= (left[i] ^ right[i]);\n\n\treturn (diff == 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_add",
          "args": [
            "tmp2",
            "tmp2",
            "curve_b",
            "curve_p"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "390-402",
          "snippet": "static void vli_mod_add(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t carry;\n\n\tcarry = vli_add(result, left, right);\n\n\t/* result > mod (result = mod + remainder), so subtract mod to\n\t * get remainder.\n\t */\n\tif (carry || vli_cmp(result, mod) >= 0)\n\t\tvli_sub(result, result, mod);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void vli_mod_add(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t carry;\n\n\tcarry = vli_add(result, left, right);\n\n\t/* result > mod (result = mod + remainder), so subtract mod to\n\t * get remainder.\n\t */\n\tif (carry || vli_cmp(result, mod) >= 0)\n\t\tvli_sub(result, result, mod);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_mult_fast",
          "args": [
            "tmp2",
            "tmp2",
            "point->x"
          ],
          "line": 811
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_mult_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "498-505",
          "snippet": "static void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_sub",
          "args": [
            "tmp2",
            "tmp2",
            "_3",
            "curve_p"
          ],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "407-418",
          "snippet": "static void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_square_fast",
          "args": [
            "tmp2",
            "point->x"
          ],
          "line": 809
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_square_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "508-514",
          "snippet": "static void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_cmp",
          "args": [
            "curve_p",
            "point->y"
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "vli_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "176-188",
          "snippet": "static int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_point_is_zero",
          "args": [
            "point"
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_point_is_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "598-601",
          "snippet": "static bool ecc_point_is_zero(const struct ecc_point *point)\n{\n\treturn (vli_is_zero(point->x) && vli_is_zero(point->y));\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic bool ecc_point_is_zero(const struct ecc_point *point)\n{\n\treturn (vli_is_zero(point->x) && vli_is_zero(point->y));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\nstatic uint64_t curve_b[NUM_ECC_DIGITS] = CURVE_B_32;\n\nstatic bool ecc_valid_point(const struct ecc_point *point)\n{\n\tuint64_t tmp1[NUM_ECC_DIGITS];\n\tuint64_t tmp2[NUM_ECC_DIGITS];\n\tuint64_t _3[NUM_ECC_DIGITS] = { 3 };\t/* -a = 3 */\n\n\t/* The point at infinity is invalid. */\n\tif (ecc_point_is_zero(point))\n\t\treturn false;\n\n\t/* x and y must be smaller than p. */\n\tif (vli_cmp(curve_p, point->x) != 1 ||\n\t\t\tvli_cmp(curve_p, point->y) != 1)\n\t\treturn false;\n\n\t/* Computes result = y^2. */\n\tvli_mod_square_fast(tmp1, point->y);\n\n\t/* Computes result = x^3 + ax + b. result must not overlap x. */\n\tvli_mod_square_fast(tmp2, point->x);\t\t/* r = x^2 */\n\tvli_mod_sub(tmp2, tmp2, _3, curve_p);\t\t/* r = x^2 - 3 */\n\tvli_mod_mult_fast(tmp2, tmp2, point->x);\t/* r = x^3 - 3x */\n\tvli_mod_add(tmp2, tmp2, curve_b, curve_p);\t/* r = x^3 - 3x + b */\n\n\t/* Make sure that y^2 == x^3 + ax + b */\n\treturn vli_equal(tmp1, tmp2);\n}"
  },
  {
    "function_name": "ecc_point_mult",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "748-788",
    "snippet": "static void ecc_point_mult(struct ecc_point *result,\n\t\t\t\tconst struct ecc_point *point,\n\t\t\t\tuint64_t *scalar, uint64_t *initial_z,\n\t\t\t\tint num_bits)\n{\n\t/* R0 and R1 */\n\tuint64_t rx[2][NUM_ECC_DIGITS];\n\tuint64_t ry[2][NUM_ECC_DIGITS];\n\tuint64_t z[NUM_ECC_DIGITS];\n\tint i, nb;\n\n\tvli_set(rx[1], point->x);\n\tvli_set(ry[1], point->y);\n\n\txycz_initial_double(rx[1], ry[1], rx[0], ry[0], initial_z);\n\n\tfor (i = num_bits - 2; i > 0; i--) {\n\t\tnb = !vli_test_bit(scalar, i);\n\t\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\t\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\t}\n\n\tnb = !vli_test_bit(scalar, 0);\n\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\n\t/* Find final 1/Z value. */\n\tvli_mod_sub(z, rx[1], rx[0], curve_p); /* X1 - X0 */\n\tvli_mod_mult_fast(z, z, ry[1 - nb]); /* Yb * (X1 - X0) */\n\tvli_mod_mult_fast(z, z, point->x);   /* xP * Yb * (X1 - X0) */\n\tvli_mod_inv(z, z, curve_p);          /* 1 / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, point->y);   /* yP / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, rx[1 - nb]); /* Xb * yP / (xP * Yb * (X1 - X0)) */\n\t/* End 1/Z calculation */\n\n\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\n\tapply_z(rx[0], ry[0], z);\n\n\tvli_set(result->x, rx[0]);\n\tvli_set(result->y, ry[0]);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [
      "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_set",
          "args": [
            "result->y",
            "ry[0]"
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "vli_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "167-173",
          "snippet": "static void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "apply_z",
          "args": [
            "rx[0]",
            "ry[0]",
            "z"
          ],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "apply_z",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "652-660",
          "snippet": "static void apply_z(uint64_t *x1, uint64_t *y1, uint64_t *z)\n{\n\tuint64_t t1[NUM_ECC_DIGITS];\n\n\tvli_mod_square_fast(t1, z);    /* z^2 */\n\tvli_mod_mult_fast(x1, x1, t1); /* x1 * z^2 */\n\tvli_mod_mult_fast(t1, t1, z);  /* z^3 */\n\tvli_mod_mult_fast(y1, y1, t1); /* y1 * z^3 */\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void apply_z(uint64_t *x1, uint64_t *y1, uint64_t *z)\n{\n\tuint64_t t1[NUM_ECC_DIGITS];\n\n\tvli_mod_square_fast(t1, z);    /* z^2 */\n\tvli_mod_mult_fast(x1, x1, t1); /* x1 * z^2 */\n\tvli_mod_mult_fast(t1, t1, z);  /* z^3 */\n\tvli_mod_mult_fast(y1, y1, t1); /* y1 * z^3 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "xycz_add",
          "args": [
            "rx[nb]",
            "ry[nb]",
            "rx[1 - nb]",
            "ry[1 - nb]"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "xycz_add_c",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "715-746",
          "snippet": "static void xycz_add_c(uint64_t *x1, uint64_t *y1, uint64_t *x2, uint64_t *y2)\n{\n\t/* t1 = X1, t2 = Y1, t3 = X2, t4 = Y2 */\n\tuint64_t t5[NUM_ECC_DIGITS];\n\tuint64_t t6[NUM_ECC_DIGITS];\n\tuint64_t t7[NUM_ECC_DIGITS];\n\n\tvli_mod_sub(t5, x2, x1, curve_p); /* t5 = x2 - x1 */\n\tvli_mod_square_fast(t5, t5);      /* t5 = (x2 - x1)^2 = A */\n\tvli_mod_mult_fast(x1, x1, t5);    /* t1 = x1*A = B */\n\tvli_mod_mult_fast(x2, x2, t5);    /* t3 = x2*A = C */\n\tvli_mod_add(t5, y2, y1, curve_p); /* t4 = y2 + y1 */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y2 - y1 */\n\n\tvli_mod_sub(t6, x2, x1, curve_p); /* t6 = C - B */\n\tvli_mod_mult_fast(y1, y1, t6);    /* t2 = y1 * (C - B) */\n\tvli_mod_add(t6, x1, x2, curve_p); /* t6 = B + C */\n\tvli_mod_square_fast(x2, y2);      /* t3 = (y2 - y1)^2 */\n\tvli_mod_sub(x2, x2, t6, curve_p); /* t3 = x3 */\n\n\tvli_mod_sub(t7, x1, x2, curve_p); /* t7 = B - x3 */\n\tvli_mod_mult_fast(y2, y2, t7);    /* t4 = (y2 - y1)*(B - x3) */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y3 */\n\n\tvli_mod_square_fast(t7, t5);      /* t7 = (y2 + y1)^2 = F */\n\tvli_mod_sub(t7, t7, t6, curve_p); /* t7 = x3' */\n\tvli_mod_sub(t6, t7, x1, curve_p); /* t6 = x3' - B */\n\tvli_mod_mult_fast(t6, t6, t5);    /* t6 = (y2 + y1)*(x3' - B) */\n\tvli_mod_sub(y1, t6, y1, curve_p); /* t2 = y3' */\n\n\tvli_set(x1, t7);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [
            "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void xycz_add_c(uint64_t *x1, uint64_t *y1, uint64_t *x2, uint64_t *y2)\n{\n\t/* t1 = X1, t2 = Y1, t3 = X2, t4 = Y2 */\n\tuint64_t t5[NUM_ECC_DIGITS];\n\tuint64_t t6[NUM_ECC_DIGITS];\n\tuint64_t t7[NUM_ECC_DIGITS];\n\n\tvli_mod_sub(t5, x2, x1, curve_p); /* t5 = x2 - x1 */\n\tvli_mod_square_fast(t5, t5);      /* t5 = (x2 - x1)^2 = A */\n\tvli_mod_mult_fast(x1, x1, t5);    /* t1 = x1*A = B */\n\tvli_mod_mult_fast(x2, x2, t5);    /* t3 = x2*A = C */\n\tvli_mod_add(t5, y2, y1, curve_p); /* t4 = y2 + y1 */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y2 - y1 */\n\n\tvli_mod_sub(t6, x2, x1, curve_p); /* t6 = C - B */\n\tvli_mod_mult_fast(y1, y1, t6);    /* t2 = y1 * (C - B) */\n\tvli_mod_add(t6, x1, x2, curve_p); /* t6 = B + C */\n\tvli_mod_square_fast(x2, y2);      /* t3 = (y2 - y1)^2 */\n\tvli_mod_sub(x2, x2, t6, curve_p); /* t3 = x3 */\n\n\tvli_mod_sub(t7, x1, x2, curve_p); /* t7 = B - x3 */\n\tvli_mod_mult_fast(y2, y2, t7);    /* t4 = (y2 - y1)*(B - x3) */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y3 */\n\n\tvli_mod_square_fast(t7, t5);      /* t7 = (y2 + y1)^2 = F */\n\tvli_mod_sub(t7, t7, t6, curve_p); /* t7 = x3' */\n\tvli_mod_sub(t6, t7, x1, curve_p); /* t6 = x3' - B */\n\tvli_mod_mult_fast(t6, t6, t5);    /* t6 = (y2 + y1)*(x3' - B) */\n\tvli_mod_sub(y1, t6, y1, curve_p); /* t2 = y3' */\n\n\tvli_set(x1, t7);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_mult_fast",
          "args": [
            "z",
            "z",
            "rx[1 - nb]"
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_mult_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "498-505",
          "snippet": "static void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_inv",
          "args": [
            "z",
            "z",
            "curve_p"
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_inv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "521-593",
          "snippet": "static void vli_mod_inv(uint64_t *result, const uint64_t *input,\n\t\t\t\t\t\t\tconst uint64_t *mod)\n{\n\tuint64_t a[NUM_ECC_DIGITS], b[NUM_ECC_DIGITS];\n\tuint64_t u[NUM_ECC_DIGITS], v[NUM_ECC_DIGITS];\n\tuint64_t carry;\n\tint cmp_result;\n\n\tif (vli_is_zero(input)) {\n\t\tvli_clear(result);\n\t\treturn;\n\t}\n\n\tvli_set(a, input);\n\tvli_set(b, mod);\n\tvli_clear(u);\n\tu[0] = 1;\n\tvli_clear(v);\n\n\twhile ((cmp_result = vli_cmp(a, b)) != 0) {\n\t\tcarry = 0;\n\n\t\tif (EVEN(a)) {\n\t\t\tvli_rshift1(a);\n\n\t\t\tif (!EVEN(u))\n\t\t\t\tcarry = vli_add(u, u, mod);\n\n\t\t\tvli_rshift1(u);\n\t\t\tif (carry)\n\t\t\t\tu[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else if (EVEN(b)) {\n\t\t\tvli_rshift1(b);\n\n\t\t\tif (!EVEN(v))\n\t\t\t\tcarry = vli_add(v, v, mod);\n\n\t\t\tvli_rshift1(v);\n\t\t\tif (carry)\n\t\t\t\tv[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else if (cmp_result > 0) {\n\t\t\tvli_sub(a, a, b);\n\t\t\tvli_rshift1(a);\n\n\t\t\tif (vli_cmp(u, v) < 0)\n\t\t\t\tvli_add(u, u, mod);\n\n\t\t\tvli_sub(u, u, v);\n\t\t\tif (!EVEN(u))\n\t\t\t\tcarry = vli_add(u, u, mod);\n\n\t\t\tvli_rshift1(u);\n\t\t\tif (carry)\n\t\t\t\tu[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else {\n\t\t\tvli_sub(b, b, a);\n\t\t\tvli_rshift1(b);\n\n\t\t\tif (vli_cmp(v, u) < 0)\n\t\t\t\tvli_add(v, v, mod);\n\n\t\t\tvli_sub(v, v, u);\n\t\t\tif (!EVEN(v))\n\t\t\t\tcarry = vli_add(v, v, mod);\n\n\t\t\tvli_rshift1(v);\n\t\t\tif (carry)\n\t\t\t\tv[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t}\n\t}\n\n\tvli_set(result, u);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_inv(uint64_t *result, const uint64_t *input,\n\t\t\t\t\t\t\tconst uint64_t *mod)\n{\n\tuint64_t a[NUM_ECC_DIGITS], b[NUM_ECC_DIGITS];\n\tuint64_t u[NUM_ECC_DIGITS], v[NUM_ECC_DIGITS];\n\tuint64_t carry;\n\tint cmp_result;\n\n\tif (vli_is_zero(input)) {\n\t\tvli_clear(result);\n\t\treturn;\n\t}\n\n\tvli_set(a, input);\n\tvli_set(b, mod);\n\tvli_clear(u);\n\tu[0] = 1;\n\tvli_clear(v);\n\n\twhile ((cmp_result = vli_cmp(a, b)) != 0) {\n\t\tcarry = 0;\n\n\t\tif (EVEN(a)) {\n\t\t\tvli_rshift1(a);\n\n\t\t\tif (!EVEN(u))\n\t\t\t\tcarry = vli_add(u, u, mod);\n\n\t\t\tvli_rshift1(u);\n\t\t\tif (carry)\n\t\t\t\tu[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else if (EVEN(b)) {\n\t\t\tvli_rshift1(b);\n\n\t\t\tif (!EVEN(v))\n\t\t\t\tcarry = vli_add(v, v, mod);\n\n\t\t\tvli_rshift1(v);\n\t\t\tif (carry)\n\t\t\t\tv[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else if (cmp_result > 0) {\n\t\t\tvli_sub(a, a, b);\n\t\t\tvli_rshift1(a);\n\n\t\t\tif (vli_cmp(u, v) < 0)\n\t\t\t\tvli_add(u, u, mod);\n\n\t\t\tvli_sub(u, u, v);\n\t\t\tif (!EVEN(u))\n\t\t\t\tcarry = vli_add(u, u, mod);\n\n\t\t\tvli_rshift1(u);\n\t\t\tif (carry)\n\t\t\t\tu[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else {\n\t\t\tvli_sub(b, b, a);\n\t\t\tvli_rshift1(b);\n\n\t\t\tif (vli_cmp(v, u) < 0)\n\t\t\t\tvli_add(v, v, mod);\n\n\t\t\tvli_sub(v, v, u);\n\t\t\tif (!EVEN(v))\n\t\t\t\tcarry = vli_add(v, v, mod);\n\n\t\t\tvli_rshift1(v);\n\t\t\tif (carry)\n\t\t\t\tv[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t}\n\t}\n\n\tvli_set(result, u);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_sub",
          "args": [
            "z",
            "rx[1]",
            "rx[0]",
            "curve_p"
          ],
          "line": 774
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "407-418",
          "snippet": "static void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_test_bit",
          "args": [
            "scalar",
            "0"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "vli_test_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "130-133",
          "snippet": "static uint64_t vli_test_bit(const uint64_t *vli, unsigned int bit)\n{\n\treturn (vli[bit / 64] & ((uint64_t) 1 << (bit % 64)));\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic uint64_t vli_test_bit(const uint64_t *vli, unsigned int bit)\n{\n\treturn (vli[bit / 64] & ((uint64_t) 1 << (bit % 64)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "xycz_initial_double",
          "args": [
            "rx[1]",
            "ry[1]",
            "rx[0]",
            "ry[0]",
            "initial_z"
          ],
          "line": 762
        },
        "resolved": true,
        "details": {
          "function_name": "xycz_initial_double",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "663-682",
          "snippet": "static void xycz_initial_double(uint64_t *x1, uint64_t *y1, uint64_t *x2,\n\t\t\t\t\tuint64_t *y2, uint64_t *p_initial_z)\n{\n\tuint64_t z[NUM_ECC_DIGITS];\n\n\tvli_set(x2, x1);\n\tvli_set(y2, y1);\n\n\tvli_clear(z);\n\tz[0] = 1;\n\n\tif (p_initial_z)\n\t\tvli_set(z, p_initial_z);\n\n\tapply_z(x1, y1, z);\n\n\tecc_point_double_jacobian(x1, y1, z);\n\n\tapply_z(x2, y2, z);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void xycz_initial_double(uint64_t *x1, uint64_t *y1, uint64_t *x2,\n\t\t\t\t\tuint64_t *y2, uint64_t *p_initial_z)\n{\n\tuint64_t z[NUM_ECC_DIGITS];\n\n\tvli_set(x2, x1);\n\tvli_set(y2, y1);\n\n\tvli_clear(z);\n\tz[0] = 1;\n\n\tif (p_initial_z)\n\t\tvli_set(z, p_initial_z);\n\n\tapply_z(x1, y1, z);\n\n\tecc_point_double_jacobian(x1, y1, z);\n\n\tapply_z(x2, y2, z);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void ecc_point_mult(struct ecc_point *result,\n\t\t\t\tconst struct ecc_point *point,\n\t\t\t\tuint64_t *scalar, uint64_t *initial_z,\n\t\t\t\tint num_bits)\n{\n\t/* R0 and R1 */\n\tuint64_t rx[2][NUM_ECC_DIGITS];\n\tuint64_t ry[2][NUM_ECC_DIGITS];\n\tuint64_t z[NUM_ECC_DIGITS];\n\tint i, nb;\n\n\tvli_set(rx[1], point->x);\n\tvli_set(ry[1], point->y);\n\n\txycz_initial_double(rx[1], ry[1], rx[0], ry[0], initial_z);\n\n\tfor (i = num_bits - 2; i > 0; i--) {\n\t\tnb = !vli_test_bit(scalar, i);\n\t\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\t\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\t}\n\n\tnb = !vli_test_bit(scalar, 0);\n\txycz_add_c(rx[1 - nb], ry[1 - nb], rx[nb], ry[nb]);\n\n\t/* Find final 1/Z value. */\n\tvli_mod_sub(z, rx[1], rx[0], curve_p); /* X1 - X0 */\n\tvli_mod_mult_fast(z, z, ry[1 - nb]); /* Yb * (X1 - X0) */\n\tvli_mod_mult_fast(z, z, point->x);   /* xP * Yb * (X1 - X0) */\n\tvli_mod_inv(z, z, curve_p);          /* 1 / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, point->y);   /* yP / (xP * Yb * (X1 - X0)) */\n\tvli_mod_mult_fast(z, z, rx[1 - nb]); /* Xb * yP / (xP * Yb * (X1 - X0)) */\n\t/* End 1/Z calculation */\n\n\txycz_add(rx[nb], ry[nb], rx[1 - nb], ry[1 - nb]);\n\n\tapply_z(rx[0], ry[0], z);\n\n\tvli_set(result->x, rx[0]);\n\tvli_set(result->y, ry[0]);\n}"
  },
  {
    "function_name": "xycz_add_c",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "715-746",
    "snippet": "static void xycz_add_c(uint64_t *x1, uint64_t *y1, uint64_t *x2, uint64_t *y2)\n{\n\t/* t1 = X1, t2 = Y1, t3 = X2, t4 = Y2 */\n\tuint64_t t5[NUM_ECC_DIGITS];\n\tuint64_t t6[NUM_ECC_DIGITS];\n\tuint64_t t7[NUM_ECC_DIGITS];\n\n\tvli_mod_sub(t5, x2, x1, curve_p); /* t5 = x2 - x1 */\n\tvli_mod_square_fast(t5, t5);      /* t5 = (x2 - x1)^2 = A */\n\tvli_mod_mult_fast(x1, x1, t5);    /* t1 = x1*A = B */\n\tvli_mod_mult_fast(x2, x2, t5);    /* t3 = x2*A = C */\n\tvli_mod_add(t5, y2, y1, curve_p); /* t4 = y2 + y1 */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y2 - y1 */\n\n\tvli_mod_sub(t6, x2, x1, curve_p); /* t6 = C - B */\n\tvli_mod_mult_fast(y1, y1, t6);    /* t2 = y1 * (C - B) */\n\tvli_mod_add(t6, x1, x2, curve_p); /* t6 = B + C */\n\tvli_mod_square_fast(x2, y2);      /* t3 = (y2 - y1)^2 */\n\tvli_mod_sub(x2, x2, t6, curve_p); /* t3 = x3 */\n\n\tvli_mod_sub(t7, x1, x2, curve_p); /* t7 = B - x3 */\n\tvli_mod_mult_fast(y2, y2, t7);    /* t4 = (y2 - y1)*(B - x3) */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y3 */\n\n\tvli_mod_square_fast(t7, t5);      /* t7 = (y2 + y1)^2 = F */\n\tvli_mod_sub(t7, t7, t6, curve_p); /* t7 = x3' */\n\tvli_mod_sub(t6, t7, x1, curve_p); /* t6 = x3' - B */\n\tvli_mod_mult_fast(t6, t6, t5);    /* t6 = (y2 + y1)*(x3' - B) */\n\tvli_mod_sub(y1, t6, y1, curve_p); /* t2 = y3' */\n\n\tvli_set(x1, t7);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [
      "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_set",
          "args": [
            "x1",
            "t7"
          ],
          "line": 745
        },
        "resolved": true,
        "details": {
          "function_name": "vli_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "167-173",
          "snippet": "static void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_sub",
          "args": [
            "y1",
            "t6",
            "y1",
            "curve_p"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "407-418",
          "snippet": "static void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_mult_fast",
          "args": [
            "t6",
            "t6",
            "t5"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_mult_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "498-505",
          "snippet": "static void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_square_fast",
          "args": [
            "t7",
            "t5"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_square_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "508-514",
          "snippet": "static void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_add",
          "args": [
            "t6",
            "x1",
            "x2",
            "curve_p"
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "390-402",
          "snippet": "static void vli_mod_add(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t carry;\n\n\tcarry = vli_add(result, left, right);\n\n\t/* result > mod (result = mod + remainder), so subtract mod to\n\t * get remainder.\n\t */\n\tif (carry || vli_cmp(result, mod) >= 0)\n\t\tvli_sub(result, result, mod);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void vli_mod_add(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t carry;\n\n\tcarry = vli_add(result, left, right);\n\n\t/* result > mod (result = mod + remainder), so subtract mod to\n\t * get remainder.\n\t */\n\tif (carry || vli_cmp(result, mod) >= 0)\n\t\tvli_sub(result, result, mod);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void xycz_add_c(uint64_t *x1, uint64_t *y1, uint64_t *x2, uint64_t *y2)\n{\n\t/* t1 = X1, t2 = Y1, t3 = X2, t4 = Y2 */\n\tuint64_t t5[NUM_ECC_DIGITS];\n\tuint64_t t6[NUM_ECC_DIGITS];\n\tuint64_t t7[NUM_ECC_DIGITS];\n\n\tvli_mod_sub(t5, x2, x1, curve_p); /* t5 = x2 - x1 */\n\tvli_mod_square_fast(t5, t5);      /* t5 = (x2 - x1)^2 = A */\n\tvli_mod_mult_fast(x1, x1, t5);    /* t1 = x1*A = B */\n\tvli_mod_mult_fast(x2, x2, t5);    /* t3 = x2*A = C */\n\tvli_mod_add(t5, y2, y1, curve_p); /* t4 = y2 + y1 */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y2 - y1 */\n\n\tvli_mod_sub(t6, x2, x1, curve_p); /* t6 = C - B */\n\tvli_mod_mult_fast(y1, y1, t6);    /* t2 = y1 * (C - B) */\n\tvli_mod_add(t6, x1, x2, curve_p); /* t6 = B + C */\n\tvli_mod_square_fast(x2, y2);      /* t3 = (y2 - y1)^2 */\n\tvli_mod_sub(x2, x2, t6, curve_p); /* t3 = x3 */\n\n\tvli_mod_sub(t7, x1, x2, curve_p); /* t7 = B - x3 */\n\tvli_mod_mult_fast(y2, y2, t7);    /* t4 = (y2 - y1)*(B - x3) */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y3 */\n\n\tvli_mod_square_fast(t7, t5);      /* t7 = (y2 + y1)^2 = F */\n\tvli_mod_sub(t7, t7, t6, curve_p); /* t7 = x3' */\n\tvli_mod_sub(t6, t7, x1, curve_p); /* t6 = x3' - B */\n\tvli_mod_mult_fast(t6, t6, t5);    /* t6 = (y2 + y1)*(x3' - B) */\n\tvli_mod_sub(y1, t6, y1, curve_p); /* t2 = y3' */\n\n\tvli_set(x1, t7);\n}"
  },
  {
    "function_name": "xycz_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "688-709",
    "snippet": "static void xycz_add(uint64_t *x1, uint64_t *y1, uint64_t *x2, uint64_t *y2)\n{\n\t/* t1 = X1, t2 = Y1, t3 = X2, t4 = Y2 */\n\tuint64_t t5[NUM_ECC_DIGITS];\n\n\tvli_mod_sub(t5, x2, x1, curve_p); /* t5 = x2 - x1 */\n\tvli_mod_square_fast(t5, t5);      /* t5 = (x2 - x1)^2 = A */\n\tvli_mod_mult_fast(x1, x1, t5);    /* t1 = x1*A = B */\n\tvli_mod_mult_fast(x2, x2, t5);    /* t3 = x2*A = C */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y2 - y1 */\n\tvli_mod_square_fast(t5, y2);      /* t5 = (y2 - y1)^2 = D */\n\n\tvli_mod_sub(t5, t5, x1, curve_p); /* t5 = D - B */\n\tvli_mod_sub(t5, t5, x2, curve_p); /* t5 = D - B - C = x3 */\n\tvli_mod_sub(x2, x2, x1, curve_p); /* t3 = C - B */\n\tvli_mod_mult_fast(y1, y1, x2);    /* t2 = y1*(C - B) */\n\tvli_mod_sub(x2, x1, t5, curve_p); /* t3 = B - x3 */\n\tvli_mod_mult_fast(y2, y2, x2);    /* t4 = (y2 - y1)*(B - x3) */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y3 */\n\n\tvli_set(x2, t5);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [
      "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_set",
          "args": [
            "x2",
            "t5"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "vli_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "167-173",
          "snippet": "static void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_sub",
          "args": [
            "y2",
            "y2",
            "y1",
            "curve_p"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "407-418",
          "snippet": "static void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_mult_fast",
          "args": [
            "y2",
            "y2",
            "x2"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_mult_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "498-505",
          "snippet": "static void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_square_fast",
          "args": [
            "t5",
            "y2"
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_square_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "508-514",
          "snippet": "static void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void xycz_add(uint64_t *x1, uint64_t *y1, uint64_t *x2, uint64_t *y2)\n{\n\t/* t1 = X1, t2 = Y1, t3 = X2, t4 = Y2 */\n\tuint64_t t5[NUM_ECC_DIGITS];\n\n\tvli_mod_sub(t5, x2, x1, curve_p); /* t5 = x2 - x1 */\n\tvli_mod_square_fast(t5, t5);      /* t5 = (x2 - x1)^2 = A */\n\tvli_mod_mult_fast(x1, x1, t5);    /* t1 = x1*A = B */\n\tvli_mod_mult_fast(x2, x2, t5);    /* t3 = x2*A = C */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y2 - y1 */\n\tvli_mod_square_fast(t5, y2);      /* t5 = (y2 - y1)^2 = D */\n\n\tvli_mod_sub(t5, t5, x1, curve_p); /* t5 = D - B */\n\tvli_mod_sub(t5, t5, x2, curve_p); /* t5 = D - B - C = x3 */\n\tvli_mod_sub(x2, x2, x1, curve_p); /* t3 = C - B */\n\tvli_mod_mult_fast(y1, y1, x2);    /* t2 = y1*(C - B) */\n\tvli_mod_sub(x2, x1, t5, curve_p); /* t3 = B - x3 */\n\tvli_mod_mult_fast(y2, y2, x2);    /* t4 = (y2 - y1)*(B - x3) */\n\tvli_mod_sub(y2, y2, y1, curve_p); /* t4 = y3 */\n\n\tvli_set(x2, t5);\n}"
  },
  {
    "function_name": "xycz_initial_double",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "663-682",
    "snippet": "static void xycz_initial_double(uint64_t *x1, uint64_t *y1, uint64_t *x2,\n\t\t\t\t\tuint64_t *y2, uint64_t *p_initial_z)\n{\n\tuint64_t z[NUM_ECC_DIGITS];\n\n\tvli_set(x2, x1);\n\tvli_set(y2, y1);\n\n\tvli_clear(z);\n\tz[0] = 1;\n\n\tif (p_initial_z)\n\t\tvli_set(z, p_initial_z);\n\n\tapply_z(x1, y1, z);\n\n\tecc_point_double_jacobian(x1, y1, z);\n\n\tapply_z(x2, y2, z);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "apply_z",
          "args": [
            "x2",
            "y2",
            "z"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "apply_z",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "652-660",
          "snippet": "static void apply_z(uint64_t *x1, uint64_t *y1, uint64_t *z)\n{\n\tuint64_t t1[NUM_ECC_DIGITS];\n\n\tvli_mod_square_fast(t1, z);    /* z^2 */\n\tvli_mod_mult_fast(x1, x1, t1); /* x1 * z^2 */\n\tvli_mod_mult_fast(t1, t1, z);  /* z^3 */\n\tvli_mod_mult_fast(y1, y1, t1); /* y1 * z^3 */\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void apply_z(uint64_t *x1, uint64_t *y1, uint64_t *z)\n{\n\tuint64_t t1[NUM_ECC_DIGITS];\n\n\tvli_mod_square_fast(t1, z);    /* z^2 */\n\tvli_mod_mult_fast(x1, x1, t1); /* x1 * z^2 */\n\tvli_mod_mult_fast(t1, t1, z);  /* z^3 */\n\tvli_mod_mult_fast(y1, y1, t1); /* y1 * z^3 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecc_point_double_jacobian",
          "args": [
            "x1",
            "y1",
            "z"
          ],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "ecc_point_double_jacobian",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "608-649",
          "snippet": "static void ecc_point_double_jacobian(uint64_t *x1, uint64_t *y1, uint64_t *z1)\n{\n\t/* t1 = x, t2 = y, t3 = z */\n\tuint64_t t4[NUM_ECC_DIGITS];\n\tuint64_t t5[NUM_ECC_DIGITS];\n\n\tif (vli_is_zero(z1))\n\t\treturn;\n\n\tvli_mod_square_fast(t4, y1);   /* t4 = y1^2 */\n\tvli_mod_mult_fast(t5, x1, t4); /* t5 = x1*y1^2 = A */\n\tvli_mod_square_fast(t4, t4);   /* t4 = y1^4 */\n\tvli_mod_mult_fast(y1, y1, z1); /* t2 = y1*z1 = z3 */\n\tvli_mod_square_fast(z1, z1);   /* t3 = z1^2 */\n\n\tvli_mod_add(x1, x1, z1, curve_p); /* t1 = x1 + z1^2 */\n\tvli_mod_add(z1, z1, z1, curve_p); /* t3 = 2*z1^2 */\n\tvli_mod_sub(z1, x1, z1, curve_p); /* t3 = x1 - z1^2 */\n\tvli_mod_mult_fast(x1, x1, z1);    /* t1 = x1^2 - z1^4 */\n\n\tvli_mod_add(z1, x1, x1, curve_p); /* t3 = 2*(x1^2 - z1^4) */\n\tvli_mod_add(x1, x1, z1, curve_p); /* t1 = 3*(x1^2 - z1^4) */\n\tif (vli_test_bit(x1, 0)) {\n\t\tuint64_t carry = vli_add(x1, x1, curve_p);\n\t\tvli_rshift1(x1);\n\t\tx1[NUM_ECC_DIGITS - 1] |= carry << 63;\n\t} else {\n\t\tvli_rshift1(x1);\n\t}\n\t/* t1 = 3/2*(x1^2 - z1^4) = B */\n\n\tvli_mod_square_fast(z1, x1);      /* t3 = B^2 */\n\tvli_mod_sub(z1, z1, t5, curve_p); /* t3 = B^2 - A */\n\tvli_mod_sub(z1, z1, t5, curve_p); /* t3 = B^2 - 2A = x3 */\n\tvli_mod_sub(t5, t5, z1, curve_p); /* t5 = A - x3 */\n\tvli_mod_mult_fast(x1, x1, t5);    /* t1 = B * (A - x3) */\n\tvli_mod_sub(t4, x1, t4, curve_p); /* t4 = B * (A - x3) - y1^4 = y3 */\n\n\tvli_set(x1, z1);\n\tvli_set(z1, y1);\n\tvli_set(y1, t4);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [
            "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void ecc_point_double_jacobian(uint64_t *x1, uint64_t *y1, uint64_t *z1)\n{\n\t/* t1 = x, t2 = y, t3 = z */\n\tuint64_t t4[NUM_ECC_DIGITS];\n\tuint64_t t5[NUM_ECC_DIGITS];\n\n\tif (vli_is_zero(z1))\n\t\treturn;\n\n\tvli_mod_square_fast(t4, y1);   /* t4 = y1^2 */\n\tvli_mod_mult_fast(t5, x1, t4); /* t5 = x1*y1^2 = A */\n\tvli_mod_square_fast(t4, t4);   /* t4 = y1^4 */\n\tvli_mod_mult_fast(y1, y1, z1); /* t2 = y1*z1 = z3 */\n\tvli_mod_square_fast(z1, z1);   /* t3 = z1^2 */\n\n\tvli_mod_add(x1, x1, z1, curve_p); /* t1 = x1 + z1^2 */\n\tvli_mod_add(z1, z1, z1, curve_p); /* t3 = 2*z1^2 */\n\tvli_mod_sub(z1, x1, z1, curve_p); /* t3 = x1 - z1^2 */\n\tvli_mod_mult_fast(x1, x1, z1);    /* t1 = x1^2 - z1^4 */\n\n\tvli_mod_add(z1, x1, x1, curve_p); /* t3 = 2*(x1^2 - z1^4) */\n\tvli_mod_add(x1, x1, z1, curve_p); /* t1 = 3*(x1^2 - z1^4) */\n\tif (vli_test_bit(x1, 0)) {\n\t\tuint64_t carry = vli_add(x1, x1, curve_p);\n\t\tvli_rshift1(x1);\n\t\tx1[NUM_ECC_DIGITS - 1] |= carry << 63;\n\t} else {\n\t\tvli_rshift1(x1);\n\t}\n\t/* t1 = 3/2*(x1^2 - z1^4) = B */\n\n\tvli_mod_square_fast(z1, x1);      /* t3 = B^2 */\n\tvli_mod_sub(z1, z1, t5, curve_p); /* t3 = B^2 - A */\n\tvli_mod_sub(z1, z1, t5, curve_p); /* t3 = B^2 - 2A = x3 */\n\tvli_mod_sub(t5, t5, z1, curve_p); /* t5 = A - x3 */\n\tvli_mod_mult_fast(x1, x1, t5);    /* t1 = B * (A - x3) */\n\tvli_mod_sub(t4, x1, t4, curve_p); /* t4 = B * (A - x3) - y1^4 = y3 */\n\n\tvli_set(x1, z1);\n\tvli_set(z1, y1);\n\tvli_set(y1, t4);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_set",
          "args": [
            "z",
            "p_initial_z"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "vli_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "167-173",
          "snippet": "static void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_clear",
          "args": [
            "z"
          ],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "vli_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "108-114",
          "snippet": "static void vli_clear(uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tvli[i] = 0;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_clear(uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tvli[i] = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void xycz_initial_double(uint64_t *x1, uint64_t *y1, uint64_t *x2,\n\t\t\t\t\tuint64_t *y2, uint64_t *p_initial_z)\n{\n\tuint64_t z[NUM_ECC_DIGITS];\n\n\tvli_set(x2, x1);\n\tvli_set(y2, y1);\n\n\tvli_clear(z);\n\tz[0] = 1;\n\n\tif (p_initial_z)\n\t\tvli_set(z, p_initial_z);\n\n\tapply_z(x1, y1, z);\n\n\tecc_point_double_jacobian(x1, y1, z);\n\n\tapply_z(x2, y2, z);\n}"
  },
  {
    "function_name": "apply_z",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "652-660",
    "snippet": "static void apply_z(uint64_t *x1, uint64_t *y1, uint64_t *z)\n{\n\tuint64_t t1[NUM_ECC_DIGITS];\n\n\tvli_mod_square_fast(t1, z);    /* z^2 */\n\tvli_mod_mult_fast(x1, x1, t1); /* x1 * z^2 */\n\tvli_mod_mult_fast(t1, t1, z);  /* z^3 */\n\tvli_mod_mult_fast(y1, y1, t1); /* y1 * z^3 */\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_mod_mult_fast",
          "args": [
            "y1",
            "y1",
            "t1"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_mult_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "498-505",
          "snippet": "static void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_square_fast",
          "args": [
            "t1",
            "z"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_square_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "508-514",
          "snippet": "static void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void apply_z(uint64_t *x1, uint64_t *y1, uint64_t *z)\n{\n\tuint64_t t1[NUM_ECC_DIGITS];\n\n\tvli_mod_square_fast(t1, z);    /* z^2 */\n\tvli_mod_mult_fast(x1, x1, t1); /* x1 * z^2 */\n\tvli_mod_mult_fast(t1, t1, z);  /* z^3 */\n\tvli_mod_mult_fast(y1, y1, t1); /* y1 * z^3 */\n}"
  },
  {
    "function_name": "ecc_point_double_jacobian",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "608-649",
    "snippet": "static void ecc_point_double_jacobian(uint64_t *x1, uint64_t *y1, uint64_t *z1)\n{\n\t/* t1 = x, t2 = y, t3 = z */\n\tuint64_t t4[NUM_ECC_DIGITS];\n\tuint64_t t5[NUM_ECC_DIGITS];\n\n\tif (vli_is_zero(z1))\n\t\treturn;\n\n\tvli_mod_square_fast(t4, y1);   /* t4 = y1^2 */\n\tvli_mod_mult_fast(t5, x1, t4); /* t5 = x1*y1^2 = A */\n\tvli_mod_square_fast(t4, t4);   /* t4 = y1^4 */\n\tvli_mod_mult_fast(y1, y1, z1); /* t2 = y1*z1 = z3 */\n\tvli_mod_square_fast(z1, z1);   /* t3 = z1^2 */\n\n\tvli_mod_add(x1, x1, z1, curve_p); /* t1 = x1 + z1^2 */\n\tvli_mod_add(z1, z1, z1, curve_p); /* t3 = 2*z1^2 */\n\tvli_mod_sub(z1, x1, z1, curve_p); /* t3 = x1 - z1^2 */\n\tvli_mod_mult_fast(x1, x1, z1);    /* t1 = x1^2 - z1^4 */\n\n\tvli_mod_add(z1, x1, x1, curve_p); /* t3 = 2*(x1^2 - z1^4) */\n\tvli_mod_add(x1, x1, z1, curve_p); /* t1 = 3*(x1^2 - z1^4) */\n\tif (vli_test_bit(x1, 0)) {\n\t\tuint64_t carry = vli_add(x1, x1, curve_p);\n\t\tvli_rshift1(x1);\n\t\tx1[NUM_ECC_DIGITS - 1] |= carry << 63;\n\t} else {\n\t\tvli_rshift1(x1);\n\t}\n\t/* t1 = 3/2*(x1^2 - z1^4) = B */\n\n\tvli_mod_square_fast(z1, x1);      /* t3 = B^2 */\n\tvli_mod_sub(z1, z1, t5, curve_p); /* t3 = B^2 - A */\n\tvli_mod_sub(z1, z1, t5, curve_p); /* t3 = B^2 - 2A = x3 */\n\tvli_mod_sub(t5, t5, z1, curve_p); /* t5 = A - x3 */\n\tvli_mod_mult_fast(x1, x1, t5);    /* t1 = B * (A - x3) */\n\tvli_mod_sub(t4, x1, t4, curve_p); /* t4 = B * (A - x3) - y1^4 = y3 */\n\n\tvli_set(x1, z1);\n\tvli_set(z1, y1);\n\tvli_set(y1, t4);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [
      "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_set",
          "args": [
            "y1",
            "t4"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "vli_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "167-173",
          "snippet": "static void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_sub",
          "args": [
            "t4",
            "x1",
            "t4",
            "curve_p"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "407-418",
          "snippet": "static void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_mult_fast",
          "args": [
            "x1",
            "x1",
            "t5"
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_mult_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "498-505",
          "snippet": "static void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_square_fast",
          "args": [
            "z1",
            "x1"
          ],
          "line": 639
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_square_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "508-514",
          "snippet": "static void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_rshift1",
          "args": [
            "x1"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "vli_rshift1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "223-235",
          "snippet": "static void vli_rshift1(uint64_t *vli)\n{\n\tuint64_t *end = vli;\n\tuint64_t carry = 0;\n\n\tvli += NUM_ECC_DIGITS;\n\n\twhile (vli-- > end) {\n\t\tuint64_t temp = *vli;\n\t\t*vli = (temp >> 1) | carry;\n\t\tcarry = temp << 63;\n\t}\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_rshift1(uint64_t *vli)\n{\n\tuint64_t *end = vli;\n\tuint64_t carry = 0;\n\n\tvli += NUM_ECC_DIGITS;\n\n\twhile (vli-- > end) {\n\t\tuint64_t temp = *vli;\n\t\t*vli = (temp >> 1) | carry;\n\t\tcarry = temp << 63;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_add",
          "args": [
            "x1",
            "x1",
            "curve_p"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "vli_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "238-255",
          "snippet": "static uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_test_bit",
          "args": [
            "x1",
            "0"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "vli_test_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "130-133",
          "snippet": "static uint64_t vli_test_bit(const uint64_t *vli, unsigned int bit)\n{\n\treturn (vli[bit / 64] & ((uint64_t) 1 << (bit % 64)));\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic uint64_t vli_test_bit(const uint64_t *vli, unsigned int bit)\n{\n\treturn (vli[bit / 64] & ((uint64_t) 1 << (bit % 64)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mod_add",
          "args": [
            "x1",
            "x1",
            "z1",
            "curve_p"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mod_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "390-402",
          "snippet": "static void vli_mod_add(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t carry;\n\n\tcarry = vli_add(result, left, right);\n\n\t/* result > mod (result = mod + remainder), so subtract mod to\n\t * get remainder.\n\t */\n\tif (carry || vli_cmp(result, mod) >= 0)\n\t\tvli_sub(result, result, mod);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void vli_mod_add(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t carry;\n\n\tcarry = vli_add(result, left, right);\n\n\t/* result > mod (result = mod + remainder), so subtract mod to\n\t * get remainder.\n\t */\n\tif (carry || vli_cmp(result, mod) >= 0)\n\t\tvli_sub(result, result, mod);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_is_zero",
          "args": [
            "z1"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "vli_is_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "117-127",
          "snippet": "static bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void ecc_point_double_jacobian(uint64_t *x1, uint64_t *y1, uint64_t *z1)\n{\n\t/* t1 = x, t2 = y, t3 = z */\n\tuint64_t t4[NUM_ECC_DIGITS];\n\tuint64_t t5[NUM_ECC_DIGITS];\n\n\tif (vli_is_zero(z1))\n\t\treturn;\n\n\tvli_mod_square_fast(t4, y1);   /* t4 = y1^2 */\n\tvli_mod_mult_fast(t5, x1, t4); /* t5 = x1*y1^2 = A */\n\tvli_mod_square_fast(t4, t4);   /* t4 = y1^4 */\n\tvli_mod_mult_fast(y1, y1, z1); /* t2 = y1*z1 = z3 */\n\tvli_mod_square_fast(z1, z1);   /* t3 = z1^2 */\n\n\tvli_mod_add(x1, x1, z1, curve_p); /* t1 = x1 + z1^2 */\n\tvli_mod_add(z1, z1, z1, curve_p); /* t3 = 2*z1^2 */\n\tvli_mod_sub(z1, x1, z1, curve_p); /* t3 = x1 - z1^2 */\n\tvli_mod_mult_fast(x1, x1, z1);    /* t1 = x1^2 - z1^4 */\n\n\tvli_mod_add(z1, x1, x1, curve_p); /* t3 = 2*(x1^2 - z1^4) */\n\tvli_mod_add(x1, x1, z1, curve_p); /* t1 = 3*(x1^2 - z1^4) */\n\tif (vli_test_bit(x1, 0)) {\n\t\tuint64_t carry = vli_add(x1, x1, curve_p);\n\t\tvli_rshift1(x1);\n\t\tx1[NUM_ECC_DIGITS - 1] |= carry << 63;\n\t} else {\n\t\tvli_rshift1(x1);\n\t}\n\t/* t1 = 3/2*(x1^2 - z1^4) = B */\n\n\tvli_mod_square_fast(z1, x1);      /* t3 = B^2 */\n\tvli_mod_sub(z1, z1, t5, curve_p); /* t3 = B^2 - A */\n\tvli_mod_sub(z1, z1, t5, curve_p); /* t3 = B^2 - 2A = x3 */\n\tvli_mod_sub(t5, t5, z1, curve_p); /* t5 = A - x3 */\n\tvli_mod_mult_fast(x1, x1, t5);    /* t1 = B * (A - x3) */\n\tvli_mod_sub(t4, x1, t4, curve_p); /* t4 = B * (A - x3) - y1^4 = y3 */\n\n\tvli_set(x1, z1);\n\tvli_set(z1, y1);\n\tvli_set(y1, t4);\n}"
  },
  {
    "function_name": "ecc_point_is_zero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "598-601",
    "snippet": "static bool ecc_point_is_zero(const struct ecc_point *point)\n{\n\treturn (vli_is_zero(point->x) && vli_is_zero(point->y));\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_is_zero",
          "args": [
            "point->y"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "vli_is_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "117-127",
          "snippet": "static bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic bool ecc_point_is_zero(const struct ecc_point *point)\n{\n\treturn (vli_is_zero(point->x) && vli_is_zero(point->y));\n}"
  },
  {
    "function_name": "vli_mod_inv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "521-593",
    "snippet": "static void vli_mod_inv(uint64_t *result, const uint64_t *input,\n\t\t\t\t\t\t\tconst uint64_t *mod)\n{\n\tuint64_t a[NUM_ECC_DIGITS], b[NUM_ECC_DIGITS];\n\tuint64_t u[NUM_ECC_DIGITS], v[NUM_ECC_DIGITS];\n\tuint64_t carry;\n\tint cmp_result;\n\n\tif (vli_is_zero(input)) {\n\t\tvli_clear(result);\n\t\treturn;\n\t}\n\n\tvli_set(a, input);\n\tvli_set(b, mod);\n\tvli_clear(u);\n\tu[0] = 1;\n\tvli_clear(v);\n\n\twhile ((cmp_result = vli_cmp(a, b)) != 0) {\n\t\tcarry = 0;\n\n\t\tif (EVEN(a)) {\n\t\t\tvli_rshift1(a);\n\n\t\t\tif (!EVEN(u))\n\t\t\t\tcarry = vli_add(u, u, mod);\n\n\t\t\tvli_rshift1(u);\n\t\t\tif (carry)\n\t\t\t\tu[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else if (EVEN(b)) {\n\t\t\tvli_rshift1(b);\n\n\t\t\tif (!EVEN(v))\n\t\t\t\tcarry = vli_add(v, v, mod);\n\n\t\t\tvli_rshift1(v);\n\t\t\tif (carry)\n\t\t\t\tv[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else if (cmp_result > 0) {\n\t\t\tvli_sub(a, a, b);\n\t\t\tvli_rshift1(a);\n\n\t\t\tif (vli_cmp(u, v) < 0)\n\t\t\t\tvli_add(u, u, mod);\n\n\t\t\tvli_sub(u, u, v);\n\t\t\tif (!EVEN(u))\n\t\t\t\tcarry = vli_add(u, u, mod);\n\n\t\t\tvli_rshift1(u);\n\t\t\tif (carry)\n\t\t\t\tu[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else {\n\t\t\tvli_sub(b, b, a);\n\t\t\tvli_rshift1(b);\n\n\t\t\tif (vli_cmp(v, u) < 0)\n\t\t\t\tvli_add(v, v, mod);\n\n\t\t\tvli_sub(v, v, u);\n\t\t\tif (!EVEN(v))\n\t\t\t\tcarry = vli_add(v, v, mod);\n\n\t\t\tvli_rshift1(v);\n\t\t\tif (carry)\n\t\t\t\tv[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t}\n\t}\n\n\tvli_set(result, u);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_set",
          "args": [
            "result",
            "u"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "vli_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "167-173",
          "snippet": "static void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_rshift1",
          "args": [
            "v"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "vli_rshift1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "223-235",
          "snippet": "static void vli_rshift1(uint64_t *vli)\n{\n\tuint64_t *end = vli;\n\tuint64_t carry = 0;\n\n\tvli += NUM_ECC_DIGITS;\n\n\twhile (vli-- > end) {\n\t\tuint64_t temp = *vli;\n\t\t*vli = (temp >> 1) | carry;\n\t\tcarry = temp << 63;\n\t}\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_rshift1(uint64_t *vli)\n{\n\tuint64_t *end = vli;\n\tuint64_t carry = 0;\n\n\tvli += NUM_ECC_DIGITS;\n\n\twhile (vli-- > end) {\n\t\tuint64_t temp = *vli;\n\t\t*vli = (temp >> 1) | carry;\n\t\tcarry = temp << 63;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_add",
          "args": [
            "v",
            "v",
            "mod"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "vli_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "238-255",
          "snippet": "static uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "EVEN",
          "args": [
            "v"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vli_sub",
          "args": [
            "v",
            "v",
            "u"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "vli_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "258-275",
          "snippet": "static uint64_t vli_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t borrow = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t diff;\n\n\t\tdiff = left[i] - right[i] - borrow;\n\t\tif (diff != left[i])\n\t\t\tborrow = (diff > left[i]);\n\n\t\tresult[i] = diff;\n\t}\n\n\treturn borrow;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t borrow = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t diff;\n\n\t\tdiff = left[i] - right[i] - borrow;\n\t\tif (diff != left[i])\n\t\t\tborrow = (diff > left[i]);\n\n\t\tresult[i] = diff;\n\t}\n\n\treturn borrow;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_cmp",
          "args": [
            "v",
            "u"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "vli_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "176-188",
          "snippet": "static int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "EVEN",
          "args": [
            "u"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EVEN",
          "args": [
            "v"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EVEN",
          "args": [
            "b"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EVEN",
          "args": [
            "u"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EVEN",
          "args": [
            "a"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vli_clear",
          "args": [
            "v"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "vli_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "108-114",
          "snippet": "static void vli_clear(uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tvli[i] = 0;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_clear(uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tvli[i] = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_is_zero",
          "args": [
            "input"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "vli_is_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "117-127",
          "snippet": "static bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_inv(uint64_t *result, const uint64_t *input,\n\t\t\t\t\t\t\tconst uint64_t *mod)\n{\n\tuint64_t a[NUM_ECC_DIGITS], b[NUM_ECC_DIGITS];\n\tuint64_t u[NUM_ECC_DIGITS], v[NUM_ECC_DIGITS];\n\tuint64_t carry;\n\tint cmp_result;\n\n\tif (vli_is_zero(input)) {\n\t\tvli_clear(result);\n\t\treturn;\n\t}\n\n\tvli_set(a, input);\n\tvli_set(b, mod);\n\tvli_clear(u);\n\tu[0] = 1;\n\tvli_clear(v);\n\n\twhile ((cmp_result = vli_cmp(a, b)) != 0) {\n\t\tcarry = 0;\n\n\t\tif (EVEN(a)) {\n\t\t\tvli_rshift1(a);\n\n\t\t\tif (!EVEN(u))\n\t\t\t\tcarry = vli_add(u, u, mod);\n\n\t\t\tvli_rshift1(u);\n\t\t\tif (carry)\n\t\t\t\tu[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else if (EVEN(b)) {\n\t\t\tvli_rshift1(b);\n\n\t\t\tif (!EVEN(v))\n\t\t\t\tcarry = vli_add(v, v, mod);\n\n\t\t\tvli_rshift1(v);\n\t\t\tif (carry)\n\t\t\t\tv[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else if (cmp_result > 0) {\n\t\t\tvli_sub(a, a, b);\n\t\t\tvli_rshift1(a);\n\n\t\t\tif (vli_cmp(u, v) < 0)\n\t\t\t\tvli_add(u, u, mod);\n\n\t\t\tvli_sub(u, u, v);\n\t\t\tif (!EVEN(u))\n\t\t\t\tcarry = vli_add(u, u, mod);\n\n\t\t\tvli_rshift1(u);\n\t\t\tif (carry)\n\t\t\t\tu[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t} else {\n\t\t\tvli_sub(b, b, a);\n\t\t\tvli_rshift1(b);\n\n\t\t\tif (vli_cmp(v, u) < 0)\n\t\t\t\tvli_add(v, v, mod);\n\n\t\t\tvli_sub(v, v, u);\n\t\t\tif (!EVEN(v))\n\t\t\t\tcarry = vli_add(v, v, mod);\n\n\t\t\tvli_rshift1(v);\n\t\t\tif (carry)\n\t\t\t\tv[NUM_ECC_DIGITS - 1] |= 0x8000000000000000ull;\n\t\t}\n\t}\n\n\tvli_set(result, u);\n}"
  },
  {
    "function_name": "vli_mod_square_fast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "508-514",
    "snippet": "static void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_mmod_fast",
          "args": [
            "result",
            "product"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mmod_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "422-495",
          "snippet": "static void vli_mmod_fast(uint64_t *result, const uint64_t *product)\n{\n\tuint64_t tmp[NUM_ECC_DIGITS];\n\tint carry;\n\n\t/* t */\n\tvli_set(result, product);\n\n\t/* s1 */\n\ttmp[0] = 0;\n\ttmp[1] = product[5] & 0xffffffff00000000ull;\n\ttmp[2] = product[6];\n\ttmp[3] = product[7];\n\tcarry = vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s2 */\n\ttmp[1] = product[6] << 32;\n\ttmp[2] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[3] = product[7] >> 32;\n\tcarry += vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s3 */\n\ttmp[0] = product[4];\n\ttmp[1] = product[5] & 0xffffffff;\n\ttmp[2] = 0;\n\ttmp[3] = product[7];\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s4 */\n\ttmp[0] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[1] = (product[5] >> 32) | (product[6] & 0xffffffff00000000ull);\n\ttmp[2] = product[7];\n\ttmp[3] = (product[6] >> 32) | (product[4] << 32);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* d1 */\n\ttmp[0] = (product[5] >> 32) | (product[6] << 32);\n\ttmp[1] = (product[6] >> 32);\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] & 0xffffffff) | (product[5] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d2 */\n\ttmp[0] = product[6];\n\ttmp[1] = product[7];\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] >> 32) | (product[5] & 0xffffffff00000000ull);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d3 */\n\ttmp[0] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[1] = (product[7] >> 32) | (product[4] << 32);\n\ttmp[2] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[3] = (product[6] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d4 */\n\ttmp[0] = product[7];\n\ttmp[1] = product[4] & 0xffffffff00000000ull;\n\ttmp[2] = product[5];\n\ttmp[3] = product[6] & 0xffffffff00000000ull;\n\tcarry -= vli_sub(result, result, tmp);\n\n\tif (carry < 0) {\n\t\tdo {\n\t\t\tcarry += vli_add(result, result, curve_p);\n\t\t} while (carry < 0);\n\t} else {\n\t\twhile (carry || vli_cmp(curve_p, result) != 1)\n\t\t\tcarry -= vli_sub(result, result, curve_p);\n\t}\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [
            "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void vli_mmod_fast(uint64_t *result, const uint64_t *product)\n{\n\tuint64_t tmp[NUM_ECC_DIGITS];\n\tint carry;\n\n\t/* t */\n\tvli_set(result, product);\n\n\t/* s1 */\n\ttmp[0] = 0;\n\ttmp[1] = product[5] & 0xffffffff00000000ull;\n\ttmp[2] = product[6];\n\ttmp[3] = product[7];\n\tcarry = vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s2 */\n\ttmp[1] = product[6] << 32;\n\ttmp[2] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[3] = product[7] >> 32;\n\tcarry += vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s3 */\n\ttmp[0] = product[4];\n\ttmp[1] = product[5] & 0xffffffff;\n\ttmp[2] = 0;\n\ttmp[3] = product[7];\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s4 */\n\ttmp[0] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[1] = (product[5] >> 32) | (product[6] & 0xffffffff00000000ull);\n\ttmp[2] = product[7];\n\ttmp[3] = (product[6] >> 32) | (product[4] << 32);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* d1 */\n\ttmp[0] = (product[5] >> 32) | (product[6] << 32);\n\ttmp[1] = (product[6] >> 32);\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] & 0xffffffff) | (product[5] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d2 */\n\ttmp[0] = product[6];\n\ttmp[1] = product[7];\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] >> 32) | (product[5] & 0xffffffff00000000ull);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d3 */\n\ttmp[0] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[1] = (product[7] >> 32) | (product[4] << 32);\n\ttmp[2] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[3] = (product[6] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d4 */\n\ttmp[0] = product[7];\n\ttmp[1] = product[4] & 0xffffffff00000000ull;\n\ttmp[2] = product[5];\n\ttmp[3] = product[6] & 0xffffffff00000000ull;\n\tcarry -= vli_sub(result, result, tmp);\n\n\tif (carry < 0) {\n\t\tdo {\n\t\t\tcarry += vli_add(result, result, curve_p);\n\t\t} while (carry < 0);\n\t} else {\n\t\twhile (carry || vli_cmp(curve_p, result) != 1)\n\t\t\tcarry -= vli_sub(result, result, curve_p);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_square",
          "args": [
            "product",
            "left"
          ],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "vli_square",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "348-385",
          "snippet": "static void vli_square(uint64_t *result, const uint64_t *left)\n{\n\tuint128_t r01 = { 0, 0 };\n\tuint64_t r2 = 0;\n\tint i, k;\n\n\tfor (k = 0; k < NUM_ECC_DIGITS * 2 - 1; k++) {\n\t\tunsigned int min;\n\n\t\tif (k < NUM_ECC_DIGITS)\n\t\t\tmin = 0;\n\t\telse\n\t\t\tmin = (k + 1) - NUM_ECC_DIGITS;\n\n\t\tfor (i = min; i <= k && i <= k - i; i++) {\n\t\t\tuint128_t product;\n\n\t\t\tproduct = mul_64_64(left[i], left[k - i]);\n\n\t\t\tif (i < k - i) {\n\t\t\t\tr2 += product.m_high >> 63;\n\t\t\t\tproduct.m_high = (product.m_high << 1) |\n\t\t\t\t\t\t\t(product.m_low >> 63);\n\t\t\t\tproduct.m_low <<= 1;\n\t\t\t}\n\n\t\t\tr01 = add_128_128(r01, product);\n\t\t\tr2 += (r01.m_high < product.m_high);\n\t\t}\n\n\t\tresult[k] = r01.m_low;\n\t\tr01.m_low = r01.m_high;\n\t\tr01.m_high = r2;\n\t\tr2 = 0;\n\t}\n\n\tresult[NUM_ECC_DIGITS * 2 - 1] = r01.m_low;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_square(uint64_t *result, const uint64_t *left)\n{\n\tuint128_t r01 = { 0, 0 };\n\tuint64_t r2 = 0;\n\tint i, k;\n\n\tfor (k = 0; k < NUM_ECC_DIGITS * 2 - 1; k++) {\n\t\tunsigned int min;\n\n\t\tif (k < NUM_ECC_DIGITS)\n\t\t\tmin = 0;\n\t\telse\n\t\t\tmin = (k + 1) - NUM_ECC_DIGITS;\n\n\t\tfor (i = min; i <= k && i <= k - i; i++) {\n\t\t\tuint128_t product;\n\n\t\t\tproduct = mul_64_64(left[i], left[k - i]);\n\n\t\t\tif (i < k - i) {\n\t\t\t\tr2 += product.m_high >> 63;\n\t\t\t\tproduct.m_high = (product.m_high << 1) |\n\t\t\t\t\t\t\t(product.m_low >> 63);\n\t\t\t\tproduct.m_low <<= 1;\n\t\t\t}\n\n\t\t\tr01 = add_128_128(r01, product);\n\t\t\tr2 += (r01.m_high < product.m_high);\n\t\t}\n\n\t\tresult[k] = r01.m_low;\n\t\tr01.m_low = r01.m_high;\n\t\tr01.m_high = r2;\n\t\tr2 = 0;\n\t}\n\n\tresult[NUM_ECC_DIGITS * 2 - 1] = r01.m_low;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_square_fast(uint64_t *result, const uint64_t *left)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_square(product, left);\n\tvli_mmod_fast(result, product);\n}"
  },
  {
    "function_name": "vli_mod_mult_fast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "498-505",
    "snippet": "static void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_mmod_fast",
          "args": [
            "result",
            "product"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mmod_fast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "422-495",
          "snippet": "static void vli_mmod_fast(uint64_t *result, const uint64_t *product)\n{\n\tuint64_t tmp[NUM_ECC_DIGITS];\n\tint carry;\n\n\t/* t */\n\tvli_set(result, product);\n\n\t/* s1 */\n\ttmp[0] = 0;\n\ttmp[1] = product[5] & 0xffffffff00000000ull;\n\ttmp[2] = product[6];\n\ttmp[3] = product[7];\n\tcarry = vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s2 */\n\ttmp[1] = product[6] << 32;\n\ttmp[2] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[3] = product[7] >> 32;\n\tcarry += vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s3 */\n\ttmp[0] = product[4];\n\ttmp[1] = product[5] & 0xffffffff;\n\ttmp[2] = 0;\n\ttmp[3] = product[7];\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s4 */\n\ttmp[0] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[1] = (product[5] >> 32) | (product[6] & 0xffffffff00000000ull);\n\ttmp[2] = product[7];\n\ttmp[3] = (product[6] >> 32) | (product[4] << 32);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* d1 */\n\ttmp[0] = (product[5] >> 32) | (product[6] << 32);\n\ttmp[1] = (product[6] >> 32);\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] & 0xffffffff) | (product[5] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d2 */\n\ttmp[0] = product[6];\n\ttmp[1] = product[7];\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] >> 32) | (product[5] & 0xffffffff00000000ull);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d3 */\n\ttmp[0] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[1] = (product[7] >> 32) | (product[4] << 32);\n\ttmp[2] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[3] = (product[6] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d4 */\n\ttmp[0] = product[7];\n\ttmp[1] = product[4] & 0xffffffff00000000ull;\n\ttmp[2] = product[5];\n\ttmp[3] = product[6] & 0xffffffff00000000ull;\n\tcarry -= vli_sub(result, result, tmp);\n\n\tif (carry < 0) {\n\t\tdo {\n\t\t\tcarry += vli_add(result, result, curve_p);\n\t\t} while (carry < 0);\n\t} else {\n\t\twhile (carry || vli_cmp(curve_p, result) != 1)\n\t\t\tcarry -= vli_sub(result, result, curve_p);\n\t}\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [
            "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void vli_mmod_fast(uint64_t *result, const uint64_t *product)\n{\n\tuint64_t tmp[NUM_ECC_DIGITS];\n\tint carry;\n\n\t/* t */\n\tvli_set(result, product);\n\n\t/* s1 */\n\ttmp[0] = 0;\n\ttmp[1] = product[5] & 0xffffffff00000000ull;\n\ttmp[2] = product[6];\n\ttmp[3] = product[7];\n\tcarry = vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s2 */\n\ttmp[1] = product[6] << 32;\n\ttmp[2] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[3] = product[7] >> 32;\n\tcarry += vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s3 */\n\ttmp[0] = product[4];\n\ttmp[1] = product[5] & 0xffffffff;\n\ttmp[2] = 0;\n\ttmp[3] = product[7];\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s4 */\n\ttmp[0] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[1] = (product[5] >> 32) | (product[6] & 0xffffffff00000000ull);\n\ttmp[2] = product[7];\n\ttmp[3] = (product[6] >> 32) | (product[4] << 32);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* d1 */\n\ttmp[0] = (product[5] >> 32) | (product[6] << 32);\n\ttmp[1] = (product[6] >> 32);\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] & 0xffffffff) | (product[5] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d2 */\n\ttmp[0] = product[6];\n\ttmp[1] = product[7];\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] >> 32) | (product[5] & 0xffffffff00000000ull);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d3 */\n\ttmp[0] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[1] = (product[7] >> 32) | (product[4] << 32);\n\ttmp[2] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[3] = (product[6] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d4 */\n\ttmp[0] = product[7];\n\ttmp[1] = product[4] & 0xffffffff00000000ull;\n\ttmp[2] = product[5];\n\ttmp[3] = product[6] & 0xffffffff00000000ull;\n\tcarry -= vli_sub(result, result, tmp);\n\n\tif (carry < 0) {\n\t\tdo {\n\t\t\tcarry += vli_add(result, result, curve_p);\n\t\t} while (carry < 0);\n\t} else {\n\t\twhile (carry || vli_cmp(curve_p, result) != 1)\n\t\t\tcarry -= vli_sub(result, result, curve_p);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_mult",
          "args": [
            "product",
            "left",
            "right"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "vli_mult",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "312-346",
          "snippet": "static void vli_mult(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint128_t r01 = { 0, 0 };\n\tuint64_t r2 = 0;\n\tunsigned int i, k;\n\n\t/* Compute each digit of result in sequence, maintaining the\n\t * carries.\n\t */\n\tfor (k = 0; k < NUM_ECC_DIGITS * 2 - 1; k++) {\n\t\tunsigned int min;\n\n\t\tif (k < NUM_ECC_DIGITS)\n\t\t\tmin = 0;\n\t\telse\n\t\t\tmin = (k + 1) - NUM_ECC_DIGITS;\n\n\t\tfor (i = min; i <= k && i < NUM_ECC_DIGITS; i++) {\n\t\t\tuint128_t product;\n\n\t\t\tproduct = mul_64_64(left[i], right[k - i]);\n\n\t\t\tr01 = add_128_128(r01, product);\n\t\t\tr2 += (r01.m_high < product.m_high);\n\t\t}\n\n\t\tresult[k] = r01.m_low;\n\t\tr01.m_low = r01.m_high;\n\t\tr01.m_high = r2;\n\t\tr2 = 0;\n\t}\n\n\tresult[NUM_ECC_DIGITS * 2 - 1] = r01.m_low;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mult(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint128_t r01 = { 0, 0 };\n\tuint64_t r2 = 0;\n\tunsigned int i, k;\n\n\t/* Compute each digit of result in sequence, maintaining the\n\t * carries.\n\t */\n\tfor (k = 0; k < NUM_ECC_DIGITS * 2 - 1; k++) {\n\t\tunsigned int min;\n\n\t\tif (k < NUM_ECC_DIGITS)\n\t\t\tmin = 0;\n\t\telse\n\t\t\tmin = (k + 1) - NUM_ECC_DIGITS;\n\n\t\tfor (i = min; i <= k && i < NUM_ECC_DIGITS; i++) {\n\t\t\tuint128_t product;\n\n\t\t\tproduct = mul_64_64(left[i], right[k - i]);\n\n\t\t\tr01 = add_128_128(r01, product);\n\t\t\tr2 += (r01.m_high < product.m_high);\n\t\t}\n\n\t\tresult[k] = r01.m_low;\n\t\tr01.m_low = r01.m_high;\n\t\tr01.m_high = r2;\n\t\tr2 = 0;\n\t}\n\n\tresult[NUM_ECC_DIGITS * 2 - 1] = r01.m_low;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mod_mult_fast(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t product[2 * NUM_ECC_DIGITS];\n\n\tvli_mult(product, left, right);\n\tvli_mmod_fast(result, product);\n}"
  },
  {
    "function_name": "vli_mmod_fast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "422-495",
    "snippet": "static void vli_mmod_fast(uint64_t *result, const uint64_t *product)\n{\n\tuint64_t tmp[NUM_ECC_DIGITS];\n\tint carry;\n\n\t/* t */\n\tvli_set(result, product);\n\n\t/* s1 */\n\ttmp[0] = 0;\n\ttmp[1] = product[5] & 0xffffffff00000000ull;\n\ttmp[2] = product[6];\n\ttmp[3] = product[7];\n\tcarry = vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s2 */\n\ttmp[1] = product[6] << 32;\n\ttmp[2] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[3] = product[7] >> 32;\n\tcarry += vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s3 */\n\ttmp[0] = product[4];\n\ttmp[1] = product[5] & 0xffffffff;\n\ttmp[2] = 0;\n\ttmp[3] = product[7];\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s4 */\n\ttmp[0] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[1] = (product[5] >> 32) | (product[6] & 0xffffffff00000000ull);\n\ttmp[2] = product[7];\n\ttmp[3] = (product[6] >> 32) | (product[4] << 32);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* d1 */\n\ttmp[0] = (product[5] >> 32) | (product[6] << 32);\n\ttmp[1] = (product[6] >> 32);\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] & 0xffffffff) | (product[5] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d2 */\n\ttmp[0] = product[6];\n\ttmp[1] = product[7];\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] >> 32) | (product[5] & 0xffffffff00000000ull);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d3 */\n\ttmp[0] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[1] = (product[7] >> 32) | (product[4] << 32);\n\ttmp[2] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[3] = (product[6] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d4 */\n\ttmp[0] = product[7];\n\ttmp[1] = product[4] & 0xffffffff00000000ull;\n\ttmp[2] = product[5];\n\ttmp[3] = product[6] & 0xffffffff00000000ull;\n\tcarry -= vli_sub(result, result, tmp);\n\n\tif (carry < 0) {\n\t\tdo {\n\t\t\tcarry += vli_add(result, result, curve_p);\n\t\t} while (carry < 0);\n\t} else {\n\t\twhile (carry || vli_cmp(curve_p, result) != 1)\n\t\t\tcarry -= vli_sub(result, result, curve_p);\n\t}\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [
      "static uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_sub",
          "args": [
            "result",
            "result",
            "curve_p"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "vli_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "258-275",
          "snippet": "static uint64_t vli_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t borrow = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t diff;\n\n\t\tdiff = left[i] - right[i] - borrow;\n\t\tif (diff != left[i])\n\t\t\tborrow = (diff > left[i]);\n\n\t\tresult[i] = diff;\n\t}\n\n\treturn borrow;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t borrow = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t diff;\n\n\t\tdiff = left[i] - right[i] - borrow;\n\t\tif (diff != left[i])\n\t\t\tborrow = (diff > left[i]);\n\n\t\tresult[i] = diff;\n\t}\n\n\treturn borrow;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_cmp",
          "args": [
            "curve_p",
            "result"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "vli_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "176-188",
          "snippet": "static int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_add",
          "args": [
            "result",
            "result",
            "curve_p"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "vli_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "238-255",
          "snippet": "static uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_lshift",
          "args": [
            "tmp",
            "tmp",
            "1"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "vli_lshift",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "206-220",
          "snippet": "static uint64_t vli_lshift(uint64_t *result, const uint64_t *in,\n\t\t\t\t\t\t\tunsigned int shift)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t temp = in[i];\n\n\t\tresult[i] = (temp << shift) | carry;\n\t\tcarry = temp >> (64 - shift);\n\t}\n\n\treturn carry;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_lshift(uint64_t *result, const uint64_t *in,\n\t\t\t\t\t\t\tunsigned int shift)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t temp = in[i];\n\n\t\tresult[i] = (temp << shift) | carry;\n\t\tcarry = temp >> (64 - shift);\n\t}\n\n\treturn carry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_set",
          "args": [
            "result",
            "product"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "vli_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "167-173",
          "snippet": "static void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t curve_p[NUM_ECC_DIGITS] = CURVE_P_32;\n\nstatic void vli_mmod_fast(uint64_t *result, const uint64_t *product)\n{\n\tuint64_t tmp[NUM_ECC_DIGITS];\n\tint carry;\n\n\t/* t */\n\tvli_set(result, product);\n\n\t/* s1 */\n\ttmp[0] = 0;\n\ttmp[1] = product[5] & 0xffffffff00000000ull;\n\ttmp[2] = product[6];\n\ttmp[3] = product[7];\n\tcarry = vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s2 */\n\ttmp[1] = product[6] << 32;\n\ttmp[2] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[3] = product[7] >> 32;\n\tcarry += vli_lshift(tmp, tmp, 1);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s3 */\n\ttmp[0] = product[4];\n\ttmp[1] = product[5] & 0xffffffff;\n\ttmp[2] = 0;\n\ttmp[3] = product[7];\n\tcarry += vli_add(result, result, tmp);\n\n\t/* s4 */\n\ttmp[0] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[1] = (product[5] >> 32) | (product[6] & 0xffffffff00000000ull);\n\ttmp[2] = product[7];\n\ttmp[3] = (product[6] >> 32) | (product[4] << 32);\n\tcarry += vli_add(result, result, tmp);\n\n\t/* d1 */\n\ttmp[0] = (product[5] >> 32) | (product[6] << 32);\n\ttmp[1] = (product[6] >> 32);\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] & 0xffffffff) | (product[5] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d2 */\n\ttmp[0] = product[6];\n\ttmp[1] = product[7];\n\ttmp[2] = 0;\n\ttmp[3] = (product[4] >> 32) | (product[5] & 0xffffffff00000000ull);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d3 */\n\ttmp[0] = (product[6] >> 32) | (product[7] << 32);\n\ttmp[1] = (product[7] >> 32) | (product[4] << 32);\n\ttmp[2] = (product[4] >> 32) | (product[5] << 32);\n\ttmp[3] = (product[6] << 32);\n\tcarry -= vli_sub(result, result, tmp);\n\n\t/* d4 */\n\ttmp[0] = product[7];\n\ttmp[1] = product[4] & 0xffffffff00000000ull;\n\ttmp[2] = product[5];\n\ttmp[3] = product[6] & 0xffffffff00000000ull;\n\tcarry -= vli_sub(result, result, tmp);\n\n\tif (carry < 0) {\n\t\tdo {\n\t\t\tcarry += vli_add(result, result, curve_p);\n\t\t} while (carry < 0);\n\t} else {\n\t\twhile (carry || vli_cmp(curve_p, result) != 1)\n\t\t\tcarry -= vli_sub(result, result, curve_p);\n\t}\n}"
  },
  {
    "function_name": "vli_mod_sub",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "407-418",
    "snippet": "static void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_add",
          "args": [
            "result",
            "result",
            "mod"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "vli_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "238-255",
          "snippet": "static uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_sub",
          "args": [
            "result",
            "left",
            "right"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "vli_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "258-275",
          "snippet": "static uint64_t vli_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t borrow = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t diff;\n\n\t\tdiff = left[i] - right[i] - borrow;\n\t\tif (diff != left[i])\n\t\t\tborrow = (diff > left[i]);\n\n\t\tresult[i] = diff;\n\t}\n\n\treturn borrow;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t borrow = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t diff;\n\n\t\tdiff = left[i] - right[i] - borrow;\n\t\tif (diff != left[i])\n\t\t\tborrow = (diff > left[i]);\n\n\t\tresult[i] = diff;\n\t}\n\n\treturn borrow;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void vli_mod_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t borrow = vli_sub(result, left, right);\n\n\t/* In this case, p_result == -diff == (max int) - diff.\n\t * Since -x % d == d - x, we can get the correct result from\n\t * result + mod (with overflow).\n\t */\n\tif (borrow)\n\t\tvli_add(result, result, mod);\n}"
  },
  {
    "function_name": "vli_mod_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "390-402",
    "snippet": "static void vli_mod_add(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t carry;\n\n\tcarry = vli_add(result, left, right);\n\n\t/* result > mod (result = mod + remainder), so subtract mod to\n\t * get remainder.\n\t */\n\tif (carry || vli_cmp(result, mod) >= 0)\n\t\tvli_sub(result, result, mod);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_sub",
          "args": [
            "result",
            "result",
            "mod"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "vli_sub",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "258-275",
          "snippet": "static uint64_t vli_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t borrow = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t diff;\n\n\t\tdiff = left[i] - right[i] - borrow;\n\t\tif (diff != left[i])\n\t\t\tborrow = (diff > left[i]);\n\n\t\tresult[i] = diff;\n\t}\n\n\treturn borrow;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t borrow = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t diff;\n\n\t\tdiff = left[i] - right[i] - borrow;\n\t\tif (diff != left[i])\n\t\t\tborrow = (diff > left[i]);\n\n\t\tresult[i] = diff;\n\t}\n\n\treturn borrow;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_cmp",
          "args": [
            "result",
            "mod"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "vli_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "176-188",
          "snippet": "static int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vli_add",
          "args": [
            "result",
            "left",
            "right"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "vli_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "238-255",
          "snippet": "static uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void vli_mod_add(uint64_t *result, const uint64_t *left,\n\t\t\t\tconst uint64_t *right, const uint64_t *mod)\n{\n\tuint64_t carry;\n\n\tcarry = vli_add(result, left, right);\n\n\t/* result > mod (result = mod + remainder), so subtract mod to\n\t * get remainder.\n\t */\n\tif (carry || vli_cmp(result, mod) >= 0)\n\t\tvli_sub(result, result, mod);\n}"
  },
  {
    "function_name": "vli_square",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "348-385",
    "snippet": "static void vli_square(uint64_t *result, const uint64_t *left)\n{\n\tuint128_t r01 = { 0, 0 };\n\tuint64_t r2 = 0;\n\tint i, k;\n\n\tfor (k = 0; k < NUM_ECC_DIGITS * 2 - 1; k++) {\n\t\tunsigned int min;\n\n\t\tif (k < NUM_ECC_DIGITS)\n\t\t\tmin = 0;\n\t\telse\n\t\t\tmin = (k + 1) - NUM_ECC_DIGITS;\n\n\t\tfor (i = min; i <= k && i <= k - i; i++) {\n\t\t\tuint128_t product;\n\n\t\t\tproduct = mul_64_64(left[i], left[k - i]);\n\n\t\t\tif (i < k - i) {\n\t\t\t\tr2 += product.m_high >> 63;\n\t\t\t\tproduct.m_high = (product.m_high << 1) |\n\t\t\t\t\t\t\t(product.m_low >> 63);\n\t\t\t\tproduct.m_low <<= 1;\n\t\t\t}\n\n\t\t\tr01 = add_128_128(r01, product);\n\t\t\tr2 += (r01.m_high < product.m_high);\n\t\t}\n\n\t\tresult[k] = r01.m_low;\n\t\tr01.m_low = r01.m_high;\n\t\tr01.m_high = r2;\n\t\tr2 = 0;\n\t}\n\n\tresult[NUM_ECC_DIGITS * 2 - 1] = r01.m_low;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_128_128",
          "args": [
            "r01",
            "product"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "add_128_128",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "302-310",
          "snippet": "static uint128_t add_128_128(uint128_t a, uint128_t b)\n{\n\tuint128_t result;\n\n\tresult.m_low = a.m_low + b.m_low;\n\tresult.m_high = a.m_high + b.m_high + (result.m_low < a.m_low);\n\n\treturn result;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic uint128_t add_128_128(uint128_t a, uint128_t b)\n{\n\tuint128_t result;\n\n\tresult.m_low = a.m_low + b.m_low;\n\tresult.m_high = a.m_high + b.m_high + (result.m_low < a.m_low);\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mul_64_64",
          "args": [
            "left[i]",
            "left[k - i]"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "mul_64_64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "277-300",
          "snippet": "static uint128_t mul_64_64(uint64_t left, uint64_t right)\n{\n\tuint64_t a0 = left & 0xffffffffull;\n\tuint64_t a1 = left >> 32;\n\tuint64_t b0 = right & 0xffffffffull;\n\tuint64_t b1 = right >> 32;\n\tuint64_t m0 = a0 * b0;\n\tuint64_t m1 = a0 * b1;\n\tuint64_t m2 = a1 * b0;\n\tuint64_t m3 = a1 * b1;\n\tuint128_t result;\n\n\tm2 += (m0 >> 32);\n\tm2 += m1;\n\n\t/* Overflow */\n\tif (m2 < m1)\n\t\tm3 += 0x100000000ull;\n\n\tresult.m_low = (m0 & 0xffffffffull) | (m2 << 32);\n\tresult.m_high = m3 + (m2 >> 32);\n\n\treturn result;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic uint128_t mul_64_64(uint64_t left, uint64_t right)\n{\n\tuint64_t a0 = left & 0xffffffffull;\n\tuint64_t a1 = left >> 32;\n\tuint64_t b0 = right & 0xffffffffull;\n\tuint64_t b1 = right >> 32;\n\tuint64_t m0 = a0 * b0;\n\tuint64_t m1 = a0 * b1;\n\tuint64_t m2 = a1 * b0;\n\tuint64_t m3 = a1 * b1;\n\tuint128_t result;\n\n\tm2 += (m0 >> 32);\n\tm2 += m1;\n\n\t/* Overflow */\n\tif (m2 < m1)\n\t\tm3 += 0x100000000ull;\n\n\tresult.m_low = (m0 & 0xffffffffull) | (m2 << 32);\n\tresult.m_high = m3 + (m2 >> 32);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_square(uint64_t *result, const uint64_t *left)\n{\n\tuint128_t r01 = { 0, 0 };\n\tuint64_t r2 = 0;\n\tint i, k;\n\n\tfor (k = 0; k < NUM_ECC_DIGITS * 2 - 1; k++) {\n\t\tunsigned int min;\n\n\t\tif (k < NUM_ECC_DIGITS)\n\t\t\tmin = 0;\n\t\telse\n\t\t\tmin = (k + 1) - NUM_ECC_DIGITS;\n\n\t\tfor (i = min; i <= k && i <= k - i; i++) {\n\t\t\tuint128_t product;\n\n\t\t\tproduct = mul_64_64(left[i], left[k - i]);\n\n\t\t\tif (i < k - i) {\n\t\t\t\tr2 += product.m_high >> 63;\n\t\t\t\tproduct.m_high = (product.m_high << 1) |\n\t\t\t\t\t\t\t(product.m_low >> 63);\n\t\t\t\tproduct.m_low <<= 1;\n\t\t\t}\n\n\t\t\tr01 = add_128_128(r01, product);\n\t\t\tr2 += (r01.m_high < product.m_high);\n\t\t}\n\n\t\tresult[k] = r01.m_low;\n\t\tr01.m_low = r01.m_high;\n\t\tr01.m_high = r2;\n\t\tr2 = 0;\n\t}\n\n\tresult[NUM_ECC_DIGITS * 2 - 1] = r01.m_low;\n}"
  },
  {
    "function_name": "vli_mult",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "312-346",
    "snippet": "static void vli_mult(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint128_t r01 = { 0, 0 };\n\tuint64_t r2 = 0;\n\tunsigned int i, k;\n\n\t/* Compute each digit of result in sequence, maintaining the\n\t * carries.\n\t */\n\tfor (k = 0; k < NUM_ECC_DIGITS * 2 - 1; k++) {\n\t\tunsigned int min;\n\n\t\tif (k < NUM_ECC_DIGITS)\n\t\t\tmin = 0;\n\t\telse\n\t\t\tmin = (k + 1) - NUM_ECC_DIGITS;\n\n\t\tfor (i = min; i <= k && i < NUM_ECC_DIGITS; i++) {\n\t\t\tuint128_t product;\n\n\t\t\tproduct = mul_64_64(left[i], right[k - i]);\n\n\t\t\tr01 = add_128_128(r01, product);\n\t\t\tr2 += (r01.m_high < product.m_high);\n\t\t}\n\n\t\tresult[k] = r01.m_low;\n\t\tr01.m_low = r01.m_high;\n\t\tr01.m_high = r2;\n\t\tr2 = 0;\n\t}\n\n\tresult[NUM_ECC_DIGITS * 2 - 1] = r01.m_low;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_128_128",
          "args": [
            "r01",
            "product"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "add_128_128",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "302-310",
          "snippet": "static uint128_t add_128_128(uint128_t a, uint128_t b)\n{\n\tuint128_t result;\n\n\tresult.m_low = a.m_low + b.m_low;\n\tresult.m_high = a.m_high + b.m_high + (result.m_low < a.m_low);\n\n\treturn result;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic uint128_t add_128_128(uint128_t a, uint128_t b)\n{\n\tuint128_t result;\n\n\tresult.m_low = a.m_low + b.m_low;\n\tresult.m_high = a.m_high + b.m_high + (result.m_low < a.m_low);\n\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mul_64_64",
          "args": [
            "left[i]",
            "right[k - i]"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "mul_64_64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "277-300",
          "snippet": "static uint128_t mul_64_64(uint64_t left, uint64_t right)\n{\n\tuint64_t a0 = left & 0xffffffffull;\n\tuint64_t a1 = left >> 32;\n\tuint64_t b0 = right & 0xffffffffull;\n\tuint64_t b1 = right >> 32;\n\tuint64_t m0 = a0 * b0;\n\tuint64_t m1 = a0 * b1;\n\tuint64_t m2 = a1 * b0;\n\tuint64_t m3 = a1 * b1;\n\tuint128_t result;\n\n\tm2 += (m0 >> 32);\n\tm2 += m1;\n\n\t/* Overflow */\n\tif (m2 < m1)\n\t\tm3 += 0x100000000ull;\n\n\tresult.m_low = (m0 & 0xffffffffull) | (m2 << 32);\n\tresult.m_high = m3 + (m2 >> 32);\n\n\treturn result;\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic uint128_t mul_64_64(uint64_t left, uint64_t right)\n{\n\tuint64_t a0 = left & 0xffffffffull;\n\tuint64_t a1 = left >> 32;\n\tuint64_t b0 = right & 0xffffffffull;\n\tuint64_t b1 = right >> 32;\n\tuint64_t m0 = a0 * b0;\n\tuint64_t m1 = a0 * b1;\n\tuint64_t m2 = a1 * b0;\n\tuint64_t m3 = a1 * b1;\n\tuint128_t result;\n\n\tm2 += (m0 >> 32);\n\tm2 += m1;\n\n\t/* Overflow */\n\tif (m2 < m1)\n\t\tm3 += 0x100000000ull;\n\n\tresult.m_low = (m0 & 0xffffffffull) | (m2 << 32);\n\tresult.m_high = m3 + (m2 >> 32);\n\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_mult(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint128_t r01 = { 0, 0 };\n\tuint64_t r2 = 0;\n\tunsigned int i, k;\n\n\t/* Compute each digit of result in sequence, maintaining the\n\t * carries.\n\t */\n\tfor (k = 0; k < NUM_ECC_DIGITS * 2 - 1; k++) {\n\t\tunsigned int min;\n\n\t\tif (k < NUM_ECC_DIGITS)\n\t\t\tmin = 0;\n\t\telse\n\t\t\tmin = (k + 1) - NUM_ECC_DIGITS;\n\n\t\tfor (i = min; i <= k && i < NUM_ECC_DIGITS; i++) {\n\t\t\tuint128_t product;\n\n\t\t\tproduct = mul_64_64(left[i], right[k - i]);\n\n\t\t\tr01 = add_128_128(r01, product);\n\t\t\tr2 += (r01.m_high < product.m_high);\n\t\t}\n\n\t\tresult[k] = r01.m_low;\n\t\tr01.m_low = r01.m_high;\n\t\tr01.m_high = r2;\n\t\tr2 = 0;\n\t}\n\n\tresult[NUM_ECC_DIGITS * 2 - 1] = r01.m_low;\n}"
  },
  {
    "function_name": "add_128_128",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "302-310",
    "snippet": "static uint128_t add_128_128(uint128_t a, uint128_t b)\n{\n\tuint128_t result;\n\n\tresult.m_low = a.m_low + b.m_low;\n\tresult.m_high = a.m_high + b.m_high + (result.m_low < a.m_low);\n\n\treturn result;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic uint128_t add_128_128(uint128_t a, uint128_t b)\n{\n\tuint128_t result;\n\n\tresult.m_low = a.m_low + b.m_low;\n\tresult.m_high = a.m_high + b.m_high + (result.m_low < a.m_low);\n\n\treturn result;\n}"
  },
  {
    "function_name": "mul_64_64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "277-300",
    "snippet": "static uint128_t mul_64_64(uint64_t left, uint64_t right)\n{\n\tuint64_t a0 = left & 0xffffffffull;\n\tuint64_t a1 = left >> 32;\n\tuint64_t b0 = right & 0xffffffffull;\n\tuint64_t b1 = right >> 32;\n\tuint64_t m0 = a0 * b0;\n\tuint64_t m1 = a0 * b1;\n\tuint64_t m2 = a1 * b0;\n\tuint64_t m3 = a1 * b1;\n\tuint128_t result;\n\n\tm2 += (m0 >> 32);\n\tm2 += m1;\n\n\t/* Overflow */\n\tif (m2 < m1)\n\t\tm3 += 0x100000000ull;\n\n\tresult.m_low = (m0 & 0xffffffffull) | (m2 << 32);\n\tresult.m_high = m3 + (m2 >> 32);\n\n\treturn result;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic uint128_t mul_64_64(uint64_t left, uint64_t right)\n{\n\tuint64_t a0 = left & 0xffffffffull;\n\tuint64_t a1 = left >> 32;\n\tuint64_t b0 = right & 0xffffffffull;\n\tuint64_t b1 = right >> 32;\n\tuint64_t m0 = a0 * b0;\n\tuint64_t m1 = a0 * b1;\n\tuint64_t m2 = a1 * b0;\n\tuint64_t m3 = a1 * b1;\n\tuint128_t result;\n\n\tm2 += (m0 >> 32);\n\tm2 += m1;\n\n\t/* Overflow */\n\tif (m2 < m1)\n\t\tm3 += 0x100000000ull;\n\n\tresult.m_low = (m0 & 0xffffffffull) | (m2 << 32);\n\tresult.m_high = m3 + (m2 >> 32);\n\n\treturn result;\n}"
  },
  {
    "function_name": "vli_sub",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "258-275",
    "snippet": "static uint64_t vli_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t borrow = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t diff;\n\n\t\tdiff = left[i] - right[i] - borrow;\n\t\tif (diff != left[i])\n\t\t\tborrow = (diff > left[i]);\n\n\t\tresult[i] = diff;\n\t}\n\n\treturn borrow;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_sub(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t borrow = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t diff;\n\n\t\tdiff = left[i] - right[i] - borrow;\n\t\tif (diff != left[i])\n\t\t\tborrow = (diff > left[i]);\n\n\t\tresult[i] = diff;\n\t}\n\n\treturn borrow;\n}"
  },
  {
    "function_name": "vli_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "238-255",
    "snippet": "static uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_add(uint64_t *result, const uint64_t *left,\n\t\t\t\t\t\t\tconst uint64_t *right)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t sum;\n\n\t\tsum = left[i] + right[i] + carry;\n\t\tif (sum != left[i])\n\t\t\tcarry = (sum < left[i]);\n\n\t\tresult[i] = sum;\n\t}\n\n\treturn carry;\n}"
  },
  {
    "function_name": "vli_rshift1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "223-235",
    "snippet": "static void vli_rshift1(uint64_t *vli)\n{\n\tuint64_t *end = vli;\n\tuint64_t carry = 0;\n\n\tvli += NUM_ECC_DIGITS;\n\n\twhile (vli-- > end) {\n\t\tuint64_t temp = *vli;\n\t\t*vli = (temp >> 1) | carry;\n\t\tcarry = temp << 63;\n\t}\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_rshift1(uint64_t *vli)\n{\n\tuint64_t *end = vli;\n\tuint64_t carry = 0;\n\n\tvli += NUM_ECC_DIGITS;\n\n\twhile (vli-- > end) {\n\t\tuint64_t temp = *vli;\n\t\t*vli = (temp >> 1) | carry;\n\t\tcarry = temp << 63;\n\t}\n}"
  },
  {
    "function_name": "vli_lshift",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "206-220",
    "snippet": "static uint64_t vli_lshift(uint64_t *result, const uint64_t *in,\n\t\t\t\t\t\t\tunsigned int shift)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t temp = in[i];\n\n\t\tresult[i] = (temp << shift) | carry;\n\t\tcarry = temp >> (64 - shift);\n\t}\n\n\treturn carry;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic uint64_t vli_lshift(uint64_t *result, const uint64_t *in,\n\t\t\t\t\t\t\tunsigned int shift)\n{\n\tuint64_t carry = 0;\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tuint64_t temp = in[i];\n\n\t\tresult[i] = (temp << shift) | carry;\n\t\tcarry = temp >> (64 - shift);\n\t}\n\n\treturn carry;\n}"
  },
  {
    "function_name": "vli_equal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "192-201",
    "snippet": "static bool vli_equal(const uint64_t *left, const uint64_t *right)\n{\n\tuint64_t diff = 0;\n\tint i;\n\n\tfor (i = NUM_ECC_DIGITS - 1; i >= 0; --i)\n\t\tdiff |= (left[i] ^ right[i]);\n\n\treturn (diff == 0);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic bool vli_equal(const uint64_t *left, const uint64_t *right)\n{\n\tuint64_t diff = 0;\n\tint i;\n\n\tfor (i = NUM_ECC_DIGITS - 1; i >= 0; --i)\n\t\tdiff |= (left[i] ^ right[i]);\n\n\treturn (diff == 0);\n}"
  },
  {
    "function_name": "vli_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "176-188",
    "snippet": "static int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic int vli_cmp(const uint64_t *left, const uint64_t *right)\n{\n    int i;\n\n    for (i = NUM_ECC_DIGITS - 1; i >= 0; i--) {\n\t    if (left[i] > right[i])\n\t\t    return 1;\n\t    else if (left[i] < right[i])\n\t\t    return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "vli_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "167-173",
    "snippet": "static void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_set(uint64_t *dest, const uint64_t *src)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tdest[i] = src[i];\n}"
  },
  {
    "function_name": "vli_num_bits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "150-164",
    "snippet": "static unsigned int vli_num_bits(const uint64_t *vli)\n{\n\tunsigned int i, num_digits;\n\tuint64_t digit;\n\n\tnum_digits = vli_num_digits(vli);\n\tif (num_digits == 0)\n\t\treturn 0;\n\n\tdigit = vli[num_digits - 1];\n\tfor (i = 0; digit; i++)\n\t\tdigit >>= 1;\n\n\treturn ((num_digits - 1) * 64 + i);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vli_num_digits",
          "args": [
            "vli"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "vli_num_digits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
          "lines": "136-147",
          "snippet": "static unsigned int vli_num_digits(const uint64_t *vli)\n{\n\tint i;\n\n\t/* Search from the end until we find a non-zero digit.\n\t * We do it in reverse because we expect that most digits will\n\t * be nonzero.\n\t */\n\tfor (i = NUM_ECC_DIGITS - 1; i >= 0 && vli[i] == 0; i--);\n\n\treturn (i + 1);\n}",
          "includes": [
            "#include \"ecc.h\"",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic unsigned int vli_num_digits(const uint64_t *vli)\n{\n\tint i;\n\n\t/* Search from the end until we find a non-zero digit.\n\t * We do it in reverse because we expect that most digits will\n\t * be nonzero.\n\t */\n\tfor (i = NUM_ECC_DIGITS - 1; i >= 0 && vli[i] == 0; i--);\n\n\treturn (i + 1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic unsigned int vli_num_bits(const uint64_t *vli)\n{\n\tunsigned int i, num_digits;\n\tuint64_t digit;\n\n\tnum_digits = vli_num_digits(vli);\n\tif (num_digits == 0)\n\t\treturn 0;\n\n\tdigit = vli[num_digits - 1];\n\tfor (i = 0; digit; i++)\n\t\tdigit >>= 1;\n\n\treturn ((num_digits - 1) * 64 + i);\n}"
  },
  {
    "function_name": "vli_num_digits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "136-147",
    "snippet": "static unsigned int vli_num_digits(const uint64_t *vli)\n{\n\tint i;\n\n\t/* Search from the end until we find a non-zero digit.\n\t * We do it in reverse because we expect that most digits will\n\t * be nonzero.\n\t */\n\tfor (i = NUM_ECC_DIGITS - 1; i >= 0 && vli[i] == 0; i--);\n\n\treturn (i + 1);\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic unsigned int vli_num_digits(const uint64_t *vli)\n{\n\tint i;\n\n\t/* Search from the end until we find a non-zero digit.\n\t * We do it in reverse because we expect that most digits will\n\t * be nonzero.\n\t */\n\tfor (i = NUM_ECC_DIGITS - 1; i >= 0 && vli[i] == 0; i--);\n\n\treturn (i + 1);\n}"
  },
  {
    "function_name": "vli_test_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "130-133",
    "snippet": "static uint64_t vli_test_bit(const uint64_t *vli, unsigned int bit)\n{\n\treturn (vli[bit / 64] & ((uint64_t) 1 << (bit % 64)));\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic uint64_t vli_test_bit(const uint64_t *vli, unsigned int bit)\n{\n\treturn (vli[bit / 64] & ((uint64_t) 1 << (bit % 64)));\n}"
  },
  {
    "function_name": "vli_is_zero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "117-127",
    "snippet": "static bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic bool vli_is_zero(const uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++) {\n\t\tif (vli[i])\n\t\t\treturn false;\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "vli_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "108-114",
    "snippet": "static void vli_clear(uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tvli[i] = 0;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define NUM_ECC_DIGITS (ECC_BYTES / 8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NUM_ECC_DIGITS (ECC_BYTES / 8)\n\nstatic void vli_clear(uint64_t *vli)\n{\n\tint i;\n\n\tfor (i = 0; i < NUM_ECC_DIGITS; i++)\n\t\tvli[i] = 0;\n}"
  },
  {
    "function_name": "get_random_number",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/ecc.c",
    "lines": "77-106",
    "snippet": "static bool get_random_number(uint64_t *vli)\n{\n\tchar *ptr = (char *) vli;\n\tsize_t left = ECC_BYTES;\n\tint fd;\n\n\tfd = open(\"/dev/urandom\", O_RDONLY | O_CLOEXEC);\n\tif (fd < 0) {\n\t\tfd = open(\"/dev/random\", O_RDONLY | O_CLOEXEC);\n\t\tif (fd < 0)\n\t\t\treturn false;\n\t}\n\n\twhile (left > 0) {\n\t\tssize_t ret;\n\n\t\tret = read(fd, ptr, left);\n\t\tif (ret <= 0) {\n\t\t\tclose(fd);\n\t\t\treturn false;\n\t\t}\n\n\t\tleft -= ret;\n\t\tptr += ret;\n\t}\n\n\tclose(fd);\n\n\treturn true;\n}",
    "includes": [
      "#include \"ecc.h\"",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define ECC_BYTES 32"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "hfp_context_close_container",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/hfp.c",
          "lines": "334-347",
          "snippet": "bool hfp_context_close_container(struct hfp_context *context)\n{\n\tskip_whitespace(context);\n\n\t/* The list shall be followed by a right parenthesis (\")\" V250 5.7.3.1*/\n\tif (context->data[context->offset] != ')')\n\t\treturn false;\n\n\tcontext->offset++;\n\n\tnext_field(context);\n\n\treturn true;\n}",
          "includes": [
            "#include \"src/shared/hfp.h\"",
            "#include \"src/shared/io.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/ringbuf.h\"",
            "#include \"src/shared/util.h\"",
            "#include <ctype.h>",
            "#include <stdarg.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/hfp.h\"\n#include \"src/shared/io.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/ringbuf.h\"\n#include \"src/shared/util.h\"\n#include <ctype.h>\n#include <stdarg.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <config.h>\n\nbool hfp_context_close_container(struct hfp_context *context)\n{\n\tskip_whitespace(context);\n\n\t/* The list shall be followed by a right parenthesis (\")\" V250 5.7.3.1*/\n\tif (context->data[context->offset] != ')')\n\t\treturn false;\n\n\tcontext->offset++;\n\n\tnext_field(context);\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "ptr",
            "left"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "notify_client_ready",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/gatt-client.c",
          "lines": "1221-1250",
          "snippet": "static void notify_client_ready(struct bt_gatt_client *client, bool success,\n\t\t\t\t\t\t\tuint8_t att_ecode)\n{\n\tconst struct queue_entry *entry;\n\n\tif (client->ready)\n\t\treturn;\n\n\tbt_gatt_client_ref(client);\n\tclient->ready = success;\n\n\tfor (entry = queue_get_entries(client->ready_cbs); entry;\n\t\t\t\t\t\t\tentry = entry->next) {\n\t\tstruct ready_cb *ready = entry->data;\n\n\t\tready->callback(success, att_ecode, ready->data);\n\t}\n\n\tqueue_remove_all(client->ready_cbs, NULL, NULL, ready_destroy);\n\n\t/* Notify clones */\n\tfor (entry = queue_get_entries(client->clones); entry;\n\t\t\t\t\t\t\tentry = entry->next) {\n\t\tstruct bt_gatt_client *clone = entry->data;\n\n\t\tnotify_client_ready(clone, success, att_ecode);\n\t}\n\n\tbt_gatt_client_unref(client);\n}",
          "includes": [
            "#include <sys/uio.h>",
            "#include <limits.h>",
            "#include <assert.h>",
            "#include \"src/shared/gatt-client.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/gatt-helpers.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include \"src/shared/att.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/uio.h>\n#include <limits.h>\n#include <assert.h>\n#include \"src/shared/gatt-client.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/gatt-helpers.h\"\n#include \"lib/uuid.h\"\n#include \"lib/bluetooth.h\"\n#include \"src/shared/att.h\"\n#include <config.h>\n\nstatic void notify_client_ready(struct bt_gatt_client *client, bool success,\n\t\t\t\t\t\t\tuint8_t att_ecode)\n{\n\tconst struct queue_entry *entry;\n\n\tif (client->ready)\n\t\treturn;\n\n\tbt_gatt_client_ref(client);\n\tclient->ready = success;\n\n\tfor (entry = queue_get_entries(client->ready_cbs); entry;\n\t\t\t\t\t\t\tentry = entry->next) {\n\t\tstruct ready_cb *ready = entry->data;\n\n\t\tready->callback(success, att_ecode, ready->data);\n\t}\n\n\tqueue_remove_all(client->ready_cbs, NULL, NULL, ready_destroy);\n\n\t/* Notify clones */\n\tfor (entry = queue_get_entries(client->clones); entry;\n\t\t\t\t\t\t\tentry = entry->next) {\n\t\tstruct bt_gatt_client *clone = entry->data;\n\n\t\tnotify_client_ready(clone, success, att_ecode);\n\t}\n\n\tbt_gatt_client_unref(client);\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "\"/dev/random\"",
            "O_RDONLY | O_CLOEXEC"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "btsnoop_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/btsnoop.c",
          "lines": "85-139",
          "snippet": "struct btsnoop *btsnoop_open(const char *path, unsigned long flags)\n{\n\tstruct btsnoop *btsnoop;\n\tstruct btsnoop_hdr hdr;\n\tssize_t len;\n\n\tbtsnoop = calloc(1, sizeof(*btsnoop));\n\tif (!btsnoop)\n\t\treturn NULL;\n\n\tbtsnoop->fd = open(path, O_RDONLY | O_CLOEXEC);\n\tif (btsnoop->fd < 0) {\n\t\tfree(btsnoop);\n\t\treturn NULL;\n\t}\n\n\tbtsnoop->flags = flags;\n\n\tlen = read(btsnoop->fd, &hdr, BTSNOOP_HDR_SIZE);\n\tif (len < 0 || len != BTSNOOP_HDR_SIZE)\n\t\tgoto failed;\n\n\tif (!memcmp(hdr.id, btsnoop_id, sizeof(btsnoop_id))) {\n\t\t/* Check for BTSnoop version 1 format */\n\t\tif (be32toh(hdr.version) != btsnoop_version)\n\t\t\tgoto failed;\n\n\t\tbtsnoop->format = be32toh(hdr.type);\n\t\tbtsnoop->index = 0xffff;\n\t} else {\n\t\tif (!(btsnoop->flags & BTSNOOP_FLAG_PKLG_SUPPORT))\n\t\t\tgoto failed;\n\n\t\t/* Check for Apple Packet Logger format */\n\t\tif (hdr.id[0] != 0x00 ||\n\t\t\t\t(hdr.id[1] != 0x00 && hdr.id[1] != 0x01))\n\t\t\tgoto failed;\n\n\t\tbtsnoop->format = BTSNOOP_FORMAT_MONITOR;\n\t\tbtsnoop->index = 0xffff;\n\t\tbtsnoop->pklg_format = true;\n\t\tbtsnoop->pklg_v2 = (hdr.id[1] == 0x01);\n\n\t\t/* Apple Packet Logger format has no header */\n\t\tlseek(btsnoop->fd, 0, SEEK_SET);\n\t}\n\n\treturn btsnoop_ref(btsnoop);\n\nfailed:\n\tclose(btsnoop->fd);\n\tfree(btsnoop);\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"src/shared/btsnoop.h\"",
            "#include <sys/stat.h>",
            "#include <arpa/inet.h>",
            "#include <limits.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <endian.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define BTSNOOP_HDR_SIZE (sizeof(struct btsnoop_hdr))"
          ],
          "globals_used": [
            "static const uint8_t btsnoop_id[] = { 0x62, 0x74, 0x73, 0x6e,\n\t\t\t\t      0x6f, 0x6f, 0x70, 0x00 };",
            "static const uint32_t btsnoop_version = 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/btsnoop.h\"\n#include <sys/stat.h>\n#include <arpa/inet.h>\n#include <limits.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <endian.h>\n#include <config.h>\n\n#define BTSNOOP_HDR_SIZE (sizeof(struct btsnoop_hdr))\n\nstatic const uint8_t btsnoop_id[] = { 0x62, 0x74, 0x73, 0x6e,\n\t\t\t\t      0x6f, 0x6f, 0x70, 0x00 };\nstatic const uint32_t btsnoop_version = 1;\n\nstruct btsnoop *btsnoop_open(const char *path, unsigned long flags)\n{\n\tstruct btsnoop *btsnoop;\n\tstruct btsnoop_hdr hdr;\n\tssize_t len;\n\n\tbtsnoop = calloc(1, sizeof(*btsnoop));\n\tif (!btsnoop)\n\t\treturn NULL;\n\n\tbtsnoop->fd = open(path, O_RDONLY | O_CLOEXEC);\n\tif (btsnoop->fd < 0) {\n\t\tfree(btsnoop);\n\t\treturn NULL;\n\t}\n\n\tbtsnoop->flags = flags;\n\n\tlen = read(btsnoop->fd, &hdr, BTSNOOP_HDR_SIZE);\n\tif (len < 0 || len != BTSNOOP_HDR_SIZE)\n\t\tgoto failed;\n\n\tif (!memcmp(hdr.id, btsnoop_id, sizeof(btsnoop_id))) {\n\t\t/* Check for BTSnoop version 1 format */\n\t\tif (be32toh(hdr.version) != btsnoop_version)\n\t\t\tgoto failed;\n\n\t\tbtsnoop->format = be32toh(hdr.type);\n\t\tbtsnoop->index = 0xffff;\n\t} else {\n\t\tif (!(btsnoop->flags & BTSNOOP_FLAG_PKLG_SUPPORT))\n\t\t\tgoto failed;\n\n\t\t/* Check for Apple Packet Logger format */\n\t\tif (hdr.id[0] != 0x00 ||\n\t\t\t\t(hdr.id[1] != 0x00 && hdr.id[1] != 0x01))\n\t\t\tgoto failed;\n\n\t\tbtsnoop->format = BTSNOOP_FORMAT_MONITOR;\n\t\tbtsnoop->index = 0xffff;\n\t\tbtsnoop->pklg_format = true;\n\t\tbtsnoop->pklg_v2 = (hdr.id[1] == 0x01);\n\n\t\t/* Apple Packet Logger format has no header */\n\t\tlseek(btsnoop->fd, 0, SEEK_SET);\n\t}\n\n\treturn btsnoop_ref(btsnoop);\n\nfailed:\n\tclose(btsnoop->fd);\n\tfree(btsnoop);\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ecc.h\"\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define ECC_BYTES 32\n\nstatic bool get_random_number(uint64_t *vli)\n{\n\tchar *ptr = (char *) vli;\n\tsize_t left = ECC_BYTES;\n\tint fd;\n\n\tfd = open(\"/dev/urandom\", O_RDONLY | O_CLOEXEC);\n\tif (fd < 0) {\n\t\tfd = open(\"/dev/random\", O_RDONLY | O_CLOEXEC);\n\t\tif (fd < 0)\n\t\t\treturn false;\n\t}\n\n\twhile (left > 0) {\n\t\tssize_t ret;\n\n\t\tret = read(fd, ptr, left);\n\t\tif (ret <= 0) {\n\t\t\tclose(fd);\n\t\t\treturn false;\n\t\t}\n\n\t\tleft -= ret;\n\t\tptr += ret;\n\t}\n\n\tclose(fd);\n\n\treturn true;\n}"
  }
]