[
  {
    "function_name": "timeout_remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/timeout-glib.c",
    "lines": "72-78",
    "snippet": "void timeout_remove(unsigned int id)\n{\n\tGSource *source = g_main_context_find_source_by_id(NULL, id);\n\n\tif (source)\n\t\tg_source_destroy(source);\n}",
    "includes": [
      "#include <glib.h>",
      "#include \"timeout.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_source_destroy",
          "args": [
            "source"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_main_context_find_source_by_id",
          "args": [
            "NULL",
            "id"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <glib.h>\n#include \"timeout.h\"\n\nvoid timeout_remove(unsigned int id)\n{\n\tGSource *source = g_main_context_find_source_by_id(NULL, id);\n\n\tif (source)\n\t\tg_source_destroy(source);\n}"
  },
  {
    "function_name": "timeout_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/timeout-glib.c",
    "lines": "50-70",
    "snippet": "unsigned int timeout_add(unsigned int timeout, timeout_func_t func,\n\t\t\tvoid *user_data, timeout_destroy_func_t destroy)\n{\n\tstruct timeout_data *data;\n\tguint id;\n\n\tdata = g_try_new0(struct timeout_data, 1);\n\tif (!data)\n\t\treturn 0;\n\n\tdata->func = func;\n\tdata->destroy = destroy;\n\tdata->user_data = user_data;\n\n\tid = g_timeout_add_full(G_PRIORITY_DEFAULT, timeout, timeout_callback,\n\t\t\t\t\t\tdata, timeout_destroy);\n\tif (!id)\n\t\tg_free(data);\n\n\treturn id;\n}",
    "includes": [
      "#include <glib.h>",
      "#include \"timeout.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "data"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_timeout_add_full",
          "args": [
            "G_PRIORITY_DEFAULT",
            "timeout",
            "timeout_callback",
            "data",
            "timeout_destroy"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_try_new0",
          "args": [
            "structtimeout_data",
            "1"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <glib.h>\n#include \"timeout.h\"\n\nunsigned int timeout_add(unsigned int timeout, timeout_func_t func,\n\t\t\tvoid *user_data, timeout_destroy_func_t destroy)\n{\n\tstruct timeout_data *data;\n\tguint id;\n\n\tdata = g_try_new0(struct timeout_data, 1);\n\tif (!data)\n\t\treturn 0;\n\n\tdata->func = func;\n\tdata->destroy = destroy;\n\tdata->user_data = user_data;\n\n\tid = g_timeout_add_full(G_PRIORITY_DEFAULT, timeout, timeout_callback,\n\t\t\t\t\t\tdata, timeout_destroy);\n\tif (!id)\n\t\tg_free(data);\n\n\treturn id;\n}"
  },
  {
    "function_name": "timeout_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/timeout-glib.c",
    "lines": "40-48",
    "snippet": "static void timeout_destroy(gpointer user_data)\n{\n\tstruct timeout_data *data = user_data;\n\n\tif (data->destroy)\n\t\tdata->destroy(data->user_data);\n\n\tg_free(data);\n}",
    "includes": [
      "#include <glib.h>",
      "#include \"timeout.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "data"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data->destroy",
          "args": [
            "data->user_data"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <glib.h>\n#include \"timeout.h\"\n\nstatic void timeout_destroy(gpointer user_data)\n{\n\tstruct timeout_data *data = user_data;\n\n\tif (data->destroy)\n\t\tdata->destroy(data->user_data);\n\n\tg_free(data);\n}"
  },
  {
    "function_name": "timeout_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/timeout-glib.c",
    "lines": "30-38",
    "snippet": "static gboolean timeout_callback(gpointer user_data)\n{\n\tstruct timeout_data *data  = user_data;\n\n\tif (data->func(data->user_data))\n\t\treturn TRUE;\n\n\treturn FALSE;\n}",
    "includes": [
      "#include <glib.h>",
      "#include \"timeout.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data->func",
          "args": [
            "data->user_data"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <glib.h>\n#include \"timeout.h\"\n\nstatic gboolean timeout_callback(gpointer user_data)\n{\n\tstruct timeout_data *data  = user_data;\n\n\tif (data->func(data->user_data))\n\t\treturn TRUE;\n\n\treturn FALSE;\n}"
  }
]