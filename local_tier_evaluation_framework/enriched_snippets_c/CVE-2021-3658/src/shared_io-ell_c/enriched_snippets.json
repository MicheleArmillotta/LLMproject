[
  {
    "function_name": "io_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-ell.c",
    "lines": "142-154",
    "snippet": "bool io_shutdown(struct io *io)\n{\n\tint fd;\n\n\tif (!io || !io->l_io)\n\t\treturn false;\n\n\tfd = l_io_get_fd(io->l_io);\n\tif (fd < 0)\n\t\treturn false;\n\n\treturn shutdown(fd, SHUT_RDWR) == 0;\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <ell/ell.h>",
      "#include <sys/socket.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shutdown",
          "args": [
            "fd",
            "SHUT_RDWR"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l_io_get_fd",
          "args": [
            "io->l_io"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <ell/ell.h>\n#include <sys/socket.h>\n#include <errno.h>\n#include <unistd.h>\n#include <config.h>\n\nbool io_shutdown(struct io *io)\n{\n\tint fd;\n\n\tif (!io || !io->l_io)\n\t\treturn false;\n\n\tfd = l_io_get_fd(io->l_io);\n\tif (fd < 0)\n\t\treturn false;\n\n\treturn shutdown(fd, SHUT_RDWR) == 0;\n}"
  },
  {
    "function_name": "io_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-ell.c",
    "lines": "120-140",
    "snippet": "ssize_t io_send(struct io *io, const struct iovec *iov, int iovcnt)\n{\n\tssize_t ret;\n\tint fd;\n\n\tif (!io || !io->l_io)\n\t\treturn -ENOTCONN;\n\n\tfd = l_io_get_fd(io->l_io);\n\tif (fd < 0)\n\t\treturn -ENOTCONN;\n\n\tdo {\n\t\tret = writev(fd, iov, iovcnt);\n\t} while (ret < 0 && errno == EINTR);\n\n\tif (ret < 0)\n\t\treturn -errno;\n\n\treturn ret;\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <ell/ell.h>",
      "#include <sys/socket.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writev",
          "args": [
            "fd",
            "iov",
            "iovcnt"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l_io_get_fd",
          "args": [
            "io->l_io"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <ell/ell.h>\n#include <sys/socket.h>\n#include <errno.h>\n#include <unistd.h>\n#include <config.h>\n\nssize_t io_send(struct io *io, const struct iovec *iov, int iovcnt)\n{\n\tssize_t ret;\n\tint fd;\n\n\tif (!io || !io->l_io)\n\t\treturn -ENOTCONN;\n\n\tfd = l_io_get_fd(io->l_io);\n\tif (fd < 0)\n\t\treturn -ENOTCONN;\n\n\tdo {\n\t\tret = writev(fd, iov, iovcnt);\n\t} while (ret < 0 && errno == EINTR);\n\n\tif (ret < 0)\n\t\treturn -errno;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "io_set_disconnect_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-ell.c",
    "lines": "110-118",
    "snippet": "bool io_set_disconnect_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\tif (!io || !io->l_io)\n\t\treturn false;\n\n\treturn l_io_set_disconnect_handler(io->l_io, (void *) callback,\n\t\t\t\t\t\t\tuser_data, destroy);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <ell/ell.h>",
      "#include <sys/socket.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "l_io_set_disconnect_handler",
          "args": [
            "io->l_io",
            "(void *) callback",
            "user_data",
            "destroy"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <ell/ell.h>\n#include <sys/socket.h>\n#include <errno.h>\n#include <unistd.h>\n#include <config.h>\n\nbool io_set_disconnect_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\tif (!io || !io->l_io)\n\t\treturn false;\n\n\treturn l_io_set_disconnect_handler(io->l_io, (void *) callback,\n\t\t\t\t\t\t\tuser_data, destroy);\n}"
  },
  {
    "function_name": "io_set_write_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-ell.c",
    "lines": "100-108",
    "snippet": "bool io_set_write_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\tif (!io || !io->l_io)\n\t\treturn false;\n\n\treturn l_io_set_write_handler(io->l_io, (l_io_write_cb_t) callback,\n\t\t\t\t\t\t\tuser_data, destroy);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <ell/ell.h>",
      "#include <sys/socket.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "l_io_set_write_handler",
          "args": [
            "io->l_io",
            "(l_io_write_cb_t) callback",
            "user_data",
            "destroy"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <ell/ell.h>\n#include <sys/socket.h>\n#include <errno.h>\n#include <unistd.h>\n#include <config.h>\n\nbool io_set_write_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\tif (!io || !io->l_io)\n\t\treturn false;\n\n\treturn l_io_set_write_handler(io->l_io, (l_io_write_cb_t) callback,\n\t\t\t\t\t\t\tuser_data, destroy);\n}"
  },
  {
    "function_name": "io_set_read_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-ell.c",
    "lines": "90-98",
    "snippet": "bool io_set_read_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\tif (!io || !io->l_io)\n\t\treturn false;\n\n\treturn l_io_set_read_handler(io->l_io, (l_io_read_cb_t) callback,\n\t\t\t\t\t\t\tuser_data, destroy);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <ell/ell.h>",
      "#include <sys/socket.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "l_io_set_read_handler",
          "args": [
            "io->l_io",
            "(l_io_read_cb_t) callback",
            "user_data",
            "destroy"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <ell/ell.h>\n#include <sys/socket.h>\n#include <errno.h>\n#include <unistd.h>\n#include <config.h>\n\nbool io_set_read_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\tif (!io || !io->l_io)\n\t\treturn false;\n\n\treturn l_io_set_read_handler(io->l_io, (l_io_read_cb_t) callback,\n\t\t\t\t\t\t\tuser_data, destroy);\n}"
  },
  {
    "function_name": "io_set_close_on_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-ell.c",
    "lines": "82-88",
    "snippet": "bool io_set_close_on_destroy(struct io *io, bool do_close)\n{\n\tif (!io || !io->l_io)\n\t\treturn false;\n\n\treturn l_io_set_close_on_destroy(io->l_io, do_close);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <ell/ell.h>",
      "#include <sys/socket.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "l_io_set_close_on_destroy",
          "args": [
            "io->l_io",
            "do_close"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <ell/ell.h>\n#include <sys/socket.h>\n#include <errno.h>\n#include <unistd.h>\n#include <config.h>\n\nbool io_set_close_on_destroy(struct io *io, bool do_close)\n{\n\tif (!io || !io->l_io)\n\t\treturn false;\n\n\treturn l_io_set_close_on_destroy(io->l_io, do_close);\n}"
  },
  {
    "function_name": "io_get_fd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-ell.c",
    "lines": "74-80",
    "snippet": "int io_get_fd(struct io *io)\n{\n\tif (!io || !io->l_io)\n\t\treturn -ENOTCONN;\n\n\treturn l_io_get_fd(io->l_io);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <ell/ell.h>",
      "#include <sys/socket.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "l_io_get_fd",
          "args": [
            "io->l_io"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <ell/ell.h>\n#include <sys/socket.h>\n#include <errno.h>\n#include <unistd.h>\n#include <config.h>\n\nint io_get_fd(struct io *io)\n{\n\tif (!io || !io->l_io)\n\t\treturn -ENOTCONN;\n\n\treturn l_io_get_fd(io->l_io);\n}"
  },
  {
    "function_name": "io_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-ell.c",
    "lines": "63-72",
    "snippet": "void io_destroy(struct io *io)\n{\n\tif (!io)\n\t\treturn;\n\n\tif (io->l_io)\n\t\tl_io_destroy(io->l_io);\n\n\tl_free(io);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <ell/ell.h>",
      "#include <sys/socket.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "l_free",
          "args": [
            "io"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "channel_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/attrib-server.c",
          "lines": "110-121",
          "snippet": "static void channel_free(struct gatt_channel *channel)\n{\n\n\tif (channel->cleanup_id)\n\t\tg_source_remove(channel->cleanup_id);\n\n\tif (channel->device)\n\t\tbtd_device_unref(channel->device);\n\n\tg_attrib_unref(channel->attrib);\n\tg_free(channel);\n}",
          "includes": [
            "#include \"attrib-server.h\"",
            "#include \"storage.h\"",
            "#include \"textfile.h\"",
            "#include \"attrib/att-database.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"btio/btio.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <sys/stat.h>",
            "#include <glib.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"attrib-server.h\"\n#include \"storage.h\"\n#include \"textfile.h\"\n#include \"attrib/att-database.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"src/shared/util.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"btio/btio.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <sys/stat.h>\n#include <glib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void channel_free(struct gatt_channel *channel)\n{\n\n\tif (channel->cleanup_id)\n\t\tg_source_remove(channel->cleanup_id);\n\n\tif (channel->device)\n\t\tbtd_device_unref(channel->device);\n\n\tg_attrib_unref(channel->attrib);\n\tg_free(channel);\n}"
        }
      },
      {
        "call_info": {
          "callee": "l_io_destroy",
          "args": [
            "io->l_io"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <ell/ell.h>\n#include <sys/socket.h>\n#include <errno.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid io_destroy(struct io *io)\n{\n\tif (!io)\n\t\treturn;\n\n\tif (io->l_io)\n\t\tl_io_destroy(io->l_io);\n\n\tl_free(io);\n}"
  },
  {
    "function_name": "io_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-ell.c",
    "lines": "40-61",
    "snippet": "struct io *io_new(int fd)\n{\n\tstruct io *io;\n\tstruct l_io *l_io;\n\n\tif (fd < 0)\n\t\treturn NULL;\n\n\tio = l_new(struct io, 1);\n\tif (!io)\n\t\treturn NULL;\n\n\tl_io = l_io_new(fd);\n\tif (!l_io) {\n\t\tl_free(io);\n\t\treturn NULL;\n\t}\n\n\tio->l_io = l_io;\n\n\treturn io;\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <ell/ell.h>",
      "#include <sys/socket.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "l_free",
          "args": [
            "io"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "channel_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/attrib-server.c",
          "lines": "110-121",
          "snippet": "static void channel_free(struct gatt_channel *channel)\n{\n\n\tif (channel->cleanup_id)\n\t\tg_source_remove(channel->cleanup_id);\n\n\tif (channel->device)\n\t\tbtd_device_unref(channel->device);\n\n\tg_attrib_unref(channel->attrib);\n\tg_free(channel);\n}",
          "includes": [
            "#include \"attrib-server.h\"",
            "#include \"storage.h\"",
            "#include \"textfile.h\"",
            "#include \"attrib/att-database.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"backtrace.h\"",
            "#include \"log.h\"",
            "#include \"btio/btio.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <sys/stat.h>",
            "#include <glib.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdbool.h>",
            "#include <stdint.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"attrib-server.h\"\n#include \"storage.h\"\n#include \"textfile.h\"\n#include \"attrib/att-database.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"src/shared/util.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"backtrace.h\"\n#include \"log.h\"\n#include \"btio/btio.h\"\n#include \"lib/uuid.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <sys/stat.h>\n#include <glib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdbool.h>\n#include <stdint.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void channel_free(struct gatt_channel *channel)\n{\n\n\tif (channel->cleanup_id)\n\t\tg_source_remove(channel->cleanup_id);\n\n\tif (channel->device)\n\t\tbtd_device_unref(channel->device);\n\n\tg_attrib_unref(channel->attrib);\n\tg_free(channel);\n}"
        }
      },
      {
        "call_info": {
          "callee": "l_io_new",
          "args": [
            "fd"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l_new",
          "args": [
            "structio",
            "1"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <ell/ell.h>\n#include <sys/socket.h>\n#include <errno.h>\n#include <unistd.h>\n#include <config.h>\n\nstruct io *io_new(int fd)\n{\n\tstruct io *io;\n\tstruct l_io *l_io;\n\n\tif (fd < 0)\n\t\treturn NULL;\n\n\tio = l_new(struct io, 1);\n\tif (!io)\n\t\treturn NULL;\n\n\tl_io = l_io_new(fd);\n\tif (!l_io) {\n\t\tl_free(io);\n\t\treturn NULL;\n\t}\n\n\tio->l_io = l_io;\n\n\treturn io;\n}"
  }
]