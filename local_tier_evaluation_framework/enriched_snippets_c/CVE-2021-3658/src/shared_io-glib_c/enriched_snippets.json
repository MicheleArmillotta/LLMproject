[
  {
    "function_name": "io_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "286-293",
    "snippet": "bool io_shutdown(struct io *io)\n{\n\tif (!io || !io->channel)\n\t\treturn false;\n\n\treturn g_io_channel_shutdown(io->channel, TRUE, NULL)\n\t\t\t\t\t\t\t== G_IO_STATUS_NORMAL;\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_io_channel_shutdown",
          "args": [
            "io->channel",
            "TRUE",
            "NULL"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nbool io_shutdown(struct io *io)\n{\n\tif (!io || !io->channel)\n\t\treturn false;\n\n\treturn g_io_channel_shutdown(io->channel, TRUE, NULL)\n\t\t\t\t\t\t\t== G_IO_STATUS_NORMAL;\n}"
  },
  {
    "function_name": "io_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "266-284",
    "snippet": "ssize_t io_send(struct io *io, const struct iovec *iov, int iovcnt)\n{\n\tint fd;\n\tssize_t ret;\n\n\tif (!io || !io->channel)\n\t\treturn -ENOTCONN;\n\n\tfd = io_get_fd(io);\n\n\tdo {\n\t\tret = writev(fd, iov, iovcnt);\n\t} while (ret < 0 && errno == EINTR);\n\n\tif (ret < 0)\n\t\treturn -errno;\n\n\treturn ret;\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writev",
          "args": [
            "fd",
            "iov",
            "iovcnt"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "io_get_fd",
          "args": [
            "io"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "io_get_fd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
          "lines": "137-143",
          "snippet": "int io_get_fd(struct io *io)\n{\n\tif (!io)\n\t\treturn -ENOTCONN;\n\n\treturn g_io_channel_unix_get_fd(io->channel);\n}",
          "includes": [
            "#include \"src/shared/io.h\"",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nint io_get_fd(struct io *io)\n{\n\tif (!io)\n\t\treturn -ENOTCONN;\n\n\treturn g_io_channel_unix_get_fd(io->channel);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nssize_t io_send(struct io *io, const struct iovec *iov, int iovcnt)\n{\n\tint fd;\n\tssize_t ret;\n\n\tif (!io || !io->channel)\n\t\treturn -ENOTCONN;\n\n\tfd = io_get_fd(io);\n\n\tdo {\n\t\tret = writev(fd, iov, iovcnt);\n\t} while (ret < 0 && errno == EINTR);\n\n\tif (ret < 0)\n\t\treturn -errno;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "io_set_disconnect_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "260-264",
    "snippet": "bool io_set_disconnect_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\treturn io_set_handler(io, G_IO_HUP, callback, user_data, destroy);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_set_handler",
          "args": [
            "io",
            "G_IO_HUP",
            "callback",
            "user_data",
            "destroy"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "io_set_handler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
          "lines": "207-246",
          "snippet": "static bool io_set_handler(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch **watch;\n\n\tif (!io)\n\t\treturn false;\n\n\tswitch (cond) {\n\tcase G_IO_IN:\n\t\twatch = &io->read_watch;\n\t\tbreak;\n\tcase G_IO_OUT:\n\t\twatch = &io->write_watch;\n\t\tbreak;\n\tcase G_IO_HUP:\n\t\twatch = &io->disconnect_watch;\n\t\tbreak;\n\tcase G_IO_PRI:\n\tcase G_IO_ERR:\n\tcase G_IO_NVAL:\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (*watch) {\n\t\tg_source_remove((*watch)->id);\n\t\t*watch = NULL;\n\t}\n\n\tif (!callback)\n\t\treturn true;\n\n\t*watch = watch_new(io, cond, callback, user_data, destroy);\n\tif (!*watch)\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include \"src/shared/io.h\"",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic bool io_set_handler(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch **watch;\n\n\tif (!io)\n\t\treturn false;\n\n\tswitch (cond) {\n\tcase G_IO_IN:\n\t\twatch = &io->read_watch;\n\t\tbreak;\n\tcase G_IO_OUT:\n\t\twatch = &io->write_watch;\n\t\tbreak;\n\tcase G_IO_HUP:\n\t\twatch = &io->disconnect_watch;\n\t\tbreak;\n\tcase G_IO_PRI:\n\tcase G_IO_ERR:\n\tcase G_IO_NVAL:\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (*watch) {\n\t\tg_source_remove((*watch)->id);\n\t\t*watch = NULL;\n\t}\n\n\tif (!callback)\n\t\treturn true;\n\n\t*watch = watch_new(io, cond, callback, user_data, destroy);\n\tif (!*watch)\n\t\treturn false;\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nbool io_set_disconnect_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\treturn io_set_handler(io, G_IO_HUP, callback, user_data, destroy);\n}"
  },
  {
    "function_name": "io_set_write_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "254-258",
    "snippet": "bool io_set_write_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\treturn io_set_handler(io, G_IO_OUT, callback, user_data, destroy);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_set_handler",
          "args": [
            "io",
            "G_IO_OUT",
            "callback",
            "user_data",
            "destroy"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "io_set_handler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
          "lines": "207-246",
          "snippet": "static bool io_set_handler(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch **watch;\n\n\tif (!io)\n\t\treturn false;\n\n\tswitch (cond) {\n\tcase G_IO_IN:\n\t\twatch = &io->read_watch;\n\t\tbreak;\n\tcase G_IO_OUT:\n\t\twatch = &io->write_watch;\n\t\tbreak;\n\tcase G_IO_HUP:\n\t\twatch = &io->disconnect_watch;\n\t\tbreak;\n\tcase G_IO_PRI:\n\tcase G_IO_ERR:\n\tcase G_IO_NVAL:\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (*watch) {\n\t\tg_source_remove((*watch)->id);\n\t\t*watch = NULL;\n\t}\n\n\tif (!callback)\n\t\treturn true;\n\n\t*watch = watch_new(io, cond, callback, user_data, destroy);\n\tif (!*watch)\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include \"src/shared/io.h\"",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic bool io_set_handler(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch **watch;\n\n\tif (!io)\n\t\treturn false;\n\n\tswitch (cond) {\n\tcase G_IO_IN:\n\t\twatch = &io->read_watch;\n\t\tbreak;\n\tcase G_IO_OUT:\n\t\twatch = &io->write_watch;\n\t\tbreak;\n\tcase G_IO_HUP:\n\t\twatch = &io->disconnect_watch;\n\t\tbreak;\n\tcase G_IO_PRI:\n\tcase G_IO_ERR:\n\tcase G_IO_NVAL:\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (*watch) {\n\t\tg_source_remove((*watch)->id);\n\t\t*watch = NULL;\n\t}\n\n\tif (!callback)\n\t\treturn true;\n\n\t*watch = watch_new(io, cond, callback, user_data, destroy);\n\tif (!*watch)\n\t\treturn false;\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nbool io_set_write_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\treturn io_set_handler(io, G_IO_OUT, callback, user_data, destroy);\n}"
  },
  {
    "function_name": "io_set_read_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "248-252",
    "snippet": "bool io_set_read_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\treturn io_set_handler(io, G_IO_IN, callback, user_data, destroy);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_set_handler",
          "args": [
            "io",
            "G_IO_IN",
            "callback",
            "user_data",
            "destroy"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "io_set_handler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
          "lines": "207-246",
          "snippet": "static bool io_set_handler(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch **watch;\n\n\tif (!io)\n\t\treturn false;\n\n\tswitch (cond) {\n\tcase G_IO_IN:\n\t\twatch = &io->read_watch;\n\t\tbreak;\n\tcase G_IO_OUT:\n\t\twatch = &io->write_watch;\n\t\tbreak;\n\tcase G_IO_HUP:\n\t\twatch = &io->disconnect_watch;\n\t\tbreak;\n\tcase G_IO_PRI:\n\tcase G_IO_ERR:\n\tcase G_IO_NVAL:\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (*watch) {\n\t\tg_source_remove((*watch)->id);\n\t\t*watch = NULL;\n\t}\n\n\tif (!callback)\n\t\treturn true;\n\n\t*watch = watch_new(io, cond, callback, user_data, destroy);\n\tif (!*watch)\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include \"src/shared/io.h\"",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic bool io_set_handler(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch **watch;\n\n\tif (!io)\n\t\treturn false;\n\n\tswitch (cond) {\n\tcase G_IO_IN:\n\t\twatch = &io->read_watch;\n\t\tbreak;\n\tcase G_IO_OUT:\n\t\twatch = &io->write_watch;\n\t\tbreak;\n\tcase G_IO_HUP:\n\t\twatch = &io->disconnect_watch;\n\t\tbreak;\n\tcase G_IO_PRI:\n\tcase G_IO_ERR:\n\tcase G_IO_NVAL:\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (*watch) {\n\t\tg_source_remove((*watch)->id);\n\t\t*watch = NULL;\n\t}\n\n\tif (!callback)\n\t\treturn true;\n\n\t*watch = watch_new(io, cond, callback, user_data, destroy);\n\tif (!*watch)\n\t\treturn false;\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nbool io_set_read_handler(struct io *io, io_callback_func_t callback,\n\t\t\t\tvoid *user_data, io_destroy_func_t destroy)\n{\n\treturn io_set_handler(io, G_IO_IN, callback, user_data, destroy);\n}"
  },
  {
    "function_name": "io_set_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "207-246",
    "snippet": "static bool io_set_handler(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch **watch;\n\n\tif (!io)\n\t\treturn false;\n\n\tswitch (cond) {\n\tcase G_IO_IN:\n\t\twatch = &io->read_watch;\n\t\tbreak;\n\tcase G_IO_OUT:\n\t\twatch = &io->write_watch;\n\t\tbreak;\n\tcase G_IO_HUP:\n\t\twatch = &io->disconnect_watch;\n\t\tbreak;\n\tcase G_IO_PRI:\n\tcase G_IO_ERR:\n\tcase G_IO_NVAL:\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (*watch) {\n\t\tg_source_remove((*watch)->id);\n\t\t*watch = NULL;\n\t}\n\n\tif (!callback)\n\t\treturn true;\n\n\t*watch = watch_new(io, cond, callback, user_data, destroy);\n\tif (!*watch)\n\t\treturn false;\n\n\treturn true;\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "watch_new",
          "args": [
            "io",
            "cond",
            "callback",
            "user_data",
            "destroy"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "watch_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
          "lines": "177-205",
          "snippet": "static struct io_watch *watch_new(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch *watch;\n\tint prio;\n\n\twatch = g_try_new0(struct io_watch, 1);\n\tif (!watch)\n\t\treturn NULL;\n\n\twatch->io = io_ref(io);\n\twatch->callback = callback;\n\twatch->destroy = destroy;\n\twatch->user_data = user_data;\n\n\tprio = cond == G_IO_HUP ? G_PRIORITY_DEFAULT_IDLE : G_PRIORITY_DEFAULT;\n\n\twatch->id = g_io_add_watch_full(io->channel, prio,\n\t\t\t\t\t\tcond | G_IO_ERR | G_IO_NVAL,\n\t\t\t\t\t\twatch_callback, watch,\n\t\t\t\t\t\twatch_destroy);\n\tif (watch->id == 0) {\n\t\twatch_destroy(watch);\n\t\treturn NULL;\n\t}\n\n\treturn watch;\n}",
          "includes": [
            "#include \"src/shared/io.h\"",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic struct io_watch *watch_new(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch *watch;\n\tint prio;\n\n\twatch = g_try_new0(struct io_watch, 1);\n\tif (!watch)\n\t\treturn NULL;\n\n\twatch->io = io_ref(io);\n\twatch->callback = callback;\n\twatch->destroy = destroy;\n\twatch->user_data = user_data;\n\n\tprio = cond == G_IO_HUP ? G_PRIORITY_DEFAULT_IDLE : G_PRIORITY_DEFAULT;\n\n\twatch->id = g_io_add_watch_full(io->channel, prio,\n\t\t\t\t\t\tcond | G_IO_ERR | G_IO_NVAL,\n\t\t\t\t\t\twatch_callback, watch,\n\t\t\t\t\t\twatch_destroy);\n\tif (watch->id == 0) {\n\t\twatch_destroy(watch);\n\t\treturn NULL;\n\t}\n\n\treturn watch;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_source_remove",
          "args": [
            "(*watch)->id"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic bool io_set_handler(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch **watch;\n\n\tif (!io)\n\t\treturn false;\n\n\tswitch (cond) {\n\tcase G_IO_IN:\n\t\twatch = &io->read_watch;\n\t\tbreak;\n\tcase G_IO_OUT:\n\t\twatch = &io->write_watch;\n\t\tbreak;\n\tcase G_IO_HUP:\n\t\twatch = &io->disconnect_watch;\n\t\tbreak;\n\tcase G_IO_PRI:\n\tcase G_IO_ERR:\n\tcase G_IO_NVAL:\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (*watch) {\n\t\tg_source_remove((*watch)->id);\n\t\t*watch = NULL;\n\t}\n\n\tif (!callback)\n\t\treturn true;\n\n\t*watch = watch_new(io, cond, callback, user_data, destroy);\n\tif (!*watch)\n\t\treturn false;\n\n\treturn true;\n}"
  },
  {
    "function_name": "watch_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "177-205",
    "snippet": "static struct io_watch *watch_new(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch *watch;\n\tint prio;\n\n\twatch = g_try_new0(struct io_watch, 1);\n\tif (!watch)\n\t\treturn NULL;\n\n\twatch->io = io_ref(io);\n\twatch->callback = callback;\n\twatch->destroy = destroy;\n\twatch->user_data = user_data;\n\n\tprio = cond == G_IO_HUP ? G_PRIORITY_DEFAULT_IDLE : G_PRIORITY_DEFAULT;\n\n\twatch->id = g_io_add_watch_full(io->channel, prio,\n\t\t\t\t\t\tcond | G_IO_ERR | G_IO_NVAL,\n\t\t\t\t\t\twatch_callback, watch,\n\t\t\t\t\t\twatch_destroy);\n\tif (watch->id == 0) {\n\t\twatch_destroy(watch);\n\t\treturn NULL;\n\t}\n\n\treturn watch;\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "watch_destroy",
          "args": [
            "watch"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "watch_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
          "lines": "92-109",
          "snippet": "static void watch_destroy(void *user_data)\n{\n\tstruct io_watch *watch = user_data;\n\tstruct io *io = watch->io;\n\n\tif (watch == io->read_watch)\n\t\tio->read_watch = NULL;\n\telse if (watch == io->write_watch)\n\t\tio->write_watch = NULL;\n\telse if (watch == io->disconnect_watch)\n\t\tio->disconnect_watch = NULL;\n\n\tif (watch->destroy)\n\t\twatch->destroy(watch->user_data);\n\n\tio_unref(watch->io);\n\tg_free(watch);\n}",
          "includes": [
            "#include \"src/shared/io.h\"",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void watch_destroy(void *user_data)\n{\n\tstruct io_watch *watch = user_data;\n\tstruct io *io = watch->io;\n\n\tif (watch == io->read_watch)\n\t\tio->read_watch = NULL;\n\telse if (watch == io->write_watch)\n\t\tio->write_watch = NULL;\n\telse if (watch == io->disconnect_watch)\n\t\tio->disconnect_watch = NULL;\n\n\tif (watch->destroy)\n\t\twatch->destroy(watch->user_data);\n\n\tio_unref(watch->io);\n\tg_free(watch);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_io_add_watch_full",
          "args": [
            "io->channel",
            "prio",
            "cond | G_IO_ERR | G_IO_NVAL",
            "watch_callback",
            "watch",
            "watch_destroy"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "io_ref",
          "args": [
            "io"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "io_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
          "lines": "50-58",
          "snippet": "static struct io *io_ref(struct io *io)\n{\n\tif (!io)\n\t\treturn NULL;\n\n\t__sync_fetch_and_add(&io->ref_count, 1);\n\n\treturn io;\n}",
          "includes": [
            "#include \"src/shared/io.h\"",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic struct io *io_ref(struct io *io)\n{\n\tif (!io)\n\t\treturn NULL;\n\n\t__sync_fetch_and_add(&io->ref_count, 1);\n\n\treturn io;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_try_new0",
          "args": [
            "structio_watch",
            "1"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic struct io_watch *watch_new(struct io *io, GIOCondition cond,\n\t\t\t\tio_callback_func_t callback, void *user_data,\n\t\t\t\tio_destroy_func_t destroy)\n{\n\tstruct io_watch *watch;\n\tint prio;\n\n\twatch = g_try_new0(struct io_watch, 1);\n\tif (!watch)\n\t\treturn NULL;\n\n\twatch->io = io_ref(io);\n\twatch->callback = callback;\n\twatch->destroy = destroy;\n\twatch->user_data = user_data;\n\n\tprio = cond == G_IO_HUP ? G_PRIORITY_DEFAULT_IDLE : G_PRIORITY_DEFAULT;\n\n\twatch->id = g_io_add_watch_full(io->channel, prio,\n\t\t\t\t\t\tcond | G_IO_ERR | G_IO_NVAL,\n\t\t\t\t\t\twatch_callback, watch,\n\t\t\t\t\t\twatch_destroy);\n\tif (watch->id == 0) {\n\t\twatch_destroy(watch);\n\t\treturn NULL;\n\t}\n\n\treturn watch;\n}"
  },
  {
    "function_name": "watch_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "158-175",
    "snippet": "static gboolean watch_callback(GIOChannel *channel, GIOCondition cond,\n\t\t\t\t\t\t\tgpointer user_data)\n{\n\tstruct io_watch *watch = user_data;\n\tbool result, destroy;\n\n\tdestroy = watch == watch->io->disconnect_watch;\n\n\tif (!destroy && (cond & (G_IO_ERR | G_IO_NVAL)))\n\t\treturn FALSE;\n\n\tif (watch->callback)\n\t\tresult = watch->callback(watch->io, watch->user_data);\n\telse\n\t\tresult = false;\n\n\treturn result ? TRUE : FALSE;\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "watch->callback",
          "args": [
            "watch->io",
            "watch->user_data"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic gboolean watch_callback(GIOChannel *channel, GIOCondition cond,\n\t\t\t\t\t\t\tgpointer user_data)\n{\n\tstruct io_watch *watch = user_data;\n\tbool result, destroy;\n\n\tdestroy = watch == watch->io->disconnect_watch;\n\n\tif (!destroy && (cond & (G_IO_ERR | G_IO_NVAL)))\n\t\treturn FALSE;\n\n\tif (watch->callback)\n\t\tresult = watch->callback(watch->io, watch->user_data);\n\telse\n\t\tresult = false;\n\n\treturn result ? TRUE : FALSE;\n}"
  },
  {
    "function_name": "io_set_close_on_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "145-156",
    "snippet": "bool io_set_close_on_destroy(struct io *io, bool do_close)\n{\n\tif (!io)\n\t\treturn false;\n\n\tif (do_close)\n\t\tg_io_channel_set_close_on_unref(io->channel, TRUE);\n\telse\n\t\tg_io_channel_set_close_on_unref(io->channel, FALSE);\n\n\treturn true;\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_io_channel_set_close_on_unref",
          "args": [
            "io->channel",
            "FALSE"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_set_close_on_unref",
          "args": [
            "io->channel",
            "TRUE"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nbool io_set_close_on_destroy(struct io *io, bool do_close)\n{\n\tif (!io)\n\t\treturn false;\n\n\tif (do_close)\n\t\tg_io_channel_set_close_on_unref(io->channel, TRUE);\n\telse\n\t\tg_io_channel_set_close_on_unref(io->channel, FALSE);\n\n\treturn true;\n}"
  },
  {
    "function_name": "io_get_fd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "137-143",
    "snippet": "int io_get_fd(struct io *io)\n{\n\tif (!io)\n\t\treturn -ENOTCONN;\n\n\treturn g_io_channel_unix_get_fd(io->channel);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_io_channel_unix_get_fd",
          "args": [
            "io->channel"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nint io_get_fd(struct io *io)\n{\n\tif (!io)\n\t\treturn -ENOTCONN;\n\n\treturn g_io_channel_unix_get_fd(io->channel);\n}"
  },
  {
    "function_name": "io_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "111-135",
    "snippet": "void io_destroy(struct io *io)\n{\n\tif (!io)\n\t\treturn;\n\n\tif (io->read_watch) {\n\t\tg_source_remove(io->read_watch->id);\n\t\tio->read_watch = NULL;\n\t}\n\n\tif (io->write_watch) {\n\t\tg_source_remove(io->write_watch->id);\n\t\tio->write_watch = NULL;\n\t}\n\n\tif (io->disconnect_watch) {\n\t\tg_source_remove(io->disconnect_watch->id);\n\t\tio->disconnect_watch = NULL;\n\t}\n\n\tg_io_channel_unref(io->channel);\n\tio->channel = NULL;\n\n\tio_unref(io);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_unref",
          "args": [
            "io"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "io_unref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
          "lines": "60-69",
          "snippet": "static void io_unref(struct io *io)\n{\n\tif (!io)\n\t\treturn;\n\n\tif (__sync_sub_and_fetch(&io->ref_count, 1))\n\t\treturn;\n\n\tg_free(io);\n}",
          "includes": [
            "#include \"src/shared/io.h\"",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void io_unref(struct io *io)\n{\n\tif (!io)\n\t\treturn;\n\n\tif (__sync_sub_and_fetch(&io->ref_count, 1))\n\t\treturn;\n\n\tg_free(io);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_io_channel_unref",
          "args": [
            "io->channel"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_source_remove",
          "args": [
            "io->disconnect_watch->id"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_source_remove",
          "args": [
            "io->write_watch->id"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_source_remove",
          "args": [
            "io->read_watch->id"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nvoid io_destroy(struct io *io)\n{\n\tif (!io)\n\t\treturn;\n\n\tif (io->read_watch) {\n\t\tg_source_remove(io->read_watch->id);\n\t\tio->read_watch = NULL;\n\t}\n\n\tif (io->write_watch) {\n\t\tg_source_remove(io->write_watch->id);\n\t\tio->write_watch = NULL;\n\t}\n\n\tif (io->disconnect_watch) {\n\t\tg_source_remove(io->disconnect_watch->id);\n\t\tio->disconnect_watch = NULL;\n\t}\n\n\tg_io_channel_unref(io->channel);\n\tio->channel = NULL;\n\n\tio_unref(io);\n}"
  },
  {
    "function_name": "watch_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "92-109",
    "snippet": "static void watch_destroy(void *user_data)\n{\n\tstruct io_watch *watch = user_data;\n\tstruct io *io = watch->io;\n\n\tif (watch == io->read_watch)\n\t\tio->read_watch = NULL;\n\telse if (watch == io->write_watch)\n\t\tio->write_watch = NULL;\n\telse if (watch == io->disconnect_watch)\n\t\tio->disconnect_watch = NULL;\n\n\tif (watch->destroy)\n\t\twatch->destroy(watch->user_data);\n\n\tio_unref(watch->io);\n\tg_free(watch);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "watch"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "io_unref",
          "args": [
            "watch->io"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "io_unref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
          "lines": "60-69",
          "snippet": "static void io_unref(struct io *io)\n{\n\tif (!io)\n\t\treturn;\n\n\tif (__sync_sub_and_fetch(&io->ref_count, 1))\n\t\treturn;\n\n\tg_free(io);\n}",
          "includes": [
            "#include \"src/shared/io.h\"",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void io_unref(struct io *io)\n{\n\tif (!io)\n\t\treturn;\n\n\tif (__sync_sub_and_fetch(&io->ref_count, 1))\n\t\treturn;\n\n\tg_free(io);\n}"
        }
      },
      {
        "call_info": {
          "callee": "watch->destroy",
          "args": [
            "watch->user_data"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void watch_destroy(void *user_data)\n{\n\tstruct io_watch *watch = user_data;\n\tstruct io *io = watch->io;\n\n\tif (watch == io->read_watch)\n\t\tio->read_watch = NULL;\n\telse if (watch == io->write_watch)\n\t\tio->write_watch = NULL;\n\telse if (watch == io->disconnect_watch)\n\t\tio->disconnect_watch = NULL;\n\n\tif (watch->destroy)\n\t\twatch->destroy(watch->user_data);\n\n\tio_unref(watch->io);\n\tg_free(watch);\n}"
  },
  {
    "function_name": "io_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "71-90",
    "snippet": "struct io *io_new(int fd)\n{\n\tstruct io *io;\n\n\tif (fd < 0)\n\t\treturn NULL;\n\n\tio = g_try_new0(struct io, 1);\n\tif (!io)\n\t\treturn NULL;\n\n\tio->channel = g_io_channel_unix_new(fd);\n\n\tg_io_channel_set_encoding(io->channel, NULL, NULL);\n\tg_io_channel_set_buffered(io->channel, FALSE);\n\n\tg_io_channel_set_close_on_unref(io->channel, FALSE);\n\n\treturn io_ref(io);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_ref",
          "args": [
            "io"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "io_ref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
          "lines": "50-58",
          "snippet": "static struct io *io_ref(struct io *io)\n{\n\tif (!io)\n\t\treturn NULL;\n\n\t__sync_fetch_and_add(&io->ref_count, 1);\n\n\treturn io;\n}",
          "includes": [
            "#include \"src/shared/io.h\"",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic struct io *io_ref(struct io *io)\n{\n\tif (!io)\n\t\treturn NULL;\n\n\t__sync_fetch_and_add(&io->ref_count, 1);\n\n\treturn io;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_io_channel_set_close_on_unref",
          "args": [
            "io->channel",
            "FALSE"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_set_buffered",
          "args": [
            "io->channel",
            "FALSE"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_set_encoding",
          "args": [
            "io->channel",
            "NULL",
            "NULL"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_io_channel_unix_new",
          "args": [
            "fd"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_try_new0",
          "args": [
            "structio",
            "1"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstruct io *io_new(int fd)\n{\n\tstruct io *io;\n\n\tif (fd < 0)\n\t\treturn NULL;\n\n\tio = g_try_new0(struct io, 1);\n\tif (!io)\n\t\treturn NULL;\n\n\tio->channel = g_io_channel_unix_new(fd);\n\n\tg_io_channel_set_encoding(io->channel, NULL, NULL);\n\tg_io_channel_set_buffered(io->channel, FALSE);\n\n\tg_io_channel_set_close_on_unref(io->channel, FALSE);\n\n\treturn io_ref(io);\n}"
  },
  {
    "function_name": "io_unref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "60-69",
    "snippet": "static void io_unref(struct io *io)\n{\n\tif (!io)\n\t\treturn;\n\n\tif (__sync_sub_and_fetch(&io->ref_count, 1))\n\t\treturn;\n\n\tg_free(io);\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "io"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__sync_sub_and_fetch",
          "args": [
            "&io->ref_count",
            "1"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic void io_unref(struct io *io)\n{\n\tif (!io)\n\t\treturn;\n\n\tif (__sync_sub_and_fetch(&io->ref_count, 1))\n\t\treturn;\n\n\tg_free(io);\n}"
  },
  {
    "function_name": "io_ref",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/shared/io-glib.c",
    "lines": "50-58",
    "snippet": "static struct io *io_ref(struct io *io)\n{\n\tif (!io)\n\t\treturn NULL;\n\n\t__sync_fetch_and_add(&io->ref_count, 1);\n\n\treturn io;\n}",
    "includes": [
      "#include \"src/shared/io.h\"",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__sync_fetch_and_add",
          "args": [
            "&io->ref_count",
            "1"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"src/shared/io.h\"\n#include <glib.h>\n#include <errno.h>\n#include <config.h>\n\nstatic struct io *io_ref(struct io *io)\n{\n\tif (!io)\n\t\treturn NULL;\n\n\t__sync_fetch_and_add(&io->ref_count, 1);\n\n\treturn io;\n}"
  }
]