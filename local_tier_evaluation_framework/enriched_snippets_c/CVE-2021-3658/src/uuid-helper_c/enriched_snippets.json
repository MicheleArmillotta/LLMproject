[
  {
    "function_name": "bt_string2uuid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
    "lines": "211-247",
    "snippet": "int bt_string2uuid(uuid_t *uuid, const char *string)\n{\n\tuint32_t data0, data4;\n\tuint16_t data1, data2, data3, data5;\n\n\tif (is_uuid128(string) &&\n\t\t\tsscanf(string, \"%08x-%04hx-%04hx-%04hx-%08x%04hx\",\n\t\t\t\t&data0, &data1, &data2, &data3, &data4, &data5) == 6) {\n\t\tuint8_t val[16];\n\n\t\tdata0 = htonl(data0);\n\t\tdata1 = htons(data1);\n\t\tdata2 = htons(data2);\n\t\tdata3 = htons(data3);\n\t\tdata4 = htonl(data4);\n\t\tdata5 = htons(data5);\n\n\t\tmemcpy(&val[0], &data0, 4);\n\t\tmemcpy(&val[4], &data1, 2);\n\t\tmemcpy(&val[6], &data2, 2);\n\t\tmemcpy(&val[8], &data3, 2);\n\t\tmemcpy(&val[10], &data4, 4);\n\t\tmemcpy(&val[14], &data5, 2);\n\n\t\tsdp_uuid128_create(uuid, val);\n\n\t\treturn 0;\n\t} else {\n\t\tuint16_t class = name2class(string);\n\t\tif (class) {\n\t\t\tsdp_uuid16_create(uuid, class);\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn string2uuid16(uuid, string);\n\t}\n}",
    "includes": [
      "#include \"uuid-helper.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <arpa/inet.h>",
      "#include <errno.h>",
      "#include <stdbool.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "string2uuid16",
          "args": [
            "uuid",
            "string"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "string2uuid16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
          "lines": "163-179",
          "snippet": "static int string2uuid16(uuid_t *uuid, const char *string)\n{\n\tint length = strlen(string);\n\tchar *endptr = NULL;\n\tuint16_t u16;\n\n\tif (length != 4 && length != 6)\n\t\treturn -EINVAL;\n\n\tu16 = strtol(string, &endptr, 16);\n\tif (endptr && *endptr == '\\0') {\n\t\tsdp_uuid16_create(uuid, u16);\n\t\treturn 0;\n\t}\n\n\treturn -EINVAL;\n}",
          "includes": [
            "#include \"uuid-helper.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <arpa/inet.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic int string2uuid16(uuid_t *uuid, const char *string)\n{\n\tint length = strlen(string);\n\tchar *endptr = NULL;\n\tuint16_t u16;\n\n\tif (length != 4 && length != 6)\n\t\treturn -EINVAL;\n\n\tu16 = strtol(string, &endptr, 16);\n\tif (endptr && *endptr == '\\0') {\n\t\tsdp_uuid16_create(uuid, u16);\n\t\treturn 0;\n\t}\n\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_uuid16_create",
          "args": [
            "uuid",
            "class"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name2class",
          "args": [
            "string"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "name2class",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
          "lines": "142-152",
          "snippet": "static uint16_t name2class(const char *pattern)\n{\n\tint i;\n\n\tfor (i = 0; bt_services[i].name; i++) {\n\t\tif (strcasecmp(bt_services[i].name, pattern) == 0)\n\t\t\treturn bt_services[i].class;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"uuid-helper.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <arpa/inet.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct {\n\tconst char\t*name;\n\tuint16_t\tclass;\n} bt_services[] = {\n\t{ \"pbap\",\tPBAP_SVCLASS_ID\t\t\t},\n\t{ \"sap\",\tSAP_SVCLASS_ID\t\t\t},\n\t{ \"ftp\",\tOBEX_FILETRANS_SVCLASS_ID\t},\n\t{ \"bpp\",\tBASIC_PRINTING_SVCLASS_ID\t},\n\t{ \"bip\",\tIMAGING_SVCLASS_ID\t\t},\n\t{ \"synch\",\tIRMC_SYNC_SVCLASS_ID\t\t},\n\t{ \"dun\",\tDIALUP_NET_SVCLASS_ID\t\t},\n\t{ \"opp\",\tOBEX_OBJPUSH_SVCLASS_ID\t\t},\n\t{ \"fax\",\tFAX_SVCLASS_ID\t\t\t},\n\t{ \"spp\",\tSERIAL_PORT_SVCLASS_ID\t\t},\n\t{ \"hsp\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-hs\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-ag\",\tHEADSET_AGW_SVCLASS_ID\t\t},\n\t{ \"hfp\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-hf\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-ag\",\tHANDSFREE_AGW_SVCLASS_ID\t},\n\t{ \"pbap-pce\",\tPBAP_PCE_SVCLASS_ID\t\t},\n\t{ \"pbap-pse\",\tPBAP_PSE_SVCLASS_ID\t\t},\n\t{ \"map-mse\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mas\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mce\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"map-mns\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"gnss\",\tGNSS_SERVER_SVCLASS_ID\t\t},\n\t{ }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic struct {\n\tconst char\t*name;\n\tuint16_t\tclass;\n} bt_services[] = {\n\t{ \"pbap\",\tPBAP_SVCLASS_ID\t\t\t},\n\t{ \"sap\",\tSAP_SVCLASS_ID\t\t\t},\n\t{ \"ftp\",\tOBEX_FILETRANS_SVCLASS_ID\t},\n\t{ \"bpp\",\tBASIC_PRINTING_SVCLASS_ID\t},\n\t{ \"bip\",\tIMAGING_SVCLASS_ID\t\t},\n\t{ \"synch\",\tIRMC_SYNC_SVCLASS_ID\t\t},\n\t{ \"dun\",\tDIALUP_NET_SVCLASS_ID\t\t},\n\t{ \"opp\",\tOBEX_OBJPUSH_SVCLASS_ID\t\t},\n\t{ \"fax\",\tFAX_SVCLASS_ID\t\t\t},\n\t{ \"spp\",\tSERIAL_PORT_SVCLASS_ID\t\t},\n\t{ \"hsp\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-hs\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-ag\",\tHEADSET_AGW_SVCLASS_ID\t\t},\n\t{ \"hfp\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-hf\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-ag\",\tHANDSFREE_AGW_SVCLASS_ID\t},\n\t{ \"pbap-pce\",\tPBAP_PCE_SVCLASS_ID\t\t},\n\t{ \"pbap-pse\",\tPBAP_PSE_SVCLASS_ID\t\t},\n\t{ \"map-mse\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mas\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mce\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"map-mns\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"gnss\",\tGNSS_SERVER_SVCLASS_ID\t\t},\n\t{ }\n};\n\nstatic uint16_t name2class(const char *pattern)\n{\n\tint i;\n\n\tfor (i = 0; bt_services[i].name; i++) {\n\t\tif (strcasecmp(bt_services[i].name, pattern) == 0)\n\t\t\treturn bt_services[i].class;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_uuid128_create",
          "args": [
            "uuid",
            "val"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&val[14]",
            "&data5",
            "2"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&val[10]",
            "&data4",
            "4"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&val[8]",
            "&data3",
            "2"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&val[6]",
            "&data2",
            "2"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&val[4]",
            "&data1",
            "2"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&val[0]",
            "&data0",
            "4"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htons",
          "args": [
            "data5"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "data4"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htons",
          "args": [
            "data3"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htons",
          "args": [
            "data2"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htons",
          "args": [
            "data1"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "data0"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "string",
            "\"%08x-%04hx-%04hx-%04hx-%08x%04hx\"",
            "&data0",
            "&data1",
            "&data2",
            "&data3",
            "&data4",
            "&data5"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_uuid128",
          "args": [
            "string"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "is_uuid128",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
          "lines": "154-161",
          "snippet": "static inline bool is_uuid128(const char *string)\n{\n\treturn (strlen(string) == 36 &&\n\t\t\tstring[8] == '-' &&\n\t\t\tstring[13] == '-' &&\n\t\t\tstring[18] == '-' &&\n\t\t\tstring[23] == '-');\n}",
          "includes": [
            "#include \"uuid-helper.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <arpa/inet.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic inline bool is_uuid128(const char *string)\n{\n\treturn (strlen(string) == 36 &&\n\t\t\tstring[8] == '-' &&\n\t\t\tstring[13] == '-' &&\n\t\t\tstring[18] == '-' &&\n\t\t\tstring[23] == '-');\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nint bt_string2uuid(uuid_t *uuid, const char *string)\n{\n\tuint32_t data0, data4;\n\tuint16_t data1, data2, data3, data5;\n\n\tif (is_uuid128(string) &&\n\t\t\tsscanf(string, \"%08x-%04hx-%04hx-%04hx-%08x%04hx\",\n\t\t\t\t&data0, &data1, &data2, &data3, &data4, &data5) == 6) {\n\t\tuint8_t val[16];\n\n\t\tdata0 = htonl(data0);\n\t\tdata1 = htons(data1);\n\t\tdata2 = htons(data2);\n\t\tdata3 = htons(data3);\n\t\tdata4 = htonl(data4);\n\t\tdata5 = htons(data5);\n\n\t\tmemcpy(&val[0], &data0, 4);\n\t\tmemcpy(&val[4], &data1, 2);\n\t\tmemcpy(&val[6], &data2, 2);\n\t\tmemcpy(&val[8], &data3, 2);\n\t\tmemcpy(&val[10], &data4, 4);\n\t\tmemcpy(&val[14], &data5, 2);\n\n\t\tsdp_uuid128_create(uuid, val);\n\n\t\treturn 0;\n\t} else {\n\t\tuint16_t class = name2class(string);\n\t\tif (class) {\n\t\t\tsdp_uuid16_create(uuid, class);\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn string2uuid16(uuid, string);\n\t}\n}"
  },
  {
    "function_name": "bt_name2string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
    "lines": "181-209",
    "snippet": "char *bt_name2string(const char *pattern)\n{\n\tuuid_t uuid;\n\tuint16_t uuid16;\n\tint i;\n\n\t/* UUID 128 string format */\n\tif (is_uuid128(pattern))\n\t\treturn strdup(pattern);\n\n\t/* Friendly service name format */\n\tuuid16 = name2class(pattern);\n\tif (uuid16)\n\t\tgoto proceed;\n\n\t/* HEX format */\n\tuuid16 = strtol(pattern, NULL, 16);\n\tfor (i = 0; bt_services[i].class; i++) {\n\t\tif (bt_services[i].class == uuid16)\n\t\t\tgoto proceed;\n\t}\n\n\treturn NULL;\n\nproceed:\n\tsdp_uuid16_create(&uuid, uuid16);\n\n\treturn bt_uuid2string(&uuid);\n}",
    "includes": [
      "#include \"uuid-helper.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <arpa/inet.h>",
      "#include <errno.h>",
      "#include <stdbool.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct {\n\tconst char\t*name;\n\tuint16_t\tclass;\n} bt_services[] = {\n\t{ \"pbap\",\tPBAP_SVCLASS_ID\t\t\t},\n\t{ \"sap\",\tSAP_SVCLASS_ID\t\t\t},\n\t{ \"ftp\",\tOBEX_FILETRANS_SVCLASS_ID\t},\n\t{ \"bpp\",\tBASIC_PRINTING_SVCLASS_ID\t},\n\t{ \"bip\",\tIMAGING_SVCLASS_ID\t\t},\n\t{ \"synch\",\tIRMC_SYNC_SVCLASS_ID\t\t},\n\t{ \"dun\",\tDIALUP_NET_SVCLASS_ID\t\t},\n\t{ \"opp\",\tOBEX_OBJPUSH_SVCLASS_ID\t\t},\n\t{ \"fax\",\tFAX_SVCLASS_ID\t\t\t},\n\t{ \"spp\",\tSERIAL_PORT_SVCLASS_ID\t\t},\n\t{ \"hsp\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-hs\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-ag\",\tHEADSET_AGW_SVCLASS_ID\t\t},\n\t{ \"hfp\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-hf\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-ag\",\tHANDSFREE_AGW_SVCLASS_ID\t},\n\t{ \"pbap-pce\",\tPBAP_PCE_SVCLASS_ID\t\t},\n\t{ \"pbap-pse\",\tPBAP_PSE_SVCLASS_ID\t\t},\n\t{ \"map-mse\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mas\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mce\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"map-mns\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"gnss\",\tGNSS_SERVER_SVCLASS_ID\t\t},\n\t{ }\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bt_uuid2string",
          "args": [
            "&uuid"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "bt_uuid2string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
          "lines": "65-110",
          "snippet": "char *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}",
          "includes": [
            "#include \"uuid-helper.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <arpa/inet.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sdp_uuid16_create",
          "args": [
            "&uuid",
            "uuid16"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "pattern",
            "NULL",
            "16"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name2class",
          "args": [
            "pattern"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "name2class",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
          "lines": "142-152",
          "snippet": "static uint16_t name2class(const char *pattern)\n{\n\tint i;\n\n\tfor (i = 0; bt_services[i].name; i++) {\n\t\tif (strcasecmp(bt_services[i].name, pattern) == 0)\n\t\t\treturn bt_services[i].class;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"uuid-helper.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <arpa/inet.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct {\n\tconst char\t*name;\n\tuint16_t\tclass;\n} bt_services[] = {\n\t{ \"pbap\",\tPBAP_SVCLASS_ID\t\t\t},\n\t{ \"sap\",\tSAP_SVCLASS_ID\t\t\t},\n\t{ \"ftp\",\tOBEX_FILETRANS_SVCLASS_ID\t},\n\t{ \"bpp\",\tBASIC_PRINTING_SVCLASS_ID\t},\n\t{ \"bip\",\tIMAGING_SVCLASS_ID\t\t},\n\t{ \"synch\",\tIRMC_SYNC_SVCLASS_ID\t\t},\n\t{ \"dun\",\tDIALUP_NET_SVCLASS_ID\t\t},\n\t{ \"opp\",\tOBEX_OBJPUSH_SVCLASS_ID\t\t},\n\t{ \"fax\",\tFAX_SVCLASS_ID\t\t\t},\n\t{ \"spp\",\tSERIAL_PORT_SVCLASS_ID\t\t},\n\t{ \"hsp\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-hs\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-ag\",\tHEADSET_AGW_SVCLASS_ID\t\t},\n\t{ \"hfp\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-hf\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-ag\",\tHANDSFREE_AGW_SVCLASS_ID\t},\n\t{ \"pbap-pce\",\tPBAP_PCE_SVCLASS_ID\t\t},\n\t{ \"pbap-pse\",\tPBAP_PSE_SVCLASS_ID\t\t},\n\t{ \"map-mse\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mas\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mce\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"map-mns\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"gnss\",\tGNSS_SERVER_SVCLASS_ID\t\t},\n\t{ }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic struct {\n\tconst char\t*name;\n\tuint16_t\tclass;\n} bt_services[] = {\n\t{ \"pbap\",\tPBAP_SVCLASS_ID\t\t\t},\n\t{ \"sap\",\tSAP_SVCLASS_ID\t\t\t},\n\t{ \"ftp\",\tOBEX_FILETRANS_SVCLASS_ID\t},\n\t{ \"bpp\",\tBASIC_PRINTING_SVCLASS_ID\t},\n\t{ \"bip\",\tIMAGING_SVCLASS_ID\t\t},\n\t{ \"synch\",\tIRMC_SYNC_SVCLASS_ID\t\t},\n\t{ \"dun\",\tDIALUP_NET_SVCLASS_ID\t\t},\n\t{ \"opp\",\tOBEX_OBJPUSH_SVCLASS_ID\t\t},\n\t{ \"fax\",\tFAX_SVCLASS_ID\t\t\t},\n\t{ \"spp\",\tSERIAL_PORT_SVCLASS_ID\t\t},\n\t{ \"hsp\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-hs\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-ag\",\tHEADSET_AGW_SVCLASS_ID\t\t},\n\t{ \"hfp\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-hf\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-ag\",\tHANDSFREE_AGW_SVCLASS_ID\t},\n\t{ \"pbap-pce\",\tPBAP_PCE_SVCLASS_ID\t\t},\n\t{ \"pbap-pse\",\tPBAP_PSE_SVCLASS_ID\t\t},\n\t{ \"map-mse\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mas\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mce\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"map-mns\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"gnss\",\tGNSS_SERVER_SVCLASS_ID\t\t},\n\t{ }\n};\n\nstatic uint16_t name2class(const char *pattern)\n{\n\tint i;\n\n\tfor (i = 0; bt_services[i].name; i++) {\n\t\tif (strcasecmp(bt_services[i].name, pattern) == 0)\n\t\t\treturn bt_services[i].class;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "pattern"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_uuid128",
          "args": [
            "pattern"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "is_uuid128",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
          "lines": "154-161",
          "snippet": "static inline bool is_uuid128(const char *string)\n{\n\treturn (strlen(string) == 36 &&\n\t\t\tstring[8] == '-' &&\n\t\t\tstring[13] == '-' &&\n\t\t\tstring[18] == '-' &&\n\t\t\tstring[23] == '-');\n}",
          "includes": [
            "#include \"uuid-helper.h\"",
            "#include \"lib/sdp_lib.h\"",
            "#include \"lib/sdp.h\"",
            "#include \"lib/bluetooth.h\"",
            "#include <arpa/inet.h>",
            "#include <errno.h>",
            "#include <stdbool.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic inline bool is_uuid128(const char *string)\n{\n\treturn (strlen(string) == 36 &&\n\t\t\tstring[8] == '-' &&\n\t\t\tstring[13] == '-' &&\n\t\t\tstring[18] == '-' &&\n\t\t\tstring[23] == '-');\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic struct {\n\tconst char\t*name;\n\tuint16_t\tclass;\n} bt_services[] = {\n\t{ \"pbap\",\tPBAP_SVCLASS_ID\t\t\t},\n\t{ \"sap\",\tSAP_SVCLASS_ID\t\t\t},\n\t{ \"ftp\",\tOBEX_FILETRANS_SVCLASS_ID\t},\n\t{ \"bpp\",\tBASIC_PRINTING_SVCLASS_ID\t},\n\t{ \"bip\",\tIMAGING_SVCLASS_ID\t\t},\n\t{ \"synch\",\tIRMC_SYNC_SVCLASS_ID\t\t},\n\t{ \"dun\",\tDIALUP_NET_SVCLASS_ID\t\t},\n\t{ \"opp\",\tOBEX_OBJPUSH_SVCLASS_ID\t\t},\n\t{ \"fax\",\tFAX_SVCLASS_ID\t\t\t},\n\t{ \"spp\",\tSERIAL_PORT_SVCLASS_ID\t\t},\n\t{ \"hsp\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-hs\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-ag\",\tHEADSET_AGW_SVCLASS_ID\t\t},\n\t{ \"hfp\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-hf\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-ag\",\tHANDSFREE_AGW_SVCLASS_ID\t},\n\t{ \"pbap-pce\",\tPBAP_PCE_SVCLASS_ID\t\t},\n\t{ \"pbap-pse\",\tPBAP_PSE_SVCLASS_ID\t\t},\n\t{ \"map-mse\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mas\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mce\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"map-mns\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"gnss\",\tGNSS_SERVER_SVCLASS_ID\t\t},\n\t{ }\n};\n\nchar *bt_name2string(const char *pattern)\n{\n\tuuid_t uuid;\n\tuint16_t uuid16;\n\tint i;\n\n\t/* UUID 128 string format */\n\tif (is_uuid128(pattern))\n\t\treturn strdup(pattern);\n\n\t/* Friendly service name format */\n\tuuid16 = name2class(pattern);\n\tif (uuid16)\n\t\tgoto proceed;\n\n\t/* HEX format */\n\tuuid16 = strtol(pattern, NULL, 16);\n\tfor (i = 0; bt_services[i].class; i++) {\n\t\tif (bt_services[i].class == uuid16)\n\t\t\tgoto proceed;\n\t}\n\n\treturn NULL;\n\nproceed:\n\tsdp_uuid16_create(&uuid, uuid16);\n\n\treturn bt_uuid2string(&uuid);\n}"
  },
  {
    "function_name": "string2uuid16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
    "lines": "163-179",
    "snippet": "static int string2uuid16(uuid_t *uuid, const char *string)\n{\n\tint length = strlen(string);\n\tchar *endptr = NULL;\n\tuint16_t u16;\n\n\tif (length != 4 && length != 6)\n\t\treturn -EINVAL;\n\n\tu16 = strtol(string, &endptr, 16);\n\tif (endptr && *endptr == '\\0') {\n\t\tsdp_uuid16_create(uuid, u16);\n\t\treturn 0;\n\t}\n\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"uuid-helper.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <arpa/inet.h>",
      "#include <errno.h>",
      "#include <stdbool.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sdp_uuid16_create",
          "args": [
            "uuid",
            "u16"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "string",
            "&endptr",
            "16"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "string"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic int string2uuid16(uuid_t *uuid, const char *string)\n{\n\tint length = strlen(string);\n\tchar *endptr = NULL;\n\tuint16_t u16;\n\n\tif (length != 4 && length != 6)\n\t\treturn -EINVAL;\n\n\tu16 = strtol(string, &endptr, 16);\n\tif (endptr && *endptr == '\\0') {\n\t\tsdp_uuid16_create(uuid, u16);\n\t\treturn 0;\n\t}\n\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "is_uuid128",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
    "lines": "154-161",
    "snippet": "static inline bool is_uuid128(const char *string)\n{\n\treturn (strlen(string) == 36 &&\n\t\t\tstring[8] == '-' &&\n\t\t\tstring[13] == '-' &&\n\t\t\tstring[18] == '-' &&\n\t\t\tstring[23] == '-');\n}",
    "includes": [
      "#include \"uuid-helper.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <arpa/inet.h>",
      "#include <errno.h>",
      "#include <stdbool.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "string"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic inline bool is_uuid128(const char *string)\n{\n\treturn (strlen(string) == 36 &&\n\t\t\tstring[8] == '-' &&\n\t\t\tstring[13] == '-' &&\n\t\t\tstring[18] == '-' &&\n\t\t\tstring[23] == '-');\n}"
  },
  {
    "function_name": "name2class",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
    "lines": "142-152",
    "snippet": "static uint16_t name2class(const char *pattern)\n{\n\tint i;\n\n\tfor (i = 0; bt_services[i].name; i++) {\n\t\tif (strcasecmp(bt_services[i].name, pattern) == 0)\n\t\t\treturn bt_services[i].class;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"uuid-helper.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <arpa/inet.h>",
      "#include <errno.h>",
      "#include <stdbool.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct {\n\tconst char\t*name;\n\tuint16_t\tclass;\n} bt_services[] = {\n\t{ \"pbap\",\tPBAP_SVCLASS_ID\t\t\t},\n\t{ \"sap\",\tSAP_SVCLASS_ID\t\t\t},\n\t{ \"ftp\",\tOBEX_FILETRANS_SVCLASS_ID\t},\n\t{ \"bpp\",\tBASIC_PRINTING_SVCLASS_ID\t},\n\t{ \"bip\",\tIMAGING_SVCLASS_ID\t\t},\n\t{ \"synch\",\tIRMC_SYNC_SVCLASS_ID\t\t},\n\t{ \"dun\",\tDIALUP_NET_SVCLASS_ID\t\t},\n\t{ \"opp\",\tOBEX_OBJPUSH_SVCLASS_ID\t\t},\n\t{ \"fax\",\tFAX_SVCLASS_ID\t\t\t},\n\t{ \"spp\",\tSERIAL_PORT_SVCLASS_ID\t\t},\n\t{ \"hsp\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-hs\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-ag\",\tHEADSET_AGW_SVCLASS_ID\t\t},\n\t{ \"hfp\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-hf\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-ag\",\tHANDSFREE_AGW_SVCLASS_ID\t},\n\t{ \"pbap-pce\",\tPBAP_PCE_SVCLASS_ID\t\t},\n\t{ \"pbap-pse\",\tPBAP_PSE_SVCLASS_ID\t\t},\n\t{ \"map-mse\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mas\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mce\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"map-mns\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"gnss\",\tGNSS_SERVER_SVCLASS_ID\t\t},\n\t{ }\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "bt_services[i].name",
            "pattern"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nstatic struct {\n\tconst char\t*name;\n\tuint16_t\tclass;\n} bt_services[] = {\n\t{ \"pbap\",\tPBAP_SVCLASS_ID\t\t\t},\n\t{ \"sap\",\tSAP_SVCLASS_ID\t\t\t},\n\t{ \"ftp\",\tOBEX_FILETRANS_SVCLASS_ID\t},\n\t{ \"bpp\",\tBASIC_PRINTING_SVCLASS_ID\t},\n\t{ \"bip\",\tIMAGING_SVCLASS_ID\t\t},\n\t{ \"synch\",\tIRMC_SYNC_SVCLASS_ID\t\t},\n\t{ \"dun\",\tDIALUP_NET_SVCLASS_ID\t\t},\n\t{ \"opp\",\tOBEX_OBJPUSH_SVCLASS_ID\t\t},\n\t{ \"fax\",\tFAX_SVCLASS_ID\t\t\t},\n\t{ \"spp\",\tSERIAL_PORT_SVCLASS_ID\t\t},\n\t{ \"hsp\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-hs\",\tHEADSET_SVCLASS_ID\t\t},\n\t{ \"hsp-ag\",\tHEADSET_AGW_SVCLASS_ID\t\t},\n\t{ \"hfp\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-hf\",\tHANDSFREE_SVCLASS_ID\t\t},\n\t{ \"hfp-ag\",\tHANDSFREE_AGW_SVCLASS_ID\t},\n\t{ \"pbap-pce\",\tPBAP_PCE_SVCLASS_ID\t\t},\n\t{ \"pbap-pse\",\tPBAP_PSE_SVCLASS_ID\t\t},\n\t{ \"map-mse\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mas\",\tMAP_MSE_SVCLASS_ID\t\t},\n\t{ \"map-mce\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"map-mns\",\tMAP_MCE_SVCLASS_ID\t\t},\n\t{ \"gnss\",\tGNSS_SERVER_SVCLASS_ID\t\t},\n\t{ }\n};\n\nstatic uint16_t name2class(const char *pattern)\n{\n\tint i;\n\n\tfor (i = 0; bt_services[i].name; i++) {\n\t\tif (strcasecmp(bt_services[i].name, pattern) == 0)\n\t\t\treturn bt_services[i].class;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "bt_uuid2string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
    "lines": "65-110",
    "snippet": "char *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}",
    "includes": [
      "#include \"uuid-helper.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <arpa/inet.h>",
      "#include <errno.h>",
      "#include <stdbool.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "asprintf",
          "args": [
            "&str",
            "\"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\"",
            "ntohl(data0)",
            "ntohs(data1)",
            "ntohs(data2)",
            "ntohs(data3)",
            "ntohl(data4)",
            "ntohs(data5)"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohs",
          "args": [
            "data5"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "data4"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohs",
          "args": [
            "data3"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohs",
          "args": [
            "data2"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohs",
          "args": [
            "data1"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "data0"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&data5",
            "&uuid128.value.uuid128.data[14]",
            "2"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&data4",
            "&uuid128.value.uuid128.data[10]",
            "4"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&data3",
            "&uuid128.value.uuid128.data[8]",
            "2"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&data2",
            "&uuid128.value.uuid128.data[6]",
            "2"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&data1",
            "&uuid128.value.uuid128.data[4]",
            "2"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&data0",
            "&uuid128.value.uuid128.data[0]",
            "4"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&uuid128",
            "uuid",
            "sizeof(uuid_t)"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_uuid32_to_uuid128",
          "args": [
            "&uuid128",
            "uuid"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sdp_uuid16_to_uuid128",
          "args": [
            "&uuid128",
            "uuid"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *bt_uuid2string(uuid_t *uuid)\n{\n\tchar *str;\n\tuuid_t uuid128;\n\tunsigned int data0;\n\tunsigned short data1;\n\tunsigned short data2;\n\tunsigned short data3;\n\tunsigned int data4;\n\tunsigned short data5;\n\tint err;\n\n\tif (!uuid)\n\t\treturn NULL;\n\n\tswitch (uuid->type) {\n\tcase SDP_UUID16:\n\t\tsdp_uuid16_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID32:\n\t\tsdp_uuid32_to_uuid128(&uuid128, uuid);\n\t\tbreak;\n\tcase SDP_UUID128:\n\t\tmemcpy(&uuid128, uuid, sizeof(uuid_t));\n\t\tbreak;\n\tdefault:\n\t\t/* Type of UUID unknown */\n\t\treturn NULL;\n\t}\n\n\tmemcpy(&data0, &uuid128.value.uuid128.data[0], 4);\n\tmemcpy(&data1, &uuid128.value.uuid128.data[4], 2);\n\tmemcpy(&data2, &uuid128.value.uuid128.data[6], 2);\n\tmemcpy(&data3, &uuid128.value.uuid128.data[8], 2);\n\tmemcpy(&data4, &uuid128.value.uuid128.data[10], 4);\n\tmemcpy(&data5, &uuid128.value.uuid128.data[14], 2);\n\n\terr = asprintf(&str, \"%.8x-%.4x-%.4x-%.4x-%.8x%.4x\",\n\t\t\tntohl(data0), ntohs(data1),\n\t\t\tntohs(data2), ntohs(data3),\n\t\t\tntohl(data4), ntohs(data5));\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}"
  },
  {
    "function_name": "bt_modalias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/uuid-helper.c",
    "lines": "40-63",
    "snippet": "char *bt_modalias(uint16_t source, uint16_t vendor,\n\t\t\t\t\tuint16_t product, uint16_t version)\n{\n\tchar *str;\n\tint err;\n\n\tswitch (source) {\n\tcase 0x0001:\n\t\terr = asprintf(&str, \"%s:v%04Xp%04Xd%04X\",\n\t\t\t\t\t\"bluetooth\", vendor, product, version);\n\t\tbreak;\n\tcase 0x0002:\n\t\terr = asprintf(&str, \"%s:v%04Xp%04Xd%04X\",\n\t\t\t\t\t\"usb\", vendor, product, version);\n\t\tbreak;\n\tdefault:\n\t\treturn NULL;\n\t}\n\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}",
    "includes": [
      "#include \"uuid-helper.h\"",
      "#include \"lib/sdp_lib.h\"",
      "#include \"lib/sdp.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <arpa/inet.h>",
      "#include <errno.h>",
      "#include <stdbool.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "asprintf",
          "args": [
            "&str",
            "\"%s:v%04Xp%04Xd%04X\"",
            "\"usb\"",
            "vendor",
            "product",
            "version"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asprintf",
          "args": [
            "&str",
            "\"%s:v%04Xp%04Xd%04X\"",
            "\"bluetooth\"",
            "vendor",
            "product",
            "version"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uuid-helper.h\"\n#include \"lib/sdp_lib.h\"\n#include \"lib/sdp.h\"\n#include \"lib/bluetooth.h\"\n#include <arpa/inet.h>\n#include <errno.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *bt_modalias(uint16_t source, uint16_t vendor,\n\t\t\t\t\tuint16_t product, uint16_t version)\n{\n\tchar *str;\n\tint err;\n\n\tswitch (source) {\n\tcase 0x0001:\n\t\terr = asprintf(&str, \"%s:v%04Xp%04Xd%04X\",\n\t\t\t\t\t\"bluetooth\", vendor, product, version);\n\t\tbreak;\n\tcase 0x0002:\n\t\terr = asprintf(&str, \"%s:v%04Xp%04Xd%04X\",\n\t\t\t\t\t\"usb\", vendor, product, version);\n\t\tbreak;\n\tdefault:\n\t\treturn NULL;\n\t}\n\n\tif (err < 0)\n\t\treturn NULL;\n\n\treturn str;\n}"
  }
]