[
  {
    "function_name": "batocomp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/oui.c",
    "lines": "70-73",
    "snippet": "char *batocomp(const bdaddr_t *ba)\n{\n\treturn NULL;\n}",
    "includes": [
      "#include <libudev.h>",
      "#include \"oui.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <libudev.h>\n#include \"oui.h\"\n#include \"lib/bluetooth.h\"\n#include <config.h>\n\nchar *batocomp(const bdaddr_t *ba)\n{\n\treturn NULL;\n}"
  },
  {
    "function_name": "batocomp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/oui.c",
    "lines": "34-68",
    "snippet": "char *batocomp(const bdaddr_t *ba)\n{\n\tstruct udev *udev;\n\tstruct udev_hwdb *hwdb;\n\tstruct udev_list_entry *head, *entry;\n\tchar modalias[11], *comp = NULL;\n\n\tsprintf(modalias, \"OUI:%2.2X%2.2X%2.2X\", ba->b[5], ba->b[4], ba->b[3]);\n\n\tudev = udev_new();\n\tif (!udev)\n\t\treturn NULL;\n\n\thwdb = udev_hwdb_new(udev);\n\tif (!hwdb)\n\t\tgoto done;\n\n\thead = udev_hwdb_get_properties_list_entry(hwdb, modalias, 0);\n\n\tudev_list_entry_foreach(entry, head) {\n\t\tconst char *name = udev_list_entry_get_name(entry);\n\n\t\tif (name && !strcmp(name, \"ID_OUI_FROM_DATABASE\")) {\n\t\t\tcomp = strdup(udev_list_entry_get_value(entry));\n\t\t\tbreak;\n\t\t}\n\t}\n\n\thwdb = udev_hwdb_unref(hwdb);\n\ndone:\n\tudev = udev_unref(udev);\n\n\treturn comp;\n}",
    "includes": [
      "#include <libudev.h>",
      "#include \"oui.h\"",
      "#include \"lib/bluetooth.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "udev_unref",
          "args": [
            "udev"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udev_hwdb_unref",
          "args": [
            "hwdb"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "udev_list_entry_get_value(entry)"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udev_list_entry_get_value",
          "args": [
            "entry"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "\"ID_OUI_FROM_DATABASE\""
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "g_strcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2021-3658/repo/src/adapter.c",
          "lines": "1927-1930",
          "snippet": "static gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}",
          "includes": [
            "#include \"eir.h\"",
            "#include \"advertising.h\"",
            "#include \"gatt-database.h\"",
            "#include \"attrib-server.h\"",
            "#include \"attrib/gatt.h\"",
            "#include \"attrib/att.h\"",
            "#include \"attrib/gattrib.h\"",
            "#include \"storage.h\"",
            "#include \"agent.h\"",
            "#include \"uuid-helper.h\"",
            "#include \"error.h\"",
            "#include \"dbus-common.h\"",
            "#include \"profile.h\"",
            "#include \"device.h\"",
            "#include \"adapter.h\"",
            "#include \"sdpd.h\"",
            "#include \"hcid.h\"",
            "#include \"btio/btio.h\"",
            "#include \"src/shared/gatt-db.h\"",
            "#include \"src/shared/att.h\"",
            "#include \"src/shared/queue.h\"",
            "#include \"src/shared/util.h\"",
            "#include \"src/shared/mgmt.h\"",
            "#include \"textfile.h\"",
            "#include \"log.h\"",
            "#include \"gdbus/gdbus.h\"",
            "#include \"lib/mgmt.h\"",
            "#include \"lib/uuid.h\"",
            "#include \"bluetooth/sdp_lib.h\"",
            "#include \"bluetooth/sdp.h\"",
            "#include \"bluetooth/hci_lib.h\"",
            "#include \"bluetooth/hci.h\"",
            "#include \"bluetooth/bluetooth.h\"",
            "#include <dbus/dbus.h>",
            "#include <glib.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/file.h>",
            "#include <sys/ioctl.h>",
            "#include <stdbool.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <inttypes.h>",
            "#include <stdio.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eir.h\"\n#include \"advertising.h\"\n#include \"gatt-database.h\"\n#include \"attrib-server.h\"\n#include \"attrib/gatt.h\"\n#include \"attrib/att.h\"\n#include \"attrib/gattrib.h\"\n#include \"storage.h\"\n#include \"agent.h\"\n#include \"uuid-helper.h\"\n#include \"error.h\"\n#include \"dbus-common.h\"\n#include \"profile.h\"\n#include \"device.h\"\n#include \"adapter.h\"\n#include \"sdpd.h\"\n#include \"hcid.h\"\n#include \"btio/btio.h\"\n#include \"src/shared/gatt-db.h\"\n#include \"src/shared/att.h\"\n#include \"src/shared/queue.h\"\n#include \"src/shared/util.h\"\n#include \"src/shared/mgmt.h\"\n#include \"textfile.h\"\n#include \"log.h\"\n#include \"gdbus/gdbus.h\"\n#include \"lib/mgmt.h\"\n#include \"lib/uuid.h\"\n#include \"bluetooth/sdp_lib.h\"\n#include \"bluetooth/sdp.h\"\n#include \"bluetooth/hci_lib.h\"\n#include \"bluetooth/hci.h\"\n#include \"bluetooth/bluetooth.h\"\n#include <dbus/dbus.h>\n#include <glib.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/file.h>\n#include <sys/ioctl.h>\n#include <stdbool.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <inttypes.h>\n#include <stdio.h>\n#include <config.h>\n\nstatic gint g_strcmp(gconstpointer a, gconstpointer b)\n{\n\treturn strcmp(a, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "udev_list_entry_get_name",
          "args": [
            "entry"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udev_list_entry_foreach",
          "args": [
            "entry",
            "head"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udev_hwdb_get_properties_list_entry",
          "args": [
            "hwdb",
            "modalias",
            "0"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udev_hwdb_new",
          "args": [
            "udev"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "udev_new",
          "args": [],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "modalias",
            "\"OUI:%2.2X%2.2X%2.2X\"",
            "ba->b[5]",
            "ba->b[4]",
            "ba->b[3]"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <libudev.h>\n#include \"oui.h\"\n#include \"lib/bluetooth.h\"\n#include <config.h>\n\nchar *batocomp(const bdaddr_t *ba)\n{\n\tstruct udev *udev;\n\tstruct udev_hwdb *hwdb;\n\tstruct udev_list_entry *head, *entry;\n\tchar modalias[11], *comp = NULL;\n\n\tsprintf(modalias, \"OUI:%2.2X%2.2X%2.2X\", ba->b[5], ba->b[4], ba->b[3]);\n\n\tudev = udev_new();\n\tif (!udev)\n\t\treturn NULL;\n\n\thwdb = udev_hwdb_new(udev);\n\tif (!hwdb)\n\t\tgoto done;\n\n\thead = udev_hwdb_get_properties_list_entry(hwdb, modalias, 0);\n\n\tudev_list_entry_foreach(entry, head) {\n\t\tconst char *name = udev_list_entry_get_name(entry);\n\n\t\tif (name && !strcmp(name, \"ID_OUI_FROM_DATABASE\")) {\n\t\t\tcomp = strdup(udev_list_entry_get_value(entry));\n\t\t\tbreak;\n\t\t}\n\t}\n\n\thwdb = udev_hwdb_unref(hwdb);\n\ndone:\n\tudev = udev_unref(udev);\n\n\treturn comp;\n}"
  }
]