[
  {
    "function_name": "fuse_session_exited",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2691-2694",
    "snippet": "int fuse_session_exited(struct fuse_session *se)\n{\n    return se->exited;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_session_exited(struct fuse_session *se)\n{\n    return se->exited;\n}"
  },
  {
    "function_name": "fuse_session_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2685-2689",
    "snippet": "void fuse_session_reset(struct fuse_session *se)\n{\n    se->exited = 0;\n    se->error = 0;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_session_reset(struct fuse_session *se)\n{\n    se->exited = 0;\n    se->error = 0;\n}"
  },
  {
    "function_name": "fuse_session_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2680-2683",
    "snippet": "void fuse_session_exit(struct fuse_session *se)\n{\n    se->exited = 1;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_session_exit(struct fuse_session *se)\n{\n    se->exited = 1;\n}"
  },
  {
    "function_name": "fuse_lowlevel_is_virtio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2675-2678",
    "snippet": "int fuse_lowlevel_is_virtio(struct fuse_session *se)\n{\n    return !!se->virtio_dev;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_lowlevel_is_virtio(struct fuse_session *se)\n{\n    return !!se->virtio_dev;\n}"
  },
  {
    "function_name": "fuse_session_unmount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2671-2673",
    "snippet": "void fuse_session_unmount(struct fuse_session *se)\n{\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_session_unmount(struct fuse_session *se)\n{\n}"
  },
  {
    "function_name": "fuse_session_fd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2666-2669",
    "snippet": "int fuse_session_fd(struct fuse_session *se)\n{\n    return se->fd;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_session_fd(struct fuse_session *se)\n{\n    return se->fd;\n}"
  },
  {
    "function_name": "fuse_session_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2661-2664",
    "snippet": "int fuse_session_mount(struct fuse_session *se)\n{\n    return virtio_session_mount(se);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virtio_session_mount",
          "args": [
            "se"
          ],
          "line": 2663
        },
        "resolved": true,
        "details": {
          "function_name": "virtio_session_mount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_virtio.c",
          "lines": "965-1020",
          "snippet": "int virtio_session_mount(struct fuse_session *se)\n{\n    int ret;\n\n    /*\n     * Test that unshare(CLONE_FS) works. fv_queue_worker() will need it. It's\n     * an unprivileged system call but some Docker/Moby versions are known to\n     * reject it via seccomp when CAP_SYS_ADMIN is not given.\n     *\n     * Note that the program is single-threaded here so this syscall has no\n     * visible effect and is safe to make.\n     */\n    ret = unshare(CLONE_FS);\n    if (ret == -1 && errno == EPERM) {\n        fuse_log(FUSE_LOG_ERR, \"unshare(CLONE_FS) failed with EPERM. If \"\n                \"running in a container please check that the container \"\n                \"runtime seccomp policy allows unshare.\\n\");\n        return -1;\n    }\n\n    ret = fv_create_listen_socket(se);\n    if (ret < 0) {\n        return ret;\n    }\n\n    se->fd = -1;\n\n    fuse_log(FUSE_LOG_INFO, \"%s: Waiting for vhost-user socket connection...\\n\",\n             __func__);\n    int data_sock = accept(se->vu_listen_fd, NULL, NULL);\n    if (data_sock == -1) {\n        fuse_log(FUSE_LOG_ERR, \"vhost socket accept: %m\\n\");\n        close(se->vu_listen_fd);\n        return -1;\n    }\n    close(se->vu_listen_fd);\n    se->vu_listen_fd = -1;\n    fuse_log(FUSE_LOG_INFO, \"%s: Received vhost-user socket connection\\n\",\n             __func__);\n\n    /* TODO: Some cleanup/deallocation! */\n    se->virtio_dev = calloc(sizeof(struct fv_VuDev), 1);\n    if (!se->virtio_dev) {\n        fuse_log(FUSE_LOG_ERR, \"%s: virtio_dev calloc failed\\n\", __func__);\n        close(data_sock);\n        return -1;\n    }\n\n    se->vu_socketfd = data_sock;\n    se->virtio_dev->se = se;\n    pthread_rwlock_init(&se->virtio_dev->vu_dispatch_rwlock, NULL);\n    vu_init(&se->virtio_dev->dev, 2, se->vu_socketfd, fv_panic, fv_set_watch,\n            fv_remove_watch, &fv_iface);\n\n    return 0;\n}",
          "includes": [
            "#include \"contrib/libvhost-user/libvhost-user.h\"",
            "#include <unistd.h>",
            "#include <grp.h>",
            "#include <sys/types.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/socket.h>",
            "#include <sys/eventfd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qapi/error.h\"",
            "#include \"qemu/iov.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const VuDevIface fv_iface = {\n    .get_features = fv_get_features,\n    .set_features = fv_set_features,\n\n    /* Don't need process message, we've not got any at vhost-user level */\n    .queue_set_started = fv_queue_set_started,\n\n    .queue_is_processed_in_order = fv_queue_order,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"contrib/libvhost-user/libvhost-user.h\"\n#include <unistd.h>\n#include <grp.h>\n#include <sys/types.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <sys/eventfd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qapi/error.h\"\n#include \"qemu/iov.h\"\n#include \"qemu/osdep.h\"\n\nstatic const VuDevIface fv_iface = {\n    .get_features = fv_get_features,\n    .set_features = fv_set_features,\n\n    /* Don't need process message, we've not got any at vhost-user level */\n    .queue_set_started = fv_queue_set_started,\n\n    .queue_is_processed_in_order = fv_queue_order,\n};\n\nint virtio_session_mount(struct fuse_session *se)\n{\n    int ret;\n\n    /*\n     * Test that unshare(CLONE_FS) works. fv_queue_worker() will need it. It's\n     * an unprivileged system call but some Docker/Moby versions are known to\n     * reject it via seccomp when CAP_SYS_ADMIN is not given.\n     *\n     * Note that the program is single-threaded here so this syscall has no\n     * visible effect and is safe to make.\n     */\n    ret = unshare(CLONE_FS);\n    if (ret == -1 && errno == EPERM) {\n        fuse_log(FUSE_LOG_ERR, \"unshare(CLONE_FS) failed with EPERM. If \"\n                \"running in a container please check that the container \"\n                \"runtime seccomp policy allows unshare.\\n\");\n        return -1;\n    }\n\n    ret = fv_create_listen_socket(se);\n    if (ret < 0) {\n        return ret;\n    }\n\n    se->fd = -1;\n\n    fuse_log(FUSE_LOG_INFO, \"%s: Waiting for vhost-user socket connection...\\n\",\n             __func__);\n    int data_sock = accept(se->vu_listen_fd, NULL, NULL);\n    if (data_sock == -1) {\n        fuse_log(FUSE_LOG_ERR, \"vhost socket accept: %m\\n\");\n        close(se->vu_listen_fd);\n        return -1;\n    }\n    close(se->vu_listen_fd);\n    se->vu_listen_fd = -1;\n    fuse_log(FUSE_LOG_INFO, \"%s: Received vhost-user socket connection\\n\",\n             __func__);\n\n    /* TODO: Some cleanup/deallocation! */\n    se->virtio_dev = calloc(sizeof(struct fv_VuDev), 1);\n    if (!se->virtio_dev) {\n        fuse_log(FUSE_LOG_ERR, \"%s: virtio_dev calloc failed\\n\", __func__);\n        close(data_sock);\n        return -1;\n    }\n\n    se->vu_socketfd = data_sock;\n    se->virtio_dev->se = se;\n    pthread_rwlock_init(&se->virtio_dev->vu_dispatch_rwlock, NULL);\n    vu_init(&se->virtio_dev->dev, 2, se->vu_socketfd, fv_panic, fv_set_watch,\n            fv_remove_watch, &fv_iface);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_session_mount(struct fuse_session *se)\n{\n    return virtio_session_mount(se);\n}"
  },
  {
    "function_name": "fuse_session_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2577-2659",
    "snippet": "struct fuse_session *fuse_session_new(struct fuse_args *args,\n                                      const struct fuse_lowlevel_ops *op,\n                                      size_t op_size, void *userdata)\n{\n    struct fuse_session *se;\n\n    if (sizeof(struct fuse_lowlevel_ops) < op_size) {\n        fuse_log(\n            FUSE_LOG_ERR,\n            \"fuse: warning: library too old, some operations may not work\\n\");\n        op_size = sizeof(struct fuse_lowlevel_ops);\n    }\n\n    if (args->argc == 0) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: empty argv passed to fuse_session_new().\\n\");\n        return NULL;\n    }\n\n    se = (struct fuse_session *)calloc(1, sizeof(struct fuse_session));\n    if (se == NULL) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: failed to allocate fuse object\\n\");\n        goto out1;\n    }\n    se->fd = -1;\n    se->vu_listen_fd = -1;\n    se->thread_pool_size = THREAD_POOL_SIZE;\n    se->conn.max_write = UINT_MAX;\n    se->conn.max_readahead = UINT_MAX;\n\n    /* Parse options */\n    if (fuse_opt_parse(args, se, fuse_ll_opts, NULL) == -1) {\n        goto out2;\n    }\n    if (args->argc == 1 && args->argv[0][0] == '-') {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: warning: argv[0] looks like an option, but \"\n                 \"will be ignored\\n\");\n    } else if (args->argc != 1) {\n        int i;\n        fuse_log(FUSE_LOG_ERR, \"fuse: unknown option(s): `\");\n        for (i = 1; i < args->argc - 1; i++) {\n            fuse_log(FUSE_LOG_ERR, \"%s \", args->argv[i]);\n        }\n        fuse_log(FUSE_LOG_ERR, \"%s'\\n\", args->argv[i]);\n        goto out4;\n    }\n\n    if (!se->vu_socket_path && se->vu_listen_fd < 0) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: missing --socket-path or --fd option\\n\");\n        goto out4;\n    }\n    if (se->vu_socket_path && se->vu_listen_fd >= 0) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: --socket-path and --fd cannot be given together\\n\");\n        goto out4;\n    }\n    if (se->vu_socket_group && !se->vu_socket_path) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: --socket-group can only be used with --socket-path\\n\");\n        goto out4;\n    }\n\n    se->bufsize = FUSE_MAX_MAX_PAGES * getpagesize() + FUSE_BUFFER_HEADER_SIZE;\n\n    list_init_req(&se->list);\n    list_init_req(&se->interrupts);\n    fuse_mutex_init(&se->lock);\n    pthread_rwlock_init(&se->init_rwlock, NULL);\n\n    memcpy(&se->op, op, op_size);\n    se->owner = getuid();\n    se->userdata = userdata;\n\n    return se;\n\nout4:\n    fuse_opt_free_args(args);\nout2:\n    free(se);\nout1:\n    return NULL;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [
      "#define THREAD_POOL_SIZE 64"
    ],
    "globals_used": [
      "static const struct fuse_opt fuse_ll_opts[] = {\n    LL_OPTION(\"debug\", debug, 1),\n    LL_OPTION(\"-d\", debug, 1),\n    LL_OPTION(\"--debug\", debug, 1),\n    LL_OPTION(\"allow_root\", deny_others, 1),\n    LL_OPTION(\"--socket-path=%s\", vu_socket_path, 0),\n    LL_OPTION(\"--socket-group=%s\", vu_socket_group, 0),\n    LL_OPTION(\"--fd=%d\", vu_listen_fd, 0),\n    LL_OPTION(\"--thread-pool-size=%d\", thread_pool_size, 0),\n    FUSE_OPT_END\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "se"
          ],
          "line": 2656
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_free_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "122-137",
          "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_opt_free_args",
          "args": [
            "args"
          ],
          "line": 2654
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_free_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "34-48",
          "snippet": "void fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 2648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&se->op",
            "op",
            "op_size"
          ],
          "line": 2647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_rwlock_init",
          "args": [
            "&se->init_rwlock",
            "NULL"
          ],
          "line": 2645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mutex_init",
          "args": [
            "&se->lock"
          ],
          "line": 2644
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_misc.h",
          "lines": "27-34",
          "snippet": "static inline void fuse_mutex_init(pthread_mutex_t *mut)\n{\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_ADAPTIVE_NP);\n    pthread_mutex_init(mut, &attr);\n    pthread_mutexattr_destroy(&attr);\n}",
          "includes": [
            "#include \"config-host.h\"",
            "#include <pthread.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config-host.h\"\n#include <pthread.h>\n\nstatic inline void fuse_mutex_init(pthread_mutex_t *mut)\n{\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_ADAPTIVE_NP);\n    pthread_mutex_init(mut, &attr);\n    pthread_mutexattr_destroy(&attr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_init_req",
          "args": [
            "&se->interrupts"
          ],
          "line": 2643
        },
        "resolved": true,
        "details": {
          "function_name": "list_init_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "93-97",
          "snippet": "static void list_init_req(struct fuse_req *req)\n{\n    req->next = req;\n    req->prev = req;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void list_init_req(struct fuse_req *req)\n{\n    req->next = req;\n    req->prev = req;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpagesize",
          "args": [],
          "line": 2640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_ERR",
            "\"fuse: --socket-group can only be used with --socket-path\\n\""
          ],
          "line": 2635
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_opt_parse",
          "args": [
            "args",
            "se",
            "fuse_ll_opts",
            "NULL"
          ],
          "line": 2608
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "424-450",
          "snippet": "int fuse_opt_parse(struct fuse_args *args, void *data,\n                   const struct fuse_opt opts[], fuse_opt_proc_t proc)\n{\n    int res;\n    struct fuse_opt_context ctx = {\n        .data = data,\n        .opt = opts,\n        .proc = proc,\n    };\n\n    if (!args || !args->argv || !args->argc) {\n        return 0;\n    }\n\n    ctx.argc = args->argc;\n    ctx.argv = args->argv;\n\n    res = opt_parse(&ctx);\n    if (res != -1) {\n        struct fuse_args tmp = *args;\n        *args = ctx.outargs;\n        ctx.outargs = tmp;\n    }\n    free(ctx.opts);\n    fuse_opt_free_args(&ctx.outargs);\n    return res;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_opt_parse(struct fuse_args *args, void *data,\n                   const struct fuse_opt opts[], fuse_opt_proc_t proc)\n{\n    int res;\n    struct fuse_opt_context ctx = {\n        .data = data,\n        .opt = opts,\n        .proc = proc,\n    };\n\n    if (!args || !args->argv || !args->argc) {\n        return 0;\n    }\n\n    ctx.argc = args->argc;\n    ctx.argv = args->argv;\n\n    res = opt_parse(&ctx);\n    if (res != -1) {\n        struct fuse_args tmp = *args;\n        *args = ctx.outargs;\n        ctx.outargs = tmp;\n    }\n    free(ctx.opts);\n    fuse_opt_free_args(&ctx.outargs);\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "1",
            "sizeof(struct fuse_session)"
          ],
          "line": 2596
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\n#define THREAD_POOL_SIZE 64\n\nstatic const struct fuse_opt fuse_ll_opts[] = {\n    LL_OPTION(\"debug\", debug, 1),\n    LL_OPTION(\"-d\", debug, 1),\n    LL_OPTION(\"--debug\", debug, 1),\n    LL_OPTION(\"allow_root\", deny_others, 1),\n    LL_OPTION(\"--socket-path=%s\", vu_socket_path, 0),\n    LL_OPTION(\"--socket-group=%s\", vu_socket_group, 0),\n    LL_OPTION(\"--fd=%d\", vu_listen_fd, 0),\n    LL_OPTION(\"--thread-pool-size=%d\", thread_pool_size, 0),\n    FUSE_OPT_END\n};\n\nstruct fuse_session *fuse_session_new(struct fuse_args *args,\n                                      const struct fuse_lowlevel_ops *op,\n                                      size_t op_size, void *userdata)\n{\n    struct fuse_session *se;\n\n    if (sizeof(struct fuse_lowlevel_ops) < op_size) {\n        fuse_log(\n            FUSE_LOG_ERR,\n            \"fuse: warning: library too old, some operations may not work\\n\");\n        op_size = sizeof(struct fuse_lowlevel_ops);\n    }\n\n    if (args->argc == 0) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: empty argv passed to fuse_session_new().\\n\");\n        return NULL;\n    }\n\n    se = (struct fuse_session *)calloc(1, sizeof(struct fuse_session));\n    if (se == NULL) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: failed to allocate fuse object\\n\");\n        goto out1;\n    }\n    se->fd = -1;\n    se->vu_listen_fd = -1;\n    se->thread_pool_size = THREAD_POOL_SIZE;\n    se->conn.max_write = UINT_MAX;\n    se->conn.max_readahead = UINT_MAX;\n\n    /* Parse options */\n    if (fuse_opt_parse(args, se, fuse_ll_opts, NULL) == -1) {\n        goto out2;\n    }\n    if (args->argc == 1 && args->argv[0][0] == '-') {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: warning: argv[0] looks like an option, but \"\n                 \"will be ignored\\n\");\n    } else if (args->argc != 1) {\n        int i;\n        fuse_log(FUSE_LOG_ERR, \"fuse: unknown option(s): `\");\n        for (i = 1; i < args->argc - 1; i++) {\n            fuse_log(FUSE_LOG_ERR, \"%s \", args->argv[i]);\n        }\n        fuse_log(FUSE_LOG_ERR, \"%s'\\n\", args->argv[i]);\n        goto out4;\n    }\n\n    if (!se->vu_socket_path && se->vu_listen_fd < 0) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: missing --socket-path or --fd option\\n\");\n        goto out4;\n    }\n    if (se->vu_socket_path && se->vu_listen_fd >= 0) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: --socket-path and --fd cannot be given together\\n\");\n        goto out4;\n    }\n    if (se->vu_socket_group && !se->vu_socket_path) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: --socket-group can only be used with --socket-path\\n\");\n        goto out4;\n    }\n\n    se->bufsize = FUSE_MAX_MAX_PAGES * getpagesize() + FUSE_BUFFER_HEADER_SIZE;\n\n    list_init_req(&se->list);\n    list_init_req(&se->interrupts);\n    fuse_mutex_init(&se->lock);\n    pthread_rwlock_init(&se->init_rwlock, NULL);\n\n    memcpy(&se->op, op, op_size);\n    se->owner = getuid();\n    se->userdata = userdata;\n\n    return se;\n\nout4:\n    fuse_opt_free_args(args);\nout2:\n    free(se);\nout1:\n    return NULL;\n}"
  },
  {
    "function_name": "fuse_session_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2552-2574",
    "snippet": "void fuse_session_destroy(struct fuse_session *se)\n{\n    if (se->got_init && !se->got_destroy) {\n        if (se->op.destroy) {\n            se->op.destroy(se->userdata);\n        }\n    }\n    pthread_rwlock_destroy(&se->init_rwlock);\n    pthread_mutex_destroy(&se->lock);\n    free(se->cuse_data);\n    if (se->fd != -1) {\n        close(se->fd);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        virtio_session_close(se);\n    }\n\n    free(se->vu_socket_path);\n    se->vu_socket_path = NULL;\n\n    free(se);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "se"
          ],
          "line": 2573
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_free_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "122-137",
          "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virtio_session_close",
          "args": [
            "se"
          ],
          "line": 2567
        },
        "resolved": true,
        "details": {
          "function_name": "virtio_session_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_virtio.c",
          "lines": "1022-1034",
          "snippet": "void virtio_session_close(struct fuse_session *se)\n{\n    close(se->vu_socketfd);\n\n    if (!se->virtio_dev) {\n        return;\n    }\n\n    free(se->virtio_dev->qi);\n    pthread_rwlock_destroy(&se->virtio_dev->vu_dispatch_rwlock);\n    free(se->virtio_dev);\n    se->virtio_dev = NULL;\n}",
          "includes": [
            "#include \"contrib/libvhost-user/libvhost-user.h\"",
            "#include <unistd.h>",
            "#include <grp.h>",
            "#include <sys/types.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/socket.h>",
            "#include <sys/eventfd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qapi/error.h\"",
            "#include \"qemu/iov.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"contrib/libvhost-user/libvhost-user.h\"\n#include <unistd.h>\n#include <grp.h>\n#include <sys/types.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <sys/eventfd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qapi/error.h\"\n#include \"qemu/iov.h\"\n#include \"qemu/osdep.h\"\n\nvoid virtio_session_close(struct fuse_session *se)\n{\n    close(se->vu_socketfd);\n\n    if (!se->virtio_dev) {\n        return;\n    }\n\n    free(se->virtio_dev->qi);\n    pthread_rwlock_destroy(&se->virtio_dev->vu_dispatch_rwlock);\n    free(se->virtio_dev);\n    se->virtio_dev = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_lowlevel_is_virtio",
          "args": [
            "se"
          ],
          "line": 2566
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_lowlevel_is_virtio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "2675-2678",
          "snippet": "int fuse_lowlevel_is_virtio(struct fuse_session *se)\n{\n    return !!se->virtio_dev;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_lowlevel_is_virtio(struct fuse_session *se)\n{\n    return !!se->virtio_dev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_mutex_destroy",
          "args": [
            "&se->lock"
          ],
          "line": 2560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_rwlock_destroy",
          "args": [
            "&se->init_rwlock"
          ],
          "line": 2559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "se->op.destroy",
          "args": [
            "se->userdata"
          ],
          "line": 2556
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_session_destroy(struct fuse_session *se)\n{\n    if (se->got_init && !se->got_destroy) {\n        if (se->op.destroy) {\n            se->op.destroy(se->userdata);\n        }\n    }\n    pthread_rwlock_destroy(&se->init_rwlock);\n    pthread_mutex_destroy(&se->lock);\n    free(se->cuse_data);\n    if (se->fd != -1) {\n        close(se->fd);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        virtio_session_close(se);\n    }\n\n    free(se->vu_socket_path);\n    se->vu_socket_path = NULL;\n\n    free(se);\n}"
  },
  {
    "function_name": "fuse_lowlevel_help",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2538-2550",
    "snippet": "void fuse_lowlevel_help(void)\n{\n    /*\n     * These are not all options, but the ones that are\n     * potentially of interest to an end-user\n     */\n    printf(\n        \"    -o allow_root              allow access by root\\n\"\n        \"    --socket-path=PATH         path for the vhost-user socket\\n\"\n        \"    --fd=FDNUM                 fd number of vhost-user socket\\n\"\n        \"    --thread-pool-size=NUM     thread pool size limit (default %d)\\n\",\n        THREAD_POOL_SIZE);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [
      "#define THREAD_POOL_SIZE 64"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"    -o allow_root              allow access by root\\n\"\n        \"    --socket-path=PATH         path for the vhost-user socket\\n\"\n        \"    --fd=FDNUM                 fd number of vhost-user socket\\n\"\n        \"    --thread-pool-size=NUM     thread pool size limit (default %d)\\n\"",
            "THREAD_POOL_SIZE"
          ],
          "line": 2544
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\n#define THREAD_POOL_SIZE 64\n\nvoid fuse_lowlevel_help(void)\n{\n    /*\n     * These are not all options, but the ones that are\n     * potentially of interest to an end-user\n     */\n    printf(\n        \"    -o allow_root              allow access by root\\n\"\n        \"    --socket-path=PATH         path for the vhost-user socket\\n\"\n        \"    --fd=FDNUM                 fd number of vhost-user socket\\n\"\n        \"    --thread-pool-size=NUM     thread pool size limit (default %d)\\n\",\n        THREAD_POOL_SIZE);\n}"
  },
  {
    "function_name": "fuse_lowlevel_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2532-2536",
    "snippet": "void fuse_lowlevel_version(void)\n{\n    printf(\"using FUSE kernel interface version %i.%i\\n\", FUSE_KERNEL_VERSION,\n           FUSE_KERNEL_MINOR_VERSION);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"using FUSE kernel interface version %i.%i\\n\"",
            "FUSE_KERNEL_VERSION",
            "FUSE_KERNEL_MINOR_VERSION"
          ],
          "line": 2534
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_lowlevel_version(void)\n{\n    printf(\"using FUSE kernel interface version %i.%i\\n\", FUSE_KERNEL_VERSION,\n           FUSE_KERNEL_MINOR_VERSION);\n}"
  },
  {
    "function_name": "fuse_session_process_buf_int",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2393-2513",
    "snippet": "void fuse_session_process_buf_int(struct fuse_session *se,\n                                  struct fuse_bufvec *bufv,\n                                  struct fuse_chan *ch)\n{\n    const struct fuse_buf *buf = bufv->buf;\n    struct fuse_mbuf_iter iter = FUSE_MBUF_ITER_INIT(buf);\n    struct fuse_in_header *in;\n    struct fuse_req *req;\n    int err;\n\n    /* The first buffer must be a memory buffer */\n    assert(!(buf->flags & FUSE_BUF_IS_FD));\n\n    in = fuse_mbuf_iter_advance(&iter, sizeof(*in));\n    assert(in); /* caller guarantees the input buffer is large enough */\n\n    fuse_log(\n        FUSE_LOG_DEBUG,\n        \"unique: %llu, opcode: %s (%i), nodeid: %llu, insize: %zu, pid: %u\\n\",\n        (unsigned long long)in->unique, opname((enum fuse_opcode)in->opcode),\n        in->opcode, (unsigned long long)in->nodeid, buf->size, in->pid);\n\n    req = fuse_ll_alloc_req(se);\n    if (req == NULL) {\n        struct fuse_out_header out = {\n            .unique = in->unique,\n            .error = -ENOMEM,\n        };\n        struct iovec iov = {\n            .iov_base = &out,\n            .iov_len = sizeof(struct fuse_out_header),\n        };\n\n        fuse_send_msg(se, ch, &iov, 1);\n        return;\n    }\n\n    req->unique = in->unique;\n    req->ctx.uid = in->uid;\n    req->ctx.gid = in->gid;\n    req->ctx.pid = in->pid;\n    req->ch = ch;\n\n    /*\n     * INIT and DESTROY requests are serialized, all other request types\n     * run in parallel.  This prevents races between FUSE_INIT and ordinary\n     * requests, FUSE_INIT and FUSE_INIT, FUSE_INIT and FUSE_DESTROY, and\n     * FUSE_DESTROY and FUSE_DESTROY.\n     */\n    if (in->opcode == FUSE_INIT || in->opcode == CUSE_INIT ||\n        in->opcode == FUSE_DESTROY) {\n        pthread_rwlock_wrlock(&se->init_rwlock);\n    } else {\n        pthread_rwlock_rdlock(&se->init_rwlock);\n    }\n\n    err = EIO;\n    if (!se->got_init) {\n        enum fuse_opcode expected;\n\n        expected = se->cuse_data ? CUSE_INIT : FUSE_INIT;\n        if (in->opcode != expected) {\n            goto reply_err;\n        }\n    } else if (in->opcode == FUSE_INIT || in->opcode == CUSE_INIT) {\n        if (fuse_lowlevel_is_virtio(se)) {\n            /*\n             * TODO: This is after a hard reboot typically, we need to do\n             * a destroy, but we can't reply to this request yet so\n             * we can't use do_destroy\n             */\n            fuse_log(FUSE_LOG_DEBUG, \"%s: reinit\\n\", __func__);\n            se->got_destroy = 1;\n            se->got_init = 0;\n            if (se->op.destroy) {\n                se->op.destroy(se->userdata);\n            }\n        } else {\n            goto reply_err;\n        }\n    }\n\n    err = EACCES;\n    /* Implement -o allow_root */\n    if (se->deny_others && in->uid != se->owner && in->uid != 0 &&\n        in->opcode != FUSE_INIT && in->opcode != FUSE_READ &&\n        in->opcode != FUSE_WRITE && in->opcode != FUSE_FSYNC &&\n        in->opcode != FUSE_RELEASE && in->opcode != FUSE_READDIR &&\n        in->opcode != FUSE_FSYNCDIR && in->opcode != FUSE_RELEASEDIR &&\n        in->opcode != FUSE_NOTIFY_REPLY && in->opcode != FUSE_READDIRPLUS) {\n        goto reply_err;\n    }\n\n    err = ENOSYS;\n    if (in->opcode >= FUSE_MAXOP || !fuse_ll_ops[in->opcode].func) {\n        goto reply_err;\n    }\n    if (in->opcode != FUSE_INTERRUPT) {\n        struct fuse_req *intr;\n        pthread_mutex_lock(&se->lock);\n        intr = check_interrupt(se, req);\n        list_add_req(req, &se->list);\n        pthread_mutex_unlock(&se->lock);\n        if (intr) {\n            fuse_reply_err(intr, EAGAIN);\n        }\n    }\n\n    if (in->opcode == FUSE_WRITE && se->op.write_buf) {\n        do_write_buf(req, in->nodeid, &iter, bufv);\n    } else {\n        fuse_ll_ops[in->opcode].func(req, in->nodeid, &iter);\n    }\n\n    pthread_rwlock_unlock(&se->init_rwlock);\n    return;\n\nreply_err:\n    fuse_reply_err(req, err);\n    pthread_rwlock_unlock(&se->init_rwlock);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [
      "#define FUSE_MAXOP (sizeof(fuse_ll_ops) / sizeof(fuse_ll_ops[0]))"
    ],
    "globals_used": [
      "static struct {\n    void (*func)(fuse_req_t, fuse_ino_t, struct fuse_mbuf_iter *);\n    const char *name;\n} fuse_ll_ops[] = {\n    [FUSE_LOOKUP] = { do_lookup, \"LOOKUP\" },\n    [FUSE_FORGET] = { do_forget, \"FORGET\" },\n    [FUSE_GETATTR] = { do_getattr, \"GETATTR\" },\n    [FUSE_SETATTR] = { do_setattr, \"SETATTR\" },\n    [FUSE_READLINK] = { do_readlink, \"READLINK\" },\n    [FUSE_SYMLINK] = { do_symlink, \"SYMLINK\" },\n    [FUSE_MKNOD] = { do_mknod, \"MKNOD\" },\n    [FUSE_MKDIR] = { do_mkdir, \"MKDIR\" },\n    [FUSE_UNLINK] = { do_unlink, \"UNLINK\" },\n    [FUSE_RMDIR] = { do_rmdir, \"RMDIR\" },\n    [FUSE_RENAME] = { do_rename, \"RENAME\" },\n    [FUSE_LINK] = { do_link, \"LINK\" },\n    [FUSE_OPEN] = { do_open, \"OPEN\" },\n    [FUSE_READ] = { do_read, \"READ\" },\n    [FUSE_WRITE] = { do_write, \"WRITE\" },\n    [FUSE_STATFS] = { do_statfs, \"STATFS\" },\n    [FUSE_RELEASE] = { do_release, \"RELEASE\" },\n    [FUSE_FSYNC] = { do_fsync, \"FSYNC\" },\n    [FUSE_SETXATTR] = { do_setxattr, \"SETXATTR\" },\n    [FUSE_GETXATTR] = { do_getxattr, \"GETXATTR\" },\n    [FUSE_LISTXATTR] = { do_listxattr, \"LISTXATTR\" },\n    [FUSE_REMOVEXATTR] = { do_removexattr, \"REMOVEXATTR\" },\n    [FUSE_FLUSH] = { do_flush, \"FLUSH\" },\n    [FUSE_INIT] = { do_init, \"INIT\" },\n    [FUSE_OPENDIR] = { do_opendir, \"OPENDIR\" },\n    [FUSE_READDIR] = { do_readdir, \"READDIR\" },\n    [FUSE_RELEASEDIR] = { do_releasedir, \"RELEASEDIR\" },\n    [FUSE_FSYNCDIR] = { do_fsyncdir, \"FSYNCDIR\" },\n    [FUSE_GETLK] = { do_getlk, \"GETLK\" },\n    [FUSE_SETLK] = { do_setlk, \"SETLK\" },\n    [FUSE_SETLKW] = { do_setlkw, \"SETLKW\" },\n    [FUSE_ACCESS] = { do_access, \"ACCESS\" },\n    [FUSE_CREATE] = { do_create, \"CREATE\" },\n    [FUSE_INTERRUPT] = { do_interrupt, \"INTERRUPT\" },\n    [FUSE_BMAP] = { do_bmap, \"BMAP\" },\n    [FUSE_IOCTL] = { do_ioctl, \"IOCTL\" },\n    [FUSE_POLL] = { do_poll, \"POLL\" },\n    [FUSE_FALLOCATE] = { do_fallocate, \"FALLOCATE\" },\n    [FUSE_DESTROY] = { do_destroy, \"DESTROY\" },\n    [FUSE_NOTIFY_REPLY] = { NULL, \"NOTIFY_REPLY\" },\n    [FUSE_BATCH_FORGET] = { do_batch_forget, \"BATCH_FORGET\" },\n    [FUSE_READDIRPLUS] = { do_readdirplus, \"READDIRPLUS\" },\n    [FUSE_RENAME2] = { do_rename2, \"RENAME2\" },\n    [FUSE_COPY_FILE_RANGE] = { do_copy_file_range, \"COPY_FILE_RANGE\" },\n    [FUSE_LSEEK] = { do_lseek, \"LSEEK\" },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_rwlock_unlock",
          "args": [
            "&se->init_rwlock"
          ],
          "line": 2512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "err"
          ],
          "line": 2511
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_rwlock_unlock",
          "args": [
            "&se->init_rwlock"
          ],
          "line": 2507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_ll_ops[in->opcode].func",
          "args": [
            "req",
            "in->nodeid",
            "&iter"
          ],
          "line": 2504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_write_buf",
          "args": [
            "req",
            "in->nodeid",
            "&iter",
            "bufv"
          ],
          "line": 2502
        },
        "resolved": true,
        "details": {
          "function_name": "do_write_buf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "1168-1216",
          "snippet": "static void do_write_buf(fuse_req_t req, fuse_ino_t nodeid,\n                         struct fuse_mbuf_iter *iter, struct fuse_bufvec *ibufv)\n{\n    struct fuse_session *se = req->se;\n    struct fuse_bufvec *pbufv = ibufv;\n    struct fuse_bufvec tmpbufv = {\n        .buf[0] = ibufv->buf[0],\n        .count = 1,\n    };\n    struct fuse_write_in *arg;\n    size_t arg_size = sizeof(*arg);\n    struct fuse_file_info fi;\n\n    memset(&fi, 0, sizeof(fi));\n\n    arg = fuse_mbuf_iter_advance(iter, arg_size);\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    fi.lock_owner = arg->lock_owner;\n    fi.flags = arg->flags;\n    fi.fh = arg->fh;\n    fi.writepage = !!(arg->write_flags & FUSE_WRITE_CACHE);\n    fi.kill_priv = !!(arg->write_flags & FUSE_WRITE_KILL_PRIV);\n\n    if (ibufv->count == 1) {\n        assert(!(tmpbufv.buf[0].flags & FUSE_BUF_IS_FD));\n        tmpbufv.buf[0].mem = ((char *)arg) + arg_size;\n        tmpbufv.buf[0].size -= sizeof(struct fuse_in_header) + arg_size;\n        pbufv = &tmpbufv;\n    } else {\n        /*\n         *  Input bufv contains the headers in the first element\n         * and the data in the rest, we need to skip that first element\n         */\n        ibufv->buf[0].size = 0;\n    }\n\n    if (fuse_buf_size(pbufv) != arg->size) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: do_write_buf: buffer size doesn't match arg->size\\n\");\n        fuse_reply_err(req, EIO);\n        return;\n    }\n\n    se->op.write_buf(req, nodeid, pbufv, arg->offset, &fi);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_write_buf(fuse_req_t req, fuse_ino_t nodeid,\n                         struct fuse_mbuf_iter *iter, struct fuse_bufvec *ibufv)\n{\n    struct fuse_session *se = req->se;\n    struct fuse_bufvec *pbufv = ibufv;\n    struct fuse_bufvec tmpbufv = {\n        .buf[0] = ibufv->buf[0],\n        .count = 1,\n    };\n    struct fuse_write_in *arg;\n    size_t arg_size = sizeof(*arg);\n    struct fuse_file_info fi;\n\n    memset(&fi, 0, sizeof(fi));\n\n    arg = fuse_mbuf_iter_advance(iter, arg_size);\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    fi.lock_owner = arg->lock_owner;\n    fi.flags = arg->flags;\n    fi.fh = arg->fh;\n    fi.writepage = !!(arg->write_flags & FUSE_WRITE_CACHE);\n    fi.kill_priv = !!(arg->write_flags & FUSE_WRITE_KILL_PRIV);\n\n    if (ibufv->count == 1) {\n        assert(!(tmpbufv.buf[0].flags & FUSE_BUF_IS_FD));\n        tmpbufv.buf[0].mem = ((char *)arg) + arg_size;\n        tmpbufv.buf[0].size -= sizeof(struct fuse_in_header) + arg_size;\n        pbufv = &tmpbufv;\n    } else {\n        /*\n         *  Input bufv contains the headers in the first element\n         * and the data in the rest, we need to skip that first element\n         */\n        ibufv->buf[0].size = 0;\n    }\n\n    if (fuse_buf_size(pbufv) != arg->size) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: do_write_buf: buffer size doesn't match arg->size\\n\");\n        fuse_reply_err(req, EIO);\n        return;\n    }\n\n    se->op.write_buf(req, nodeid, pbufv, arg->offset, &fi);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&se->lock"
          ],
          "line": 2495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_req",
          "args": [
            "req",
            "&se->list"
          ],
          "line": 2494
        },
        "resolved": true,
        "details": {
          "function_name": "list_add_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "107-114",
          "snippet": "static void list_add_req(struct fuse_req *req, struct fuse_req *next)\n{\n    struct fuse_req *prev = next->prev;\n    req->next = next;\n    req->prev = prev;\n    prev->next = req;\n    next->prev = req;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void list_add_req(struct fuse_req *req, struct fuse_req *next)\n{\n    struct fuse_req *prev = next->prev;\n    req->next = next;\n    req->prev = prev;\n    prev->next = req;\n    next->prev = req;\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_interrupt",
          "args": [
            "se",
            "req"
          ],
          "line": 2493
        },
        "resolved": true,
        "details": {
          "function_name": "check_interrupt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "1683-1705",
          "snippet": "static struct fuse_req *check_interrupt(struct fuse_session *se,\n                                        struct fuse_req *req)\n{\n    struct fuse_req *curr;\n\n    for (curr = se->interrupts.next; curr != &se->interrupts;\n         curr = curr->next) {\n        if (curr->u.i.unique == req->unique) {\n            req->interrupted = 1;\n            list_del_req(curr);\n            free(curr);\n            return NULL;\n        }\n    }\n    curr = se->interrupts.next;\n    if (curr != &se->interrupts) {\n        list_del_req(curr);\n        list_init_req(curr);\n        return curr;\n    } else {\n        return NULL;\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic struct fuse_req *check_interrupt(struct fuse_session *se,\n                                        struct fuse_req *req)\n{\n    struct fuse_req *curr;\n\n    for (curr = se->interrupts.next; curr != &se->interrupts;\n         curr = curr->next) {\n        if (curr->u.i.unique == req->unique) {\n            req->interrupted = 1;\n            list_del_req(curr);\n            free(curr);\n            return NULL;\n        }\n    }\n    curr = se->interrupts.next;\n    if (curr != &se->interrupts) {\n        list_del_req(curr);\n        list_init_req(curr);\n        return curr;\n    } else {\n        return NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&se->lock"
          ],
          "line": 2492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "se->op.destroy",
          "args": [
            "se->userdata"
          ],
          "line": 2468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_DEBUG",
            "\"%s: reinit\\n\"",
            "__func__"
          ],
          "line": 2464
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_lowlevel_is_virtio",
          "args": [
            "se"
          ],
          "line": 2458
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_lowlevel_is_virtio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "2675-2678",
          "snippet": "int fuse_lowlevel_is_virtio(struct fuse_session *se)\n{\n    return !!se->virtio_dev;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_lowlevel_is_virtio(struct fuse_session *se)\n{\n    return !!se->virtio_dev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_rwlock_rdlock",
          "args": [
            "&se->init_rwlock"
          ],
          "line": 2446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_rwlock_wrlock",
          "args": [
            "&se->init_rwlock"
          ],
          "line": 2444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_send_msg",
          "args": [
            "se",
            "ch",
            "&iov",
            "1"
          ],
          "line": 2426
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_send_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "157-182",
          "snippet": "static int fuse_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count)\n{\n    struct fuse_out_header *out = iov[0].iov_base;\n\n    out->len = iov_length(iov, count);\n    if (out->unique == 0) {\n        fuse_log(FUSE_LOG_DEBUG, \"NOTIFY: code=%d length=%u\\n\", out->error,\n                 out->len);\n    } else if (out->error) {\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"   unique: %llu, error: %i (%s), outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->error,\n                 strerror(-out->error), out->len);\n    } else {\n        fuse_log(FUSE_LOG_DEBUG, \"   unique: %llu, success, outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->len);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        return virtio_send_msg(se, ch, iov, count);\n    }\n\n    abort(); /* virtio should have taken it before here */\n    return 0;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count)\n{\n    struct fuse_out_header *out = iov[0].iov_base;\n\n    out->len = iov_length(iov, count);\n    if (out->unique == 0) {\n        fuse_log(FUSE_LOG_DEBUG, \"NOTIFY: code=%d length=%u\\n\", out->error,\n                 out->len);\n    } else if (out->error) {\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"   unique: %llu, error: %i (%s), outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->error,\n                 strerror(-out->error), out->len);\n    } else {\n        fuse_log(FUSE_LOG_DEBUG, \"   unique: %llu, success, outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->len);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        return virtio_send_msg(se, ch, iov, count);\n    }\n\n    abort(); /* virtio should have taken it before here */\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_ll_alloc_req",
          "args": [
            "se"
          ],
          "line": 2415
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_ll_alloc_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "139-154",
          "snippet": "static struct fuse_req *fuse_ll_alloc_req(struct fuse_session *se)\n{\n    struct fuse_req *req;\n\n    req = (struct fuse_req *)calloc(1, sizeof(struct fuse_req));\n    if (req == NULL) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: failed to allocate request\\n\");\n    } else {\n        req->se = se;\n        req->ctr = 1;\n        list_init_req(req);\n        fuse_mutex_init(&req->lock);\n    }\n\n    return req;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic struct fuse_req *fuse_ll_alloc_req(struct fuse_session *se)\n{\n    struct fuse_req *req;\n\n    req = (struct fuse_req *)calloc(1, sizeof(struct fuse_req));\n    if (req == NULL) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: failed to allocate request\\n\");\n    } else {\n        req->se = se;\n        req->ctr = 1;\n        list_init_req(req);\n        fuse_mutex_init(&req->lock);\n    }\n\n    return req;\n}"
        }
      },
      {
        "call_info": {
          "callee": "opname",
          "args": [
            "(enum fuse_opcode)in->opcode"
          ],
          "line": 2412
        },
        "resolved": true,
        "details": {
          "function_name": "opname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "2368-2375",
          "snippet": "static const char *opname(enum fuse_opcode opcode)\n{\n    if (opcode >= FUSE_MAXOP || !fuse_ll_ops[opcode].name) {\n        return \"???\";\n    } else {\n        return fuse_ll_ops[opcode].name;\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [
            "#define FUSE_MAXOP (sizeof(fuse_ll_ops) / sizeof(fuse_ll_ops[0]))"
          ],
          "globals_used": [
            "static struct {\n    void (*func)(fuse_req_t, fuse_ino_t, struct fuse_mbuf_iter *);\n    const char *name;\n} fuse_ll_ops[] = {\n    [FUSE_LOOKUP] = { do_lookup, \"LOOKUP\" },\n    [FUSE_FORGET] = { do_forget, \"FORGET\" },\n    [FUSE_GETATTR] = { do_getattr, \"GETATTR\" },\n    [FUSE_SETATTR] = { do_setattr, \"SETATTR\" },\n    [FUSE_READLINK] = { do_readlink, \"READLINK\" },\n    [FUSE_SYMLINK] = { do_symlink, \"SYMLINK\" },\n    [FUSE_MKNOD] = { do_mknod, \"MKNOD\" },\n    [FUSE_MKDIR] = { do_mkdir, \"MKDIR\" },\n    [FUSE_UNLINK] = { do_unlink, \"UNLINK\" },\n    [FUSE_RMDIR] = { do_rmdir, \"RMDIR\" },\n    [FUSE_RENAME] = { do_rename, \"RENAME\" },\n    [FUSE_LINK] = { do_link, \"LINK\" },\n    [FUSE_OPEN] = { do_open, \"OPEN\" },\n    [FUSE_READ] = { do_read, \"READ\" },\n    [FUSE_WRITE] = { do_write, \"WRITE\" },\n    [FUSE_STATFS] = { do_statfs, \"STATFS\" },\n    [FUSE_RELEASE] = { do_release, \"RELEASE\" },\n    [FUSE_FSYNC] = { do_fsync, \"FSYNC\" },\n    [FUSE_SETXATTR] = { do_setxattr, \"SETXATTR\" },\n    [FUSE_GETXATTR] = { do_getxattr, \"GETXATTR\" },\n    [FUSE_LISTXATTR] = { do_listxattr, \"LISTXATTR\" },\n    [FUSE_REMOVEXATTR] = { do_removexattr, \"REMOVEXATTR\" },\n    [FUSE_FLUSH] = { do_flush, \"FLUSH\" },\n    [FUSE_INIT] = { do_init, \"INIT\" },\n    [FUSE_OPENDIR] = { do_opendir, \"OPENDIR\" },\n    [FUSE_READDIR] = { do_readdir, \"READDIR\" },\n    [FUSE_RELEASEDIR] = { do_releasedir, \"RELEASEDIR\" },\n    [FUSE_FSYNCDIR] = { do_fsyncdir, \"FSYNCDIR\" },\n    [FUSE_GETLK] = { do_getlk, \"GETLK\" },\n    [FUSE_SETLK] = { do_setlk, \"SETLK\" },\n    [FUSE_SETLKW] = { do_setlkw, \"SETLKW\" },\n    [FUSE_ACCESS] = { do_access, \"ACCESS\" },\n    [FUSE_CREATE] = { do_create, \"CREATE\" },\n    [FUSE_INTERRUPT] = { do_interrupt, \"INTERRUPT\" },\n    [FUSE_BMAP] = { do_bmap, \"BMAP\" },\n    [FUSE_IOCTL] = { do_ioctl, \"IOCTL\" },\n    [FUSE_POLL] = { do_poll, \"POLL\" },\n    [FUSE_FALLOCATE] = { do_fallocate, \"FALLOCATE\" },\n    [FUSE_DESTROY] = { do_destroy, \"DESTROY\" },\n    [FUSE_NOTIFY_REPLY] = { NULL, \"NOTIFY_REPLY\" },\n    [FUSE_BATCH_FORGET] = { do_batch_forget, \"BATCH_FORGET\" },\n    [FUSE_READDIRPLUS] = { do_readdirplus, \"READDIRPLUS\" },\n    [FUSE_RENAME2] = { do_rename2, \"RENAME2\" },\n    [FUSE_COPY_FILE_RANGE] = { do_copy_file_range, \"COPY_FILE_RANGE\" },\n    [FUSE_LSEEK] = { do_lseek, \"LSEEK\" },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\n#define FUSE_MAXOP (sizeof(fuse_ll_ops) / sizeof(fuse_ll_ops[0]))\n\nstatic struct {\n    void (*func)(fuse_req_t, fuse_ino_t, struct fuse_mbuf_iter *);\n    const char *name;\n} fuse_ll_ops[] = {\n    [FUSE_LOOKUP] = { do_lookup, \"LOOKUP\" },\n    [FUSE_FORGET] = { do_forget, \"FORGET\" },\n    [FUSE_GETATTR] = { do_getattr, \"GETATTR\" },\n    [FUSE_SETATTR] = { do_setattr, \"SETATTR\" },\n    [FUSE_READLINK] = { do_readlink, \"READLINK\" },\n    [FUSE_SYMLINK] = { do_symlink, \"SYMLINK\" },\n    [FUSE_MKNOD] = { do_mknod, \"MKNOD\" },\n    [FUSE_MKDIR] = { do_mkdir, \"MKDIR\" },\n    [FUSE_UNLINK] = { do_unlink, \"UNLINK\" },\n    [FUSE_RMDIR] = { do_rmdir, \"RMDIR\" },\n    [FUSE_RENAME] = { do_rename, \"RENAME\" },\n    [FUSE_LINK] = { do_link, \"LINK\" },\n    [FUSE_OPEN] = { do_open, \"OPEN\" },\n    [FUSE_READ] = { do_read, \"READ\" },\n    [FUSE_WRITE] = { do_write, \"WRITE\" },\n    [FUSE_STATFS] = { do_statfs, \"STATFS\" },\n    [FUSE_RELEASE] = { do_release, \"RELEASE\" },\n    [FUSE_FSYNC] = { do_fsync, \"FSYNC\" },\n    [FUSE_SETXATTR] = { do_setxattr, \"SETXATTR\" },\n    [FUSE_GETXATTR] = { do_getxattr, \"GETXATTR\" },\n    [FUSE_LISTXATTR] = { do_listxattr, \"LISTXATTR\" },\n    [FUSE_REMOVEXATTR] = { do_removexattr, \"REMOVEXATTR\" },\n    [FUSE_FLUSH] = { do_flush, \"FLUSH\" },\n    [FUSE_INIT] = { do_init, \"INIT\" },\n    [FUSE_OPENDIR] = { do_opendir, \"OPENDIR\" },\n    [FUSE_READDIR] = { do_readdir, \"READDIR\" },\n    [FUSE_RELEASEDIR] = { do_releasedir, \"RELEASEDIR\" },\n    [FUSE_FSYNCDIR] = { do_fsyncdir, \"FSYNCDIR\" },\n    [FUSE_GETLK] = { do_getlk, \"GETLK\" },\n    [FUSE_SETLK] = { do_setlk, \"SETLK\" },\n    [FUSE_SETLKW] = { do_setlkw, \"SETLKW\" },\n    [FUSE_ACCESS] = { do_access, \"ACCESS\" },\n    [FUSE_CREATE] = { do_create, \"CREATE\" },\n    [FUSE_INTERRUPT] = { do_interrupt, \"INTERRUPT\" },\n    [FUSE_BMAP] = { do_bmap, \"BMAP\" },\n    [FUSE_IOCTL] = { do_ioctl, \"IOCTL\" },\n    [FUSE_POLL] = { do_poll, \"POLL\" },\n    [FUSE_FALLOCATE] = { do_fallocate, \"FALLOCATE\" },\n    [FUSE_DESTROY] = { do_destroy, \"DESTROY\" },\n    [FUSE_NOTIFY_REPLY] = { NULL, \"NOTIFY_REPLY\" },\n    [FUSE_BATCH_FORGET] = { do_batch_forget, \"BATCH_FORGET\" },\n    [FUSE_READDIRPLUS] = { do_readdirplus, \"READDIRPLUS\" },\n    [FUSE_RENAME2] = { do_rename2, \"RENAME2\" },\n    [FUSE_COPY_FILE_RANGE] = { do_copy_file_range, \"COPY_FILE_RANGE\" },\n    [FUSE_LSEEK] = { do_lseek, \"LSEEK\" },\n};\n\nstatic const char *opname(enum fuse_opcode opcode)\n{\n    if (opcode >= FUSE_MAXOP || !fuse_ll_ops[opcode].name) {\n        return \"???\";\n    } else {\n        return fuse_ll_ops[opcode].name;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "in"
          ],
          "line": 2407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "&iter",
            "sizeof(*in)"
          ],
          "line": 2406
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!(buf->flags & FUSE_BUF_IS_FD)"
          ],
          "line": 2404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FUSE_MBUF_ITER_INIT",
          "args": [
            "buf"
          ],
          "line": 2398
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\n#define FUSE_MAXOP (sizeof(fuse_ll_ops) / sizeof(fuse_ll_ops[0]))\n\nstatic struct {\n    void (*func)(fuse_req_t, fuse_ino_t, struct fuse_mbuf_iter *);\n    const char *name;\n} fuse_ll_ops[] = {\n    [FUSE_LOOKUP] = { do_lookup, \"LOOKUP\" },\n    [FUSE_FORGET] = { do_forget, \"FORGET\" },\n    [FUSE_GETATTR] = { do_getattr, \"GETATTR\" },\n    [FUSE_SETATTR] = { do_setattr, \"SETATTR\" },\n    [FUSE_READLINK] = { do_readlink, \"READLINK\" },\n    [FUSE_SYMLINK] = { do_symlink, \"SYMLINK\" },\n    [FUSE_MKNOD] = { do_mknod, \"MKNOD\" },\n    [FUSE_MKDIR] = { do_mkdir, \"MKDIR\" },\n    [FUSE_UNLINK] = { do_unlink, \"UNLINK\" },\n    [FUSE_RMDIR] = { do_rmdir, \"RMDIR\" },\n    [FUSE_RENAME] = { do_rename, \"RENAME\" },\n    [FUSE_LINK] = { do_link, \"LINK\" },\n    [FUSE_OPEN] = { do_open, \"OPEN\" },\n    [FUSE_READ] = { do_read, \"READ\" },\n    [FUSE_WRITE] = { do_write, \"WRITE\" },\n    [FUSE_STATFS] = { do_statfs, \"STATFS\" },\n    [FUSE_RELEASE] = { do_release, \"RELEASE\" },\n    [FUSE_FSYNC] = { do_fsync, \"FSYNC\" },\n    [FUSE_SETXATTR] = { do_setxattr, \"SETXATTR\" },\n    [FUSE_GETXATTR] = { do_getxattr, \"GETXATTR\" },\n    [FUSE_LISTXATTR] = { do_listxattr, \"LISTXATTR\" },\n    [FUSE_REMOVEXATTR] = { do_removexattr, \"REMOVEXATTR\" },\n    [FUSE_FLUSH] = { do_flush, \"FLUSH\" },\n    [FUSE_INIT] = { do_init, \"INIT\" },\n    [FUSE_OPENDIR] = { do_opendir, \"OPENDIR\" },\n    [FUSE_READDIR] = { do_readdir, \"READDIR\" },\n    [FUSE_RELEASEDIR] = { do_releasedir, \"RELEASEDIR\" },\n    [FUSE_FSYNCDIR] = { do_fsyncdir, \"FSYNCDIR\" },\n    [FUSE_GETLK] = { do_getlk, \"GETLK\" },\n    [FUSE_SETLK] = { do_setlk, \"SETLK\" },\n    [FUSE_SETLKW] = { do_setlkw, \"SETLKW\" },\n    [FUSE_ACCESS] = { do_access, \"ACCESS\" },\n    [FUSE_CREATE] = { do_create, \"CREATE\" },\n    [FUSE_INTERRUPT] = { do_interrupt, \"INTERRUPT\" },\n    [FUSE_BMAP] = { do_bmap, \"BMAP\" },\n    [FUSE_IOCTL] = { do_ioctl, \"IOCTL\" },\n    [FUSE_POLL] = { do_poll, \"POLL\" },\n    [FUSE_FALLOCATE] = { do_fallocate, \"FALLOCATE\" },\n    [FUSE_DESTROY] = { do_destroy, \"DESTROY\" },\n    [FUSE_NOTIFY_REPLY] = { NULL, \"NOTIFY_REPLY\" },\n    [FUSE_BATCH_FORGET] = { do_batch_forget, \"BATCH_FORGET\" },\n    [FUSE_READDIRPLUS] = { do_readdirplus, \"READDIRPLUS\" },\n    [FUSE_RENAME2] = { do_rename2, \"RENAME2\" },\n    [FUSE_COPY_FILE_RANGE] = { do_copy_file_range, \"COPY_FILE_RANGE\" },\n    [FUSE_LSEEK] = { do_lseek, \"LSEEK\" },\n};\n\nvoid fuse_session_process_buf_int(struct fuse_session *se,\n                                  struct fuse_bufvec *bufv,\n                                  struct fuse_chan *ch)\n{\n    const struct fuse_buf *buf = bufv->buf;\n    struct fuse_mbuf_iter iter = FUSE_MBUF_ITER_INIT(buf);\n    struct fuse_in_header *in;\n    struct fuse_req *req;\n    int err;\n\n    /* The first buffer must be a memory buffer */\n    assert(!(buf->flags & FUSE_BUF_IS_FD));\n\n    in = fuse_mbuf_iter_advance(&iter, sizeof(*in));\n    assert(in); /* caller guarantees the input buffer is large enough */\n\n    fuse_log(\n        FUSE_LOG_DEBUG,\n        \"unique: %llu, opcode: %s (%i), nodeid: %llu, insize: %zu, pid: %u\\n\",\n        (unsigned long long)in->unique, opname((enum fuse_opcode)in->opcode),\n        in->opcode, (unsigned long long)in->nodeid, buf->size, in->pid);\n\n    req = fuse_ll_alloc_req(se);\n    if (req == NULL) {\n        struct fuse_out_header out = {\n            .unique = in->unique,\n            .error = -ENOMEM,\n        };\n        struct iovec iov = {\n            .iov_base = &out,\n            .iov_len = sizeof(struct fuse_out_header),\n        };\n\n        fuse_send_msg(se, ch, &iov, 1);\n        return;\n    }\n\n    req->unique = in->unique;\n    req->ctx.uid = in->uid;\n    req->ctx.gid = in->gid;\n    req->ctx.pid = in->pid;\n    req->ch = ch;\n\n    /*\n     * INIT and DESTROY requests are serialized, all other request types\n     * run in parallel.  This prevents races between FUSE_INIT and ordinary\n     * requests, FUSE_INIT and FUSE_INIT, FUSE_INIT and FUSE_DESTROY, and\n     * FUSE_DESTROY and FUSE_DESTROY.\n     */\n    if (in->opcode == FUSE_INIT || in->opcode == CUSE_INIT ||\n        in->opcode == FUSE_DESTROY) {\n        pthread_rwlock_wrlock(&se->init_rwlock);\n    } else {\n        pthread_rwlock_rdlock(&se->init_rwlock);\n    }\n\n    err = EIO;\n    if (!se->got_init) {\n        enum fuse_opcode expected;\n\n        expected = se->cuse_data ? CUSE_INIT : FUSE_INIT;\n        if (in->opcode != expected) {\n            goto reply_err;\n        }\n    } else if (in->opcode == FUSE_INIT || in->opcode == CUSE_INIT) {\n        if (fuse_lowlevel_is_virtio(se)) {\n            /*\n             * TODO: This is after a hard reboot typically, we need to do\n             * a destroy, but we can't reply to this request yet so\n             * we can't use do_destroy\n             */\n            fuse_log(FUSE_LOG_DEBUG, \"%s: reinit\\n\", __func__);\n            se->got_destroy = 1;\n            se->got_init = 0;\n            if (se->op.destroy) {\n                se->op.destroy(se->userdata);\n            }\n        } else {\n            goto reply_err;\n        }\n    }\n\n    err = EACCES;\n    /* Implement -o allow_root */\n    if (se->deny_others && in->uid != se->owner && in->uid != 0 &&\n        in->opcode != FUSE_INIT && in->opcode != FUSE_READ &&\n        in->opcode != FUSE_WRITE && in->opcode != FUSE_FSYNC &&\n        in->opcode != FUSE_RELEASE && in->opcode != FUSE_READDIR &&\n        in->opcode != FUSE_FSYNCDIR && in->opcode != FUSE_RELEASEDIR &&\n        in->opcode != FUSE_NOTIFY_REPLY && in->opcode != FUSE_READDIRPLUS) {\n        goto reply_err;\n    }\n\n    err = ENOSYS;\n    if (in->opcode >= FUSE_MAXOP || !fuse_ll_ops[in->opcode].func) {\n        goto reply_err;\n    }\n    if (in->opcode != FUSE_INTERRUPT) {\n        struct fuse_req *intr;\n        pthread_mutex_lock(&se->lock);\n        intr = check_interrupt(se, req);\n        list_add_req(req, &se->list);\n        pthread_mutex_unlock(&se->lock);\n        if (intr) {\n            fuse_reply_err(intr, EAGAIN);\n        }\n    }\n\n    if (in->opcode == FUSE_WRITE && se->op.write_buf) {\n        do_write_buf(req, in->nodeid, &iter, bufv);\n    } else {\n        fuse_ll_ops[in->opcode].func(req, in->nodeid, &iter);\n    }\n\n    pthread_rwlock_unlock(&se->init_rwlock);\n    return;\n\nreply_err:\n    fuse_reply_err(req, err);\n    pthread_rwlock_unlock(&se->init_rwlock);\n}"
  },
  {
    "function_name": "fuse_session_process_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2377-2382",
    "snippet": "void fuse_session_process_buf(struct fuse_session *se,\n                              const struct fuse_buf *buf)\n{\n    struct fuse_bufvec bufv = { .buf[0] = *buf, .count = 1 };\n    fuse_session_process_buf_int(se, &bufv, NULL);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_session_process_buf_int",
          "args": [
            "se",
            "&bufv",
            "NULL"
          ],
          "line": 2381
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_session_process_buf_int",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "2393-2513",
          "snippet": "void fuse_session_process_buf_int(struct fuse_session *se,\n                                  struct fuse_bufvec *bufv,\n                                  struct fuse_chan *ch)\n{\n    const struct fuse_buf *buf = bufv->buf;\n    struct fuse_mbuf_iter iter = FUSE_MBUF_ITER_INIT(buf);\n    struct fuse_in_header *in;\n    struct fuse_req *req;\n    int err;\n\n    /* The first buffer must be a memory buffer */\n    assert(!(buf->flags & FUSE_BUF_IS_FD));\n\n    in = fuse_mbuf_iter_advance(&iter, sizeof(*in));\n    assert(in); /* caller guarantees the input buffer is large enough */\n\n    fuse_log(\n        FUSE_LOG_DEBUG,\n        \"unique: %llu, opcode: %s (%i), nodeid: %llu, insize: %zu, pid: %u\\n\",\n        (unsigned long long)in->unique, opname((enum fuse_opcode)in->opcode),\n        in->opcode, (unsigned long long)in->nodeid, buf->size, in->pid);\n\n    req = fuse_ll_alloc_req(se);\n    if (req == NULL) {\n        struct fuse_out_header out = {\n            .unique = in->unique,\n            .error = -ENOMEM,\n        };\n        struct iovec iov = {\n            .iov_base = &out,\n            .iov_len = sizeof(struct fuse_out_header),\n        };\n\n        fuse_send_msg(se, ch, &iov, 1);\n        return;\n    }\n\n    req->unique = in->unique;\n    req->ctx.uid = in->uid;\n    req->ctx.gid = in->gid;\n    req->ctx.pid = in->pid;\n    req->ch = ch;\n\n    /*\n     * INIT and DESTROY requests are serialized, all other request types\n     * run in parallel.  This prevents races between FUSE_INIT and ordinary\n     * requests, FUSE_INIT and FUSE_INIT, FUSE_INIT and FUSE_DESTROY, and\n     * FUSE_DESTROY and FUSE_DESTROY.\n     */\n    if (in->opcode == FUSE_INIT || in->opcode == CUSE_INIT ||\n        in->opcode == FUSE_DESTROY) {\n        pthread_rwlock_wrlock(&se->init_rwlock);\n    } else {\n        pthread_rwlock_rdlock(&se->init_rwlock);\n    }\n\n    err = EIO;\n    if (!se->got_init) {\n        enum fuse_opcode expected;\n\n        expected = se->cuse_data ? CUSE_INIT : FUSE_INIT;\n        if (in->opcode != expected) {\n            goto reply_err;\n        }\n    } else if (in->opcode == FUSE_INIT || in->opcode == CUSE_INIT) {\n        if (fuse_lowlevel_is_virtio(se)) {\n            /*\n             * TODO: This is after a hard reboot typically, we need to do\n             * a destroy, but we can't reply to this request yet so\n             * we can't use do_destroy\n             */\n            fuse_log(FUSE_LOG_DEBUG, \"%s: reinit\\n\", __func__);\n            se->got_destroy = 1;\n            se->got_init = 0;\n            if (se->op.destroy) {\n                se->op.destroy(se->userdata);\n            }\n        } else {\n            goto reply_err;\n        }\n    }\n\n    err = EACCES;\n    /* Implement -o allow_root */\n    if (se->deny_others && in->uid != se->owner && in->uid != 0 &&\n        in->opcode != FUSE_INIT && in->opcode != FUSE_READ &&\n        in->opcode != FUSE_WRITE && in->opcode != FUSE_FSYNC &&\n        in->opcode != FUSE_RELEASE && in->opcode != FUSE_READDIR &&\n        in->opcode != FUSE_FSYNCDIR && in->opcode != FUSE_RELEASEDIR &&\n        in->opcode != FUSE_NOTIFY_REPLY && in->opcode != FUSE_READDIRPLUS) {\n        goto reply_err;\n    }\n\n    err = ENOSYS;\n    if (in->opcode >= FUSE_MAXOP || !fuse_ll_ops[in->opcode].func) {\n        goto reply_err;\n    }\n    if (in->opcode != FUSE_INTERRUPT) {\n        struct fuse_req *intr;\n        pthread_mutex_lock(&se->lock);\n        intr = check_interrupt(se, req);\n        list_add_req(req, &se->list);\n        pthread_mutex_unlock(&se->lock);\n        if (intr) {\n            fuse_reply_err(intr, EAGAIN);\n        }\n    }\n\n    if (in->opcode == FUSE_WRITE && se->op.write_buf) {\n        do_write_buf(req, in->nodeid, &iter, bufv);\n    } else {\n        fuse_ll_ops[in->opcode].func(req, in->nodeid, &iter);\n    }\n\n    pthread_rwlock_unlock(&se->init_rwlock);\n    return;\n\nreply_err:\n    fuse_reply_err(req, err);\n    pthread_rwlock_unlock(&se->init_rwlock);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [
            "#define FUSE_MAXOP (sizeof(fuse_ll_ops) / sizeof(fuse_ll_ops[0]))"
          ],
          "globals_used": [
            "static struct {\n    void (*func)(fuse_req_t, fuse_ino_t, struct fuse_mbuf_iter *);\n    const char *name;\n} fuse_ll_ops[] = {\n    [FUSE_LOOKUP] = { do_lookup, \"LOOKUP\" },\n    [FUSE_FORGET] = { do_forget, \"FORGET\" },\n    [FUSE_GETATTR] = { do_getattr, \"GETATTR\" },\n    [FUSE_SETATTR] = { do_setattr, \"SETATTR\" },\n    [FUSE_READLINK] = { do_readlink, \"READLINK\" },\n    [FUSE_SYMLINK] = { do_symlink, \"SYMLINK\" },\n    [FUSE_MKNOD] = { do_mknod, \"MKNOD\" },\n    [FUSE_MKDIR] = { do_mkdir, \"MKDIR\" },\n    [FUSE_UNLINK] = { do_unlink, \"UNLINK\" },\n    [FUSE_RMDIR] = { do_rmdir, \"RMDIR\" },\n    [FUSE_RENAME] = { do_rename, \"RENAME\" },\n    [FUSE_LINK] = { do_link, \"LINK\" },\n    [FUSE_OPEN] = { do_open, \"OPEN\" },\n    [FUSE_READ] = { do_read, \"READ\" },\n    [FUSE_WRITE] = { do_write, \"WRITE\" },\n    [FUSE_STATFS] = { do_statfs, \"STATFS\" },\n    [FUSE_RELEASE] = { do_release, \"RELEASE\" },\n    [FUSE_FSYNC] = { do_fsync, \"FSYNC\" },\n    [FUSE_SETXATTR] = { do_setxattr, \"SETXATTR\" },\n    [FUSE_GETXATTR] = { do_getxattr, \"GETXATTR\" },\n    [FUSE_LISTXATTR] = { do_listxattr, \"LISTXATTR\" },\n    [FUSE_REMOVEXATTR] = { do_removexattr, \"REMOVEXATTR\" },\n    [FUSE_FLUSH] = { do_flush, \"FLUSH\" },\n    [FUSE_INIT] = { do_init, \"INIT\" },\n    [FUSE_OPENDIR] = { do_opendir, \"OPENDIR\" },\n    [FUSE_READDIR] = { do_readdir, \"READDIR\" },\n    [FUSE_RELEASEDIR] = { do_releasedir, \"RELEASEDIR\" },\n    [FUSE_FSYNCDIR] = { do_fsyncdir, \"FSYNCDIR\" },\n    [FUSE_GETLK] = { do_getlk, \"GETLK\" },\n    [FUSE_SETLK] = { do_setlk, \"SETLK\" },\n    [FUSE_SETLKW] = { do_setlkw, \"SETLKW\" },\n    [FUSE_ACCESS] = { do_access, \"ACCESS\" },\n    [FUSE_CREATE] = { do_create, \"CREATE\" },\n    [FUSE_INTERRUPT] = { do_interrupt, \"INTERRUPT\" },\n    [FUSE_BMAP] = { do_bmap, \"BMAP\" },\n    [FUSE_IOCTL] = { do_ioctl, \"IOCTL\" },\n    [FUSE_POLL] = { do_poll, \"POLL\" },\n    [FUSE_FALLOCATE] = { do_fallocate, \"FALLOCATE\" },\n    [FUSE_DESTROY] = { do_destroy, \"DESTROY\" },\n    [FUSE_NOTIFY_REPLY] = { NULL, \"NOTIFY_REPLY\" },\n    [FUSE_BATCH_FORGET] = { do_batch_forget, \"BATCH_FORGET\" },\n    [FUSE_READDIRPLUS] = { do_readdirplus, \"READDIRPLUS\" },\n    [FUSE_RENAME2] = { do_rename2, \"RENAME2\" },\n    [FUSE_COPY_FILE_RANGE] = { do_copy_file_range, \"COPY_FILE_RANGE\" },\n    [FUSE_LSEEK] = { do_lseek, \"LSEEK\" },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\n#define FUSE_MAXOP (sizeof(fuse_ll_ops) / sizeof(fuse_ll_ops[0]))\n\nstatic struct {\n    void (*func)(fuse_req_t, fuse_ino_t, struct fuse_mbuf_iter *);\n    const char *name;\n} fuse_ll_ops[] = {\n    [FUSE_LOOKUP] = { do_lookup, \"LOOKUP\" },\n    [FUSE_FORGET] = { do_forget, \"FORGET\" },\n    [FUSE_GETATTR] = { do_getattr, \"GETATTR\" },\n    [FUSE_SETATTR] = { do_setattr, \"SETATTR\" },\n    [FUSE_READLINK] = { do_readlink, \"READLINK\" },\n    [FUSE_SYMLINK] = { do_symlink, \"SYMLINK\" },\n    [FUSE_MKNOD] = { do_mknod, \"MKNOD\" },\n    [FUSE_MKDIR] = { do_mkdir, \"MKDIR\" },\n    [FUSE_UNLINK] = { do_unlink, \"UNLINK\" },\n    [FUSE_RMDIR] = { do_rmdir, \"RMDIR\" },\n    [FUSE_RENAME] = { do_rename, \"RENAME\" },\n    [FUSE_LINK] = { do_link, \"LINK\" },\n    [FUSE_OPEN] = { do_open, \"OPEN\" },\n    [FUSE_READ] = { do_read, \"READ\" },\n    [FUSE_WRITE] = { do_write, \"WRITE\" },\n    [FUSE_STATFS] = { do_statfs, \"STATFS\" },\n    [FUSE_RELEASE] = { do_release, \"RELEASE\" },\n    [FUSE_FSYNC] = { do_fsync, \"FSYNC\" },\n    [FUSE_SETXATTR] = { do_setxattr, \"SETXATTR\" },\n    [FUSE_GETXATTR] = { do_getxattr, \"GETXATTR\" },\n    [FUSE_LISTXATTR] = { do_listxattr, \"LISTXATTR\" },\n    [FUSE_REMOVEXATTR] = { do_removexattr, \"REMOVEXATTR\" },\n    [FUSE_FLUSH] = { do_flush, \"FLUSH\" },\n    [FUSE_INIT] = { do_init, \"INIT\" },\n    [FUSE_OPENDIR] = { do_opendir, \"OPENDIR\" },\n    [FUSE_READDIR] = { do_readdir, \"READDIR\" },\n    [FUSE_RELEASEDIR] = { do_releasedir, \"RELEASEDIR\" },\n    [FUSE_FSYNCDIR] = { do_fsyncdir, \"FSYNCDIR\" },\n    [FUSE_GETLK] = { do_getlk, \"GETLK\" },\n    [FUSE_SETLK] = { do_setlk, \"SETLK\" },\n    [FUSE_SETLKW] = { do_setlkw, \"SETLKW\" },\n    [FUSE_ACCESS] = { do_access, \"ACCESS\" },\n    [FUSE_CREATE] = { do_create, \"CREATE\" },\n    [FUSE_INTERRUPT] = { do_interrupt, \"INTERRUPT\" },\n    [FUSE_BMAP] = { do_bmap, \"BMAP\" },\n    [FUSE_IOCTL] = { do_ioctl, \"IOCTL\" },\n    [FUSE_POLL] = { do_poll, \"POLL\" },\n    [FUSE_FALLOCATE] = { do_fallocate, \"FALLOCATE\" },\n    [FUSE_DESTROY] = { do_destroy, \"DESTROY\" },\n    [FUSE_NOTIFY_REPLY] = { NULL, \"NOTIFY_REPLY\" },\n    [FUSE_BATCH_FORGET] = { do_batch_forget, \"BATCH_FORGET\" },\n    [FUSE_READDIRPLUS] = { do_readdirplus, \"READDIRPLUS\" },\n    [FUSE_RENAME2] = { do_rename2, \"RENAME2\" },\n    [FUSE_COPY_FILE_RANGE] = { do_copy_file_range, \"COPY_FILE_RANGE\" },\n    [FUSE_LSEEK] = { do_lseek, \"LSEEK\" },\n};\n\nvoid fuse_session_process_buf_int(struct fuse_session *se,\n                                  struct fuse_bufvec *bufv,\n                                  struct fuse_chan *ch)\n{\n    const struct fuse_buf *buf = bufv->buf;\n    struct fuse_mbuf_iter iter = FUSE_MBUF_ITER_INIT(buf);\n    struct fuse_in_header *in;\n    struct fuse_req *req;\n    int err;\n\n    /* The first buffer must be a memory buffer */\n    assert(!(buf->flags & FUSE_BUF_IS_FD));\n\n    in = fuse_mbuf_iter_advance(&iter, sizeof(*in));\n    assert(in); /* caller guarantees the input buffer is large enough */\n\n    fuse_log(\n        FUSE_LOG_DEBUG,\n        \"unique: %llu, opcode: %s (%i), nodeid: %llu, insize: %zu, pid: %u\\n\",\n        (unsigned long long)in->unique, opname((enum fuse_opcode)in->opcode),\n        in->opcode, (unsigned long long)in->nodeid, buf->size, in->pid);\n\n    req = fuse_ll_alloc_req(se);\n    if (req == NULL) {\n        struct fuse_out_header out = {\n            .unique = in->unique,\n            .error = -ENOMEM,\n        };\n        struct iovec iov = {\n            .iov_base = &out,\n            .iov_len = sizeof(struct fuse_out_header),\n        };\n\n        fuse_send_msg(se, ch, &iov, 1);\n        return;\n    }\n\n    req->unique = in->unique;\n    req->ctx.uid = in->uid;\n    req->ctx.gid = in->gid;\n    req->ctx.pid = in->pid;\n    req->ch = ch;\n\n    /*\n     * INIT and DESTROY requests are serialized, all other request types\n     * run in parallel.  This prevents races between FUSE_INIT and ordinary\n     * requests, FUSE_INIT and FUSE_INIT, FUSE_INIT and FUSE_DESTROY, and\n     * FUSE_DESTROY and FUSE_DESTROY.\n     */\n    if (in->opcode == FUSE_INIT || in->opcode == CUSE_INIT ||\n        in->opcode == FUSE_DESTROY) {\n        pthread_rwlock_wrlock(&se->init_rwlock);\n    } else {\n        pthread_rwlock_rdlock(&se->init_rwlock);\n    }\n\n    err = EIO;\n    if (!se->got_init) {\n        enum fuse_opcode expected;\n\n        expected = se->cuse_data ? CUSE_INIT : FUSE_INIT;\n        if (in->opcode != expected) {\n            goto reply_err;\n        }\n    } else if (in->opcode == FUSE_INIT || in->opcode == CUSE_INIT) {\n        if (fuse_lowlevel_is_virtio(se)) {\n            /*\n             * TODO: This is after a hard reboot typically, we need to do\n             * a destroy, but we can't reply to this request yet so\n             * we can't use do_destroy\n             */\n            fuse_log(FUSE_LOG_DEBUG, \"%s: reinit\\n\", __func__);\n            se->got_destroy = 1;\n            se->got_init = 0;\n            if (se->op.destroy) {\n                se->op.destroy(se->userdata);\n            }\n        } else {\n            goto reply_err;\n        }\n    }\n\n    err = EACCES;\n    /* Implement -o allow_root */\n    if (se->deny_others && in->uid != se->owner && in->uid != 0 &&\n        in->opcode != FUSE_INIT && in->opcode != FUSE_READ &&\n        in->opcode != FUSE_WRITE && in->opcode != FUSE_FSYNC &&\n        in->opcode != FUSE_RELEASE && in->opcode != FUSE_READDIR &&\n        in->opcode != FUSE_FSYNCDIR && in->opcode != FUSE_RELEASEDIR &&\n        in->opcode != FUSE_NOTIFY_REPLY && in->opcode != FUSE_READDIRPLUS) {\n        goto reply_err;\n    }\n\n    err = ENOSYS;\n    if (in->opcode >= FUSE_MAXOP || !fuse_ll_ops[in->opcode].func) {\n        goto reply_err;\n    }\n    if (in->opcode != FUSE_INTERRUPT) {\n        struct fuse_req *intr;\n        pthread_mutex_lock(&se->lock);\n        intr = check_interrupt(se, req);\n        list_add_req(req, &se->list);\n        pthread_mutex_unlock(&se->lock);\n        if (intr) {\n            fuse_reply_err(intr, EAGAIN);\n        }\n    }\n\n    if (in->opcode == FUSE_WRITE && se->op.write_buf) {\n        do_write_buf(req, in->nodeid, &iter, bufv);\n    } else {\n        fuse_ll_ops[in->opcode].func(req, in->nodeid, &iter);\n    }\n\n    pthread_rwlock_unlock(&se->init_rwlock);\n    return;\n\nreply_err:\n    fuse_reply_err(req, err);\n    pthread_rwlock_unlock(&se->init_rwlock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_session_process_buf(struct fuse_session *se,\n                              const struct fuse_buf *buf)\n{\n    struct fuse_bufvec bufv = { .buf[0] = *buf, .count = 1 };\n    fuse_session_process_buf_int(se, &bufv, NULL);\n}"
  },
  {
    "function_name": "opname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2368-2375",
    "snippet": "static const char *opname(enum fuse_opcode opcode)\n{\n    if (opcode >= FUSE_MAXOP || !fuse_ll_ops[opcode].name) {\n        return \"???\";\n    } else {\n        return fuse_ll_ops[opcode].name;\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [
      "#define FUSE_MAXOP (sizeof(fuse_ll_ops) / sizeof(fuse_ll_ops[0]))"
    ],
    "globals_used": [
      "static struct {\n    void (*func)(fuse_req_t, fuse_ino_t, struct fuse_mbuf_iter *);\n    const char *name;\n} fuse_ll_ops[] = {\n    [FUSE_LOOKUP] = { do_lookup, \"LOOKUP\" },\n    [FUSE_FORGET] = { do_forget, \"FORGET\" },\n    [FUSE_GETATTR] = { do_getattr, \"GETATTR\" },\n    [FUSE_SETATTR] = { do_setattr, \"SETATTR\" },\n    [FUSE_READLINK] = { do_readlink, \"READLINK\" },\n    [FUSE_SYMLINK] = { do_symlink, \"SYMLINK\" },\n    [FUSE_MKNOD] = { do_mknod, \"MKNOD\" },\n    [FUSE_MKDIR] = { do_mkdir, \"MKDIR\" },\n    [FUSE_UNLINK] = { do_unlink, \"UNLINK\" },\n    [FUSE_RMDIR] = { do_rmdir, \"RMDIR\" },\n    [FUSE_RENAME] = { do_rename, \"RENAME\" },\n    [FUSE_LINK] = { do_link, \"LINK\" },\n    [FUSE_OPEN] = { do_open, \"OPEN\" },\n    [FUSE_READ] = { do_read, \"READ\" },\n    [FUSE_WRITE] = { do_write, \"WRITE\" },\n    [FUSE_STATFS] = { do_statfs, \"STATFS\" },\n    [FUSE_RELEASE] = { do_release, \"RELEASE\" },\n    [FUSE_FSYNC] = { do_fsync, \"FSYNC\" },\n    [FUSE_SETXATTR] = { do_setxattr, \"SETXATTR\" },\n    [FUSE_GETXATTR] = { do_getxattr, \"GETXATTR\" },\n    [FUSE_LISTXATTR] = { do_listxattr, \"LISTXATTR\" },\n    [FUSE_REMOVEXATTR] = { do_removexattr, \"REMOVEXATTR\" },\n    [FUSE_FLUSH] = { do_flush, \"FLUSH\" },\n    [FUSE_INIT] = { do_init, \"INIT\" },\n    [FUSE_OPENDIR] = { do_opendir, \"OPENDIR\" },\n    [FUSE_READDIR] = { do_readdir, \"READDIR\" },\n    [FUSE_RELEASEDIR] = { do_releasedir, \"RELEASEDIR\" },\n    [FUSE_FSYNCDIR] = { do_fsyncdir, \"FSYNCDIR\" },\n    [FUSE_GETLK] = { do_getlk, \"GETLK\" },\n    [FUSE_SETLK] = { do_setlk, \"SETLK\" },\n    [FUSE_SETLKW] = { do_setlkw, \"SETLKW\" },\n    [FUSE_ACCESS] = { do_access, \"ACCESS\" },\n    [FUSE_CREATE] = { do_create, \"CREATE\" },\n    [FUSE_INTERRUPT] = { do_interrupt, \"INTERRUPT\" },\n    [FUSE_BMAP] = { do_bmap, \"BMAP\" },\n    [FUSE_IOCTL] = { do_ioctl, \"IOCTL\" },\n    [FUSE_POLL] = { do_poll, \"POLL\" },\n    [FUSE_FALLOCATE] = { do_fallocate, \"FALLOCATE\" },\n    [FUSE_DESTROY] = { do_destroy, \"DESTROY\" },\n    [FUSE_NOTIFY_REPLY] = { NULL, \"NOTIFY_REPLY\" },\n    [FUSE_BATCH_FORGET] = { do_batch_forget, \"BATCH_FORGET\" },\n    [FUSE_READDIRPLUS] = { do_readdirplus, \"READDIRPLUS\" },\n    [FUSE_RENAME2] = { do_rename2, \"RENAME2\" },\n    [FUSE_COPY_FILE_RANGE] = { do_copy_file_range, \"COPY_FILE_RANGE\" },\n    [FUSE_LSEEK] = { do_lseek, \"LSEEK\" },\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\n#define FUSE_MAXOP (sizeof(fuse_ll_ops) / sizeof(fuse_ll_ops[0]))\n\nstatic struct {\n    void (*func)(fuse_req_t, fuse_ino_t, struct fuse_mbuf_iter *);\n    const char *name;\n} fuse_ll_ops[] = {\n    [FUSE_LOOKUP] = { do_lookup, \"LOOKUP\" },\n    [FUSE_FORGET] = { do_forget, \"FORGET\" },\n    [FUSE_GETATTR] = { do_getattr, \"GETATTR\" },\n    [FUSE_SETATTR] = { do_setattr, \"SETATTR\" },\n    [FUSE_READLINK] = { do_readlink, \"READLINK\" },\n    [FUSE_SYMLINK] = { do_symlink, \"SYMLINK\" },\n    [FUSE_MKNOD] = { do_mknod, \"MKNOD\" },\n    [FUSE_MKDIR] = { do_mkdir, \"MKDIR\" },\n    [FUSE_UNLINK] = { do_unlink, \"UNLINK\" },\n    [FUSE_RMDIR] = { do_rmdir, \"RMDIR\" },\n    [FUSE_RENAME] = { do_rename, \"RENAME\" },\n    [FUSE_LINK] = { do_link, \"LINK\" },\n    [FUSE_OPEN] = { do_open, \"OPEN\" },\n    [FUSE_READ] = { do_read, \"READ\" },\n    [FUSE_WRITE] = { do_write, \"WRITE\" },\n    [FUSE_STATFS] = { do_statfs, \"STATFS\" },\n    [FUSE_RELEASE] = { do_release, \"RELEASE\" },\n    [FUSE_FSYNC] = { do_fsync, \"FSYNC\" },\n    [FUSE_SETXATTR] = { do_setxattr, \"SETXATTR\" },\n    [FUSE_GETXATTR] = { do_getxattr, \"GETXATTR\" },\n    [FUSE_LISTXATTR] = { do_listxattr, \"LISTXATTR\" },\n    [FUSE_REMOVEXATTR] = { do_removexattr, \"REMOVEXATTR\" },\n    [FUSE_FLUSH] = { do_flush, \"FLUSH\" },\n    [FUSE_INIT] = { do_init, \"INIT\" },\n    [FUSE_OPENDIR] = { do_opendir, \"OPENDIR\" },\n    [FUSE_READDIR] = { do_readdir, \"READDIR\" },\n    [FUSE_RELEASEDIR] = { do_releasedir, \"RELEASEDIR\" },\n    [FUSE_FSYNCDIR] = { do_fsyncdir, \"FSYNCDIR\" },\n    [FUSE_GETLK] = { do_getlk, \"GETLK\" },\n    [FUSE_SETLK] = { do_setlk, \"SETLK\" },\n    [FUSE_SETLKW] = { do_setlkw, \"SETLKW\" },\n    [FUSE_ACCESS] = { do_access, \"ACCESS\" },\n    [FUSE_CREATE] = { do_create, \"CREATE\" },\n    [FUSE_INTERRUPT] = { do_interrupt, \"INTERRUPT\" },\n    [FUSE_BMAP] = { do_bmap, \"BMAP\" },\n    [FUSE_IOCTL] = { do_ioctl, \"IOCTL\" },\n    [FUSE_POLL] = { do_poll, \"POLL\" },\n    [FUSE_FALLOCATE] = { do_fallocate, \"FALLOCATE\" },\n    [FUSE_DESTROY] = { do_destroy, \"DESTROY\" },\n    [FUSE_NOTIFY_REPLY] = { NULL, \"NOTIFY_REPLY\" },\n    [FUSE_BATCH_FORGET] = { do_batch_forget, \"BATCH_FORGET\" },\n    [FUSE_READDIRPLUS] = { do_readdirplus, \"READDIRPLUS\" },\n    [FUSE_RENAME2] = { do_rename2, \"RENAME2\" },\n    [FUSE_COPY_FILE_RANGE] = { do_copy_file_range, \"COPY_FILE_RANGE\" },\n    [FUSE_LSEEK] = { do_lseek, \"LSEEK\" },\n};\n\nstatic const char *opname(enum fuse_opcode opcode)\n{\n    if (opcode >= FUSE_MAXOP || !fuse_ll_ops[opcode].name) {\n        return \"???\";\n    } else {\n        return fuse_ll_ops[opcode].name;\n    }\n}"
  },
  {
    "function_name": "fuse_req_interrupted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2304-2313",
    "snippet": "int fuse_req_interrupted(fuse_req_t req)\n{\n    int interrupted;\n\n    pthread_mutex_lock(&req->se->lock);\n    interrupted = req->interrupted;\n    pthread_mutex_unlock(&req->se->lock);\n\n    return interrupted;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&req->se->lock"
          ],
          "line": 2310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&req->se->lock"
          ],
          "line": 2308
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_req_interrupted(fuse_req_t req)\n{\n    int interrupted;\n\n    pthread_mutex_lock(&req->se->lock);\n    interrupted = req->interrupted;\n    pthread_mutex_unlock(&req->se->lock);\n\n    return interrupted;\n}"
  },
  {
    "function_name": "fuse_req_interrupt_func",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2290-2302",
    "snippet": "void fuse_req_interrupt_func(fuse_req_t req, fuse_interrupt_func_t func,\n                             void *data)\n{\n    pthread_mutex_lock(&req->lock);\n    pthread_mutex_lock(&req->se->lock);\n    req->u.ni.func = func;\n    req->u.ni.data = data;\n    pthread_mutex_unlock(&req->se->lock);\n    if (req->interrupted && func) {\n        func(req, data);\n    }\n    pthread_mutex_unlock(&req->lock);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&req->lock"
          ],
          "line": 2301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "func",
          "args": [
            "req",
            "data"
          ],
          "line": 2299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&req->se->lock"
          ],
          "line": 2297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&req->se->lock"
          ],
          "line": 2294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&req->lock"
          ],
          "line": 2293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_req_interrupt_func(fuse_req_t req, fuse_interrupt_func_t func,\n                             void *data)\n{\n    pthread_mutex_lock(&req->lock);\n    pthread_mutex_lock(&req->se->lock);\n    req->u.ni.func = func;\n    req->u.ni.data = data;\n    pthread_mutex_unlock(&req->se->lock);\n    if (req->interrupted && func) {\n        func(req, data);\n    }\n    pthread_mutex_unlock(&req->lock);\n}"
  },
  {
    "function_name": "fuse_req_ctx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2285-2288",
    "snippet": "const struct fuse_ctx *fuse_req_ctx(fuse_req_t req)\n{\n    return &req->ctx;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst struct fuse_ctx *fuse_req_ctx(fuse_req_t req)\n{\n    return &req->ctx;\n}"
  },
  {
    "function_name": "fuse_req_userdata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2280-2283",
    "snippet": "void *fuse_req_userdata(fuse_req_t req)\n{\n    return req->se->userdata;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_req_userdata(fuse_req_t req)\n{\n    return req->se->userdata;\n}"
  },
  {
    "function_name": "fuse_lowlevel_notify_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2249-2278",
    "snippet": "int fuse_lowlevel_notify_store(struct fuse_session *se, fuse_ino_t ino,\n                               off_t offset, struct fuse_bufvec *bufv)\n{\n    struct fuse_out_header out = {\n        .error = FUSE_NOTIFY_STORE,\n    };\n    struct fuse_notify_store_out outarg = {\n        .nodeid = ino,\n        .offset = offset,\n        .size = fuse_buf_size(bufv),\n    };\n    struct iovec iov[3];\n    int res;\n\n    if (!se) {\n        return -EINVAL;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(out);\n    iov[1].iov_base = &outarg;\n    iov[1].iov_len = sizeof(outarg);\n\n    res = fuse_send_data_iov(se, NULL, iov, 2, bufv);\n    if (res > 0) {\n        res = -res;\n    }\n\n    return res;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_send_data_iov",
          "args": [
            "se",
            "NULL",
            "iov",
            "2",
            "bufv"
          ],
          "line": 2272
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_send_data_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "495-502",
          "snippet": "static int fuse_send_data_iov(struct fuse_session *se, struct fuse_chan *ch,\n                              struct iovec *iov, int iov_count,\n                              struct fuse_bufvec *buf)\n{\n    size_t len = fuse_buf_size(buf);\n\n    return fuse_send_data_iov_fallback(se, ch, iov, iov_count, buf, len);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_send_data_iov(struct fuse_session *se, struct fuse_chan *ch,\n                              struct iovec *iov, int iov_count,\n                              struct fuse_bufvec *buf)\n{\n    size_t len = fuse_buf_size(buf);\n\n    return fuse_send_data_iov_fallback(se, ch, iov, iov_count, buf, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_buf_size",
          "args": [
            "bufv"
          ],
          "line": 2258
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_buf_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "21-35",
          "snippet": "size_t fuse_buf_size(const struct fuse_bufvec *bufv)\n{\n    size_t i;\n    size_t size = 0;\n\n    for (i = 0; i < bufv->count; i++) {\n        if (bufv->buf[i].size == SIZE_MAX) {\n            size = SIZE_MAX;\n        } else {\n            size += bufv->buf[i].size;\n        }\n    }\n\n    return size;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nsize_t fuse_buf_size(const struct fuse_bufvec *bufv)\n{\n    size_t i;\n    size_t size = 0;\n\n    for (i = 0; i < bufv->count; i++) {\n        if (bufv->buf[i].size == SIZE_MAX) {\n            size = SIZE_MAX;\n        } else {\n            size += bufv->buf[i].size;\n        }\n    }\n\n    return size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_lowlevel_notify_store(struct fuse_session *se, fuse_ino_t ino,\n                               off_t offset, struct fuse_bufvec *bufv)\n{\n    struct fuse_out_header out = {\n        .error = FUSE_NOTIFY_STORE,\n    };\n    struct fuse_notify_store_out outarg = {\n        .nodeid = ino,\n        .offset = offset,\n        .size = fuse_buf_size(bufv),\n    };\n    struct iovec iov[3];\n    int res;\n\n    if (!se) {\n        return -EINVAL;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(out);\n    iov[1].iov_base = &outarg;\n    iov[1].iov_len = sizeof(outarg);\n\n    res = fuse_send_data_iov(se, NULL, iov, 2, bufv);\n    if (res > 0) {\n        res = -res;\n    }\n\n    return res;\n}"
  },
  {
    "function_name": "fuse_lowlevel_notify_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2226-2247",
    "snippet": "int fuse_lowlevel_notify_delete(struct fuse_session *se, fuse_ino_t parent,\n                                fuse_ino_t child, const char *name,\n                                size_t namelen)\n{\n    struct fuse_notify_delete_out outarg = {\n        .parent = parent,\n        .child = child,\n        .namelen = namelen,\n    };\n    struct iovec iov[3];\n\n    if (!se) {\n        return -EINVAL;\n    }\n\n    iov[1].iov_base = &outarg;\n    iov[1].iov_len = sizeof(outarg);\n    iov[2].iov_base = (void *)name;\n    iov[2].iov_len = namelen + 1;\n\n    return send_notify_iov(se, FUSE_NOTIFY_DELETE, iov, 3);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_notify_iov",
          "args": [
            "se",
            "FUSE_NOTIFY_DELETE",
            "iov",
            "3"
          ],
          "line": 2246
        },
        "resolved": true,
        "details": {
          "function_name": "send_notify_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "2151-2166",
          "snippet": "static int send_notify_iov(struct fuse_session *se, int notify_code,\n                           struct iovec *iov, int count)\n{\n    struct fuse_out_header out = {\n        .error = notify_code,\n    };\n\n    if (!se->got_init) {\n        return -ENOTCONN;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(se, NULL, iov, count);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_notify_iov(struct fuse_session *se, int notify_code,\n                           struct iovec *iov, int count)\n{\n    struct fuse_out_header out = {\n        .error = notify_code,\n    };\n\n    if (!se->got_init) {\n        return -ENOTCONN;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(se, NULL, iov, count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_lowlevel_notify_delete(struct fuse_session *se, fuse_ino_t parent,\n                                fuse_ino_t child, const char *name,\n                                size_t namelen)\n{\n    struct fuse_notify_delete_out outarg = {\n        .parent = parent,\n        .child = child,\n        .namelen = namelen,\n    };\n    struct iovec iov[3];\n\n    if (!se) {\n        return -EINVAL;\n    }\n\n    iov[1].iov_base = &outarg;\n    iov[1].iov_len = sizeof(outarg);\n    iov[2].iov_base = (void *)name;\n    iov[2].iov_len = namelen + 1;\n\n    return send_notify_iov(se, FUSE_NOTIFY_DELETE, iov, 3);\n}"
  },
  {
    "function_name": "fuse_lowlevel_notify_inval_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2205-2224",
    "snippet": "int fuse_lowlevel_notify_inval_entry(struct fuse_session *se, fuse_ino_t parent,\n                                     const char *name, size_t namelen)\n{\n    struct fuse_notify_inval_entry_out outarg = {\n        .parent = parent,\n        .namelen = namelen,\n    };\n    struct iovec iov[3];\n\n    if (!se) {\n        return -EINVAL;\n    }\n\n    iov[1].iov_base = &outarg;\n    iov[1].iov_len = sizeof(outarg);\n    iov[2].iov_base = (void *)name;\n    iov[2].iov_len = namelen + 1;\n\n    return send_notify_iov(se, FUSE_NOTIFY_INVAL_ENTRY, iov, 3);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_notify_iov",
          "args": [
            "se",
            "FUSE_NOTIFY_INVAL_ENTRY",
            "iov",
            "3"
          ],
          "line": 2223
        },
        "resolved": true,
        "details": {
          "function_name": "send_notify_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "2151-2166",
          "snippet": "static int send_notify_iov(struct fuse_session *se, int notify_code,\n                           struct iovec *iov, int count)\n{\n    struct fuse_out_header out = {\n        .error = notify_code,\n    };\n\n    if (!se->got_init) {\n        return -ENOTCONN;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(se, NULL, iov, count);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_notify_iov(struct fuse_session *se, int notify_code,\n                           struct iovec *iov, int count)\n{\n    struct fuse_out_header out = {\n        .error = notify_code,\n    };\n\n    if (!se->got_init) {\n        return -ENOTCONN;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(se, NULL, iov, count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_lowlevel_notify_inval_entry(struct fuse_session *se, fuse_ino_t parent,\n                                     const char *name, size_t namelen)\n{\n    struct fuse_notify_inval_entry_out outarg = {\n        .parent = parent,\n        .namelen = namelen,\n    };\n    struct iovec iov[3];\n\n    if (!se) {\n        return -EINVAL;\n    }\n\n    iov[1].iov_base = &outarg;\n    iov[1].iov_len = sizeof(outarg);\n    iov[2].iov_base = (void *)name;\n    iov[2].iov_len = namelen + 1;\n\n    return send_notify_iov(se, FUSE_NOTIFY_INVAL_ENTRY, iov, 3);\n}"
  },
  {
    "function_name": "fuse_lowlevel_notify_inval_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2185-2203",
    "snippet": "int fuse_lowlevel_notify_inval_inode(struct fuse_session *se, fuse_ino_t ino,\n                                     off_t off, off_t len)\n{\n    struct fuse_notify_inval_inode_out outarg = {\n        .ino = ino,\n        .off = off,\n        .len = len,\n    };\n    struct iovec iov[2];\n\n    if (!se) {\n        return -EINVAL;\n    }\n\n    iov[1].iov_base = &outarg;\n    iov[1].iov_len = sizeof(outarg);\n\n    return send_notify_iov(se, FUSE_NOTIFY_INVAL_INODE, iov, 2);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_notify_iov",
          "args": [
            "se",
            "FUSE_NOTIFY_INVAL_INODE",
            "iov",
            "2"
          ],
          "line": 2202
        },
        "resolved": true,
        "details": {
          "function_name": "send_notify_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "2151-2166",
          "snippet": "static int send_notify_iov(struct fuse_session *se, int notify_code,\n                           struct iovec *iov, int count)\n{\n    struct fuse_out_header out = {\n        .error = notify_code,\n    };\n\n    if (!se->got_init) {\n        return -ENOTCONN;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(se, NULL, iov, count);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_notify_iov(struct fuse_session *se, int notify_code,\n                           struct iovec *iov, int count)\n{\n    struct fuse_out_header out = {\n        .error = notify_code,\n    };\n\n    if (!se->got_init) {\n        return -ENOTCONN;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(se, NULL, iov, count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_lowlevel_notify_inval_inode(struct fuse_session *se, fuse_ino_t ino,\n                                     off_t off, off_t len)\n{\n    struct fuse_notify_inval_inode_out outarg = {\n        .ino = ino,\n        .off = off,\n        .len = len,\n    };\n    struct iovec iov[2];\n\n    if (!se) {\n        return -EINVAL;\n    }\n\n    iov[1].iov_base = &outarg;\n    iov[1].iov_len = sizeof(outarg);\n\n    return send_notify_iov(se, FUSE_NOTIFY_INVAL_INODE, iov, 2);\n}"
  },
  {
    "function_name": "fuse_lowlevel_notify_poll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2168-2183",
    "snippet": "int fuse_lowlevel_notify_poll(struct fuse_pollhandle *ph)\n{\n    if (ph != NULL) {\n        struct fuse_notify_poll_wakeup_out outarg = {\n            .kh = ph->kh,\n        };\n        struct iovec iov[2];\n\n        iov[1].iov_base = &outarg;\n        iov[1].iov_len = sizeof(outarg);\n\n        return send_notify_iov(ph->se, FUSE_NOTIFY_POLL, iov, 2);\n    } else {\n        return 0;\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_notify_iov",
          "args": [
            "ph->se",
            "FUSE_NOTIFY_POLL",
            "iov",
            "2"
          ],
          "line": 2179
        },
        "resolved": true,
        "details": {
          "function_name": "send_notify_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "2151-2166",
          "snippet": "static int send_notify_iov(struct fuse_session *se, int notify_code,\n                           struct iovec *iov, int count)\n{\n    struct fuse_out_header out = {\n        .error = notify_code,\n    };\n\n    if (!se->got_init) {\n        return -ENOTCONN;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(se, NULL, iov, count);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_notify_iov(struct fuse_session *se, int notify_code,\n                           struct iovec *iov, int count)\n{\n    struct fuse_out_header out = {\n        .error = notify_code,\n    };\n\n    if (!se->got_init) {\n        return -ENOTCONN;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(se, NULL, iov, count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_lowlevel_notify_poll(struct fuse_pollhandle *ph)\n{\n    if (ph != NULL) {\n        struct fuse_notify_poll_wakeup_out outarg = {\n            .kh = ph->kh,\n        };\n        struct iovec iov[2];\n\n        iov[1].iov_base = &outarg;\n        iov[1].iov_len = sizeof(outarg);\n\n        return send_notify_iov(ph->se, FUSE_NOTIFY_POLL, iov, 2);\n    } else {\n        return 0;\n    }\n}"
  },
  {
    "function_name": "send_notify_iov",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2151-2166",
    "snippet": "static int send_notify_iov(struct fuse_session *se, int notify_code,\n                           struct iovec *iov, int count)\n{\n    struct fuse_out_header out = {\n        .error = notify_code,\n    };\n\n    if (!se->got_init) {\n        return -ENOTCONN;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(se, NULL, iov, count);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_send_msg",
          "args": [
            "se",
            "NULL",
            "iov",
            "count"
          ],
          "line": 2165
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_send_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "157-182",
          "snippet": "static int fuse_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count)\n{\n    struct fuse_out_header *out = iov[0].iov_base;\n\n    out->len = iov_length(iov, count);\n    if (out->unique == 0) {\n        fuse_log(FUSE_LOG_DEBUG, \"NOTIFY: code=%d length=%u\\n\", out->error,\n                 out->len);\n    } else if (out->error) {\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"   unique: %llu, error: %i (%s), outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->error,\n                 strerror(-out->error), out->len);\n    } else {\n        fuse_log(FUSE_LOG_DEBUG, \"   unique: %llu, success, outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->len);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        return virtio_send_msg(se, ch, iov, count);\n    }\n\n    abort(); /* virtio should have taken it before here */\n    return 0;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count)\n{\n    struct fuse_out_header *out = iov[0].iov_base;\n\n    out->len = iov_length(iov, count);\n    if (out->unique == 0) {\n        fuse_log(FUSE_LOG_DEBUG, \"NOTIFY: code=%d length=%u\\n\", out->error,\n                 out->len);\n    } else if (out->error) {\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"   unique: %llu, error: %i (%s), outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->error,\n                 strerror(-out->error), out->len);\n    } else {\n        fuse_log(FUSE_LOG_DEBUG, \"   unique: %llu, success, outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->len);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        return virtio_send_msg(se, ch, iov, count);\n    }\n\n    abort(); /* virtio should have taken it before here */\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_notify_iov(struct fuse_session *se, int notify_code,\n                           struct iovec *iov, int count)\n{\n    struct fuse_out_header out = {\n        .error = notify_code,\n    };\n\n    if (!se->got_init) {\n        return -ENOTCONN;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(se, NULL, iov, count);\n}"
  },
  {
    "function_name": "do_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "2134-2149",
    "snippet": "static void do_destroy(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_session *se = req->se;\n\n    (void)nodeid;\n    (void)iter;\n\n    se->got_destroy = 1;\n    se->got_init = 0;\n    if (se->op.destroy) {\n        se->op.destroy(se->userdata);\n    }\n\n    send_reply_ok(req, NULL, 0);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "NULL",
            "0"
          ],
          "line": 2148
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "se->op.destroy",
          "args": [
            "se->userdata"
          ],
          "line": 2145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_destroy(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_session *se = req->se;\n\n    (void)nodeid;\n    (void)iter;\n\n    se->got_destroy = 1;\n    se->got_init = 0;\n    if (se->op.destroy) {\n        se->op.destroy(se->userdata);\n    }\n\n    send_reply_ok(req, NULL, 0);\n}"
  },
  {
    "function_name": "do_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1879-2132",
    "snippet": "static void do_init(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    size_t compat_size = offsetof(struct fuse_init_in, max_readahead);\n    struct fuse_init_in *arg;\n    struct fuse_init_out outarg;\n    struct fuse_session *se = req->se;\n    size_t bufsize = se->bufsize;\n    size_t outargsize = sizeof(outarg);\n\n    (void)nodeid;\n\n    /* First consume the old fields... */\n    arg = fuse_mbuf_iter_advance(iter, compat_size);\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    /* ...and now consume the new fields. */\n    if (arg->major == 7 && arg->minor >= 6) {\n        if (!fuse_mbuf_iter_advance(iter, sizeof(*arg) - compat_size)) {\n            fuse_reply_err(req, EINVAL);\n            return;\n        }\n    }\n\n    fuse_log(FUSE_LOG_DEBUG, \"INIT: %u.%u\\n\", arg->major, arg->minor);\n    if (arg->major == 7 && arg->minor >= 6) {\n        fuse_log(FUSE_LOG_DEBUG, \"flags=0x%08x\\n\", arg->flags);\n        fuse_log(FUSE_LOG_DEBUG, \"max_readahead=0x%08x\\n\", arg->max_readahead);\n    }\n    se->conn.proto_major = arg->major;\n    se->conn.proto_minor = arg->minor;\n    se->conn.capable = 0;\n    se->conn.want = 0;\n\n    memset(&outarg, 0, sizeof(outarg));\n    outarg.major = FUSE_KERNEL_VERSION;\n    outarg.minor = FUSE_KERNEL_MINOR_VERSION;\n\n    if (arg->major < 7 || (arg->major == 7 && arg->minor < 31)) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: unsupported protocol version: %u.%u\\n\",\n                 arg->major, arg->minor);\n        fuse_reply_err(req, EPROTO);\n        return;\n    }\n\n    if (arg->major > 7) {\n        /* Wait for a second INIT request with a 7.X version */\n        send_reply_ok(req, &outarg, sizeof(outarg));\n        return;\n    }\n\n    if (arg->max_readahead < se->conn.max_readahead) {\n        se->conn.max_readahead = arg->max_readahead;\n    }\n    if (arg->flags & FUSE_ASYNC_READ) {\n        se->conn.capable |= FUSE_CAP_ASYNC_READ;\n    }\n    if (arg->flags & FUSE_POSIX_LOCKS) {\n        se->conn.capable |= FUSE_CAP_POSIX_LOCKS;\n    }\n    if (arg->flags & FUSE_ATOMIC_O_TRUNC) {\n        se->conn.capable |= FUSE_CAP_ATOMIC_O_TRUNC;\n    }\n    if (arg->flags & FUSE_EXPORT_SUPPORT) {\n        se->conn.capable |= FUSE_CAP_EXPORT_SUPPORT;\n    }\n    if (arg->flags & FUSE_DONT_MASK) {\n        se->conn.capable |= FUSE_CAP_DONT_MASK;\n    }\n    if (arg->flags & FUSE_FLOCK_LOCKS) {\n        se->conn.capable |= FUSE_CAP_FLOCK_LOCKS;\n    }\n    if (arg->flags & FUSE_AUTO_INVAL_DATA) {\n        se->conn.capable |= FUSE_CAP_AUTO_INVAL_DATA;\n    }\n    if (arg->flags & FUSE_DO_READDIRPLUS) {\n        se->conn.capable |= FUSE_CAP_READDIRPLUS;\n    }\n    if (arg->flags & FUSE_READDIRPLUS_AUTO) {\n        se->conn.capable |= FUSE_CAP_READDIRPLUS_AUTO;\n    }\n    if (arg->flags & FUSE_ASYNC_DIO) {\n        se->conn.capable |= FUSE_CAP_ASYNC_DIO;\n    }\n    if (arg->flags & FUSE_WRITEBACK_CACHE) {\n        se->conn.capable |= FUSE_CAP_WRITEBACK_CACHE;\n    }\n    if (arg->flags & FUSE_NO_OPEN_SUPPORT) {\n        se->conn.capable |= FUSE_CAP_NO_OPEN_SUPPORT;\n    }\n    if (arg->flags & FUSE_PARALLEL_DIROPS) {\n        se->conn.capable |= FUSE_CAP_PARALLEL_DIROPS;\n    }\n    if (arg->flags & FUSE_POSIX_ACL) {\n        se->conn.capable |= FUSE_CAP_POSIX_ACL;\n    }\n    if (arg->flags & FUSE_HANDLE_KILLPRIV) {\n        se->conn.capable |= FUSE_CAP_HANDLE_KILLPRIV;\n    }\n    if (arg->flags & FUSE_NO_OPENDIR_SUPPORT) {\n        se->conn.capable |= FUSE_CAP_NO_OPENDIR_SUPPORT;\n    }\n    if (!(arg->flags & FUSE_MAX_PAGES)) {\n        size_t max_bufsize = FUSE_DEFAULT_MAX_PAGES_PER_REQ * getpagesize() +\n                             FUSE_BUFFER_HEADER_SIZE;\n        if (bufsize > max_bufsize) {\n            bufsize = max_bufsize;\n        }\n    }\n#ifdef HAVE_SPLICE\n#ifdef HAVE_VMSPLICE\n    se->conn.capable |= FUSE_CAP_SPLICE_WRITE | FUSE_CAP_SPLICE_MOVE;\n#endif\n    se->conn.capable |= FUSE_CAP_SPLICE_READ;\n#endif\n    se->conn.capable |= FUSE_CAP_IOCTL_DIR;\n\n    /*\n     * Default settings for modern filesystems.\n     *\n     * Most of these capabilities were disabled by default in\n     * libfuse2 for backwards compatibility reasons. In libfuse3,\n     * we can finally enable them by default (as long as they're\n     * supported by the kernel).\n     */\n#define LL_SET_DEFAULT(cond, cap)             \\\n    if ((cond) && (se->conn.capable & (cap))) \\\n        se->conn.want |= (cap)\n    LL_SET_DEFAULT(1, FUSE_CAP_ASYNC_READ);\n    LL_SET_DEFAULT(1, FUSE_CAP_PARALLEL_DIROPS);\n    LL_SET_DEFAULT(1, FUSE_CAP_AUTO_INVAL_DATA);\n    LL_SET_DEFAULT(1, FUSE_CAP_HANDLE_KILLPRIV);\n    LL_SET_DEFAULT(1, FUSE_CAP_ASYNC_DIO);\n    LL_SET_DEFAULT(1, FUSE_CAP_IOCTL_DIR);\n    LL_SET_DEFAULT(1, FUSE_CAP_ATOMIC_O_TRUNC);\n    LL_SET_DEFAULT(se->op.write_buf, FUSE_CAP_SPLICE_READ);\n    LL_SET_DEFAULT(se->op.getlk && se->op.setlk, FUSE_CAP_POSIX_LOCKS);\n    LL_SET_DEFAULT(se->op.flock, FUSE_CAP_FLOCK_LOCKS);\n    LL_SET_DEFAULT(se->op.readdirplus, FUSE_CAP_READDIRPLUS);\n    LL_SET_DEFAULT(se->op.readdirplus && se->op.readdir,\n                   FUSE_CAP_READDIRPLUS_AUTO);\n    se->conn.time_gran = 1;\n\n    if (bufsize < FUSE_MIN_READ_BUFFER) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: warning: buffer size too small: %zu\\n\",\n                 bufsize);\n        bufsize = FUSE_MIN_READ_BUFFER;\n    }\n    se->bufsize = bufsize;\n\n    if (se->conn.max_write > bufsize - FUSE_BUFFER_HEADER_SIZE) {\n        se->conn.max_write = bufsize - FUSE_BUFFER_HEADER_SIZE;\n    }\n\n    se->got_init = 1;\n    se->got_destroy = 0;\n    if (se->op.init) {\n        se->op.init(se->userdata, &se->conn);\n    }\n\n    if (se->conn.want & (~se->conn.capable)) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: error: filesystem requested capabilities \"\n                 \"0x%x that are not supported by kernel, aborting.\\n\",\n                 se->conn.want & (~se->conn.capable));\n        fuse_reply_err(req, EPROTO);\n        se->error = -EPROTO;\n        fuse_session_exit(se);\n        return;\n    }\n\n    if (se->conn.max_write < bufsize - FUSE_BUFFER_HEADER_SIZE) {\n        se->bufsize = se->conn.max_write + FUSE_BUFFER_HEADER_SIZE;\n    }\n    if (arg->flags & FUSE_MAX_PAGES) {\n        outarg.flags |= FUSE_MAX_PAGES;\n        outarg.max_pages = (se->conn.max_write - 1) / getpagesize() + 1;\n    }\n\n    /*\n     * Always enable big writes, this is superseded\n     * by the max_write option\n     */\n    outarg.flags |= FUSE_BIG_WRITES;\n\n    if (se->conn.want & FUSE_CAP_ASYNC_READ) {\n        outarg.flags |= FUSE_ASYNC_READ;\n    }\n    if (se->conn.want & FUSE_CAP_PARALLEL_DIROPS) {\n        outarg.flags |= FUSE_PARALLEL_DIROPS;\n    }\n    if (se->conn.want & FUSE_CAP_POSIX_LOCKS) {\n        outarg.flags |= FUSE_POSIX_LOCKS;\n    }\n    if (se->conn.want & FUSE_CAP_ATOMIC_O_TRUNC) {\n        outarg.flags |= FUSE_ATOMIC_O_TRUNC;\n    }\n    if (se->conn.want & FUSE_CAP_EXPORT_SUPPORT) {\n        outarg.flags |= FUSE_EXPORT_SUPPORT;\n    }\n    if (se->conn.want & FUSE_CAP_DONT_MASK) {\n        outarg.flags |= FUSE_DONT_MASK;\n    }\n    if (se->conn.want & FUSE_CAP_FLOCK_LOCKS) {\n        outarg.flags |= FUSE_FLOCK_LOCKS;\n    }\n    if (se->conn.want & FUSE_CAP_AUTO_INVAL_DATA) {\n        outarg.flags |= FUSE_AUTO_INVAL_DATA;\n    }\n    if (se->conn.want & FUSE_CAP_READDIRPLUS) {\n        outarg.flags |= FUSE_DO_READDIRPLUS;\n    }\n    if (se->conn.want & FUSE_CAP_READDIRPLUS_AUTO) {\n        outarg.flags |= FUSE_READDIRPLUS_AUTO;\n    }\n    if (se->conn.want & FUSE_CAP_ASYNC_DIO) {\n        outarg.flags |= FUSE_ASYNC_DIO;\n    }\n    if (se->conn.want & FUSE_CAP_WRITEBACK_CACHE) {\n        outarg.flags |= FUSE_WRITEBACK_CACHE;\n    }\n    if (se->conn.want & FUSE_CAP_POSIX_ACL) {\n        outarg.flags |= FUSE_POSIX_ACL;\n    }\n    outarg.max_readahead = se->conn.max_readahead;\n    outarg.max_write = se->conn.max_write;\n    if (se->conn.max_background >= (1 << 16)) {\n        se->conn.max_background = (1 << 16) - 1;\n    }\n    if (se->conn.congestion_threshold > se->conn.max_background) {\n        se->conn.congestion_threshold = se->conn.max_background;\n    }\n    if (!se->conn.congestion_threshold) {\n        se->conn.congestion_threshold = se->conn.max_background * 3 / 4;\n    }\n\n    outarg.max_background = se->conn.max_background;\n    outarg.congestion_threshold = se->conn.congestion_threshold;\n    outarg.time_gran = se->conn.time_gran;\n\n    fuse_log(FUSE_LOG_DEBUG, \"   INIT: %u.%u\\n\", outarg.major, outarg.minor);\n    fuse_log(FUSE_LOG_DEBUG, \"   flags=0x%08x\\n\", outarg.flags);\n    fuse_log(FUSE_LOG_DEBUG, \"   max_readahead=0x%08x\\n\", outarg.max_readahead);\n    fuse_log(FUSE_LOG_DEBUG, \"   max_write=0x%08x\\n\", outarg.max_write);\n    fuse_log(FUSE_LOG_DEBUG, \"   max_background=%i\\n\", outarg.max_background);\n    fuse_log(FUSE_LOG_DEBUG, \"   congestion_threshold=%i\\n\",\n             outarg.congestion_threshold);\n    fuse_log(FUSE_LOG_DEBUG, \"   time_gran=%u\\n\", outarg.time_gran);\n\n    send_reply_ok(req, &outarg, outargsize);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "&outarg",
            "outargsize"
          ],
          "line": 2131
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_DEBUG",
            "\"   time_gran=%u\\n\"",
            "outarg.time_gran"
          ],
          "line": 2129
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpagesize",
          "args": [],
          "line": 2058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_session_exit",
          "args": [
            "se"
          ],
          "line": 2049
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_session_exited",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "2691-2694",
          "snippet": "int fuse_session_exited(struct fuse_session *se)\n{\n    return se->exited;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_session_exited(struct fuse_session *se)\n{\n    return se->exited;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "EPROTO"
          ],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "se->op.init",
          "args": [
            "se->userdata",
            "&se->conn"
          ],
          "line": 2039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "se->op.readdirplus && se->op.readdir",
            "FUSE_CAP_READDIRPLUS_AUTO"
          ],
          "line": 2021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "se->op.readdirplus",
            "FUSE_CAP_READDIRPLUS"
          ],
          "line": 2020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "se->op.flock",
            "FUSE_CAP_FLOCK_LOCKS"
          ],
          "line": 2019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "se->op.getlk && se->op.setlk",
            "FUSE_CAP_POSIX_LOCKS"
          ],
          "line": 2018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "se->op.write_buf",
            "FUSE_CAP_SPLICE_READ"
          ],
          "line": 2017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "1",
            "FUSE_CAP_ATOMIC_O_TRUNC"
          ],
          "line": 2016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "1",
            "FUSE_CAP_IOCTL_DIR"
          ],
          "line": 2015
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "1",
            "FUSE_CAP_ASYNC_DIO"
          ],
          "line": 2014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "1",
            "FUSE_CAP_HANDLE_KILLPRIV"
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "1",
            "FUSE_CAP_AUTO_INVAL_DATA"
          ],
          "line": 2012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "1",
            "FUSE_CAP_PARALLEL_DIROPS"
          ],
          "line": 2011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LL_SET_DEFAULT",
          "args": [
            "1",
            "FUSE_CAP_ASYNC_READ"
          ],
          "line": 2010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpagesize",
          "args": [],
          "line": 1985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&outarg",
            "0",
            "sizeof(outarg)"
          ],
          "line": 1916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg) - compat_size"
          ],
          "line": 1900
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_init(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    size_t compat_size = offsetof(struct fuse_init_in, max_readahead);\n    struct fuse_init_in *arg;\n    struct fuse_init_out outarg;\n    struct fuse_session *se = req->se;\n    size_t bufsize = se->bufsize;\n    size_t outargsize = sizeof(outarg);\n\n    (void)nodeid;\n\n    /* First consume the old fields... */\n    arg = fuse_mbuf_iter_advance(iter, compat_size);\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    /* ...and now consume the new fields. */\n    if (arg->major == 7 && arg->minor >= 6) {\n        if (!fuse_mbuf_iter_advance(iter, sizeof(*arg) - compat_size)) {\n            fuse_reply_err(req, EINVAL);\n            return;\n        }\n    }\n\n    fuse_log(FUSE_LOG_DEBUG, \"INIT: %u.%u\\n\", arg->major, arg->minor);\n    if (arg->major == 7 && arg->minor >= 6) {\n        fuse_log(FUSE_LOG_DEBUG, \"flags=0x%08x\\n\", arg->flags);\n        fuse_log(FUSE_LOG_DEBUG, \"max_readahead=0x%08x\\n\", arg->max_readahead);\n    }\n    se->conn.proto_major = arg->major;\n    se->conn.proto_minor = arg->minor;\n    se->conn.capable = 0;\n    se->conn.want = 0;\n\n    memset(&outarg, 0, sizeof(outarg));\n    outarg.major = FUSE_KERNEL_VERSION;\n    outarg.minor = FUSE_KERNEL_MINOR_VERSION;\n\n    if (arg->major < 7 || (arg->major == 7 && arg->minor < 31)) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: unsupported protocol version: %u.%u\\n\",\n                 arg->major, arg->minor);\n        fuse_reply_err(req, EPROTO);\n        return;\n    }\n\n    if (arg->major > 7) {\n        /* Wait for a second INIT request with a 7.X version */\n        send_reply_ok(req, &outarg, sizeof(outarg));\n        return;\n    }\n\n    if (arg->max_readahead < se->conn.max_readahead) {\n        se->conn.max_readahead = arg->max_readahead;\n    }\n    if (arg->flags & FUSE_ASYNC_READ) {\n        se->conn.capable |= FUSE_CAP_ASYNC_READ;\n    }\n    if (arg->flags & FUSE_POSIX_LOCKS) {\n        se->conn.capable |= FUSE_CAP_POSIX_LOCKS;\n    }\n    if (arg->flags & FUSE_ATOMIC_O_TRUNC) {\n        se->conn.capable |= FUSE_CAP_ATOMIC_O_TRUNC;\n    }\n    if (arg->flags & FUSE_EXPORT_SUPPORT) {\n        se->conn.capable |= FUSE_CAP_EXPORT_SUPPORT;\n    }\n    if (arg->flags & FUSE_DONT_MASK) {\n        se->conn.capable |= FUSE_CAP_DONT_MASK;\n    }\n    if (arg->flags & FUSE_FLOCK_LOCKS) {\n        se->conn.capable |= FUSE_CAP_FLOCK_LOCKS;\n    }\n    if (arg->flags & FUSE_AUTO_INVAL_DATA) {\n        se->conn.capable |= FUSE_CAP_AUTO_INVAL_DATA;\n    }\n    if (arg->flags & FUSE_DO_READDIRPLUS) {\n        se->conn.capable |= FUSE_CAP_READDIRPLUS;\n    }\n    if (arg->flags & FUSE_READDIRPLUS_AUTO) {\n        se->conn.capable |= FUSE_CAP_READDIRPLUS_AUTO;\n    }\n    if (arg->flags & FUSE_ASYNC_DIO) {\n        se->conn.capable |= FUSE_CAP_ASYNC_DIO;\n    }\n    if (arg->flags & FUSE_WRITEBACK_CACHE) {\n        se->conn.capable |= FUSE_CAP_WRITEBACK_CACHE;\n    }\n    if (arg->flags & FUSE_NO_OPEN_SUPPORT) {\n        se->conn.capable |= FUSE_CAP_NO_OPEN_SUPPORT;\n    }\n    if (arg->flags & FUSE_PARALLEL_DIROPS) {\n        se->conn.capable |= FUSE_CAP_PARALLEL_DIROPS;\n    }\n    if (arg->flags & FUSE_POSIX_ACL) {\n        se->conn.capable |= FUSE_CAP_POSIX_ACL;\n    }\n    if (arg->flags & FUSE_HANDLE_KILLPRIV) {\n        se->conn.capable |= FUSE_CAP_HANDLE_KILLPRIV;\n    }\n    if (arg->flags & FUSE_NO_OPENDIR_SUPPORT) {\n        se->conn.capable |= FUSE_CAP_NO_OPENDIR_SUPPORT;\n    }\n    if (!(arg->flags & FUSE_MAX_PAGES)) {\n        size_t max_bufsize = FUSE_DEFAULT_MAX_PAGES_PER_REQ * getpagesize() +\n                             FUSE_BUFFER_HEADER_SIZE;\n        if (bufsize > max_bufsize) {\n            bufsize = max_bufsize;\n        }\n    }\n#ifdef HAVE_SPLICE\n#ifdef HAVE_VMSPLICE\n    se->conn.capable |= FUSE_CAP_SPLICE_WRITE | FUSE_CAP_SPLICE_MOVE;\n#endif\n    se->conn.capable |= FUSE_CAP_SPLICE_READ;\n#endif\n    se->conn.capable |= FUSE_CAP_IOCTL_DIR;\n\n    /*\n     * Default settings for modern filesystems.\n     *\n     * Most of these capabilities were disabled by default in\n     * libfuse2 for backwards compatibility reasons. In libfuse3,\n     * we can finally enable them by default (as long as they're\n     * supported by the kernel).\n     */\n#define LL_SET_DEFAULT(cond, cap)             \\\n    if ((cond) && (se->conn.capable & (cap))) \\\n        se->conn.want |= (cap)\n    LL_SET_DEFAULT(1, FUSE_CAP_ASYNC_READ);\n    LL_SET_DEFAULT(1, FUSE_CAP_PARALLEL_DIROPS);\n    LL_SET_DEFAULT(1, FUSE_CAP_AUTO_INVAL_DATA);\n    LL_SET_DEFAULT(1, FUSE_CAP_HANDLE_KILLPRIV);\n    LL_SET_DEFAULT(1, FUSE_CAP_ASYNC_DIO);\n    LL_SET_DEFAULT(1, FUSE_CAP_IOCTL_DIR);\n    LL_SET_DEFAULT(1, FUSE_CAP_ATOMIC_O_TRUNC);\n    LL_SET_DEFAULT(se->op.write_buf, FUSE_CAP_SPLICE_READ);\n    LL_SET_DEFAULT(se->op.getlk && se->op.setlk, FUSE_CAP_POSIX_LOCKS);\n    LL_SET_DEFAULT(se->op.flock, FUSE_CAP_FLOCK_LOCKS);\n    LL_SET_DEFAULT(se->op.readdirplus, FUSE_CAP_READDIRPLUS);\n    LL_SET_DEFAULT(se->op.readdirplus && se->op.readdir,\n                   FUSE_CAP_READDIRPLUS_AUTO);\n    se->conn.time_gran = 1;\n\n    if (bufsize < FUSE_MIN_READ_BUFFER) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: warning: buffer size too small: %zu\\n\",\n                 bufsize);\n        bufsize = FUSE_MIN_READ_BUFFER;\n    }\n    se->bufsize = bufsize;\n\n    if (se->conn.max_write > bufsize - FUSE_BUFFER_HEADER_SIZE) {\n        se->conn.max_write = bufsize - FUSE_BUFFER_HEADER_SIZE;\n    }\n\n    se->got_init = 1;\n    se->got_destroy = 0;\n    if (se->op.init) {\n        se->op.init(se->userdata, &se->conn);\n    }\n\n    if (se->conn.want & (~se->conn.capable)) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: error: filesystem requested capabilities \"\n                 \"0x%x that are not supported by kernel, aborting.\\n\",\n                 se->conn.want & (~se->conn.capable));\n        fuse_reply_err(req, EPROTO);\n        se->error = -EPROTO;\n        fuse_session_exit(se);\n        return;\n    }\n\n    if (se->conn.max_write < bufsize - FUSE_BUFFER_HEADER_SIZE) {\n        se->bufsize = se->conn.max_write + FUSE_BUFFER_HEADER_SIZE;\n    }\n    if (arg->flags & FUSE_MAX_PAGES) {\n        outarg.flags |= FUSE_MAX_PAGES;\n        outarg.max_pages = (se->conn.max_write - 1) / getpagesize() + 1;\n    }\n\n    /*\n     * Always enable big writes, this is superseded\n     * by the max_write option\n     */\n    outarg.flags |= FUSE_BIG_WRITES;\n\n    if (se->conn.want & FUSE_CAP_ASYNC_READ) {\n        outarg.flags |= FUSE_ASYNC_READ;\n    }\n    if (se->conn.want & FUSE_CAP_PARALLEL_DIROPS) {\n        outarg.flags |= FUSE_PARALLEL_DIROPS;\n    }\n    if (se->conn.want & FUSE_CAP_POSIX_LOCKS) {\n        outarg.flags |= FUSE_POSIX_LOCKS;\n    }\n    if (se->conn.want & FUSE_CAP_ATOMIC_O_TRUNC) {\n        outarg.flags |= FUSE_ATOMIC_O_TRUNC;\n    }\n    if (se->conn.want & FUSE_CAP_EXPORT_SUPPORT) {\n        outarg.flags |= FUSE_EXPORT_SUPPORT;\n    }\n    if (se->conn.want & FUSE_CAP_DONT_MASK) {\n        outarg.flags |= FUSE_DONT_MASK;\n    }\n    if (se->conn.want & FUSE_CAP_FLOCK_LOCKS) {\n        outarg.flags |= FUSE_FLOCK_LOCKS;\n    }\n    if (se->conn.want & FUSE_CAP_AUTO_INVAL_DATA) {\n        outarg.flags |= FUSE_AUTO_INVAL_DATA;\n    }\n    if (se->conn.want & FUSE_CAP_READDIRPLUS) {\n        outarg.flags |= FUSE_DO_READDIRPLUS;\n    }\n    if (se->conn.want & FUSE_CAP_READDIRPLUS_AUTO) {\n        outarg.flags |= FUSE_READDIRPLUS_AUTO;\n    }\n    if (se->conn.want & FUSE_CAP_ASYNC_DIO) {\n        outarg.flags |= FUSE_ASYNC_DIO;\n    }\n    if (se->conn.want & FUSE_CAP_WRITEBACK_CACHE) {\n        outarg.flags |= FUSE_WRITEBACK_CACHE;\n    }\n    if (se->conn.want & FUSE_CAP_POSIX_ACL) {\n        outarg.flags |= FUSE_POSIX_ACL;\n    }\n    outarg.max_readahead = se->conn.max_readahead;\n    outarg.max_write = se->conn.max_write;\n    if (se->conn.max_background >= (1 << 16)) {\n        se->conn.max_background = (1 << 16) - 1;\n    }\n    if (se->conn.congestion_threshold > se->conn.max_background) {\n        se->conn.congestion_threshold = se->conn.max_background;\n    }\n    if (!se->conn.congestion_threshold) {\n        se->conn.congestion_threshold = se->conn.max_background * 3 / 4;\n    }\n\n    outarg.max_background = se->conn.max_background;\n    outarg.congestion_threshold = se->conn.congestion_threshold;\n    outarg.time_gran = se->conn.time_gran;\n\n    fuse_log(FUSE_LOG_DEBUG, \"   INIT: %u.%u\\n\", outarg.major, outarg.minor);\n    fuse_log(FUSE_LOG_DEBUG, \"   flags=0x%08x\\n\", outarg.flags);\n    fuse_log(FUSE_LOG_DEBUG, \"   max_readahead=0x%08x\\n\", outarg.max_readahead);\n    fuse_log(FUSE_LOG_DEBUG, \"   max_write=0x%08x\\n\", outarg.max_write);\n    fuse_log(FUSE_LOG_DEBUG, \"   max_background=%i\\n\", outarg.max_background);\n    fuse_log(FUSE_LOG_DEBUG, \"   congestion_threshold=%i\\n\",\n             outarg.congestion_threshold);\n    fuse_log(FUSE_LOG_DEBUG, \"   time_gran=%u\\n\", outarg.time_gran);\n\n    send_reply_ok(req, &outarg, outargsize);\n}"
  },
  {
    "function_name": "do_lseek",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1858-1877",
    "snippet": "static void do_lseek(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_lseek_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.lseek) {\n        req->se->op.lseek(req, nodeid, arg->offset, arg->whence, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1875
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.lseek",
          "args": [
            "req",
            "nodeid",
            "arg->offset",
            "arg->whence",
            "&fi"
          ],
          "line": 1873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1864
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_lseek(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_lseek_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.lseek) {\n        req->se->op.lseek(req, nodeid, arg->offset, arg->whence, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_copy_file_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1830-1856",
    "snippet": "static void do_copy_file_range(fuse_req_t req, fuse_ino_t nodeid_in,\n                               struct fuse_mbuf_iter *iter)\n{\n    struct fuse_copy_file_range_in *arg;\n    struct fuse_file_info fi_in, fi_out;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi_in, 0, sizeof(fi_in));\n    fi_in.fh = arg->fh_in;\n\n    memset(&fi_out, 0, sizeof(fi_out));\n    fi_out.fh = arg->fh_out;\n\n\n    if (req->se->op.copy_file_range) {\n        req->se->op.copy_file_range(req, nodeid_in, arg->off_in, &fi_in,\n                                    arg->nodeid_out, arg->off_out, &fi_out,\n                                    arg->len, arg->flags);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1854
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.copy_file_range",
          "args": [
            "req",
            "nodeid_in",
            "arg->off_in",
            "&fi_in",
            "arg->nodeid_out",
            "arg->off_out",
            "&fi_out",
            "arg->len",
            "arg->flags"
          ],
          "line": 1850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi_out",
            "0",
            "sizeof(fi_out)"
          ],
          "line": 1845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi_in",
            "0",
            "sizeof(fi_in)"
          ],
          "line": 1842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1836
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_copy_file_range(fuse_req_t req, fuse_ino_t nodeid_in,\n                               struct fuse_mbuf_iter *iter)\n{\n    struct fuse_copy_file_range_in *arg;\n    struct fuse_file_info fi_in, fi_out;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi_in, 0, sizeof(fi_in));\n    fi_in.fh = arg->fh_in;\n\n    memset(&fi_out, 0, sizeof(fi_out));\n    fi_out.fh = arg->fh_out;\n\n\n    if (req->se->op.copy_file_range) {\n        req->se->op.copy_file_range(req, nodeid_in, arg->off_in, &fi_in,\n                                    arg->nodeid_out, arg->off_out, &fi_out,\n                                    arg->len, arg->flags);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_fallocate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1807-1828",
    "snippet": "static void do_fallocate(fuse_req_t req, fuse_ino_t nodeid,\n                         struct fuse_mbuf_iter *iter)\n{\n    struct fuse_fallocate_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.fallocate) {\n        req->se->op.fallocate(req, nodeid, arg->mode, arg->offset, arg->length,\n                              &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1826
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.fallocate",
          "args": [
            "req",
            "nodeid",
            "arg->mode",
            "arg->offset",
            "arg->length",
            "&fi"
          ],
          "line": 1823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1813
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_fallocate(fuse_req_t req, fuse_ino_t nodeid,\n                         struct fuse_mbuf_iter *iter)\n{\n    struct fuse_fallocate_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.fallocate) {\n        req->se->op.fallocate(req, nodeid, arg->mode, arg->offset, arg->length,\n                              &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_poll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1772-1805",
    "snippet": "static void do_poll(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    struct fuse_poll_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.poll_events = arg->events;\n\n    if (req->se->op.poll) {\n        struct fuse_pollhandle *ph = NULL;\n\n        if (arg->flags & FUSE_POLL_SCHEDULE_NOTIFY) {\n            ph = malloc(sizeof(struct fuse_pollhandle));\n            if (ph == NULL) {\n                fuse_reply_err(req, ENOMEM);\n                return;\n            }\n            ph->kh = arg->kh;\n            ph->se = req->se;\n        }\n\n        req->se->op.poll(req, nodeid, &fi, ph);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1803
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.poll",
          "args": [
            "req",
            "nodeid",
            "&fi",
            "ph"
          ],
          "line": 1801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct fuse_pollhandle)"
          ],
          "line": 1792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1778
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_poll(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    struct fuse_poll_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.poll_events = arg->events;\n\n    if (req->se->op.poll) {\n        struct fuse_pollhandle *ph = NULL;\n\n        if (arg->flags & FUSE_POLL_SCHEDULE_NOTIFY) {\n            ph = malloc(sizeof(struct fuse_pollhandle));\n            if (ph == NULL) {\n                fuse_reply_err(req, ENOMEM);\n                return;\n            }\n            ph->kh = arg->kh;\n            ph->se = req->se;\n        }\n\n        req->se->op.poll(req, nodeid, &fi, ph);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "fuse_pollhandle_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1767-1770",
    "snippet": "void fuse_pollhandle_destroy(struct fuse_pollhandle *ph)\n{\n    free(ph);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ph"
          ],
          "line": 1769
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_free_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "122-137",
          "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_pollhandle_destroy(struct fuse_pollhandle *ph)\n{\n    free(ph);\n}"
  },
  {
    "function_name": "do_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1724-1765",
    "snippet": "static void do_ioctl(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_ioctl_in *arg;\n    unsigned int flags;\n    void *in_buf = NULL;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    flags = arg->flags;\n    if (flags & FUSE_IOCTL_DIR && !(req->se->conn.want & FUSE_CAP_IOCTL_DIR)) {\n        fuse_reply_err(req, ENOTTY);\n        return;\n    }\n\n    if (arg->in_size) {\n        in_buf = fuse_mbuf_iter_advance(iter, arg->in_size);\n        if (!in_buf) {\n            fuse_reply_err(req, EINVAL);\n            return;\n        }\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (sizeof(void *) == 4 && !(flags & FUSE_IOCTL_32BIT)) {\n        req->ioctl_64bit = 1;\n    }\n\n    if (req->se->op.ioctl) {\n        req->se->op.ioctl(req, nodeid, arg->cmd, (void *)(uintptr_t)arg->arg,\n                          &fi, flags, in_buf, arg->in_size, arg->out_size);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1763
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.ioctl",
          "args": [
            "req",
            "nodeid",
            "arg->cmd",
            "(void *)(uintptr_t)arg->arg",
            "&fi",
            "flags",
            "in_buf",
            "arg->in_size",
            "arg->out_size"
          ],
          "line": 1760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "arg->in_size"
          ],
          "line": 1745
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_ioctl(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_ioctl_in *arg;\n    unsigned int flags;\n    void *in_buf = NULL;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    flags = arg->flags;\n    if (flags & FUSE_IOCTL_DIR && !(req->se->conn.want & FUSE_CAP_IOCTL_DIR)) {\n        fuse_reply_err(req, ENOTTY);\n        return;\n    }\n\n    if (arg->in_size) {\n        in_buf = fuse_mbuf_iter_advance(iter, arg->in_size);\n        if (!in_buf) {\n            fuse_reply_err(req, EINVAL);\n            return;\n        }\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (sizeof(void *) == 4 && !(flags & FUSE_IOCTL_32BIT)) {\n        req->ioctl_64bit = 1;\n    }\n\n    if (req->se->op.ioctl) {\n        req->se->op.ioctl(req, nodeid, arg->cmd, (void *)(uintptr_t)arg->arg,\n                          &fi, flags, in_buf, arg->in_size, arg->out_size);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_bmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1707-1722",
    "snippet": "static void do_bmap(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    struct fuse_bmap_in *arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.bmap) {\n        req->se->op.bmap(req, nodeid, arg->blocksize, arg->block);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1720
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.bmap",
          "args": [
            "req",
            "nodeid",
            "arg->blocksize",
            "arg->block"
          ],
          "line": 1718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1710
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_bmap(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    struct fuse_bmap_in *arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.bmap) {\n        req->se->op.bmap(req, nodeid, arg->blocksize, arg->block);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "check_interrupt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1683-1705",
    "snippet": "static struct fuse_req *check_interrupt(struct fuse_session *se,\n                                        struct fuse_req *req)\n{\n    struct fuse_req *curr;\n\n    for (curr = se->interrupts.next; curr != &se->interrupts;\n         curr = curr->next) {\n        if (curr->u.i.unique == req->unique) {\n            req->interrupted = 1;\n            list_del_req(curr);\n            free(curr);\n            return NULL;\n        }\n    }\n    curr = se->interrupts.next;\n    if (curr != &se->interrupts) {\n        list_del_req(curr);\n        list_init_req(curr);\n        return curr;\n    } else {\n        return NULL;\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_init_req",
          "args": [
            "curr"
          ],
          "line": 1700
        },
        "resolved": true,
        "details": {
          "function_name": "list_init_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "93-97",
          "snippet": "static void list_init_req(struct fuse_req *req)\n{\n    req->next = req;\n    req->prev = req;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void list_init_req(struct fuse_req *req)\n{\n    req->next = req;\n    req->prev = req;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_req",
          "args": [
            "curr"
          ],
          "line": 1699
        },
        "resolved": true,
        "details": {
          "function_name": "list_del_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "99-105",
          "snippet": "static void list_del_req(struct fuse_req *req)\n{\n    struct fuse_req *prev = req->prev;\n    struct fuse_req *next = req->next;\n    prev->next = next;\n    next->prev = prev;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void list_del_req(struct fuse_req *req)\n{\n    struct fuse_req *prev = req->prev;\n    struct fuse_req *next = req->next;\n    prev->next = next;\n    next->prev = prev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "curr"
          ],
          "line": 1693
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_free_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "122-137",
          "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic struct fuse_req *check_interrupt(struct fuse_session *se,\n                                        struct fuse_req *req)\n{\n    struct fuse_req *curr;\n\n    for (curr = se->interrupts.next; curr != &se->interrupts;\n         curr = curr->next) {\n        if (curr->u.i.unique == req->unique) {\n            req->interrupted = 1;\n            list_del_req(curr);\n            free(curr);\n            return NULL;\n        }\n    }\n    curr = se->interrupts.next;\n    if (curr != &se->interrupts) {\n        list_del_req(curr);\n        list_init_req(curr);\n        return curr;\n    } else {\n        return NULL;\n    }\n}"
  },
  {
    "function_name": "do_interrupt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1655-1681",
    "snippet": "static void do_interrupt(fuse_req_t req, fuse_ino_t nodeid,\n                         struct fuse_mbuf_iter *iter)\n{\n    struct fuse_interrupt_in *arg;\n    struct fuse_session *se = req->se;\n\n    (void)nodeid;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    fuse_log(FUSE_LOG_DEBUG, \"INTERRUPT: %llu\\n\",\n             (unsigned long long)arg->unique);\n\n    req->u.i.unique = arg->unique;\n\n    pthread_mutex_lock(&se->lock);\n    if (find_interrupted(se, req)) {\n        destroy_req(req);\n    } else {\n        list_add_req(req, &se->interrupts);\n    }\n    pthread_mutex_unlock(&se->lock);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&se->lock"
          ],
          "line": 1680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_req",
          "args": [
            "req",
            "&se->interrupts"
          ],
          "line": 1678
        },
        "resolved": true,
        "details": {
          "function_name": "list_add_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "107-114",
          "snippet": "static void list_add_req(struct fuse_req *req, struct fuse_req *next)\n{\n    struct fuse_req *prev = next->prev;\n    req->next = next;\n    req->prev = prev;\n    prev->next = req;\n    next->prev = req;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void list_add_req(struct fuse_req *req, struct fuse_req *next)\n{\n    struct fuse_req *prev = next->prev;\n    req->next = next;\n    req->prev = prev;\n    prev->next = req;\n    next->prev = req;\n}"
        }
      },
      {
        "call_info": {
          "callee": "destroy_req",
          "args": [
            "req"
          ],
          "line": 1676
        },
        "resolved": true,
        "details": {
          "function_name": "destroy_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "116-120",
          "snippet": "static void destroy_req(fuse_req_t req)\n{\n    pthread_mutex_destroy(&req->lock);\n    free(req);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void destroy_req(fuse_req_t req)\n{\n    pthread_mutex_destroy(&req->lock);\n    free(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_interrupted",
          "args": [
            "se",
            "req"
          ],
          "line": 1675
        },
        "resolved": true,
        "details": {
          "function_name": "find_interrupted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "1613-1653",
          "snippet": "static int find_interrupted(struct fuse_session *se, struct fuse_req *req)\n{\n    struct fuse_req *curr;\n\n    for (curr = se->list.next; curr != &se->list; curr = curr->next) {\n        if (curr->unique == req->u.i.unique) {\n            fuse_interrupt_func_t func;\n            void *data;\n\n            curr->ctr++;\n            pthread_mutex_unlock(&se->lock);\n\n            /* Ugh, ugly locking */\n            pthread_mutex_lock(&curr->lock);\n            pthread_mutex_lock(&se->lock);\n            curr->interrupted = 1;\n            func = curr->u.ni.func;\n            data = curr->u.ni.data;\n            pthread_mutex_unlock(&se->lock);\n            if (func) {\n                func(curr, data);\n            }\n            pthread_mutex_unlock(&curr->lock);\n\n            pthread_mutex_lock(&se->lock);\n            curr->ctr--;\n            if (!curr->ctr) {\n                destroy_req(curr);\n            }\n\n            return 1;\n        }\n    }\n    for (curr = se->interrupts.next; curr != &se->interrupts;\n         curr = curr->next) {\n        if (curr->u.i.unique == req->u.i.unique) {\n            return 1;\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int find_interrupted(struct fuse_session *se, struct fuse_req *req)\n{\n    struct fuse_req *curr;\n\n    for (curr = se->list.next; curr != &se->list; curr = curr->next) {\n        if (curr->unique == req->u.i.unique) {\n            fuse_interrupt_func_t func;\n            void *data;\n\n            curr->ctr++;\n            pthread_mutex_unlock(&se->lock);\n\n            /* Ugh, ugly locking */\n            pthread_mutex_lock(&curr->lock);\n            pthread_mutex_lock(&se->lock);\n            curr->interrupted = 1;\n            func = curr->u.ni.func;\n            data = curr->u.ni.data;\n            pthread_mutex_unlock(&se->lock);\n            if (func) {\n                func(curr, data);\n            }\n            pthread_mutex_unlock(&curr->lock);\n\n            pthread_mutex_lock(&se->lock);\n            curr->ctr--;\n            if (!curr->ctr) {\n                destroy_req(curr);\n            }\n\n            return 1;\n        }\n    }\n    for (curr = se->interrupts.next; curr != &se->interrupts;\n         curr = curr->next) {\n        if (curr->u.i.unique == req->u.i.unique) {\n            return 1;\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&se->lock"
          ],
          "line": 1674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_DEBUG",
            "\"INTERRUPT: %llu\\n\"",
            "(unsigned long long)arg->unique"
          ],
          "line": 1669
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "EINVAL"
          ],
          "line": 1665
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1663
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_interrupt(fuse_req_t req, fuse_ino_t nodeid,\n                         struct fuse_mbuf_iter *iter)\n{\n    struct fuse_interrupt_in *arg;\n    struct fuse_session *se = req->se;\n\n    (void)nodeid;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    fuse_log(FUSE_LOG_DEBUG, \"INTERRUPT: %llu\\n\",\n             (unsigned long long)arg->unique);\n\n    req->u.i.unique = arg->unique;\n\n    pthread_mutex_lock(&se->lock);\n    if (find_interrupted(se, req)) {\n        destroy_req(req);\n    } else {\n        list_add_req(req, &se->interrupts);\n    }\n    pthread_mutex_unlock(&se->lock);\n}"
  },
  {
    "function_name": "find_interrupted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1613-1653",
    "snippet": "static int find_interrupted(struct fuse_session *se, struct fuse_req *req)\n{\n    struct fuse_req *curr;\n\n    for (curr = se->list.next; curr != &se->list; curr = curr->next) {\n        if (curr->unique == req->u.i.unique) {\n            fuse_interrupt_func_t func;\n            void *data;\n\n            curr->ctr++;\n            pthread_mutex_unlock(&se->lock);\n\n            /* Ugh, ugly locking */\n            pthread_mutex_lock(&curr->lock);\n            pthread_mutex_lock(&se->lock);\n            curr->interrupted = 1;\n            func = curr->u.ni.func;\n            data = curr->u.ni.data;\n            pthread_mutex_unlock(&se->lock);\n            if (func) {\n                func(curr, data);\n            }\n            pthread_mutex_unlock(&curr->lock);\n\n            pthread_mutex_lock(&se->lock);\n            curr->ctr--;\n            if (!curr->ctr) {\n                destroy_req(curr);\n            }\n\n            return 1;\n        }\n    }\n    for (curr = se->interrupts.next; curr != &se->interrupts;\n         curr = curr->next) {\n        if (curr->u.i.unique == req->u.i.unique) {\n            return 1;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "destroy_req",
          "args": [
            "curr"
          ],
          "line": 1640
        },
        "resolved": true,
        "details": {
          "function_name": "destroy_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "116-120",
          "snippet": "static void destroy_req(fuse_req_t req)\n{\n    pthread_mutex_destroy(&req->lock);\n    free(req);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void destroy_req(fuse_req_t req)\n{\n    pthread_mutex_destroy(&req->lock);\n    free(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&se->lock"
          ],
          "line": 1637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&curr->lock"
          ],
          "line": 1635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "func",
          "args": [
            "curr",
            "data"
          ],
          "line": 1633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&se->lock"
          ],
          "line": 1631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&se->lock"
          ],
          "line": 1627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&curr->lock"
          ],
          "line": 1626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&se->lock"
          ],
          "line": 1623
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int find_interrupted(struct fuse_session *se, struct fuse_req *req)\n{\n    struct fuse_req *curr;\n\n    for (curr = se->list.next; curr != &se->list; curr = curr->next) {\n        if (curr->unique == req->u.i.unique) {\n            fuse_interrupt_func_t func;\n            void *data;\n\n            curr->ctr++;\n            pthread_mutex_unlock(&se->lock);\n\n            /* Ugh, ugly locking */\n            pthread_mutex_lock(&curr->lock);\n            pthread_mutex_lock(&se->lock);\n            curr->interrupted = 1;\n            func = curr->u.ni.func;\n            data = curr->u.ni.data;\n            pthread_mutex_unlock(&se->lock);\n            if (func) {\n                func(curr, data);\n            }\n            pthread_mutex_unlock(&curr->lock);\n\n            pthread_mutex_lock(&se->lock);\n            curr->ctr--;\n            if (!curr->ctr) {\n                destroy_req(curr);\n            }\n\n            return 1;\n        }\n    }\n    for (curr = se->interrupts.next; curr != &se->interrupts;\n         curr = curr->next) {\n        if (curr->u.i.unique == req->u.i.unique) {\n            return 1;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "do_setlkw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1607-1611",
    "snippet": "static void do_setlkw(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    do_setlk_common(req, nodeid, iter, 1);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_setlk_common",
          "args": [
            "req",
            "nodeid",
            "iter",
            "1"
          ],
          "line": 1610
        },
        "resolved": true,
        "details": {
          "function_name": "do_setlk_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "1551-1599",
          "snippet": "static void do_setlk_common(fuse_req_t req, fuse_ino_t nodeid,\n                            struct fuse_mbuf_iter *iter, int sleep)\n{\n    struct fuse_lk_in *arg;\n    struct fuse_file_info fi;\n    struct flock flock;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.lock_owner = arg->owner;\n\n    if (arg->lk_flags & FUSE_LK_FLOCK) {\n        int op = 0;\n\n        switch (arg->lk.type) {\n        case F_RDLCK:\n            op = LOCK_SH;\n            break;\n        case F_WRLCK:\n            op = LOCK_EX;\n            break;\n        case F_UNLCK:\n            op = LOCK_UN;\n            break;\n        }\n        if (!sleep) {\n            op |= LOCK_NB;\n        }\n\n        if (req->se->op.flock) {\n            req->se->op.flock(req, nodeid, &fi, op);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    } else {\n        convert_fuse_file_lock(&arg->lk, &flock);\n        if (req->se->op.setlk) {\n            req->se->op.setlk(req, nodeid, &fi, &flock, sleep);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_setlk_common(fuse_req_t req, fuse_ino_t nodeid,\n                            struct fuse_mbuf_iter *iter, int sleep)\n{\n    struct fuse_lk_in *arg;\n    struct fuse_file_info fi;\n    struct flock flock;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.lock_owner = arg->owner;\n\n    if (arg->lk_flags & FUSE_LK_FLOCK) {\n        int op = 0;\n\n        switch (arg->lk.type) {\n        case F_RDLCK:\n            op = LOCK_SH;\n            break;\n        case F_WRLCK:\n            op = LOCK_EX;\n            break;\n        case F_UNLCK:\n            op = LOCK_UN;\n            break;\n        }\n        if (!sleep) {\n            op |= LOCK_NB;\n        }\n\n        if (req->se->op.flock) {\n            req->se->op.flock(req, nodeid, &fi, op);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    } else {\n        convert_fuse_file_lock(&arg->lk, &flock);\n        if (req->se->op.setlk) {\n            req->se->op.setlk(req, nodeid, &fi, &flock, sleep);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_setlkw(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    do_setlk_common(req, nodeid, iter, 1);\n}"
  },
  {
    "function_name": "do_setlk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1601-1605",
    "snippet": "static void do_setlk(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    do_setlk_common(req, nodeid, iter, 0);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_setlk_common",
          "args": [
            "req",
            "nodeid",
            "iter",
            "0"
          ],
          "line": 1604
        },
        "resolved": true,
        "details": {
          "function_name": "do_setlk_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "1551-1599",
          "snippet": "static void do_setlk_common(fuse_req_t req, fuse_ino_t nodeid,\n                            struct fuse_mbuf_iter *iter, int sleep)\n{\n    struct fuse_lk_in *arg;\n    struct fuse_file_info fi;\n    struct flock flock;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.lock_owner = arg->owner;\n\n    if (arg->lk_flags & FUSE_LK_FLOCK) {\n        int op = 0;\n\n        switch (arg->lk.type) {\n        case F_RDLCK:\n            op = LOCK_SH;\n            break;\n        case F_WRLCK:\n            op = LOCK_EX;\n            break;\n        case F_UNLCK:\n            op = LOCK_UN;\n            break;\n        }\n        if (!sleep) {\n            op |= LOCK_NB;\n        }\n\n        if (req->se->op.flock) {\n            req->se->op.flock(req, nodeid, &fi, op);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    } else {\n        convert_fuse_file_lock(&arg->lk, &flock);\n        if (req->se->op.setlk) {\n            req->se->op.setlk(req, nodeid, &fi, &flock, sleep);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_setlk_common(fuse_req_t req, fuse_ino_t nodeid,\n                            struct fuse_mbuf_iter *iter, int sleep)\n{\n    struct fuse_lk_in *arg;\n    struct fuse_file_info fi;\n    struct flock flock;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.lock_owner = arg->owner;\n\n    if (arg->lk_flags & FUSE_LK_FLOCK) {\n        int op = 0;\n\n        switch (arg->lk.type) {\n        case F_RDLCK:\n            op = LOCK_SH;\n            break;\n        case F_WRLCK:\n            op = LOCK_EX;\n            break;\n        case F_UNLCK:\n            op = LOCK_UN;\n            break;\n        }\n        if (!sleep) {\n            op |= LOCK_NB;\n        }\n\n        if (req->se->op.flock) {\n            req->se->op.flock(req, nodeid, &fi, op);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    } else {\n        convert_fuse_file_lock(&arg->lk, &flock);\n        if (req->se->op.setlk) {\n            req->se->op.setlk(req, nodeid, &fi, &flock, sleep);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_setlk(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    do_setlk_common(req, nodeid, iter, 0);\n}"
  },
  {
    "function_name": "do_setlk_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1551-1599",
    "snippet": "static void do_setlk_common(fuse_req_t req, fuse_ino_t nodeid,\n                            struct fuse_mbuf_iter *iter, int sleep)\n{\n    struct fuse_lk_in *arg;\n    struct fuse_file_info fi;\n    struct flock flock;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.lock_owner = arg->owner;\n\n    if (arg->lk_flags & FUSE_LK_FLOCK) {\n        int op = 0;\n\n        switch (arg->lk.type) {\n        case F_RDLCK:\n            op = LOCK_SH;\n            break;\n        case F_WRLCK:\n            op = LOCK_EX;\n            break;\n        case F_UNLCK:\n            op = LOCK_UN;\n            break;\n        }\n        if (!sleep) {\n            op |= LOCK_NB;\n        }\n\n        if (req->se->op.flock) {\n            req->se->op.flock(req, nodeid, &fi, op);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    } else {\n        convert_fuse_file_lock(&arg->lk, &flock);\n        if (req->se->op.setlk) {\n            req->se->op.setlk(req, nodeid, &fi, &flock, sleep);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1596
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.setlk",
          "args": [
            "req",
            "nodeid",
            "&fi",
            "&flock",
            "sleep"
          ],
          "line": 1594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_fuse_file_lock",
          "args": [
            "&arg->lk",
            "&flock"
          ],
          "line": 1592
        },
        "resolved": true,
        "details": {
          "function_name": "convert_fuse_file_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "1511-1524",
          "snippet": "static void convert_fuse_file_lock(struct fuse_file_lock *fl,\n                                   struct flock *flock)\n{\n    memset(flock, 0, sizeof(struct flock));\n    flock->l_type = fl->type;\n    flock->l_whence = SEEK_SET;\n    flock->l_start = fl->start;\n    if (fl->end == OFFSET_MAX) {\n        flock->l_len = 0;\n    } else {\n        flock->l_len = fl->end - fl->start + 1;\n    }\n    flock->l_pid = fl->pid;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [
            "#define OFFSET_MAX 0x7fffffffffffffffLL"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\n#define OFFSET_MAX 0x7fffffffffffffffLL\n\nstatic void convert_fuse_file_lock(struct fuse_file_lock *fl,\n                                   struct flock *flock)\n{\n    memset(flock, 0, sizeof(struct flock));\n    flock->l_type = fl->type;\n    flock->l_whence = SEEK_SET;\n    flock->l_start = fl->start;\n    if (fl->end == OFFSET_MAX) {\n        flock->l_len = 0;\n    } else {\n        flock->l_len = fl->end - fl->start + 1;\n    }\n    flock->l_pid = fl->pid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.flock",
          "args": [
            "req",
            "nodeid",
            "&fi",
            "op"
          ],
          "line": 1587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1558
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_setlk_common(fuse_req_t req, fuse_ino_t nodeid,\n                            struct fuse_mbuf_iter *iter, int sleep)\n{\n    struct fuse_lk_in *arg;\n    struct fuse_file_info fi;\n    struct flock flock;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.lock_owner = arg->owner;\n\n    if (arg->lk_flags & FUSE_LK_FLOCK) {\n        int op = 0;\n\n        switch (arg->lk.type) {\n        case F_RDLCK:\n            op = LOCK_SH;\n            break;\n        case F_WRLCK:\n            op = LOCK_EX;\n            break;\n        case F_UNLCK:\n            op = LOCK_UN;\n            break;\n        }\n        if (!sleep) {\n            op |= LOCK_NB;\n        }\n\n        if (req->se->op.flock) {\n            req->se->op.flock(req, nodeid, &fi, op);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    } else {\n        convert_fuse_file_lock(&arg->lk, &flock);\n        if (req->se->op.setlk) {\n            req->se->op.setlk(req, nodeid, &fi, &flock, sleep);\n        } else {\n            fuse_reply_err(req, ENOSYS);\n        }\n    }\n}"
  },
  {
    "function_name": "do_getlk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1526-1549",
    "snippet": "static void do_getlk(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_lk_in *arg;\n    struct fuse_file_info fi;\n    struct flock flock;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.lock_owner = arg->owner;\n\n    convert_fuse_file_lock(&arg->lk, &flock);\n    if (req->se->op.getlk) {\n        req->se->op.getlk(req, nodeid, &fi, &flock);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1547
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.getlk",
          "args": [
            "req",
            "nodeid",
            "&fi",
            "&flock"
          ],
          "line": 1545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_fuse_file_lock",
          "args": [
            "&arg->lk",
            "&flock"
          ],
          "line": 1543
        },
        "resolved": true,
        "details": {
          "function_name": "convert_fuse_file_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "1511-1524",
          "snippet": "static void convert_fuse_file_lock(struct fuse_file_lock *fl,\n                                   struct flock *flock)\n{\n    memset(flock, 0, sizeof(struct flock));\n    flock->l_type = fl->type;\n    flock->l_whence = SEEK_SET;\n    flock->l_start = fl->start;\n    if (fl->end == OFFSET_MAX) {\n        flock->l_len = 0;\n    } else {\n        flock->l_len = fl->end - fl->start + 1;\n    }\n    flock->l_pid = fl->pid;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [
            "#define OFFSET_MAX 0x7fffffffffffffffLL"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\n#define OFFSET_MAX 0x7fffffffffffffffLL\n\nstatic void convert_fuse_file_lock(struct fuse_file_lock *fl,\n                                   struct flock *flock)\n{\n    memset(flock, 0, sizeof(struct flock));\n    flock->l_type = fl->type;\n    flock->l_whence = SEEK_SET;\n    flock->l_start = fl->start;\n    if (fl->end == OFFSET_MAX) {\n        flock->l_len = 0;\n    } else {\n        flock->l_len = fl->end - fl->start + 1;\n    }\n    flock->l_pid = fl->pid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1533
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_getlk(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_lk_in *arg;\n    struct fuse_file_info fi;\n    struct flock flock;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.lock_owner = arg->owner;\n\n    convert_fuse_file_lock(&arg->lk, &flock);\n    if (req->se->op.getlk) {\n        req->se->op.getlk(req, nodeid, &fi, &flock);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "convert_fuse_file_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1511-1524",
    "snippet": "static void convert_fuse_file_lock(struct fuse_file_lock *fl,\n                                   struct flock *flock)\n{\n    memset(flock, 0, sizeof(struct flock));\n    flock->l_type = fl->type;\n    flock->l_whence = SEEK_SET;\n    flock->l_start = fl->start;\n    if (fl->end == OFFSET_MAX) {\n        flock->l_len = 0;\n    } else {\n        flock->l_len = fl->end - fl->start + 1;\n    }\n    flock->l_pid = fl->pid;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [
      "#define OFFSET_MAX 0x7fffffffffffffffLL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "flock",
            "0",
            "sizeof(struct flock)"
          ],
          "line": 1514
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\n#define OFFSET_MAX 0x7fffffffffffffffLL\n\nstatic void convert_fuse_file_lock(struct fuse_file_lock *fl,\n                                   struct flock *flock)\n{\n    memset(flock, 0, sizeof(struct flock));\n    flock->l_type = fl->type;\n    flock->l_whence = SEEK_SET;\n    flock->l_start = fl->start;\n    if (fl->end == OFFSET_MAX) {\n        flock->l_len = 0;\n    } else {\n        flock->l_len = fl->end - fl->start + 1;\n    }\n    flock->l_pid = fl->pid;\n}"
  },
  {
    "function_name": "do_removexattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1494-1509",
    "snippet": "static void do_removexattr(fuse_req_t req, fuse_ino_t nodeid,\n                           struct fuse_mbuf_iter *iter)\n{\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n\n    if (!name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.removexattr) {\n        req->se->op.removexattr(req, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1507
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.removexattr",
          "args": [
            "req",
            "nodeid",
            "name"
          ],
          "line": 1505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 1497
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_removexattr(fuse_req_t req, fuse_ino_t nodeid,\n                           struct fuse_mbuf_iter *iter)\n{\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n\n    if (!name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.removexattr) {\n        req->se->op.removexattr(req, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_listxattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1476-1492",
    "snippet": "static void do_listxattr(fuse_req_t req, fuse_ino_t nodeid,\n                         struct fuse_mbuf_iter *iter)\n{\n    struct fuse_getxattr_in *arg;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.listxattr) {\n        req->se->op.listxattr(req, nodeid, arg->size);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1490
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.listxattr",
          "args": [
            "req",
            "nodeid",
            "arg->size"
          ],
          "line": 1488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1481
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_listxattr(fuse_req_t req, fuse_ino_t nodeid,\n                         struct fuse_mbuf_iter *iter)\n{\n    struct fuse_getxattr_in *arg;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.listxattr) {\n        req->se->op.listxattr(req, nodeid, arg->size);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_getxattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1456-1474",
    "snippet": "static void do_getxattr(fuse_req_t req, fuse_ino_t nodeid,\n                        struct fuse_mbuf_iter *iter)\n{\n    struct fuse_getxattr_in *arg;\n    const char *name;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    name = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.getxattr) {\n        req->se->op.getxattr(req, nodeid, name, arg->size);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1472
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.getxattr",
          "args": [
            "req",
            "nodeid",
            "name",
            "arg->size"
          ],
          "line": 1470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 1463
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1462
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_getxattr(fuse_req_t req, fuse_ino_t nodeid,\n                        struct fuse_mbuf_iter *iter)\n{\n    struct fuse_getxattr_in *arg;\n    const char *name;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    name = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.getxattr) {\n        req->se->op.getxattr(req, nodeid, name, arg->size);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_setxattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1429-1454",
    "snippet": "static void do_setxattr(fuse_req_t req, fuse_ino_t nodeid,\n                        struct fuse_mbuf_iter *iter)\n{\n    struct fuse_setxattr_in *arg;\n    const char *name;\n    const char *value;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    name = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    value = fuse_mbuf_iter_advance(iter, arg->size);\n    if (!value) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.setxattr) {\n        req->se->op.setxattr(req, nodeid, name, value, arg->size, arg->flags);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1452
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.setxattr",
          "args": [
            "req",
            "nodeid",
            "name",
            "value",
            "arg->size",
            "arg->flags"
          ],
          "line": 1450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "arg->size"
          ],
          "line": 1443
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 1437
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_setxattr(fuse_req_t req, fuse_ino_t nodeid,\n                        struct fuse_mbuf_iter *iter)\n{\n    struct fuse_setxattr_in *arg;\n    const char *name;\n    const char *value;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    name = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    value = fuse_mbuf_iter_advance(iter, arg->size);\n    if (!value) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.setxattr) {\n        req->se->op.setxattr(req, nodeid, name, value, arg->size, arg->flags);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1412-1427",
    "snippet": "static void do_statfs(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    (void)nodeid;\n    (void)iter;\n\n    if (req->se->op.statfs) {\n        req->se->op.statfs(req, nodeid);\n    } else {\n        struct statvfs buf = {\n            .f_namemax = 255,\n            .f_bsize = 512,\n        };\n        fuse_reply_statfs(req, &buf);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_statfs",
          "args": [
            "req",
            "&buf"
          ],
          "line": 1425
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_statfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "524-533",
          "snippet": "int fuse_reply_statfs(fuse_req_t req, const struct statvfs *stbuf)\n{\n    struct fuse_statfs_out arg;\n    size_t size = sizeof(arg);\n\n    memset(&arg, 0, sizeof(arg));\n    convert_statfs(stbuf, &arg.st);\n\n    return send_reply_ok(req, &arg, size);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_statfs(fuse_req_t req, const struct statvfs *stbuf)\n{\n    struct fuse_statfs_out arg;\n    size_t size = sizeof(arg);\n\n    memset(&arg, 0, sizeof(arg));\n    convert_statfs(stbuf, &arg.st);\n\n    return send_reply_ok(req, &arg, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.statfs",
          "args": [
            "req",
            "nodeid"
          ],
          "line": 1419
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_statfs(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    (void)nodeid;\n    (void)iter;\n\n    if (req->se->op.statfs) {\n        req->se->op.statfs(req, nodeid);\n    } else {\n        struct statvfs buf = {\n            .f_namemax = 255,\n            .f_bsize = 512,\n        };\n        fuse_reply_statfs(req, &buf);\n    }\n}"
  },
  {
    "function_name": "do_fsyncdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1388-1410",
    "snippet": "static void do_fsyncdir(fuse_req_t req, fuse_ino_t nodeid,\n                        struct fuse_mbuf_iter *iter)\n{\n    struct fuse_fsync_in *arg;\n    struct fuse_file_info fi;\n    int datasync;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n    datasync = arg->fsync_flags & 1;\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.fsyncdir) {\n        req->se->op.fsyncdir(req, nodeid, datasync, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1408
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.fsyncdir",
          "args": [
            "req",
            "nodeid",
            "datasync",
            "&fi"
          ],
          "line": 1406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1395
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_fsyncdir(fuse_req_t req, fuse_ino_t nodeid,\n                        struct fuse_mbuf_iter *iter)\n{\n    struct fuse_fsync_in *arg;\n    struct fuse_file_info fi;\n    int datasync;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n    datasync = arg->fsync_flags & 1;\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.fsyncdir) {\n        req->se->op.fsyncdir(req, nodeid, datasync, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_releasedir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1365-1386",
    "snippet": "static void do_releasedir(fuse_req_t req, fuse_ino_t nodeid,\n                          struct fuse_mbuf_iter *iter)\n{\n    struct fuse_release_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.flags = arg->flags;\n    fi.fh = arg->fh;\n\n    if (req->se->op.releasedir) {\n        req->se->op.releasedir(req, nodeid, &fi);\n    } else {\n        fuse_reply_err(req, 0);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "0"
          ],
          "line": 1384
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.releasedir",
          "args": [
            "req",
            "nodeid",
            "&fi"
          ],
          "line": 1382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1371
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_releasedir(fuse_req_t req, fuse_ino_t nodeid,\n                          struct fuse_mbuf_iter *iter)\n{\n    struct fuse_release_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.flags = arg->flags;\n    fi.fh = arg->fh;\n\n    if (req->se->op.releasedir) {\n        req->se->op.releasedir(req, nodeid, &fi);\n    } else {\n        fuse_reply_err(req, 0);\n    }\n}"
  },
  {
    "function_name": "do_readdirplus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1343-1363",
    "snippet": "static void do_readdirplus(fuse_req_t req, fuse_ino_t nodeid,\n                           struct fuse_mbuf_iter *iter)\n{\n    struct fuse_read_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.readdirplus) {\n        req->se->op.readdirplus(req, nodeid, arg->size, arg->offset, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1361
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.readdirplus",
          "args": [
            "req",
            "nodeid",
            "arg->size",
            "arg->offset",
            "&fi"
          ],
          "line": 1359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1349
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_readdirplus(fuse_req_t req, fuse_ino_t nodeid,\n                           struct fuse_mbuf_iter *iter)\n{\n    struct fuse_read_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.readdirplus) {\n        req->se->op.readdirplus(req, nodeid, arg->size, arg->offset, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_readdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1321-1341",
    "snippet": "static void do_readdir(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_read_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.readdir) {\n        req->se->op.readdir(req, nodeid, arg->size, arg->offset, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1339
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.readdir",
          "args": [
            "req",
            "nodeid",
            "arg->size",
            "arg->offset",
            "&fi"
          ],
          "line": 1337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1327
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_readdir(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_read_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.readdir) {\n        req->se->op.readdir(req, nodeid, arg->size, arg->offset, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_opendir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1299-1319",
    "snippet": "static void do_opendir(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_open_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.flags = arg->flags;\n\n    if (req->se->op.opendir) {\n        req->se->op.opendir(req, nodeid, &fi);\n    } else {\n        fuse_reply_open(req, &fi);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_open",
          "args": [
            "req",
            "&fi"
          ],
          "line": 1317
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "443-450",
          "snippet": "int fuse_reply_open(fuse_req_t req, const struct fuse_file_info *f)\n{\n    struct fuse_open_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    fill_open(&arg, f);\n    return send_reply_ok(req, &arg, sizeof(arg));\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_open(fuse_req_t req, const struct fuse_file_info *f)\n{\n    struct fuse_open_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    fill_open(&arg, f);\n    return send_reply_ok(req, &arg, sizeof(arg));\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.opendir",
          "args": [
            "req",
            "nodeid",
            "&fi"
          ],
          "line": 1315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "EINVAL"
          ],
          "line": 1307
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1305
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_opendir(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_open_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.flags = arg->flags;\n\n    if (req->se->op.opendir) {\n        req->se->op.opendir(req, nodeid, &fi);\n    } else {\n        fuse_reply_open(req, &fi);\n    }\n}"
  },
  {
    "function_name": "do_fsync",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1271-1297",
    "snippet": "static void do_fsync(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_fsync_in *arg;\n    struct fuse_file_info fi;\n    int datasync;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n    datasync = arg->fsync_flags & 1;\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.fsync) {\n        if (fi.fh == (uint64_t)-1) {\n            req->se->op.fsync(req, nodeid, datasync, NULL);\n        } else {\n            req->se->op.fsync(req, nodeid, datasync, &fi);\n        }\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1295
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.fsync",
          "args": [
            "req",
            "nodeid",
            "datasync",
            "&fi"
          ],
          "line": 1292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "req->se->op.fsync",
          "args": [
            "req",
            "nodeid",
            "datasync",
            "NULL"
          ],
          "line": 1290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1278
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_fsync(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_fsync_in *arg;\n    struct fuse_file_info fi;\n    int datasync;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n    datasync = arg->fsync_flags & 1;\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n\n    if (req->se->op.fsync) {\n        if (fi.fh == (uint64_t)-1) {\n            req->se->op.fsync(req, nodeid, datasync, NULL);\n        } else {\n            req->se->op.fsync(req, nodeid, datasync, &fi);\n        }\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1242-1269",
    "snippet": "static void do_release(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_release_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.flags = arg->flags;\n    fi.fh = arg->fh;\n    fi.flush = (arg->release_flags & FUSE_RELEASE_FLUSH) ? 1 : 0;\n    fi.lock_owner = arg->lock_owner;\n\n    if (arg->release_flags & FUSE_RELEASE_FLOCK_UNLOCK) {\n        fi.flock_release = 1;\n    }\n\n    if (req->se->op.release) {\n        req->se->op.release(req, nodeid, &fi);\n    } else {\n        fuse_reply_err(req, 0);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "0"
          ],
          "line": 1267
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.release",
          "args": [
            "req",
            "nodeid",
            "&fi"
          ],
          "line": 1265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1248
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_release(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_release_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.flags = arg->flags;\n    fi.fh = arg->fh;\n    fi.flush = (arg->release_flags & FUSE_RELEASE_FLUSH) ? 1 : 0;\n    fi.lock_owner = arg->lock_owner;\n\n    if (arg->release_flags & FUSE_RELEASE_FLOCK_UNLOCK) {\n        fi.flock_release = 1;\n    }\n\n    if (req->se->op.release) {\n        req->se->op.release(req, nodeid, &fi);\n    } else {\n        fuse_reply_err(req, 0);\n    }\n}"
  },
  {
    "function_name": "do_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1218-1240",
    "snippet": "static void do_flush(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_flush_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.flush = 1;\n    fi.lock_owner = arg->lock_owner;\n\n    if (req->se->op.flush) {\n        req->se->op.flush(req, nodeid, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1238
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.flush",
          "args": [
            "req",
            "nodeid",
            "&fi"
          ],
          "line": 1236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1224
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_flush(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_flush_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.flush = 1;\n    fi.lock_owner = arg->lock_owner;\n\n    if (req->se->op.flush) {\n        req->se->op.flush(req, nodeid, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_write_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1168-1216",
    "snippet": "static void do_write_buf(fuse_req_t req, fuse_ino_t nodeid,\n                         struct fuse_mbuf_iter *iter, struct fuse_bufvec *ibufv)\n{\n    struct fuse_session *se = req->se;\n    struct fuse_bufvec *pbufv = ibufv;\n    struct fuse_bufvec tmpbufv = {\n        .buf[0] = ibufv->buf[0],\n        .count = 1,\n    };\n    struct fuse_write_in *arg;\n    size_t arg_size = sizeof(*arg);\n    struct fuse_file_info fi;\n\n    memset(&fi, 0, sizeof(fi));\n\n    arg = fuse_mbuf_iter_advance(iter, arg_size);\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    fi.lock_owner = arg->lock_owner;\n    fi.flags = arg->flags;\n    fi.fh = arg->fh;\n    fi.writepage = !!(arg->write_flags & FUSE_WRITE_CACHE);\n    fi.kill_priv = !!(arg->write_flags & FUSE_WRITE_KILL_PRIV);\n\n    if (ibufv->count == 1) {\n        assert(!(tmpbufv.buf[0].flags & FUSE_BUF_IS_FD));\n        tmpbufv.buf[0].mem = ((char *)arg) + arg_size;\n        tmpbufv.buf[0].size -= sizeof(struct fuse_in_header) + arg_size;\n        pbufv = &tmpbufv;\n    } else {\n        /*\n         *  Input bufv contains the headers in the first element\n         * and the data in the rest, we need to skip that first element\n         */\n        ibufv->buf[0].size = 0;\n    }\n\n    if (fuse_buf_size(pbufv) != arg->size) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: do_write_buf: buffer size doesn't match arg->size\\n\");\n        fuse_reply_err(req, EIO);\n        return;\n    }\n\n    se->op.write_buf(req, nodeid, pbufv, arg->offset, &fi);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "se->op.write_buf",
          "args": [
            "req",
            "nodeid",
            "pbufv",
            "arg->offset",
            "&fi"
          ],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "EIO"
          ],
          "line": 1211
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_ERR",
            "\"fuse: do_write_buf: buffer size doesn't match arg->size\\n\""
          ],
          "line": 1209
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_buf_size",
          "args": [
            "pbufv"
          ],
          "line": 1208
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_buf_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "21-35",
          "snippet": "size_t fuse_buf_size(const struct fuse_bufvec *bufv)\n{\n    size_t i;\n    size_t size = 0;\n\n    for (i = 0; i < bufv->count; i++) {\n        if (bufv->buf[i].size == SIZE_MAX) {\n            size = SIZE_MAX;\n        } else {\n            size += bufv->buf[i].size;\n        }\n    }\n\n    return size;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nsize_t fuse_buf_size(const struct fuse_bufvec *bufv)\n{\n    size_t i;\n    size_t size = 0;\n\n    for (i = 0; i < bufv->count; i++) {\n        if (bufv->buf[i].size == SIZE_MAX) {\n            size = SIZE_MAX;\n        } else {\n            size += bufv->buf[i].size;\n        }\n    }\n\n    return size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!(tmpbufv.buf[0].flags & FUSE_BUF_IS_FD)"
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "arg_size"
          ],
          "line": 1183
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_write_buf(fuse_req_t req, fuse_ino_t nodeid,\n                         struct fuse_mbuf_iter *iter, struct fuse_bufvec *ibufv)\n{\n    struct fuse_session *se = req->se;\n    struct fuse_bufvec *pbufv = ibufv;\n    struct fuse_bufvec tmpbufv = {\n        .buf[0] = ibufv->buf[0],\n        .count = 1,\n    };\n    struct fuse_write_in *arg;\n    size_t arg_size = sizeof(*arg);\n    struct fuse_file_info fi;\n\n    memset(&fi, 0, sizeof(fi));\n\n    arg = fuse_mbuf_iter_advance(iter, arg_size);\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    fi.lock_owner = arg->lock_owner;\n    fi.flags = arg->flags;\n    fi.fh = arg->fh;\n    fi.writepage = !!(arg->write_flags & FUSE_WRITE_CACHE);\n    fi.kill_priv = !!(arg->write_flags & FUSE_WRITE_KILL_PRIV);\n\n    if (ibufv->count == 1) {\n        assert(!(tmpbufv.buf[0].flags & FUSE_BUF_IS_FD));\n        tmpbufv.buf[0].mem = ((char *)arg) + arg_size;\n        tmpbufv.buf[0].size -= sizeof(struct fuse_in_header) + arg_size;\n        pbufv = &tmpbufv;\n    } else {\n        /*\n         *  Input bufv contains the headers in the first element\n         * and the data in the rest, we need to skip that first element\n         */\n        ibufv->buf[0].size = 0;\n    }\n\n    if (fuse_buf_size(pbufv) != arg->size) {\n        fuse_log(FUSE_LOG_ERR,\n                 \"fuse: do_write_buf: buffer size doesn't match arg->size\\n\");\n        fuse_reply_err(req, EIO);\n        return;\n    }\n\n    se->op.write_buf(req, nodeid, pbufv, arg->offset, &fi);\n}"
  },
  {
    "function_name": "do_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1134-1166",
    "snippet": "static void do_write(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_write_in *arg;\n    struct fuse_file_info fi;\n    const char *param;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    param = fuse_mbuf_iter_advance(iter, arg->size);\n    if (!param) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.writepage = (arg->write_flags & FUSE_WRITE_CACHE) != 0;\n    fi.kill_priv = !!(arg->write_flags & FUSE_WRITE_KILL_PRIV);\n\n    fi.lock_owner = arg->lock_owner;\n    fi.flags = arg->flags;\n\n    if (req->se->op.write) {\n        req->se->op.write(req, nodeid, param, arg->size, arg->offset, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.write",
          "args": [
            "req",
            "nodeid",
            "param",
            "arg->size",
            "arg->offset",
            "&fi"
          ],
          "line": 1162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "arg->size"
          ],
          "line": 1147
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_write(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_write_in *arg;\n    struct fuse_file_info fi;\n    const char *param;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    param = fuse_mbuf_iter_advance(iter, arg->size);\n    if (!param) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.fh = arg->fh;\n    fi.writepage = (arg->write_flags & FUSE_WRITE_CACHE) != 0;\n    fi.kill_priv = !!(arg->write_flags & FUSE_WRITE_KILL_PRIV);\n\n    fi.lock_owner = arg->lock_owner;\n    fi.flags = arg->flags;\n\n    if (req->se->op.write) {\n        req->se->op.write(req, nodeid, param, arg->size, arg->offset, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1111-1132",
    "snippet": "static void do_read(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    if (req->se->op.read) {\n        struct fuse_read_in *arg;\n        struct fuse_file_info fi;\n\n        arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n        if (!arg) {\n            fuse_reply_err(req, EINVAL);\n            return;\n        }\n\n        memset(&fi, 0, sizeof(fi));\n        fi.fh = arg->fh;\n        fi.lock_owner = arg->lock_owner;\n        fi.flags = arg->flags;\n        req->se->op.read(req, nodeid, arg->size, arg->offset, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.read",
          "args": [
            "req",
            "nodeid",
            "arg->size",
            "arg->offset",
            "&fi"
          ],
          "line": 1128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1118
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_read(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    if (req->se->op.read) {\n        struct fuse_read_in *arg;\n        struct fuse_file_info fi;\n\n        arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n        if (!arg) {\n            fuse_reply_err(req, EINVAL);\n            return;\n        }\n\n        memset(&fi, 0, sizeof(fi));\n        fi.fh = arg->fh;\n        fi.lock_owner = arg->lock_owner;\n        fi.flags = arg->flags;\n        req->se->op.read(req, nodeid, arg->size, arg->offset, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1089-1109",
    "snippet": "static void do_open(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    struct fuse_open_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.flags = arg->flags;\n\n    if (req->se->op.open) {\n        req->se->op.open(req, nodeid, &fi);\n    } else {\n        fuse_reply_open(req, &fi);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_open",
          "args": [
            "req",
            "&fi"
          ],
          "line": 1107
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "443-450",
          "snippet": "int fuse_reply_open(fuse_req_t req, const struct fuse_file_info *f)\n{\n    struct fuse_open_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    fill_open(&arg, f);\n    return send_reply_ok(req, &arg, sizeof(arg));\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_open(fuse_req_t req, const struct fuse_file_info *f)\n{\n    struct fuse_open_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    fill_open(&arg, f);\n    return send_reply_ok(req, &arg, sizeof(arg));\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.open",
          "args": [
            "req",
            "nodeid",
            "&fi"
          ],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "EINVAL"
          ],
          "line": 1097
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1095
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_open(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    struct fuse_open_in *arg;\n    struct fuse_file_info fi;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    memset(&fi, 0, sizeof(fi));\n    fi.flags = arg->flags;\n\n    if (req->se->op.open) {\n        req->se->op.open(req, nodeid, &fi);\n    } else {\n        fuse_reply_open(req, &fi);\n    }\n}"
  },
  {
    "function_name": "do_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1063-1087",
    "snippet": "static void do_create(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    if (req->se->op.create) {\n        struct fuse_create_in *arg;\n        struct fuse_file_info fi;\n        const char *name;\n\n        arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n        name = fuse_mbuf_iter_advance_str(iter);\n        if (!arg || !name) {\n            fuse_reply_err(req, EINVAL);\n            return;\n        }\n\n        memset(&fi, 0, sizeof(fi));\n        fi.flags = arg->flags;\n\n        req->ctx.umask = arg->umask;\n\n        req->se->op.create(req, nodeid, name, arg->mode, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.create",
          "args": [
            "req",
            "nodeid",
            "name",
            "arg->mode",
            "&fi"
          ],
          "line": 1083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 1078
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 1072
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1071
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_create(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    if (req->se->op.create) {\n        struct fuse_create_in *arg;\n        struct fuse_file_info fi;\n        const char *name;\n\n        arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n        name = fuse_mbuf_iter_advance_str(iter);\n        if (!arg || !name) {\n            fuse_reply_err(req, EINVAL);\n            return;\n        }\n\n        memset(&fi, 0, sizeof(fi));\n        fi.flags = arg->flags;\n\n        req->ctx.umask = arg->umask;\n\n        req->se->op.create(req, nodeid, name, arg->mode, &fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1045-1061",
    "snippet": "static void do_link(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    struct fuse_link_in *arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n\n    if (!arg || !name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.link) {\n        req->se->op.link(req, arg->oldnodeid, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1059
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.link",
          "args": [
            "req",
            "arg->oldnodeid",
            "nodeid",
            "name"
          ],
          "line": 1057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 1049
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1048
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_link(fuse_req_t req, fuse_ino_t nodeid,\n                    struct fuse_mbuf_iter *iter)\n{\n    struct fuse_link_in *arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n\n    if (!arg || !name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.link) {\n        req->se->op.link(req, arg->oldnodeid, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_rename2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1022-1043",
    "snippet": "static void do_rename2(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_rename2_in *arg;\n    const char *oldname;\n    const char *newname;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    oldname = fuse_mbuf_iter_advance_str(iter);\n    newname = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !oldname || !newname) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.rename) {\n        req->se->op.rename(req, nodeid, oldname, arg->newdir, newname,\n                           arg->flags);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.rename",
          "args": [
            "req",
            "nodeid",
            "oldname",
            "arg->newdir",
            "newname",
            "arg->flags"
          ],
          "line": 1038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 1031
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1029
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_rename2(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_rename2_in *arg;\n    const char *oldname;\n    const char *newname;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    oldname = fuse_mbuf_iter_advance_str(iter);\n    newname = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !oldname || !newname) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.rename) {\n        req->se->op.rename(req, nodeid, oldname, arg->newdir, newname,\n                           arg->flags);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_rename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "1000-1020",
    "snippet": "static void do_rename(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    struct fuse_rename_in *arg;\n    const char *oldname;\n    const char *newname;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    oldname = fuse_mbuf_iter_advance_str(iter);\n    newname = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !oldname || !newname) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.rename) {\n        req->se->op.rename(req, nodeid, oldname, arg->newdir, newname, 0);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 1018
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.rename",
          "args": [
            "req",
            "nodeid",
            "oldname",
            "arg->newdir",
            "newname",
            "0"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 1009
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_rename(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    struct fuse_rename_in *arg;\n    const char *oldname;\n    const char *newname;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    oldname = fuse_mbuf_iter_advance_str(iter);\n    newname = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !oldname || !newname) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.rename) {\n        req->se->op.rename(req, nodeid, oldname, arg->newdir, newname, 0);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_symlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "982-998",
    "snippet": "static void do_symlink(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n    const char *linkname = fuse_mbuf_iter_advance_str(iter);\n\n    if (!name || !linkname) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.symlink) {\n        req->se->op.symlink(req, linkname, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 996
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.symlink",
          "args": [
            "req",
            "linkname",
            "nodeid",
            "name"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_symlink(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n    const char *linkname = fuse_mbuf_iter_advance_str(iter);\n\n    if (!name || !linkname) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.symlink) {\n        req->se->op.symlink(req, linkname, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_rmdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "965-980",
    "snippet": "static void do_rmdir(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n\n    if (!name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.rmdir) {\n        req->se->op.rmdir(req, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 978
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.rmdir",
          "args": [
            "req",
            "nodeid",
            "name"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 968
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_rmdir(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n\n    if (!name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.rmdir) {\n        req->se->op.rmdir(req, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_unlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "948-963",
    "snippet": "static void do_unlink(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n\n    if (!name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.unlink) {\n        req->se->op.unlink(req, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 961
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.unlink",
          "args": [
            "req",
            "nodeid",
            "name"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_unlink(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n\n    if (!name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.unlink) {\n        req->se->op.unlink(req, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_mkdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "926-946",
    "snippet": "static void do_mkdir(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_mkdir_in *arg;\n    const char *name;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    name = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    req->ctx.umask = arg->umask;\n\n    if (req->se->op.mkdir) {\n        req->se->op.mkdir(req, nodeid, name, arg->mode);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 944
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.mkdir",
          "args": [
            "req",
            "nodeid",
            "name",
            "arg->mode"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 932
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_mkdir(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_mkdir_in *arg;\n    const char *name;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    name = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    req->ctx.umask = arg->umask;\n\n    if (req->se->op.mkdir) {\n        req->se->op.mkdir(req, nodeid, name, arg->mode);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_mknod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "904-924",
    "snippet": "static void do_mknod(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_mknod_in *arg;\n    const char *name;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    name = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    req->ctx.umask = arg->umask;\n\n    if (req->se->op.mknod) {\n        req->se->op.mknod(req, nodeid, name, arg->mode, arg->rdev);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.mknod",
          "args": [
            "req",
            "nodeid",
            "name",
            "arg->mode",
            "arg->rdev"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 911
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 910
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_mknod(fuse_req_t req, fuse_ino_t nodeid,\n                     struct fuse_mbuf_iter *iter)\n{\n    struct fuse_mknod_in *arg;\n    const char *name;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    name = fuse_mbuf_iter_advance_str(iter);\n    if (!arg || !name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    req->ctx.umask = arg->umask;\n\n    if (req->se->op.mknod) {\n        req->se->op.mknod(req, nodeid, name, arg->mode, arg->rdev);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_readlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "892-902",
    "snippet": "static void do_readlink(fuse_req_t req, fuse_ino_t nodeid,\n                        struct fuse_mbuf_iter *iter)\n{\n    (void)iter;\n\n    if (req->se->op.readlink) {\n        req->se->op.readlink(req, nodeid);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 900
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.readlink",
          "args": [
            "req",
            "nodeid"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_readlink(fuse_req_t req, fuse_ino_t nodeid,\n                        struct fuse_mbuf_iter *iter)\n{\n    (void)iter;\n\n    if (req->se->op.readlink) {\n        req->se->op.readlink(req, nodeid);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_access",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "874-890",
    "snippet": "static void do_access(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    struct fuse_access_in *arg;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.access) {\n        req->se->op.access(req, nodeid, arg->mask);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.access",
          "args": [
            "req",
            "nodeid",
            "arg->mask"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 879
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_access(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    struct fuse_access_in *arg;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.access) {\n        req->se->op.access(req, nodeid, arg->mask);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_setattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "839-872",
    "snippet": "static void do_setattr(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    if (req->se->op.setattr) {\n        struct fuse_setattr_in *arg;\n        struct fuse_file_info *fi = NULL;\n        struct fuse_file_info fi_store;\n        struct stat stbuf;\n\n        arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n        if (!arg) {\n            fuse_reply_err(req, EINVAL);\n            return;\n        }\n\n        memset(&stbuf, 0, sizeof(stbuf));\n        convert_attr(arg, &stbuf);\n        if (arg->valid & FATTR_FH) {\n            arg->valid &= ~FATTR_FH;\n            memset(&fi_store, 0, sizeof(fi_store));\n            fi = &fi_store;\n            fi->fh = arg->fh;\n        }\n        arg->valid &= FUSE_SET_ATTR_MODE | FUSE_SET_ATTR_UID |\n                      FUSE_SET_ATTR_GID | FUSE_SET_ATTR_SIZE |\n                      FUSE_SET_ATTR_ATIME | FUSE_SET_ATTR_MTIME |\n                      FUSE_SET_ATTR_ATIME_NOW | FUSE_SET_ATTR_MTIME_NOW |\n                      FUSE_SET_ATTR_CTIME;\n\n        req->se->op.setattr(req, nodeid, &stbuf, arg->valid, fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.setattr",
          "args": [
            "req",
            "nodeid",
            "&stbuf",
            "arg->valid",
            "fi"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi_store",
            "0",
            "sizeof(fi_store)"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_attr",
          "args": [
            "arg",
            "&stbuf"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "convert_attr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "68-80",
          "snippet": "static void convert_attr(const struct fuse_setattr_in *attr, struct stat *stbuf)\n{\n    stbuf->st_mode = attr->mode;\n    stbuf->st_uid = attr->uid;\n    stbuf->st_gid = attr->gid;\n    stbuf->st_size = attr->size;\n    stbuf->st_atime = attr->atime;\n    stbuf->st_mtime = attr->mtime;\n    stbuf->st_ctime = attr->ctime;\n    ST_ATIM_NSEC_SET(stbuf, attr->atimensec);\n    ST_MTIM_NSEC_SET(stbuf, attr->mtimensec);\n    ST_CTIM_NSEC_SET(stbuf, attr->ctimensec);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void convert_attr(const struct fuse_setattr_in *attr, struct stat *stbuf)\n{\n    stbuf->st_mode = attr->mode;\n    stbuf->st_uid = attr->uid;\n    stbuf->st_gid = attr->gid;\n    stbuf->st_size = attr->size;\n    stbuf->st_atime = attr->atime;\n    stbuf->st_mtime = attr->mtime;\n    stbuf->st_ctime = attr->ctime;\n    ST_ATIM_NSEC_SET(stbuf, attr->atimensec);\n    ST_MTIM_NSEC_SET(stbuf, attr->mtimensec);\n    ST_CTIM_NSEC_SET(stbuf, attr->ctimensec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&stbuf",
            "0",
            "sizeof(stbuf)"
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_setattr(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    if (req->se->op.setattr) {\n        struct fuse_setattr_in *arg;\n        struct fuse_file_info *fi = NULL;\n        struct fuse_file_info fi_store;\n        struct stat stbuf;\n\n        arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n        if (!arg) {\n            fuse_reply_err(req, EINVAL);\n            return;\n        }\n\n        memset(&stbuf, 0, sizeof(stbuf));\n        convert_attr(arg, &stbuf);\n        if (arg->valid & FATTR_FH) {\n            arg->valid &= ~FATTR_FH;\n            memset(&fi_store, 0, sizeof(fi_store));\n            fi = &fi_store;\n            fi->fh = arg->fh;\n        }\n        arg->valid &= FUSE_SET_ATTR_MODE | FUSE_SET_ATTR_UID |\n                      FUSE_SET_ATTR_GID | FUSE_SET_ATTR_SIZE |\n                      FUSE_SET_ATTR_ATIME | FUSE_SET_ATTR_MTIME |\n                      FUSE_SET_ATTR_ATIME_NOW | FUSE_SET_ATTR_MTIME_NOW |\n                      FUSE_SET_ATTR_CTIME;\n\n        req->se->op.setattr(req, nodeid, &stbuf, arg->valid, fi);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_getattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "812-837",
    "snippet": "static void do_getattr(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_file_info *fip = NULL;\n    struct fuse_file_info fi;\n\n    struct fuse_getattr_in *arg;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (arg->getattr_flags & FUSE_GETATTR_FH) {\n        memset(&fi, 0, sizeof(fi));\n        fi.fh = arg->fh;\n        fip = &fi;\n    }\n\n    if (req->se->op.getattr) {\n        req->se->op.getattr(req, nodeid, fip);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 835
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.getattr",
          "args": [
            "req",
            "nodeid",
            "fip"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&fi",
            "0",
            "sizeof(fi)"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_getattr(fuse_req_t req, fuse_ino_t nodeid,\n                       struct fuse_mbuf_iter *iter)\n{\n    struct fuse_file_info *fip = NULL;\n    struct fuse_file_info fi;\n\n    struct fuse_getattr_in *arg;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (arg->getattr_flags & FUSE_GETATTR_FH) {\n        memset(&fi, 0, sizeof(fi));\n        fi.fh = arg->fh;\n        fip = &fi;\n    }\n\n    if (req->se->op.getattr) {\n        req->se->op.getattr(req, nodeid, fip);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "do_batch_forget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "750-810",
    "snippet": "static void do_batch_forget(fuse_req_t req, fuse_ino_t nodeid,\n                            struct fuse_mbuf_iter *iter)\n{\n    struct fuse_batch_forget_in *arg;\n    struct fuse_forget_data *forgets;\n    size_t scount;\n\n    (void)nodeid;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_none(req);\n        return;\n    }\n\n    /*\n     * Prevent integer overflow.  The compiler emits the following warning\n     * unless we use the scount local variable:\n     *\n     * error: comparison is always false due to limited range of data type\n     * [-Werror=type-limits]\n     *\n     * This may be true on 64-bit hosts but we need this check for 32-bit\n     * hosts.\n     */\n    scount = arg->count;\n    if (scount > SIZE_MAX / sizeof(forgets[0])) {\n        fuse_reply_none(req);\n        return;\n    }\n\n    forgets = fuse_mbuf_iter_advance(iter, arg->count * sizeof(forgets[0]));\n    if (!forgets) {\n        fuse_reply_none(req);\n        return;\n    }\n\n    if (req->se->op.forget_multi) {\n        req->se->op.forget_multi(req, arg->count, forgets);\n    } else if (req->se->op.forget) {\n        unsigned int i;\n\n        for (i = 0; i < arg->count; i++) {\n            struct fuse_req *dummy_req;\n\n            dummy_req = fuse_ll_alloc_req(req->se);\n            if (dummy_req == NULL) {\n                break;\n            }\n\n            dummy_req->unique = req->unique;\n            dummy_req->ctx = req->ctx;\n            dummy_req->ch = NULL;\n\n            req->se->op.forget(dummy_req, forgets[i].ino, forgets[i].nlookup);\n        }\n        fuse_reply_none(req);\n    } else {\n        fuse_reply_none(req);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_none",
          "args": [
            "req"
          ],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_none",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "304-307",
          "snippet": "void fuse_reply_none(fuse_req_t req)\n{\n    fuse_free_req(req);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_reply_none(fuse_req_t req)\n{\n    fuse_free_req(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.forget",
          "args": [
            "dummy_req",
            "forgets[i].ino",
            "forgets[i].nlookup"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_ll_alloc_req",
          "args": [
            "req->se"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_ll_alloc_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "139-154",
          "snippet": "static struct fuse_req *fuse_ll_alloc_req(struct fuse_session *se)\n{\n    struct fuse_req *req;\n\n    req = (struct fuse_req *)calloc(1, sizeof(struct fuse_req));\n    if (req == NULL) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: failed to allocate request\\n\");\n    } else {\n        req->se = se;\n        req->ctr = 1;\n        list_init_req(req);\n        fuse_mutex_init(&req->lock);\n    }\n\n    return req;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic struct fuse_req *fuse_ll_alloc_req(struct fuse_session *se)\n{\n    struct fuse_req *req;\n\n    req = (struct fuse_req *)calloc(1, sizeof(struct fuse_req));\n    if (req == NULL) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: failed to allocate request\\n\");\n    } else {\n        req->se = se;\n        req->ctr = 1;\n        list_init_req(req);\n        fuse_mutex_init(&req->lock);\n    }\n\n    return req;\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.forget_multi",
          "args": [
            "req",
            "arg->count",
            "forgets"
          ],
          "line": 788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "arg->count * sizeof(forgets[0])"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_batch_forget(fuse_req_t req, fuse_ino_t nodeid,\n                            struct fuse_mbuf_iter *iter)\n{\n    struct fuse_batch_forget_in *arg;\n    struct fuse_forget_data *forgets;\n    size_t scount;\n\n    (void)nodeid;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_none(req);\n        return;\n    }\n\n    /*\n     * Prevent integer overflow.  The compiler emits the following warning\n     * unless we use the scount local variable:\n     *\n     * error: comparison is always false due to limited range of data type\n     * [-Werror=type-limits]\n     *\n     * This may be true on 64-bit hosts but we need this check for 32-bit\n     * hosts.\n     */\n    scount = arg->count;\n    if (scount > SIZE_MAX / sizeof(forgets[0])) {\n        fuse_reply_none(req);\n        return;\n    }\n\n    forgets = fuse_mbuf_iter_advance(iter, arg->count * sizeof(forgets[0]));\n    if (!forgets) {\n        fuse_reply_none(req);\n        return;\n    }\n\n    if (req->se->op.forget_multi) {\n        req->se->op.forget_multi(req, arg->count, forgets);\n    } else if (req->se->op.forget) {\n        unsigned int i;\n\n        for (i = 0; i < arg->count; i++) {\n            struct fuse_req *dummy_req;\n\n            dummy_req = fuse_ll_alloc_req(req->se);\n            if (dummy_req == NULL) {\n                break;\n            }\n\n            dummy_req->unique = req->unique;\n            dummy_req->ctx = req->ctx;\n            dummy_req->ch = NULL;\n\n            req->se->op.forget(dummy_req, forgets[i].ino, forgets[i].nlookup);\n        }\n        fuse_reply_none(req);\n    } else {\n        fuse_reply_none(req);\n    }\n}"
  },
  {
    "function_name": "do_forget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "732-748",
    "snippet": "static void do_forget(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    struct fuse_forget_in *arg;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.forget) {\n        req->se->op.forget(req, nodeid, arg->nlookup);\n    } else {\n        fuse_reply_none(req);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_none",
          "args": [
            "req"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_none",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "304-307",
          "snippet": "void fuse_reply_none(fuse_req_t req)\n{\n    fuse_free_req(req);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_reply_none(fuse_req_t req)\n{\n    fuse_free_req(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.forget",
          "args": [
            "req",
            "nodeid",
            "arg->nlookup"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "EINVAL"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance",
          "args": [
            "iter",
            "sizeof(*arg)"
          ],
          "line": 737
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "325-336",
          "snippet": "void *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid *fuse_mbuf_iter_advance(struct fuse_mbuf_iter *iter, size_t len)\n{\n    void *ptr;\n\n    if (len > iter->size - iter->pos) {\n        return NULL;\n    }\n\n    ptr = iter->mem + iter->pos;\n    iter->pos += len;\n    return ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_forget(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    struct fuse_forget_in *arg;\n\n    arg = fuse_mbuf_iter_advance(iter, sizeof(*arg));\n    if (!arg) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.forget) {\n        req->se->op.forget(req, nodeid, arg->nlookup);\n    } else {\n        fuse_reply_none(req);\n    }\n}"
  },
  {
    "function_name": "do_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "716-730",
    "snippet": "static void do_lookup(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n    if (!name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.lookup) {\n        req->se->op.lookup(req, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOSYS"
          ],
          "line": 728
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "req->se->op.lookup",
          "args": [
            "req",
            "nodeid",
            "name"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_mbuf_iter_advance_str",
          "args": [
            "iter"
          ],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mbuf_iter_advance_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "338-351",
          "snippet": "const char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nconst char *fuse_mbuf_iter_advance_str(struct fuse_mbuf_iter *iter)\n{\n    const char *str = iter->mem + iter->pos;\n    size_t remaining = iter->size - iter->pos;\n    size_t i;\n\n    for (i = 0; i < remaining; i++) {\n        if (str[i] == '\\0') {\n            iter->pos += i + 1;\n            return str;\n        }\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void do_lookup(fuse_req_t req, fuse_ino_t nodeid,\n                      struct fuse_mbuf_iter *iter)\n{\n    const char *name = fuse_mbuf_iter_advance_str(iter);\n    if (!name) {\n        fuse_reply_err(req, EINVAL);\n        return;\n    }\n\n    if (req->se->op.lookup) {\n        req->se->op.lookup(req, nodeid, name);\n    } else {\n        fuse_reply_err(req, ENOSYS);\n    }\n}"
  },
  {
    "function_name": "fuse_reply_lseek",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "706-714",
    "snippet": "int fuse_reply_lseek(fuse_req_t req, off_t off)\n{\n    struct fuse_lseek_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.offset = off;\n\n    return send_reply_ok(req, &arg, sizeof(arg));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "&arg",
            "sizeof(arg)"
          ],
          "line": 713
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_lseek(fuse_req_t req, off_t off)\n{\n    struct fuse_lseek_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.offset = off;\n\n    return send_reply_ok(req, &arg, sizeof(arg));\n}"
  },
  {
    "function_name": "fuse_reply_poll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "696-704",
    "snippet": "int fuse_reply_poll(fuse_req_t req, unsigned revents)\n{\n    struct fuse_poll_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.revents = revents;\n\n    return send_reply_ok(req, &arg, sizeof(arg));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "&arg",
            "sizeof(arg)"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_poll(fuse_req_t req, unsigned revents)\n{\n    struct fuse_poll_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.revents = revents;\n\n    return send_reply_ok(req, &arg, sizeof(arg));\n}"
  },
  {
    "function_name": "fuse_reply_ioctl_iov",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "671-694",
    "snippet": "int fuse_reply_ioctl_iov(fuse_req_t req, int result, const struct iovec *iov,\n                         int count)\n{\n    struct iovec *padded_iov;\n    struct fuse_ioctl_out arg;\n    int res;\n\n    padded_iov = malloc((count + 2) * sizeof(struct iovec));\n    if (padded_iov == NULL) {\n        return fuse_reply_err(req, ENOMEM);\n    }\n\n    memset(&arg, 0, sizeof(arg));\n    arg.result = result;\n    padded_iov[1].iov_base = &arg;\n    padded_iov[1].iov_len = sizeof(arg);\n\n    memcpy(&padded_iov[2], iov, count * sizeof(struct iovec));\n\n    res = send_reply_iov(req, 0, padded_iov, count + 2);\n    free(padded_iov);\n\n    return res;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "padded_iov"
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_free_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "122-137",
          "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "send_reply_iov",
          "args": [
            "req",
            "0",
            "padded_iov",
            "count + 2"
          ],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "204-212",
          "snippet": "static int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&padded_iov[2]",
            "iov",
            "count * sizeof(struct iovec)"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOMEM"
          ],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "(count + 2) * sizeof(struct iovec)"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_ioctl_iov(fuse_req_t req, int result, const struct iovec *iov,\n                         int count)\n{\n    struct iovec *padded_iov;\n    struct fuse_ioctl_out arg;\n    int res;\n\n    padded_iov = malloc((count + 2) * sizeof(struct iovec));\n    if (padded_iov == NULL) {\n        return fuse_reply_err(req, ENOMEM);\n    }\n\n    memset(&arg, 0, sizeof(arg));\n    arg.result = result;\n    padded_iov[1].iov_base = &arg;\n    padded_iov[1].iov_len = sizeof(arg);\n\n    memcpy(&padded_iov[2], iov, count * sizeof(struct iovec));\n\n    res = send_reply_iov(req, 0, padded_iov, count + 2);\n    free(padded_iov);\n\n    return res;\n}"
  },
  {
    "function_name": "fuse_reply_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "650-669",
    "snippet": "int fuse_reply_ioctl(fuse_req_t req, int result, const void *buf, size_t size)\n{\n    struct fuse_ioctl_out arg;\n    struct iovec iov[3];\n    size_t count = 1;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.result = result;\n    iov[count].iov_base = &arg;\n    iov[count].iov_len = sizeof(arg);\n    count++;\n\n    if (size) {\n        iov[count].iov_base = (char *)buf;\n        iov[count].iov_len = size;\n        count++;\n    }\n\n    return send_reply_iov(req, 0, iov, count);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_iov",
          "args": [
            "req",
            "0",
            "iov",
            "count"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "204-212",
          "snippet": "static int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_ioctl(fuse_req_t req, int result, const void *buf, size_t size)\n{\n    struct fuse_ioctl_out arg;\n    struct iovec iov[3];\n    size_t count = 1;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.result = result;\n    iov[count].iov_base = &arg;\n    iov[count].iov_len = sizeof(arg);\n    count++;\n\n    if (size) {\n        iov[count].iov_base = (char *)buf;\n        iov[count].iov_len = size;\n        count++;\n    }\n\n    return send_reply_iov(req, 0, iov, count);\n}"
  },
  {
    "function_name": "fuse_reply_ioctl_retry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "592-648",
    "snippet": "int fuse_reply_ioctl_retry(fuse_req_t req, const struct iovec *in_iov,\n                           size_t in_count, const struct iovec *out_iov,\n                           size_t out_count)\n{\n    struct fuse_ioctl_out arg;\n    struct fuse_ioctl_iovec *in_fiov = NULL;\n    struct fuse_ioctl_iovec *out_fiov = NULL;\n    struct iovec iov[4];\n    size_t count = 1;\n    int res;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.flags |= FUSE_IOCTL_RETRY;\n    arg.in_iovs = in_count;\n    arg.out_iovs = out_count;\n    iov[count].iov_base = &arg;\n    iov[count].iov_len = sizeof(arg);\n    count++;\n\n    /* Can't handle non-compat 64bit ioctls on 32bit */\n    if (sizeof(void *) == 4 && req->ioctl_64bit) {\n        res = fuse_reply_err(req, EINVAL);\n        goto out;\n    }\n\n    if (in_count) {\n        in_fiov = fuse_ioctl_iovec_copy(in_iov, in_count);\n        if (!in_fiov) {\n            goto enomem;\n        }\n\n        iov[count].iov_base = (void *)in_fiov;\n        iov[count].iov_len = sizeof(in_fiov[0]) * in_count;\n        count++;\n    }\n    if (out_count) {\n        out_fiov = fuse_ioctl_iovec_copy(out_iov, out_count);\n        if (!out_fiov) {\n            goto enomem;\n        }\n\n        iov[count].iov_base = (void *)out_fiov;\n        iov[count].iov_len = sizeof(out_fiov[0]) * out_count;\n        count++;\n    }\n\n    res = send_reply_iov(req, 0, iov, count);\nout:\n    free(in_fiov);\n    free(out_fiov);\n\n    return res;\n\nenomem:\n    res = fuse_reply_err(req, ENOMEM);\n    goto out;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOMEM"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "out_fiov"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_free_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "122-137",
          "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "send_reply_iov",
          "args": [
            "req",
            "0",
            "iov",
            "count"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "204-212",
          "snippet": "static int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_ioctl_iovec_copy",
          "args": [
            "out_iov",
            "out_count"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_ioctl_iovec_copy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "573-590",
          "snippet": "static struct fuse_ioctl_iovec *fuse_ioctl_iovec_copy(const struct iovec *iov,\n                                                      size_t count)\n{\n    struct fuse_ioctl_iovec *fiov;\n    size_t i;\n\n    fiov = malloc(sizeof(fiov[0]) * count);\n    if (!fiov) {\n        return NULL;\n    }\n\n    for (i = 0; i < count; i++) {\n        fiov[i].base = (uintptr_t)iov[i].iov_base;\n        fiov[i].len = iov[i].iov_len;\n    }\n\n    return fiov;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic struct fuse_ioctl_iovec *fuse_ioctl_iovec_copy(const struct iovec *iov,\n                                                      size_t count)\n{\n    struct fuse_ioctl_iovec *fiov;\n    size_t i;\n\n    fiov = malloc(sizeof(fiov[0]) * count);\n    if (!fiov) {\n        return NULL;\n    }\n\n    for (i = 0; i < count; i++) {\n        fiov[i].base = (uintptr_t)iov[i].iov_base;\n        fiov[i].len = iov[i].iov_len;\n    }\n\n    return fiov;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_ioctl_retry(fuse_req_t req, const struct iovec *in_iov,\n                           size_t in_count, const struct iovec *out_iov,\n                           size_t out_count)\n{\n    struct fuse_ioctl_out arg;\n    struct fuse_ioctl_iovec *in_fiov = NULL;\n    struct fuse_ioctl_iovec *out_fiov = NULL;\n    struct iovec iov[4];\n    size_t count = 1;\n    int res;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.flags |= FUSE_IOCTL_RETRY;\n    arg.in_iovs = in_count;\n    arg.out_iovs = out_count;\n    iov[count].iov_base = &arg;\n    iov[count].iov_len = sizeof(arg);\n    count++;\n\n    /* Can't handle non-compat 64bit ioctls on 32bit */\n    if (sizeof(void *) == 4 && req->ioctl_64bit) {\n        res = fuse_reply_err(req, EINVAL);\n        goto out;\n    }\n\n    if (in_count) {\n        in_fiov = fuse_ioctl_iovec_copy(in_iov, in_count);\n        if (!in_fiov) {\n            goto enomem;\n        }\n\n        iov[count].iov_base = (void *)in_fiov;\n        iov[count].iov_len = sizeof(in_fiov[0]) * in_count;\n        count++;\n    }\n    if (out_count) {\n        out_fiov = fuse_ioctl_iovec_copy(out_iov, out_count);\n        if (!out_fiov) {\n            goto enomem;\n        }\n\n        iov[count].iov_base = (void *)out_fiov;\n        iov[count].iov_len = sizeof(out_fiov[0]) * out_count;\n        count++;\n    }\n\n    res = send_reply_iov(req, 0, iov, count);\nout:\n    free(in_fiov);\n    free(out_fiov);\n\n    return res;\n\nenomem:\n    res = fuse_reply_err(req, ENOMEM);\n    goto out;\n}"
  },
  {
    "function_name": "fuse_ioctl_iovec_copy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "573-590",
    "snippet": "static struct fuse_ioctl_iovec *fuse_ioctl_iovec_copy(const struct iovec *iov,\n                                                      size_t count)\n{\n    struct fuse_ioctl_iovec *fiov;\n    size_t i;\n\n    fiov = malloc(sizeof(fiov[0]) * count);\n    if (!fiov) {\n        return NULL;\n    }\n\n    for (i = 0; i < count; i++) {\n        fiov[i].base = (uintptr_t)iov[i].iov_base;\n        fiov[i].len = iov[i].iov_len;\n    }\n\n    return fiov;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(fiov[0]) * count"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic struct fuse_ioctl_iovec *fuse_ioctl_iovec_copy(const struct iovec *iov,\n                                                      size_t count)\n{\n    struct fuse_ioctl_iovec *fiov;\n    size_t i;\n\n    fiov = malloc(sizeof(fiov[0]) * count);\n    if (!fiov) {\n        return NULL;\n    }\n\n    for (i = 0; i < count; i++) {\n        fiov[i].base = (uintptr_t)iov[i].iov_base;\n        fiov[i].len = iov[i].iov_len;\n    }\n\n    return fiov;\n}"
  },
  {
    "function_name": "fuse_reply_bmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "563-571",
    "snippet": "int fuse_reply_bmap(fuse_req_t req, uint64_t idx)\n{\n    struct fuse_bmap_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.block = idx;\n\n    return send_reply_ok(req, &arg, sizeof(arg));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "&arg",
            "sizeof(arg)"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_bmap(fuse_req_t req, uint64_t idx)\n{\n    struct fuse_bmap_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.block = idx;\n\n    return send_reply_ok(req, &arg, sizeof(arg));\n}"
  },
  {
    "function_name": "fuse_reply_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "545-561",
    "snippet": "int fuse_reply_lock(fuse_req_t req, const struct flock *lock)\n{\n    struct fuse_lk_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.lk.type = lock->l_type;\n    if (lock->l_type != F_UNLCK) {\n        arg.lk.start = lock->l_start;\n        if (lock->l_len == 0) {\n            arg.lk.end = OFFSET_MAX;\n        } else {\n            arg.lk.end = lock->l_start + lock->l_len - 1;\n        }\n    }\n    arg.lk.pid = lock->l_pid;\n    return send_reply_ok(req, &arg, sizeof(arg));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [
      "#define OFFSET_MAX 0x7fffffffffffffffLL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "&arg",
            "sizeof(arg)"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\n#define OFFSET_MAX 0x7fffffffffffffffLL\n\nint fuse_reply_lock(fuse_req_t req, const struct flock *lock)\n{\n    struct fuse_lk_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.lk.type = lock->l_type;\n    if (lock->l_type != F_UNLCK) {\n        arg.lk.start = lock->l_start;\n        if (lock->l_len == 0) {\n            arg.lk.end = OFFSET_MAX;\n        } else {\n            arg.lk.end = lock->l_start + lock->l_len - 1;\n        }\n    }\n    arg.lk.pid = lock->l_pid;\n    return send_reply_ok(req, &arg, sizeof(arg));\n}"
  },
  {
    "function_name": "fuse_reply_xattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "535-543",
    "snippet": "int fuse_reply_xattr(fuse_req_t req, size_t count)\n{\n    struct fuse_getxattr_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.size = count;\n\n    return send_reply_ok(req, &arg, sizeof(arg));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "&arg",
            "sizeof(arg)"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_xattr(fuse_req_t req, size_t count)\n{\n    struct fuse_getxattr_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.size = count;\n\n    return send_reply_ok(req, &arg, sizeof(arg));\n}"
  },
  {
    "function_name": "fuse_reply_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "524-533",
    "snippet": "int fuse_reply_statfs(fuse_req_t req, const struct statvfs *stbuf)\n{\n    struct fuse_statfs_out arg;\n    size_t size = sizeof(arg);\n\n    memset(&arg, 0, sizeof(arg));\n    convert_statfs(stbuf, &arg.st);\n\n    return send_reply_ok(req, &arg, size);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "&arg",
            "size"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_statfs",
          "args": [
            "stbuf",
            "&arg.st"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "convert_statfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "279-292",
          "snippet": "static void convert_statfs(const struct statvfs *stbuf,\n                           struct fuse_kstatfs *kstatfs)\n{\n    *kstatfs = (struct fuse_kstatfs){\n        .bsize = stbuf->f_bsize,\n        .frsize = stbuf->f_frsize,\n        .blocks = stbuf->f_blocks,\n        .bfree = stbuf->f_bfree,\n        .bavail = stbuf->f_bavail,\n        .files = stbuf->f_files,\n        .ffree = stbuf->f_ffree,\n        .namelen = stbuf->f_namemax,\n    };\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void convert_statfs(const struct statvfs *stbuf,\n                           struct fuse_kstatfs *kstatfs)\n{\n    *kstatfs = (struct fuse_kstatfs){\n        .bsize = stbuf->f_bsize,\n        .frsize = stbuf->f_frsize,\n        .blocks = stbuf->f_blocks,\n        .bfree = stbuf->f_bfree,\n        .bavail = stbuf->f_bavail,\n        .files = stbuf->f_files,\n        .ffree = stbuf->f_ffree,\n        .namelen = stbuf->f_namemax,\n    };\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_statfs(fuse_req_t req, const struct statvfs *stbuf)\n{\n    struct fuse_statfs_out arg;\n    size_t size = sizeof(arg);\n\n    memset(&arg, 0, sizeof(arg));\n    convert_statfs(stbuf, &arg.st);\n\n    return send_reply_ok(req, &arg, size);\n}"
  },
  {
    "function_name": "fuse_reply_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "504-522",
    "snippet": "int fuse_reply_data(fuse_req_t req, struct fuse_bufvec *bufv)\n{\n    struct iovec iov[2];\n    struct fuse_out_header out = {\n        .unique = req->unique,\n    };\n    int res;\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    res = fuse_send_data_iov(req->se, req->ch, iov, 1, bufv);\n    if (res <= 0) {\n        fuse_free_req(req);\n        return res;\n    } else {\n        return fuse_reply_err(req, res);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "res"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_free_req",
          "args": [
            "req"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_free_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "122-137",
          "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_send_data_iov",
          "args": [
            "req->se",
            "req->ch",
            "iov",
            "1",
            "bufv"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_send_data_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "495-502",
          "snippet": "static int fuse_send_data_iov(struct fuse_session *se, struct fuse_chan *ch,\n                              struct iovec *iov, int iov_count,\n                              struct fuse_bufvec *buf)\n{\n    size_t len = fuse_buf_size(buf);\n\n    return fuse_send_data_iov_fallback(se, ch, iov, iov_count, buf, len);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_send_data_iov(struct fuse_session *se, struct fuse_chan *ch,\n                              struct iovec *iov, int iov_count,\n                              struct fuse_bufvec *buf)\n{\n    size_t len = fuse_buf_size(buf);\n\n    return fuse_send_data_iov_fallback(se, ch, iov, iov_count, buf, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_data(fuse_req_t req, struct fuse_bufvec *bufv)\n{\n    struct iovec iov[2];\n    struct fuse_out_header out = {\n        .unique = req->unique,\n    };\n    int res;\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    res = fuse_send_data_iov(req->se, req->ch, iov, 1, bufv);\n    if (res <= 0) {\n        fuse_free_req(req);\n        return res;\n    } else {\n        return fuse_reply_err(req, res);\n    }\n}"
  },
  {
    "function_name": "fuse_send_data_iov",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "495-502",
    "snippet": "static int fuse_send_data_iov(struct fuse_session *se, struct fuse_chan *ch,\n                              struct iovec *iov, int iov_count,\n                              struct fuse_bufvec *buf)\n{\n    size_t len = fuse_buf_size(buf);\n\n    return fuse_send_data_iov_fallback(se, ch, iov, iov_count, buf, len);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_send_data_iov_fallback",
          "args": [
            "se",
            "ch",
            "iov",
            "iov_count",
            "buf",
            "len"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_send_data_iov_fallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "467-493",
          "snippet": "static int fuse_send_data_iov_fallback(struct fuse_session *se,\n                                       struct fuse_chan *ch, struct iovec *iov,\n                                       int iov_count, struct fuse_bufvec *buf,\n                                       size_t len)\n{\n    /* Optimize common case */\n    if (buf->count == 1 && buf->idx == 0 && buf->off == 0 &&\n        !(buf->buf[0].flags & FUSE_BUF_IS_FD)) {\n        /*\n         * FIXME: also avoid memory copy if there are multiple buffers\n         * but none of them contain an fd\n         */\n\n        iov[iov_count].iov_base = buf->buf[0].mem;\n        iov[iov_count].iov_len = len;\n        iov_count++;\n        return fuse_send_msg(se, ch, iov, iov_count);\n    }\n\n    if (fuse_lowlevel_is_virtio(se) && buf->count == 1 &&\n        buf->buf[0].flags == (FUSE_BUF_IS_FD | FUSE_BUF_FD_SEEK)) {\n        return virtio_send_data_iov(se, ch, iov, iov_count, buf, len);\n    }\n\n    abort(); /* Will have taken vhost path */\n    return 0;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_send_data_iov_fallback(struct fuse_session *se,\n                                       struct fuse_chan *ch, struct iovec *iov,\n                                       int iov_count, struct fuse_bufvec *buf,\n                                       size_t len)\n{\n    /* Optimize common case */\n    if (buf->count == 1 && buf->idx == 0 && buf->off == 0 &&\n        !(buf->buf[0].flags & FUSE_BUF_IS_FD)) {\n        /*\n         * FIXME: also avoid memory copy if there are multiple buffers\n         * but none of them contain an fd\n         */\n\n        iov[iov_count].iov_base = buf->buf[0].mem;\n        iov[iov_count].iov_len = len;\n        iov_count++;\n        return fuse_send_msg(se, ch, iov, iov_count);\n    }\n\n    if (fuse_lowlevel_is_virtio(se) && buf->count == 1 &&\n        buf->buf[0].flags == (FUSE_BUF_IS_FD | FUSE_BUF_FD_SEEK)) {\n        return virtio_send_data_iov(se, ch, iov, iov_count, buf, len);\n    }\n\n    abort(); /* Will have taken vhost path */\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_buf_size",
          "args": [
            "buf"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_buf_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/buffer.c",
          "lines": "21-35",
          "snippet": "size_t fuse_buf_size(const struct fuse_bufvec *bufv)\n{\n    size_t i;\n    size_t size = 0;\n\n    for (i = 0; i < bufv->count; i++) {\n        if (bufv->buf[i].size == SIZE_MAX) {\n            size = SIZE_MAX;\n        } else {\n            size += bufv->buf[i].size;\n        }\n    }\n\n    return size;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_lowlevel.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_lowlevel.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nsize_t fuse_buf_size(const struct fuse_bufvec *bufv)\n{\n    size_t i;\n    size_t size = 0;\n\n    for (i = 0; i < bufv->count; i++) {\n        if (bufv->buf[i].size == SIZE_MAX) {\n            size = SIZE_MAX;\n        } else {\n            size += bufv->buf[i].size;\n        }\n    }\n\n    return size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_send_data_iov(struct fuse_session *se, struct fuse_chan *ch,\n                              struct iovec *iov, int iov_count,\n                              struct fuse_bufvec *buf)\n{\n    size_t len = fuse_buf_size(buf);\n\n    return fuse_send_data_iov_fallback(se, ch, iov, iov_count, buf, len);\n}"
  },
  {
    "function_name": "fuse_send_data_iov_fallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "467-493",
    "snippet": "static int fuse_send_data_iov_fallback(struct fuse_session *se,\n                                       struct fuse_chan *ch, struct iovec *iov,\n                                       int iov_count, struct fuse_bufvec *buf,\n                                       size_t len)\n{\n    /* Optimize common case */\n    if (buf->count == 1 && buf->idx == 0 && buf->off == 0 &&\n        !(buf->buf[0].flags & FUSE_BUF_IS_FD)) {\n        /*\n         * FIXME: also avoid memory copy if there are multiple buffers\n         * but none of them contain an fd\n         */\n\n        iov[iov_count].iov_base = buf->buf[0].mem;\n        iov[iov_count].iov_len = len;\n        iov_count++;\n        return fuse_send_msg(se, ch, iov, iov_count);\n    }\n\n    if (fuse_lowlevel_is_virtio(se) && buf->count == 1 &&\n        buf->buf[0].flags == (FUSE_BUF_IS_FD | FUSE_BUF_FD_SEEK)) {\n        return virtio_send_data_iov(se, ch, iov, iov_count, buf, len);\n    }\n\n    abort(); /* Will have taken vhost path */\n    return 0;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virtio_send_data_iov",
          "args": [
            "se",
            "ch",
            "iov",
            "iov_count",
            "buf",
            "len"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "virtio_send_data_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_virtio.c",
          "lines": "272-429",
          "snippet": "int virtio_send_data_iov(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count, struct fuse_bufvec *buf,\n                         size_t len)\n{\n    FVRequest *req = container_of(ch, FVRequest, ch);\n    struct fv_QueueInfo *qi = ch->qi;\n    VuDev *dev = &se->virtio_dev->dev;\n    VuVirtq *q = vu_get_queue(dev, qi->qidx);\n    VuVirtqElement *elem = &req->elem;\n    int ret = 0;\n\n    assert(count >= 1);\n    assert(iov[0].iov_len >= sizeof(struct fuse_out_header));\n\n    struct fuse_out_header *out = iov[0].iov_base;\n    /* TODO: Endianness! */\n\n    size_t iov_len = iov_size(iov, count);\n    size_t tosend_len = iov_len + len;\n\n    out->len = tosend_len;\n\n    fuse_log(FUSE_LOG_DEBUG, \"%s: count=%d len=%zd iov_len=%zd\\n\", __func__,\n             count, len, iov_len);\n\n    /* unique == 0 is notification which we don't support */\n    assert(out->unique);\n\n    assert(!req->reply_sent);\n\n    /* The 'in' part of the elem is to qemu */\n    unsigned int in_num = elem->in_num;\n    struct iovec *in_sg = elem->in_sg;\n    size_t in_len = iov_size(in_sg, in_num);\n    fuse_log(FUSE_LOG_DEBUG, \"%s: elem %d: with %d in desc of length %zd\\n\",\n             __func__, elem->index, in_num, in_len);\n\n    /*\n     * The elem should have room for a 'fuse_out_header' (out from fuse)\n     * plus the data based on the len in the header.\n     */\n    if (in_len < sizeof(struct fuse_out_header)) {\n        fuse_log(FUSE_LOG_ERR, \"%s: elem %d too short for out_header\\n\",\n                 __func__, elem->index);\n        ret = E2BIG;\n        goto err;\n    }\n    if (in_len < tosend_len) {\n        fuse_log(FUSE_LOG_ERR, \"%s: elem %d too small for data len %zd\\n\",\n                 __func__, elem->index, tosend_len);\n        ret = E2BIG;\n        goto err;\n    }\n\n    /* TODO: Limit to 'len' */\n\n    /* First copy the header data from iov->in_sg */\n    copy_iov(iov, count, in_sg, in_num, iov_len);\n\n    /*\n     * Build a copy of the the in_sg iov so we can skip bits in it,\n     * including changing the offsets\n     */\n    struct iovec *in_sg_cpy = calloc(sizeof(struct iovec), in_num);\n    assert(in_sg_cpy);\n    memcpy(in_sg_cpy, in_sg, sizeof(struct iovec) * in_num);\n    /* These get updated as we skip */\n    struct iovec *in_sg_ptr = in_sg_cpy;\n    int in_sg_cpy_count = in_num;\n\n    /* skip over parts of in_sg that contained the header iov */\n    size_t skip_size = iov_len;\n\n    size_t in_sg_left = 0;\n    do {\n        while (skip_size != 0 && in_sg_cpy_count) {\n            if (skip_size >= in_sg_ptr[0].iov_len) {\n                skip_size -= in_sg_ptr[0].iov_len;\n                in_sg_ptr++;\n                in_sg_cpy_count--;\n            } else {\n                in_sg_ptr[0].iov_len -= skip_size;\n                in_sg_ptr[0].iov_base += skip_size;\n                break;\n            }\n        }\n\n        int i;\n        for (i = 0, in_sg_left = 0; i < in_sg_cpy_count; i++) {\n            in_sg_left += in_sg_ptr[i].iov_len;\n        }\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"%s: after skip skip_size=%zd in_sg_cpy_count=%d \"\n                 \"in_sg_left=%zd\\n\",\n                 __func__, skip_size, in_sg_cpy_count, in_sg_left);\n        ret = preadv(buf->buf[0].fd, in_sg_ptr, in_sg_cpy_count,\n                     buf->buf[0].pos);\n\n        if (ret == -1) {\n            ret = errno;\n            fuse_log(FUSE_LOG_DEBUG, \"%s: preadv failed (%m) len=%zd\\n\",\n                     __func__, len);\n            free(in_sg_cpy);\n            goto err;\n        }\n        fuse_log(FUSE_LOG_DEBUG, \"%s: preadv ret=%d len=%zd\\n\", __func__,\n                 ret, len);\n        if (ret < len && ret) {\n            fuse_log(FUSE_LOG_DEBUG, \"%s: ret < len\\n\", __func__);\n            /* Skip over this much next time around */\n            skip_size = ret;\n            buf->buf[0].pos += ret;\n            len -= ret;\n\n            /* Lets do another read */\n            continue;\n        }\n        if (!ret) {\n            /* EOF case? */\n            fuse_log(FUSE_LOG_DEBUG, \"%s: !ret in_sg_left=%zd\\n\", __func__,\n                     in_sg_left);\n            break;\n        }\n        if (ret != len) {\n            fuse_log(FUSE_LOG_DEBUG, \"%s: ret!=len\\n\", __func__);\n            ret = EIO;\n            free(in_sg_cpy);\n            goto err;\n        }\n        in_sg_left -= ret;\n        len -= ret;\n    } while (in_sg_left);\n    free(in_sg_cpy);\n\n    /* Need to fix out->len on EOF */\n    if (len) {\n        struct fuse_out_header *out_sg = in_sg[0].iov_base;\n\n        tosend_len -= len;\n        out_sg->len = tosend_len;\n    }\n\n    ret = 0;\n\n    pthread_rwlock_rdlock(&qi->virtio_dev->vu_dispatch_rwlock);\n    pthread_mutex_lock(&qi->vq_lock);\n    vu_queue_push(dev, q, elem, tosend_len);\n    vu_queue_notify(dev, q);\n    pthread_mutex_unlock(&qi->vq_lock);\n    pthread_rwlock_unlock(&qi->virtio_dev->vu_dispatch_rwlock);\n\nerr:\n    if (ret == 0) {\n        req->reply_sent = true;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"contrib/libvhost-user/libvhost-user.h\"",
            "#include <unistd.h>",
            "#include <grp.h>",
            "#include <sys/types.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/socket.h>",
            "#include <sys/eventfd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qapi/error.h\"",
            "#include \"qemu/iov.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"contrib/libvhost-user/libvhost-user.h\"\n#include <unistd.h>\n#include <grp.h>\n#include <sys/types.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <sys/eventfd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qapi/error.h\"\n#include \"qemu/iov.h\"\n#include \"qemu/osdep.h\"\n\nint virtio_send_data_iov(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count, struct fuse_bufvec *buf,\n                         size_t len)\n{\n    FVRequest *req = container_of(ch, FVRequest, ch);\n    struct fv_QueueInfo *qi = ch->qi;\n    VuDev *dev = &se->virtio_dev->dev;\n    VuVirtq *q = vu_get_queue(dev, qi->qidx);\n    VuVirtqElement *elem = &req->elem;\n    int ret = 0;\n\n    assert(count >= 1);\n    assert(iov[0].iov_len >= sizeof(struct fuse_out_header));\n\n    struct fuse_out_header *out = iov[0].iov_base;\n    /* TODO: Endianness! */\n\n    size_t iov_len = iov_size(iov, count);\n    size_t tosend_len = iov_len + len;\n\n    out->len = tosend_len;\n\n    fuse_log(FUSE_LOG_DEBUG, \"%s: count=%d len=%zd iov_len=%zd\\n\", __func__,\n             count, len, iov_len);\n\n    /* unique == 0 is notification which we don't support */\n    assert(out->unique);\n\n    assert(!req->reply_sent);\n\n    /* The 'in' part of the elem is to qemu */\n    unsigned int in_num = elem->in_num;\n    struct iovec *in_sg = elem->in_sg;\n    size_t in_len = iov_size(in_sg, in_num);\n    fuse_log(FUSE_LOG_DEBUG, \"%s: elem %d: with %d in desc of length %zd\\n\",\n             __func__, elem->index, in_num, in_len);\n\n    /*\n     * The elem should have room for a 'fuse_out_header' (out from fuse)\n     * plus the data based on the len in the header.\n     */\n    if (in_len < sizeof(struct fuse_out_header)) {\n        fuse_log(FUSE_LOG_ERR, \"%s: elem %d too short for out_header\\n\",\n                 __func__, elem->index);\n        ret = E2BIG;\n        goto err;\n    }\n    if (in_len < tosend_len) {\n        fuse_log(FUSE_LOG_ERR, \"%s: elem %d too small for data len %zd\\n\",\n                 __func__, elem->index, tosend_len);\n        ret = E2BIG;\n        goto err;\n    }\n\n    /* TODO: Limit to 'len' */\n\n    /* First copy the header data from iov->in_sg */\n    copy_iov(iov, count, in_sg, in_num, iov_len);\n\n    /*\n     * Build a copy of the the in_sg iov so we can skip bits in it,\n     * including changing the offsets\n     */\n    struct iovec *in_sg_cpy = calloc(sizeof(struct iovec), in_num);\n    assert(in_sg_cpy);\n    memcpy(in_sg_cpy, in_sg, sizeof(struct iovec) * in_num);\n    /* These get updated as we skip */\n    struct iovec *in_sg_ptr = in_sg_cpy;\n    int in_sg_cpy_count = in_num;\n\n    /* skip over parts of in_sg that contained the header iov */\n    size_t skip_size = iov_len;\n\n    size_t in_sg_left = 0;\n    do {\n        while (skip_size != 0 && in_sg_cpy_count) {\n            if (skip_size >= in_sg_ptr[0].iov_len) {\n                skip_size -= in_sg_ptr[0].iov_len;\n                in_sg_ptr++;\n                in_sg_cpy_count--;\n            } else {\n                in_sg_ptr[0].iov_len -= skip_size;\n                in_sg_ptr[0].iov_base += skip_size;\n                break;\n            }\n        }\n\n        int i;\n        for (i = 0, in_sg_left = 0; i < in_sg_cpy_count; i++) {\n            in_sg_left += in_sg_ptr[i].iov_len;\n        }\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"%s: after skip skip_size=%zd in_sg_cpy_count=%d \"\n                 \"in_sg_left=%zd\\n\",\n                 __func__, skip_size, in_sg_cpy_count, in_sg_left);\n        ret = preadv(buf->buf[0].fd, in_sg_ptr, in_sg_cpy_count,\n                     buf->buf[0].pos);\n\n        if (ret == -1) {\n            ret = errno;\n            fuse_log(FUSE_LOG_DEBUG, \"%s: preadv failed (%m) len=%zd\\n\",\n                     __func__, len);\n            free(in_sg_cpy);\n            goto err;\n        }\n        fuse_log(FUSE_LOG_DEBUG, \"%s: preadv ret=%d len=%zd\\n\", __func__,\n                 ret, len);\n        if (ret < len && ret) {\n            fuse_log(FUSE_LOG_DEBUG, \"%s: ret < len\\n\", __func__);\n            /* Skip over this much next time around */\n            skip_size = ret;\n            buf->buf[0].pos += ret;\n            len -= ret;\n\n            /* Lets do another read */\n            continue;\n        }\n        if (!ret) {\n            /* EOF case? */\n            fuse_log(FUSE_LOG_DEBUG, \"%s: !ret in_sg_left=%zd\\n\", __func__,\n                     in_sg_left);\n            break;\n        }\n        if (ret != len) {\n            fuse_log(FUSE_LOG_DEBUG, \"%s: ret!=len\\n\", __func__);\n            ret = EIO;\n            free(in_sg_cpy);\n            goto err;\n        }\n        in_sg_left -= ret;\n        len -= ret;\n    } while (in_sg_left);\n    free(in_sg_cpy);\n\n    /* Need to fix out->len on EOF */\n    if (len) {\n        struct fuse_out_header *out_sg = in_sg[0].iov_base;\n\n        tosend_len -= len;\n        out_sg->len = tosend_len;\n    }\n\n    ret = 0;\n\n    pthread_rwlock_rdlock(&qi->virtio_dev->vu_dispatch_rwlock);\n    pthread_mutex_lock(&qi->vq_lock);\n    vu_queue_push(dev, q, elem, tosend_len);\n    vu_queue_notify(dev, q);\n    pthread_mutex_unlock(&qi->vq_lock);\n    pthread_rwlock_unlock(&qi->virtio_dev->vu_dispatch_rwlock);\n\nerr:\n    if (ret == 0) {\n        req->reply_sent = true;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_lowlevel_is_virtio",
          "args": [
            "se"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_lowlevel_is_virtio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "2675-2678",
          "snippet": "int fuse_lowlevel_is_virtio(struct fuse_session *se)\n{\n    return !!se->virtio_dev;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_lowlevel_is_virtio(struct fuse_session *se)\n{\n    return !!se->virtio_dev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_send_msg",
          "args": [
            "se",
            "ch",
            "iov",
            "iov_count"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_send_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "157-182",
          "snippet": "static int fuse_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count)\n{\n    struct fuse_out_header *out = iov[0].iov_base;\n\n    out->len = iov_length(iov, count);\n    if (out->unique == 0) {\n        fuse_log(FUSE_LOG_DEBUG, \"NOTIFY: code=%d length=%u\\n\", out->error,\n                 out->len);\n    } else if (out->error) {\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"   unique: %llu, error: %i (%s), outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->error,\n                 strerror(-out->error), out->len);\n    } else {\n        fuse_log(FUSE_LOG_DEBUG, \"   unique: %llu, success, outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->len);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        return virtio_send_msg(se, ch, iov, count);\n    }\n\n    abort(); /* virtio should have taken it before here */\n    return 0;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count)\n{\n    struct fuse_out_header *out = iov[0].iov_base;\n\n    out->len = iov_length(iov, count);\n    if (out->unique == 0) {\n        fuse_log(FUSE_LOG_DEBUG, \"NOTIFY: code=%d length=%u\\n\", out->error,\n                 out->len);\n    } else if (out->error) {\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"   unique: %llu, error: %i (%s), outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->error,\n                 strerror(-out->error), out->len);\n    } else {\n        fuse_log(FUSE_LOG_DEBUG, \"   unique: %llu, success, outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->len);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        return virtio_send_msg(se, ch, iov, count);\n    }\n\n    abort(); /* virtio should have taken it before here */\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_send_data_iov_fallback(struct fuse_session *se,\n                                       struct fuse_chan *ch, struct iovec *iov,\n                                       int iov_count, struct fuse_bufvec *buf,\n                                       size_t len)\n{\n    /* Optimize common case */\n    if (buf->count == 1 && buf->idx == 0 && buf->off == 0 &&\n        !(buf->buf[0].flags & FUSE_BUF_IS_FD)) {\n        /*\n         * FIXME: also avoid memory copy if there are multiple buffers\n         * but none of them contain an fd\n         */\n\n        iov[iov_count].iov_base = buf->buf[0].mem;\n        iov[iov_count].iov_len = len;\n        iov_count++;\n        return fuse_send_msg(se, ch, iov, iov_count);\n    }\n\n    if (fuse_lowlevel_is_virtio(se) && buf->count == 1 &&\n        buf->buf[0].flags == (FUSE_BUF_IS_FD | FUSE_BUF_FD_SEEK)) {\n        return virtio_send_data_iov(se, ch, iov, iov_count, buf, len);\n    }\n\n    abort(); /* Will have taken vhost path */\n    return 0;\n}"
  },
  {
    "function_name": "fuse_reply_buf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "462-465",
    "snippet": "int fuse_reply_buf(fuse_req_t req, const char *buf, size_t size)\n{\n    return send_reply_ok(req, buf, size);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "buf",
            "size"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_buf(fuse_req_t req, const char *buf, size_t size)\n{\n    return send_reply_ok(req, buf, size);\n}"
  },
  {
    "function_name": "fuse_reply_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "452-460",
    "snippet": "int fuse_reply_write(fuse_req_t req, size_t count)\n{\n    struct fuse_write_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.size = count;\n\n    return send_reply_ok(req, &arg, sizeof(arg));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "&arg",
            "sizeof(arg)"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_write(fuse_req_t req, size_t count)\n{\n    struct fuse_write_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    arg.size = count;\n\n    return send_reply_ok(req, &arg, sizeof(arg));\n}"
  },
  {
    "function_name": "fuse_reply_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "443-450",
    "snippet": "int fuse_reply_open(fuse_req_t req, const struct fuse_file_info *f)\n{\n    struct fuse_open_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    fill_open(&arg, f);\n    return send_reply_ok(req, &arg, sizeof(arg));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "&arg",
            "sizeof(arg)"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fill_open",
          "args": [
            "&arg",
            "f"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "fill_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "383-398",
          "snippet": "static void fill_open(struct fuse_open_out *arg, const struct fuse_file_info *f)\n{\n    arg->fh = f->fh;\n    if (f->direct_io) {\n        arg->open_flags |= FOPEN_DIRECT_IO;\n    }\n    if (f->keep_cache) {\n        arg->open_flags |= FOPEN_KEEP_CACHE;\n    }\n    if (f->cache_readdir) {\n        arg->open_flags |= FOPEN_CACHE_DIR;\n    }\n    if (f->nonseekable) {\n        arg->open_flags |= FOPEN_NONSEEKABLE;\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void fill_open(struct fuse_open_out *arg, const struct fuse_file_info *f)\n{\n    arg->fh = f->fh;\n    if (f->direct_io) {\n        arg->open_flags |= FOPEN_DIRECT_IO;\n    }\n    if (f->keep_cache) {\n        arg->open_flags |= FOPEN_KEEP_CACHE;\n    }\n    if (f->cache_readdir) {\n        arg->open_flags |= FOPEN_CACHE_DIR;\n    }\n    if (f->nonseekable) {\n        arg->open_flags |= FOPEN_NONSEEKABLE;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_open(fuse_req_t req, const struct fuse_file_info *f)\n{\n    struct fuse_open_out arg;\n\n    memset(&arg, 0, sizeof(arg));\n    fill_open(&arg, f);\n    return send_reply_ok(req, &arg, sizeof(arg));\n}"
  },
  {
    "function_name": "fuse_reply_readlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "438-441",
    "snippet": "int fuse_reply_readlink(fuse_req_t req, const char *linkname)\n{\n    return send_reply_ok(req, linkname, strlen(linkname));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "linkname",
            "strlen(linkname)"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "linkname"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_readlink(fuse_req_t req, const char *linkname)\n{\n    return send_reply_ok(req, linkname, strlen(linkname));\n}"
  },
  {
    "function_name": "fuse_reply_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "424-436",
    "snippet": "int fuse_reply_attr(fuse_req_t req, const struct stat *attr,\n                    double attr_timeout)\n{\n    struct fuse_attr_out arg;\n    size_t size = sizeof(arg);\n\n    memset(&arg, 0, sizeof(arg));\n    arg.attr_valid = calc_timeout_sec(attr_timeout);\n    arg.attr_valid_nsec = calc_timeout_nsec(attr_timeout);\n    convert_stat(attr, &arg.attr);\n\n    return send_reply_ok(req, &arg, size);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "&arg",
            "size"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_stat",
          "args": [
            "attr",
            "&arg.attr"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "convert_statfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "279-292",
          "snippet": "static void convert_statfs(const struct statvfs *stbuf,\n                           struct fuse_kstatfs *kstatfs)\n{\n    *kstatfs = (struct fuse_kstatfs){\n        .bsize = stbuf->f_bsize,\n        .frsize = stbuf->f_frsize,\n        .blocks = stbuf->f_blocks,\n        .bfree = stbuf->f_bfree,\n        .bavail = stbuf->f_bavail,\n        .files = stbuf->f_files,\n        .ffree = stbuf->f_ffree,\n        .namelen = stbuf->f_namemax,\n    };\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void convert_statfs(const struct statvfs *stbuf,\n                           struct fuse_kstatfs *kstatfs)\n{\n    *kstatfs = (struct fuse_kstatfs){\n        .bsize = stbuf->f_bsize,\n        .frsize = stbuf->f_frsize,\n        .blocks = stbuf->f_blocks,\n        .bfree = stbuf->f_bfree,\n        .bavail = stbuf->f_bavail,\n        .files = stbuf->f_files,\n        .ffree = stbuf->f_ffree,\n        .namelen = stbuf->f_namemax,\n    };\n}"
        }
      },
      {
        "call_info": {
          "callee": "calc_timeout_nsec",
          "args": [
            "attr_timeout"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "calc_timeout_nsec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "320-330",
          "snippet": "static unsigned int calc_timeout_nsec(double t)\n{\n    double f = t - (double)calc_timeout_sec(t);\n    if (f < 0.0) {\n        return 0;\n    } else if (f >= 0.999999999) {\n        return 999999999;\n    } else {\n        return (unsigned int)(f * 1.0e9);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic unsigned int calc_timeout_nsec(double t)\n{\n    double f = t - (double)calc_timeout_sec(t);\n    if (f < 0.0) {\n        return 0;\n    } else if (f >= 0.999999999) {\n        return 999999999;\n    } else {\n        return (unsigned int)(f * 1.0e9);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "calc_timeout_sec",
          "args": [
            "attr_timeout"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "calc_timeout_sec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "309-318",
          "snippet": "static unsigned long calc_timeout_sec(double t)\n{\n    if (t > (double)ULONG_MAX) {\n        return ULONG_MAX;\n    } else if (t < 0.0) {\n        return 0;\n    } else {\n        return (unsigned long)t;\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic unsigned long calc_timeout_sec(double t)\n{\n    if (t > (double)ULONG_MAX) {\n        return ULONG_MAX;\n    } else if (t < 0.0) {\n        return 0;\n    } else {\n        return (unsigned long)t;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_attr(fuse_req_t req, const struct stat *attr,\n                    double attr_timeout)\n{\n    struct fuse_attr_out arg;\n    size_t size = sizeof(arg);\n\n    memset(&arg, 0, sizeof(arg));\n    arg.attr_valid = calc_timeout_sec(attr_timeout);\n    arg.attr_valid_nsec = calc_timeout_nsec(attr_timeout);\n    convert_stat(attr, &arg.attr);\n\n    return send_reply_ok(req, &arg, size);\n}"
  },
  {
    "function_name": "fuse_reply_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "410-422",
    "snippet": "int fuse_reply_create(fuse_req_t req, const struct fuse_entry_param *e,\n                      const struct fuse_file_info *f)\n{\n    char buf[sizeof(struct fuse_entry_out) + sizeof(struct fuse_open_out)];\n    size_t entrysize = sizeof(struct fuse_entry_out);\n    struct fuse_entry_out *earg = (struct fuse_entry_out *)buf;\n    struct fuse_open_out *oarg = (struct fuse_open_out *)(buf + entrysize);\n\n    memset(buf, 0, sizeof(buf));\n    fill_entry(earg, e);\n    fill_open(oarg, f);\n    return send_reply_ok(req, buf, entrysize + sizeof(struct fuse_open_out));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "buf",
            "entrysize + sizeof(struct fuse_open_out)"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fill_open",
          "args": [
            "oarg",
            "f"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "fill_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "383-398",
          "snippet": "static void fill_open(struct fuse_open_out *arg, const struct fuse_file_info *f)\n{\n    arg->fh = f->fh;\n    if (f->direct_io) {\n        arg->open_flags |= FOPEN_DIRECT_IO;\n    }\n    if (f->keep_cache) {\n        arg->open_flags |= FOPEN_KEEP_CACHE;\n    }\n    if (f->cache_readdir) {\n        arg->open_flags |= FOPEN_CACHE_DIR;\n    }\n    if (f->nonseekable) {\n        arg->open_flags |= FOPEN_NONSEEKABLE;\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void fill_open(struct fuse_open_out *arg, const struct fuse_file_info *f)\n{\n    arg->fh = f->fh;\n    if (f->direct_io) {\n        arg->open_flags |= FOPEN_DIRECT_IO;\n    }\n    if (f->keep_cache) {\n        arg->open_flags |= FOPEN_KEEP_CACHE;\n    }\n    if (f->cache_readdir) {\n        arg->open_flags |= FOPEN_CACHE_DIR;\n    }\n    if (f->nonseekable) {\n        arg->open_flags |= FOPEN_NONSEEKABLE;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fill_entry",
          "args": [
            "earg",
            "e"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "fill_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "332-344",
          "snippet": "static void fill_entry(struct fuse_entry_out *arg,\n                       const struct fuse_entry_param *e)\n{\n    *arg = (struct fuse_entry_out){\n        .nodeid = e->ino,\n        .generation = e->generation,\n        .entry_valid = calc_timeout_sec(e->entry_timeout),\n        .entry_valid_nsec = calc_timeout_nsec(e->entry_timeout),\n        .attr_valid = calc_timeout_sec(e->attr_timeout),\n        .attr_valid_nsec = calc_timeout_nsec(e->attr_timeout),\n    };\n    convert_stat(&e->attr, &arg->attr);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void fill_entry(struct fuse_entry_out *arg,\n                       const struct fuse_entry_param *e)\n{\n    *arg = (struct fuse_entry_out){\n        .nodeid = e->ino,\n        .generation = e->generation,\n        .entry_valid = calc_timeout_sec(e->entry_timeout),\n        .entry_valid_nsec = calc_timeout_nsec(e->entry_timeout),\n        .attr_valid = calc_timeout_sec(e->attr_timeout),\n        .attr_valid_nsec = calc_timeout_nsec(e->attr_timeout),\n    };\n    convert_stat(&e->attr, &arg->attr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buf",
            "0",
            "sizeof(buf)"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_create(fuse_req_t req, const struct fuse_entry_param *e,\n                      const struct fuse_file_info *f)\n{\n    char buf[sizeof(struct fuse_entry_out) + sizeof(struct fuse_open_out)];\n    size_t entrysize = sizeof(struct fuse_entry_out);\n    struct fuse_entry_out *earg = (struct fuse_entry_out *)buf;\n    struct fuse_open_out *oarg = (struct fuse_open_out *)(buf + entrysize);\n\n    memset(buf, 0, sizeof(buf));\n    fill_entry(earg, e);\n    fill_open(oarg, f);\n    return send_reply_ok(req, buf, entrysize + sizeof(struct fuse_open_out));\n}"
  },
  {
    "function_name": "fuse_reply_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "400-408",
    "snippet": "int fuse_reply_entry(fuse_req_t req, const struct fuse_entry_param *e)\n{\n    struct fuse_entry_out arg;\n    size_t size = sizeof(arg);\n\n    memset(&arg, 0, sizeof(arg));\n    fill_entry(&arg, e);\n    return send_reply_ok(req, &arg, size);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_ok",
          "args": [
            "req",
            "&arg",
            "size"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "294-297",
          "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fill_entry",
          "args": [
            "&arg",
            "e"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "fill_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "332-344",
          "snippet": "static void fill_entry(struct fuse_entry_out *arg,\n                       const struct fuse_entry_param *e)\n{\n    *arg = (struct fuse_entry_out){\n        .nodeid = e->ino,\n        .generation = e->generation,\n        .entry_valid = calc_timeout_sec(e->entry_timeout),\n        .entry_valid_nsec = calc_timeout_nsec(e->entry_timeout),\n        .attr_valid = calc_timeout_sec(e->attr_timeout),\n        .attr_valid_nsec = calc_timeout_nsec(e->attr_timeout),\n    };\n    convert_stat(&e->attr, &arg->attr);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void fill_entry(struct fuse_entry_out *arg,\n                       const struct fuse_entry_param *e)\n{\n    *arg = (struct fuse_entry_out){\n        .nodeid = e->ino,\n        .generation = e->generation,\n        .entry_valid = calc_timeout_sec(e->entry_timeout),\n        .entry_valid_nsec = calc_timeout_nsec(e->entry_timeout),\n        .attr_valid = calc_timeout_sec(e->attr_timeout),\n        .attr_valid_nsec = calc_timeout_nsec(e->attr_timeout),\n    };\n    convert_stat(&e->attr, &arg->attr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&arg",
            "0",
            "sizeof(arg)"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_entry(fuse_req_t req, const struct fuse_entry_param *e)\n{\n    struct fuse_entry_out arg;\n    size_t size = sizeof(arg);\n\n    memset(&arg, 0, sizeof(arg));\n    fill_entry(&arg, e);\n    return send_reply_ok(req, &arg, size);\n}"
  },
  {
    "function_name": "fill_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "383-398",
    "snippet": "static void fill_open(struct fuse_open_out *arg, const struct fuse_file_info *f)\n{\n    arg->fh = f->fh;\n    if (f->direct_io) {\n        arg->open_flags |= FOPEN_DIRECT_IO;\n    }\n    if (f->keep_cache) {\n        arg->open_flags |= FOPEN_KEEP_CACHE;\n    }\n    if (f->cache_readdir) {\n        arg->open_flags |= FOPEN_CACHE_DIR;\n    }\n    if (f->nonseekable) {\n        arg->open_flags |= FOPEN_NONSEEKABLE;\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void fill_open(struct fuse_open_out *arg, const struct fuse_file_info *f)\n{\n    arg->fh = f->fh;\n    if (f->direct_io) {\n        arg->open_flags |= FOPEN_DIRECT_IO;\n    }\n    if (f->keep_cache) {\n        arg->open_flags |= FOPEN_KEEP_CACHE;\n    }\n    if (f->cache_readdir) {\n        arg->open_flags |= FOPEN_CACHE_DIR;\n    }\n    if (f->nonseekable) {\n        arg->open_flags |= FOPEN_NONSEEKABLE;\n    }\n}"
  },
  {
    "function_name": "fuse_add_direntry_plus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "350-381",
    "snippet": "size_t fuse_add_direntry_plus(fuse_req_t req, char *buf, size_t bufsize,\n                              const char *name,\n                              const struct fuse_entry_param *e, off_t off)\n{\n    (void)req;\n    size_t namelen;\n    size_t entlen;\n    size_t entlen_padded;\n\n    namelen = strlen(name);\n    entlen = FUSE_NAME_OFFSET_DIRENTPLUS + namelen;\n    entlen_padded = FUSE_DIRENT_ALIGN(entlen);\n    if ((buf == NULL) || (entlen_padded > bufsize)) {\n        return entlen_padded;\n    }\n\n    struct fuse_direntplus *dp = (struct fuse_direntplus *)buf;\n    memset(&dp->entry_out, 0, sizeof(dp->entry_out));\n    fill_entry(&dp->entry_out, e);\n\n    struct fuse_dirent *dirent = &dp->dirent;\n    *dirent = (struct fuse_dirent){\n        .ino = e->attr.st_ino,\n        .off = off,\n        .namelen = namelen,\n        .type = (e->attr.st_mode & S_IFMT) >> 12,\n    };\n    memcpy(dirent->name, name, namelen);\n    memset(dirent->name + namelen, 0, entlen_padded - entlen);\n\n    return entlen_padded;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "dirent->name + namelen",
            "0",
            "entlen_padded - entlen"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dirent->name",
            "name",
            "namelen"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fill_entry",
          "args": [
            "&dp->entry_out",
            "e"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "fill_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "332-344",
          "snippet": "static void fill_entry(struct fuse_entry_out *arg,\n                       const struct fuse_entry_param *e)\n{\n    *arg = (struct fuse_entry_out){\n        .nodeid = e->ino,\n        .generation = e->generation,\n        .entry_valid = calc_timeout_sec(e->entry_timeout),\n        .entry_valid_nsec = calc_timeout_nsec(e->entry_timeout),\n        .attr_valid = calc_timeout_sec(e->attr_timeout),\n        .attr_valid_nsec = calc_timeout_nsec(e->attr_timeout),\n    };\n    convert_stat(&e->attr, &arg->attr);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void fill_entry(struct fuse_entry_out *arg,\n                       const struct fuse_entry_param *e)\n{\n    *arg = (struct fuse_entry_out){\n        .nodeid = e->ino,\n        .generation = e->generation,\n        .entry_valid = calc_timeout_sec(e->entry_timeout),\n        .entry_valid_nsec = calc_timeout_nsec(e->entry_timeout),\n        .attr_valid = calc_timeout_sec(e->attr_timeout),\n        .attr_valid_nsec = calc_timeout_nsec(e->attr_timeout),\n    };\n    convert_stat(&e->attr, &arg->attr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&dp->entry_out",
            "0",
            "sizeof(dp->entry_out)"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FUSE_DIRENT_ALIGN",
          "args": [
            "entlen"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nsize_t fuse_add_direntry_plus(fuse_req_t req, char *buf, size_t bufsize,\n                              const char *name,\n                              const struct fuse_entry_param *e, off_t off)\n{\n    (void)req;\n    size_t namelen;\n    size_t entlen;\n    size_t entlen_padded;\n\n    namelen = strlen(name);\n    entlen = FUSE_NAME_OFFSET_DIRENTPLUS + namelen;\n    entlen_padded = FUSE_DIRENT_ALIGN(entlen);\n    if ((buf == NULL) || (entlen_padded > bufsize)) {\n        return entlen_padded;\n    }\n\n    struct fuse_direntplus *dp = (struct fuse_direntplus *)buf;\n    memset(&dp->entry_out, 0, sizeof(dp->entry_out));\n    fill_entry(&dp->entry_out, e);\n\n    struct fuse_dirent *dirent = &dp->dirent;\n    *dirent = (struct fuse_dirent){\n        .ino = e->attr.st_ino,\n        .off = off,\n        .namelen = namelen,\n        .type = (e->attr.st_mode & S_IFMT) >> 12,\n    };\n    memcpy(dirent->name, name, namelen);\n    memset(dirent->name + namelen, 0, entlen_padded - entlen);\n\n    return entlen_padded;\n}"
  },
  {
    "function_name": "fill_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "332-344",
    "snippet": "static void fill_entry(struct fuse_entry_out *arg,\n                       const struct fuse_entry_param *e)\n{\n    *arg = (struct fuse_entry_out){\n        .nodeid = e->ino,\n        .generation = e->generation,\n        .entry_valid = calc_timeout_sec(e->entry_timeout),\n        .entry_valid_nsec = calc_timeout_nsec(e->entry_timeout),\n        .attr_valid = calc_timeout_sec(e->attr_timeout),\n        .attr_valid_nsec = calc_timeout_nsec(e->attr_timeout),\n    };\n    convert_stat(&e->attr, &arg->attr);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_stat",
          "args": [
            "&e->attr",
            "&arg->attr"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "convert_statfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "279-292",
          "snippet": "static void convert_statfs(const struct statvfs *stbuf,\n                           struct fuse_kstatfs *kstatfs)\n{\n    *kstatfs = (struct fuse_kstatfs){\n        .bsize = stbuf->f_bsize,\n        .frsize = stbuf->f_frsize,\n        .blocks = stbuf->f_blocks,\n        .bfree = stbuf->f_bfree,\n        .bavail = stbuf->f_bavail,\n        .files = stbuf->f_files,\n        .ffree = stbuf->f_ffree,\n        .namelen = stbuf->f_namemax,\n    };\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void convert_statfs(const struct statvfs *stbuf,\n                           struct fuse_kstatfs *kstatfs)\n{\n    *kstatfs = (struct fuse_kstatfs){\n        .bsize = stbuf->f_bsize,\n        .frsize = stbuf->f_frsize,\n        .blocks = stbuf->f_blocks,\n        .bfree = stbuf->f_bfree,\n        .bavail = stbuf->f_bavail,\n        .files = stbuf->f_files,\n        .ffree = stbuf->f_ffree,\n        .namelen = stbuf->f_namemax,\n    };\n}"
        }
      },
      {
        "call_info": {
          "callee": "calc_timeout_nsec",
          "args": [
            "e->attr_timeout"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "calc_timeout_nsec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "320-330",
          "snippet": "static unsigned int calc_timeout_nsec(double t)\n{\n    double f = t - (double)calc_timeout_sec(t);\n    if (f < 0.0) {\n        return 0;\n    } else if (f >= 0.999999999) {\n        return 999999999;\n    } else {\n        return (unsigned int)(f * 1.0e9);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic unsigned int calc_timeout_nsec(double t)\n{\n    double f = t - (double)calc_timeout_sec(t);\n    if (f < 0.0) {\n        return 0;\n    } else if (f >= 0.999999999) {\n        return 999999999;\n    } else {\n        return (unsigned int)(f * 1.0e9);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "calc_timeout_sec",
          "args": [
            "e->attr_timeout"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "calc_timeout_sec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "309-318",
          "snippet": "static unsigned long calc_timeout_sec(double t)\n{\n    if (t > (double)ULONG_MAX) {\n        return ULONG_MAX;\n    } else if (t < 0.0) {\n        return 0;\n    } else {\n        return (unsigned long)t;\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic unsigned long calc_timeout_sec(double t)\n{\n    if (t > (double)ULONG_MAX) {\n        return ULONG_MAX;\n    } else if (t < 0.0) {\n        return 0;\n    } else {\n        return (unsigned long)t;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void fill_entry(struct fuse_entry_out *arg,\n                       const struct fuse_entry_param *e)\n{\n    *arg = (struct fuse_entry_out){\n        .nodeid = e->ino,\n        .generation = e->generation,\n        .entry_valid = calc_timeout_sec(e->entry_timeout),\n        .entry_valid_nsec = calc_timeout_nsec(e->entry_timeout),\n        .attr_valid = calc_timeout_sec(e->attr_timeout),\n        .attr_valid_nsec = calc_timeout_nsec(e->attr_timeout),\n    };\n    convert_stat(&e->attr, &arg->attr);\n}"
  },
  {
    "function_name": "calc_timeout_nsec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "320-330",
    "snippet": "static unsigned int calc_timeout_nsec(double t)\n{\n    double f = t - (double)calc_timeout_sec(t);\n    if (f < 0.0) {\n        return 0;\n    } else if (f >= 0.999999999) {\n        return 999999999;\n    } else {\n        return (unsigned int)(f * 1.0e9);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "calc_timeout_sec",
          "args": [
            "t"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "calc_timeout_sec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "309-318",
          "snippet": "static unsigned long calc_timeout_sec(double t)\n{\n    if (t > (double)ULONG_MAX) {\n        return ULONG_MAX;\n    } else if (t < 0.0) {\n        return 0;\n    } else {\n        return (unsigned long)t;\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic unsigned long calc_timeout_sec(double t)\n{\n    if (t > (double)ULONG_MAX) {\n        return ULONG_MAX;\n    } else if (t < 0.0) {\n        return 0;\n    } else {\n        return (unsigned long)t;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic unsigned int calc_timeout_nsec(double t)\n{\n    double f = t - (double)calc_timeout_sec(t);\n    if (f < 0.0) {\n        return 0;\n    } else if (f >= 0.999999999) {\n        return 999999999;\n    } else {\n        return (unsigned int)(f * 1.0e9);\n    }\n}"
  },
  {
    "function_name": "calc_timeout_sec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "309-318",
    "snippet": "static unsigned long calc_timeout_sec(double t)\n{\n    if (t > (double)ULONG_MAX) {\n        return ULONG_MAX;\n    } else if (t < 0.0) {\n        return 0;\n    } else {\n        return (unsigned long)t;\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic unsigned long calc_timeout_sec(double t)\n{\n    if (t > (double)ULONG_MAX) {\n        return ULONG_MAX;\n    } else if (t < 0.0) {\n        return 0;\n    } else {\n        return (unsigned long)t;\n    }\n}"
  },
  {
    "function_name": "fuse_reply_none",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "304-307",
    "snippet": "void fuse_reply_none(fuse_req_t req)\n{\n    fuse_free_req(req);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_free_req",
          "args": [
            "req"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_free_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "122-137",
          "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_reply_none(fuse_req_t req)\n{\n    fuse_free_req(req);\n}"
  },
  {
    "function_name": "fuse_reply_err",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "299-302",
    "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply",
          "args": [
            "req",
            "-err",
            "NULL",
            "0"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "214-225",
          "snippet": "static int send_reply(fuse_req_t req, int error, const void *arg,\n                      size_t argsize)\n{\n    struct iovec iov[2];\n    int count = 1;\n    if (argsize) {\n        iov[1].iov_base = (void *)arg;\n        iov[1].iov_len = argsize;\n        count++;\n    }\n    return send_reply_iov(req, error, iov, count);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply(fuse_req_t req, int error, const void *arg,\n                      size_t argsize)\n{\n    struct iovec iov[2];\n    int count = 1;\n    if (argsize) {\n        iov[1].iov_base = (void *)arg;\n        iov[1].iov_len = argsize;\n        count++;\n    }\n    return send_reply_iov(req, error, iov, count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
  },
  {
    "function_name": "send_reply_ok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "294-297",
    "snippet": "static int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply",
          "args": [
            "req",
            "0",
            "arg",
            "argsize"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "214-225",
          "snippet": "static int send_reply(fuse_req_t req, int error, const void *arg,\n                      size_t argsize)\n{\n    struct iovec iov[2];\n    int count = 1;\n    if (argsize) {\n        iov[1].iov_base = (void *)arg;\n        iov[1].iov_len = argsize;\n        count++;\n    }\n    return send_reply_iov(req, error, iov, count);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply(fuse_req_t req, int error, const void *arg,\n                      size_t argsize)\n{\n    struct iovec iov[2];\n    int count = 1;\n    if (argsize) {\n        iov[1].iov_base = (void *)arg;\n        iov[1].iov_len = argsize;\n        count++;\n    }\n    return send_reply_iov(req, error, iov, count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_ok(fuse_req_t req, const void *arg, size_t argsize)\n{\n    return send_reply(req, 0, arg, argsize);\n}"
  },
  {
    "function_name": "convert_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "279-292",
    "snippet": "static void convert_statfs(const struct statvfs *stbuf,\n                           struct fuse_kstatfs *kstatfs)\n{\n    *kstatfs = (struct fuse_kstatfs){\n        .bsize = stbuf->f_bsize,\n        .frsize = stbuf->f_frsize,\n        .blocks = stbuf->f_blocks,\n        .bfree = stbuf->f_bfree,\n        .bavail = stbuf->f_bavail,\n        .files = stbuf->f_files,\n        .ffree = stbuf->f_ffree,\n        .namelen = stbuf->f_namemax,\n    };\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void convert_statfs(const struct statvfs *stbuf,\n                           struct fuse_kstatfs *kstatfs)\n{\n    *kstatfs = (struct fuse_kstatfs){\n        .bsize = stbuf->f_bsize,\n        .frsize = stbuf->f_frsize,\n        .blocks = stbuf->f_blocks,\n        .bfree = stbuf->f_bfree,\n        .bavail = stbuf->f_bavail,\n        .files = stbuf->f_files,\n        .ffree = stbuf->f_ffree,\n        .namelen = stbuf->f_namemax,\n    };\n}"
  },
  {
    "function_name": "fuse_add_direntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "251-277",
    "snippet": "size_t fuse_add_direntry(fuse_req_t req, char *buf, size_t bufsize,\n                         const char *name, const struct stat *stbuf, off_t off)\n{\n    (void)req;\n    size_t namelen;\n    size_t entlen;\n    size_t entlen_padded;\n    struct fuse_dirent *dirent;\n\n    namelen = strlen(name);\n    entlen = FUSE_NAME_OFFSET + namelen;\n    entlen_padded = FUSE_DIRENT_ALIGN(entlen);\n\n    if ((buf == NULL) || (entlen_padded > bufsize)) {\n        return entlen_padded;\n    }\n\n    dirent = (struct fuse_dirent *)buf;\n    dirent->ino = stbuf->st_ino;\n    dirent->off = off;\n    dirent->namelen = namelen;\n    dirent->type = (stbuf->st_mode & S_IFMT) >> 12;\n    memcpy(dirent->name, name, namelen);\n    memset(dirent->name + namelen, 0, entlen_padded - entlen);\n\n    return entlen_padded;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "dirent->name + namelen",
            "0",
            "entlen_padded - entlen"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dirent->name",
            "name",
            "namelen"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FUSE_DIRENT_ALIGN",
          "args": [
            "entlen"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nsize_t fuse_add_direntry(fuse_req_t req, char *buf, size_t bufsize,\n                         const char *name, const struct stat *stbuf, off_t off)\n{\n    (void)req;\n    size_t namelen;\n    size_t entlen;\n    size_t entlen_padded;\n    struct fuse_dirent *dirent;\n\n    namelen = strlen(name);\n    entlen = FUSE_NAME_OFFSET + namelen;\n    entlen_padded = FUSE_DIRENT_ALIGN(entlen);\n\n    if ((buf == NULL) || (entlen_padded > bufsize)) {\n        return entlen_padded;\n    }\n\n    dirent = (struct fuse_dirent *)buf;\n    dirent->ino = stbuf->st_ino;\n    dirent->off = off;\n    dirent->namelen = namelen;\n    dirent->type = (stbuf->st_mode & S_IFMT) >> 12;\n    memcpy(dirent->name, name, namelen);\n    memset(dirent->name + namelen, 0, entlen_padded - entlen);\n\n    return entlen_padded;\n}"
  },
  {
    "function_name": "fuse_reply_iov",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "227-244",
    "snippet": "int fuse_reply_iov(fuse_req_t req, const struct iovec *iov, int count)\n{\n    int res;\n    struct iovec *padded_iov;\n\n    padded_iov = malloc((count + 1) * sizeof(struct iovec));\n    if (padded_iov == NULL) {\n        return fuse_reply_err(req, ENOMEM);\n    }\n\n    memcpy(padded_iov + 1, iov, count * sizeof(struct iovec));\n    count++;\n\n    res = send_reply_iov(req, 0, padded_iov, count);\n    free(padded_iov);\n\n    return res;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "padded_iov"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_free_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "122-137",
          "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "send_reply_iov",
          "args": [
            "req",
            "0",
            "padded_iov",
            "count"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "204-212",
          "snippet": "static int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "padded_iov + 1",
            "iov",
            "count * sizeof(struct iovec)"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_reply_err",
          "args": [
            "req",
            "ENOMEM"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_reply_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "299-302",
          "snippet": "int fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_err(fuse_req_t req, int err)\n{\n    return send_reply(req, -err, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "(count + 1) * sizeof(struct iovec)"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_reply_iov(fuse_req_t req, const struct iovec *iov, int count)\n{\n    int res;\n    struct iovec *padded_iov;\n\n    padded_iov = malloc((count + 1) * sizeof(struct iovec));\n    if (padded_iov == NULL) {\n        return fuse_reply_err(req, ENOMEM);\n    }\n\n    memcpy(padded_iov + 1, iov, count * sizeof(struct iovec));\n    count++;\n\n    res = send_reply_iov(req, 0, padded_iov, count);\n    free(padded_iov);\n\n    return res;\n}"
  },
  {
    "function_name": "send_reply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "214-225",
    "snippet": "static int send_reply(fuse_req_t req, int error, const void *arg,\n                      size_t argsize)\n{\n    struct iovec iov[2];\n    int count = 1;\n    if (argsize) {\n        iov[1].iov_base = (void *)arg;\n        iov[1].iov_len = argsize;\n        count++;\n    }\n    return send_reply_iov(req, error, iov, count);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "send_reply_iov",
          "args": [
            "req",
            "error",
            "iov",
            "count"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "send_reply_iov",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "204-212",
          "snippet": "static int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply(fuse_req_t req, int error, const void *arg,\n                      size_t argsize)\n{\n    struct iovec iov[2];\n    int count = 1;\n    if (argsize) {\n        iov[1].iov_base = (void *)arg;\n        iov[1].iov_len = argsize;\n        count++;\n    }\n    return send_reply_iov(req, error, iov, count);\n}"
  },
  {
    "function_name": "send_reply_iov",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "204-212",
    "snippet": "static int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_free_req",
          "args": [
            "req"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_free_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "122-137",
          "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_send_reply_iov_nofree",
          "args": [
            "req",
            "error",
            "iov",
            "count"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_send_reply_iov_nofree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "185-202",
          "snippet": "int fuse_send_reply_iov_nofree(fuse_req_t req, int error, struct iovec *iov,\n                               int count)\n{\n    struct fuse_out_header out = {\n        .unique = req->unique,\n        .error = error,\n    };\n\n    if (error <= -1000 || error > 0) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: bad error value: %i\\n\", error);\n        out.error = -ERANGE;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(req->se, req->ch, iov, count);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_send_reply_iov_nofree(fuse_req_t req, int error, struct iovec *iov,\n                               int count)\n{\n    struct fuse_out_header out = {\n        .unique = req->unique,\n        .error = error,\n    };\n\n    if (error <= -1000 || error > 0) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: bad error value: %i\\n\", error);\n        out.error = -ERANGE;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(req->se, req->ch, iov, count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int send_reply_iov(fuse_req_t req, int error, struct iovec *iov,\n                          int count)\n{\n    int res;\n\n    res = fuse_send_reply_iov_nofree(req, error, iov, count);\n    fuse_free_req(req);\n    return res;\n}"
  },
  {
    "function_name": "fuse_send_reply_iov_nofree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "185-202",
    "snippet": "int fuse_send_reply_iov_nofree(fuse_req_t req, int error, struct iovec *iov,\n                               int count)\n{\n    struct fuse_out_header out = {\n        .unique = req->unique,\n        .error = error,\n    };\n\n    if (error <= -1000 || error > 0) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: bad error value: %i\\n\", error);\n        out.error = -ERANGE;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(req->se, req->ch, iov, count);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_send_msg",
          "args": [
            "req->se",
            "req->ch",
            "iov",
            "count"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_send_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "157-182",
          "snippet": "static int fuse_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count)\n{\n    struct fuse_out_header *out = iov[0].iov_base;\n\n    out->len = iov_length(iov, count);\n    if (out->unique == 0) {\n        fuse_log(FUSE_LOG_DEBUG, \"NOTIFY: code=%d length=%u\\n\", out->error,\n                 out->len);\n    } else if (out->error) {\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"   unique: %llu, error: %i (%s), outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->error,\n                 strerror(-out->error), out->len);\n    } else {\n        fuse_log(FUSE_LOG_DEBUG, \"   unique: %llu, success, outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->len);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        return virtio_send_msg(se, ch, iov, count);\n    }\n\n    abort(); /* virtio should have taken it before here */\n    return 0;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count)\n{\n    struct fuse_out_header *out = iov[0].iov_base;\n\n    out->len = iov_length(iov, count);\n    if (out->unique == 0) {\n        fuse_log(FUSE_LOG_DEBUG, \"NOTIFY: code=%d length=%u\\n\", out->error,\n                 out->len);\n    } else if (out->error) {\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"   unique: %llu, error: %i (%s), outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->error,\n                 strerror(-out->error), out->len);\n    } else {\n        fuse_log(FUSE_LOG_DEBUG, \"   unique: %llu, success, outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->len);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        return virtio_send_msg(se, ch, iov, count);\n    }\n\n    abort(); /* virtio should have taken it before here */\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_ERR",
            "\"fuse: bad error value: %i\\n\"",
            "error"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_send_reply_iov_nofree(fuse_req_t req, int error, struct iovec *iov,\n                               int count)\n{\n    struct fuse_out_header out = {\n        .unique = req->unique,\n        .error = error,\n    };\n\n    if (error <= -1000 || error > 0) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: bad error value: %i\\n\", error);\n        out.error = -ERANGE;\n    }\n\n    iov[0].iov_base = &out;\n    iov[0].iov_len = sizeof(struct fuse_out_header);\n\n    return fuse_send_msg(req->se, req->ch, iov, count);\n}"
  },
  {
    "function_name": "fuse_send_msg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "157-182",
    "snippet": "static int fuse_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count)\n{\n    struct fuse_out_header *out = iov[0].iov_base;\n\n    out->len = iov_length(iov, count);\n    if (out->unique == 0) {\n        fuse_log(FUSE_LOG_DEBUG, \"NOTIFY: code=%d length=%u\\n\", out->error,\n                 out->len);\n    } else if (out->error) {\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"   unique: %llu, error: %i (%s), outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->error,\n                 strerror(-out->error), out->len);\n    } else {\n        fuse_log(FUSE_LOG_DEBUG, \"   unique: %llu, success, outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->len);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        return virtio_send_msg(se, ch, iov, count);\n    }\n\n    abort(); /* virtio should have taken it before here */\n    return 0;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virtio_send_msg",
          "args": [
            "se",
            "ch",
            "iov",
            "count"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "virtio_send_msg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_virtio.c",
          "lines": "205-264",
          "snippet": "int virtio_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                    struct iovec *iov, int count)\n{\n    FVRequest *req = container_of(ch, FVRequest, ch);\n    struct fv_QueueInfo *qi = ch->qi;\n    VuDev *dev = &se->virtio_dev->dev;\n    VuVirtq *q = vu_get_queue(dev, qi->qidx);\n    VuVirtqElement *elem = &req->elem;\n    int ret = 0;\n\n    assert(count >= 1);\n    assert(iov[0].iov_len >= sizeof(struct fuse_out_header));\n\n    struct fuse_out_header *out = iov[0].iov_base;\n    /* TODO: Endianness! */\n\n    size_t tosend_len = iov_size(iov, count);\n\n    /* unique == 0 is notification, which we don't support */\n    assert(out->unique);\n    assert(!req->reply_sent);\n\n    /* The 'in' part of the elem is to qemu */\n    unsigned int in_num = elem->in_num;\n    struct iovec *in_sg = elem->in_sg;\n    size_t in_len = iov_size(in_sg, in_num);\n    fuse_log(FUSE_LOG_DEBUG, \"%s: elem %d: with %d in desc of length %zd\\n\",\n             __func__, elem->index, in_num, in_len);\n\n    /*\n     * The elem should have room for a 'fuse_out_header' (out from fuse)\n     * plus the data based on the len in the header.\n     */\n    if (in_len < sizeof(struct fuse_out_header)) {\n        fuse_log(FUSE_LOG_ERR, \"%s: elem %d too short for out_header\\n\",\n                 __func__, elem->index);\n        ret = -E2BIG;\n        goto err;\n    }\n    if (in_len < tosend_len) {\n        fuse_log(FUSE_LOG_ERR, \"%s: elem %d too small for data len %zd\\n\",\n                 __func__, elem->index, tosend_len);\n        ret = -E2BIG;\n        goto err;\n    }\n\n    copy_iov(iov, count, in_sg, in_num, tosend_len);\n\n    pthread_rwlock_rdlock(&qi->virtio_dev->vu_dispatch_rwlock);\n    pthread_mutex_lock(&qi->vq_lock);\n    vu_queue_push(dev, q, elem, tosend_len);\n    vu_queue_notify(dev, q);\n    pthread_mutex_unlock(&qi->vq_lock);\n    pthread_rwlock_unlock(&qi->virtio_dev->vu_dispatch_rwlock);\n\n    req->reply_sent = true;\n\nerr:\n    return ret;\n}",
          "includes": [
            "#include \"contrib/libvhost-user/libvhost-user.h\"",
            "#include <unistd.h>",
            "#include <grp.h>",
            "#include <sys/types.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include <sys/socket.h>",
            "#include <sys/eventfd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qapi/error.h\"",
            "#include \"qemu/iov.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"contrib/libvhost-user/libvhost-user.h\"\n#include <unistd.h>\n#include <grp.h>\n#include <sys/types.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <sys/eventfd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qapi/error.h\"\n#include \"qemu/iov.h\"\n#include \"qemu/osdep.h\"\n\nint virtio_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                    struct iovec *iov, int count)\n{\n    FVRequest *req = container_of(ch, FVRequest, ch);\n    struct fv_QueueInfo *qi = ch->qi;\n    VuDev *dev = &se->virtio_dev->dev;\n    VuVirtq *q = vu_get_queue(dev, qi->qidx);\n    VuVirtqElement *elem = &req->elem;\n    int ret = 0;\n\n    assert(count >= 1);\n    assert(iov[0].iov_len >= sizeof(struct fuse_out_header));\n\n    struct fuse_out_header *out = iov[0].iov_base;\n    /* TODO: Endianness! */\n\n    size_t tosend_len = iov_size(iov, count);\n\n    /* unique == 0 is notification, which we don't support */\n    assert(out->unique);\n    assert(!req->reply_sent);\n\n    /* The 'in' part of the elem is to qemu */\n    unsigned int in_num = elem->in_num;\n    struct iovec *in_sg = elem->in_sg;\n    size_t in_len = iov_size(in_sg, in_num);\n    fuse_log(FUSE_LOG_DEBUG, \"%s: elem %d: with %d in desc of length %zd\\n\",\n             __func__, elem->index, in_num, in_len);\n\n    /*\n     * The elem should have room for a 'fuse_out_header' (out from fuse)\n     * plus the data based on the len in the header.\n     */\n    if (in_len < sizeof(struct fuse_out_header)) {\n        fuse_log(FUSE_LOG_ERR, \"%s: elem %d too short for out_header\\n\",\n                 __func__, elem->index);\n        ret = -E2BIG;\n        goto err;\n    }\n    if (in_len < tosend_len) {\n        fuse_log(FUSE_LOG_ERR, \"%s: elem %d too small for data len %zd\\n\",\n                 __func__, elem->index, tosend_len);\n        ret = -E2BIG;\n        goto err;\n    }\n\n    copy_iov(iov, count, in_sg, in_num, tosend_len);\n\n    pthread_rwlock_rdlock(&qi->virtio_dev->vu_dispatch_rwlock);\n    pthread_mutex_lock(&qi->vq_lock);\n    vu_queue_push(dev, q, elem, tosend_len);\n    vu_queue_notify(dev, q);\n    pthread_mutex_unlock(&qi->vq_lock);\n    pthread_rwlock_unlock(&qi->virtio_dev->vu_dispatch_rwlock);\n\n    req->reply_sent = true;\n\nerr:\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_lowlevel_is_virtio",
          "args": [
            "se"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_lowlevel_is_virtio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "2675-2678",
          "snippet": "int fuse_lowlevel_is_virtio(struct fuse_session *se)\n{\n    return !!se->virtio_dev;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_lowlevel_is_virtio(struct fuse_session *se)\n{\n    return !!se->virtio_dev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_DEBUG",
            "\"   unique: %llu, success, outsize: %i\\n\"",
            "(unsigned long long)out->unique",
            "out->len"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "-out->error"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iov_length",
          "args": [
            "iov",
            "count"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "iov_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "82-91",
          "snippet": "static size_t iov_length(const struct iovec *iov, size_t count)\n{\n    size_t seg;\n    size_t ret = 0;\n\n    for (seg = 0; seg < count; seg++) {\n        ret += iov[seg].iov_len;\n    }\n    return ret;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic size_t iov_length(const struct iovec *iov, size_t count)\n{\n    size_t seg;\n    size_t ret = 0;\n\n    for (seg = 0; seg < count; seg++) {\n        ret += iov[seg].iov_len;\n    }\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_send_msg(struct fuse_session *se, struct fuse_chan *ch,\n                         struct iovec *iov, int count)\n{\n    struct fuse_out_header *out = iov[0].iov_base;\n\n    out->len = iov_length(iov, count);\n    if (out->unique == 0) {\n        fuse_log(FUSE_LOG_DEBUG, \"NOTIFY: code=%d length=%u\\n\", out->error,\n                 out->len);\n    } else if (out->error) {\n        fuse_log(FUSE_LOG_DEBUG,\n                 \"   unique: %llu, error: %i (%s), outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->error,\n                 strerror(-out->error), out->len);\n    } else {\n        fuse_log(FUSE_LOG_DEBUG, \"   unique: %llu, success, outsize: %i\\n\",\n                 (unsigned long long)out->unique, out->len);\n    }\n\n    if (fuse_lowlevel_is_virtio(se)) {\n        return virtio_send_msg(se, ch, iov, count);\n    }\n\n    abort(); /* virtio should have taken it before here */\n    return 0;\n}"
  },
  {
    "function_name": "fuse_ll_alloc_req",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "139-154",
    "snippet": "static struct fuse_req *fuse_ll_alloc_req(struct fuse_session *se)\n{\n    struct fuse_req *req;\n\n    req = (struct fuse_req *)calloc(1, sizeof(struct fuse_req));\n    if (req == NULL) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: failed to allocate request\\n\");\n    } else {\n        req->se = se;\n        req->ctr = 1;\n        list_init_req(req);\n        fuse_mutex_init(&req->lock);\n    }\n\n    return req;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_mutex_init",
          "args": [
            "&req->lock"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_misc.h",
          "lines": "27-34",
          "snippet": "static inline void fuse_mutex_init(pthread_mutex_t *mut)\n{\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_ADAPTIVE_NP);\n    pthread_mutex_init(mut, &attr);\n    pthread_mutexattr_destroy(&attr);\n}",
          "includes": [
            "#include \"config-host.h\"",
            "#include <pthread.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config-host.h\"\n#include <pthread.h>\n\nstatic inline void fuse_mutex_init(pthread_mutex_t *mut)\n{\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_ADAPTIVE_NP);\n    pthread_mutex_init(mut, &attr);\n    pthread_mutexattr_destroy(&attr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_init_req",
          "args": [
            "req"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "list_init_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "93-97",
          "snippet": "static void list_init_req(struct fuse_req *req)\n{\n    req->next = req;\n    req->prev = req;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void list_init_req(struct fuse_req *req)\n{\n    req->next = req;\n    req->prev = req;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_ERR",
            "\"fuse: failed to allocate request\\n\""
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "1",
            "sizeof(struct fuse_req)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic struct fuse_req *fuse_ll_alloc_req(struct fuse_session *se)\n{\n    struct fuse_req *req;\n\n    req = (struct fuse_req *)calloc(1, sizeof(struct fuse_req));\n    if (req == NULL) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: failed to allocate request\\n\");\n    } else {\n        req->se = se;\n        req->ctr = 1;\n        list_init_req(req);\n        fuse_mutex_init(&req->lock);\n    }\n\n    return req;\n}"
  },
  {
    "function_name": "fuse_free_req",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "122-137",
    "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "destroy_req",
          "args": [
            "req"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "destroy_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "116-120",
          "snippet": "static void destroy_req(fuse_req_t req)\n{\n    pthread_mutex_destroy(&req->lock);\n    free(req);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void destroy_req(fuse_req_t req)\n{\n    pthread_mutex_destroy(&req->lock);\n    free(req);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&se->lock"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_req",
          "args": [
            "req"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "list_del_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "99-105",
          "snippet": "static void list_del_req(struct fuse_req *req)\n{\n    struct fuse_req *prev = req->prev;\n    struct fuse_req *next = req->next;\n    prev->next = next;\n    next->prev = prev;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void list_del_req(struct fuse_req *req)\n{\n    struct fuse_req *prev = req->prev;\n    struct fuse_req *next = req->next;\n    prev->next = next;\n    next->prev = prev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&se->lock"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
  },
  {
    "function_name": "destroy_req",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "116-120",
    "snippet": "static void destroy_req(fuse_req_t req)\n{\n    pthread_mutex_destroy(&req->lock);\n    free(req);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "req"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_free_req",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
          "lines": "122-137",
          "snippet": "void fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <sys/file.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <stdbool.h>",
            "#include <limits.h>",
            "#include <glib.h>",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"fuse_virtio.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"fuse_misc.h\"",
            "#include \"standard-headers/linux/fuse.h\"",
            "#include \"fuse_i.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_free_req(fuse_req_t req)\n{\n    int ctr;\n    struct fuse_session *se = req->se;\n\n    pthread_mutex_lock(&se->lock);\n    req->u.ni.func = NULL;\n    req->u.ni.data = NULL;\n    list_del_req(req);\n    ctr = --req->ctr;\n    req->ch = NULL;\n    pthread_mutex_unlock(&se->lock);\n    if (!ctr) {\n        destroy_req(req);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_mutex_destroy",
          "args": [
            "&req->lock"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void destroy_req(fuse_req_t req)\n{\n    pthread_mutex_destroy(&req->lock);\n    free(req);\n}"
  },
  {
    "function_name": "list_add_req",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "107-114",
    "snippet": "static void list_add_req(struct fuse_req *req, struct fuse_req *next)\n{\n    struct fuse_req *prev = next->prev;\n    req->next = next;\n    req->prev = prev;\n    prev->next = req;\n    next->prev = req;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void list_add_req(struct fuse_req *req, struct fuse_req *next)\n{\n    struct fuse_req *prev = next->prev;\n    req->next = next;\n    req->prev = prev;\n    prev->next = req;\n    next->prev = req;\n}"
  },
  {
    "function_name": "list_del_req",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "99-105",
    "snippet": "static void list_del_req(struct fuse_req *req)\n{\n    struct fuse_req *prev = req->prev;\n    struct fuse_req *next = req->next;\n    prev->next = next;\n    next->prev = prev;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void list_del_req(struct fuse_req *req)\n{\n    struct fuse_req *prev = req->prev;\n    struct fuse_req *next = req->next;\n    prev->next = next;\n    next->prev = prev;\n}"
  },
  {
    "function_name": "list_init_req",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "93-97",
    "snippet": "static void list_init_req(struct fuse_req *req)\n{\n    req->next = req;\n    req->prev = req;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void list_init_req(struct fuse_req *req)\n{\n    req->next = req;\n    req->prev = req;\n}"
  },
  {
    "function_name": "iov_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "82-91",
    "snippet": "static size_t iov_length(const struct iovec *iov, size_t count)\n{\n    size_t seg;\n    size_t ret = 0;\n\n    for (seg = 0; seg < count; seg++) {\n        ret += iov[seg].iov_len;\n    }\n    return ret;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic size_t iov_length(const struct iovec *iov, size_t count)\n{\n    size_t seg;\n    size_t ret = 0;\n\n    for (seg = 0; seg < count; seg++) {\n        ret += iov[seg].iov_len;\n    }\n    return ret;\n}"
  },
  {
    "function_name": "convert_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "68-80",
    "snippet": "static void convert_attr(const struct fuse_setattr_in *attr, struct stat *stbuf)\n{\n    stbuf->st_mode = attr->mode;\n    stbuf->st_uid = attr->uid;\n    stbuf->st_gid = attr->gid;\n    stbuf->st_size = attr->size;\n    stbuf->st_atime = attr->atime;\n    stbuf->st_mtime = attr->mtime;\n    stbuf->st_ctime = attr->ctime;\n    ST_ATIM_NSEC_SET(stbuf, attr->atimensec);\n    ST_MTIM_NSEC_SET(stbuf, attr->mtimensec);\n    ST_CTIM_NSEC_SET(stbuf, attr->ctimensec);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ST_CTIM_NSEC_SET",
          "args": [
            "stbuf",
            "attr->ctimensec"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ST_MTIM_NSEC_SET",
          "args": [
            "stbuf",
            "attr->mtimensec"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ST_ATIM_NSEC_SET",
          "args": [
            "stbuf",
            "attr->atimensec"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void convert_attr(const struct fuse_setattr_in *attr, struct stat *stbuf)\n{\n    stbuf->st_mode = attr->mode;\n    stbuf->st_uid = attr->uid;\n    stbuf->st_gid = attr->gid;\n    stbuf->st_size = attr->size;\n    stbuf->st_atime = attr->atime;\n    stbuf->st_mtime = attr->mtime;\n    stbuf->st_ctime = attr->ctime;\n    ST_ATIM_NSEC_SET(stbuf, attr->atimensec);\n    ST_MTIM_NSEC_SET(stbuf, attr->mtimensec);\n    ST_CTIM_NSEC_SET(stbuf, attr->ctimensec);\n}"
  },
  {
    "function_name": "convert_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "47-66",
    "snippet": "static void convert_stat(const struct stat *stbuf, struct fuse_attr *attr)\n{\n    *attr = (struct fuse_attr){\n        .ino = stbuf->st_ino,\n        .mode = stbuf->st_mode,\n        .nlink = stbuf->st_nlink,\n        .uid = stbuf->st_uid,\n        .gid = stbuf->st_gid,\n        .rdev = stbuf->st_rdev,\n        .size = stbuf->st_size,\n        .blksize = stbuf->st_blksize,\n        .blocks = stbuf->st_blocks,\n        .atime = stbuf->st_atime,\n        .mtime = stbuf->st_mtime,\n        .ctime = stbuf->st_ctime,\n        .atimensec = ST_ATIM_NSEC(stbuf),\n        .mtimensec = ST_MTIM_NSEC(stbuf),\n        .ctimensec = ST_CTIM_NSEC(stbuf),\n    };\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ST_CTIM_NSEC",
          "args": [
            "stbuf"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ST_MTIM_NSEC",
          "args": [
            "stbuf"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ST_ATIM_NSEC",
          "args": [
            "stbuf"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic void convert_stat(const struct stat *stbuf, struct fuse_attr *attr)\n{\n    *attr = (struct fuse_attr){\n        .ino = stbuf->st_ino,\n        .mode = stbuf->st_mode,\n        .nlink = stbuf->st_nlink,\n        .uid = stbuf->st_uid,\n        .gid = stbuf->st_gid,\n        .rdev = stbuf->st_rdev,\n        .size = stbuf->st_size,\n        .blksize = stbuf->st_blksize,\n        .blocks = stbuf->st_blocks,\n        .atime = stbuf->st_atime,\n        .mtime = stbuf->st_mtime,\n        .ctime = stbuf->st_ctime,\n        .atimensec = ST_ATIM_NSEC(stbuf),\n        .mtimensec = ST_MTIM_NSEC(stbuf),\n        .ctimensec = ST_CTIM_NSEC(stbuf),\n    };\n}"
  },
  {
    "function_name": "fuse_ll_init_pagesize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_lowlevel.c",
    "lines": "42-45",
    "snippet": "static __attribute__((constructor)) void fuse_ll_init_pagesize(void)\n{\n    pagesize = getpagesize();\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <sys/file.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <stdbool.h>",
      "#include <limits.h>",
      "#include <glib.h>",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"fuse_virtio.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"fuse_misc.h\"",
      "#include \"standard-headers/linux/fuse.h\"",
      "#include \"fuse_i.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static size_t pagesize;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "getpagesize",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <sys/file.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <stdbool.h>\n#include <limits.h>\n#include <glib.h>\n#include <errno.h>\n#include <assert.h>\n#include \"fuse_virtio.h\"\n#include \"fuse_opt.h\"\n#include \"fuse_misc.h\"\n#include \"standard-headers/linux/fuse.h\"\n#include \"fuse_i.h\"\n#include \"qemu/osdep.h\"\n\nstatic size_t pagesize;\n\nstatic __attribute__((constructor)) void fuse_ll_init_pagesize(void)\n{\n    pagesize = getpagesize();\n}"
  }
]