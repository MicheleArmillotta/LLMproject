[
  {
    "function_name": "fuse_log",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
    "lines": "34-41",
    "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
    "includes": [
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include \"fuse_log.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static fuse_log_func_t log_func = default_log_func;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_func",
          "args": [
            "level",
            "fmt",
            "ap"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "default_log_func",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "17-21",
          "snippet": "static void default_log_func(__attribute__((unused)) enum fuse_log_level level,\n                             const char *fmt, va_list ap)\n{\n    vfprintf(stderr, fmt, ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic void default_log_func(__attribute__((unused)) enum fuse_log_level level,\n                             const char *fmt, va_list ap)\n{\n    vfprintf(stderr, fmt, ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "fmt"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
  },
  {
    "function_name": "fuse_set_log_func",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
    "lines": "25-32",
    "snippet": "void fuse_set_log_func(fuse_log_func_t func)\n{\n    if (!func) {\n        func = default_log_func;\n    }\n\n    log_func = func;\n}",
    "includes": [
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include \"fuse_log.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static fuse_log_func_t log_func = default_log_func;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_set_log_func(fuse_log_func_t func)\n{\n    if (!func) {\n        func = default_log_func;\n    }\n\n    log_func = func;\n}"
  },
  {
    "function_name": "default_log_func",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
    "lines": "17-21",
    "snippet": "static void default_log_func(__attribute__((unused)) enum fuse_log_level level,\n                             const char *fmt, va_list ap)\n{\n    vfprintf(stderr, fmt, ap);\n}",
    "includes": [
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include \"fuse_log.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfprintf",
          "args": [
            "stderr",
            "fmt",
            "ap"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic void default_log_func(__attribute__((unused)) enum fuse_log_level level,\n                             const char *fmt, va_list ap)\n{\n    vfprintf(stderr, fmt, ap);\n}"
  }
]