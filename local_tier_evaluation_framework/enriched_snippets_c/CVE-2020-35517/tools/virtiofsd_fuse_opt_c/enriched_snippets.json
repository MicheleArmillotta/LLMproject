[
  {
    "function_name": "fuse_opt_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "424-450",
    "snippet": "int fuse_opt_parse(struct fuse_args *args, void *data,\n                   const struct fuse_opt opts[], fuse_opt_proc_t proc)\n{\n    int res;\n    struct fuse_opt_context ctx = {\n        .data = data,\n        .opt = opts,\n        .proc = proc,\n    };\n\n    if (!args || !args->argv || !args->argc) {\n        return 0;\n    }\n\n    ctx.argc = args->argc;\n    ctx.argv = args->argv;\n\n    res = opt_parse(&ctx);\n    if (res != -1) {\n        struct fuse_args tmp = *args;\n        *args = ctx.outargs;\n        ctx.outargs = tmp;\n    }\n    free(ctx.opts);\n    fuse_opt_free_args(&ctx.outargs);\n    return res;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_opt_free_args",
          "args": [
            "&ctx.outargs"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_free_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "34-48",
          "snippet": "void fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "opt_parse",
          "args": [
            "&ctx"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "opt_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "393-422",
          "snippet": "static int opt_parse(struct fuse_opt_context *ctx)\n{\n    if (ctx->argc) {\n        if (add_arg(ctx, ctx->argv[0]) == -1) {\n            return -1;\n        }\n    }\n\n    for (ctx->argctr = 1; ctx->argctr < ctx->argc; ctx->argctr++) {\n        if (process_one(ctx, ctx->argv[ctx->argctr]) == -1) {\n            return -1;\n        }\n    }\n\n    if (ctx->opts) {\n        if (fuse_opt_insert_arg(&ctx->outargs, 1, \"-o\") == -1 ||\n            fuse_opt_insert_arg(&ctx->outargs, 2, ctx->opts) == -1) {\n            return -1;\n        }\n    }\n\n    /* If option separator (\"--\") is the last argument, remove it */\n    if (ctx->nonopt && ctx->nonopt == ctx->outargs.argc &&\n        strcmp(ctx->outargs.argv[ctx->outargs.argc - 1], \"--\") == 0) {\n        free(ctx->outargs.argv[ctx->outargs.argc - 1]);\n        ctx->outargs.argv[--ctx->outargs.argc] = NULL;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int opt_parse(struct fuse_opt_context *ctx)\n{\n    if (ctx->argc) {\n        if (add_arg(ctx, ctx->argv[0]) == -1) {\n            return -1;\n        }\n    }\n\n    for (ctx->argctr = 1; ctx->argctr < ctx->argc; ctx->argctr++) {\n        if (process_one(ctx, ctx->argv[ctx->argctr]) == -1) {\n            return -1;\n        }\n    }\n\n    if (ctx->opts) {\n        if (fuse_opt_insert_arg(&ctx->outargs, 1, \"-o\") == -1 ||\n            fuse_opt_insert_arg(&ctx->outargs, 2, ctx->opts) == -1) {\n            return -1;\n        }\n    }\n\n    /* If option separator (\"--\") is the last argument, remove it */\n    if (ctx->nonopt && ctx->nonopt == ctx->outargs.argc &&\n        strcmp(ctx->outargs.argv[ctx->outargs.argc - 1], \"--\") == 0) {\n        free(ctx->outargs.argv[ctx->outargs.argc - 1]);\n        ctx->outargs.argv[--ctx->outargs.argc] = NULL;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_opt_parse(struct fuse_args *args, void *data,\n                   const struct fuse_opt opts[], fuse_opt_proc_t proc)\n{\n    int res;\n    struct fuse_opt_context ctx = {\n        .data = data,\n        .opt = opts,\n        .proc = proc,\n    };\n\n    if (!args || !args->argv || !args->argc) {\n        return 0;\n    }\n\n    ctx.argc = args->argc;\n    ctx.argv = args->argv;\n\n    res = opt_parse(&ctx);\n    if (res != -1) {\n        struct fuse_args tmp = *args;\n        *args = ctx.outargs;\n        ctx.outargs = tmp;\n    }\n    free(ctx.opts);\n    fuse_opt_free_args(&ctx.outargs);\n    return res;\n}"
  },
  {
    "function_name": "opt_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "393-422",
    "snippet": "static int opt_parse(struct fuse_opt_context *ctx)\n{\n    if (ctx->argc) {\n        if (add_arg(ctx, ctx->argv[0]) == -1) {\n            return -1;\n        }\n    }\n\n    for (ctx->argctr = 1; ctx->argctr < ctx->argc; ctx->argctr++) {\n        if (process_one(ctx, ctx->argv[ctx->argctr]) == -1) {\n            return -1;\n        }\n    }\n\n    if (ctx->opts) {\n        if (fuse_opt_insert_arg(&ctx->outargs, 1, \"-o\") == -1 ||\n            fuse_opt_insert_arg(&ctx->outargs, 2, ctx->opts) == -1) {\n            return -1;\n        }\n    }\n\n    /* If option separator (\"--\") is the last argument, remove it */\n    if (ctx->nonopt && ctx->nonopt == ctx->outargs.argc &&\n        strcmp(ctx->outargs.argv[ctx->outargs.argc - 1], \"--\") == 0) {\n        free(ctx->outargs.argv[ctx->outargs.argc - 1]);\n        ctx->outargs.argv[--ctx->outargs.argc] = NULL;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ctx->outargs.argv[ctx->outargs.argc - 1]"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_free_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "34-48",
          "snippet": "void fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "ctx->outargs.argv[ctx->outargs.argc - 1]",
            "\"--\""
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_opt_insert_arg",
          "args": [
            "&ctx->outargs",
            "2",
            "ctx->opts"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_insert_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "98-101",
          "snippet": "int fuse_opt_insert_arg(struct fuse_args *args, int pos, const char *arg)\n{\n    return fuse_opt_insert_arg_common(args, pos, arg);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_opt_insert_arg(struct fuse_args *args, int pos, const char *arg)\n{\n    return fuse_opt_insert_arg_common(args, pos, arg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "process_one",
          "args": [
            "ctx",
            "ctx->argv[ctx->argctr]"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "process_one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "368-391",
          "snippet": "static int process_one(struct fuse_opt_context *ctx, const char *arg)\n{\n    if (ctx->nonopt || arg[0] != '-') {\n        return call_proc(ctx, arg, FUSE_OPT_KEY_NONOPT, 0);\n    } else if (arg[1] == 'o') {\n        if (arg[2]) {\n            return process_option_group(ctx, arg + 2);\n        } else {\n            if (next_arg(ctx, arg) == -1) {\n                return -1;\n            }\n\n            return process_option_group(ctx, ctx->argv[ctx->argctr]);\n        }\n    } else if (arg[1] == '-' && !arg[2]) {\n        if (add_arg(ctx, arg) == -1) {\n            return -1;\n        }\n        ctx->nonopt = ctx->outargs.argc;\n        return 0;\n    } else {\n        return process_gopt(ctx, arg, 0);\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_one(struct fuse_opt_context *ctx, const char *arg)\n{\n    if (ctx->nonopt || arg[0] != '-') {\n        return call_proc(ctx, arg, FUSE_OPT_KEY_NONOPT, 0);\n    } else if (arg[1] == 'o') {\n        if (arg[2]) {\n            return process_option_group(ctx, arg + 2);\n        } else {\n            if (next_arg(ctx, arg) == -1) {\n                return -1;\n            }\n\n            return process_option_group(ctx, ctx->argv[ctx->argctr]);\n        }\n    } else if (arg[1] == '-' && !arg[2]) {\n        if (add_arg(ctx, arg) == -1) {\n            return -1;\n        }\n        ctx->nonopt = ctx->outargs.argc;\n        return 0;\n    } else {\n        return process_gopt(ctx, arg, 0);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_arg",
          "args": [
            "ctx",
            "ctx->argv[0]"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "add_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "113-116",
          "snippet": "static int add_arg(struct fuse_opt_context *ctx, const char *arg)\n{\n    return fuse_opt_add_arg(&ctx->outargs, arg);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int add_arg(struct fuse_opt_context *ctx, const char *arg)\n{\n    return fuse_opt_add_arg(&ctx->outargs, arg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int opt_parse(struct fuse_opt_context *ctx)\n{\n    if (ctx->argc) {\n        if (add_arg(ctx, ctx->argv[0]) == -1) {\n            return -1;\n        }\n    }\n\n    for (ctx->argctr = 1; ctx->argctr < ctx->argc; ctx->argctr++) {\n        if (process_one(ctx, ctx->argv[ctx->argctr]) == -1) {\n            return -1;\n        }\n    }\n\n    if (ctx->opts) {\n        if (fuse_opt_insert_arg(&ctx->outargs, 1, \"-o\") == -1 ||\n            fuse_opt_insert_arg(&ctx->outargs, 2, ctx->opts) == -1) {\n            return -1;\n        }\n    }\n\n    /* If option separator (\"--\") is the last argument, remove it */\n    if (ctx->nonopt && ctx->nonopt == ctx->outargs.argc &&\n        strcmp(ctx->outargs.argv[ctx->outargs.argc - 1], \"--\") == 0) {\n        free(ctx->outargs.argv[ctx->outargs.argc - 1]);\n        ctx->outargs.argv[--ctx->outargs.argc] = NULL;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "process_one",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "368-391",
    "snippet": "static int process_one(struct fuse_opt_context *ctx, const char *arg)\n{\n    if (ctx->nonopt || arg[0] != '-') {\n        return call_proc(ctx, arg, FUSE_OPT_KEY_NONOPT, 0);\n    } else if (arg[1] == 'o') {\n        if (arg[2]) {\n            return process_option_group(ctx, arg + 2);\n        } else {\n            if (next_arg(ctx, arg) == -1) {\n                return -1;\n            }\n\n            return process_option_group(ctx, ctx->argv[ctx->argctr]);\n        }\n    } else if (arg[1] == '-' && !arg[2]) {\n        if (add_arg(ctx, arg) == -1) {\n            return -1;\n        }\n        ctx->nonopt = ctx->outargs.argc;\n        return 0;\n    } else {\n        return process_gopt(ctx, arg, 0);\n    }\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "process_gopt",
          "args": [
            "ctx",
            "arg",
            "0"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "process_gopt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "292-312",
          "snippet": "static int process_gopt(struct fuse_opt_context *ctx, const char *arg, int iso)\n{\n    unsigned sep;\n    const struct fuse_opt *opt = find_opt(ctx->opt, arg, &sep);\n    if (opt) {\n        for (; opt; opt = find_opt(opt + 1, arg, &sep)) {\n            int res;\n            if (sep && opt->templ[sep] == ' ' && !arg[sep]) {\n                res = process_opt_sep_arg(ctx, opt, sep, arg, iso);\n            } else {\n                res = process_opt(ctx, opt, sep, arg, iso);\n            }\n            if (res == -1) {\n                return -1;\n            }\n        }\n        return 0;\n    } else {\n        return call_proc(ctx, arg, FUSE_OPT_KEY_OPT, iso);\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_gopt(struct fuse_opt_context *ctx, const char *arg, int iso)\n{\n    unsigned sep;\n    const struct fuse_opt *opt = find_opt(ctx->opt, arg, &sep);\n    if (opt) {\n        for (; opt; opt = find_opt(opt + 1, arg, &sep)) {\n            int res;\n            if (sep && opt->templ[sep] == ' ' && !arg[sep]) {\n                res = process_opt_sep_arg(ctx, opt, sep, arg, iso);\n            } else {\n                res = process_opt(ctx, opt, sep, arg, iso);\n            }\n            if (res == -1) {\n                return -1;\n            }\n        }\n        return 0;\n    } else {\n        return call_proc(ctx, arg, FUSE_OPT_KEY_OPT, iso);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_arg",
          "args": [
            "ctx",
            "arg"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "add_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "113-116",
          "snippet": "static int add_arg(struct fuse_opt_context *ctx, const char *arg)\n{\n    return fuse_opt_add_arg(&ctx->outargs, arg);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int add_arg(struct fuse_opt_context *ctx, const char *arg)\n{\n    return fuse_opt_add_arg(&ctx->outargs, arg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "process_option_group",
          "args": [
            "ctx",
            "ctx->argv[ctx->argctr]"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "process_option_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "354-366",
          "snippet": "static int process_option_group(struct fuse_opt_context *ctx, const char *opts)\n{\n    int res;\n    char *copy = strdup(opts);\n\n    if (!copy) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n        return -1;\n    }\n    res = process_real_option_group(ctx, copy);\n    free(copy);\n    return res;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_option_group(struct fuse_opt_context *ctx, const char *opts)\n{\n    int res;\n    char *copy = strdup(opts);\n\n    if (!copy) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n        return -1;\n    }\n    res = process_real_option_group(ctx, copy);\n    free(copy);\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "next_arg",
          "args": [
            "ctx",
            "arg"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "next_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "103-111",
          "snippet": "static int next_arg(struct fuse_opt_context *ctx, const char *opt)\n{\n    if (ctx->argctr + 1 >= ctx->argc) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: missing argument after `%s'\\n\", opt);\n        return -1;\n    }\n    ctx->argctr++;\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int next_arg(struct fuse_opt_context *ctx, const char *opt)\n{\n    if (ctx->argctr + 1 >= ctx->argc) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: missing argument after `%s'\\n\", opt);\n        return -1;\n    }\n    ctx->argctr++;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_proc",
          "args": [
            "ctx",
            "arg",
            "FUSE_OPT_KEY_NONOPT",
            "0"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "call_proc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "159-177",
          "snippet": "static int call_proc(struct fuse_opt_context *ctx, const char *arg, int key,\n                     int iso)\n{\n    if (key == FUSE_OPT_KEY_DISCARD) {\n        return 0;\n    }\n\n    if (key != FUSE_OPT_KEY_KEEP && ctx->proc) {\n        int res = ctx->proc(ctx->data, arg, key, &ctx->outargs);\n        if (res == -1 || !res) {\n            return res;\n        }\n    }\n    if (iso) {\n        return add_opt(ctx, arg);\n    } else {\n        return add_arg(ctx, arg);\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int call_proc(struct fuse_opt_context *ctx, const char *arg, int key,\n                     int iso)\n{\n    if (key == FUSE_OPT_KEY_DISCARD) {\n        return 0;\n    }\n\n    if (key != FUSE_OPT_KEY_KEEP && ctx->proc) {\n        int res = ctx->proc(ctx->data, arg, key, &ctx->outargs);\n        if (res == -1 || !res) {\n            return res;\n        }\n    }\n    if (iso) {\n        return add_opt(ctx, arg);\n    } else {\n        return add_arg(ctx, arg);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_one(struct fuse_opt_context *ctx, const char *arg)\n{\n    if (ctx->nonopt || arg[0] != '-') {\n        return call_proc(ctx, arg, FUSE_OPT_KEY_NONOPT, 0);\n    } else if (arg[1] == 'o') {\n        if (arg[2]) {\n            return process_option_group(ctx, arg + 2);\n        } else {\n            if (next_arg(ctx, arg) == -1) {\n                return -1;\n            }\n\n            return process_option_group(ctx, ctx->argv[ctx->argctr]);\n        }\n    } else if (arg[1] == '-' && !arg[2]) {\n        if (add_arg(ctx, arg) == -1) {\n            return -1;\n        }\n        ctx->nonopt = ctx->outargs.argc;\n        return 0;\n    } else {\n        return process_gopt(ctx, arg, 0);\n    }\n}"
  },
  {
    "function_name": "process_option_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "354-366",
    "snippet": "static int process_option_group(struct fuse_opt_context *ctx, const char *opts)\n{\n    int res;\n    char *copy = strdup(opts);\n\n    if (!copy) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n        return -1;\n    }\n    res = process_real_option_group(ctx, copy);\n    free(copy);\n    return res;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "copy"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_free_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "34-48",
          "snippet": "void fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "process_real_option_group",
          "args": [
            "ctx",
            "copy"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "process_real_option_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "314-352",
          "snippet": "static int process_real_option_group(struct fuse_opt_context *ctx, char *opts)\n{\n    char *s = opts;\n    char *d = s;\n    int end = 0;\n\n    while (!end) {\n        if (*s == '\\0') {\n            end = 1;\n        }\n        if (*s == ',' || end) {\n            int res;\n\n            *d = '\\0';\n            res = process_gopt(ctx, opts, 1);\n            if (res == -1) {\n                return -1;\n            }\n            d = opts;\n        } else {\n            if (s[0] == '\\\\' && s[1] != '\\0') {\n                s++;\n                if (s[0] >= '0' && s[0] <= '3' && s[1] >= '0' && s[1] <= '7' &&\n                    s[2] >= '0' && s[2] <= '7') {\n                    *d++ = (s[0] - '0') * 0100 + (s[1] - '0') * 0010 +\n                           (s[2] - '0');\n                    s += 2;\n                } else {\n                    *d++ = *s;\n                }\n            } else {\n                *d++ = *s;\n            }\n        }\n        s++;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_real_option_group(struct fuse_opt_context *ctx, char *opts)\n{\n    char *s = opts;\n    char *d = s;\n    int end = 0;\n\n    while (!end) {\n        if (*s == '\\0') {\n            end = 1;\n        }\n        if (*s == ',' || end) {\n            int res;\n\n            *d = '\\0';\n            res = process_gopt(ctx, opts, 1);\n            if (res == -1) {\n                return -1;\n            }\n            d = opts;\n        } else {\n            if (s[0] == '\\\\' && s[1] != '\\0') {\n                s++;\n                if (s[0] >= '0' && s[0] <= '3' && s[1] >= '0' && s[1] <= '7' &&\n                    s[2] >= '0' && s[2] <= '7') {\n                    *d++ = (s[0] - '0') * 0100 + (s[1] - '0') * 0010 +\n                           (s[2] - '0');\n                    s += 2;\n                } else {\n                    *d++ = *s;\n                }\n            } else {\n                *d++ = *s;\n            }\n        }\n        s++;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_ERR",
            "\"fuse: memory allocation failed\\n\""
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "opts"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_option_group(struct fuse_opt_context *ctx, const char *opts)\n{\n    int res;\n    char *copy = strdup(opts);\n\n    if (!copy) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n        return -1;\n    }\n    res = process_real_option_group(ctx, copy);\n    free(copy);\n    return res;\n}"
  },
  {
    "function_name": "process_real_option_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "314-352",
    "snippet": "static int process_real_option_group(struct fuse_opt_context *ctx, char *opts)\n{\n    char *s = opts;\n    char *d = s;\n    int end = 0;\n\n    while (!end) {\n        if (*s == '\\0') {\n            end = 1;\n        }\n        if (*s == ',' || end) {\n            int res;\n\n            *d = '\\0';\n            res = process_gopt(ctx, opts, 1);\n            if (res == -1) {\n                return -1;\n            }\n            d = opts;\n        } else {\n            if (s[0] == '\\\\' && s[1] != '\\0') {\n                s++;\n                if (s[0] >= '0' && s[0] <= '3' && s[1] >= '0' && s[1] <= '7' &&\n                    s[2] >= '0' && s[2] <= '7') {\n                    *d++ = (s[0] - '0') * 0100 + (s[1] - '0') * 0010 +\n                           (s[2] - '0');\n                    s += 2;\n                } else {\n                    *d++ = *s;\n                }\n            } else {\n                *d++ = *s;\n            }\n        }\n        s++;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "process_gopt",
          "args": [
            "ctx",
            "opts",
            "1"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "process_gopt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "292-312",
          "snippet": "static int process_gopt(struct fuse_opt_context *ctx, const char *arg, int iso)\n{\n    unsigned sep;\n    const struct fuse_opt *opt = find_opt(ctx->opt, arg, &sep);\n    if (opt) {\n        for (; opt; opt = find_opt(opt + 1, arg, &sep)) {\n            int res;\n            if (sep && opt->templ[sep] == ' ' && !arg[sep]) {\n                res = process_opt_sep_arg(ctx, opt, sep, arg, iso);\n            } else {\n                res = process_opt(ctx, opt, sep, arg, iso);\n            }\n            if (res == -1) {\n                return -1;\n            }\n        }\n        return 0;\n    } else {\n        return call_proc(ctx, arg, FUSE_OPT_KEY_OPT, iso);\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_gopt(struct fuse_opt_context *ctx, const char *arg, int iso)\n{\n    unsigned sep;\n    const struct fuse_opt *opt = find_opt(ctx->opt, arg, &sep);\n    if (opt) {\n        for (; opt; opt = find_opt(opt + 1, arg, &sep)) {\n            int res;\n            if (sep && opt->templ[sep] == ' ' && !arg[sep]) {\n                res = process_opt_sep_arg(ctx, opt, sep, arg, iso);\n            } else {\n                res = process_opt(ctx, opt, sep, arg, iso);\n            }\n            if (res == -1) {\n                return -1;\n            }\n        }\n        return 0;\n    } else {\n        return call_proc(ctx, arg, FUSE_OPT_KEY_OPT, iso);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_real_option_group(struct fuse_opt_context *ctx, char *opts)\n{\n    char *s = opts;\n    char *d = s;\n    int end = 0;\n\n    while (!end) {\n        if (*s == '\\0') {\n            end = 1;\n        }\n        if (*s == ',' || end) {\n            int res;\n\n            *d = '\\0';\n            res = process_gopt(ctx, opts, 1);\n            if (res == -1) {\n                return -1;\n            }\n            d = opts;\n        } else {\n            if (s[0] == '\\\\' && s[1] != '\\0') {\n                s++;\n                if (s[0] >= '0' && s[0] <= '3' && s[1] >= '0' && s[1] <= '7' &&\n                    s[2] >= '0' && s[2] <= '7') {\n                    *d++ = (s[0] - '0') * 0100 + (s[1] - '0') * 0010 +\n                           (s[2] - '0');\n                    s += 2;\n                } else {\n                    *d++ = *s;\n                }\n            } else {\n                *d++ = *s;\n            }\n        }\n        s++;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "process_gopt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "292-312",
    "snippet": "static int process_gopt(struct fuse_opt_context *ctx, const char *arg, int iso)\n{\n    unsigned sep;\n    const struct fuse_opt *opt = find_opt(ctx->opt, arg, &sep);\n    if (opt) {\n        for (; opt; opt = find_opt(opt + 1, arg, &sep)) {\n            int res;\n            if (sep && opt->templ[sep] == ' ' && !arg[sep]) {\n                res = process_opt_sep_arg(ctx, opt, sep, arg, iso);\n            } else {\n                res = process_opt(ctx, opt, sep, arg, iso);\n            }\n            if (res == -1) {\n                return -1;\n            }\n        }\n        return 0;\n    } else {\n        return call_proc(ctx, arg, FUSE_OPT_KEY_OPT, iso);\n    }\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_proc",
          "args": [
            "ctx",
            "arg",
            "FUSE_OPT_KEY_OPT",
            "iso"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "call_proc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "159-177",
          "snippet": "static int call_proc(struct fuse_opt_context *ctx, const char *arg, int key,\n                     int iso)\n{\n    if (key == FUSE_OPT_KEY_DISCARD) {\n        return 0;\n    }\n\n    if (key != FUSE_OPT_KEY_KEEP && ctx->proc) {\n        int res = ctx->proc(ctx->data, arg, key, &ctx->outargs);\n        if (res == -1 || !res) {\n            return res;\n        }\n    }\n    if (iso) {\n        return add_opt(ctx, arg);\n    } else {\n        return add_arg(ctx, arg);\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int call_proc(struct fuse_opt_context *ctx, const char *arg, int key,\n                     int iso)\n{\n    if (key == FUSE_OPT_KEY_DISCARD) {\n        return 0;\n    }\n\n    if (key != FUSE_OPT_KEY_KEEP && ctx->proc) {\n        int res = ctx->proc(ctx->data, arg, key, &ctx->outargs);\n        if (res == -1 || !res) {\n            return res;\n        }\n    }\n    if (iso) {\n        return add_opt(ctx, arg);\n    } else {\n        return add_arg(ctx, arg);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "process_opt",
          "args": [
            "ctx",
            "opt",
            "sep",
            "arg",
            "iso"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "process_opt_sep_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "266-290",
          "snippet": "static int process_opt_sep_arg(struct fuse_opt_context *ctx,\n                               const struct fuse_opt *opt, unsigned sep,\n                               const char *arg, int iso)\n{\n    int res;\n    char *newarg;\n    char *param;\n\n    if (next_arg(ctx, arg) == -1) {\n        return -1;\n    }\n\n    param = ctx->argv[ctx->argctr];\n    newarg = malloc(sep + strlen(param) + 1);\n    if (!newarg) {\n        return alloc_failed();\n    }\n\n    memcpy(newarg, arg, sep);\n    strcpy(newarg + sep, param);\n    res = process_opt(ctx, opt, sep, newarg, iso);\n    free(newarg);\n\n    return res;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_opt_sep_arg(struct fuse_opt_context *ctx,\n                               const struct fuse_opt *opt, unsigned sep,\n                               const char *arg, int iso)\n{\n    int res;\n    char *newarg;\n    char *param;\n\n    if (next_arg(ctx, arg) == -1) {\n        return -1;\n    }\n\n    param = ctx->argv[ctx->argctr];\n    newarg = malloc(sep + strlen(param) + 1);\n    if (!newarg) {\n        return alloc_failed();\n    }\n\n    memcpy(newarg, arg, sep);\n    strcpy(newarg + sep, param);\n    res = process_opt(ctx, opt, sep, newarg, iso);\n    free(newarg);\n\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_opt",
          "args": [
            "opt + 1",
            "arg",
            "&sep"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "find_opt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "201-210",
          "snippet": "static const struct fuse_opt *find_opt(const struct fuse_opt *opt,\n                                       const char *arg, unsigned *sepp)\n{\n    for (; opt && opt->templ; opt++) {\n        if (match_template(opt->templ, arg, sepp)) {\n            return opt;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic const struct fuse_opt *find_opt(const struct fuse_opt *opt,\n                                       const char *arg, unsigned *sepp)\n{\n    for (; opt && opt->templ; opt++) {\n        if (match_template(opt->templ, arg, sepp)) {\n            return opt;\n        }\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_gopt(struct fuse_opt_context *ctx, const char *arg, int iso)\n{\n    unsigned sep;\n    const struct fuse_opt *opt = find_opt(ctx->opt, arg, &sep);\n    if (opt) {\n        for (; opt; opt = find_opt(opt + 1, arg, &sep)) {\n            int res;\n            if (sep && opt->templ[sep] == ' ' && !arg[sep]) {\n                res = process_opt_sep_arg(ctx, opt, sep, arg, iso);\n            } else {\n                res = process_opt(ctx, opt, sep, arg, iso);\n            }\n            if (res == -1) {\n                return -1;\n            }\n        }\n        return 0;\n    } else {\n        return call_proc(ctx, arg, FUSE_OPT_KEY_OPT, iso);\n    }\n}"
  },
  {
    "function_name": "process_opt_sep_arg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "266-290",
    "snippet": "static int process_opt_sep_arg(struct fuse_opt_context *ctx,\n                               const struct fuse_opt *opt, unsigned sep,\n                               const char *arg, int iso)\n{\n    int res;\n    char *newarg;\n    char *param;\n\n    if (next_arg(ctx, arg) == -1) {\n        return -1;\n    }\n\n    param = ctx->argv[ctx->argctr];\n    newarg = malloc(sep + strlen(param) + 1);\n    if (!newarg) {\n        return alloc_failed();\n    }\n\n    memcpy(newarg, arg, sep);\n    strcpy(newarg + sep, param);\n    res = process_opt(ctx, opt, sep, newarg, iso);\n    free(newarg);\n\n    return res;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "newarg"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_free_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "34-48",
          "snippet": "void fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "process_opt",
          "args": [
            "ctx",
            "opt",
            "sep",
            "newarg",
            "iso"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "process_opt_sep_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "266-290",
          "snippet": "static int process_opt_sep_arg(struct fuse_opt_context *ctx,\n                               const struct fuse_opt *opt, unsigned sep,\n                               const char *arg, int iso)\n{\n    int res;\n    char *newarg;\n    char *param;\n\n    if (next_arg(ctx, arg) == -1) {\n        return -1;\n    }\n\n    param = ctx->argv[ctx->argctr];\n    newarg = malloc(sep + strlen(param) + 1);\n    if (!newarg) {\n        return alloc_failed();\n    }\n\n    memcpy(newarg, arg, sep);\n    strcpy(newarg + sep, param);\n    res = process_opt(ctx, opt, sep, newarg, iso);\n    free(newarg);\n\n    return res;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "newarg + sep",
            "param"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "newarg",
            "arg",
            "sep"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_failed",
          "args": [],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_failed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "50-54",
          "snippet": "static int alloc_failed(void)\n{\n    fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n    return -1;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int alloc_failed(void)\n{\n    fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sep + strlen(param) + 1"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "param"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "next_arg",
          "args": [
            "ctx",
            "arg"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "next_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "103-111",
          "snippet": "static int next_arg(struct fuse_opt_context *ctx, const char *opt)\n{\n    if (ctx->argctr + 1 >= ctx->argc) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: missing argument after `%s'\\n\", opt);\n        return -1;\n    }\n    ctx->argctr++;\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int next_arg(struct fuse_opt_context *ctx, const char *opt)\n{\n    if (ctx->argctr + 1 >= ctx->argc) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: missing argument after `%s'\\n\", opt);\n        return -1;\n    }\n    ctx->argctr++;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_opt_sep_arg(struct fuse_opt_context *ctx,\n                               const struct fuse_opt *opt, unsigned sep,\n                               const char *arg, int iso)\n{\n    int res;\n    char *newarg;\n    char *param;\n\n    if (next_arg(ctx, arg) == -1) {\n        return -1;\n    }\n\n    param = ctx->argv[ctx->argctr];\n    newarg = malloc(sep + strlen(param) + 1);\n    if (!newarg) {\n        return alloc_failed();\n    }\n\n    memcpy(newarg, arg, sep);\n    strcpy(newarg + sep, param);\n    res = process_opt(ctx, opt, sep, newarg, iso);\n    free(newarg);\n\n    return res;\n}"
  },
  {
    "function_name": "process_opt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "241-264",
    "snippet": "static int process_opt(struct fuse_opt_context *ctx, const struct fuse_opt *opt,\n                       unsigned sep, const char *arg, int iso)\n{\n    if (opt->offset == -1U) {\n        if (call_proc(ctx, arg, opt->value, iso) == -1) {\n            return -1;\n        }\n    } else {\n        void *var = (char *)ctx->data + opt->offset;\n        if (sep && opt->templ[sep + 1]) {\n            const char *param = arg + sep;\n            if (opt->templ[sep] == '=') {\n                param++;\n            }\n            if (process_opt_param(var, opt->templ + sep + 1, param, arg) ==\n                -1) {\n                return -1;\n            }\n        } else {\n            *(int *)var = opt->value;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "process_opt_param",
          "args": [
            "var",
            "opt->templ + sep + 1",
            "param",
            "arg"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "process_opt_param",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "218-239",
          "snippet": "static int process_opt_param(void *var, const char *format, const char *param,\n                             const char *arg)\n{\n    assert(format[0] == '%');\n    if (format[1] == 's') {\n        char **s = var;\n        char *copy = strdup(param);\n        if (!copy) {\n            return alloc_failed();\n        }\n\n        free(*s);\n        *s = copy;\n    } else {\n        if (sscanf(param, format, var) != 1) {\n            fuse_log(FUSE_LOG_ERR, \"fuse: invalid parameter in option `%s'\\n\",\n                     arg);\n            return -1;\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_opt_param(void *var, const char *format, const char *param,\n                             const char *arg)\n{\n    assert(format[0] == '%');\n    if (format[1] == 's') {\n        char **s = var;\n        char *copy = strdup(param);\n        if (!copy) {\n            return alloc_failed();\n        }\n\n        free(*s);\n        *s = copy;\n    } else {\n        if (sscanf(param, format, var) != 1) {\n            fuse_log(FUSE_LOG_ERR, \"fuse: invalid parameter in option `%s'\\n\",\n                     arg);\n            return -1;\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_proc",
          "args": [
            "ctx",
            "arg",
            "opt->value",
            "iso"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "call_proc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "159-177",
          "snippet": "static int call_proc(struct fuse_opt_context *ctx, const char *arg, int key,\n                     int iso)\n{\n    if (key == FUSE_OPT_KEY_DISCARD) {\n        return 0;\n    }\n\n    if (key != FUSE_OPT_KEY_KEEP && ctx->proc) {\n        int res = ctx->proc(ctx->data, arg, key, &ctx->outargs);\n        if (res == -1 || !res) {\n            return res;\n        }\n    }\n    if (iso) {\n        return add_opt(ctx, arg);\n    } else {\n        return add_arg(ctx, arg);\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int call_proc(struct fuse_opt_context *ctx, const char *arg, int key,\n                     int iso)\n{\n    if (key == FUSE_OPT_KEY_DISCARD) {\n        return 0;\n    }\n\n    if (key != FUSE_OPT_KEY_KEEP && ctx->proc) {\n        int res = ctx->proc(ctx->data, arg, key, &ctx->outargs);\n        if (res == -1 || !res) {\n            return res;\n        }\n    }\n    if (iso) {\n        return add_opt(ctx, arg);\n    } else {\n        return add_arg(ctx, arg);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_opt(struct fuse_opt_context *ctx, const struct fuse_opt *opt,\n                       unsigned sep, const char *arg, int iso)\n{\n    if (opt->offset == -1U) {\n        if (call_proc(ctx, arg, opt->value, iso) == -1) {\n            return -1;\n        }\n    } else {\n        void *var = (char *)ctx->data + opt->offset;\n        if (sep && opt->templ[sep + 1]) {\n            const char *param = arg + sep;\n            if (opt->templ[sep] == '=') {\n                param++;\n            }\n            if (process_opt_param(var, opt->templ + sep + 1, param, arg) ==\n                -1) {\n                return -1;\n            }\n        } else {\n            *(int *)var = opt->value;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "process_opt_param",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "218-239",
    "snippet": "static int process_opt_param(void *var, const char *format, const char *param,\n                             const char *arg)\n{\n    assert(format[0] == '%');\n    if (format[1] == 's') {\n        char **s = var;\n        char *copy = strdup(param);\n        if (!copy) {\n            return alloc_failed();\n        }\n\n        free(*s);\n        *s = copy;\n    } else {\n        if (sscanf(param, format, var) != 1) {\n            fuse_log(FUSE_LOG_ERR, \"fuse: invalid parameter in option `%s'\\n\",\n                     arg);\n            return -1;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_ERR",
            "\"fuse: invalid parameter in option `%s'\\n\"",
            "arg"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "param",
            "format",
            "var"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "*s"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_free_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "34-48",
          "snippet": "void fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_failed",
          "args": [],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_failed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "50-54",
          "snippet": "static int alloc_failed(void)\n{\n    fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n    return -1;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int alloc_failed(void)\n{\n    fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "param"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "format[0] == '%'"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int process_opt_param(void *var, const char *format, const char *param,\n                             const char *arg)\n{\n    assert(format[0] == '%');\n    if (format[1] == 's') {\n        char **s = var;\n        char *copy = strdup(param);\n        if (!copy) {\n            return alloc_failed();\n        }\n\n        free(*s);\n        *s = copy;\n    } else {\n        if (sscanf(param, format, var) != 1) {\n            fuse_log(FUSE_LOG_ERR, \"fuse: invalid parameter in option `%s'\\n\",\n                     arg);\n            return -1;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "fuse_opt_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "212-216",
    "snippet": "int fuse_opt_match(const struct fuse_opt *opts, const char *opt)\n{\n    unsigned dummy;\n    return find_opt(opts, opt, &dummy) ? 1 : 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "find_opt",
          "args": [
            "opts",
            "opt",
            "&dummy"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "find_opt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "201-210",
          "snippet": "static const struct fuse_opt *find_opt(const struct fuse_opt *opt,\n                                       const char *arg, unsigned *sepp)\n{\n    for (; opt && opt->templ; opt++) {\n        if (match_template(opt->templ, arg, sepp)) {\n            return opt;\n        }\n    }\n    return NULL;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic const struct fuse_opt *find_opt(const struct fuse_opt *opt,\n                                       const char *arg, unsigned *sepp)\n{\n    for (; opt && opt->templ; opt++) {\n        if (match_template(opt->templ, arg, sepp)) {\n            return opt;\n        }\n    }\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_opt_match(const struct fuse_opt *opts, const char *opt)\n{\n    unsigned dummy;\n    return find_opt(opts, opt, &dummy) ? 1 : 0;\n}"
  },
  {
    "function_name": "find_opt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "201-210",
    "snippet": "static const struct fuse_opt *find_opt(const struct fuse_opt *opt,\n                                       const char *arg, unsigned *sepp)\n{\n    for (; opt && opt->templ; opt++) {\n        if (match_template(opt->templ, arg, sepp)) {\n            return opt;\n        }\n    }\n    return NULL;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "match_template",
          "args": [
            "opt->templ",
            "arg",
            "sepp"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "match_template",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "179-199",
          "snippet": "static int match_template(const char *t, const char *arg, unsigned *sepp)\n{\n    int arglen = strlen(arg);\n    const char *sep = strchr(t, '=');\n    sep = sep ? sep : strchr(t, ' ');\n    if (sep && (!sep[1] || sep[1] == '%')) {\n        int tlen = sep - t;\n        if (sep[0] == '=') {\n            tlen++;\n        }\n        if (arglen >= tlen && strncmp(arg, t, tlen) == 0) {\n            *sepp = sep - t;\n            return 1;\n        }\n    }\n    if (strcmp(t, arg) == 0) {\n        *sepp = 0;\n        return 1;\n    }\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int match_template(const char *t, const char *arg, unsigned *sepp)\n{\n    int arglen = strlen(arg);\n    const char *sep = strchr(t, '=');\n    sep = sep ? sep : strchr(t, ' ');\n    if (sep && (!sep[1] || sep[1] == '%')) {\n        int tlen = sep - t;\n        if (sep[0] == '=') {\n            tlen++;\n        }\n        if (arglen >= tlen && strncmp(arg, t, tlen) == 0) {\n            *sepp = sep - t;\n            return 1;\n        }\n    }\n    if (strcmp(t, arg) == 0) {\n        *sepp = 0;\n        return 1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic const struct fuse_opt *find_opt(const struct fuse_opt *opt,\n                                       const char *arg, unsigned *sepp)\n{\n    for (; opt && opt->templ; opt++) {\n        if (match_template(opt->templ, arg, sepp)) {\n            return opt;\n        }\n    }\n    return NULL;\n}"
  },
  {
    "function_name": "match_template",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "179-199",
    "snippet": "static int match_template(const char *t, const char *arg, unsigned *sepp)\n{\n    int arglen = strlen(arg);\n    const char *sep = strchr(t, '=');\n    sep = sep ? sep : strchr(t, ' ');\n    if (sep && (!sep[1] || sep[1] == '%')) {\n        int tlen = sep - t;\n        if (sep[0] == '=') {\n            tlen++;\n        }\n        if (arglen >= tlen && strncmp(arg, t, tlen) == 0) {\n            *sepp = sep - t;\n            return 1;\n        }\n    }\n    if (strcmp(t, arg) == 0) {\n        *sepp = 0;\n        return 1;\n    }\n    return 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "t",
            "arg"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "arg",
            "t",
            "tlen"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "t",
            "' '"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "t",
            "'='"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "arg"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int match_template(const char *t, const char *arg, unsigned *sepp)\n{\n    int arglen = strlen(arg);\n    const char *sep = strchr(t, '=');\n    sep = sep ? sep : strchr(t, ' ');\n    if (sep && (!sep[1] || sep[1] == '%')) {\n        int tlen = sep - t;\n        if (sep[0] == '=') {\n            tlen++;\n        }\n        if (arglen >= tlen && strncmp(arg, t, tlen) == 0) {\n            *sepp = sep - t;\n            return 1;\n        }\n    }\n    if (strcmp(t, arg) == 0) {\n        *sepp = 0;\n        return 1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "call_proc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "159-177",
    "snippet": "static int call_proc(struct fuse_opt_context *ctx, const char *arg, int key,\n                     int iso)\n{\n    if (key == FUSE_OPT_KEY_DISCARD) {\n        return 0;\n    }\n\n    if (key != FUSE_OPT_KEY_KEEP && ctx->proc) {\n        int res = ctx->proc(ctx->data, arg, key, &ctx->outargs);\n        if (res == -1 || !res) {\n            return res;\n        }\n    }\n    if (iso) {\n        return add_opt(ctx, arg);\n    } else {\n        return add_arg(ctx, arg);\n    }\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_arg",
          "args": [
            "ctx",
            "arg"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "add_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "113-116",
          "snippet": "static int add_arg(struct fuse_opt_context *ctx, const char *arg)\n{\n    return fuse_opt_add_arg(&ctx->outargs, arg);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int add_arg(struct fuse_opt_context *ctx, const char *arg)\n{\n    return fuse_opt_add_arg(&ctx->outargs, arg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_opt",
          "args": [
            "ctx",
            "arg"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "add_opt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "154-157",
          "snippet": "static int add_opt(struct fuse_opt_context *ctx, const char *opt)\n{\n    return add_opt_common(&ctx->opts, opt, 1);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int add_opt(struct fuse_opt_context *ctx, const char *opt)\n{\n    return add_opt_common(&ctx->opts, opt, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ctx->proc",
          "args": [
            "ctx->data",
            "arg",
            "key",
            "&ctx->outargs"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int call_proc(struct fuse_opt_context *ctx, const char *arg, int key,\n                     int iso)\n{\n    if (key == FUSE_OPT_KEY_DISCARD) {\n        return 0;\n    }\n\n    if (key != FUSE_OPT_KEY_KEEP && ctx->proc) {\n        int res = ctx->proc(ctx->data, arg, key, &ctx->outargs);\n        if (res == -1 || !res) {\n            return res;\n        }\n    }\n    if (iso) {\n        return add_opt(ctx, arg);\n    } else {\n        return add_arg(ctx, arg);\n    }\n}"
  },
  {
    "function_name": "add_opt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "154-157",
    "snippet": "static int add_opt(struct fuse_opt_context *ctx, const char *opt)\n{\n    return add_opt_common(&ctx->opts, opt, 1);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_opt_common",
          "args": [
            "&ctx->opts",
            "opt",
            "1"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "add_opt_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "118-142",
          "snippet": "static int add_opt_common(char **opts, const char *opt, int esc)\n{\n    unsigned oldlen = *opts ? strlen(*opts) : 0;\n    char *d = realloc(*opts, oldlen + 1 + strlen(opt) * 2 + 1);\n\n    if (!d) {\n        return alloc_failed();\n    }\n\n    *opts = d;\n    if (oldlen) {\n        d += oldlen;\n        *d++ = ',';\n    }\n\n    for (; *opt; opt++) {\n        if (esc && (*opt == ',' || *opt == '\\\\')) {\n            *d++ = '\\\\';\n        }\n        *d++ = *opt;\n    }\n    *d = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int add_opt_common(char **opts, const char *opt, int esc)\n{\n    unsigned oldlen = *opts ? strlen(*opts) : 0;\n    char *d = realloc(*opts, oldlen + 1 + strlen(opt) * 2 + 1);\n\n    if (!d) {\n        return alloc_failed();\n    }\n\n    *opts = d;\n    if (oldlen) {\n        d += oldlen;\n        *d++ = ',';\n    }\n\n    for (; *opt; opt++) {\n        if (esc && (*opt == ',' || *opt == '\\\\')) {\n            *d++ = '\\\\';\n        }\n        *d++ = *opt;\n    }\n    *d = '\\0';\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int add_opt(struct fuse_opt_context *ctx, const char *opt)\n{\n    return add_opt_common(&ctx->opts, opt, 1);\n}"
  },
  {
    "function_name": "fuse_opt_add_opt_escaped",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "149-152",
    "snippet": "int fuse_opt_add_opt_escaped(char **opts, const char *opt)\n{\n    return add_opt_common(opts, opt, 1);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_opt_common",
          "args": [
            "opts",
            "opt",
            "1"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "add_opt_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "118-142",
          "snippet": "static int add_opt_common(char **opts, const char *opt, int esc)\n{\n    unsigned oldlen = *opts ? strlen(*opts) : 0;\n    char *d = realloc(*opts, oldlen + 1 + strlen(opt) * 2 + 1);\n\n    if (!d) {\n        return alloc_failed();\n    }\n\n    *opts = d;\n    if (oldlen) {\n        d += oldlen;\n        *d++ = ',';\n    }\n\n    for (; *opt; opt++) {\n        if (esc && (*opt == ',' || *opt == '\\\\')) {\n            *d++ = '\\\\';\n        }\n        *d++ = *opt;\n    }\n    *d = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int add_opt_common(char **opts, const char *opt, int esc)\n{\n    unsigned oldlen = *opts ? strlen(*opts) : 0;\n    char *d = realloc(*opts, oldlen + 1 + strlen(opt) * 2 + 1);\n\n    if (!d) {\n        return alloc_failed();\n    }\n\n    *opts = d;\n    if (oldlen) {\n        d += oldlen;\n        *d++ = ',';\n    }\n\n    for (; *opt; opt++) {\n        if (esc && (*opt == ',' || *opt == '\\\\')) {\n            *d++ = '\\\\';\n        }\n        *d++ = *opt;\n    }\n    *d = '\\0';\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_opt_add_opt_escaped(char **opts, const char *opt)\n{\n    return add_opt_common(opts, opt, 1);\n}"
  },
  {
    "function_name": "fuse_opt_add_opt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "144-147",
    "snippet": "int fuse_opt_add_opt(char **opts, const char *opt)\n{\n    return add_opt_common(opts, opt, 0);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_opt_common",
          "args": [
            "opts",
            "opt",
            "0"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "add_opt_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "118-142",
          "snippet": "static int add_opt_common(char **opts, const char *opt, int esc)\n{\n    unsigned oldlen = *opts ? strlen(*opts) : 0;\n    char *d = realloc(*opts, oldlen + 1 + strlen(opt) * 2 + 1);\n\n    if (!d) {\n        return alloc_failed();\n    }\n\n    *opts = d;\n    if (oldlen) {\n        d += oldlen;\n        *d++ = ',';\n    }\n\n    for (; *opt; opt++) {\n        if (esc && (*opt == ',' || *opt == '\\\\')) {\n            *d++ = '\\\\';\n        }\n        *d++ = *opt;\n    }\n    *d = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int add_opt_common(char **opts, const char *opt, int esc)\n{\n    unsigned oldlen = *opts ? strlen(*opts) : 0;\n    char *d = realloc(*opts, oldlen + 1 + strlen(opt) * 2 + 1);\n\n    if (!d) {\n        return alloc_failed();\n    }\n\n    *opts = d;\n    if (oldlen) {\n        d += oldlen;\n        *d++ = ',';\n    }\n\n    for (; *opt; opt++) {\n        if (esc && (*opt == ',' || *opt == '\\\\')) {\n            *d++ = '\\\\';\n        }\n        *d++ = *opt;\n    }\n    *d = '\\0';\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_opt_add_opt(char **opts, const char *opt)\n{\n    return add_opt_common(opts, opt, 0);\n}"
  },
  {
    "function_name": "add_opt_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "118-142",
    "snippet": "static int add_opt_common(char **opts, const char *opt, int esc)\n{\n    unsigned oldlen = *opts ? strlen(*opts) : 0;\n    char *d = realloc(*opts, oldlen + 1 + strlen(opt) * 2 + 1);\n\n    if (!d) {\n        return alloc_failed();\n    }\n\n    *opts = d;\n    if (oldlen) {\n        d += oldlen;\n        *d++ = ',';\n    }\n\n    for (; *opt; opt++) {\n        if (esc && (*opt == ',' || *opt == '\\\\')) {\n            *d++ = '\\\\';\n        }\n        *d++ = *opt;\n    }\n    *d = '\\0';\n\n    return 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_failed",
          "args": [],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_failed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "50-54",
          "snippet": "static int alloc_failed(void)\n{\n    fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n    return -1;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int alloc_failed(void)\n{\n    fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "realloc",
          "args": [
            "*opts",
            "oldlen + 1 + strlen(opt) * 2 + 1"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "opt"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "*opts"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int add_opt_common(char **opts, const char *opt, int esc)\n{\n    unsigned oldlen = *opts ? strlen(*opts) : 0;\n    char *d = realloc(*opts, oldlen + 1 + strlen(opt) * 2 + 1);\n\n    if (!d) {\n        return alloc_failed();\n    }\n\n    *opts = d;\n    if (oldlen) {\n        d += oldlen;\n        *d++ = ',';\n    }\n\n    for (; *opt; opt++) {\n        if (esc && (*opt == ',' || *opt == '\\\\')) {\n            *d++ = '\\\\';\n        }\n        *d++ = *opt;\n    }\n    *d = '\\0';\n\n    return 0;\n}"
  },
  {
    "function_name": "add_arg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "113-116",
    "snippet": "static int add_arg(struct fuse_opt_context *ctx, const char *arg)\n{\n    return fuse_opt_add_arg(&ctx->outargs, arg);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_opt_add_arg",
          "args": [
            "&ctx->outargs",
            "arg"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_add_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "56-79",
          "snippet": "int fuse_opt_add_arg(struct fuse_args *args, const char *arg)\n{\n    char **newargv;\n    char *newarg;\n\n    assert(!args->argv || args->allocated);\n\n    newarg = strdup(arg);\n    if (!newarg) {\n        return alloc_failed();\n    }\n\n    newargv = realloc(args->argv, (args->argc + 2) * sizeof(char *));\n    if (!newargv) {\n        free(newarg);\n        return alloc_failed();\n    }\n\n    args->argv = newargv;\n    args->allocated = 1;\n    args->argv[args->argc++] = newarg;\n    args->argv[args->argc] = NULL;\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_opt_add_arg(struct fuse_args *args, const char *arg)\n{\n    char **newargv;\n    char *newarg;\n\n    assert(!args->argv || args->allocated);\n\n    newarg = strdup(arg);\n    if (!newarg) {\n        return alloc_failed();\n    }\n\n    newargv = realloc(args->argv, (args->argc + 2) * sizeof(char *));\n    if (!newargv) {\n        free(newarg);\n        return alloc_failed();\n    }\n\n    args->argv = newargv;\n    args->allocated = 1;\n    args->argv[args->argc++] = newarg;\n    args->argv[args->argc] = NULL;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int add_arg(struct fuse_opt_context *ctx, const char *arg)\n{\n    return fuse_opt_add_arg(&ctx->outargs, arg);\n}"
  },
  {
    "function_name": "next_arg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "103-111",
    "snippet": "static int next_arg(struct fuse_opt_context *ctx, const char *opt)\n{\n    if (ctx->argctr + 1 >= ctx->argc) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: missing argument after `%s'\\n\", opt);\n        return -1;\n    }\n    ctx->argctr++;\n    return 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_ERR",
            "\"fuse: missing argument after `%s'\\n\"",
            "opt"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int next_arg(struct fuse_opt_context *ctx, const char *opt)\n{\n    if (ctx->argctr + 1 >= ctx->argc) {\n        fuse_log(FUSE_LOG_ERR, \"fuse: missing argument after `%s'\\n\", opt);\n        return -1;\n    }\n    ctx->argctr++;\n    return 0;\n}"
  },
  {
    "function_name": "fuse_opt_insert_arg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "98-101",
    "snippet": "int fuse_opt_insert_arg(struct fuse_args *args, int pos, const char *arg)\n{\n    return fuse_opt_insert_arg_common(args, pos, arg);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_opt_insert_arg_common",
          "args": [
            "args",
            "pos",
            "arg"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_insert_arg_common",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "81-96",
          "snippet": "static int fuse_opt_insert_arg_common(struct fuse_args *args, int pos,\n                                      const char *arg)\n{\n    assert(pos <= args->argc);\n    if (fuse_opt_add_arg(args, arg) == -1) {\n        return -1;\n    }\n\n    if (pos != args->argc - 1) {\n        char *newarg = args->argv[args->argc - 1];\n        memmove(&args->argv[pos + 1], &args->argv[pos],\n                sizeof(char *) * (args->argc - pos - 1));\n        args->argv[pos] = newarg;\n    }\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_opt_insert_arg_common(struct fuse_args *args, int pos,\n                                      const char *arg)\n{\n    assert(pos <= args->argc);\n    if (fuse_opt_add_arg(args, arg) == -1) {\n        return -1;\n    }\n\n    if (pos != args->argc - 1) {\n        char *newarg = args->argv[args->argc - 1];\n        memmove(&args->argv[pos + 1], &args->argv[pos],\n                sizeof(char *) * (args->argc - pos - 1));\n        args->argv[pos] = newarg;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_opt_insert_arg(struct fuse_args *args, int pos, const char *arg)\n{\n    return fuse_opt_insert_arg_common(args, pos, arg);\n}"
  },
  {
    "function_name": "fuse_opt_insert_arg_common",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "81-96",
    "snippet": "static int fuse_opt_insert_arg_common(struct fuse_args *args, int pos,\n                                      const char *arg)\n{\n    assert(pos <= args->argc);\n    if (fuse_opt_add_arg(args, arg) == -1) {\n        return -1;\n    }\n\n    if (pos != args->argc - 1) {\n        char *newarg = args->argv[args->argc - 1];\n        memmove(&args->argv[pos + 1], &args->argv[pos],\n                sizeof(char *) * (args->argc - pos - 1));\n        args->argv[pos] = newarg;\n    }\n    return 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "&args->argv[pos + 1]",
            "&args->argv[pos]",
            "sizeof(char *) * (args->argc - pos - 1)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fuse_opt_add_arg",
          "args": [
            "args",
            "arg"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_add_arg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "56-79",
          "snippet": "int fuse_opt_add_arg(struct fuse_args *args, const char *arg)\n{\n    char **newargv;\n    char *newarg;\n\n    assert(!args->argv || args->allocated);\n\n    newarg = strdup(arg);\n    if (!newarg) {\n        return alloc_failed();\n    }\n\n    newargv = realloc(args->argv, (args->argc + 2) * sizeof(char *));\n    if (!newargv) {\n        free(newarg);\n        return alloc_failed();\n    }\n\n    args->argv = newargv;\n    args->allocated = 1;\n    args->argv[args->argc++] = newarg;\n    args->argv[args->argc] = NULL;\n    return 0;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_opt_add_arg(struct fuse_args *args, const char *arg)\n{\n    char **newargv;\n    char *newarg;\n\n    assert(!args->argv || args->allocated);\n\n    newarg = strdup(arg);\n    if (!newarg) {\n        return alloc_failed();\n    }\n\n    newargv = realloc(args->argv, (args->argc + 2) * sizeof(char *));\n    if (!newargv) {\n        free(newarg);\n        return alloc_failed();\n    }\n\n    args->argv = newargv;\n    args->allocated = 1;\n    args->argv[args->argc++] = newarg;\n    args->argv[args->argc] = NULL;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "pos <= args->argc"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int fuse_opt_insert_arg_common(struct fuse_args *args, int pos,\n                                      const char *arg)\n{\n    assert(pos <= args->argc);\n    if (fuse_opt_add_arg(args, arg) == -1) {\n        return -1;\n    }\n\n    if (pos != args->argc - 1) {\n        char *newarg = args->argv[args->argc - 1];\n        memmove(&args->argv[pos + 1], &args->argv[pos],\n                sizeof(char *) * (args->argc - pos - 1));\n        args->argv[pos] = newarg;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "fuse_opt_add_arg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "56-79",
    "snippet": "int fuse_opt_add_arg(struct fuse_args *args, const char *arg)\n{\n    char **newargv;\n    char *newarg;\n\n    assert(!args->argv || args->allocated);\n\n    newarg = strdup(arg);\n    if (!newarg) {\n        return alloc_failed();\n    }\n\n    newargv = realloc(args->argv, (args->argc + 2) * sizeof(char *));\n    if (!newargv) {\n        free(newarg);\n        return alloc_failed();\n    }\n\n    args->argv = newargv;\n    args->allocated = 1;\n    args->argv[args->argc++] = newarg;\n    args->argv[args->argc] = NULL;\n    return 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_failed",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_failed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "50-54",
          "snippet": "static int alloc_failed(void)\n{\n    fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n    return -1;\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int alloc_failed(void)\n{\n    fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "newarg"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_free_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "34-48",
          "snippet": "void fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"fuse_misc.h\"",
            "#include \"fuse_i.h\"",
            "#include \"fuse_opt.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "realloc",
          "args": [
            "args->argv",
            "(args->argc + 2) * sizeof(char *)"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "arg"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!args->argv || args->allocated"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nint fuse_opt_add_arg(struct fuse_args *args, const char *arg)\n{\n    char **newargv;\n    char *newarg;\n\n    assert(!args->argv || args->allocated);\n\n    newarg = strdup(arg);\n    if (!newarg) {\n        return alloc_failed();\n    }\n\n    newargv = realloc(args->argv, (args->argc + 2) * sizeof(char *));\n    if (!newargv) {\n        free(newarg);\n        return alloc_failed();\n    }\n\n    args->argv = newargv;\n    args->allocated = 1;\n    args->argv[args->argc++] = newarg;\n    args->argv[args->argc] = NULL;\n    return 0;\n}"
  },
  {
    "function_name": "alloc_failed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "50-54",
    "snippet": "static int alloc_failed(void)\n{\n    fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n    return -1;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fuse_log",
          "args": [
            "FUSE_LOG_ERR",
            "\"fuse: memory allocation failed\\n\""
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_log.c",
          "lines": "34-41",
          "snippet": "void fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include \"fuse_log.h\"",
            "#include \"qemu/osdep.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static fuse_log_func_t log_func = default_log_func;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <stdarg.h>\n#include \"fuse_log.h\"\n#include \"qemu/osdep.h\"\n\nstatic fuse_log_func_t log_func = default_log_func;\n\nvoid fuse_log(enum fuse_log_level level, const char *fmt, ...)\n{\n    va_list ap;\n\n    va_start(ap, fmt);\n    log_func(level, fmt, ap);\n    va_end(ap);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nstatic int alloc_failed(void)\n{\n    fuse_log(FUSE_LOG_ERR, \"fuse: memory allocation failed\\n\");\n    return -1;\n}"
  },
  {
    "function_name": "fuse_opt_free_args",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
    "lines": "34-48",
    "snippet": "void fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <assert.h>",
      "#include \"fuse_misc.h\"",
      "#include \"fuse_i.h\"",
      "#include \"fuse_opt.h\"",
      "#include \"qemu/osdep.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "args->argv"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "fuse_opt_free_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-35517/repo/tools/virtiofsd/fuse_opt.c",
          "lines": "34-48",
          "snippet": "void fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n#include \"fuse_misc.h\"\n#include \"fuse_i.h\"\n#include \"fuse_opt.h\"\n#include \"qemu/osdep.h\"\n\nvoid fuse_opt_free_args(struct fuse_args *args)\n{\n    if (args) {\n        if (args->argv && args->allocated) {\n            int i;\n            for (i = 0; i < args->argc; i++) {\n                free(args->argv[i]);\n            }\n            free(args->argv);\n        }\n        args->argc = 0;\n        args->argv = NULL;\n        args->allocated = 0;\n    }\n}"
  }
]