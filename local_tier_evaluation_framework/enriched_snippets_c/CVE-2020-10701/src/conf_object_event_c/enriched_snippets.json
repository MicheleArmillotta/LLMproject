[
  {
    "function_name": "virObjectEventStateSetRemote",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "1057-1078",
    "snippet": "void\nvirObjectEventStateSetRemote(virConnectPtr conn,\n                             virObjectEventStatePtr state,\n                             int callbackID,\n                             int remoteID)\n{\n    size_t i;\n\n    virObjectLock(state);\n    for (i = 0; i < state->callbacks->count; i++) {\n        virObjectEventCallbackPtr cb = state->callbacks->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            cb->remoteID = remoteID;\n            break;\n        }\n    }\n    virObjectUnlock(state);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "state"
          ],
          "line": 1077
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "state"
          ],
          "line": 1065
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateSetRemote(virConnectPtr conn,\n                             virObjectEventStatePtr state,\n                             int callbackID,\n                             int remoteID)\n{\n    size_t i;\n\n    virObjectLock(state);\n    for (i = 0; i < state->callbacks->count; i++) {\n        virObjectEventCallbackPtr cb = state->callbacks->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            cb->remoteID = remoteID;\n            break;\n        }\n    }\n    virObjectUnlock(state);\n}"
  },
  {
    "function_name": "virObjectEventStateEventID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "1011-1042",
    "snippet": "int\nvirObjectEventStateEventID(virConnectPtr conn,\n                           virObjectEventStatePtr state,\n                           int callbackID,\n                           int *remoteID)\n{\n    int ret = -1;\n    size_t i;\n    virObjectEventCallbackListPtr cbList = state->callbacks;\n\n    virObjectLock(state);\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            ret = cb->eventID;\n            break;\n        }\n    }\n    virObjectUnlock(state);\n\n    if (ret < 0)\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"event callback id %d not registered\"),\n                       callbackID);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"event callback id %d not registered\")",
            "callbackID"
          ],
          "line": 1038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"event callback id %d not registered\""
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "333-366",
          "snippet": "static int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "state"
          ],
          "line": 1035
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "state"
          ],
          "line": 1021
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateEventID(virConnectPtr conn,\n                           virObjectEventStatePtr state,\n                           int callbackID,\n                           int *remoteID)\n{\n    int ret = -1;\n    size_t i;\n    virObjectEventCallbackListPtr cbList = state->callbacks;\n\n    virObjectLock(state);\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            ret = cb->eventID;\n            break;\n        }\n    }\n    virObjectUnlock(state);\n\n    if (ret < 0)\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"event callback id %d not registered\"),\n                       callbackID);\n    return ret;\n}"
  },
  {
    "function_name": "virObjectEventStateCallbackID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "973-994",
    "snippet": "int\nvirObjectEventStateCallbackID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback callback,\n                              int *remoteID)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n    ret = virObjectEventCallbackLookup(conn, state->callbacks, NULL,\n                                       klass, eventID, callback, true,\n                                       remoteID);\n    virObjectUnlock(state);\n\n    if (ret < 0)\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"event callback function %p not registered\"),\n                       callback);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"event callback function %p not registered\")",
            "callback"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"event callback function %p not registered\""
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "333-366",
          "snippet": "static int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "state"
          ],
          "line": 987
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackLookup",
          "args": [
            "conn",
            "state->callbacks",
            "NULL",
            "klass",
            "eventID",
            "callback",
            "true",
            "remoteID"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "state"
          ],
          "line": 983
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateCallbackID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback callback,\n                              int *remoteID)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n    ret = virObjectEventCallbackLookup(conn, state->callbacks, NULL,\n                                       klass, eventID, callback, true,\n                                       remoteID);\n    virObjectUnlock(state);\n\n    if (ret < 0)\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"event callback function %p not registered\"),\n                       callback);\n    return ret;\n}"
  },
  {
    "function_name": "virObjectEventStateDeregisterID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "936-957",
    "snippet": "int\nvirObjectEventStateDeregisterID(virConnectPtr conn,\n                                virObjectEventStatePtr state,\n                                int callbackID,\n                                bool doFreeCb)\n{\n    int ret;\n\n    virObjectLock(state);\n    if (state->isDispatching)\n        ret = virObjectEventCallbackListMarkDeleteID(conn,\n                                                     state->callbacks,\n                                                     callbackID);\n    else\n        ret = virObjectEventCallbackListRemoveID(conn, state->callbacks,\n                                                 callbackID, doFreeCb);\n\n    virObjectEventStateCleanupTimer(state, true);\n\n    virObjectUnlock(state);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "state"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateCleanupTimer",
          "args": [
            "state",
            "true"
          ],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateCleanupTimer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "780-796",
          "snippet": "static void\nvirObjectEventStateCleanupTimer(virObjectEventStatePtr state, bool clear_queue)\n{\n    /* There are still some callbacks, keep the timer. */\n    if (state->callbacks->count)\n        return;\n\n    /* The timer is not registered, nothing to do. */\n    if (state->timer == -1)\n        return;\n\n    virEventRemoveTimeout(state->timer);\n    state->timer = -1;\n\n    if (clear_queue)\n        virObjectEventQueueClear(state->queue);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventStateCleanupTimer(virObjectEventStatePtr state, bool clear_queue)\n{\n    /* There are still some callbacks, keep the timer. */\n    if (state->callbacks->count)\n        return;\n\n    /* The timer is not registered, nothing to do. */\n    if (state->timer == -1)\n        return;\n\n    virEventRemoveTimeout(state->timer);\n    state->timer = -1;\n\n    if (clear_queue)\n        virObjectEventQueueClear(state->queue);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackListRemoveID",
          "args": [
            "conn",
            "state->callbacks",
            "callbackID",
            "doFreeCb"
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventCallbackListRemoveID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "231-266",
          "snippet": "static int\nvirObjectEventCallbackListRemoveID(virConnectPtr conn,\n                                   virObjectEventCallbackListPtr cbList,\n                                   int callbackID,\n                                   bool doFreeCb)\n{\n    size_t i;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            int ret;\n\n            ret = cb->filter ? 0 :\n                (virObjectEventCallbackListCount(conn, cbList, cb->klass,\n                                                 cb->eventID,\n                                                 cb->key_filter ? cb->key : NULL,\n                                                 cb->remoteID >= 0) - 1);\n\n            /* @doFreeCb inhibits calling @freecb from error paths in\n             * register functions to ensure the caller of a failed register\n             * function won't end up with a double free error */\n            if (doFreeCb && cb->freecb)\n                (*cb->freecb)(cb->opaque);\n            virObjectEventCallbackFree(cb);\n            VIR_DELETE_ELEMENT(cbList->callbacks, i, cbList->count);\n            return ret;\n        }\n    }\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"could not find event callback %d for deletion\"),\n                   callbackID);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListRemoveID(virConnectPtr conn,\n                                   virObjectEventCallbackListPtr cbList,\n                                   int callbackID,\n                                   bool doFreeCb)\n{\n    size_t i;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            int ret;\n\n            ret = cb->filter ? 0 :\n                (virObjectEventCallbackListCount(conn, cbList, cb->klass,\n                                                 cb->eventID,\n                                                 cb->key_filter ? cb->key : NULL,\n                                                 cb->remoteID >= 0) - 1);\n\n            /* @doFreeCb inhibits calling @freecb from error paths in\n             * register functions to ensure the caller of a failed register\n             * function won't end up with a double free error */\n            if (doFreeCb && cb->freecb)\n                (*cb->freecb)(cb->opaque);\n            virObjectEventCallbackFree(cb);\n            VIR_DELETE_ELEMENT(cbList->callbacks, i, cbList->count);\n            return ret;\n        }\n    }\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"could not find event callback %d for deletion\"),\n                   callbackID);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackListMarkDeleteID",
          "args": [
            "conn",
            "state->callbacks",
            "callbackID"
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventCallbackListMarkDeleteID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "269-293",
          "snippet": "static int\nvirObjectEventCallbackListMarkDeleteID(virConnectPtr conn,\n                                       virObjectEventCallbackListPtr cbList,\n                                       int callbackID)\n{\n    size_t i;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            cb->deleted = true;\n            return cb->filter ? 0 :\n                virObjectEventCallbackListCount(conn, cbList, cb->klass,\n                                                cb->eventID,\n                                                cb->key_filter ? cb->key : NULL,\n                                                cb->remoteID >= 0);\n        }\n    }\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"could not find event callback %d for deletion\"),\n                   callbackID);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListMarkDeleteID(virConnectPtr conn,\n                                       virObjectEventCallbackListPtr cbList,\n                                       int callbackID)\n{\n    size_t i;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            cb->deleted = true;\n            return cb->filter ? 0 :\n                virObjectEventCallbackListCount(conn, cbList, cb->klass,\n                                                cb->eventID,\n                                                cb->key_filter ? cb->key : NULL,\n                                                cb->remoteID >= 0);\n        }\n    }\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"could not find event callback %d for deletion\"),\n                   callbackID);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "state"
          ],
          "line": 944
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateDeregisterID(virConnectPtr conn,\n                                virObjectEventStatePtr state,\n                                int callbackID,\n                                bool doFreeCb)\n{\n    int ret;\n\n    virObjectLock(state);\n    if (state->isDispatching)\n        ret = virObjectEventCallbackListMarkDeleteID(conn,\n                                                     state->callbacks,\n                                                     callbackID);\n    else\n        ret = virObjectEventCallbackListRemoveID(conn, state->callbacks,\n                                                 callbackID, doFreeCb);\n\n    virObjectEventStateCleanupTimer(state, true);\n\n    virObjectUnlock(state);\n    return ret;\n}"
  },
  {
    "function_name": "virObjectEventStateRegisterID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "870-917",
    "snippet": "int\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "state"
          ],
          "line": 915
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateCleanupTimer",
          "args": [
            "state",
            "false"
          ],
          "line": 912
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateCleanupTimer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "780-796",
          "snippet": "static void\nvirObjectEventStateCleanupTimer(virObjectEventStatePtr state, bool clear_queue)\n{\n    /* There are still some callbacks, keep the timer. */\n    if (state->callbacks->count)\n        return;\n\n    /* The timer is not registered, nothing to do. */\n    if (state->timer == -1)\n        return;\n\n    virEventRemoveTimeout(state->timer);\n    state->timer = -1;\n\n    if (clear_queue)\n        virObjectEventQueueClear(state->queue);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventStateCleanupTimer(virObjectEventStatePtr state, bool clear_queue)\n{\n    /* There are still some callbacks, keep the timer. */\n    if (state->callbacks->count)\n        return;\n\n    /* The timer is not registered, nothing to do. */\n    if (state->timer == -1)\n        return;\n\n    virEventRemoveTimeout(state->timer);\n    state->timer = -1;\n\n    if (clear_queue)\n        virObjectEventQueueClear(state->queue);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackListAddID",
          "args": [
            "conn",
            "state->callbacks",
            "key",
            "filter",
            "filter_opaque",
            "klass",
            "eventID",
            "cb",
            "opaque",
            "freecb",
            "legacy",
            "callbackID",
            "serverFilter"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventCallbackListAddID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "387-463",
          "snippet": "static int\nvirObjectEventCallbackListAddID(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                const char *key,\n                                virObjectEventCallbackFilter filter,\n                                void *filter_opaque,\n                                virClassPtr klass,\n                                int eventID,\n                                virConnectObjectEventGenericCallback callback,\n                                void *opaque,\n                                virFreeCallback freecb,\n                                bool legacy,\n                                int *callbackID,\n                                bool serverFilter)\n{\n    virObjectEventCallbackPtr cb;\n    int ret = -1;\n    int remoteID = -1;\n\n    VIR_DEBUG(\"conn=%p cblist=%p key=%p filter=%p filter_opaque=%p \"\n              \"klass=%p eventID=%d callback=%p opaque=%p \"\n              \"legacy=%d callbackID=%p serverFilter=%d\",\n              conn, cbList, key, filter, filter_opaque, klass, eventID,\n              callback, opaque, legacy, callbackID, serverFilter);\n\n    /* Check incoming */\n    if (!cbList)\n        return -1;\n\n    /* If there is no additional filtering, then check if we already\n     * have this callback on our list.  */\n    if (!filter &&\n        virObjectEventCallbackLookup(conn, cbList, key,\n                                     klass, eventID, callback, legacy,\n                                     serverFilter ? &remoteID : NULL) != -1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"event callback already tracked\"));\n        return -1;\n    }\n    /* Allocate new cb */\n    if (VIR_ALLOC(cb) < 0)\n        goto cleanup;\n    cb->conn = virObjectRef(conn);\n    *callbackID = cb->callbackID = cbList->nextID++;\n    cb->cb = callback;\n    cb->klass = klass;\n    cb->eventID = eventID;\n    cb->opaque = opaque;\n    cb->freecb = freecb;\n    cb->remoteID = remoteID;\n\n    if (key) {\n        cb->key_filter = true;\n        cb->key = g_strdup(key);\n    }\n    cb->filter = filter;\n    cb->filter_opaque = filter_opaque;\n    cb->legacy = legacy;\n\n    if (VIR_APPEND_ELEMENT(cbList->callbacks, cbList->count, cb) < 0)\n        goto cleanup;\n\n    /* When additional filtering is being done, every client callback\n     * is matched to exactly one server callback.  */\n    if (filter) {\n        ret = 1;\n    } else {\n        ret = virObjectEventCallbackListCount(conn, cbList, klass, eventID,\n                                              key, serverFilter);\n        if (serverFilter && remoteID < 0)\n            ret++;\n    }\n\n cleanup:\n    virObjectEventCallbackFree(cb);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListAddID(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                const char *key,\n                                virObjectEventCallbackFilter filter,\n                                void *filter_opaque,\n                                virClassPtr klass,\n                                int eventID,\n                                virConnectObjectEventGenericCallback callback,\n                                void *opaque,\n                                virFreeCallback freecb,\n                                bool legacy,\n                                int *callbackID,\n                                bool serverFilter)\n{\n    virObjectEventCallbackPtr cb;\n    int ret = -1;\n    int remoteID = -1;\n\n    VIR_DEBUG(\"conn=%p cblist=%p key=%p filter=%p filter_opaque=%p \"\n              \"klass=%p eventID=%d callback=%p opaque=%p \"\n              \"legacy=%d callbackID=%p serverFilter=%d\",\n              conn, cbList, key, filter, filter_opaque, klass, eventID,\n              callback, opaque, legacy, callbackID, serverFilter);\n\n    /* Check incoming */\n    if (!cbList)\n        return -1;\n\n    /* If there is no additional filtering, then check if we already\n     * have this callback on our list.  */\n    if (!filter &&\n        virObjectEventCallbackLookup(conn, cbList, key,\n                                     klass, eventID, callback, legacy,\n                                     serverFilter ? &remoteID : NULL) != -1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"event callback already tracked\"));\n        return -1;\n    }\n    /* Allocate new cb */\n    if (VIR_ALLOC(cb) < 0)\n        goto cleanup;\n    cb->conn = virObjectRef(conn);\n    *callbackID = cb->callbackID = cbList->nextID++;\n    cb->cb = callback;\n    cb->klass = klass;\n    cb->eventID = eventID;\n    cb->opaque = opaque;\n    cb->freecb = freecb;\n    cb->remoteID = remoteID;\n\n    if (key) {\n        cb->key_filter = true;\n        cb->key = g_strdup(key);\n    }\n    cb->filter = filter;\n    cb->filter_opaque = filter_opaque;\n    cb->legacy = legacy;\n\n    if (VIR_APPEND_ELEMENT(cbList->callbacks, cbList->count, cb) < 0)\n        goto cleanup;\n\n    /* When additional filtering is being done, every client callback\n     * is matched to exactly one server callback.  */\n    if (filter) {\n        ret = 1;\n    } else {\n        ret = virObjectEventCallbackListCount(conn, cbList, klass, eventID,\n                                              key, serverFilter);\n        if (serverFilter && remoteID < 0)\n            ret++;\n    }\n\n cleanup:\n    virObjectEventCallbackFree(cb);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "state"
          ],
          "line": 902
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"could not initialize domain event timer\")"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not initialize domain event timer\""
          ],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "333-366",
          "snippet": "static int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virEventAddTimeout",
          "args": [
            "-1",
            "virObjectEventTimer",
            "state",
            "virObjectFreeCallback"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "virEventAddTimeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "143-153",
          "snippet": "int\nvirEventAddTimeout(int timeout,\n                   virEventTimeoutCallback cb,\n                   void *opaque,\n                   virFreeCallback ff)\n{\n    if (!addTimeoutImpl)\n        return -1;\n\n    return addTimeoutImpl(timeout, cb, opaque, ff);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventAddTimeoutFunc addTimeoutImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventAddTimeoutFunc addTimeoutImpl;\n\nint\nvirEventAddTimeout(int timeout,\n                   virEventTimeoutCallback cb,\n                   void *opaque,\n                   virFreeCallback ff)\n{\n    if (!addTimeoutImpl)\n        return -1;\n\n    return addTimeoutImpl(timeout, cb, opaque, ff);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "state"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}"
  },
  {
    "function_name": "virObjectEventStateFlush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "799-833",
    "snippet": "static void\nvirObjectEventStateFlush(virObjectEventStatePtr state)\n{\n    virObjectEventQueue tempQueue;\n\n    /* We need to lock as well as ref due to the fact that we might\n     * unref the state we're working on in this very function */\n    virObjectRef(state);\n    virObjectLock(state);\n    state->isDispatching = true;\n\n    /* Copy the queue, so we're reentrant safe when dispatchFunc drops the\n     * driver lock */\n    tempQueue.count = state->queue->count;\n    tempQueue.events = state->queue->events;\n    state->queue->count = 0;\n    state->queue->events = NULL;\n    if (state->timer != -1)\n        virEventUpdateTimeout(state->timer, -1);\n\n    virObjectEventStateQueueDispatch(state,\n                                     &tempQueue,\n                                     state->callbacks);\n\n    /* Purge any deleted callbacks */\n    virObjectEventCallbackListPurgeMarked(state->callbacks);\n\n    /* If we purged all callbacks, we need to remove the timeout as\n     * well like virObjectEventStateDeregisterID() would do. */\n    virObjectEventStateCleanupTimer(state, true);\n\n    state->isDispatching = false;\n    virObjectUnlock(state);\n    virObjectUnref(state);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "state"
          ],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "state"
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateCleanupTimer",
          "args": [
            "state",
            "true"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateCleanupTimer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "780-796",
          "snippet": "static void\nvirObjectEventStateCleanupTimer(virObjectEventStatePtr state, bool clear_queue)\n{\n    /* There are still some callbacks, keep the timer. */\n    if (state->callbacks->count)\n        return;\n\n    /* The timer is not registered, nothing to do. */\n    if (state->timer == -1)\n        return;\n\n    virEventRemoveTimeout(state->timer);\n    state->timer = -1;\n\n    if (clear_queue)\n        virObjectEventQueueClear(state->queue);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventStateCleanupTimer(virObjectEventStatePtr state, bool clear_queue)\n{\n    /* There are still some callbacks, keep the timer. */\n    if (state->callbacks->count)\n        return;\n\n    /* The timer is not registered, nothing to do. */\n    if (state->timer == -1)\n        return;\n\n    virEventRemoveTimeout(state->timer);\n    state->timer = -1;\n\n    if (clear_queue)\n        virObjectEventQueueClear(state->queue);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackListPurgeMarked",
          "args": [
            "state->callbacks"
          ],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventCallbackListPurgeMarked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "296-312",
          "snippet": "static int\nvirObjectEventCallbackListPurgeMarked(virObjectEventCallbackListPtr cbList)\n{\n    size_t n;\n    for (n = 0; n < cbList->count; n++) {\n        if (cbList->callbacks[n]->deleted) {\n            virFreeCallback freecb = cbList->callbacks[n]->freecb;\n            if (freecb)\n                (*freecb)(cbList->callbacks[n]->opaque);\n            virObjectEventCallbackFree(cbList->callbacks[n]);\n\n            VIR_DELETE_ELEMENT(cbList->callbacks, n, cbList->count);\n            n--;\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListPurgeMarked(virObjectEventCallbackListPtr cbList)\n{\n    size_t n;\n    for (n = 0; n < cbList->count; n++) {\n        if (cbList->callbacks[n]->deleted) {\n            virFreeCallback freecb = cbList->callbacks[n]->freecb;\n            if (freecb)\n                (*freecb)(cbList->callbacks[n]->opaque);\n            virObjectEventCallbackFree(cbList->callbacks[n]);\n\n            VIR_DELETE_ELEMENT(cbList->callbacks, n, cbList->count);\n            n--;\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueueDispatch",
          "args": [
            "state",
            "&tempQueue",
            "state->callbacks"
          ],
          "line": 819
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueueDispatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "707-721",
          "snippet": "static void\nvirObjectEventStateQueueDispatch(virObjectEventStatePtr state,\n                                 virObjectEventQueuePtr queue,\n                                 virObjectEventCallbackListPtr callbacks)\n{\n    size_t i;\n\n    for (i = 0; i < queue->count; i++) {\n        virObjectEventStateDispatchCallbacks(state, queue->events[i],\n                                             callbacks);\n        virObjectUnref(queue->events[i]);\n    }\n    VIR_FREE(queue->events);\n    queue->count = 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventStateQueueDispatch(virObjectEventStatePtr state,\n                                 virObjectEventQueuePtr queue,\n                                 virObjectEventCallbackListPtr callbacks)\n{\n    size_t i;\n\n    for (i = 0; i < queue->count; i++) {\n        virObjectEventStateDispatchCallbacks(state, queue->events[i],\n                                             callbacks);\n        virObjectUnref(queue->events[i]);\n    }\n    VIR_FREE(queue->events);\n    queue->count = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virEventUpdateTimeout",
          "args": [
            "state->timer",
            "-1"
          ],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "virEventUpdateTimeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "170-175",
          "snippet": "void\nvirEventUpdateTimeout(int timer, int timeout)\n{\n    if (updateTimeoutImpl)\n        updateTimeoutImpl(timer, timeout);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventUpdateTimeoutFunc updateTimeoutImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventUpdateTimeoutFunc updateTimeoutImpl;\n\nvoid\nvirEventUpdateTimeout(int timer, int timeout)\n{\n    if (updateTimeoutImpl)\n        updateTimeoutImpl(timer, timeout);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "state"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "state"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventStateFlush(virObjectEventStatePtr state)\n{\n    virObjectEventQueue tempQueue;\n\n    /* We need to lock as well as ref due to the fact that we might\n     * unref the state we're working on in this very function */\n    virObjectRef(state);\n    virObjectLock(state);\n    state->isDispatching = true;\n\n    /* Copy the queue, so we're reentrant safe when dispatchFunc drops the\n     * driver lock */\n    tempQueue.count = state->queue->count;\n    tempQueue.events = state->queue->events;\n    state->queue->count = 0;\n    state->queue->events = NULL;\n    if (state->timer != -1)\n        virEventUpdateTimeout(state->timer, -1);\n\n    virObjectEventStateQueueDispatch(state,\n                                     &tempQueue,\n                                     state->callbacks);\n\n    /* Purge any deleted callbacks */\n    virObjectEventCallbackListPurgeMarked(state->callbacks);\n\n    /* If we purged all callbacks, we need to remove the timeout as\n     * well like virObjectEventStateDeregisterID() would do. */\n    virObjectEventStateCleanupTimer(state, true);\n\n    state->isDispatching = false;\n    virObjectUnlock(state);\n    virObjectUnref(state);\n}"
  },
  {
    "function_name": "virObjectEventStateCleanupTimer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "780-796",
    "snippet": "static void\nvirObjectEventStateCleanupTimer(virObjectEventStatePtr state, bool clear_queue)\n{\n    /* There are still some callbacks, keep the timer. */\n    if (state->callbacks->count)\n        return;\n\n    /* The timer is not registered, nothing to do. */\n    if (state->timer == -1)\n        return;\n\n    virEventRemoveTimeout(state->timer);\n    state->timer = -1;\n\n    if (clear_queue)\n        virObjectEventQueueClear(state->queue);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventQueueClear",
          "args": [
            "state->queue"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventQueueClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "472-483",
          "snippet": "static void\nvirObjectEventQueueClear(virObjectEventQueuePtr queue)\n{\n    size_t i;\n    if (!queue)\n        return;\n\n    for (i = 0; i < queue->count; i++)\n        virObjectUnref(queue->events[i]);\n    VIR_FREE(queue->events);\n    queue->count = 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void\nvirObjectEventQueueClear(virObjectEventQueuePtr queue)\n{\n    size_t i;\n    if (!queue)\n        return;\n\n    for (i = 0; i < queue->count; i++)\n        virObjectUnref(queue->events[i]);\n    VIR_FREE(queue->events);\n    queue->count = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virEventRemoveTimeout",
          "args": [
            "state->timer"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "virEventRemoveTimeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "188-195",
          "snippet": "int\nvirEventRemoveTimeout(int timer)\n{\n    if (!removeTimeoutImpl)\n        return -1;\n\n    return removeTimeoutImpl(timer);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventRemoveTimeoutFunc removeTimeoutImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventRemoveTimeoutFunc removeTimeoutImpl;\n\nint\nvirEventRemoveTimeout(int timer)\n{\n    if (!removeTimeoutImpl)\n        return -1;\n\n    return removeTimeoutImpl(timer);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventStateCleanupTimer(virObjectEventStatePtr state, bool clear_queue)\n{\n    /* There are still some callbacks, keep the timer. */\n    if (state->callbacks->count)\n        return;\n\n    /* The timer is not registered, nothing to do. */\n    if (state->timer == -1)\n        return;\n\n    virEventRemoveTimeout(state->timer);\n    state->timer = -1;\n\n    if (clear_queue)\n        virObjectEventQueueClear(state->queue);\n}"
  },
  {
    "function_name": "virObjectEventStateQueue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "772-777",
    "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateQueueRemote",
          "args": [
            "state",
            "event",
            "-1"
          ],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueueRemote",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "736-760",
          "snippet": "void\nvirObjectEventStateQueueRemote(virObjectEventStatePtr state,\n                               virObjectEventPtr event,\n                               int remoteID)\n{\n    if (!event)\n        return;\n\n    if (state->timer < 0) {\n        virObjectUnref(event);\n        return;\n    }\n\n    virObjectLock(state);\n\n    event->remoteID = remoteID;\n    if (virObjectEventQueuePush(state->queue, event) < 0) {\n        VIR_DEBUG(\"Error adding event to queue\");\n        virObjectUnref(event);\n    }\n\n    if (state->queue->count == 1)\n        virEventUpdateTimeout(state->timer, 0);\n    virObjectUnlock(state);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueueRemote(virObjectEventStatePtr state,\n                               virObjectEventPtr event,\n                               int remoteID)\n{\n    if (!event)\n        return;\n\n    if (state->timer < 0) {\n        virObjectUnref(event);\n        return;\n    }\n\n    virObjectLock(state);\n\n    event->remoteID = remoteID;\n    if (virObjectEventQueuePush(state->queue, event) < 0) {\n        VIR_DEBUG(\"Error adding event to queue\");\n        virObjectUnref(event);\n    }\n\n    if (state->queue->count == 1)\n        virEventUpdateTimeout(state->timer, 0);\n    virObjectUnlock(state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
  },
  {
    "function_name": "virObjectEventStateQueueRemote",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "736-760",
    "snippet": "void\nvirObjectEventStateQueueRemote(virObjectEventStatePtr state,\n                               virObjectEventPtr event,\n                               int remoteID)\n{\n    if (!event)\n        return;\n\n    if (state->timer < 0) {\n        virObjectUnref(event);\n        return;\n    }\n\n    virObjectLock(state);\n\n    event->remoteID = remoteID;\n    if (virObjectEventQueuePush(state->queue, event) < 0) {\n        VIR_DEBUG(\"Error adding event to queue\");\n        virObjectUnref(event);\n    }\n\n    if (state->queue->count == 1)\n        virEventUpdateTimeout(state->timer, 0);\n    virObjectUnlock(state);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "state"
          ],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virEventUpdateTimeout",
          "args": [
            "state->timer",
            "0"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "virEventUpdateTimeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "170-175",
          "snippet": "void\nvirEventUpdateTimeout(int timer, int timeout)\n{\n    if (updateTimeoutImpl)\n        updateTimeoutImpl(timer, timeout);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventUpdateTimeoutFunc updateTimeoutImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventUpdateTimeoutFunc updateTimeoutImpl;\n\nvoid\nvirEventUpdateTimeout(int timer, int timeout)\n{\n    if (updateTimeoutImpl)\n        updateTimeoutImpl(timer, timeout);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "event"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Error adding event to queue\""
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectEventQueuePush",
          "args": [
            "state->queue",
            "event"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventQueuePush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "645-655",
          "snippet": "static int\nvirObjectEventQueuePush(virObjectEventQueuePtr evtQueue,\n                        virObjectEventPtr event)\n{\n    if (!evtQueue)\n        return -1;\n\n    if (VIR_APPEND_ELEMENT(evtQueue->events, evtQueue->count, event) < 0)\n        return -1;\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventQueuePush(virObjectEventQueuePtr evtQueue,\n                        virObjectEventPtr event)\n{\n    if (!evtQueue)\n        return -1;\n\n    if (VIR_APPEND_ELEMENT(evtQueue->events, evtQueue->count, event) < 0)\n        return -1;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "state"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueueRemote(virObjectEventStatePtr state,\n                               virObjectEventPtr event,\n                               int remoteID)\n{\n    if (!event)\n        return;\n\n    if (state->timer < 0) {\n        virObjectUnref(event);\n        return;\n    }\n\n    virObjectLock(state);\n\n    event->remoteID = remoteID;\n    if (virObjectEventQueuePush(state->queue, event) < 0) {\n        VIR_DEBUG(\"Error adding event to queue\");\n        virObjectUnref(event);\n    }\n\n    if (state->queue->count == 1)\n        virEventUpdateTimeout(state->timer, 0);\n    virObjectUnlock(state);\n}"
  },
  {
    "function_name": "virObjectEventStateQueueDispatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "707-721",
    "snippet": "static void\nvirObjectEventStateQueueDispatch(virObjectEventStatePtr state,\n                                 virObjectEventQueuePtr queue,\n                                 virObjectEventCallbackListPtr callbacks)\n{\n    size_t i;\n\n    for (i = 0; i < queue->count; i++) {\n        virObjectEventStateDispatchCallbacks(state, queue->events[i],\n                                             callbacks);\n        virObjectUnref(queue->events[i]);\n    }\n    VIR_FREE(queue->events);\n    queue->count = 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "queue->events"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "queue->events[i]"
          ],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateDispatchCallbacks",
          "args": [
            "state",
            "queue->events[i]",
            "callbacks"
          ],
          "line": 715
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateDispatchCallbacks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "682-704",
          "snippet": "static void\nvirObjectEventStateDispatchCallbacks(virObjectEventStatePtr state,\n                                     virObjectEventPtr event,\n                                     virObjectEventCallbackListPtr callbacks)\n{\n    size_t i;\n    /* Cache this now, since we may be dropping the lock,\n       and have more callbacks added. We're guaranteed not\n       to have any removed */\n    size_t cbCount = callbacks->count;\n\n    for (i = 0; i < cbCount; i++) {\n        virObjectEventCallbackPtr cb = callbacks->callbacks[i];\n\n        if (!virObjectEventDispatchMatchCallback(event, cb))\n            continue;\n\n        /* Drop the lock while dispatching, for sake of re-entrance */\n        virObjectUnlock(state);\n        event->dispatch(cb->conn, event, cb->cb, cb->opaque);\n        virObjectLock(state);\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventStateDispatchCallbacks(virObjectEventStatePtr state,\n                                     virObjectEventPtr event,\n                                     virObjectEventCallbackListPtr callbacks)\n{\n    size_t i;\n    /* Cache this now, since we may be dropping the lock,\n       and have more callbacks added. We're guaranteed not\n       to have any removed */\n    size_t cbCount = callbacks->count;\n\n    for (i = 0; i < cbCount; i++) {\n        virObjectEventCallbackPtr cb = callbacks->callbacks[i];\n\n        if (!virObjectEventDispatchMatchCallback(event, cb))\n            continue;\n\n        /* Drop the lock while dispatching, for sake of re-entrance */\n        virObjectUnlock(state);\n        event->dispatch(cb->conn, event, cb->cb, cb->opaque);\n        virObjectLock(state);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventStateQueueDispatch(virObjectEventStatePtr state,\n                                 virObjectEventQueuePtr queue,\n                                 virObjectEventCallbackListPtr callbacks)\n{\n    size_t i;\n\n    for (i = 0; i < queue->count; i++) {\n        virObjectEventStateDispatchCallbacks(state, queue->events[i],\n                                             callbacks);\n        virObjectUnref(queue->events[i]);\n    }\n    VIR_FREE(queue->events);\n    queue->count = 0;\n}"
  },
  {
    "function_name": "virObjectEventStateDispatchCallbacks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "682-704",
    "snippet": "static void\nvirObjectEventStateDispatchCallbacks(virObjectEventStatePtr state,\n                                     virObjectEventPtr event,\n                                     virObjectEventCallbackListPtr callbacks)\n{\n    size_t i;\n    /* Cache this now, since we may be dropping the lock,\n       and have more callbacks added. We're guaranteed not\n       to have any removed */\n    size_t cbCount = callbacks->count;\n\n    for (i = 0; i < cbCount; i++) {\n        virObjectEventCallbackPtr cb = callbacks->callbacks[i];\n\n        if (!virObjectEventDispatchMatchCallback(event, cb))\n            continue;\n\n        /* Drop the lock while dispatching, for sake of re-entrance */\n        virObjectUnlock(state);\n        event->dispatch(cb->conn, event, cb->cb, cb->opaque);\n        virObjectLock(state);\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "state"
          ],
          "line": 702
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "event->dispatch",
          "args": [
            "cb->conn",
            "event",
            "cb->cb",
            "cb->opaque"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "state"
          ],
          "line": 700
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventDispatchMatchCallback",
          "args": [
            "event",
            "cb"
          ],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventDispatchMatchCallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "658-679",
          "snippet": "static bool\nvirObjectEventDispatchMatchCallback(virObjectEventPtr event,\n                                    virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return false;\n    if (cb->deleted)\n        return false;\n    if (!virObjectIsClass(event, cb->klass))\n        return false;\n    if (cb->eventID != event->eventID)\n        return false;\n    if (cb->remoteID != event->remoteID)\n        return false;\n\n    if (cb->filter && !(cb->filter)(cb->conn, event, cb->filter_opaque))\n        return false;\n\n    if (cb->key_filter)\n        return STREQ(event->meta.key, cb->key);\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic bool\nvirObjectEventDispatchMatchCallback(virObjectEventPtr event,\n                                    virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return false;\n    if (cb->deleted)\n        return false;\n    if (!virObjectIsClass(event, cb->klass))\n        return false;\n    if (cb->eventID != event->eventID)\n        return false;\n    if (cb->remoteID != event->remoteID)\n        return false;\n\n    if (cb->filter && !(cb->filter)(cb->conn, event, cb->filter_opaque))\n        return false;\n\n    if (cb->key_filter)\n        return STREQ(event->meta.key, cb->key);\n    return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventStateDispatchCallbacks(virObjectEventStatePtr state,\n                                     virObjectEventPtr event,\n                                     virObjectEventCallbackListPtr callbacks)\n{\n    size_t i;\n    /* Cache this now, since we may be dropping the lock,\n       and have more callbacks added. We're guaranteed not\n       to have any removed */\n    size_t cbCount = callbacks->count;\n\n    for (i = 0; i < cbCount; i++) {\n        virObjectEventCallbackPtr cb = callbacks->callbacks[i];\n\n        if (!virObjectEventDispatchMatchCallback(event, cb))\n            continue;\n\n        /* Drop the lock while dispatching, for sake of re-entrance */\n        virObjectUnlock(state);\n        event->dispatch(cb->conn, event, cb->cb, cb->opaque);\n        virObjectLock(state);\n    }\n}"
  },
  {
    "function_name": "virObjectEventDispatchMatchCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "658-679",
    "snippet": "static bool\nvirObjectEventDispatchMatchCallback(virObjectEventPtr event,\n                                    virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return false;\n    if (cb->deleted)\n        return false;\n    if (!virObjectIsClass(event, cb->klass))\n        return false;\n    if (cb->eventID != event->eventID)\n        return false;\n    if (cb->remoteID != event->remoteID)\n        return false;\n\n    if (cb->filter && !(cb->filter)(cb->conn, event, cb->filter_opaque))\n        return false;\n\n    if (cb->key_filter)\n        return STREQ(event->meta.key, cb->key);\n    return true;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "event->meta.key",
            "cb->key"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "cb->conn",
            "event",
            "cb->filter_opaque"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectIsClass",
          "args": [
            "event",
            "cb->klass"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectIsClass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "542-551",
          "snippet": "bool\nvirObjectIsClass(void *anyobj,\n                 virClassPtr klass)\n{\n    virObjectPtr obj = anyobj;\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    return virClassIsDerivedFrom(obj->klass, klass);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectIsClass(void *anyobj,\n                 virClassPtr klass)\n{\n    virObjectPtr obj = anyobj;\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    return virClassIsDerivedFrom(obj->klass, klass);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic bool\nvirObjectEventDispatchMatchCallback(virObjectEventPtr event,\n                                    virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return false;\n    if (cb->deleted)\n        return false;\n    if (!virObjectIsClass(event, cb->klass))\n        return false;\n    if (cb->eventID != event->eventID)\n        return false;\n    if (cb->remoteID != event->remoteID)\n        return false;\n\n    if (cb->filter && !(cb->filter)(cb->conn, event, cb->filter_opaque))\n        return false;\n\n    if (cb->key_filter)\n        return STREQ(event->meta.key, cb->key);\n    return true;\n}"
  },
  {
    "function_name": "virObjectEventQueuePush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "645-655",
    "snippet": "static int\nvirObjectEventQueuePush(virObjectEventQueuePtr evtQueue,\n                        virObjectEventPtr event)\n{\n    if (!evtQueue)\n        return -1;\n\n    if (VIR_APPEND_ELEMENT(evtQueue->events, evtQueue->count, event) < 0)\n        return -1;\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "evtQueue->events",
            "evtQueue->count",
            "event"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventQueuePush(virObjectEventQueuePtr evtQueue,\n                        virObjectEventPtr event)\n{\n    if (!evtQueue)\n        return -1;\n\n    if (VIR_APPEND_ELEMENT(evtQueue->events, evtQueue->count, event) < 0)\n        return -1;\n    return 0;\n}"
  },
  {
    "function_name": "virObjectEventNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "597-633",
    "snippet": "void *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virObjectEventClass;",
      "static void virObjectEventDispose(void *obj);",
      "static void virObjectEventStateDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "event"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "event->meta.uuid",
            "uuid",
            "VIR_UUID_BUFLEN"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "key"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectNew",
          "args": [
            "klass"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "236-253",
          "snippet": "void *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "klass",
            "_(\"Class %s must derive from virObjectEvent\")",
            "virClassName(klass)"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassName",
          "args": [
            "klass"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "virClassName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "560-564",
          "snippet": "const char *\nvirClassName(virClassPtr klass)\n{\n    return klass->name;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nconst char *\nvirClassName(virClassPtr klass)\n{\n    return klass->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Class %s must derive from virObjectEvent\""
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "333-366",
          "snippet": "static int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virClassIsDerivedFrom",
          "args": [
            "klass",
            "virObjectEventClass"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "virClassIsDerivedFrom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "211-221",
          "snippet": "bool\nvirClassIsDerivedFrom(virClassPtr klass,\n                      virClassPtr parent)\n{\n    while (klass) {\n        if (klass->magic == parent->magic)\n            return true;\n        klass = klass->parent;\n    }\n    return false;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nbool\nvirClassIsDerivedFrom(virClassPtr klass,\n                      virClassPtr parent)\n{\n    while (klass) {\n        if (klass->magic == parent->magic)\n            return true;\n        klass = klass->parent;\n    }\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventInitialize",
          "args": [],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\nstatic void virObjectEventDispose(void *obj);\nstatic void virObjectEventStateDispose(void *obj);\n\nvoid *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}"
  },
  {
    "function_name": "virObjectEventStateNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "558-582",
    "snippet": "virObjectEventStatePtr\nvirObjectEventStateNew(void)\n{\n    virObjectEventStatePtr state = NULL;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!(state = virObjectLockableNew(virObjectEventStateClass)))\n        return NULL;\n\n    if (VIR_ALLOC(state->callbacks) < 0)\n        goto error;\n\n    if (!(state->queue = virObjectEventQueueNew()))\n        goto error;\n\n    state->timer = -1;\n\n    return state;\n\n error:\n    virObjectUnref(state);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virObjectEventStateClass;",
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "state"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventQueueNew",
          "args": [],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventQueueNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "501-508",
          "snippet": "static virObjectEventQueuePtr\nvirObjectEventQueueNew(void)\n{\n    virObjectEventQueuePtr ret;\n\n    ignore_value(VIR_ALLOC(ret));\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virObjectEventQueuePtr\nvirObjectEventQueueNew(void)\n{\n    virObjectEventQueuePtr ret;\n\n    ignore_value(VIR_ALLOC(ret));\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "state->callbacks"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virObjectEventStateClass"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventInitialize",
          "args": [],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventStateClass;\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvirObjectEventStatePtr\nvirObjectEventStateNew(void)\n{\n    virObjectEventStatePtr state = NULL;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!(state = virObjectLockableNew(virObjectEventStateClass)))\n        return NULL;\n\n    if (VIR_ALLOC(state->callbacks) < 0)\n        goto error;\n\n    if (!(state->queue = virObjectEventQueueNew()))\n        goto error;\n\n    state->timer = -1;\n\n    return state;\n\n error:\n    virObjectUnref(state);\n    return NULL;\n}"
  },
  {
    "function_name": "virObjectEventTimer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "544-550",
    "snippet": "static void\nvirObjectEventTimer(int timer G_GNUC_UNUSED, void *opaque)\n{\n    virObjectEventStatePtr state = opaque;\n\n    virObjectEventStateFlush(state);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateFlush",
          "args": [
            "state"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateFlush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "799-833",
          "snippet": "static void\nvirObjectEventStateFlush(virObjectEventStatePtr state)\n{\n    virObjectEventQueue tempQueue;\n\n    /* We need to lock as well as ref due to the fact that we might\n     * unref the state we're working on in this very function */\n    virObjectRef(state);\n    virObjectLock(state);\n    state->isDispatching = true;\n\n    /* Copy the queue, so we're reentrant safe when dispatchFunc drops the\n     * driver lock */\n    tempQueue.count = state->queue->count;\n    tempQueue.events = state->queue->events;\n    state->queue->count = 0;\n    state->queue->events = NULL;\n    if (state->timer != -1)\n        virEventUpdateTimeout(state->timer, -1);\n\n    virObjectEventStateQueueDispatch(state,\n                                     &tempQueue,\n                                     state->callbacks);\n\n    /* Purge any deleted callbacks */\n    virObjectEventCallbackListPurgeMarked(state->callbacks);\n\n    /* If we purged all callbacks, we need to remove the timeout as\n     * well like virObjectEventStateDeregisterID() would do. */\n    virObjectEventStateCleanupTimer(state, true);\n\n    state->isDispatching = false;\n    virObjectUnlock(state);\n    virObjectUnref(state);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventStateFlush(virObjectEventStatePtr state)\n{\n    virObjectEventQueue tempQueue;\n\n    /* We need to lock as well as ref due to the fact that we might\n     * unref the state we're working on in this very function */\n    virObjectRef(state);\n    virObjectLock(state);\n    state->isDispatching = true;\n\n    /* Copy the queue, so we're reentrant safe when dispatchFunc drops the\n     * driver lock */\n    tempQueue.count = state->queue->count;\n    tempQueue.events = state->queue->events;\n    state->queue->count = 0;\n    state->queue->events = NULL;\n    if (state->timer != -1)\n        virEventUpdateTimeout(state->timer, -1);\n\n    virObjectEventStateQueueDispatch(state,\n                                     &tempQueue,\n                                     state->callbacks);\n\n    /* Purge any deleted callbacks */\n    virObjectEventCallbackListPurgeMarked(state->callbacks);\n\n    /* If we purged all callbacks, we need to remove the timeout as\n     * well like virObjectEventStateDeregisterID() would do. */\n    virObjectEventStateCleanupTimer(state, true);\n\n    state->isDispatching = false;\n    virObjectUnlock(state);\n    virObjectUnref(state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventTimer(int timer G_GNUC_UNUSED, void *opaque)\n{\n    virObjectEventStatePtr state = opaque;\n\n    virObjectEventStateFlush(state);\n}"
  },
  {
    "function_name": "virObjectEventStateDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "517-529",
    "snippet": "static void\nvirObjectEventStateDispose(void *obj)\n{\n    virObjectEventStatePtr state = obj;\n\n    VIR_DEBUG(\"obj=%p\", state);\n\n    virObjectEventCallbackListFree(state->callbacks);\n    virObjectEventQueueFree(state->queue);\n\n    if (state->timer != -1)\n        virEventRemoveTimeout(state->timer);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventDispose(void *obj);",
      "static void virObjectEventStateDispose(void *obj);",
      "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virEventRemoveTimeout",
          "args": [
            "state->timer"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "virEventRemoveTimeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virevent.c",
          "lines": "188-195",
          "snippet": "int\nvirEventRemoveTimeout(int timer)\n{\n    if (!removeTimeoutImpl)\n        return -1;\n\n    return removeTimeoutImpl(timer);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vireventglib.h\"",
            "#include \"virevent.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virEventRemoveTimeoutFunc removeTimeoutImpl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vireventglib.h\"\n#include \"virevent.h\"\n#include <config.h>\n\nstatic virEventRemoveTimeoutFunc removeTimeoutImpl;\n\nint\nvirEventRemoveTimeout(int timer)\n{\n    if (!removeTimeoutImpl)\n        return -1;\n\n    return removeTimeoutImpl(timer);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventQueueFree",
          "args": [
            "state->queue"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventQueueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "491-499",
          "snippet": "static void\nvirObjectEventQueueFree(virObjectEventQueuePtr queue)\n{\n    if (!queue)\n        return;\n\n    virObjectEventQueueClear(queue);\n    VIR_FREE(queue);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void\nvirObjectEventQueueFree(virObjectEventQueuePtr queue)\n{\n    if (!queue)\n        return;\n\n    virObjectEventQueueClear(queue);\n    VIR_FREE(queue);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackListFree",
          "args": [
            "state->callbacks"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventCallbackListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "153-168",
          "snippet": "static void\nvirObjectEventCallbackListFree(virObjectEventCallbackListPtr list)\n{\n    size_t i;\n    if (!list)\n        return;\n\n    for (i = 0; i < list->count; i++) {\n        virFreeCallback freecb = list->callbacks[i]->freecb;\n        if (freecb)\n            (*freecb)(list->callbacks[i]->opaque);\n        VIR_FREE(list->callbacks[i]);\n    }\n    VIR_FREE(list->callbacks);\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void\nvirObjectEventCallbackListFree(virObjectEventCallbackListPtr list)\n{\n    size_t i;\n    if (!list)\n        return;\n\n    for (i = 0; i < list->count; i++) {\n        virFreeCallback freecb = list->callbacks[i]->freecb;\n        if (freecb)\n            (*freecb)(list->callbacks[i]->opaque);\n        VIR_FREE(list->callbacks[i]);\n    }\n    VIR_FREE(list->callbacks);\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "state"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventDispose(void *obj);\nstatic void virObjectEventStateDispose(void *obj);\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nstatic void\nvirObjectEventStateDispose(void *obj)\n{\n    virObjectEventStatePtr state = obj;\n\n    VIR_DEBUG(\"obj=%p\", state);\n\n    virObjectEventCallbackListFree(state->callbacks);\n    virObjectEventQueueFree(state->queue);\n\n    if (state->timer != -1)\n        virEventRemoveTimeout(state->timer);\n}"
  },
  {
    "function_name": "virObjectEventQueueNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "501-508",
    "snippet": "static virObjectEventQueuePtr\nvirObjectEventQueueNew(void)\n{\n    virObjectEventQueuePtr ret;\n\n    ignore_value(VIR_ALLOC(ret));\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "VIR_ALLOC(ret)"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virObjectEventQueuePtr\nvirObjectEventQueueNew(void)\n{\n    virObjectEventQueuePtr ret;\n\n    ignore_value(VIR_ALLOC(ret));\n    return ret;\n}"
  },
  {
    "function_name": "virObjectEventQueueFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "491-499",
    "snippet": "static void\nvirObjectEventQueueFree(virObjectEventQueuePtr queue)\n{\n    if (!queue)\n        return;\n\n    virObjectEventQueueClear(queue);\n    VIR_FREE(queue);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "queue"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectEventQueueClear",
          "args": [
            "queue"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventQueueClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "472-483",
          "snippet": "static void\nvirObjectEventQueueClear(virObjectEventQueuePtr queue)\n{\n    size_t i;\n    if (!queue)\n        return;\n\n    for (i = 0; i < queue->count; i++)\n        virObjectUnref(queue->events[i]);\n    VIR_FREE(queue->events);\n    queue->count = 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void\nvirObjectEventQueueClear(virObjectEventQueuePtr queue)\n{\n    size_t i;\n    if (!queue)\n        return;\n\n    for (i = 0; i < queue->count; i++)\n        virObjectUnref(queue->events[i]);\n    VIR_FREE(queue->events);\n    queue->count = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void\nvirObjectEventQueueFree(virObjectEventQueuePtr queue)\n{\n    if (!queue)\n        return;\n\n    virObjectEventQueueClear(queue);\n    VIR_FREE(queue);\n}"
  },
  {
    "function_name": "virObjectEventQueueClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "472-483",
    "snippet": "static void\nvirObjectEventQueueClear(virObjectEventQueuePtr queue)\n{\n    size_t i;\n    if (!queue)\n        return;\n\n    for (i = 0; i < queue->count; i++)\n        virObjectUnref(queue->events[i]);\n    VIR_FREE(queue->events);\n    queue->count = 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "queue->events"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "queue->events[i]"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void\nvirObjectEventQueueClear(virObjectEventQueuePtr queue)\n{\n    size_t i;\n    if (!queue)\n        return;\n\n    for (i = 0; i < queue->count; i++)\n        virObjectUnref(queue->events[i]);\n    VIR_FREE(queue->events);\n    queue->count = 0;\n}"
  },
  {
    "function_name": "virObjectEventCallbackListAddID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "387-463",
    "snippet": "static int\nvirObjectEventCallbackListAddID(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                const char *key,\n                                virObjectEventCallbackFilter filter,\n                                void *filter_opaque,\n                                virClassPtr klass,\n                                int eventID,\n                                virConnectObjectEventGenericCallback callback,\n                                void *opaque,\n                                virFreeCallback freecb,\n                                bool legacy,\n                                int *callbackID,\n                                bool serverFilter)\n{\n    virObjectEventCallbackPtr cb;\n    int ret = -1;\n    int remoteID = -1;\n\n    VIR_DEBUG(\"conn=%p cblist=%p key=%p filter=%p filter_opaque=%p \"\n              \"klass=%p eventID=%d callback=%p opaque=%p \"\n              \"legacy=%d callbackID=%p serverFilter=%d\",\n              conn, cbList, key, filter, filter_opaque, klass, eventID,\n              callback, opaque, legacy, callbackID, serverFilter);\n\n    /* Check incoming */\n    if (!cbList)\n        return -1;\n\n    /* If there is no additional filtering, then check if we already\n     * have this callback on our list.  */\n    if (!filter &&\n        virObjectEventCallbackLookup(conn, cbList, key,\n                                     klass, eventID, callback, legacy,\n                                     serverFilter ? &remoteID : NULL) != -1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"event callback already tracked\"));\n        return -1;\n    }\n    /* Allocate new cb */\n    if (VIR_ALLOC(cb) < 0)\n        goto cleanup;\n    cb->conn = virObjectRef(conn);\n    *callbackID = cb->callbackID = cbList->nextID++;\n    cb->cb = callback;\n    cb->klass = klass;\n    cb->eventID = eventID;\n    cb->opaque = opaque;\n    cb->freecb = freecb;\n    cb->remoteID = remoteID;\n\n    if (key) {\n        cb->key_filter = true;\n        cb->key = g_strdup(key);\n    }\n    cb->filter = filter;\n    cb->filter_opaque = filter_opaque;\n    cb->legacy = legacy;\n\n    if (VIR_APPEND_ELEMENT(cbList->callbacks, cbList->count, cb) < 0)\n        goto cleanup;\n\n    /* When additional filtering is being done, every client callback\n     * is matched to exactly one server callback.  */\n    if (filter) {\n        ret = 1;\n    } else {\n        ret = virObjectEventCallbackListCount(conn, cbList, klass, eventID,\n                                              key, serverFilter);\n        if (serverFilter && remoteID < 0)\n            ret++;\n    }\n\n cleanup:\n    virObjectEventCallbackFree(cb);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventCallbackFree",
          "args": [
            "cb"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventCallbackFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "136-145",
          "snippet": "static void\nvirObjectEventCallbackFree(virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return;\n\n    virObjectUnref(cb->conn);\n    VIR_FREE(cb->key);\n    VIR_FREE(cb);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void\nvirObjectEventCallbackFree(virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return;\n\n    virObjectUnref(cb->conn);\n    VIR_FREE(cb->key);\n    VIR_FREE(cb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackListCount",
          "args": [
            "conn",
            "cbList",
            "klass",
            "eventID",
            "key",
            "serverFilter"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventCallbackListCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "193-220",
          "snippet": "static int\nvirObjectEventCallbackListCount(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                virClassPtr klass,\n                                int eventID,\n                                const char *key,\n                                bool serverFilter)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->filter)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            !cb->deleted &&\n            (!serverFilter ||\n             (cb->remoteID >= 0 &&\n              ((key && cb->key_filter && STREQ(cb->key, key)) ||\n               (!key && !cb->key_filter)))))\n            ret++;\n    }\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListCount(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                virClassPtr klass,\n                                int eventID,\n                                const char *key,\n                                bool serverFilter)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->filter)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            !cb->deleted &&\n            (!serverFilter ||\n             (cb->remoteID >= 0 &&\n              ((key && cb->key_filter && STREQ(cb->key, key)) ||\n               (!key && !cb->key_filter)))))\n            ret++;\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "cbList->callbacks",
            "cbList->count",
            "cb"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "key"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "conn"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "cb"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"event callback already tracked\")"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"event callback already tracked\""
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "333-366",
          "snippet": "static int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackLookup",
          "args": [
            "conn",
            "cbList",
            "key",
            "klass",
            "eventID",
            "callback",
            "legacy",
            "serverFilter ? &remoteID : NULL"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p cblist=%p key=%p filter=%p filter_opaque=%p \"\n              \"klass=%p eventID=%d callback=%p opaque=%p \"\n              \"legacy=%d callbackID=%p serverFilter=%d\"",
            "conn",
            "cbList",
            "key",
            "filter",
            "filter_opaque",
            "klass",
            "eventID",
            "callback",
            "opaque",
            "legacy",
            "callbackID",
            "serverFilter"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListAddID(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                const char *key,\n                                virObjectEventCallbackFilter filter,\n                                void *filter_opaque,\n                                virClassPtr klass,\n                                int eventID,\n                                virConnectObjectEventGenericCallback callback,\n                                void *opaque,\n                                virFreeCallback freecb,\n                                bool legacy,\n                                int *callbackID,\n                                bool serverFilter)\n{\n    virObjectEventCallbackPtr cb;\n    int ret = -1;\n    int remoteID = -1;\n\n    VIR_DEBUG(\"conn=%p cblist=%p key=%p filter=%p filter_opaque=%p \"\n              \"klass=%p eventID=%d callback=%p opaque=%p \"\n              \"legacy=%d callbackID=%p serverFilter=%d\",\n              conn, cbList, key, filter, filter_opaque, klass, eventID,\n              callback, opaque, legacy, callbackID, serverFilter);\n\n    /* Check incoming */\n    if (!cbList)\n        return -1;\n\n    /* If there is no additional filtering, then check if we already\n     * have this callback on our list.  */\n    if (!filter &&\n        virObjectEventCallbackLookup(conn, cbList, key,\n                                     klass, eventID, callback, legacy,\n                                     serverFilter ? &remoteID : NULL) != -1) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"event callback already tracked\"));\n        return -1;\n    }\n    /* Allocate new cb */\n    if (VIR_ALLOC(cb) < 0)\n        goto cleanup;\n    cb->conn = virObjectRef(conn);\n    *callbackID = cb->callbackID = cbList->nextID++;\n    cb->cb = callback;\n    cb->klass = klass;\n    cb->eventID = eventID;\n    cb->opaque = opaque;\n    cb->freecb = freecb;\n    cb->remoteID = remoteID;\n\n    if (key) {\n        cb->key_filter = true;\n        cb->key = g_strdup(key);\n    }\n    cb->filter = filter;\n    cb->filter_opaque = filter_opaque;\n    cb->legacy = legacy;\n\n    if (VIR_APPEND_ELEMENT(cbList->callbacks, cbList->count, cb) < 0)\n        goto cleanup;\n\n    /* When additional filtering is being done, every client callback\n     * is matched to exactly one server callback.  */\n    if (filter) {\n        ret = 1;\n    } else {\n        ret = virObjectEventCallbackListCount(conn, cbList, klass, eventID,\n                                              key, serverFilter);\n        if (serverFilter && remoteID < 0)\n            ret++;\n    }\n\n cleanup:\n    virObjectEventCallbackFree(cb);\n    return ret;\n}"
  },
  {
    "function_name": "ATTRIBUTE_NONNULL",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "333-366",
    "snippet": "static int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "cb->key",
            "key"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackLookup",
          "args": [
            "virConnectPtrconn",
            "virObjectEventCallbackListPtrcbList",
            "const char *key",
            "virClassPtrklass",
            "inteventID",
            "virConnectObjectEventGenericCallbackcallback",
            "boollegacy",
            "int *remoteID"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ATTRIBUTE_NONNULL",
          "args": [
            "2"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "333-366",
          "snippet": "static int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virObjectEventCallbackListPurgeMarked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "296-312",
    "snippet": "static int\nvirObjectEventCallbackListPurgeMarked(virObjectEventCallbackListPtr cbList)\n{\n    size_t n;\n    for (n = 0; n < cbList->count; n++) {\n        if (cbList->callbacks[n]->deleted) {\n            virFreeCallback freecb = cbList->callbacks[n]->freecb;\n            if (freecb)\n                (*freecb)(cbList->callbacks[n]->opaque);\n            virObjectEventCallbackFree(cbList->callbacks[n]);\n\n            VIR_DELETE_ELEMENT(cbList->callbacks, n, cbList->count);\n            n--;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "cbList->callbacks",
            "n",
            "cbList->count"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackFree",
          "args": [
            "cbList->callbacks[n]"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventCallbackFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "136-145",
          "snippet": "static void\nvirObjectEventCallbackFree(virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return;\n\n    virObjectUnref(cb->conn);\n    VIR_FREE(cb->key);\n    VIR_FREE(cb);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void\nvirObjectEventCallbackFree(virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return;\n\n    virObjectUnref(cb->conn);\n    VIR_FREE(cb->key);\n    VIR_FREE(cb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "cbList->callbacks[n]->opaque"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListPurgeMarked(virObjectEventCallbackListPtr cbList)\n{\n    size_t n;\n    for (n = 0; n < cbList->count; n++) {\n        if (cbList->callbacks[n]->deleted) {\n            virFreeCallback freecb = cbList->callbacks[n]->freecb;\n            if (freecb)\n                (*freecb)(cbList->callbacks[n]->opaque);\n            virObjectEventCallbackFree(cbList->callbacks[n]);\n\n            VIR_DELETE_ELEMENT(cbList->callbacks, n, cbList->count);\n            n--;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virObjectEventCallbackListMarkDeleteID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "269-293",
    "snippet": "static int\nvirObjectEventCallbackListMarkDeleteID(virConnectPtr conn,\n                                       virObjectEventCallbackListPtr cbList,\n                                       int callbackID)\n{\n    size_t i;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            cb->deleted = true;\n            return cb->filter ? 0 :\n                virObjectEventCallbackListCount(conn, cbList, cb->klass,\n                                                cb->eventID,\n                                                cb->key_filter ? cb->key : NULL,\n                                                cb->remoteID >= 0);\n        }\n    }\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"could not find event callback %d for deletion\"),\n                   callbackID);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"could not find event callback %d for deletion\")",
            "callbackID"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not find event callback %d for deletion\""
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "333-366",
          "snippet": "static int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackListCount",
          "args": [
            "conn",
            "cbList",
            "cb->klass",
            "cb->eventID",
            "cb->key_filter ? cb->key : NULL",
            "cb->remoteID >= 0"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventCallbackListCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "193-220",
          "snippet": "static int\nvirObjectEventCallbackListCount(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                virClassPtr klass,\n                                int eventID,\n                                const char *key,\n                                bool serverFilter)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->filter)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            !cb->deleted &&\n            (!serverFilter ||\n             (cb->remoteID >= 0 &&\n              ((key && cb->key_filter && STREQ(cb->key, key)) ||\n               (!key && !cb->key_filter)))))\n            ret++;\n    }\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListCount(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                virClassPtr klass,\n                                int eventID,\n                                const char *key,\n                                bool serverFilter)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->filter)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            !cb->deleted &&\n            (!serverFilter ||\n             (cb->remoteID >= 0 &&\n              ((key && cb->key_filter && STREQ(cb->key, key)) ||\n               (!key && !cb->key_filter)))))\n            ret++;\n    }\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListMarkDeleteID(virConnectPtr conn,\n                                       virObjectEventCallbackListPtr cbList,\n                                       int callbackID)\n{\n    size_t i;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            cb->deleted = true;\n            return cb->filter ? 0 :\n                virObjectEventCallbackListCount(conn, cbList, cb->klass,\n                                                cb->eventID,\n                                                cb->key_filter ? cb->key : NULL,\n                                                cb->remoteID >= 0);\n        }\n    }\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"could not find event callback %d for deletion\"),\n                   callbackID);\n    return -1;\n}"
  },
  {
    "function_name": "virObjectEventCallbackListRemoveID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "231-266",
    "snippet": "static int\nvirObjectEventCallbackListRemoveID(virConnectPtr conn,\n                                   virObjectEventCallbackListPtr cbList,\n                                   int callbackID,\n                                   bool doFreeCb)\n{\n    size_t i;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            int ret;\n\n            ret = cb->filter ? 0 :\n                (virObjectEventCallbackListCount(conn, cbList, cb->klass,\n                                                 cb->eventID,\n                                                 cb->key_filter ? cb->key : NULL,\n                                                 cb->remoteID >= 0) - 1);\n\n            /* @doFreeCb inhibits calling @freecb from error paths in\n             * register functions to ensure the caller of a failed register\n             * function won't end up with a double free error */\n            if (doFreeCb && cb->freecb)\n                (*cb->freecb)(cb->opaque);\n            virObjectEventCallbackFree(cb);\n            VIR_DELETE_ELEMENT(cbList->callbacks, i, cbList->count);\n            return ret;\n        }\n    }\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"could not find event callback %d for deletion\"),\n                   callbackID);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"could not find event callback %d for deletion\")",
            "callbackID"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not find event callback %d for deletion\""
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "333-366",
          "snippet": "static int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirObjectEventCallbackLookup(virConnectPtr conn,\n                             virObjectEventCallbackListPtr cbList,\n                             const char *key,\n                             virClassPtr klass,\n                             int eventID,\n                             virConnectObjectEventGenericCallback callback,\n                             bool legacy,\n                             int *remoteID)\n{\n    size_t i;\n\n    if (remoteID)\n        *remoteID = -1;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->deleted)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            ((key && cb->key_filter && STREQ(cb->key, key)) ||\n             (!key && !cb->key_filter))) {\n            if (remoteID)\n                *remoteID = cb->remoteID;\n            if (cb->legacy == legacy &&\n                cb->cb == callback)\n                return cb->callbackID;\n        }\n    }\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "cbList->callbacks",
            "i",
            "cbList->count"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackFree",
          "args": [
            "cb"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventCallbackFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "136-145",
          "snippet": "static void\nvirObjectEventCallbackFree(virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return;\n\n    virObjectUnref(cb->conn);\n    VIR_FREE(cb->key);\n    VIR_FREE(cb);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void\nvirObjectEventCallbackFree(virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return;\n\n    virObjectUnref(cb->conn);\n    VIR_FREE(cb->key);\n    VIR_FREE(cb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "cb->opaque"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectEventCallbackListCount",
          "args": [
            "conn",
            "cbList",
            "cb->klass",
            "cb->eventID",
            "cb->key_filter ? cb->key : NULL",
            "cb->remoteID >= 0"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventCallbackListCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "193-220",
          "snippet": "static int\nvirObjectEventCallbackListCount(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                virClassPtr klass,\n                                int eventID,\n                                const char *key,\n                                bool serverFilter)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->filter)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            !cb->deleted &&\n            (!serverFilter ||\n             (cb->remoteID >= 0 &&\n              ((key && cb->key_filter && STREQ(cb->key, key)) ||\n               (!key && !cb->key_filter)))))\n            ret++;\n    }\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListCount(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                virClassPtr klass,\n                                int eventID,\n                                const char *key,\n                                bool serverFilter)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->filter)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            !cb->deleted &&\n            (!serverFilter ||\n             (cb->remoteID >= 0 &&\n              ((key && cb->key_filter && STREQ(cb->key, key)) ||\n               (!key && !cb->key_filter)))))\n            ret++;\n    }\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListRemoveID(virConnectPtr conn,\n                                   virObjectEventCallbackListPtr cbList,\n                                   int callbackID,\n                                   bool doFreeCb)\n{\n    size_t i;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->callbackID == callbackID && cb->conn == conn) {\n            int ret;\n\n            ret = cb->filter ? 0 :\n                (virObjectEventCallbackListCount(conn, cbList, cb->klass,\n                                                 cb->eventID,\n                                                 cb->key_filter ? cb->key : NULL,\n                                                 cb->remoteID >= 0) - 1);\n\n            /* @doFreeCb inhibits calling @freecb from error paths in\n             * register functions to ensure the caller of a failed register\n             * function won't end up with a double free error */\n            if (doFreeCb && cb->freecb)\n                (*cb->freecb)(cb->opaque);\n            virObjectEventCallbackFree(cb);\n            VIR_DELETE_ELEMENT(cbList->callbacks, i, cbList->count);\n            return ret;\n        }\n    }\n\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"could not find event callback %d for deletion\"),\n                   callbackID);\n    return -1;\n}"
  },
  {
    "function_name": "virObjectEventCallbackListCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "193-220",
    "snippet": "static int\nvirObjectEventCallbackListCount(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                virClassPtr klass,\n                                int eventID,\n                                const char *key,\n                                bool serverFilter)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->filter)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            !cb->deleted &&\n            (!serverFilter ||\n             (cb->remoteID >= 0 &&\n              ((key && cb->key_filter && STREQ(cb->key, key)) ||\n               (!key && !cb->key_filter)))))\n            ret++;\n    }\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "cb->key",
            "key"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventCallbackListCount(virConnectPtr conn,\n                                virObjectEventCallbackListPtr cbList,\n                                virClassPtr klass,\n                                int eventID,\n                                const char *key,\n                                bool serverFilter)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < cbList->count; i++) {\n        virObjectEventCallbackPtr cb = cbList->callbacks[i];\n\n        if (cb->filter)\n            continue;\n        if (cb->klass == klass &&\n            cb->eventID == eventID &&\n            cb->conn == conn &&\n            !cb->deleted &&\n            (!serverFilter ||\n             (cb->remoteID >= 0 &&\n              ((key && cb->key_filter && STREQ(cb->key, key)) ||\n               (!key && !cb->key_filter)))))\n            ret++;\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virObjectEventCallbackListFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "153-168",
    "snippet": "static void\nvirObjectEventCallbackListFree(virObjectEventCallbackListPtr list)\n{\n    size_t i;\n    if (!list)\n        return;\n\n    for (i = 0; i < list->count; i++) {\n        virFreeCallback freecb = list->callbacks[i]->freecb;\n        if (freecb)\n            (*freecb)(list->callbacks[i]->opaque);\n        VIR_FREE(list->callbacks[i]);\n    }\n    VIR_FREE(list->callbacks);\n    VIR_FREE(list);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "list"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "list->callbacks"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "list->callbacks[i]"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "list->callbacks[i]->opaque"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void\nvirObjectEventCallbackListFree(virObjectEventCallbackListPtr list)\n{\n    size_t i;\n    if (!list)\n        return;\n\n    for (i = 0; i < list->count; i++) {\n        virFreeCallback freecb = list->callbacks[i]->freecb;\n        if (freecb)\n            (*freecb)(list->callbacks[i]->opaque);\n        VIR_FREE(list->callbacks[i]);\n    }\n    VIR_FREE(list->callbacks);\n    VIR_FREE(list);\n}"
  },
  {
    "function_name": "virObjectEventCallbackFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "136-145",
    "snippet": "static void\nvirObjectEventCallbackFree(virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return;\n\n    virObjectUnref(cb->conn);\n    VIR_FREE(cb->key);\n    VIR_FREE(cb);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cb"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cb->key"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cb->conn"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void\nvirObjectEventCallbackFree(virObjectEventCallbackPtr cb)\n{\n    if (!cb)\n        return;\n\n    virObjectUnref(cb->conn);\n    VIR_FREE(cb->key);\n    VIR_FREE(cb);\n}"
  },
  {
    "function_name": "virObjectEventDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "119-128",
    "snippet": "static void\nvirObjectEventDispose(void *obj)\n{\n    virObjectEventPtr event = obj;\n\n    VIR_DEBUG(\"obj=%p\", event);\n\n    VIR_FREE(event->meta.name);\n    VIR_FREE(event->meta.key);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virObjectEventDispose(void *obj);",
      "static void virObjectEventStateDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "event->meta.key"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "event->meta.name"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "event"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventDispose(void *obj);\nstatic void virObjectEventStateDispose(void *obj);\n\nstatic void\nvirObjectEventDispose(void *obj)\n{\n    virObjectEventPtr event = obj;\n\n    VIR_DEBUG(\"obj=%p\", event);\n\n    VIR_FREE(event->meta.name);\n    VIR_FREE(event->meta.key);\n}"
  },
  {
    "function_name": "virClassForObjectEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "110-116",
    "snippet": "virClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virObjectEventClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventInitialize",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\n\nvirClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}"
  },
  {
    "function_name": "virObjectEventOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
    "lines": "90-100",
    "snippet": "static int\nvirObjectEventOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virObjectEventState, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virObjectEvent, virClassForObject()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virobject.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include \"domain_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virObjectEvent",
            "virClassForObject()"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObject",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectEvent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "110-116",
          "snippet": "virClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\n\nvirClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virObjectEventState",
            "virClassForObjectLockable()"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic int\nvirObjectEventOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virObjectEventState, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virObjectEvent, virClassForObject()))\n        return -1;\n\n    return 0;\n}"
  }
]