[
  {
    "function_name": "virConnectNodeDeviceEventDeregisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "861-886",
    "snippet": "int\nvirConnectNodeDeviceEventDeregisterAny(virConnectPtr conn,\n                                       int callbackID)\n{\n    VIR_DEBUG(\"conn=%p, callbackID=%d\", conn, callbackID);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNegativeArgGoto(callbackID, error);\n\n    if (conn->nodeDeviceDriver &&\n        conn->nodeDeviceDriver->connectNodeDeviceEventDeregisterAny) {\n        int ret;\n        ret = conn->nodeDeviceDriver->connectNodeDeviceEventDeregisterAny(conn,\n                                                                          callbackID);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 884
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nodeDeviceDriver->connectNodeDeviceEventDeregisterAny",
          "args": [
            "conn",
            "callbackID"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "callbackID",
            "error"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, callbackID=%d\"",
            "conn",
            "callbackID"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectNodeDeviceEventDeregisterAny(virConnectPtr conn,\n                                       int callbackID)\n{\n    VIR_DEBUG(\"conn=%p, callbackID=%d\", conn, callbackID);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNegativeArgGoto(callbackID, error);\n\n    if (conn->nodeDeviceDriver &&\n        conn->nodeDeviceDriver->connectNodeDeviceEventDeregisterAny) {\n        int ret;\n        ret = conn->nodeDeviceDriver->connectNodeDeviceEventDeregisterAny(conn,\n                                                                          callbackID);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectNodeDeviceEventRegisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "797-848",
    "snippet": "int\nvirConnectNodeDeviceEventRegisterAny(virConnectPtr conn,\n                                     virNodeDevicePtr dev,\n                                     int eventID,\n                                     virConnectNodeDeviceEventGenericCallback cb,\n                                     void *opaque,\n                                     virFreeCallback freecb)\n{\n    VIR_DEBUG(\"conn=%p, nodeDevice=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\",\n              conn, dev, eventID, cb, opaque, freecb);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    if (dev) {\n        virCheckNodeDeviceGoto(dev, error);\n        if (dev->conn != conn) {\n            virReportInvalidArg(dev,\n                                _(\"node device '%s' in %s must match connection\"),\n                                dev->name, __FUNCTION__);\n            goto error;\n        }\n    }\n    virCheckNonNullArgGoto(cb, error);\n    virCheckNonNegativeArgGoto(eventID, error);\n\n    if (eventID >= VIR_NODE_DEVICE_EVENT_ID_LAST) {\n        virReportInvalidArg(eventID,\n                            _(\"eventID in %s must be less than %d\"),\n                            __FUNCTION__, VIR_NODE_DEVICE_EVENT_ID_LAST);\n        goto error;\n    }\n\n    if (conn->nodeDeviceDriver &&\n        conn->nodeDeviceDriver->connectNodeDeviceEventRegisterAny) {\n        int ret;\n        ret = conn->nodeDeviceDriver->connectNodeDeviceEventRegisterAny(conn,\n                                                                        dev,\n                                                                        eventID,\n                                                                        cb,\n                                                                        opaque,\n                                                                        freecb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 846
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nodeDeviceDriver->connectNodeDeviceEventRegisterAny",
          "args": [
            "conn",
            "dev",
            "eventID",
            "cb",
            "opaque",
            "freecb"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "eventID",
            "_(\"eventID in %s must be less than %d\")",
            "__FUNCTION__",
            "VIR_NODE_DEVICE_EVENT_ID_LAST"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"eventID in %s must be less than %d\""
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "eventID",
            "error"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cb",
            "error"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "dev",
            "_(\"node device '%s' in %s must match connection\")",
            "dev->name",
            "__FUNCTION__"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceGoto",
          "args": [
            "dev",
            "error"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, nodeDevice=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\"",
            "conn",
            "dev",
            "eventID",
            "cb",
            "opaque",
            "freecb"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectNodeDeviceEventRegisterAny(virConnectPtr conn,\n                                     virNodeDevicePtr dev,\n                                     int eventID,\n                                     virConnectNodeDeviceEventGenericCallback cb,\n                                     void *opaque,\n                                     virFreeCallback freecb)\n{\n    VIR_DEBUG(\"conn=%p, nodeDevice=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\",\n              conn, dev, eventID, cb, opaque, freecb);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    if (dev) {\n        virCheckNodeDeviceGoto(dev, error);\n        if (dev->conn != conn) {\n            virReportInvalidArg(dev,\n                                _(\"node device '%s' in %s must match connection\"),\n                                dev->name, __FUNCTION__);\n            goto error;\n        }\n    }\n    virCheckNonNullArgGoto(cb, error);\n    virCheckNonNegativeArgGoto(eventID, error);\n\n    if (eventID >= VIR_NODE_DEVICE_EVENT_ID_LAST) {\n        virReportInvalidArg(eventID,\n                            _(\"eventID in %s must be less than %d\"),\n                            __FUNCTION__, VIR_NODE_DEVICE_EVENT_ID_LAST);\n        goto error;\n    }\n\n    if (conn->nodeDeviceDriver &&\n        conn->nodeDeviceDriver->connectNodeDeviceEventRegisterAny) {\n        int ret;\n        ret = conn->nodeDeviceDriver->connectNodeDeviceEventRegisterAny(conn,\n                                                                        dev,\n                                                                        eventID,\n                                                                        cb,\n                                                                        opaque,\n                                                                        freecb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNodeDeviceDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "735-759",
    "snippet": "int\nvirNodeDeviceDestroy(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p\", dev);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckReadOnlyGoto(dev->conn->flags, error);\n\n    if (dev->conn->nodeDeviceDriver &&\n        dev->conn->nodeDeviceDriver->nodeDeviceDestroy) {\n        int retval = dev->conn->nodeDeviceDriver->nodeDeviceDestroy(dev);\n        if (retval < 0)\n            goto error;\n\n        return 0;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dev->conn"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev->conn->nodeDeviceDriver->nodeDeviceDestroy",
          "args": [
            "dev"
          ],
          "line": 747
        },
        "resolved": true,
        "details": {
          "function_name": "nodeDeviceDestroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/node_device/node_device_driver.c",
          "lines": "539-589",
          "snippet": "int\nnodeDeviceDestroy(virNodeDevicePtr device)\n{\n    int ret = -1;\n    virNodeDeviceObjPtr obj = NULL;\n    virNodeDeviceDefPtr def;\n    g_autofree char *parent = NULL;\n    g_autofree char *wwnn = NULL;\n    g_autofree char *wwpn = NULL;\n    unsigned int parent_host;\n\n    if (nodeDeviceWaitInit() < 0)\n        return -1;\n\n    if (!(obj = nodeDeviceObjFindByName(device->name)))\n        return -1;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceDestroyEnsureACL(device->conn, def) < 0)\n        goto cleanup;\n\n    if (virNodeDeviceGetWWNs(def, &wwnn, &wwpn) < 0)\n        goto cleanup;\n\n    /* Because we're about to release the lock and thus run into a race\n     * possibility (however improbable) with a udevAddOneDevice change\n     * event which would essentially free the existing @def (obj->def) and\n     * replace it with something new, we need to grab the parent field\n     * and then find the parent obj in order to manage the vport */\n    parent = g_strdup(def->parent);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    if (!(obj = virNodeDeviceObjListFindByName(driver->devs, parent))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot find parent '%s' definition\"), parent);\n        goto cleanup;\n    }\n\n    if (virSCSIHostGetNumber(parent, &parent_host) < 0)\n        goto cleanup;\n\n    if (virVHBAManageVport(parent_host, wwpn, wwnn, VPORT_DELETE) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virnetdev.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virvhba.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_hal.h\"",
            "#include \"node_device_driver.h\"",
            "#include \"node_device_event.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virNodeDeviceDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virnetdev.h\"\n#include \"viraccessapicheck.h\"\n#include \"virvhba.h\"\n#include \"node_device_util.h\"\n#include \"node_device_hal.h\"\n#include \"node_device_driver.h\"\n#include \"node_device_event.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <time.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNodeDeviceDriverStatePtr driver;\n\nint\nnodeDeviceDestroy(virNodeDevicePtr device)\n{\n    int ret = -1;\n    virNodeDeviceObjPtr obj = NULL;\n    virNodeDeviceDefPtr def;\n    g_autofree char *parent = NULL;\n    g_autofree char *wwnn = NULL;\n    g_autofree char *wwpn = NULL;\n    unsigned int parent_host;\n\n    if (nodeDeviceWaitInit() < 0)\n        return -1;\n\n    if (!(obj = nodeDeviceObjFindByName(device->name)))\n        return -1;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceDestroyEnsureACL(device->conn, def) < 0)\n        goto cleanup;\n\n    if (virNodeDeviceGetWWNs(def, &wwnn, &wwpn) < 0)\n        goto cleanup;\n\n    /* Because we're about to release the lock and thus run into a race\n     * possibility (however improbable) with a udevAddOneDevice change\n     * event which would essentially free the existing @def (obj->def) and\n     * replace it with something new, we need to grab the parent field\n     * and then find the parent obj in order to manage the vport */\n    parent = g_strdup(def->parent);\n\n    virNodeDeviceObjEndAPI(&obj);\n\n    if (!(obj = virNodeDeviceObjListFindByName(driver->devs, parent))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot find parent '%s' definition\"), parent);\n        goto cleanup;\n    }\n\n    if (virSCSIHostGetNumber(parent, &parent_host) < 0)\n        goto cleanup;\n\n    if (virVHBAManageVport(parent_host, wwpn, wwnn, VPORT_DELETE) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dev->conn->flags",
            "error"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "-1"
          ],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 740
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p\"",
            "dev"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceDestroy(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p\", dev);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckReadOnlyGoto(dev->conn->flags, error);\n\n    if (dev->conn->nodeDeviceDriver &&\n        dev->conn->nodeDeviceDriver->nodeDeviceDestroy) {\n        int retval = dev->conn->nodeDeviceDriver->nodeDeviceDestroy(dev);\n        if (retval < 0)\n            goto error;\n\n        return 0;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNodeDeviceCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "696-722",
    "snippet": "virNodeDevicePtr\nvirNodeDeviceCreateXML(virConnectPtr conn,\n                       const char *xmlDesc,\n                       unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s, flags=0x%x\", conn, NULLSTR(xmlDesc), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xmlDesc, error);\n\n    if (conn->nodeDeviceDriver &&\n        conn->nodeDeviceDriver->nodeDeviceCreateXML) {\n        virNodeDevicePtr dev = conn->nodeDeviceDriver->nodeDeviceCreateXML(conn, xmlDesc, flags);\n        if (dev == NULL)\n            goto error;\n        return dev;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nodeDeviceDriver->nodeDeviceCreateXML",
          "args": [
            "conn",
            "xmlDesc",
            "flags"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "nodeDeviceCreateXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/node_device/node_device_driver.c",
          "lines": "491-536",
          "snippet": "virNodeDevicePtr\nnodeDeviceCreateXML(virConnectPtr conn,\n                    const char *xmlDesc,\n                    unsigned int flags)\n{\n    g_autoptr(virNodeDeviceDef) def = NULL;\n    g_autofree char *wwnn = NULL;\n    g_autofree char *wwpn = NULL;\n    int parent_host = -1;\n    virNodeDevicePtr device = NULL;\n    const char *virt_type = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (nodeDeviceWaitInit() < 0)\n        return NULL;\n\n    virt_type  = virConnectGetType(conn);\n\n    if (!(def = virNodeDeviceDefParseString(xmlDesc, CREATE_DEVICE, virt_type)))\n        return NULL;\n\n    if (virNodeDeviceCreateXMLEnsureACL(conn, def) < 0)\n        return NULL;\n\n    if (virNodeDeviceGetWWNs(def, &wwnn, &wwpn) == -1)\n        return NULL;\n\n    if ((parent_host = virNodeDeviceObjListGetParentHost(driver->devs, def)) < 0)\n        return NULL;\n\n    if (virVHBAManageVport(parent_host, wwpn, wwnn, VPORT_CREATE) < 0)\n        return NULL;\n\n    device = nodeDeviceFindNewDevice(conn, wwnn, wwpn);\n    /* We don't check the return value, because one way or another,\n     * we're returning what we get... */\n\n    if (device == NULL)\n        virReportError(VIR_ERR_NO_NODE_DEVICE,\n                       _(\"no node device for '%s' with matching \"\n                         \"wwnn '%s' and wwpn '%s'\"),\n                       def->name, wwnn, wwpn);\n\n    return device;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virnetdev.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virvhba.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_hal.h\"",
            "#include \"node_device_driver.h\"",
            "#include \"node_device_event.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virNodeDeviceDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virnetdev.h\"\n#include \"viraccessapicheck.h\"\n#include \"virvhba.h\"\n#include \"node_device_util.h\"\n#include \"node_device_hal.h\"\n#include \"node_device_driver.h\"\n#include \"node_device_event.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <time.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNodeDeviceDriverStatePtr driver;\n\nvirNodeDevicePtr\nnodeDeviceCreateXML(virConnectPtr conn,\n                    const char *xmlDesc,\n                    unsigned int flags)\n{\n    g_autoptr(virNodeDeviceDef) def = NULL;\n    g_autofree char *wwnn = NULL;\n    g_autofree char *wwpn = NULL;\n    int parent_host = -1;\n    virNodeDevicePtr device = NULL;\n    const char *virt_type = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (nodeDeviceWaitInit() < 0)\n        return NULL;\n\n    virt_type  = virConnectGetType(conn);\n\n    if (!(def = virNodeDeviceDefParseString(xmlDesc, CREATE_DEVICE, virt_type)))\n        return NULL;\n\n    if (virNodeDeviceCreateXMLEnsureACL(conn, def) < 0)\n        return NULL;\n\n    if (virNodeDeviceGetWWNs(def, &wwnn, &wwpn) == -1)\n        return NULL;\n\n    if ((parent_host = virNodeDeviceObjListGetParentHost(driver->devs, def)) < 0)\n        return NULL;\n\n    if (virVHBAManageVport(parent_host, wwpn, wwnn, VPORT_CREATE) < 0)\n        return NULL;\n\n    device = nodeDeviceFindNewDevice(conn, wwnn, wwpn);\n    /* We don't check the return value, because one way or another,\n     * we're returning what we get... */\n\n    if (device == NULL)\n        virReportError(VIR_ERR_NO_NODE_DEVICE,\n                       _(\"no node device for '%s' with matching \"\n                         \"wwnn '%s' and wwpn '%s'\"),\n                       def->name, wwnn, wwpn);\n\n    return device;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xmlDesc",
            "error"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, xmlDesc=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(xmlDesc)",
            "flags"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmlDesc"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNodeDevicePtr\nvirNodeDeviceCreateXML(virConnectPtr conn,\n                       const char *xmlDesc,\n                       unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s, flags=0x%x\", conn, NULLSTR(xmlDesc), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xmlDesc, error);\n\n    if (conn->nodeDeviceDriver &&\n        conn->nodeDeviceDriver->nodeDeviceCreateXML) {\n        virNodeDevicePtr dev = conn->nodeDeviceDriver->nodeDeviceCreateXML(conn, xmlDesc, flags);\n        if (dev == NULL)\n            goto error;\n        return dev;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNodeDeviceReset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "656-679",
    "snippet": "int\nvirNodeDeviceReset(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckReadOnlyGoto(dev->conn->flags, error);\n\n    if (dev->conn->driver->nodeDeviceReset) {\n        int ret;\n        ret = dev->conn->driver->nodeDeviceReset(dev);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dev->conn"
          ],
          "line": 677
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev->conn->driver->nodeDeviceReset",
          "args": [
            "dev"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dev->conn->flags",
            "error"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "-1"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 661
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p, conn=%p\"",
            "dev",
            "dev ? dev->conn : NULL"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceReset(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckReadOnlyGoto(dev->conn->flags, error);\n\n    if (dev->conn->driver->nodeDeviceReset) {\n        int ret;\n        ret = dev->conn->driver->nodeDeviceReset(dev);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNodeDeviceReAttach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "613-636",
    "snippet": "int\nvirNodeDeviceReAttach(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckReadOnlyGoto(dev->conn->flags, error);\n\n    if (dev->conn->driver->nodeDeviceReAttach) {\n        int ret;\n        ret = dev->conn->driver->nodeDeviceReAttach(dev);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dev->conn"
          ],
          "line": 634
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev->conn->driver->nodeDeviceReAttach",
          "args": [
            "dev"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dev->conn->flags",
            "error"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "-1"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p, conn=%p\"",
            "dev",
            "dev ? dev->conn : NULL"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceReAttach(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckReadOnlyGoto(dev->conn->flags, error);\n\n    if (dev->conn->driver->nodeDeviceReAttach) {\n        int ret;\n        ret = dev->conn->driver->nodeDeviceReAttach(dev);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNodeDeviceDetachFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "568-595",
    "snippet": "int\nvirNodeDeviceDetachFlags(virNodeDevicePtr dev,\n                         const char *driverName,\n                         unsigned int flags)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p driverName=%s flags=0x%x\",\n              dev, dev ? dev->conn : NULL,\n              driverName ? driverName : \"(default)\", flags);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckReadOnlyGoto(dev->conn->flags, error);\n\n    if (dev->conn->driver->nodeDeviceDetachFlags) {\n        int ret;\n        ret = dev->conn->driver->nodeDeviceDetachFlags(dev, driverName, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dev->conn"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev->conn->driver->nodeDeviceDetachFlags",
          "args": [
            "dev",
            "driverName",
            "flags"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dev->conn->flags",
            "error"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "-1"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p, conn=%p driverName=%s flags=0x%x\"",
            "dev",
            "dev ? dev->conn : NULL",
            "driverName ? driverName : \"(default)\"",
            "flags"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceDetachFlags(virNodeDevicePtr dev,\n                         const char *driverName,\n                         unsigned int flags)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p driverName=%s flags=0x%x\",\n              dev, dev ? dev->conn : NULL,\n              driverName ? driverName : \"(default)\", flags);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckReadOnlyGoto(dev->conn->flags, error);\n\n    if (dev->conn->driver->nodeDeviceDetachFlags) {\n        int ret;\n        ret = dev->conn->driver->nodeDeviceDetachFlags(dev, driverName, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNodeDeviceDettach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "515-538",
    "snippet": "int\nvirNodeDeviceDettach(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckReadOnlyGoto(dev->conn->flags, error);\n\n    if (dev->conn->driver->nodeDeviceDettach) {\n        int ret;\n        ret = dev->conn->driver->nodeDeviceDettach(dev);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dev->conn"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev->conn->driver->nodeDeviceDettach",
          "args": [
            "dev"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dev->conn->flags",
            "error"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "-1"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p, conn=%p\"",
            "dev",
            "dev ? dev->conn : NULL"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceDettach(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckReadOnlyGoto(dev->conn->flags, error);\n\n    if (dev->conn->driver->nodeDeviceDettach) {\n        int ret;\n        ret = dev->conn->driver->nodeDeviceDettach(dev);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNodeDeviceRef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "477-488",
    "snippet": "int\nvirNodeDeviceRef(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p refs=%d\", dev, dev ? dev->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n\n    virObjectRef(dev);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "dev"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "-1"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p refs=%d\"",
            "dev",
            "dev ? dev->parent.u.s.refs : 0"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceRef(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p refs=%d\", dev, dev ? dev->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n\n    virObjectRef(dev);\n    return 0;\n}"
  },
  {
    "function_name": "virNodeDeviceFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "446-457",
    "snippet": "int\nvirNodeDeviceFree(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n\n    virObjectUnref(dev);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "dev"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "-1"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p, conn=%p\"",
            "dev",
            "dev ? dev->conn : NULL"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceFree(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n\n    virObjectUnref(dev);\n    return 0;\n}"
  },
  {
    "function_name": "virNodeDeviceListCaps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "407-434",
    "snippet": "int\nvirNodeDeviceListCaps(virNodeDevicePtr dev,\n                      char **const names,\n                      int maxnames)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p, names=%p, maxnames=%d\",\n          dev, dev ? dev->conn : NULL, names, maxnames);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (dev->conn->nodeDeviceDriver && dev->conn->nodeDeviceDriver->nodeDeviceListCaps) {\n        int ret;\n        ret = dev->conn->nodeDeviceDriver->nodeDeviceListCaps(dev, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dev->conn"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev->conn->nodeDeviceDriver->nodeDeviceListCaps",
          "args": [
            "dev",
            "names",
            "maxnames"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "nodeDeviceListCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/node_device/node_device_driver.c",
          "lines": "389-429",
          "snippet": "int\nnodeDeviceListCaps(virNodeDevicePtr device,\n                   char **const names,\n                   int maxnames)\n{\n    virNodeDeviceObjPtr obj;\n    virNodeDeviceDefPtr def;\n    virNodeDevCapType *list = NULL;\n    int ncaps = 0;\n    int ret = -1;\n    size_t i = 0;\n\n    if (!(obj = nodeDeviceObjFindByName(device->name)))\n        return -1;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceListCapsEnsureACL(device->conn, def) < 0)\n        goto cleanup;\n\n    if ((ncaps = virNodeDeviceCapsListExport(def, &list)) < 0)\n        goto cleanup;\n\n    if (ncaps > maxnames)\n        ncaps = maxnames;\n\n    for (i = 0; i < ncaps; i++)\n        names[i] = g_strdup(virNodeDevCapTypeToString(list[i]));\n\n    ret = ncaps;\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    if (ret < 0) {\n        size_t j;\n        for (j = 0; j < i; j++)\n            VIR_FREE(names[j]);\n    }\n\n    VIR_FREE(list);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virnetdev.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virvhba.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_hal.h\"",
            "#include \"node_device_driver.h\"",
            "#include \"node_device_event.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virnetdev.h\"\n#include \"viraccessapicheck.h\"\n#include \"virvhba.h\"\n#include \"node_device_util.h\"\n#include \"node_device_hal.h\"\n#include \"node_device_driver.h\"\n#include \"node_device_event.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <time.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nnodeDeviceListCaps(virNodeDevicePtr device,\n                   char **const names,\n                   int maxnames)\n{\n    virNodeDeviceObjPtr obj;\n    virNodeDeviceDefPtr def;\n    virNodeDevCapType *list = NULL;\n    int ncaps = 0;\n    int ret = -1;\n    size_t i = 0;\n\n    if (!(obj = nodeDeviceObjFindByName(device->name)))\n        return -1;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceListCapsEnsureACL(device->conn, def) < 0)\n        goto cleanup;\n\n    if ((ncaps = virNodeDeviceCapsListExport(def, &list)) < 0)\n        goto cleanup;\n\n    if (ncaps > maxnames)\n        ncaps = maxnames;\n\n    for (i = 0; i < ncaps; i++)\n        names[i] = g_strdup(virNodeDevCapTypeToString(list[i]));\n\n    ret = ncaps;\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    if (ret < 0) {\n        size_t j;\n        for (j = 0; j < i; j++)\n            VIR_FREE(names[j]);\n    }\n\n    VIR_FREE(list);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "maxnames",
            "error"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "names",
            "maxnames",
            "error"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "-1"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p, conn=%p, names=%p, maxnames=%d\"",
            "dev",
            "dev ? dev->conn : NULL",
            "names",
            "maxnames"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceListCaps(virNodeDevicePtr dev,\n                      char **const names,\n                      int maxnames)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p, names=%p, maxnames=%d\",\n          dev, dev ? dev->conn : NULL, names, maxnames);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (dev->conn->nodeDeviceDriver && dev->conn->nodeDeviceDriver->nodeDeviceListCaps) {\n        int ret;\n        ret = dev->conn->nodeDeviceDriver->nodeDeviceListCaps(dev, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNodeDeviceNumOfCaps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "371-393",
    "snippet": "int\nvirNodeDeviceNumOfCaps(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n\n    if (dev->conn->nodeDeviceDriver && dev->conn->nodeDeviceDriver->nodeDeviceNumOfCaps) {\n        int ret;\n        ret = dev->conn->nodeDeviceDriver->nodeDeviceNumOfCaps(dev);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dev->conn"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev->conn->nodeDeviceDriver->nodeDeviceNumOfCaps",
          "args": [
            "dev"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "nodeDeviceNumOfCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/node_device/node_device_driver.c",
          "lines": "366-385",
          "snippet": "int\nnodeDeviceNumOfCaps(virNodeDevicePtr device)\n{\n    virNodeDeviceObjPtr obj;\n    virNodeDeviceDefPtr def;\n    int ret = -1;\n\n    if (!(obj = nodeDeviceObjFindByName(device->name)))\n        return -1;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceNumOfCapsEnsureACL(device->conn, def) < 0)\n        goto cleanup;\n\n    ret = virNodeDeviceCapsListExport(def, NULL);\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virnetdev.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virvhba.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_hal.h\"",
            "#include \"node_device_driver.h\"",
            "#include \"node_device_event.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virnetdev.h\"\n#include \"viraccessapicheck.h\"\n#include \"virvhba.h\"\n#include \"node_device_util.h\"\n#include \"node_device_hal.h\"\n#include \"node_device_driver.h\"\n#include \"node_device_event.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <time.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nnodeDeviceNumOfCaps(virNodeDevicePtr device)\n{\n    virNodeDeviceObjPtr obj;\n    virNodeDeviceDefPtr def;\n    int ret = -1;\n\n    if (!(obj = nodeDeviceObjFindByName(device->name)))\n        return -1;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceNumOfCapsEnsureACL(device->conn, def) < 0)\n        goto cleanup;\n\n    ret = virNodeDeviceCapsListExport(def, NULL);\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "-1"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p, conn=%p\"",
            "dev",
            "dev ? dev->conn : NULL"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeDeviceNumOfCaps(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, -1);\n\n    if (dev->conn->nodeDeviceDriver && dev->conn->nodeDeviceDriver->nodeDeviceNumOfCaps) {\n        int ret;\n        ret = dev->conn->nodeDeviceDriver->nodeDeviceNumOfCaps(dev);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNodeDeviceGetParent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "340-359",
    "snippet": "const char *\nvirNodeDeviceGetParent(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, NULL);\n\n    if (!dev->parentName) {\n        if (dev->conn->nodeDeviceDriver && dev->conn->nodeDeviceDriver->nodeDeviceGetParent) {\n            dev->parentName = dev->conn->nodeDeviceDriver->nodeDeviceGetParent(dev);\n        } else {\n            virReportUnsupportedError();\n            virDispatchError(dev->conn);\n            return NULL;\n        }\n    }\n    return dev->parentName;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dev->conn"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev->conn->nodeDeviceDriver->nodeDeviceGetParent",
          "args": [
            "dev"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "nodeDeviceGetParent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/node_device/node_device_driver.c",
          "lines": "339-363",
          "snippet": "char *\nnodeDeviceGetParent(virNodeDevicePtr device)\n{\n    virNodeDeviceObjPtr obj;\n    virNodeDeviceDefPtr def;\n    char *ret = NULL;\n\n    if (!(obj = nodeDeviceObjFindByName(device->name)))\n        return NULL;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceGetParentEnsureACL(device->conn, def) < 0)\n        goto cleanup;\n\n    if (def->parent) {\n        ret = g_strdup(def->parent);\n    } else {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"no parent for this device\"));\n    }\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virnetdev.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virvhba.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_hal.h\"",
            "#include \"node_device_driver.h\"",
            "#include \"node_device_event.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virnetdev.h\"\n#include \"viraccessapicheck.h\"\n#include \"virvhba.h\"\n#include \"node_device_util.h\"\n#include \"node_device_hal.h\"\n#include \"node_device_driver.h\"\n#include \"node_device_event.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <time.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nnodeDeviceGetParent(virNodeDevicePtr device)\n{\n    virNodeDeviceObjPtr obj;\n    virNodeDeviceDefPtr def;\n    char *ret = NULL;\n\n    if (!(obj = nodeDeviceObjFindByName(device->name)))\n        return NULL;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceGetParentEnsureACL(device->conn, def) < 0)\n        goto cleanup;\n\n    if (def->parent) {\n        ret = g_strdup(def->parent);\n    } else {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"no parent for this device\"));\n    }\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "NULL"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p, conn=%p\"",
            "dev",
            "dev ? dev->conn : NULL"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nconst char *\nvirNodeDeviceGetParent(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, NULL);\n\n    if (!dev->parentName) {\n        if (dev->conn->nodeDeviceDriver && dev->conn->nodeDeviceDriver->nodeDeviceGetParent) {\n            dev->parentName = dev->conn->nodeDeviceDriver->nodeDeviceGetParent(dev);\n        } else {\n            virReportUnsupportedError();\n            virDispatchError(dev->conn);\n            return NULL;\n        }\n    }\n    return dev->parentName;\n}"
  },
  {
    "function_name": "virNodeDeviceGetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "318-328",
    "snippet": "const char *\nvirNodeDeviceGetName(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, NULL);\n\n    return dev->name;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "NULL"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p, conn=%p\"",
            "dev",
            "dev ? dev->conn : NULL"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nconst char *\nvirNodeDeviceGetName(virNodeDevicePtr dev)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p\", dev, dev ? dev->conn : NULL);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, NULL);\n\n    return dev->name;\n}"
  },
  {
    "function_name": "virNodeDeviceGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "285-307",
    "snippet": "char *\nvirNodeDeviceGetXMLDesc(virNodeDevicePtr dev, unsigned int flags)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p, flags=0x%x\", dev, dev ? dev->conn : NULL, flags);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, NULL);\n\n    if (dev->conn->nodeDeviceDriver && dev->conn->nodeDeviceDriver->nodeDeviceGetXMLDesc) {\n        char *ret;\n        ret = dev->conn->nodeDeviceDriver->nodeDeviceGetXMLDesc(dev, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dev->conn"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev->conn->nodeDeviceDriver->nodeDeviceGetXMLDesc",
          "args": [
            "dev",
            "flags"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "nodeDeviceGetXMLDesc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/node_device/node_device_driver.c",
          "lines": "308-336",
          "snippet": "char *\nnodeDeviceGetXMLDesc(virNodeDevicePtr device,\n                     unsigned int flags)\n{\n    virNodeDeviceObjPtr obj;\n    virNodeDeviceDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(obj = nodeDeviceObjFindByName(device->name)))\n        return NULL;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceGetXMLDescEnsureACL(device->conn, def) < 0)\n        goto cleanup;\n\n    if (nodeDeviceUpdateDriverName(def) < 0)\n        goto cleanup;\n\n    if (virNodeDeviceUpdateCaps(def) < 0)\n        goto cleanup;\n\n    ret = virNodeDeviceDefFormat(def);\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virnetdev.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virvhba.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_hal.h\"",
            "#include \"node_device_driver.h\"",
            "#include \"node_device_event.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virnetdev.h\"\n#include \"viraccessapicheck.h\"\n#include \"virvhba.h\"\n#include \"node_device_util.h\"\n#include \"node_device_hal.h\"\n#include \"node_device_driver.h\"\n#include \"node_device_event.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <time.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nnodeDeviceGetXMLDesc(virNodeDevicePtr device,\n                     unsigned int flags)\n{\n    virNodeDeviceObjPtr obj;\n    virNodeDeviceDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(obj = nodeDeviceObjFindByName(device->name)))\n        return NULL;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceGetXMLDescEnsureACL(device->conn, def) < 0)\n        goto cleanup;\n\n    if (nodeDeviceUpdateDriverName(def) < 0)\n        goto cleanup;\n\n    if (virNodeDeviceUpdateCaps(def) < 0)\n        goto cleanup;\n\n    ret = virNodeDeviceDefFormat(def);\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNodeDeviceReturn",
          "args": [
            "dev",
            "NULL"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dev=%p, conn=%p, flags=0x%x\"",
            "dev",
            "dev ? dev->conn : NULL",
            "flags"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nchar *\nvirNodeDeviceGetXMLDesc(virNodeDevicePtr dev, unsigned int flags)\n{\n    VIR_DEBUG(\"dev=%p, conn=%p, flags=0x%x\", dev, dev ? dev->conn : NULL, flags);\n\n    virResetLastError();\n\n    virCheckNodeDeviceReturn(dev, NULL);\n\n    if (dev->conn->nodeDeviceDriver && dev->conn->nodeDeviceDriver->nodeDeviceGetXMLDesc) {\n        char *ret;\n        ret = dev->conn->nodeDeviceDriver->nodeDeviceGetXMLDesc(dev, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dev->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNodeDeviceLookupSCSIHostByWWN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "243-272",
    "snippet": "virNodeDevicePtr\nvirNodeDeviceLookupSCSIHostByWWN(virConnectPtr conn,\n                                 const char *wwnn,\n                                 const char *wwpn,\n                                 unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, wwnn=%s, wwpn=%s, flags=0x%x\", conn, NULLSTR(wwnn), NULLSTR(wwpn), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(wwnn, error);\n    virCheckNonNullArgGoto(wwpn, error);\n\n    if (conn->nodeDeviceDriver &&\n        conn->nodeDeviceDriver->nodeDeviceLookupSCSIHostByWWN) {\n        virNodeDevicePtr ret;\n        ret = conn->nodeDeviceDriver->nodeDeviceLookupSCSIHostByWWN(conn, wwnn,\n                                                             wwpn, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nodeDeviceDriver->nodeDeviceLookupSCSIHostByWWN",
          "args": [
            "conn",
            "wwnn",
            "wwpn",
            "flags"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "nodeDeviceLookupSCSIHostByWWN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/node_device/node_device_driver.c",
          "lines": "275-305",
          "snippet": "virNodeDevicePtr\nnodeDeviceLookupSCSIHostByWWN(virConnectPtr conn,\n                              const char *wwnn,\n                              const char *wwpn,\n                              unsigned int flags)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    virNodeDeviceDefPtr def;\n    virNodeDevicePtr device = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (nodeDeviceWaitInit() < 0)\n        return NULL;\n\n    if (!(obj = virNodeDeviceObjListFindSCSIHostByWWNs(driver->devs,\n                                                       wwnn, wwpn)))\n        return NULL;\n\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceLookupSCSIHostByWWNEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if ((device = virGetNodeDevice(conn, def->name)))\n        device->parentName = g_strdup(def->parent);\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return device;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virnetdev.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virvhba.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_hal.h\"",
            "#include \"node_device_driver.h\"",
            "#include \"node_device_event.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virNodeDeviceDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virnetdev.h\"\n#include \"viraccessapicheck.h\"\n#include \"virvhba.h\"\n#include \"node_device_util.h\"\n#include \"node_device_hal.h\"\n#include \"node_device_driver.h\"\n#include \"node_device_event.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <time.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNodeDeviceDriverStatePtr driver;\n\nvirNodeDevicePtr\nnodeDeviceLookupSCSIHostByWWN(virConnectPtr conn,\n                              const char *wwnn,\n                              const char *wwpn,\n                              unsigned int flags)\n{\n    virNodeDeviceObjPtr obj = NULL;\n    virNodeDeviceDefPtr def;\n    virNodeDevicePtr device = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (nodeDeviceWaitInit() < 0)\n        return NULL;\n\n    if (!(obj = virNodeDeviceObjListFindSCSIHostByWWNs(driver->devs,\n                                                       wwnn, wwpn)))\n        return NULL;\n\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceLookupSCSIHostByWWNEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if ((device = virGetNodeDevice(conn, def->name)))\n        device->parentName = g_strdup(def->parent);\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return device;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "wwpn",
            "error"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "wwnn",
            "error"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, wwnn=%s, wwpn=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(wwnn)",
            "NULLSTR(wwpn)",
            "flags"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "wwpn"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "wwnn"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNodeDevicePtr\nvirNodeDeviceLookupSCSIHostByWWN(virConnectPtr conn,\n                                 const char *wwnn,\n                                 const char *wwpn,\n                                 unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, wwnn=%s, wwpn=%s, flags=0x%x\", conn, NULLSTR(wwnn), NULLSTR(wwpn), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(wwnn, error);\n    virCheckNonNullArgGoto(wwpn, error);\n\n    if (conn->nodeDeviceDriver &&\n        conn->nodeDeviceDriver->nodeDeviceLookupSCSIHostByWWN) {\n        virNodeDevicePtr ret;\n        ret = conn->nodeDeviceDriver->nodeDeviceLookupSCSIHostByWWN(conn, wwnn,\n                                                             wwpn, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNodeDeviceLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "203-226",
    "snippet": "virNodeDevicePtr\nvirNodeDeviceLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->nodeDeviceDriver && conn->nodeDeviceDriver->nodeDeviceLookupByName) {\n        virNodeDevicePtr ret;\n        ret = conn->nodeDeviceDriver->nodeDeviceLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nodeDeviceDriver->nodeDeviceLookupByName",
          "args": [
            "conn",
            "name"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "nodeDeviceLookupByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/node_device/node_device_driver.c",
          "lines": "248-272",
          "snippet": "virNodeDevicePtr\nnodeDeviceLookupByName(virConnectPtr conn,\n                       const char *name)\n{\n    virNodeDeviceObjPtr obj;\n    virNodeDeviceDefPtr def;\n    virNodeDevicePtr device = NULL;\n\n    if (nodeDeviceWaitInit() < 0)\n        return NULL;\n\n    if (!(obj = nodeDeviceObjFindByName(name)))\n        return NULL;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if ((device = virGetNodeDevice(conn, name)))\n        device->parentName = g_strdup(def->parent);\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return device;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virnetdev.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virvhba.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_hal.h\"",
            "#include \"node_device_driver.h\"",
            "#include \"node_device_event.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virnetdev.h\"\n#include \"viraccessapicheck.h\"\n#include \"virvhba.h\"\n#include \"node_device_util.h\"\n#include \"node_device_hal.h\"\n#include \"node_device_driver.h\"\n#include \"node_device_event.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <time.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNodeDevicePtr\nnodeDeviceLookupByName(virConnectPtr conn,\n                       const char *name)\n{\n    virNodeDeviceObjPtr obj;\n    virNodeDeviceDefPtr def;\n    virNodeDevicePtr device = NULL;\n\n    if (nodeDeviceWaitInit() < 0)\n        return NULL;\n\n    if (!(obj = nodeDeviceObjFindByName(name)))\n        return NULL;\n    def = virNodeDeviceObjGetDef(obj);\n\n    if (virNodeDeviceLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if ((device = virGetNodeDevice(conn, name)))\n        device->parentName = g_strdup(def->parent);\n\n cleanup:\n    virNodeDeviceObjEndAPI(&obj);\n    return device;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "name",
            "error"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, name=%s\"",
            "conn",
            "NULLSTR(name)"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "name"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNodeDevicePtr\nvirNodeDeviceLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->nodeDeviceDriver && conn->nodeDeviceDriver->nodeDeviceLookupByName) {\n        virNodeDevicePtr ret;\n        ret = conn->nodeDeviceDriver->nodeDeviceLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNodeListDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "160-188",
    "snippet": "int\nvirNodeListDevices(virConnectPtr conn,\n                   const char *cap,\n                   char **const names, int maxnames,\n                   unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, cap=%s, names=%p, maxnames=%d, flags=0x%x\",\n              conn, NULLSTR(cap), names, maxnames, flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->nodeDeviceDriver && conn->nodeDeviceDriver->nodeListDevices) {\n        int ret;\n        ret = conn->nodeDeviceDriver->nodeListDevices(conn, cap, names, maxnames, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nodeDeviceDriver->nodeListDevices",
          "args": [
            "conn",
            "cap",
            "names",
            "maxnames",
            "flags"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "nodeListDevices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/node_device/node_device_driver.c",
          "lines": "193-211",
          "snippet": "int\nnodeListDevices(virConnectPtr conn,\n                const char *cap,\n                char **const names,\n                int maxnames,\n                unsigned int flags)\n{\n    if (virNodeListDevicesEnsureACL(conn) < 0)\n        return -1;\n\n    virCheckFlags(0, -1);\n\n    if (nodeDeviceWaitInit() < 0)\n        return -1;\n\n    return virNodeDeviceObjListGetNames(driver->devs, conn,\n                                        virNodeListDevicesCheckACL,\n                                        cap, names, maxnames);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virnetdev.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virvhba.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_hal.h\"",
            "#include \"node_device_driver.h\"",
            "#include \"node_device_event.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virNodeDeviceDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virnetdev.h\"\n#include \"viraccessapicheck.h\"\n#include \"virvhba.h\"\n#include \"node_device_util.h\"\n#include \"node_device_hal.h\"\n#include \"node_device_driver.h\"\n#include \"node_device_event.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <time.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNodeDeviceDriverStatePtr driver;\n\nint\nnodeListDevices(virConnectPtr conn,\n                const char *cap,\n                char **const names,\n                int maxnames,\n                unsigned int flags)\n{\n    if (virNodeListDevicesEnsureACL(conn) < 0)\n        return -1;\n\n    virCheckFlags(0, -1);\n\n    if (nodeDeviceWaitInit() < 0)\n        return -1;\n\n    return virNodeDeviceObjListGetNames(driver->devs, conn,\n                                        virNodeListDevicesCheckACL,\n                                        cap, names, maxnames);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "maxnames",
            "error"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "names",
            "maxnames",
            "error"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, cap=%s, names=%p, maxnames=%d, flags=0x%x\"",
            "conn",
            "NULLSTR(cap)",
            "names",
            "maxnames",
            "flags"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "cap"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeListDevices(virConnectPtr conn,\n                   const char *cap,\n                   char **const names, int maxnames,\n                   unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, cap=%s, names=%p, maxnames=%d, flags=0x%x\",\n              conn, NULLSTR(cap), names, maxnames, flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->nodeDeviceDriver && conn->nodeDeviceDriver->nodeListDevices) {\n        int ret;\n        ret = conn->nodeDeviceDriver->nodeListDevices(conn, cap, names, maxnames, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectListAllNodeDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "112-140",
    "snippet": "int\nvirConnectListAllNodeDevices(virConnectPtr conn,\n                             virNodeDevicePtr **devices,\n                             unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, devices=%p, flags=0x%x\", conn, devices, flags);\n\n    virResetLastError();\n\n    if (devices)\n        *devices = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->nodeDeviceDriver &&\n        conn->nodeDeviceDriver->connectListAllNodeDevices) {\n        int ret;\n        ret = conn->nodeDeviceDriver->connectListAllNodeDevices(conn, devices, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nodeDeviceDriver->connectListAllNodeDevices",
          "args": [
            "conn",
            "devices",
            "flags"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, devices=%p, flags=0x%x\"",
            "conn",
            "devices",
            "flags"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectListAllNodeDevices(virConnectPtr conn,\n                             virNodeDevicePtr **devices,\n                             unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, devices=%p, flags=0x%x\", conn, devices, flags);\n\n    virResetLastError();\n\n    if (devices)\n        *devices = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->nodeDeviceDriver &&\n        conn->nodeDeviceDriver->connectListAllNodeDevices) {\n        int ret;\n        ret = conn->nodeDeviceDriver->connectListAllNodeDevices(conn, devices, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNodeNumOfDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nodedev.c",
    "lines": "44-66",
    "snippet": "int\nvirNodeNumOfDevices(virConnectPtr conn, const char *cap, unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, cap=%s, flags=0x%x\", conn, NULLSTR(cap), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->nodeDeviceDriver && conn->nodeDeviceDriver->nodeNumOfDevices) {\n        int ret;\n        ret = conn->nodeDeviceDriver->nodeNumOfDevices(conn, cap, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->nodeDeviceDriver->nodeNumOfDevices",
          "args": [
            "conn",
            "cap",
            "flags"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "nodeNumOfDevices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/node_device/node_device_driver.c",
          "lines": "175-190",
          "snippet": "int\nnodeNumOfDevices(virConnectPtr conn,\n                 const char *cap,\n                 unsigned int flags)\n{\n    if (virNodeNumOfDevicesEnsureACL(conn) < 0)\n        return -1;\n\n    virCheckFlags(0, -1);\n\n    if (nodeDeviceWaitInit() < 0)\n        return -1;\n\n    return virNodeDeviceObjListNumOfDevices(driver->devs, conn, cap,\n                                            virNodeNumOfDevicesCheckACL);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virnetdev.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virvhba.h\"",
            "#include \"node_device_util.h\"",
            "#include \"node_device_hal.h\"",
            "#include \"node_device_driver.h\"",
            "#include \"node_device_event.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virNodeDeviceDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virnetdev.h\"\n#include \"viraccessapicheck.h\"\n#include \"virvhba.h\"\n#include \"node_device_util.h\"\n#include \"node_device_hal.h\"\n#include \"node_device_driver.h\"\n#include \"node_device_event.h\"\n#include \"node_device_conf.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <time.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirNodeDeviceDriverStatePtr driver;\n\nint\nnodeNumOfDevices(virConnectPtr conn,\n                 const char *cap,\n                 unsigned int flags)\n{\n    if (virNodeNumOfDevicesEnsureACL(conn) < 0)\n        return -1;\n\n    virCheckFlags(0, -1);\n\n    if (nodeDeviceWaitInit() < 0)\n        return -1;\n\n    return virNodeDeviceObjListNumOfDevices(driver->devs, conn, cap,\n                                            virNodeNumOfDevicesCheckACL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, cap=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(cap)",
            "flags"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "cap"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNodeNumOfDevices(virConnectPtr conn, const char *cap, unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, cap=%s, flags=0x%x\", conn, NULLSTR(cap), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->nodeDeviceDriver && conn->nodeDeviceDriver->nodeNumOfDevices) {\n        int ret;\n        ret = conn->nodeDeviceDriver->nodeNumOfDevices(conn, cap, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  }
]