[
  {
    "function_name": "ebtablesRemoveForwardAllowIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virebtables.c",
    "lines": "178-187",
    "snippet": "int\nebtablesRemoveForwardAllowIn(ebtablesContext *ctx,\n                             const char *iface,\n                             const virMacAddr *mac)\n{\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n\n    virMacAddrFormat(mac, macaddr);\n    return ebtablesForwardAllowIn(ctx, iface, macaddr, REMOVE);\n}",
    "includes": [
      "#include \"virfirewall.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virebtables.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ebtablesForwardAllowIn",
          "args": [
            "ctx",
            "iface",
            "macaddr",
            "REMOVE"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "ebtablesForwardAllowIn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virebtables.c",
          "lines": "115-141",
          "snippet": "static int\nebtablesForwardAllowIn(ebtablesContext *ctx,\n                       const char *iface,\n                       const char *macaddr,\n                       int action)\n{\n    virFirewallPtr fw = NULL;\n    int ret = -1;\n\n    fw = virFirewallNew();\n    virFirewallStartTransaction(fw, 0);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       ctx->chain,\n                       \"--in-interface\", iface,\n                       \"--source\", macaddr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n\n    if (virFirewallApply(fw) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virFirewallFree(fw);\n    return ret;\n}",
          "includes": [
            "#include \"virfirewall.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virebtables.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfirewall.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virebtables.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nebtablesForwardAllowIn(ebtablesContext *ctx,\n                       const char *iface,\n                       const char *macaddr,\n                       int action)\n{\n    virFirewallPtr fw = NULL;\n    int ret = -1;\n\n    fw = virFirewallNew();\n    virFirewallStartTransaction(fw, 0);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       ctx->chain,\n                       \"--in-interface\", iface,\n                       \"--source\", macaddr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n\n    if (virFirewallApply(fw) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virFirewallFree(fw);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "mac",
            "macaddr"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfirewall.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virebtables.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nebtablesRemoveForwardAllowIn(ebtablesContext *ctx,\n                             const char *iface,\n                             const virMacAddr *mac)\n{\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n\n    virMacAddrFormat(mac, macaddr);\n    return ebtablesForwardAllowIn(ctx, iface, macaddr, REMOVE);\n}"
  },
  {
    "function_name": "ebtablesAddForwardAllowIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virebtables.c",
    "lines": "155-164",
    "snippet": "int\nebtablesAddForwardAllowIn(ebtablesContext *ctx,\n                          const char *iface,\n                          const virMacAddr *mac)\n{\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n\n    virMacAddrFormat(mac, macaddr);\n    return ebtablesForwardAllowIn(ctx, iface, macaddr, ADD);\n}",
    "includes": [
      "#include \"virfirewall.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virebtables.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ebtablesForwardAllowIn",
          "args": [
            "ctx",
            "iface",
            "macaddr",
            "ADD"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "ebtablesForwardAllowIn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virebtables.c",
          "lines": "115-141",
          "snippet": "static int\nebtablesForwardAllowIn(ebtablesContext *ctx,\n                       const char *iface,\n                       const char *macaddr,\n                       int action)\n{\n    virFirewallPtr fw = NULL;\n    int ret = -1;\n\n    fw = virFirewallNew();\n    virFirewallStartTransaction(fw, 0);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       ctx->chain,\n                       \"--in-interface\", iface,\n                       \"--source\", macaddr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n\n    if (virFirewallApply(fw) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virFirewallFree(fw);\n    return ret;\n}",
          "includes": [
            "#include \"virfirewall.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virebtables.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfirewall.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virebtables.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nebtablesForwardAllowIn(ebtablesContext *ctx,\n                       const char *iface,\n                       const char *macaddr,\n                       int action)\n{\n    virFirewallPtr fw = NULL;\n    int ret = -1;\n\n    fw = virFirewallNew();\n    virFirewallStartTransaction(fw, 0);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       ctx->chain,\n                       \"--in-interface\", iface,\n                       \"--source\", macaddr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n\n    if (virFirewallApply(fw) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virFirewallFree(fw);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "mac",
            "macaddr"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfirewall.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virebtables.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nebtablesAddForwardAllowIn(ebtablesContext *ctx,\n                          const char *iface,\n                          const virMacAddr *mac)\n{\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n\n    virMacAddrFormat(mac, macaddr);\n    return ebtablesForwardAllowIn(ctx, iface, macaddr, ADD);\n}"
  },
  {
    "function_name": "ebtablesForwardAllowIn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virebtables.c",
    "lines": "115-141",
    "snippet": "static int\nebtablesForwardAllowIn(ebtablesContext *ctx,\n                       const char *iface,\n                       const char *macaddr,\n                       int action)\n{\n    virFirewallPtr fw = NULL;\n    int ret = -1;\n\n    fw = virFirewallNew();\n    virFirewallStartTransaction(fw, 0);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       ctx->chain,\n                       \"--in-interface\", iface,\n                       \"--source\", macaddr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n\n    if (virFirewallApply(fw) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virFirewallFree(fw);\n    return ret;\n}",
    "includes": [
      "#include \"virfirewall.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virebtables.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallFree",
          "args": [
            "fw"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "286-298",
          "snippet": "void virFirewallFree(virFirewallPtr firewall)\n{\n    size_t i;\n\n    if (!firewall)\n        return;\n\n    for (i = 0; i < firewall->ngroups; i++)\n        virFirewallGroupFree(firewall->groups[i]);\n    VIR_FREE(firewall->groups);\n\n    VIR_FREE(firewall);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virFirewallFree(virFirewallPtr firewall)\n{\n    size_t i;\n\n    if (!firewall)\n        return;\n\n    for (i = 0; i < firewall->ngroups; i++)\n        virFirewallGroupFree(firewall->groups[i]);\n    VIR_FREE(firewall->groups);\n\n    VIR_FREE(firewall);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallApply",
          "args": [
            "fw"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallApply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "804-868",
          "snippet": "int\nvirFirewallApply(virFirewallPtr firewall)\n{\n    size_t i, j;\n    int ret = -1;\n\n    virMutexLock(&ruleLock);\n\n    if (currentBackend == VIR_FIREWALL_BACKEND_AUTOMATIC) {\n        /* a specific backend should have been set when the firewall\n         * object was created. If not, it means none was found.\n         */\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize a valid firewall backend\"));\n        goto cleanup;\n    }\n    if (!firewall || firewall->err == ENOMEM) {\n        virReportOOMError();\n        goto cleanup;\n    }\n    if (firewall->err) {\n        virReportSystemError(firewall->err, \"%s\",\n                             _(\"Unable to create rule\"));\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Applying groups for %p\", firewall);\n    for (i = 0; i < firewall->ngroups; i++) {\n        if (virFirewallApplyGroup(firewall, i) < 0) {\n            VIR_DEBUG(\"Rolling back groups up to %zu for %p\", i, firewall);\n            size_t first = i;\n            virErrorPtr saved_error;\n\n            virErrorPreserveLast(&saved_error);\n\n            /*\n             * Look at any inheritance markers to figure out\n             * what the first rollback group we need to apply is\n             */\n            for (j = 0; j < i; j++) {\n                VIR_DEBUG(\"Checking inheritance of group %zu\", i - j);\n                if (firewall->groups[i - j]->rollbackFlags &\n                    VIR_FIREWALL_ROLLBACK_INHERIT_PREVIOUS)\n                    first = (i - j) - 1;\n            }\n            /*\n             * Now apply all rollback groups in order\n             */\n            for (j = first; j <= i; j++) {\n                VIR_DEBUG(\"Rolling back group %zu\", j);\n                virFirewallRollbackGroup(firewall, j);\n            }\n\n            virErrorRestore(&saved_error);\n            VIR_DEBUG(\"Done rolling back groups for %p\", firewall);\n            goto cleanup;\n        }\n    }\n    VIR_DEBUG(\"Done applying groups for %p\", firewall);\n\n    ret = 0;\n cleanup:\n    virMutexUnlock(&ruleLock);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virFirewallBackend currentBackend = VIR_FIREWALL_BACKEND_AUTOMATIC;",
            "static virMutex ruleLock = VIR_MUTEX_INITIALIZER;",
            "static int\nvirFirewallValidateBackend(virFirewallBackend backend);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic virFirewallBackend currentBackend = VIR_FIREWALL_BACKEND_AUTOMATIC;\nstatic virMutex ruleLock = VIR_MUTEX_INITIALIZER;\nstatic int\nvirFirewallValidateBackend(virFirewallBackend backend);\n\nint\nvirFirewallApply(virFirewallPtr firewall)\n{\n    size_t i, j;\n    int ret = -1;\n\n    virMutexLock(&ruleLock);\n\n    if (currentBackend == VIR_FIREWALL_BACKEND_AUTOMATIC) {\n        /* a specific backend should have been set when the firewall\n         * object was created. If not, it means none was found.\n         */\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize a valid firewall backend\"));\n        goto cleanup;\n    }\n    if (!firewall || firewall->err == ENOMEM) {\n        virReportOOMError();\n        goto cleanup;\n    }\n    if (firewall->err) {\n        virReportSystemError(firewall->err, \"%s\",\n                             _(\"Unable to create rule\"));\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Applying groups for %p\", firewall);\n    for (i = 0; i < firewall->ngroups; i++) {\n        if (virFirewallApplyGroup(firewall, i) < 0) {\n            VIR_DEBUG(\"Rolling back groups up to %zu for %p\", i, firewall);\n            size_t first = i;\n            virErrorPtr saved_error;\n\n            virErrorPreserveLast(&saved_error);\n\n            /*\n             * Look at any inheritance markers to figure out\n             * what the first rollback group we need to apply is\n             */\n            for (j = 0; j < i; j++) {\n                VIR_DEBUG(\"Checking inheritance of group %zu\", i - j);\n                if (firewall->groups[i - j]->rollbackFlags &\n                    VIR_FIREWALL_ROLLBACK_INHERIT_PREVIOUS)\n                    first = (i - j) - 1;\n            }\n            /*\n             * Now apply all rollback groups in order\n             */\n            for (j = first; j <= i; j++) {\n                VIR_DEBUG(\"Rolling back group %zu\", j);\n                virFirewallRollbackGroup(firewall, j);\n            }\n\n            virErrorRestore(&saved_error);\n            VIR_DEBUG(\"Done rolling back groups for %p\", firewall);\n            goto cleanup;\n        }\n    }\n    VIR_DEBUG(\"Done applying groups for %p\", firewall);\n\n    ret = 0;\n cleanup:\n    virMutexUnlock(&ruleLock);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "VIR_FIREWALL_LAYER_ETHERNET",
            "action == ADD ? \"--insert\" : \"--delete\"",
            "ctx->chain",
            "\"--in-interface\"",
            "iface",
            "\"--source\"",
            "macaddr",
            "\"--jump\"",
            "\"ACCEPT\"",
            "NULL"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallStartTransaction",
          "args": [
            "fw",
            "0"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallStartTransaction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "586-607",
          "snippet": "void virFirewallStartTransaction(virFirewallPtr firewall,\n                                 unsigned int flags)\n{\n    virFirewallGroupPtr group;\n\n    VIR_FIREWALL_RETURN_IF_ERROR(firewall);\n\n    if (!(group = virFirewallGroupNew())) {\n        firewall->err = ENOMEM;\n        return;\n    }\n    group->actionFlags = flags;\n\n    if (VIR_EXPAND_N(firewall->groups,\n                     firewall->ngroups, 1) < 0) {\n        firewall->err = ENOMEM;\n        virFirewallGroupFree(group);\n        return;\n    }\n    firewall->groups[firewall->ngroups - 1] = group;\n    firewall->currentGroup = firewall->ngroups - 1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virFirewallStartTransaction(virFirewallPtr firewall,\n                                 unsigned int flags)\n{\n    virFirewallGroupPtr group;\n\n    VIR_FIREWALL_RETURN_IF_ERROR(firewall);\n\n    if (!(group = virFirewallGroupNew())) {\n        firewall->err = ENOMEM;\n        return;\n    }\n    group->actionFlags = flags;\n\n    if (VIR_EXPAND_N(firewall->groups,\n                     firewall->ngroups, 1) < 0) {\n        firewall->err = ENOMEM;\n        virFirewallGroupFree(group);\n        return;\n    }\n    firewall->groups[firewall->ngroups - 1] = group;\n    firewall->currentGroup = firewall->ngroups - 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallNew",
          "args": [],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "231-242",
          "snippet": "virFirewallPtr virFirewallNew(void)\n{\n    virFirewallPtr firewall;\n\n    if (virFirewallInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC(firewall) < 0)\n        return NULL;\n\n    return firewall;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallPtr virFirewallNew(void)\n{\n    virFirewallPtr firewall;\n\n    if (virFirewallInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC(firewall) < 0)\n        return NULL;\n\n    return firewall;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfirewall.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virebtables.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nebtablesForwardAllowIn(ebtablesContext *ctx,\n                       const char *iface,\n                       const char *macaddr,\n                       int action)\n{\n    virFirewallPtr fw = NULL;\n    int ret = -1;\n\n    fw = virFirewallNew();\n    virFirewallStartTransaction(fw, 0);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       action == ADD ? \"--insert\" : \"--delete\",\n                       ctx->chain,\n                       \"--in-interface\", iface,\n                       \"--source\", macaddr,\n                       \"--jump\", \"ACCEPT\",\n                       NULL);\n\n    if (virFirewallApply(fw) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virFirewallFree(fw);\n    return ret;\n}"
  },
  {
    "function_name": "ebtablesAddForwardPolicyReject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virebtables.c",
    "lines": "82-109",
    "snippet": "int\nebtablesAddForwardPolicyReject(ebtablesContext *ctx)\n{\n    virFirewallPtr fw = NULL;\n    int ret = -1;\n\n    fw = virFirewallNew();\n    virFirewallStartTransaction(fw, VIR_FIREWALL_TRANSACTION_IGNORE_ERRORS);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       \"--new-chain\", ctx->chain,\n                       NULL);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       \"--insert\", \"FORWARD\",\n                       \"--jump\", ctx->chain, NULL);\n\n    virFirewallStartTransaction(fw, 0);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       \"-P\", ctx->chain, \"DROP\",\n                       NULL);\n\n    if (virFirewallApply(fw) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virFirewallFree(fw);\n    return ret;\n}",
    "includes": [
      "#include \"virfirewall.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virebtables.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirewallFree",
          "args": [
            "fw"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "286-298",
          "snippet": "void virFirewallFree(virFirewallPtr firewall)\n{\n    size_t i;\n\n    if (!firewall)\n        return;\n\n    for (i = 0; i < firewall->ngroups; i++)\n        virFirewallGroupFree(firewall->groups[i]);\n    VIR_FREE(firewall->groups);\n\n    VIR_FREE(firewall);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virFirewallFree(virFirewallPtr firewall)\n{\n    size_t i;\n\n    if (!firewall)\n        return;\n\n    for (i = 0; i < firewall->ngroups; i++)\n        virFirewallGroupFree(firewall->groups[i]);\n    VIR_FREE(firewall->groups);\n\n    VIR_FREE(firewall);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallApply",
          "args": [
            "fw"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallApply",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "804-868",
          "snippet": "int\nvirFirewallApply(virFirewallPtr firewall)\n{\n    size_t i, j;\n    int ret = -1;\n\n    virMutexLock(&ruleLock);\n\n    if (currentBackend == VIR_FIREWALL_BACKEND_AUTOMATIC) {\n        /* a specific backend should have been set when the firewall\n         * object was created. If not, it means none was found.\n         */\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize a valid firewall backend\"));\n        goto cleanup;\n    }\n    if (!firewall || firewall->err == ENOMEM) {\n        virReportOOMError();\n        goto cleanup;\n    }\n    if (firewall->err) {\n        virReportSystemError(firewall->err, \"%s\",\n                             _(\"Unable to create rule\"));\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Applying groups for %p\", firewall);\n    for (i = 0; i < firewall->ngroups; i++) {\n        if (virFirewallApplyGroup(firewall, i) < 0) {\n            VIR_DEBUG(\"Rolling back groups up to %zu for %p\", i, firewall);\n            size_t first = i;\n            virErrorPtr saved_error;\n\n            virErrorPreserveLast(&saved_error);\n\n            /*\n             * Look at any inheritance markers to figure out\n             * what the first rollback group we need to apply is\n             */\n            for (j = 0; j < i; j++) {\n                VIR_DEBUG(\"Checking inheritance of group %zu\", i - j);\n                if (firewall->groups[i - j]->rollbackFlags &\n                    VIR_FIREWALL_ROLLBACK_INHERIT_PREVIOUS)\n                    first = (i - j) - 1;\n            }\n            /*\n             * Now apply all rollback groups in order\n             */\n            for (j = first; j <= i; j++) {\n                VIR_DEBUG(\"Rolling back group %zu\", j);\n                virFirewallRollbackGroup(firewall, j);\n            }\n\n            virErrorRestore(&saved_error);\n            VIR_DEBUG(\"Done rolling back groups for %p\", firewall);\n            goto cleanup;\n        }\n    }\n    VIR_DEBUG(\"Done applying groups for %p\", firewall);\n\n    ret = 0;\n cleanup:\n    virMutexUnlock(&ruleLock);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virFirewallBackend currentBackend = VIR_FIREWALL_BACKEND_AUTOMATIC;",
            "static virMutex ruleLock = VIR_MUTEX_INITIALIZER;",
            "static int\nvirFirewallValidateBackend(virFirewallBackend backend);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic virFirewallBackend currentBackend = VIR_FIREWALL_BACKEND_AUTOMATIC;\nstatic virMutex ruleLock = VIR_MUTEX_INITIALIZER;\nstatic int\nvirFirewallValidateBackend(virFirewallBackend backend);\n\nint\nvirFirewallApply(virFirewallPtr firewall)\n{\n    size_t i, j;\n    int ret = -1;\n\n    virMutexLock(&ruleLock);\n\n    if (currentBackend == VIR_FIREWALL_BACKEND_AUTOMATIC) {\n        /* a specific backend should have been set when the firewall\n         * object was created. If not, it means none was found.\n         */\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize a valid firewall backend\"));\n        goto cleanup;\n    }\n    if (!firewall || firewall->err == ENOMEM) {\n        virReportOOMError();\n        goto cleanup;\n    }\n    if (firewall->err) {\n        virReportSystemError(firewall->err, \"%s\",\n                             _(\"Unable to create rule\"));\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Applying groups for %p\", firewall);\n    for (i = 0; i < firewall->ngroups; i++) {\n        if (virFirewallApplyGroup(firewall, i) < 0) {\n            VIR_DEBUG(\"Rolling back groups up to %zu for %p\", i, firewall);\n            size_t first = i;\n            virErrorPtr saved_error;\n\n            virErrorPreserveLast(&saved_error);\n\n            /*\n             * Look at any inheritance markers to figure out\n             * what the first rollback group we need to apply is\n             */\n            for (j = 0; j < i; j++) {\n                VIR_DEBUG(\"Checking inheritance of group %zu\", i - j);\n                if (firewall->groups[i - j]->rollbackFlags &\n                    VIR_FIREWALL_ROLLBACK_INHERIT_PREVIOUS)\n                    first = (i - j) - 1;\n            }\n            /*\n             * Now apply all rollback groups in order\n             */\n            for (j = first; j <= i; j++) {\n                VIR_DEBUG(\"Rolling back group %zu\", j);\n                virFirewallRollbackGroup(firewall, j);\n            }\n\n            virErrorRestore(&saved_error);\n            VIR_DEBUG(\"Done rolling back groups for %p\", firewall);\n            goto cleanup;\n        }\n    }\n    VIR_DEBUG(\"Done applying groups for %p\", firewall);\n\n    ret = 0;\n cleanup:\n    virMutexUnlock(&ruleLock);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallAddRule",
          "args": [
            "fw",
            "VIR_FIREWALL_LAYER_ETHERNET",
            "\"-P\"",
            "ctx->chain",
            "\"DROP\"",
            "NULL"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallAddRuleFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "421-434",
          "snippet": "virFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallRulePtr virFirewallAddRuleFull(virFirewallPtr firewall,\n                                          virFirewallLayer layer,\n                                          bool ignoreErrors,\n                                          virFirewallQueryCallback cb,\n                                          void *opaque,\n                                          ...)\n{\n    virFirewallRulePtr rule;\n    va_list args;\n    va_start(args, opaque);\n    rule = virFirewallAddRuleFullV(firewall, layer, ignoreErrors, cb, opaque, args);\n    va_end(args);\n    return rule;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallStartTransaction",
          "args": [
            "fw",
            "0"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallStartTransaction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "586-607",
          "snippet": "void virFirewallStartTransaction(virFirewallPtr firewall,\n                                 unsigned int flags)\n{\n    virFirewallGroupPtr group;\n\n    VIR_FIREWALL_RETURN_IF_ERROR(firewall);\n\n    if (!(group = virFirewallGroupNew())) {\n        firewall->err = ENOMEM;\n        return;\n    }\n    group->actionFlags = flags;\n\n    if (VIR_EXPAND_N(firewall->groups,\n                     firewall->ngroups, 1) < 0) {\n        firewall->err = ENOMEM;\n        virFirewallGroupFree(group);\n        return;\n    }\n    firewall->groups[firewall->ngroups - 1] = group;\n    firewall->currentGroup = firewall->ngroups - 1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virFirewallStartTransaction(virFirewallPtr firewall,\n                                 unsigned int flags)\n{\n    virFirewallGroupPtr group;\n\n    VIR_FIREWALL_RETURN_IF_ERROR(firewall);\n\n    if (!(group = virFirewallGroupNew())) {\n        firewall->err = ENOMEM;\n        return;\n    }\n    group->actionFlags = flags;\n\n    if (VIR_EXPAND_N(firewall->groups,\n                     firewall->ngroups, 1) < 0) {\n        firewall->err = ENOMEM;\n        virFirewallGroupFree(group);\n        return;\n    }\n    firewall->groups[firewall->ngroups - 1] = group;\n    firewall->currentGroup = firewall->ngroups - 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirewallNew",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "virFirewallNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirewall.c",
          "lines": "231-242",
          "snippet": "virFirewallPtr virFirewallNew(void)\n{\n    virFirewallPtr firewall;\n\n    if (virFirewallInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC(firewall) < 0)\n        return NULL;\n\n    return firewall;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfirewalld.h\"",
            "#include \"virfirewallpriv.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virfirewalld.h\"\n#include \"virfirewallpriv.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirFirewallPtr virFirewallNew(void)\n{\n    virFirewallPtr firewall;\n\n    if (virFirewallInitialize() < 0)\n        return NULL;\n\n    if (VIR_ALLOC(firewall) < 0)\n        return NULL;\n\n    return firewall;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfirewall.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virebtables.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nebtablesAddForwardPolicyReject(ebtablesContext *ctx)\n{\n    virFirewallPtr fw = NULL;\n    int ret = -1;\n\n    fw = virFirewallNew();\n    virFirewallStartTransaction(fw, VIR_FIREWALL_TRANSACTION_IGNORE_ERRORS);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       \"--new-chain\", ctx->chain,\n                       NULL);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       \"--insert\", \"FORWARD\",\n                       \"--jump\", ctx->chain, NULL);\n\n    virFirewallStartTransaction(fw, 0);\n    virFirewallAddRule(fw, VIR_FIREWALL_LAYER_ETHERNET,\n                       \"-P\", ctx->chain, \"DROP\",\n                       NULL);\n\n    if (virFirewallApply(fw) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virFirewallFree(fw);\n    return ret;\n}"
  },
  {
    "function_name": "ebtablesContextFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virebtables.c",
    "lines": "72-79",
    "snippet": "void\nebtablesContextFree(ebtablesContext *ctx)\n{\n    if (!ctx)\n        return;\n    VIR_FREE(ctx->chain);\n    VIR_FREE(ctx);\n}",
    "includes": [
      "#include \"virfirewall.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virebtables.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ctx"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ctx->chain"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virfirewall.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virebtables.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nebtablesContextFree(ebtablesContext *ctx)\n{\n    if (!ctx)\n        return;\n    VIR_FREE(ctx->chain);\n    VIR_FREE(ctx);\n}"
  },
  {
    "function_name": "ebtablesContextNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virebtables.c",
    "lines": "53-64",
    "snippet": "ebtablesContext *\nebtablesContextNew(const char *driver)\n{\n    ebtablesContext *ctx = NULL;\n\n    if (VIR_ALLOC(ctx) < 0)\n        return NULL;\n\n    ctx->chain = g_strdup_printf(\"libvirt_%s_FORWARD\", driver);\n\n    return ctx;\n}",
    "includes": [
      "#include \"virfirewall.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virebtables.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"libvirt_%s_FORWARD\"",
            "driver"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ctx"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virfirewall.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virebtables.h\"\n#include \"internal.h\"\n#include <config.h>\n\nebtablesContext *\nebtablesContextNew(const char *driver)\n{\n    ebtablesContext *ctx = NULL;\n\n    if (VIR_ALLOC(ctx) < 0)\n        return NULL;\n\n    ctx->chain = g_strdup_printf(\"libvirt_%s_FORWARD\", driver);\n\n    return ctx;\n}"
  }
]