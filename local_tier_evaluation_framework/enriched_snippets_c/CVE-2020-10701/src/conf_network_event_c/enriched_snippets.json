[
  {
    "function_name": "virNetworkEventLifecycleNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_event.c",
    "lines": "214-237",
    "snippet": "virObjectEventPtr\nvirNetworkEventLifecycleNew(const char *name,\n                            const unsigned char *uuid,\n                            int type,\n                            int detail)\n{\n    virNetworkEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virNetworkEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virNetworkEventLifecycleClass,\n                                    virNetworkEventDispatchDefaultFunc,\n                                    VIR_NETWORK_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNetworkEventLifecycleClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventNew",
          "args": [
            "virNetworkEventLifecycleClass",
            "virNetworkEventDispatchDefaultFunc",
            "VIR_NETWORK_EVENT_ID_LIFECYCLE",
            "0",
            "name",
            "uuid",
            "uuidstr"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "597-633",
          "snippet": "void *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventClass;",
            "static void virObjectEventDispose(void *obj);",
            "static void virObjectEventStateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\nstatic void virObjectEventDispose(void *obj);\nstatic void virObjectEventStateDispose(void *obj);\n\nvoid *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkEventsInitialize",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include <config.h>\n\nstatic virClassPtr virNetworkEventLifecycleClass;\n\nvirObjectEventPtr\nvirNetworkEventLifecycleNew(const char *name,\n                            const unsigned char *uuid,\n                            int type,\n                            int detail)\n{\n    virNetworkEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virNetworkEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    if (!(event = virObjectEventNew(virNetworkEventLifecycleClass,\n                                    virNetworkEventDispatchDefaultFunc,\n                                    VIR_NETWORK_EVENT_ID_LIFECYCLE,\n                                    0, name, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}"
  },
  {
    "function_name": "virNetworkEventStateRegisterClient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_event.c",
    "lines": "179-202",
    "snippet": "int\nvirNetworkEventStateRegisterClient(virConnectPtr conn,\n                                   virObjectEventStatePtr state,\n                                   virNetworkPtr net,\n                                   int eventID,\n                                   virConnectNetworkEventGenericCallback cb,\n                                   void *opaque,\n                                   virFreeCallback freecb,\n                                   int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virNetworkEventsInitialize() < 0)\n        return -1;\n\n    if (net)\n        virUUIDFormat(net->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, net ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virNetworkEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, true);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNetworkEventClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateRegisterID",
          "args": [
            "conn",
            "state",
            "net ? uuidstr : NULL",
            "NULL",
            "NULL",
            "virNetworkEventClass",
            "eventID",
            "VIR_OBJECT_EVENT_CALLBACK(cb)",
            "opaque",
            "freecb",
            "false",
            "callbackID",
            "true"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateRegisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "870-917",
          "snippet": "int\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_OBJECT_EVENT_CALLBACK",
          "args": [
            "cb"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "net->uuid",
            "uuidstr"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkEventsInitialize",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include <config.h>\n\nstatic virClassPtr virNetworkEventClass;\n\nint\nvirNetworkEventStateRegisterClient(virConnectPtr conn,\n                                   virObjectEventStatePtr state,\n                                   virNetworkPtr net,\n                                   int eventID,\n                                   virConnectNetworkEventGenericCallback cb,\n                                   void *opaque,\n                                   virFreeCallback freecb,\n                                   int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virNetworkEventsInitialize() < 0)\n        return -1;\n\n    if (net)\n        virUUIDFormat(net->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, net ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virNetworkEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, true);\n}"
  },
  {
    "function_name": "virNetworkEventStateRegisterID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_event.c",
    "lines": "135-158",
    "snippet": "int\nvirNetworkEventStateRegisterID(virConnectPtr conn,\n                               virObjectEventStatePtr state,\n                               virNetworkPtr net,\n                               int eventID,\n                               virConnectNetworkEventGenericCallback cb,\n                               void *opaque,\n                               virFreeCallback freecb,\n                               int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virNetworkEventsInitialize() < 0)\n        return -1;\n\n    if (net)\n        virUUIDFormat(net->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, net ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virNetworkEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNetworkEventClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateRegisterID",
          "args": [
            "conn",
            "state",
            "net ? uuidstr : NULL",
            "NULL",
            "NULL",
            "virNetworkEventClass",
            "eventID",
            "VIR_OBJECT_EVENT_CALLBACK(cb)",
            "opaque",
            "freecb",
            "false",
            "callbackID",
            "false"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateRegisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "870-917",
          "snippet": "int\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_OBJECT_EVENT_CALLBACK",
          "args": [
            "cb"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "net->uuid",
            "uuidstr"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkEventsInitialize",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include <config.h>\n\nstatic virClassPtr virNetworkEventClass;\n\nint\nvirNetworkEventStateRegisterID(virConnectPtr conn,\n                               virObjectEventStatePtr state,\n                               virNetworkPtr net,\n                               int eventID,\n                               virConnectNetworkEventGenericCallback cb,\n                               void *opaque,\n                               virFreeCallback freecb,\n                               int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virNetworkEventsInitialize() < 0)\n        return -1;\n\n    if (net)\n        virUUIDFormat(net->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, net ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virNetworkEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}"
  },
  {
    "function_name": "virNetworkEventDispatchDefaultFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_event.c",
    "lines": "85-115",
    "snippet": "static void\nvirNetworkEventDispatchDefaultFunc(virConnectPtr conn,\n                                   virObjectEventPtr event,\n                                   virConnectObjectEventGenericCallback cb,\n                                   void *cbopaque)\n{\n    virNetworkPtr net = virGetNetwork(conn, event->meta.name, event->meta.uuid);\n    if (!net)\n        return;\n\n    switch ((virNetworkEventID)event->eventID) {\n    case VIR_NETWORK_EVENT_ID_LIFECYCLE:\n        {\n            virNetworkEventLifecyclePtr networkLifecycleEvent;\n\n            networkLifecycleEvent = (virNetworkEventLifecyclePtr)event;\n            ((virConnectNetworkEventLifecycleCallback)cb)(conn, net,\n                                                          networkLifecycleEvent->type,\n                                                          networkLifecycleEvent->detail,\n                                                          cbopaque);\n            goto cleanup;\n        }\n\n    case VIR_NETWORK_EVENT_ID_LAST:\n        break;\n    }\n    VIR_WARN(\"Unexpected event ID %d\", event->eventID);\n\n cleanup:\n    virObjectUnref(net);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "net"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unexpected event ID %d\"",
            "event->eventID"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "conn",
            "net",
            "networkLifecycleEvent->type",
            "networkLifecycleEvent->detail",
            "cbopaque"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetNetwork",
          "args": [
            "conn",
            "event->meta.name",
            "event->meta.uuid"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "virGetNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "341-366",
          "snippet": "virNetworkPtr\nvirGetNetwork(virConnectPtr conn, const char *name, const unsigned char *uuid)\n{\n    virNetworkPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virNetworkClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virNetworkClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virNetworkClass;\n\nvirNetworkPtr\nvirGetNetwork(virConnectPtr conn, const char *name, const unsigned char *uuid)\n{\n    virNetworkPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virNetworkClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include <config.h>\n\nstatic void\nvirNetworkEventDispatchDefaultFunc(virConnectPtr conn,\n                                   virObjectEventPtr event,\n                                   virConnectObjectEventGenericCallback cb,\n                                   void *cbopaque)\n{\n    virNetworkPtr net = virGetNetwork(conn, event->meta.name, event->meta.uuid);\n    if (!net)\n        return;\n\n    switch ((virNetworkEventID)event->eventID) {\n    case VIR_NETWORK_EVENT_ID_LIFECYCLE:\n        {\n            virNetworkEventLifecyclePtr networkLifecycleEvent;\n\n            networkLifecycleEvent = (virNetworkEventLifecyclePtr)event;\n            ((virConnectNetworkEventLifecycleCallback)cb)(conn, net,\n                                                          networkLifecycleEvent->type,\n                                                          networkLifecycleEvent->detail,\n                                                          cbopaque);\n            goto cleanup;\n        }\n\n    case VIR_NETWORK_EVENT_ID_LAST:\n        break;\n    }\n    VIR_WARN(\"Unexpected event ID %d\", event->eventID);\n\n cleanup:\n    virObjectUnref(net);\n}"
  },
  {
    "function_name": "virNetworkEventLifecycleDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_event.c",
    "lines": "77-82",
    "snippet": "static void\nvirNetworkEventLifecycleDispose(void *obj)\n{\n    virNetworkEventLifecyclePtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkEventDispose(void *obj);",
      "static void virNetworkEventLifecycleDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "event"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include <config.h>\n\nstatic void virNetworkEventDispose(void *obj);\nstatic void virNetworkEventLifecycleDispose(void *obj);\n\nstatic void\nvirNetworkEventLifecycleDispose(void *obj)\n{\n    virNetworkEventLifecyclePtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}"
  },
  {
    "function_name": "virNetworkEventDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_event.c",
    "lines": "69-74",
    "snippet": "static void\nvirNetworkEventDispose(void *obj)\n{\n    virNetworkEventPtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetworkEventDispose(void *obj);",
      "static void virNetworkEventLifecycleDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "event"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include <config.h>\n\nstatic void virNetworkEventDispose(void *obj);\nstatic void virNetworkEventLifecycleDispose(void *obj);\n\nstatic void\nvirNetworkEventDispose(void *obj)\n{\n    virNetworkEventPtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}"
  },
  {
    "function_name": "virNetworkEventsOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/network_event.c",
    "lines": "55-65",
    "snippet": "static int\nvirNetworkEventsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNetworkEvent, virClassForObjectEvent()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virNetworkEventLifecycle, virNetworkEventClass))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"network_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNetworkEventClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNetworkEventLifecycle",
            "virNetworkEventClass"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNetworkEvent",
            "virClassForObjectEvent()"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectEvent",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectEvent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "110-116",
          "snippet": "virClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\n\nvirClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include <config.h>\n\nstatic virClassPtr virNetworkEventClass;\n\nstatic int\nvirNetworkEventsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNetworkEvent, virClassForObjectEvent()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virNetworkEventLifecycle, virNetworkEventClass))\n        return -1;\n\n    return 0;\n}"
  }
]