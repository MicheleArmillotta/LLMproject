[
  {
    "function_name": "virConnectGetStoragePoolCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "2371-2397",
    "snippet": "char *\nvirConnectGetStoragePoolCapabilities(virConnectPtr conn,\n                                     unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, flags=0x%x\", conn, flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n\n    if (conn->storageDriver &&\n        conn->storageDriver->connectGetStoragePoolCapabilities) {\n        char *ret;\n        ret = conn->storageDriver->connectGetStoragePoolCapabilities(conn,\n                                                                     flags);\n        if (!ret)\n            goto error;\n        VIR_DEBUG(\"conn=%p, ret=%s\", conn, ret);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 2395
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, ret=%s\"",
            "conn",
            "ret"
          ],
          "line": 2388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->connectGetStoragePoolCapabilities",
          "args": [
            "conn",
            "flags"
          ],
          "line": 2384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 2379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2377
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, flags=0x%x\"",
            "conn",
            "flags"
          ],
          "line": 2375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nchar *\nvirConnectGetStoragePoolCapabilities(virConnectPtr conn,\n                                     unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, flags=0x%x\", conn, flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n\n    if (conn->storageDriver &&\n        conn->storageDriver->connectGetStoragePoolCapabilities) {\n        char *ret;\n        ret = conn->storageDriver->connectGetStoragePoolCapabilities(conn,\n                                                                     flags);\n        if (!ret)\n            goto error;\n        VIR_DEBUG(\"conn=%p, ret=%s\", conn, ret);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virConnectStoragePoolEventDeregisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "2332-2357",
    "snippet": "int\nvirConnectStoragePoolEventDeregisterAny(virConnectPtr conn,\n                                        int callbackID)\n{\n    VIR_DEBUG(\"conn=%p, callbackID=%d\", conn, callbackID);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNegativeArgGoto(callbackID, error);\n\n    if (conn->storageDriver &&\n        conn->storageDriver->connectStoragePoolEventDeregisterAny) {\n        int ret;\n        ret = conn->storageDriver->connectStoragePoolEventDeregisterAny(conn,\n                                                                        callbackID);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 2355
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->connectStoragePoolEventDeregisterAny",
          "args": [
            "conn",
            "callbackID"
          ],
          "line": 2346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "callbackID",
            "error"
          ],
          "line": 2341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 2340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2338
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, callbackID=%d\"",
            "conn",
            "callbackID"
          ],
          "line": 2336
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectStoragePoolEventDeregisterAny(virConnectPtr conn,\n                                        int callbackID)\n{\n    VIR_DEBUG(\"conn=%p, callbackID=%d\", conn, callbackID);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNegativeArgGoto(callbackID, error);\n\n    if (conn->storageDriver &&\n        conn->storageDriver->connectStoragePoolEventDeregisterAny) {\n        int ret;\n        ret = conn->storageDriver->connectStoragePoolEventDeregisterAny(conn,\n                                                                        callbackID);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectStoragePoolEventRegisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "2269-2320",
    "snippet": "int\nvirConnectStoragePoolEventRegisterAny(virConnectPtr conn,\n                                      virStoragePoolPtr pool,\n                                      int eventID,\n                                      virConnectStoragePoolEventGenericCallback cb,\n                                      void *opaque,\n                                      virFreeCallback freecb)\n{\n    VIR_DEBUG(\"conn=%p, pool=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\",\n              conn, pool, eventID, cb, opaque, freecb);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    if (pool) {\n        virCheckStoragePoolGoto(pool, error);\n        if (pool->conn != conn) {\n            virReportInvalidArg(pool,\n                                _(\"storage pool '%s' in %s must match connection\"),\n                                pool->name, __FUNCTION__);\n            goto error;\n        }\n    }\n    virCheckNonNullArgGoto(cb, error);\n    virCheckNonNegativeArgGoto(eventID, error);\n\n    if (eventID >= VIR_STORAGE_POOL_EVENT_ID_LAST) {\n        virReportInvalidArg(eventID,\n                            _(\"eventID in %s must be less than %d\"),\n                            __FUNCTION__, VIR_STORAGE_POOL_EVENT_ID_LAST);\n        goto error;\n    }\n\n    if (conn->storageDriver &&\n        conn->storageDriver->connectStoragePoolEventRegisterAny) {\n        int ret;\n        ret = conn->storageDriver->connectStoragePoolEventRegisterAny(conn,\n                                                                      pool,\n                                                                      eventID,\n                                                                      cb,\n                                                                      opaque,\n                                                                      freecb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 2318
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->connectStoragePoolEventRegisterAny",
          "args": [
            "conn",
            "pool",
            "eventID",
            "cb",
            "opaque",
            "freecb"
          ],
          "line": 2305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "eventID",
            "_(\"eventID in %s must be less than %d\")",
            "__FUNCTION__",
            "VIR_STORAGE_POOL_EVENT_ID_LAST"
          ],
          "line": 2296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"eventID in %s must be less than %d\""
          ],
          "line": 2297
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "eventID",
            "error"
          ],
          "line": 2293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cb",
            "error"
          ],
          "line": 2292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "pool",
            "_(\"storage pool '%s' in %s must match connection\")",
            "pool->name",
            "__FUNCTION__"
          ],
          "line": 2286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolGoto",
          "args": [
            "pool",
            "error"
          ],
          "line": 2284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 2282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2280
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, pool=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\"",
            "conn",
            "pool",
            "eventID",
            "cb",
            "opaque",
            "freecb"
          ],
          "line": 2277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectStoragePoolEventRegisterAny(virConnectPtr conn,\n                                      virStoragePoolPtr pool,\n                                      int eventID,\n                                      virConnectStoragePoolEventGenericCallback cb,\n                                      void *opaque,\n                                      virFreeCallback freecb)\n{\n    VIR_DEBUG(\"conn=%p, pool=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\",\n              conn, pool, eventID, cb, opaque, freecb);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    if (pool) {\n        virCheckStoragePoolGoto(pool, error);\n        if (pool->conn != conn) {\n            virReportInvalidArg(pool,\n                                _(\"storage pool '%s' in %s must match connection\"),\n                                pool->name, __FUNCTION__);\n            goto error;\n        }\n    }\n    virCheckNonNullArgGoto(cb, error);\n    virCheckNonNegativeArgGoto(eventID, error);\n\n    if (eventID >= VIR_STORAGE_POOL_EVENT_ID_LAST) {\n        virReportInvalidArg(eventID,\n                            _(\"eventID in %s must be less than %d\"),\n                            __FUNCTION__, VIR_STORAGE_POOL_EVENT_ID_LAST);\n        goto error;\n    }\n\n    if (conn->storageDriver &&\n        conn->storageDriver->connectStoragePoolEventRegisterAny) {\n        int ret;\n        ret = conn->storageDriver->connectStoragePoolEventRegisterAny(conn,\n                                                                      pool,\n                                                                      eventID,\n                                                                      cb,\n                                                                      opaque,\n                                                                      freecb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolIsPersistent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "2211-2232",
    "snippet": "int\nvirStoragePoolIsPersistent(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    if (pool->conn->storageDriver->storagePoolIsPersistent) {\n        int ret;\n        ret = pool->conn->storageDriver->storagePoolIsPersistent(pool);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 2230
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pool->conn->storageDriver->storagePoolIsPersistent",
          "args": [
            "pool"
          ],
          "line": 2222
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolIsPersistent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "699-718",
          "snippet": "static int\nstoragePoolIsPersistent(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolIsPersistentEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    ret = virStoragePoolObjGetConfigFile(obj) ? 1 : 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolIsPersistent(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolIsPersistentEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    ret = virStoragePoolObjGetConfigFile(obj) ? 1 : 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 2218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2216
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p\"",
            "pool"
          ],
          "line": 2214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolIsPersistent(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    if (pool->conn->storageDriver->storagePoolIsPersistent) {\n        int ret;\n        ret = pool->conn->storageDriver->storagePoolIsPersistent(pool);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolIsActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "2178-2199",
    "snippet": "int\nvirStoragePoolIsActive(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    if (pool->conn->storageDriver->storagePoolIsActive) {\n        int ret;\n        ret = pool->conn->storageDriver->storagePoolIsActive(pool);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 2197
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pool->conn->storageDriver->storagePoolIsActive",
          "args": [
            "pool"
          ],
          "line": 2189
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "677-696",
          "snippet": "static int\nstoragePoolIsActive(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolIsActiveEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    ret = virStoragePoolObjIsActive(obj);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolIsActive(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolIsActiveEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    ret = virStoragePoolObjIsActive(obj);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 2185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2183
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p\"",
            "pool"
          ],
          "line": 2181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolIsActive(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    if (pool->conn->storageDriver->storagePoolIsActive) {\n        int ret;\n        ret = pool->conn->storageDriver->storagePoolIsActive(pool);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStorageVolResize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "2129-2167",
    "snippet": "int\nvirStorageVolResize(virStorageVolPtr vol,\n                    unsigned long long capacity,\n                    unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p capacity=%llu flags=0x%x\", vol, capacity, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    conn = vol->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    /* Zero capacity is only valid with either delta or shrink.  */\n    if (capacity == 0 && !((flags & VIR_STORAGE_VOL_RESIZE_DELTA) ||\n                           (flags & VIR_STORAGE_VOL_RESIZE_SHRINK))) {\n        virReportInvalidArg(capacity,\n                            _(\"capacity in %s cannot be zero without 'delta' \"\n                              \"or 'shrink' flags set\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    if (conn->storageDriver && conn->storageDriver->storageVolResize) {\n        int ret;\n        ret = conn->storageDriver->storageVolResize(vol, capacity, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "vol->conn"
          ],
          "line": 2165
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storageVolResize",
          "args": [
            "vol",
            "capacity",
            "flags"
          ],
          "line": 2156
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolResize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2466-2564",
          "snippet": "static int\nstorageVolResize(virStorageVolPtr vol,\n                 unsigned long long capacity,\n                 unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef = NULL;\n    unsigned long long abs_capacity, delta = 0;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_RESIZE_ALLOCATE |\n                  VIR_STORAGE_VOL_RESIZE_DELTA |\n                  VIR_STORAGE_VOL_RESIZE_SHRINK, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolResizeEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (flags & VIR_STORAGE_VOL_RESIZE_DELTA) {\n        if (flags & VIR_STORAGE_VOL_RESIZE_SHRINK)\n            abs_capacity = voldef->target.capacity - MIN(capacity, voldef->target.capacity);\n        else\n            abs_capacity = voldef->target.capacity + capacity;\n        flags &= ~VIR_STORAGE_VOL_RESIZE_DELTA;\n    } else {\n        abs_capacity = capacity;\n    }\n\n    if (abs_capacity < voldef->target.allocation) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"can't shrink capacity below \"\n                         \"existing allocation\"));\n        goto cleanup;\n    }\n\n    if (abs_capacity < voldef->target.capacity &&\n        !(flags & VIR_STORAGE_VOL_RESIZE_SHRINK)) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Can't shrink capacity below current \"\n                         \"capacity unless shrink flag explicitly specified\"));\n        goto cleanup;\n    }\n\n    if (flags & VIR_STORAGE_VOL_RESIZE_ALLOCATE)\n        delta = abs_capacity - voldef->target.allocation;\n\n    if (delta > def->available) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"Not enough space left in storage pool\"));\n        goto cleanup;\n    }\n\n    if (!backend->resizeVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool does not support changing of \"\n                         \"volume capacity\"));\n        goto cleanup;\n    }\n\n    if (backend->resizeVol(obj, voldef, abs_capacity, flags) < 0)\n        goto cleanup;\n\n    voldef->target.capacity = abs_capacity;\n    /* Only update the allocation and pool values if we actually did the\n     * allocation; otherwise, this is akin to a create operation with a\n     * capacity value different and potentially much larger than available\n     */\n    if (flags & VIR_STORAGE_VOL_RESIZE_ALLOCATE) {\n        voldef->target.allocation = abs_capacity;\n        def->allocation += delta;\n        def->available -= delta;\n    }\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolResize(virStorageVolPtr vol,\n                 unsigned long long capacity,\n                 unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef = NULL;\n    unsigned long long abs_capacity, delta = 0;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_RESIZE_ALLOCATE |\n                  VIR_STORAGE_VOL_RESIZE_DELTA |\n                  VIR_STORAGE_VOL_RESIZE_SHRINK, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolResizeEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (flags & VIR_STORAGE_VOL_RESIZE_DELTA) {\n        if (flags & VIR_STORAGE_VOL_RESIZE_SHRINK)\n            abs_capacity = voldef->target.capacity - MIN(capacity, voldef->target.capacity);\n        else\n            abs_capacity = voldef->target.capacity + capacity;\n        flags &= ~VIR_STORAGE_VOL_RESIZE_DELTA;\n    } else {\n        abs_capacity = capacity;\n    }\n\n    if (abs_capacity < voldef->target.allocation) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"can't shrink capacity below \"\n                         \"existing allocation\"));\n        goto cleanup;\n    }\n\n    if (abs_capacity < voldef->target.capacity &&\n        !(flags & VIR_STORAGE_VOL_RESIZE_SHRINK)) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Can't shrink capacity below current \"\n                         \"capacity unless shrink flag explicitly specified\"));\n        goto cleanup;\n    }\n\n    if (flags & VIR_STORAGE_VOL_RESIZE_ALLOCATE)\n        delta = abs_capacity - voldef->target.allocation;\n\n    if (delta > def->available) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"Not enough space left in storage pool\"));\n        goto cleanup;\n    }\n\n    if (!backend->resizeVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool does not support changing of \"\n                         \"volume capacity\"));\n        goto cleanup;\n    }\n\n    if (backend->resizeVol(obj, voldef, abs_capacity, flags) < 0)\n        goto cleanup;\n\n    voldef->target.capacity = abs_capacity;\n    /* Only update the allocation and pool values if we actually did the\n     * allocation; otherwise, this is akin to a create operation with a\n     * capacity value different and potentially much larger than available\n     */\n    if (flags & VIR_STORAGE_VOL_RESIZE_ALLOCATE) {\n        voldef->target.allocation = abs_capacity;\n        def->allocation += delta;\n        def->available -= delta;\n    }\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "capacity",
            "_(\"capacity in %s cannot be zero without 'delta' \"\n                              \"or 'shrink' flags set\")",
            "__FUNCTION__"
          ],
          "line": 2147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"capacity in %s cannot be zero without 'delta' \"\n                              \"or 'shrink' flags set\""
          ],
          "line": 2148
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 2142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "-1"
          ],
          "line": 2139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2137
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p capacity=%llu flags=0x%x\"",
            "vol",
            "capacity",
            "flags"
          ],
          "line": 2135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStorageVolResize(virStorageVolPtr vol,\n                    unsigned long long capacity,\n                    unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p capacity=%llu flags=0x%x\", vol, capacity, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    conn = vol->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    /* Zero capacity is only valid with either delta or shrink.  */\n    if (capacity == 0 && !((flags & VIR_STORAGE_VOL_RESIZE_DELTA) ||\n                           (flags & VIR_STORAGE_VOL_RESIZE_SHRINK))) {\n        virReportInvalidArg(capacity,\n                            _(\"capacity in %s cannot be zero without 'delta' \"\n                              \"or 'shrink' flags set\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    if (conn->storageDriver && conn->storageDriver->storageVolResize) {\n        int ret;\n        ret = conn->storageDriver->storageVolResize(vol, capacity, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStorageVolGetPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "2068-2092",
    "snippet": "char *\nvirStorageVolGetPath(virStorageVolPtr vol)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n    conn = vol->conn;\n\n    if (conn->storageDriver && conn->storageDriver->storageVolGetPath) {\n        char *ret;\n        ret = conn->storageDriver->storageVolGetPath(vol);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "vol->conn"
          ],
          "line": 2090
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2087
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storageVolGetPath",
          "args": [
            "vol"
          ],
          "line": 2081
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolGetPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2734-2753",
          "snippet": "static char *\nstorageVolGetPath(virStorageVolPtr vol)\n{\n    virStoragePoolObjPtr obj;\n    virStorageVolDefPtr voldef;\n    char *ret = NULL;\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, NULL)))\n        return NULL;\n\n    if (virStorageVolGetPathEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                      voldef) < 0)\n        goto cleanup;\n\n    ret = g_strdup(voldef->target.path);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nstorageVolGetPath(virStorageVolPtr vol)\n{\n    virStoragePoolObjPtr obj;\n    virStorageVolDefPtr voldef;\n    char *ret = NULL;\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, NULL)))\n        return NULL;\n\n    if (virStorageVolGetPathEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                      voldef) < 0)\n        goto cleanup;\n\n    ret = g_strdup(voldef->target.path);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "NULL"
          ],
          "line": 2076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2074
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p\"",
            "vol"
          ],
          "line": 2072
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nchar *\nvirStorageVolGetPath(virStorageVolPtr vol)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n    conn = vol->conn;\n\n    if (conn->storageDriver && conn->storageDriver->storageVolGetPath) {\n        char *ret;\n        ret = conn->storageDriver->storageVolGetPath(vol);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageVolGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "2027-2052",
    "snippet": "char *\nvirStorageVolGetXMLDesc(virStorageVolPtr vol,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, flags=0x%x\", vol, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n    conn = vol->conn;\n\n    if (conn->storageDriver && conn->storageDriver->storageVolGetXMLDesc) {\n        char *ret;\n        ret = conn->storageDriver->storageVolGetXMLDesc(vol, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "vol->conn"
          ],
          "line": 2050
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storageVolGetXMLDesc",
          "args": [
            "vol",
            "flags"
          ],
          "line": 2041
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolGetXMLDesc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2703-2732",
          "snippet": "static char *\nstorageVolGetXMLDesc(virStorageVolPtr vol,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolGetXMLDescEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0)\n        goto cleanup;\n\n    ret = virStorageVolDefFormat(def, voldef);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nstorageVolGetXMLDesc(virStorageVolPtr vol,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolGetXMLDescEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0)\n        goto cleanup;\n\n    ret = virStorageVolDefFormat(def, voldef);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "NULL"
          ],
          "line": 2036
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2034
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p, flags=0x%x\"",
            "vol",
            "flags"
          ],
          "line": 2032
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nchar *\nvirStorageVolGetXMLDesc(virStorageVolPtr vol,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, flags=0x%x\", vol, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n    conn = vol->conn;\n\n    if (conn->storageDriver && conn->storageDriver->storageVolGetXMLDesc) {\n        char *ret;\n        ret = conn->storageDriver->storageVolGetXMLDesc(vol, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageVolGetInfoFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1983-2014",
    "snippet": "int\nvirStorageVolGetInfoFlags(virStorageVolPtr vol,\n                          virStorageVolInfoPtr info,\n                          unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, info=%p, flags=0x%x\", vol, info, flags);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckStorageVolReturn(vol, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = vol->conn;\n\n    if (conn->storageDriver->storageVolGetInfoFlags) {\n        int ret;\n        ret = conn->storageDriver->storageVolGetInfoFlags(vol, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "vol->conn"
          ],
          "line": 2012
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storageVolGetInfoFlags",
          "args": [
            "vol",
            "info",
            "flags"
          ],
          "line": 2003
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolGetInfoFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2656-2692",
          "snippet": "static int\nstorageVolGetInfoFlags(virStorageVolPtr vol,\n                       virStorageVolInfoPtr info,\n                       unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_GET_PHYSICAL, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolGetInfoFlagsEnsureACL(vol->conn,\n                                           virStoragePoolObjGetDef(obj),\n                                           voldef) < 0)\n        goto cleanup;\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0)\n        goto cleanup;\n\n    memset(info, 0, sizeof(*info));\n    info->type = voldef->type;\n    info->capacity = voldef->target.capacity;\n    if (flags & VIR_STORAGE_VOL_GET_PHYSICAL)\n        info->allocation = voldef->target.physical;\n    else\n        info->allocation = voldef->target.allocation;\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolGetInfoFlags(virStorageVolPtr vol,\n                       virStorageVolInfoPtr info,\n                       unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_GET_PHYSICAL, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolGetInfoFlagsEnsureACL(vol->conn,\n                                           virStoragePoolObjGetDef(obj),\n                                           voldef) < 0)\n        goto cleanup;\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0)\n        goto cleanup;\n\n    memset(info, 0, sizeof(*info));\n    info->type = voldef->type;\n    info->capacity = voldef->target.capacity;\n    if (flags & VIR_STORAGE_VOL_GET_PHYSICAL)\n        info->allocation = voldef->target.physical;\n    else\n        info->allocation = voldef->target.allocation;\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "info",
            "error"
          ],
          "line": 1997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "-1"
          ],
          "line": 1996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(*info)"
          ],
          "line": 1994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1991
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p, info=%p, flags=0x%x\"",
            "vol",
            "info",
            "flags"
          ],
          "line": 1989
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStorageVolGetInfoFlags(virStorageVolPtr vol,\n                          virStorageVolInfoPtr info,\n                          unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, info=%p, flags=0x%x\", vol, info, flags);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckStorageVolReturn(vol, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = vol->conn;\n\n    if (conn->storageDriver->storageVolGetInfoFlags) {\n        int ret;\n        ret = conn->storageDriver->storageVolGetInfoFlags(vol, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStorageVolGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1933-1963",
    "snippet": "int\nvirStorageVolGetInfo(virStorageVolPtr vol,\n                     virStorageVolInfoPtr info)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, info=%p\", vol, info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckStorageVolReturn(vol, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = vol->conn;\n\n    if (conn->storageDriver->storageVolGetInfo) {\n        int ret;\n        ret = conn->storageDriver->storageVolGetInfo(vol, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "vol->conn"
          ],
          "line": 1961
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storageVolGetInfo",
          "args": [
            "vol",
            "info"
          ],
          "line": 1952
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolGetInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2695-2700",
          "snippet": "static int\nstorageVolGetInfo(virStorageVolPtr vol,\n                  virStorageVolInfoPtr info)\n{\n    return storageVolGetInfoFlags(vol, info, 0);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolGetInfo(virStorageVolPtr vol,\n                  virStorageVolInfoPtr info)\n{\n    return storageVolGetInfoFlags(vol, info, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "info",
            "error"
          ],
          "line": 1946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "-1"
          ],
          "line": 1945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(*info)"
          ],
          "line": 1943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1940
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p, info=%p\"",
            "vol",
            "info"
          ],
          "line": 1938
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStorageVolGetInfo(virStorageVolPtr vol,\n                     virStorageVolInfoPtr info)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, info=%p\", vol, info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckStorageVolReturn(vol, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = vol->conn;\n\n    if (conn->storageDriver->storageVolGetInfo) {\n        int ret;\n        ret = conn->storageDriver->storageVolGetInfo(vol, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStorageVolRef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1909-1920",
    "snippet": "int\nvirStorageVolRef(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p refs=%d\", vol, vol ? vol->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n\n    virObjectRef(vol);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "vol"
          ],
          "line": 1918
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "-1"
          ],
          "line": 1916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1914
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p refs=%d\"",
            "vol",
            "vol ? vol->parent.u.s.refs : 0"
          ],
          "line": 1912
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStorageVolRef(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p refs=%d\", vol, vol ? vol->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n\n    virObjectRef(vol);\n    return 0;\n}"
  },
  {
    "function_name": "virStorageVolFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1878-1889",
    "snippet": "int\nvirStorageVolFree(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n\n    virObjectUnref(vol);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "vol"
          ],
          "line": 1887
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "-1"
          ],
          "line": 1885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1883
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p\"",
            "vol"
          ],
          "line": 1881
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStorageVolFree(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n\n    virObjectUnref(vol);\n    return 0;\n}"
  },
  {
    "function_name": "virStorageVolWipePattern",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1838-1866",
    "snippet": "int\nvirStorageVolWipePattern(virStorageVolPtr vol,\n                         unsigned int algorithm,\n                         unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, algorithm=%u, flags=0x%x\", vol, algorithm, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    conn = vol->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storageVolWipePattern) {\n        int ret;\n        ret = conn->storageDriver->storageVolWipePattern(vol, algorithm, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "vol->conn"
          ],
          "line": 1864
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storageVolWipePattern",
          "args": [
            "vol",
            "algorithm",
            "flags"
          ],
          "line": 1855
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolWipePattern",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2567-2646",
          "snippet": "static int\nstorageVolWipePattern(virStorageVolPtr vol,\n                      unsigned int algorithm,\n                      unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStorageVolDefPtr voldef = NULL;\n    int rc;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (algorithm >= VIR_STORAGE_VOL_WIPE_ALG_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"wiping algorithm %d not supported\"),\n                       algorithm);\n        return -1;\n    }\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolWipePatternEnsureACL(vol->conn,\n                                          virStoragePoolObjGetDef(obj),\n                                          voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->wipeVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume wiping\"));\n        goto cleanup;\n    }\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    rc = backend->wipeVol(obj, voldef, algorithm, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (rc < 0)\n        goto cleanup;\n\n    /* For local volumes, Instead of using the refreshVol, since\n     * much changes on the target volume, let's update using the\n     * same function as refreshPool would use when it discovers a\n     * volume. The only failure to capture is -1, we can ignore\n     * -2. */\n    if ((backend->type == VIR_STORAGE_POOL_DIR ||\n         backend->type == VIR_STORAGE_POOL_FS ||\n         backend->type == VIR_STORAGE_POOL_NETFS ||\n         backend->type == VIR_STORAGE_POOL_VSTORAGE) &&\n        virStorageBackendRefreshVolTargetUpdate(voldef) == -1)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolWipePattern(virStorageVolPtr vol,\n                      unsigned int algorithm,\n                      unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStorageVolDefPtr voldef = NULL;\n    int rc;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (algorithm >= VIR_STORAGE_VOL_WIPE_ALG_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"wiping algorithm %d not supported\"),\n                       algorithm);\n        return -1;\n    }\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolWipePatternEnsureACL(vol->conn,\n                                          virStoragePoolObjGetDef(obj),\n                                          voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->wipeVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume wiping\"));\n        goto cleanup;\n    }\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    rc = backend->wipeVol(obj, voldef, algorithm, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (rc < 0)\n        goto cleanup;\n\n    /* For local volumes, Instead of using the refreshVol, since\n     * much changes on the target volume, let's update using the\n     * same function as refreshPool would use when it discovers a\n     * volume. The only failure to capture is -1, we can ignore\n     * -2. */\n    if ((backend->type == VIR_STORAGE_POOL_DIR ||\n         backend->type == VIR_STORAGE_POOL_FS ||\n         backend->type == VIR_STORAGE_POOL_NETFS ||\n         backend->type == VIR_STORAGE_POOL_VSTORAGE) &&\n        virStorageBackendRefreshVolTargetUpdate(voldef) == -1)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "-1"
          ],
          "line": 1848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1846
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p, algorithm=%u, flags=0x%x\"",
            "vol",
            "algorithm",
            "flags"
          ],
          "line": 1844
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStorageVolWipePattern(virStorageVolPtr vol,\n                         unsigned int algorithm,\n                         unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, algorithm=%u, flags=0x%x\", vol, algorithm, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    conn = vol->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storageVolWipePattern) {\n        int ret;\n        ret = conn->storageDriver->storageVolWipePattern(vol, algorithm, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStorageVolWipe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1792-1819",
    "snippet": "int\nvirStorageVolWipe(virStorageVolPtr vol,\n                  unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, flags=0x%x\", vol, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    conn = vol->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storageVolWipe) {\n        int ret;\n        ret = conn->storageDriver->storageVolWipe(vol, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "vol->conn"
          ],
          "line": 1817
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storageVolWipe",
          "args": [
            "vol",
            "flags"
          ],
          "line": 1808
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolWipe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2648-2653",
          "snippet": "static int\nstorageVolWipe(virStorageVolPtr vol,\n               unsigned int flags)\n{\n    return storageVolWipePattern(vol, VIR_STORAGE_VOL_WIPE_ALG_ZERO, flags);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolWipe(virStorageVolPtr vol,\n               unsigned int flags)\n{\n    return storageVolWipePattern(vol, VIR_STORAGE_VOL_WIPE_ALG_ZERO, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "-1"
          ],
          "line": 1801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1799
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p, flags=0x%x\"",
            "vol",
            "flags"
          ],
          "line": 1797
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStorageVolWipe(virStorageVolPtr vol,\n                  unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, flags=0x%x\", vol, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    conn = vol->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storageVolWipe) {\n        int ret;\n        ret = conn->storageDriver->storageVolWipe(vol, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStorageVolDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1743-1770",
    "snippet": "int\nvirStorageVolDelete(virStorageVolPtr vol,\n                    unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, flags=0x%x\", vol, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    conn = vol->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storageVolDelete) {\n        int ret;\n        ret = conn->storageDriver->storageVolDelete(vol, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "vol->conn"
          ],
          "line": 1768
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storageVolDelete",
          "args": [
            "vol",
            "flags"
          ],
          "line": 1759
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1846-1884",
          "snippet": "static int\nstorageVolDelete(virStorageVolPtr vol,\n                 unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef = NULL;\n    int ret = -1;\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolDeleteEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                     voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (storageVolDeleteInternal(backend, obj, voldef, flags, true) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolDelete(virStorageVolPtr vol,\n                 unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldef = NULL;\n    int ret = -1;\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolDeleteEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                     voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (storageVolDeleteInternal(backend, obj, voldef, flags, true) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "-1"
          ],
          "line": 1752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1750
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p, flags=0x%x\"",
            "vol",
            "flags"
          ],
          "line": 1748
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStorageVolDelete(virStorageVolPtr vol,\n                    unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"vol=%p, flags=0x%x\", vol, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    conn = vol->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storageVolDelete) {\n        int ret;\n        ret = conn->storageDriver->storageVolDelete(vol, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStorageVolUpload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1690-1731",
    "snippet": "int\nvirStorageVolUpload(virStorageVolPtr vol,\n                    virStreamPtr stream,\n                    unsigned long long offset,\n                    unsigned long long length,\n                    unsigned int flags)\n{\n    VIR_DEBUG(\"vol=%p, stream=%p, offset=%llu, length=%llu, flags=0x%x\",\n              vol, stream, offset, length, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    virCheckStreamGoto(stream, error);\n    virCheckReadOnlyGoto(vol->conn->flags, error);\n\n    if (vol->conn != stream->conn) {\n        virReportInvalidArg(stream,\n                            _(\"stream in %s must match connection of volume '%s'\"),\n                            __FUNCTION__, vol->name);\n        goto error;\n    }\n\n    if (vol->conn->storageDriver &&\n        vol->conn->storageDriver->storageVolUpload) {\n        int ret;\n        ret = vol->conn->storageDriver->storageVolUpload(vol,\n                                                  stream,\n                                                  offset,\n                                                  length,\n                                                  flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "vol->conn"
          ],
          "line": 1729
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vol->conn->storageDriver->storageVolUpload",
          "args": [
            "vol",
            "stream",
            "offset",
            "length",
            "flags"
          ],
          "line": 1716
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolUpload",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2381-2464",
          "snippet": "static int\nstorageVolUpload(virStorageVolPtr vol,\n                 virStreamPtr stream,\n                 unsigned long long offset,\n                 unsigned long long length,\n                 unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef = NULL;\n    virStorageVolStreamInfoPtr cbdata = NULL;\n    int rc;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_UPLOAD_SPARSE_STREAM, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolUploadEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->uploadVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume upload\"));\n        goto cleanup;\n    }\n\n    /* Use the callback routine in order to\n     * refresh the pool after the volume upload stream closes. This way\n     * we make sure the volume and pool data are refreshed without user\n     * interaction and we can just lookup the backend in the callback\n     * routine in order to call the refresh API.\n     */\n    if (VIR_ALLOC(cbdata) < 0)\n        goto cleanup;\n    cbdata->pool_name = g_strdup(def->name);\n    if (voldef->type == VIR_STORAGE_VOL_PLOOP)\n        cbdata->vol_path = g_strdup(voldef->target.path);\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    rc = backend->uploadVol(obj, voldef, stream, offset, length, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (rc < 0)\n        goto cleanup;\n\n    /* Add cleanup callback - call after uploadVol since the stream\n     * is then fully set up\n     */\n    virFDStreamSetInternalCloseCb(stream,\n                                  virStorageVolFDStreamCloseCb,\n                                  cbdata, NULL);\n    cbdata = NULL;\n    ret = 0;\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    if (cbdata)\n        virStorageVolPoolRefreshDataFree(cbdata);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolUpload(virStorageVolPtr vol,\n                 virStreamPtr stream,\n                 unsigned long long offset,\n                 unsigned long long length,\n                 unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef = NULL;\n    virStorageVolStreamInfoPtr cbdata = NULL;\n    int rc;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_UPLOAD_SPARSE_STREAM, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStorageVolUploadEnsureACL(vol->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (voldef->in_use) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->uploadVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume upload\"));\n        goto cleanup;\n    }\n\n    /* Use the callback routine in order to\n     * refresh the pool after the volume upload stream closes. This way\n     * we make sure the volume and pool data are refreshed without user\n     * interaction and we can just lookup the backend in the callback\n     * routine in order to call the refresh API.\n     */\n    if (VIR_ALLOC(cbdata) < 0)\n        goto cleanup;\n    cbdata->pool_name = g_strdup(def->name);\n    if (voldef->type == VIR_STORAGE_VOL_PLOOP)\n        cbdata->vol_path = g_strdup(voldef->target.path);\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    rc = backend->uploadVol(obj, voldef, stream, offset, length, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (rc < 0)\n        goto cleanup;\n\n    /* Add cleanup callback - call after uploadVol since the stream\n     * is then fully set up\n     */\n    virFDStreamSetInternalCloseCb(stream,\n                                  virStorageVolFDStreamCloseCb,\n                                  cbdata, NULL);\n    cbdata = NULL;\n    ret = 0;\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    if (cbdata)\n        virStorageVolPoolRefreshDataFree(cbdata);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "stream",
            "_(\"stream in %s must match connection of volume '%s'\")",
            "__FUNCTION__",
            "vol->name"
          ],
          "line": 1707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"stream in %s must match connection of volume '%s'\""
          ],
          "line": 1708
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "vol->conn->flags",
            "error"
          ],
          "line": 1704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStreamGoto",
          "args": [
            "stream",
            "error"
          ],
          "line": 1703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "-1"
          ],
          "line": 1702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1700
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p, stream=%p, offset=%llu, length=%llu, flags=0x%x\"",
            "vol",
            "stream",
            "offset",
            "length",
            "flags"
          ],
          "line": 1697
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStorageVolUpload(virStorageVolPtr vol,\n                    virStreamPtr stream,\n                    unsigned long long offset,\n                    unsigned long long length,\n                    unsigned int flags)\n{\n    VIR_DEBUG(\"vol=%p, stream=%p, offset=%llu, length=%llu, flags=0x%x\",\n              vol, stream, offset, length, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    virCheckStreamGoto(stream, error);\n    virCheckReadOnlyGoto(vol->conn->flags, error);\n\n    if (vol->conn != stream->conn) {\n        virReportInvalidArg(stream,\n                            _(\"stream in %s must match connection of volume '%s'\"),\n                            __FUNCTION__, vol->name);\n        goto error;\n    }\n\n    if (vol->conn->storageDriver &&\n        vol->conn->storageDriver->storageVolUpload) {\n        int ret;\n        ret = vol->conn->storageDriver->storageVolUpload(vol,\n                                                  stream,\n                                                  offset,\n                                                  length,\n                                                  flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStorageVolDownload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1610-1651",
    "snippet": "int\nvirStorageVolDownload(virStorageVolPtr vol,\n                      virStreamPtr stream,\n                      unsigned long long offset,\n                      unsigned long long length,\n                      unsigned int flags)\n{\n    VIR_DEBUG(\"vol=%p, stream=%p, offset=%llu, length=%llu, flags=0x%x\",\n              vol, stream, offset, length, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    virCheckStreamGoto(stream, error);\n    virCheckReadOnlyGoto(vol->conn->flags, error);\n\n    if (vol->conn != stream->conn) {\n        virReportInvalidArg(stream,\n                            _(\"stream in %s must match connection of volume '%s'\"),\n                            __FUNCTION__, vol->name);\n        goto error;\n    }\n\n    if (vol->conn->storageDriver &&\n        vol->conn->storageDriver->storageVolDownload) {\n        int ret;\n        ret = vol->conn->storageDriver->storageVolDownload(vol,\n                                                           stream,\n                                                           offset,\n                                                           length,\n                                                           flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "vol->conn"
          ],
          "line": 1649
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vol->conn->storageDriver->storageVolDownload",
          "args": [
            "vol",
            "stream",
            "offset",
            "length",
            "flags"
          ],
          "line": 1636
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolDownload",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2215-2263",
          "snippet": "static int\nstorageVolDownload(virStorageVolPtr vol,\n                   virStreamPtr stream,\n                   unsigned long long offset,\n                   unsigned long long length,\n                   unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStorageVolDefPtr voldef = NULL;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_DOWNLOAD_SPARSE_STREAM, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolDownloadEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                       voldef) < 0)\n        goto cleanup;\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->downloadVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume download\"));\n        goto cleanup;\n    }\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    ret = backend->downloadVol(obj, voldef, stream, offset, length, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstorageVolDownload(virStorageVolPtr vol,\n                   virStreamPtr stream,\n                   unsigned long long offset,\n                   unsigned long long length,\n                   unsigned int flags)\n{\n    virStorageBackendPtr backend;\n    virStoragePoolObjPtr obj = NULL;\n    virStorageVolDefPtr voldef = NULL;\n    int ret = -1;\n\n    virCheckFlags(VIR_STORAGE_VOL_DOWNLOAD_SPARSE_STREAM, -1);\n\n    if (!(voldef = virStorageVolDefFromVol(vol, &obj, &backend)))\n        return -1;\n\n    if (virStorageVolDownloadEnsureACL(vol->conn, virStoragePoolObjGetDef(obj),\n                                       voldef) < 0)\n        goto cleanup;\n\n    if (voldef->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->downloadVol) {\n        virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                       _(\"storage pool doesn't support volume download\"));\n        goto cleanup;\n    }\n\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->in_use++;\n    virObjectUnlock(obj);\n\n    ret = backend->downloadVol(obj, voldef, stream, offset, length, flags);\n\n    virObjectLock(obj);\n    voldef->in_use--;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "stream",
            "_(\"stream in %s must match connection of volume '%s'\")",
            "__FUNCTION__",
            "vol->name"
          ],
          "line": 1627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"stream in %s must match connection of volume '%s'\""
          ],
          "line": 1628
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "vol->conn->flags",
            "error"
          ],
          "line": 1624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStreamGoto",
          "args": [
            "stream",
            "error"
          ],
          "line": 1623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "-1"
          ],
          "line": 1622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1620
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p, stream=%p, offset=%llu, length=%llu, flags=0x%x\"",
            "vol",
            "stream",
            "offset",
            "length",
            "flags"
          ],
          "line": 1617
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStorageVolDownload(virStorageVolPtr vol,\n                      virStreamPtr stream,\n                      unsigned long long offset,\n                      unsigned long long length,\n                      unsigned int flags)\n{\n    VIR_DEBUG(\"vol=%p, stream=%p, offset=%llu, length=%llu, flags=0x%x\",\n              vol, stream, offset, length, flags);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, -1);\n    virCheckStreamGoto(stream, error);\n    virCheckReadOnlyGoto(vol->conn->flags, error);\n\n    if (vol->conn != stream->conn) {\n        virReportInvalidArg(stream,\n                            _(\"stream in %s must match connection of volume '%s'\"),\n                            __FUNCTION__, vol->name);\n        goto error;\n    }\n\n    if (vol->conn->storageDriver &&\n        vol->conn->storageDriver->storageVolDownload) {\n        int ret;\n        ret = vol->conn->storageDriver->storageVolDownload(vol,\n                                                           stream,\n                                                           offset,\n                                                           length,\n                                                           flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStorageVolCreateXMLFrom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1549-1580",
    "snippet": "virStorageVolPtr\nvirStorageVolCreateXMLFrom(virStoragePoolPtr pool,\n                           const char *xmlDesc,\n                           virStorageVolPtr clonevol,\n                           unsigned int flags)\n{\n    VIR_DEBUG(\"pool=%p, xmlDesc=%s, clonevol=%p, flags=0x%x\",\n              pool, NULLSTR(xmlDesc), clonevol, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n    virCheckStorageVolGoto(clonevol, error);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(pool->conn->flags | clonevol->conn->flags, error);\n\n    if (pool->conn->storageDriver &&\n        pool->conn->storageDriver->storageVolCreateXMLFrom) {\n        virStorageVolPtr ret;\n        ret = pool->conn->storageDriver->storageVolCreateXMLFrom(pool, xmlDesc,\n                                                          clonevol, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 1578
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pool->conn->storageDriver->storageVolCreateXMLFrom",
          "args": [
            "pool",
            "xmlDesc",
            "clonevol",
            "flags"
          ],
          "line": 1568
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolCreateXMLFrom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "2020-2212",
          "snippet": "static virStorageVolPtr\nstorageVolCreateXMLFrom(virStoragePoolPtr pool,\n                        const char *xmldesc,\n                        virStorageVolPtr volsrc,\n                        unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolObjPtr objsrc = NULL;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldefsrc = NULL;\n    virStorageVolDefPtr shadowvol = NULL;\n    virStorageVolPtr newvol = NULL;\n    virStorageVolPtr vol = NULL;\n    int buildret;\n    g_autoptr(virStorageVolDef) voldef = NULL;\n\n    virCheckFlags(VIR_STORAGE_VOL_CREATE_PREALLOC_METADATA |\n                  VIR_STORAGE_VOL_CREATE_REFLINK,\n                  NULL);\n\n    obj = virStoragePoolObjFindByUUID(driver->pools, pool->uuid);\n    if (obj && STRNEQ(pool->name, volsrc->pool)) {\n        virObjectUnlock(obj);\n        objsrc = virStoragePoolObjFindByName(driver->pools, volsrc->pool);\n        virObjectLock(obj);\n    }\n    if (!obj) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(pool->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching uuid '%s' (%s)\"),\n                       uuidstr, pool->name);\n        goto cleanup;\n    }\n    def = virStoragePoolObjGetDef(obj);\n\n    if (STRNEQ(pool->name, volsrc->pool) && !objsrc) {\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"),\n                       volsrc->pool);\n        goto cleanup;\n    }\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (objsrc && !virStoragePoolObjIsActive(objsrc)) {\n        virStoragePoolDefPtr objsrcdef = virStoragePoolObjGetDef(objsrc);\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       objsrcdef->name);\n        goto cleanup;\n    }\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    voldefsrc = virStorageVolDefFindByName(objsrc ?\n                                           objsrc : obj, volsrc->name);\n    if (!voldefsrc) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       volsrc->name);\n        goto cleanup;\n    }\n\n    voldef = virStorageVolDefParseString(def, xmldesc,\n                                         VIR_VOL_XML_PARSE_NO_CAPACITY);\n    if (voldef == NULL)\n        goto cleanup;\n\n    if (virStorageVolCreateXMLFromEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (virStorageVolDefFindByName(obj, voldef->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"storage volume name '%s' already in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    /* Use the original volume's capacity in case the new capacity\n     * is less than that, or it was omitted */\n    if (voldef->target.capacity < voldefsrc->target.capacity)\n        voldef->target.capacity = voldefsrc->target.capacity;\n\n    /* If the allocation was not provided in the XML, then use capacity\n     * as it's specifically documented \"If omitted when creating a volume,\n     * the  volume will be fully allocated at time of creation.\". This\n     * is especially important for logical volume creation. */\n    if (!voldef->target.has_allocation)\n        voldef->target.allocation = voldef->target.capacity;\n\n    if (!backend->buildVolFrom) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support\"\n                               \" volume creation from an existing volume\"));\n        goto cleanup;\n    }\n\n    if (voldefsrc->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldefsrc->name);\n        goto cleanup;\n    }\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldefsrc) < 0)\n        goto cleanup;\n\n    /* 'Define' the new volume so we get async progress reporting.\n     * Wipe any key the user may have suggested, as volume creation\n     * will generate the canonical key.  */\n    VIR_FREE(voldef->key);\n    if (backend->createVol(obj, voldef) < 0)\n        goto cleanup;\n\n    /* Make a shallow copy of the 'defined' volume definition, since the\n     * original allocation value will change as the user polls 'info',\n     * but we only need the initial requested values\n     */\n    if (VIR_ALLOC(shadowvol) < 0)\n        goto cleanup;\n\n    memcpy(shadowvol, voldef, sizeof(*voldef));\n\n    if (!(newvol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                                    voldef->key, NULL, NULL)))\n        goto cleanup;\n\n    /* NB: Upon success voldef \"owned\" by storage pool for deletion purposes */\n    if (virStoragePoolObjAddVol(obj, voldef) < 0)\n        goto cleanup;\n\n    /* Drop the pool lock during volume allocation */\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->building = true;\n    voldefsrc->in_use++;\n    virObjectUnlock(obj);\n\n    if (objsrc) {\n        virStoragePoolObjIncrAsyncjobs(objsrc);\n        virObjectUnlock(objsrc);\n    }\n\n    buildret = backend->buildVolFrom(obj, shadowvol, voldefsrc, flags);\n\n    virObjectLock(obj);\n    if (objsrc)\n        virObjectLock(objsrc);\n\n    voldefsrc->in_use--;\n    voldef->building = false;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (objsrc) {\n        virStoragePoolObjDecrAsyncjobs(objsrc);\n        virStoragePoolObjEndAPI(&objsrc);\n    }\n\n    if (buildret < 0 ||\n        (backend->refreshVol &&\n         backend->refreshVol(obj, voldef) < 0)) {\n        storageVolDeleteInternal(backend, obj, voldef, 0, false);\n        voldef = NULL;\n        goto cleanup;\n    }\n\n    /* Updating pool metadata ignoring the disk backend since\n     * it updates the pool values\n     */\n    if (def->type != VIR_STORAGE_POOL_DISK) {\n        def->allocation += voldef->target.allocation;\n        def->available -= voldef->target.allocation;\n    }\n\n    VIR_INFO(\"Creating volume '%s' in storage pool '%s'\",\n             newvol->name, def->name);\n    vol = g_steal_pointer(&newvol);\n    voldef = NULL;\n\n cleanup:\n    virObjectUnref(newvol);\n    VIR_FREE(shadowvol);\n    virStoragePoolObjEndAPI(&obj);\n    virStoragePoolObjEndAPI(&objsrc);\n    return vol;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStorageVolPtr\nstorageVolCreateXMLFrom(virStoragePoolPtr pool,\n                        const char *xmldesc,\n                        virStorageVolPtr volsrc,\n                        unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolObjPtr objsrc = NULL;\n    virStorageBackendPtr backend;\n    virStorageVolDefPtr voldefsrc = NULL;\n    virStorageVolDefPtr shadowvol = NULL;\n    virStorageVolPtr newvol = NULL;\n    virStorageVolPtr vol = NULL;\n    int buildret;\n    g_autoptr(virStorageVolDef) voldef = NULL;\n\n    virCheckFlags(VIR_STORAGE_VOL_CREATE_PREALLOC_METADATA |\n                  VIR_STORAGE_VOL_CREATE_REFLINK,\n                  NULL);\n\n    obj = virStoragePoolObjFindByUUID(driver->pools, pool->uuid);\n    if (obj && STRNEQ(pool->name, volsrc->pool)) {\n        virObjectUnlock(obj);\n        objsrc = virStoragePoolObjFindByName(driver->pools, volsrc->pool);\n        virObjectLock(obj);\n    }\n    if (!obj) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(pool->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching uuid '%s' (%s)\"),\n                       uuidstr, pool->name);\n        goto cleanup;\n    }\n    def = virStoragePoolObjGetDef(obj);\n\n    if (STRNEQ(pool->name, volsrc->pool) && !objsrc) {\n        virReportError(VIR_ERR_NO_STORAGE_POOL,\n                       _(\"no storage pool with matching name '%s'\"),\n                       volsrc->pool);\n        goto cleanup;\n    }\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (objsrc && !virStoragePoolObjIsActive(objsrc)) {\n        virStoragePoolDefPtr objsrcdef = virStoragePoolObjGetDef(objsrc);\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"),\n                       objsrcdef->name);\n        goto cleanup;\n    }\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    voldefsrc = virStorageVolDefFindByName(objsrc ?\n                                           objsrc : obj, volsrc->name);\n    if (!voldefsrc) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       volsrc->name);\n        goto cleanup;\n    }\n\n    voldef = virStorageVolDefParseString(def, xmldesc,\n                                         VIR_VOL_XML_PARSE_NO_CAPACITY);\n    if (voldef == NULL)\n        goto cleanup;\n\n    if (virStorageVolCreateXMLFromEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (virStorageVolDefFindByName(obj, voldef->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"storage volume name '%s' already in use.\"),\n                       voldef->name);\n        goto cleanup;\n    }\n\n    /* Use the original volume's capacity in case the new capacity\n     * is less than that, or it was omitted */\n    if (voldef->target.capacity < voldefsrc->target.capacity)\n        voldef->target.capacity = voldefsrc->target.capacity;\n\n    /* If the allocation was not provided in the XML, then use capacity\n     * as it's specifically documented \"If omitted when creating a volume,\n     * the  volume will be fully allocated at time of creation.\". This\n     * is especially important for logical volume creation. */\n    if (!voldef->target.has_allocation)\n        voldef->target.allocation = voldef->target.capacity;\n\n    if (!backend->buildVolFrom) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support\"\n                               \" volume creation from an existing volume\"));\n        goto cleanup;\n    }\n\n    if (voldefsrc->building) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"volume '%s' is still being allocated.\"),\n                       voldefsrc->name);\n        goto cleanup;\n    }\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldefsrc) < 0)\n        goto cleanup;\n\n    /* 'Define' the new volume so we get async progress reporting.\n     * Wipe any key the user may have suggested, as volume creation\n     * will generate the canonical key.  */\n    VIR_FREE(voldef->key);\n    if (backend->createVol(obj, voldef) < 0)\n        goto cleanup;\n\n    /* Make a shallow copy of the 'defined' volume definition, since the\n     * original allocation value will change as the user polls 'info',\n     * but we only need the initial requested values\n     */\n    if (VIR_ALLOC(shadowvol) < 0)\n        goto cleanup;\n\n    memcpy(shadowvol, voldef, sizeof(*voldef));\n\n    if (!(newvol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                                    voldef->key, NULL, NULL)))\n        goto cleanup;\n\n    /* NB: Upon success voldef \"owned\" by storage pool for deletion purposes */\n    if (virStoragePoolObjAddVol(obj, voldef) < 0)\n        goto cleanup;\n\n    /* Drop the pool lock during volume allocation */\n    virStoragePoolObjIncrAsyncjobs(obj);\n    voldef->building = true;\n    voldefsrc->in_use++;\n    virObjectUnlock(obj);\n\n    if (objsrc) {\n        virStoragePoolObjIncrAsyncjobs(objsrc);\n        virObjectUnlock(objsrc);\n    }\n\n    buildret = backend->buildVolFrom(obj, shadowvol, voldefsrc, flags);\n\n    virObjectLock(obj);\n    if (objsrc)\n        virObjectLock(objsrc);\n\n    voldefsrc->in_use--;\n    voldef->building = false;\n    virStoragePoolObjDecrAsyncjobs(obj);\n\n    if (objsrc) {\n        virStoragePoolObjDecrAsyncjobs(objsrc);\n        virStoragePoolObjEndAPI(&objsrc);\n    }\n\n    if (buildret < 0 ||\n        (backend->refreshVol &&\n         backend->refreshVol(obj, voldef) < 0)) {\n        storageVolDeleteInternal(backend, obj, voldef, 0, false);\n        voldef = NULL;\n        goto cleanup;\n    }\n\n    /* Updating pool metadata ignoring the disk backend since\n     * it updates the pool values\n     */\n    if (def->type != VIR_STORAGE_POOL_DISK) {\n        def->allocation += voldef->target.allocation;\n        def->available -= voldef->target.allocation;\n    }\n\n    VIR_INFO(\"Creating volume '%s' in storage pool '%s'\",\n             newvol->name, def->name);\n    vol = g_steal_pointer(&newvol);\n    voldef = NULL;\n\n cleanup:\n    virObjectUnref(newvol);\n    VIR_FREE(shadowvol);\n    virStoragePoolObjEndAPI(&obj);\n    virStoragePoolObjEndAPI(&objsrc);\n    return vol;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "pool->conn->flags | clonevol->conn->flags",
            "error"
          ],
          "line": 1563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xmlDesc",
            "error"
          ],
          "line": 1562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolGoto",
          "args": [
            "clonevol",
            "error"
          ],
          "line": 1561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "NULL"
          ],
          "line": 1560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1558
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, xmlDesc=%s, clonevol=%p, flags=0x%x\"",
            "pool",
            "NULLSTR(xmlDesc)",
            "clonevol",
            "flags"
          ],
          "line": 1555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmlDesc"
          ],
          "line": 1556
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStorageVolPtr\nvirStorageVolCreateXMLFrom(virStoragePoolPtr pool,\n                           const char *xmlDesc,\n                           virStorageVolPtr clonevol,\n                           unsigned int flags)\n{\n    VIR_DEBUG(\"pool=%p, xmlDesc=%s, clonevol=%p, flags=0x%x\",\n              pool, NULLSTR(xmlDesc), clonevol, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n    virCheckStorageVolGoto(clonevol, error);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(pool->conn->flags | clonevol->conn->flags, error);\n\n    if (pool->conn->storageDriver &&\n        pool->conn->storageDriver->storageVolCreateXMLFrom) {\n        virStorageVolPtr ret;\n        ret = pool->conn->storageDriver->storageVolCreateXMLFrom(pool, xmlDesc,\n                                                          clonevol, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageVolCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1498-1524",
    "snippet": "virStorageVolPtr\nvirStorageVolCreateXML(virStoragePoolPtr pool,\n                       const char *xmlDesc,\n                       unsigned int flags)\n{\n    VIR_DEBUG(\"pool=%p, xmlDesc=%s, flags=0x%x\", pool, NULLSTR(xmlDesc), flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(pool->conn->flags, error);\n\n    if (pool->conn->storageDriver && pool->conn->storageDriver->storageVolCreateXML) {\n        virStorageVolPtr ret;\n        ret = pool->conn->storageDriver->storageVolCreateXML(pool, xmlDesc, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 1522
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pool->conn->storageDriver->storageVolCreateXML",
          "args": [
            "pool",
            "xmlDesc",
            "flags"
          ],
          "line": 1513
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolCreateXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1887-2018",
          "snippet": "static virStorageVolPtr\nstorageVolCreateXML(virStoragePoolPtr pool,\n                    const char *xmldesc,\n                    unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virStorageVolPtr vol = NULL, newvol = NULL;\n    g_autoptr(virStorageVolDef) voldef = NULL;\n\n    virCheckFlags(VIR_STORAGE_VOL_CREATE_PREALLOC_METADATA, NULL);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    voldef = virStorageVolDefParseString(def, xmldesc,\n                                         VIR_VOL_XML_PARSE_OPT_CAPACITY);\n    if (voldef == NULL)\n        goto cleanup;\n\n    if (!voldef->target.capacity && !backend->buildVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"volume capacity required for this \"\n                               \"storage pool\"));\n        goto cleanup;\n    }\n\n    if (virStorageVolCreateXMLEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (virStorageVolDefFindByName(obj, voldef->name)) {\n        virReportError(VIR_ERR_STORAGE_VOL_EXIST,\n                       _(\"'%s'\"), voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->createVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support volume \"\n                               \"creation\"));\n        goto cleanup;\n    }\n\n    /* Wipe any key the user may have suggested, as volume creation\n     * will generate the canonical key.  */\n    VIR_FREE(voldef->key);\n    if (backend->createVol(obj, voldef) < 0)\n        goto cleanup;\n\n    if (!(newvol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                                    voldef->key, NULL, NULL)))\n        goto cleanup;\n\n    /* NB: Upon success voldef \"owned\" by storage pool for deletion purposes */\n    if (virStoragePoolObjAddVol(obj, voldef) < 0)\n        goto cleanup;\n\n    if (backend->buildVol) {\n        int buildret;\n        virStorageVolDefPtr buildvoldef = NULL;\n\n        if (VIR_ALLOC(buildvoldef) < 0) {\n            voldef = NULL;\n            goto cleanup;\n        }\n\n        /* Make a shallow copy of the 'defined' volume definition, since the\n         * original allocation value will change as the user polls 'info',\n         * but we only need the initial requested values\n         */\n        memcpy(buildvoldef, voldef, sizeof(*voldef));\n\n        /* Drop the pool lock during volume allocation */\n        virStoragePoolObjIncrAsyncjobs(obj);\n        voldef->building = true;\n        virObjectUnlock(obj);\n\n        buildret = backend->buildVol(obj, buildvoldef, flags);\n\n        VIR_FREE(buildvoldef);\n\n        virObjectLock(obj);\n\n        voldef->building = false;\n        virStoragePoolObjDecrAsyncjobs(obj);\n\n        if (buildret < 0) {\n            /* buildVol handles deleting volume on failure */\n            virStoragePoolObjRemoveVol(obj, voldef);\n            voldef = NULL;\n            goto cleanup;\n        }\n\n    }\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0) {\n        storageVolDeleteInternal(backend, obj, voldef,\n                                 0, false);\n        voldef = NULL;\n        goto cleanup;\n    }\n\n    /* Update pool metadata ignoring the disk backend since\n     * it updates the pool values.\n     */\n    if (def->type != VIR_STORAGE_POOL_DISK) {\n        def->allocation += voldef->target.allocation;\n        def->available -= voldef->target.allocation;\n    }\n\n    VIR_INFO(\"Creating volume '%s' in storage pool '%s'\",\n             newvol->name, def->name);\n    vol = g_steal_pointer(&newvol);\n    voldef = NULL;\n\n cleanup:\n    virObjectUnref(newvol);\n    virStoragePoolObjEndAPI(&obj);\n    return vol;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolPtr\nstorageVolCreateXML(virStoragePoolPtr pool,\n                    const char *xmldesc,\n                    unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virStorageVolPtr vol = NULL, newvol = NULL;\n    g_autoptr(virStorageVolDef) voldef = NULL;\n\n    virCheckFlags(VIR_STORAGE_VOL_CREATE_PREALLOC_METADATA, NULL);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    voldef = virStorageVolDefParseString(def, xmldesc,\n                                         VIR_VOL_XML_PARSE_OPT_CAPACITY);\n    if (voldef == NULL)\n        goto cleanup;\n\n    if (!voldef->target.capacity && !backend->buildVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"volume capacity required for this \"\n                               \"storage pool\"));\n        goto cleanup;\n    }\n\n    if (virStorageVolCreateXMLEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    if (virStorageVolDefFindByName(obj, voldef->name)) {\n        virReportError(VIR_ERR_STORAGE_VOL_EXIST,\n                       _(\"'%s'\"), voldef->name);\n        goto cleanup;\n    }\n\n    if (!backend->createVol) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"storage pool does not support volume \"\n                               \"creation\"));\n        goto cleanup;\n    }\n\n    /* Wipe any key the user may have suggested, as volume creation\n     * will generate the canonical key.  */\n    VIR_FREE(voldef->key);\n    if (backend->createVol(obj, voldef) < 0)\n        goto cleanup;\n\n    if (!(newvol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                                    voldef->key, NULL, NULL)))\n        goto cleanup;\n\n    /* NB: Upon success voldef \"owned\" by storage pool for deletion purposes */\n    if (virStoragePoolObjAddVol(obj, voldef) < 0)\n        goto cleanup;\n\n    if (backend->buildVol) {\n        int buildret;\n        virStorageVolDefPtr buildvoldef = NULL;\n\n        if (VIR_ALLOC(buildvoldef) < 0) {\n            voldef = NULL;\n            goto cleanup;\n        }\n\n        /* Make a shallow copy of the 'defined' volume definition, since the\n         * original allocation value will change as the user polls 'info',\n         * but we only need the initial requested values\n         */\n        memcpy(buildvoldef, voldef, sizeof(*voldef));\n\n        /* Drop the pool lock during volume allocation */\n        virStoragePoolObjIncrAsyncjobs(obj);\n        voldef->building = true;\n        virObjectUnlock(obj);\n\n        buildret = backend->buildVol(obj, buildvoldef, flags);\n\n        VIR_FREE(buildvoldef);\n\n        virObjectLock(obj);\n\n        voldef->building = false;\n        virStoragePoolObjDecrAsyncjobs(obj);\n\n        if (buildret < 0) {\n            /* buildVol handles deleting volume on failure */\n            virStoragePoolObjRemoveVol(obj, voldef);\n            voldef = NULL;\n            goto cleanup;\n        }\n\n    }\n\n    if (backend->refreshVol &&\n        backend->refreshVol(obj, voldef) < 0) {\n        storageVolDeleteInternal(backend, obj, voldef,\n                                 0, false);\n        voldef = NULL;\n        goto cleanup;\n    }\n\n    /* Update pool metadata ignoring the disk backend since\n     * it updates the pool values.\n     */\n    if (def->type != VIR_STORAGE_POOL_DISK) {\n        def->allocation += voldef->target.allocation;\n        def->available -= voldef->target.allocation;\n    }\n\n    VIR_INFO(\"Creating volume '%s' in storage pool '%s'\",\n             newvol->name, def->name);\n    vol = g_steal_pointer(&newvol);\n    voldef = NULL;\n\n cleanup:\n    virObjectUnref(newvol);\n    virStoragePoolObjEndAPI(&obj);\n    return vol;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "pool->conn->flags",
            "error"
          ],
          "line": 1509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xmlDesc",
            "error"
          ],
          "line": 1508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "NULL"
          ],
          "line": 1507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1505
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, xmlDesc=%s, flags=0x%x\"",
            "pool",
            "NULLSTR(xmlDesc)",
            "flags"
          ],
          "line": 1503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmlDesc"
          ],
          "line": 1503
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStorageVolPtr\nvirStorageVolCreateXML(virStoragePoolPtr pool,\n                       const char *xmlDesc,\n                       unsigned int flags)\n{\n    VIR_DEBUG(\"pool=%p, xmlDesc=%s, flags=0x%x\", pool, NULLSTR(xmlDesc), flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(pool->conn->flags, error);\n\n    if (pool->conn->storageDriver && pool->conn->storageDriver->storageVolCreateXML) {\n        virStorageVolPtr ret;\n        ret = pool->conn->storageDriver->storageVolCreateXML(pool, xmlDesc, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageVolGetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1465-1475",
    "snippet": "const char*\nvirStorageVolGetKey(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n\n    return vol->key;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "NULL"
          ],
          "line": 1472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1470
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p\"",
            "vol"
          ],
          "line": 1468
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nconst char*\nvirStorageVolGetKey(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n\n    return vol->key;\n}"
  },
  {
    "function_name": "virStorageVolGetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1442-1452",
    "snippet": "const char*\nvirStorageVolGetName(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n\n    return vol->name;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "NULL"
          ],
          "line": 1449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1447
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p\"",
            "vol"
          ],
          "line": 1445
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nconst char*\nvirStorageVolGetName(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n\n    return vol->name;\n}"
  },
  {
    "function_name": "virStorageVolLookupByPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1406-1430",
    "snippet": "virStorageVolPtr\nvirStorageVolLookupByPath(virConnectPtr conn,\n                          const char *path)\n{\n    VIR_DEBUG(\"conn=%p, path=%s\", conn, NULLSTR(path));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(path, error);\n\n    if (conn->storageDriver && conn->storageDriver->storageVolLookupByPath) {\n        virStorageVolPtr ret;\n        ret = conn->storageDriver->storageVolLookupByPath(conn, path);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 1428
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storageVolLookupByPath",
          "args": [
            "conn",
            "path"
          ],
          "line": 1419
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolLookupByPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1669-1708",
          "snippet": "static virStorageVolPtr\nstorageVolLookupByPath(virConnectPtr conn,\n                       const char *path)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    struct storageVolLookupData data = {\n        .path = path, .voldef = NULL };\n    virStorageVolPtr vol = NULL;\n\n    if (!(data.cleanpath = virFileSanitizePath(path)))\n        return NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storageVolLookupByPathCallback,\n                                           &data)) && data.voldef) {\n        def = virStoragePoolObjGetDef(obj);\n\n        if (virStorageVolLookupByPathEnsureACL(conn, def, data.voldef) == 0) {\n            vol = virGetStorageVol(conn, def->name,\n                                   data.voldef->name, data.voldef->key,\n                                   NULL, NULL);\n        }\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!vol) {\n        if (STREQ(path, data.cleanpath)) {\n            virReportError(VIR_ERR_NO_STORAGE_VOL,\n                           _(\"no storage vol with matching path '%s'\"), path);\n        } else {\n            virReportError(VIR_ERR_NO_STORAGE_VOL,\n                           _(\"no storage vol with matching path '%s' (%s)\"),\n                           path, data.cleanpath);\n        }\n    }\n\n    VIR_FREE(data.cleanpath);\n    return vol;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStorageVolPtr\nstorageVolLookupByPath(virConnectPtr conn,\n                       const char *path)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    struct storageVolLookupData data = {\n        .path = path, .voldef = NULL };\n    virStorageVolPtr vol = NULL;\n\n    if (!(data.cleanpath = virFileSanitizePath(path)))\n        return NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storageVolLookupByPathCallback,\n                                           &data)) && data.voldef) {\n        def = virStoragePoolObjGetDef(obj);\n\n        if (virStorageVolLookupByPathEnsureACL(conn, def, data.voldef) == 0) {\n            vol = virGetStorageVol(conn, def->name,\n                                   data.voldef->name, data.voldef->key,\n                                   NULL, NULL);\n        }\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!vol) {\n        if (STREQ(path, data.cleanpath)) {\n            virReportError(VIR_ERR_NO_STORAGE_VOL,\n                           _(\"no storage vol with matching path '%s'\"), path);\n        } else {\n            virReportError(VIR_ERR_NO_STORAGE_VOL,\n                           _(\"no storage vol with matching path '%s' (%s)\"),\n                           path, data.cleanpath);\n        }\n    }\n\n    VIR_FREE(data.cleanpath);\n    return vol;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "path",
            "error"
          ],
          "line": 1415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 1414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1412
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, path=%s\"",
            "conn",
            "NULLSTR(path)"
          ],
          "line": 1410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "path"
          ],
          "line": 1410
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStorageVolPtr\nvirStorageVolLookupByPath(virConnectPtr conn,\n                          const char *path)\n{\n    VIR_DEBUG(\"conn=%p, path=%s\", conn, NULLSTR(path));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(path, error);\n\n    if (conn->storageDriver && conn->storageDriver->storageVolLookupByPath) {\n        virStorageVolPtr ret;\n        ret = conn->storageDriver->storageVolLookupByPath(conn, path);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageVolLookupByKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1366-1390",
    "snippet": "virStorageVolPtr\nvirStorageVolLookupByKey(virConnectPtr conn,\n                         const char *key)\n{\n    VIR_DEBUG(\"conn=%p, key=%s\", conn, NULLSTR(key));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(key, error);\n\n    if (conn->storageDriver && conn->storageDriver->storageVolLookupByKey) {\n        virStorageVolPtr ret;\n        ret = conn->storageDriver->storageVolLookupByKey(conn, key);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 1388
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storageVolLookupByKey",
          "args": [
            "conn",
            "key"
          ],
          "line": 1379
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolLookupByKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1589-1616",
          "snippet": "static virStorageVolPtr\nstorageVolLookupByKey(virConnectPtr conn,\n                      const char *key)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    struct storageVolLookupData data = {\n        .key = key, .voldef = NULL };\n    virStorageVolPtr vol = NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storageVolLookupByKeyCallback,\n                                           &data)) && data.voldef) {\n        def = virStoragePoolObjGetDef(obj);\n        if (virStorageVolLookupByKeyEnsureACL(conn, def, data.voldef) == 0) {\n            vol = virGetStorageVol(conn, def->name,\n                                   data.voldef->name, data.voldef->key,\n                                   NULL, NULL);\n        }\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!vol)\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching key %s\"), key);\n\n    return vol;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStorageVolPtr\nstorageVolLookupByKey(virConnectPtr conn,\n                      const char *key)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    struct storageVolLookupData data = {\n        .key = key, .voldef = NULL };\n    virStorageVolPtr vol = NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storageVolLookupByKeyCallback,\n                                           &data)) && data.voldef) {\n        def = virStoragePoolObjGetDef(obj);\n        if (virStorageVolLookupByKeyEnsureACL(conn, def, data.voldef) == 0) {\n            vol = virGetStorageVol(conn, def->name,\n                                   data.voldef->name, data.voldef->key,\n                                   NULL, NULL);\n        }\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!vol)\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching key %s\"), key);\n\n    return vol;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "key",
            "error"
          ],
          "line": 1375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 1374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1372
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, key=%s\"",
            "conn",
            "NULLSTR(key)"
          ],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "key"
          ],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStorageVolPtr\nvirStorageVolLookupByKey(virConnectPtr conn,\n                         const char *key)\n{\n    VIR_DEBUG(\"conn=%p, key=%s\", conn, NULLSTR(key));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(key, error);\n\n    if (conn->storageDriver && conn->storageDriver->storageVolLookupByKey) {\n        virStorageVolPtr ret;\n        ret = conn->storageDriver->storageVolLookupByKey(conn, key);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageVolLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1326-1350",
    "snippet": "virStorageVolPtr\nvirStorageVolLookupByName(virStoragePoolPtr pool,\n                          const char *name)\n{\n    VIR_DEBUG(\"pool=%p, name=%s\", pool, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (pool->conn->storageDriver && pool->conn->storageDriver->storageVolLookupByName) {\n        virStorageVolPtr ret;\n        ret = pool->conn->storageDriver->storageVolLookupByName(pool, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 1348
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pool->conn->storageDriver->storageVolLookupByName",
          "args": [
            "pool",
            "name"
          ],
          "line": 1339
        },
        "resolved": true,
        "details": {
          "function_name": "storageVolLookupByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1529-1566",
          "snippet": "static virStorageVolPtr\nstorageVolLookupByName(virStoragePoolPtr pool,\n                       const char *name)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef;\n    virStorageVolPtr vol = NULL;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    voldef = virStorageVolDefFindByName(obj, name);\n\n    if (!voldef) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       name);\n        goto cleanup;\n    }\n\n    if (virStorageVolLookupByNameEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    vol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                           voldef->key, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return vol;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageVolPtr\nstorageVolLookupByName(virStoragePoolPtr pool,\n                       const char *name)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageVolDefPtr voldef;\n    virStorageVolPtr vol = NULL;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    voldef = virStorageVolDefFindByName(obj, name);\n\n    if (!voldef) {\n        virReportError(VIR_ERR_NO_STORAGE_VOL,\n                       _(\"no storage vol with matching name '%s'\"),\n                       name);\n        goto cleanup;\n    }\n\n    if (virStorageVolLookupByNameEnsureACL(pool->conn, def, voldef) < 0)\n        goto cleanup;\n\n    vol = virGetStorageVol(pool->conn, def->name, voldef->name,\n                           voldef->key, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return vol;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "name",
            "error"
          ],
          "line": 1335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "NULL"
          ],
          "line": 1334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1332
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, name=%s\"",
            "pool",
            "NULLSTR(name)"
          ],
          "line": 1330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "name"
          ],
          "line": 1330
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStorageVolPtr\nvirStorageVolLookupByName(virStoragePoolPtr pool,\n                          const char *name)\n{\n    VIR_DEBUG(\"pool=%p, name=%s\", pool, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (pool->conn->storageDriver && pool->conn->storageDriver->storageVolLookupByName) {\n        virStorageVolPtr ret;\n        ret = pool->conn->storageDriver->storageVolLookupByName(pool, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageVolGetConnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1300-1310",
    "snippet": "virConnectPtr\nvirStorageVolGetConnect(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n\n    return vol->conn;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "NULL"
          ],
          "line": 1307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1305
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p\"",
            "vol"
          ],
          "line": 1303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirConnectPtr\nvirStorageVolGetConnect(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n\n    return vol->conn;\n}"
  },
  {
    "function_name": "virStoragePoolListVolumes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1261-1287",
    "snippet": "int\nvirStoragePoolListVolumes(virStoragePoolPtr pool,\n                          char **const names,\n                          int maxnames)\n{\n    VIR_DEBUG(\"pool=%p, names=%p, maxnames=%d\", pool, names, maxnames);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (pool->conn->storageDriver && pool->conn->storageDriver->storagePoolListVolumes) {\n        int ret;\n        ret = pool->conn->storageDriver->storagePoolListVolumes(pool, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 1285
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pool->conn->storageDriver->storagePoolListVolumes",
          "args": [
            "pool",
            "names",
            "maxnames"
          ],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolListVolumes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1464-1492",
          "snippet": "static int\nstoragePoolListVolumes(virStoragePoolPtr pool,\n                       char **const names,\n                       int maxnames)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int n = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolListVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    n = virStoragePoolObjVolumeGetNames(obj, pool->conn,\n                                        virStoragePoolListVolumesCheckACL,\n                                        names, maxnames);\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return n;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolListVolumes(virStoragePoolPtr pool,\n                       char **const names,\n                       int maxnames)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int n = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolListVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    n = virStoragePoolObjVolumeGetNames(obj, pool->conn,\n                                        virStoragePoolListVolumesCheckACL,\n                                        names, maxnames);\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "maxnames",
            "error"
          ],
          "line": 1272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "names",
            "maxnames",
            "error"
          ],
          "line": 1271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 1270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1268
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, names=%p, maxnames=%d\"",
            "pool",
            "names",
            "maxnames"
          ],
          "line": 1266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolListVolumes(virStoragePoolPtr pool,\n                          char **const names,\n                          int maxnames)\n{\n    VIR_DEBUG(\"pool=%p, names=%p, maxnames=%d\", pool, names, maxnames);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (pool->conn->storageDriver && pool->conn->storageDriver->storagePoolListVolumes) {\n        int ret;\n        ret = pool->conn->storageDriver->storagePoolListVolumes(pool, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolNumOfVolumes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1223-1245",
    "snippet": "int\nvirStoragePoolNumOfVolumes(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    if (pool->conn->storageDriver && pool->conn->storageDriver->storagePoolNumOfVolumes) {\n        int ret;\n        ret = pool->conn->storageDriver->storagePoolNumOfVolumes(pool);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 1243
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pool->conn->storageDriver->storagePoolNumOfVolumes",
          "args": [
            "pool"
          ],
          "line": 1234
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolNumOfVolumes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1435-1461",
          "snippet": "static int\nstoragePoolNumOfVolumes(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolNumOfVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    ret = virStoragePoolObjNumOfVolumes(obj, pool->conn,\n                                        virStoragePoolNumOfVolumesCheckACL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolNumOfVolumes(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolNumOfVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    ret = virStoragePoolObjNumOfVolumes(obj, pool->conn,\n                                        virStoragePoolNumOfVolumesCheckACL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 1230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1228
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p\"",
            "pool"
          ],
          "line": 1226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolNumOfVolumes(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    if (pool->conn->storageDriver && pool->conn->storageDriver->storagePoolNumOfVolumes) {\n        int ret;\n        ret = pool->conn->storageDriver->storagePoolNumOfVolumes(pool);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolListAllVolumes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1187-1212",
    "snippet": "int\nvirStoragePoolListAllVolumes(virStoragePoolPtr pool,\n                             virStorageVolPtr **vols,\n                             unsigned int flags)\n{\n    VIR_DEBUG(\"pool=%p, vols=%p, flags=0x%x\", pool, vols, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    if (pool->conn->storageDriver &&\n        pool->conn->storageDriver->storagePoolListAllVolumes) {\n        int ret;\n        ret = pool->conn->storageDriver->storagePoolListAllVolumes(pool, vols, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 1210
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pool->conn->storageDriver->storagePoolListAllVolumes",
          "args": [
            "pool",
            "vols",
            "flags"
          ],
          "line": 1201
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolListAllVolumes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1495-1527",
          "snippet": "static int\nstoragePoolListAllVolumes(virStoragePoolPtr pool,\n                          virStorageVolPtr **vols,\n                          unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolListAllVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    ret = virStoragePoolObjVolumeListExport(pool->conn, obj, vols,\n                                            virStoragePoolListAllVolumesCheckACL);\n\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolListAllVolumes(virStoragePoolPtr pool,\n                          virStorageVolPtr **vols,\n                          unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolListAllVolumesEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    ret = virStoragePoolObjVolumeListExport(pool->conn, obj, vols,\n                                            virStoragePoolListAllVolumesCheckACL);\n\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1194
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, vols=%p, flags=0x%x\"",
            "pool",
            "vols",
            "flags"
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolListAllVolumes(virStoragePoolPtr pool,\n                             virStorageVolPtr **vols,\n                             unsigned int flags)\n{\n    VIR_DEBUG(\"pool=%p, vols=%p, flags=0x%x\", pool, vols, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    if (pool->conn->storageDriver &&\n        pool->conn->storageDriver->storagePoolListAllVolumes) {\n        int ret;\n        ret = pool->conn->storageDriver->storagePoolListAllVolumes(pool, vols, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolSetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1139-1166",
    "snippet": "int\nvirStoragePoolSetAutostart(virStoragePoolPtr pool,\n                           int autostart)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, autostart=%d\", pool, autostart);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolSetAutostart) {\n        int ret;\n        ret = conn->storageDriver->storagePoolSetAutostart(pool, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolSetAutostart",
          "args": [
            "pool",
            "autostart"
          ],
          "line": 1155
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolSetAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1372-1432",
          "snippet": "static int\nstoragePoolSetAutostart(virStoragePoolPtr pool,\n                        int autostart)\n{\n    virStoragePoolObjPtr obj;\n    const char *configFile;\n    const char *autostartLink;\n    bool new_autostart;\n    bool cur_autostart;\n    int ret = -1;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n\n    if (virStoragePoolSetAutostartEnsureACL(pool->conn,\n                                            virStoragePoolObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    if (!(configFile = virStoragePoolObjGetConfigFile(obj))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"pool has no config file\"));\n        goto cleanup;\n    }\n\n    autostartLink = virStoragePoolObjGetAutostartLink(obj);\n\n    new_autostart = (autostart != 0);\n    cur_autostart = virStoragePoolObjIsAutostart(obj);\n    if (cur_autostart != new_autostart) {\n        if (new_autostart) {\n            if (virFileMakePath(driver->autostartDir) < 0) {\n                virReportSystemError(errno,\n                                     _(\"cannot create autostart directory %s\"),\n                                     driver->autostartDir);\n                goto cleanup;\n            }\n\n            if (symlink(configFile, autostartLink) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Failed to create symlink '%s' to '%s'\"),\n                                     autostartLink, configFile);\n                goto cleanup;\n            }\n        } else {\n            if (autostartLink && unlink(autostartLink) < 0 &&\n                errno != ENOENT && errno != ENOTDIR) {\n                virReportSystemError(errno,\n                                     _(\"Failed to delete symlink '%s'\"),\n                                     autostartLink);\n                goto cleanup;\n            }\n        }\n        virStoragePoolObjSetAutostart(obj, new_autostart);\n    }\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolSetAutostart(virStoragePoolPtr pool,\n                        int autostart)\n{\n    virStoragePoolObjPtr obj;\n    const char *configFile;\n    const char *autostartLink;\n    bool new_autostart;\n    bool cur_autostart;\n    int ret = -1;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n\n    if (virStoragePoolSetAutostartEnsureACL(pool->conn,\n                                            virStoragePoolObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    if (!(configFile = virStoragePoolObjGetConfigFile(obj))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"pool has no config file\"));\n        goto cleanup;\n    }\n\n    autostartLink = virStoragePoolObjGetAutostartLink(obj);\n\n    new_autostart = (autostart != 0);\n    cur_autostart = virStoragePoolObjIsAutostart(obj);\n    if (cur_autostart != new_autostart) {\n        if (new_autostart) {\n            if (virFileMakePath(driver->autostartDir) < 0) {\n                virReportSystemError(errno,\n                                     _(\"cannot create autostart directory %s\"),\n                                     driver->autostartDir);\n                goto cleanup;\n            }\n\n            if (symlink(configFile, autostartLink) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Failed to create symlink '%s' to '%s'\"),\n                                     autostartLink, configFile);\n                goto cleanup;\n            }\n        } else {\n            if (autostartLink && unlink(autostartLink) < 0 &&\n                errno != ENOENT && errno != ENOTDIR) {\n                virReportSystemError(errno,\n                                     _(\"Failed to delete symlink '%s'\"),\n                                     autostartLink);\n                goto cleanup;\n            }\n        }\n        virStoragePoolObjSetAutostart(obj, new_autostart);\n    }\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 1148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1146
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, autostart=%d\"",
            "pool",
            "autostart"
          ],
          "line": 1144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolSetAutostart(virStoragePoolPtr pool,\n                           int autostart)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, autostart=%d\", pool, autostart);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolSetAutostart) {\n        int ret;\n        ret = conn->storageDriver->storagePoolSetAutostart(pool, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolGetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1099-1126",
    "snippet": "int\nvirStoragePoolGetAutostart(virStoragePoolPtr pool,\n                           int *autostart)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, autostart=%p\", pool, autostart);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    virCheckNonNullArgGoto(autostart, error);\n\n    conn = pool->conn;\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolGetAutostart) {\n        int ret;\n        ret = conn->storageDriver->storagePoolGetAutostart(pool, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 1124
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolGetAutostart",
          "args": [
            "pool",
            "autostart"
          ],
          "line": 1115
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolGetAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1349-1370",
          "snippet": "static int\nstoragePoolGetAutostart(virStoragePoolPtr pool,\n                        int *autostart)\n{\n    virStoragePoolObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n\n    if (virStoragePoolGetAutostartEnsureACL(pool->conn,\n                                            virStoragePoolObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    *autostart = virStoragePoolObjIsAutostart(obj) ? 1 : 0;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolGetAutostart(virStoragePoolPtr pool,\n                        int *autostart)\n{\n    virStoragePoolObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n\n    if (virStoragePoolGetAutostartEnsureACL(pool->conn,\n                                            virStoragePoolObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    *autostart = virStoragePoolObjIsAutostart(obj) ? 1 : 0;\n\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "autostart",
            "error"
          ],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 1108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1106
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, autostart=%p\"",
            "pool",
            "autostart"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolGetAutostart(virStoragePoolPtr pool,\n                           int *autostart)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, autostart=%p\", pool, autostart);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    virCheckNonNullArgGoto(autostart, error);\n\n    conn = pool->conn;\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolGetAutostart) {\n        int ret;\n        ret = conn->storageDriver->storagePoolGetAutostart(pool, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1061-1086",
    "snippet": "char *\nvirStoragePoolGetXMLDesc(virStoragePoolPtr pool,\n                         unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, flags=0x%x\", pool, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n    conn = pool->conn;\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolGetXMLDesc) {\n        char *ret;\n        ret = conn->storageDriver->storagePoolGetXMLDesc(pool, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 1084
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolGetXMLDesc",
          "args": [
            "pool",
            "flags"
          ],
          "line": 1075
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolGetXMLDesc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1317-1347",
          "snippet": "static char *\nstoragePoolGetXMLDesc(virStoragePoolPtr pool,\n                      unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolDefPtr newDef;\n    virStoragePoolDefPtr curDef;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_STORAGE_XML_INACTIVE, NULL);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n    newDef = virStoragePoolObjGetNewDef(obj);\n\n    if (virStoragePoolGetXMLDescEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((flags & VIR_STORAGE_XML_INACTIVE) && newDef)\n        curDef = newDef;\n    else\n        curDef = def;\n\n    ret = virStoragePoolDefFormat(curDef);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nstoragePoolGetXMLDesc(virStoragePoolPtr pool,\n                      unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolDefPtr newDef;\n    virStoragePoolDefPtr curDef;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_STORAGE_XML_INACTIVE, NULL);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n    newDef = virStoragePoolObjGetNewDef(obj);\n\n    if (virStoragePoolGetXMLDescEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((flags & VIR_STORAGE_XML_INACTIVE) && newDef)\n        curDef = newDef;\n    else\n        curDef = def;\n\n    ret = virStoragePoolDefFormat(curDef);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "NULL"
          ],
          "line": 1070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, flags=0x%x\"",
            "pool",
            "flags"
          ],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nchar *\nvirStoragePoolGetXMLDesc(virStoragePoolPtr pool,\n                         unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, flags=0x%x\", pool, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n    conn = pool->conn;\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolGetXMLDesc) {\n        char *ret;\n        ret = conn->storageDriver->storagePoolGetXMLDesc(pool, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "1017-1047",
    "snippet": "int\nvirStoragePoolGetInfo(virStoragePoolPtr pool,\n                      virStoragePoolInfoPtr info)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, info=%p\", pool, info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckStoragePoolReturn(pool, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = pool->conn;\n\n    if (conn->storageDriver->storagePoolGetInfo) {\n        int ret;\n        ret = conn->storageDriver->storagePoolGetInfo(pool, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 1045
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolGetInfo",
          "args": [
            "pool",
            "info"
          ],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolGetInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1284-1315",
          "snippet": "static int\nstoragePoolGetInfo(virStoragePoolPtr pool,\n                   virStoragePoolInfoPtr info)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolGetInfoEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (virStorageBackendForType(def->type) == NULL)\n        goto cleanup;\n\n    memset(info, 0, sizeof(virStoragePoolInfo));\n    if (virStoragePoolObjIsActive(obj))\n        info->state = VIR_STORAGE_POOL_RUNNING;\n    else\n        info->state = VIR_STORAGE_POOL_INACTIVE;\n    info->capacity = def->capacity;\n    info->allocation = def->allocation;\n    info->available = def->available;\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nstoragePoolGetInfo(virStoragePoolPtr pool,\n                   virStoragePoolInfoPtr info)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolGetInfoEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (virStorageBackendForType(def->type) == NULL)\n        goto cleanup;\n\n    memset(info, 0, sizeof(virStoragePoolInfo));\n    if (virStoragePoolObjIsActive(obj))\n        info->state = VIR_STORAGE_POOL_RUNNING;\n    else\n        info->state = VIR_STORAGE_POOL_INACTIVE;\n    info->capacity = def->capacity;\n    info->allocation = def->allocation;\n    info->available = def->available;\n    ret = 0;\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "info",
            "error"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(*info)"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1024
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, info=%p\"",
            "pool",
            "info"
          ],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolGetInfo(virStoragePoolPtr pool,\n                      virStoragePoolInfoPtr info)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, info=%p\", pool, info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckStoragePoolReturn(pool, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = pool->conn;\n\n    if (conn->storageDriver->storagePoolGetInfo) {\n        int ret;\n        ret = conn->storageDriver->storagePoolGetInfo(pool, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolGetUUIDString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "987-1004",
    "snippet": "int\nvirStoragePoolGetUUIDString(virStoragePoolPtr pool,\n                            char *buf)\n{\n    VIR_DEBUG(\"pool=%p, buf=%p\", pool, buf);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    virCheckNonNullArgGoto(buf, error);\n\n    virUUIDFormat(pool->uuid, buf);\n    return 0;\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "pool->uuid",
            "buf"
          ],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "buf",
            "error"
          ],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 993
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, buf=%p\"",
            "pool",
            "buf"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolGetUUIDString(virStoragePoolPtr pool,\n                            char *buf)\n{\n    VIR_DEBUG(\"pool=%p, buf=%p\", pool, buf);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    virCheckNonNullArgGoto(buf, error);\n\n    virUUIDFormat(pool->uuid, buf);\n    return 0;\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolGetUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "957-975",
    "snippet": "int\nvirStoragePoolGetUUID(virStoragePoolPtr pool,\n                      unsigned char *uuid)\n{\n    VIR_DEBUG(\"pool=%p, uuid=%p\", pool, uuid);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    virCheckNonNullArgGoto(uuid, error);\n\n    memcpy(uuid, &pool->uuid[0], VIR_UUID_BUFLEN);\n\n    return 0;\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "uuid",
            "&pool->uuid[0]",
            "VIR_UUID_BUFLEN"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuid",
            "error"
          ],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 963
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, uuid=%p\"",
            "pool",
            "uuid"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolGetUUID(virStoragePoolPtr pool,\n                      unsigned char *uuid)\n{\n    VIR_DEBUG(\"pool=%p, uuid=%p\", pool, uuid);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    virCheckNonNullArgGoto(uuid, error);\n\n    memcpy(uuid, &pool->uuid[0], VIR_UUID_BUFLEN);\n\n    return 0;\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolGetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "935-945",
    "snippet": "const char*\nvirStoragePoolGetName(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n\n    return pool->name;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "NULL"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p\"",
            "pool"
          ],
          "line": 938
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nconst char*\nvirStoragePoolGetName(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n\n    return pool->name;\n}"
  },
  {
    "function_name": "virStoragePoolRefresh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "897-924",
    "snippet": "int\nvirStoragePoolRefresh(virStoragePoolPtr pool,\n                      unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, flags=0x%x\", pool, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolRefresh) {\n        int ret;\n        ret = conn->storageDriver->storagePoolRefresh(pool, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolRefresh",
          "args": [
            "pool",
            "flags"
          ],
          "line": 913
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolRefresh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1217-1281",
          "snippet": "static int\nstoragePoolRefresh(virStoragePoolPtr pool,\n                   unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    g_autofree char *stateFile = NULL;\n    int ret = -1;\n    virObjectEventPtr event = NULL;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolRefreshEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n    if (storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        event = virStoragePoolEventLifecycleNew(def->name,\n                                                def->uuid,\n                                                VIR_STORAGE_POOL_EVENT_STOPPED,\n                                                0);\n        virStoragePoolObjSetActive(obj, false);\n\n        virStoragePoolUpdateInactive(obj);\n\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventRefreshNew(def->name,\n                                          def->uuid);\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolRefresh(virStoragePoolPtr pool,\n                   unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    g_autofree char *stateFile = NULL;\n    int ret = -1;\n    virObjectEventPtr event = NULL;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolRefreshEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n    if (storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        event = virStoragePoolEventLifecycleNew(def->name,\n                                                def->uuid,\n                                                VIR_STORAGE_POOL_EVENT_STOPPED,\n                                                0);\n        virStoragePoolObjSetActive(obj, false);\n\n        virStoragePoolUpdateInactive(obj);\n\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventRefreshNew(def->name,\n                                          def->uuid);\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, flags=0x%x\"",
            "pool",
            "flags"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolRefresh(virStoragePoolPtr pool,\n                      unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, flags=0x%x\", pool, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolRefresh) {\n        int ret;\n        ret = conn->storageDriver->storagePoolRefresh(pool, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolRef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "872-883",
    "snippet": "int\nvirStoragePoolRef(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p refs=%d\", pool, pool ? pool->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    virObjectRef(pool);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "pool"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 877
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p refs=%d\"",
            "pool",
            "pool ? pool->parent.u.s.refs : 0"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolRef(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p refs=%d\", pool, pool ? pool->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    virObjectRef(pool);\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "840-852",
    "snippet": "int\nvirStoragePoolFree(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    virObjectUnref(pool);\n    return 0;\n\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "pool"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p\"",
            "pool"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolFree(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n\n    virObjectUnref(pool);\n    return 0;\n\n}"
  },
  {
    "function_name": "virStoragePoolDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "801-828",
    "snippet": "int\nvirStoragePoolDelete(virStoragePoolPtr pool,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, flags=0x%x\", pool, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolDelete) {\n        int ret;\n        ret = conn->storageDriver->storagePoolDelete(pool, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolDelete",
          "args": [
            "pool",
            "flags"
          ],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1146-1214",
          "snippet": "static int\nstoragePoolDelete(virStoragePoolPtr pool,\n                  unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    g_autofree char *stateFile = NULL;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolDeleteEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    VIR_INFO(\"Deleting storage pool '%s'\", def->name);\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is still active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (!(stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\")))\n        goto cleanup;\n\n    unlink(stateFile);\n\n    if (!backend->deletePool) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"pool does not support pool deletion\"));\n        goto cleanup;\n    }\n    if (backend->deletePool(obj, flags) < 0)\n        goto cleanup;\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_DELETED,\n                                            0);\n\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolDelete(virStoragePoolPtr pool,\n                  unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    g_autofree char *stateFile = NULL;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolDeleteEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    VIR_INFO(\"Deleting storage pool '%s'\", def->name);\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is still active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (!(stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\")))\n        goto cleanup;\n\n    unlink(stateFile);\n\n    if (!backend->deletePool) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       \"%s\", _(\"pool does not support pool deletion\"));\n        goto cleanup;\n    }\n    if (backend->deletePool(obj, flags) < 0)\n        goto cleanup;\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_DELETED,\n                                            0);\n\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, flags=0x%x\"",
            "pool",
            "flags"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolDelete(virStoragePoolPtr pool,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, flags=0x%x\", pool, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolDelete) {\n        int ret;\n        ret = conn->storageDriver->storagePoolDelete(pool, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "761-787",
    "snippet": "int\nvirStoragePoolDestroy(virStoragePoolPtr pool)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolDestroy) {\n        int ret;\n        ret = conn->storageDriver->storagePoolDestroy(pool);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolDestroy",
          "args": [
            "pool"
          ],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolDestroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1076-1144",
          "snippet": "static int\nstoragePoolDestroy(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    g_autofree char *stateFile = NULL;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolDestroyEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    VIR_INFO(\"Destroying storage pool '%s'\", def->name);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (!(stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\")))\n        goto cleanup;\n\n    unlink(stateFile);\n\n    if (backend->stopPool &&\n        backend->stopPool(obj) < 0)\n        goto cleanup;\n\n    virStoragePoolObjClearVols(obj);\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STOPPED,\n                                            0);\n\n    virStoragePoolObjSetActive(obj, false);\n\n    virStoragePoolUpdateInactive(obj);\n\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolDestroy(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    g_autofree char *stateFile = NULL;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolDestroyEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    VIR_INFO(\"Destroying storage pool '%s'\", def->name);\n\n    if (!virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is not active\"), def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (!(stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\")))\n        goto cleanup;\n\n    unlink(stateFile);\n\n    if (backend->stopPool &&\n        backend->stopPool(obj) < 0)\n        goto cleanup;\n\n    virStoragePoolObjClearVols(obj);\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STOPPED,\n                                            0);\n\n    virStoragePoolObjSetActive(obj, false);\n\n    virStoragePoolUpdateInactive(obj);\n\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p\"",
            "pool"
          ],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolDestroy(virStoragePoolPtr pool)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolDestroy) {\n        int ret;\n        ret = conn->storageDriver->storagePoolDestroy(pool);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "719-746",
    "snippet": "int\nvirStoragePoolCreate(virStoragePoolPtr pool,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, flags=0x%x\", pool, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolCreate) {\n        int ret;\n        ret = conn->storageDriver->storagePoolCreate(pool, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolCreate",
          "args": [
            "pool",
            "flags"
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "922-1013",
          "snippet": "static int\nstoragePoolCreate(virStoragePoolPtr pool,\n                  unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    unsigned int build_flags = 0;\n    g_autofree char *stateFile = NULL;\n    bool restoreStarting = false;\n\n    virCheckFlags(VIR_STORAGE_POOL_CREATE_WITH_BUILD |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE, -1);\n\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_STORAGE_POOL_BUILD_OVERWRITE,\n                            VIR_STORAGE_POOL_BUILD_NO_OVERWRITE, -1);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolCreateEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is already active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    virStoragePoolObjSetStarting(obj, true);\n    restoreStarting = true;\n\n    if (backend->buildPool) {\n        if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_OVERWRITE;\n        else if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_NO_OVERWRITE;\n\n        if (build_flags ||\n            (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD)) {\n            if (backend->buildPool(obj, build_flags) < 0)\n                goto cleanup;\n        }\n    }\n\n    VIR_INFO(\"Starting up storage pool '%s'\", def->name);\n    if (backend->startPool &&\n        backend->startPool(obj) < 0)\n        goto cleanup;\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n\n    if (!stateFile ||\n        virStoragePoolSaveState(stateFile, def) < 0 ||\n        storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STARTED,\n                                            0);\n\n    virStoragePoolObjSetActive(obj, true);\n    ret = 0;\n\n cleanup:\n    if (restoreStarting &&\n        virStoragePoolObjIsStarting(obj)) {\n        if (!virStoragePoolObjIsActive(obj))\n            virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolCreate(virStoragePoolPtr pool,\n                  unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    unsigned int build_flags = 0;\n    g_autofree char *stateFile = NULL;\n    bool restoreStarting = false;\n\n    virCheckFlags(VIR_STORAGE_POOL_CREATE_WITH_BUILD |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE, -1);\n\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_STORAGE_POOL_BUILD_OVERWRITE,\n                            VIR_STORAGE_POOL_BUILD_NO_OVERWRITE, -1);\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolCreateEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is already active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    virStoragePoolObjSetStarting(obj, true);\n    restoreStarting = true;\n\n    if (backend->buildPool) {\n        if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_OVERWRITE;\n        else if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_NO_OVERWRITE;\n\n        if (build_flags ||\n            (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD)) {\n            if (backend->buildPool(obj, build_flags) < 0)\n                goto cleanup;\n        }\n    }\n\n    VIR_INFO(\"Starting up storage pool '%s'\", def->name);\n    if (backend->startPool &&\n        backend->startPool(obj) < 0)\n        goto cleanup;\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n\n    if (!stateFile ||\n        virStoragePoolSaveState(stateFile, def) < 0 ||\n        storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STARTED,\n                                            0);\n\n    virStoragePoolObjSetActive(obj, true);\n    ret = 0;\n\n cleanup:\n    if (restoreStarting &&\n        virStoragePoolObjIsStarting(obj)) {\n        if (!virStoragePoolObjIsActive(obj))\n            virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, flags=0x%x\"",
            "pool",
            "flags"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolCreate(virStoragePoolPtr pool,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, flags=0x%x\", pool, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolCreate) {\n        int ret;\n        ret = conn->storageDriver->storagePoolCreate(pool, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolUndefine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "681-707",
    "snippet": "int\nvirStoragePoolUndefine(virStoragePoolPtr pool)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolUndefine) {\n        int ret;\n        ret = conn->storageDriver->storagePoolUndefine(pool);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolUndefine",
          "args": [
            "pool"
          ],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolUndefine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "860-920",
          "snippet": "static int\nstoragePoolUndefine(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    const char *autostartLink;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolUndefineEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is still active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    autostartLink = virStoragePoolObjGetAutostartLink(obj);\n    if (virStoragePoolObjDeleteDef(obj) < 0)\n        goto cleanup;\n\n    if (autostartLink && unlink(autostartLink) < 0 &&\n        errno != ENOENT && errno != ENOTDIR) {\n        VIR_ERROR(_(\"Failed to delete autostart link '%s': %s\"),\n                  autostartLink, g_strerror(errno));\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_UNDEFINED,\n                                            0);\n\n    VIR_INFO(\"Undefining storage pool '%s'\", def->name);\n    virStoragePoolObjRemove(driver->pools, obj);\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolUndefine(virStoragePoolPtr pool)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    const char *autostartLink;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n\n    if (!(obj = storagePoolObjFindByUUID(pool->uuid, pool->name)))\n        goto cleanup;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolUndefineEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is still active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjGetAsyncjobs(obj) > 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"pool '%s' has asynchronous jobs running.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    autostartLink = virStoragePoolObjGetAutostartLink(obj);\n    if (virStoragePoolObjDeleteDef(obj) < 0)\n        goto cleanup;\n\n    if (autostartLink && unlink(autostartLink) < 0 &&\n        errno != ENOENT && errno != ENOTDIR) {\n        VIR_ERROR(_(\"Failed to delete autostart link '%s': %s\"),\n                  autostartLink, g_strerror(errno));\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_UNDEFINED,\n                                            0);\n\n    VIR_INFO(\"Undefining storage pool '%s'\", def->name);\n    virStoragePoolObjRemove(driver->pools, obj);\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p\"",
            "pool"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolUndefine(virStoragePoolPtr pool)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolUndefine) {\n        int ret;\n        ret = conn->storageDriver->storagePoolUndefine(pool);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolBuild",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "643-670",
    "snippet": "int\nvirStoragePoolBuild(virStoragePoolPtr pool,\n                    unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, flags=0x%x\", pool, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolBuild) {\n        int ret;\n        ret = conn->storageDriver->storagePoolBuild(pool, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "pool->conn"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolBuild",
          "args": [
            "pool",
            "flags"
          ],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolBuild",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1015-1073",
          "snippet": "static int\nstoragePoolBuild(virStoragePoolPtr pool,\n                 unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    bool restoreStarting = false;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolBuildEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is already active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    virStoragePoolObjSetStarting(obj, true);\n    restoreStarting = true;\n\n    if (backend->buildPool &&\n        backend->buildPool(obj, flags) < 0)\n        goto cleanup;\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_CREATED,\n                                            0);\n\n    ret = 0;\n\n cleanup:\n    if (restoreStarting &&\n        virStoragePoolObjIsStarting(obj)) {\n        virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic int\nstoragePoolBuild(virStoragePoolPtr pool,\n                 unsigned int flags)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    bool restoreStarting = false;\n    int ret = -1;\n\n    if (!(obj = virStoragePoolObjFromStoragePool(pool)))\n        return -1;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolBuildEnsureACL(pool->conn, def) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(def->type)) == NULL)\n        goto cleanup;\n\n    if (virStoragePoolObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is already active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (virStoragePoolObjIsStarting(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"storage pool '%s' is starting up\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    virStoragePoolObjSetStarting(obj, true);\n    restoreStarting = true;\n\n    if (backend->buildPool &&\n        backend->buildPool(obj, flags) < 0)\n        goto cleanup;\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_CREATED,\n                                            0);\n\n    ret = 0;\n\n cleanup:\n    if (restoreStarting &&\n        virStoragePoolObjIsStarting(obj)) {\n        virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "-1"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p, flags=0x%x\"",
            "pool",
            "flags"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirStoragePoolBuild(virStoragePoolPtr pool,\n                    unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"pool=%p, flags=0x%x\", pool, flags);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, -1);\n    conn = pool->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolBuild) {\n        int ret;\n        ret = conn->storageDriver->storagePoolBuild(pool, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(pool->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "602-628",
    "snippet": "virStoragePoolPtr\nvirStoragePoolDefineXML(virConnectPtr conn,\n                        const char *xml,\n                        unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s, flags=0x%x\", conn, NULLSTR(xml), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xml, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolDefineXML) {\n        virStoragePoolPtr ret;\n        ret = conn->storageDriver->storagePoolDefineXML(conn, xml, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolDefineXML",
          "args": [
            "conn",
            "xml",
            "flags"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolDefineXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "810-858",
          "snippet": "static virStoragePoolPtr\nstoragePoolDefineXML(virConnectPtr conn,\n                     const char *xml,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    virObjectEventPtr event = NULL;\n    g_autoptr(virStoragePoolDef) newDef = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(newDef = virStoragePoolDefParseString(xml)))\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", newDef->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virStoragePoolDefineXMLEnsureACL(conn, newDef) < 0)\n        goto cleanup;\n\n    if (virStorageBackendForType(newDef->type) == NULL)\n        goto cleanup;\n\n    if (!(obj = virStoragePoolObjListAdd(driver->pools, newDef, 0)))\n        goto cleanup;\n    newDef = virStoragePoolObjGetNewDef(obj);\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolObjSaveDef(driver, obj, newDef ? newDef : def) < 0) {\n        virStoragePoolObjRemove(driver->pools, obj);\n        newDef = NULL;\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name, def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_DEFINED,\n                                            0);\n\n    VIR_INFO(\"Defining storage pool '%s'\", def->name);\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n    newDef = NULL;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolPtr\nstoragePoolDefineXML(virConnectPtr conn,\n                     const char *xml,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    virObjectEventPtr event = NULL;\n    g_autoptr(virStoragePoolDef) newDef = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(newDef = virStoragePoolDefParseString(xml)))\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", newDef->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virStoragePoolDefineXMLEnsureACL(conn, newDef) < 0)\n        goto cleanup;\n\n    if (virStorageBackendForType(newDef->type) == NULL)\n        goto cleanup;\n\n    if (!(obj = virStoragePoolObjListAdd(driver->pools, newDef, 0)))\n        goto cleanup;\n    newDef = virStoragePoolObjGetNewDef(obj);\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolObjSaveDef(driver, obj, newDef ? newDef : def) < 0) {\n        virStoragePoolObjRemove(driver->pools, obj);\n        newDef = NULL;\n        goto cleanup;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name, def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_DEFINED,\n                                            0);\n\n    VIR_INFO(\"Defining storage pool '%s'\", def->name);\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n    newDef = NULL;\n\n cleanup:\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xml",
            "error"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, xml=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(xml)",
            "flags"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xml"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStoragePoolPtr\nvirStoragePoolDefineXML(virConnectPtr conn,\n                        const char *xml,\n                        unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s, flags=0x%x\", conn, NULLSTR(xml), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xml, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolDefineXML) {\n        virStoragePoolPtr ret;\n        ret = conn->storageDriver->storagePoolDefineXML(conn, xml, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "559-585",
    "snippet": "virStoragePoolPtr\nvirStoragePoolCreateXML(virConnectPtr conn,\n                        const char *xmlDesc,\n                        unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s, flags=0x%x\", conn, NULLSTR(xmlDesc), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolCreateXML) {\n        virStoragePoolPtr ret;\n        ret = conn->storageDriver->storagePoolCreateXML(conn, xmlDesc, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolCreateXML",
          "args": [
            "conn",
            "xmlDesc",
            "flags"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolCreateXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "721-808",
          "snippet": "static virStoragePoolPtr\nstoragePoolCreateXML(virConnectPtr conn,\n                     const char *xml,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    unsigned int build_flags = 0;\n    g_autoptr(virStoragePoolDef) newDef = NULL;\n    g_autofree char *stateFile = NULL;\n\n    virCheckFlags(VIR_STORAGE_POOL_CREATE_WITH_BUILD |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE, NULL);\n\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_STORAGE_POOL_BUILD_OVERWRITE,\n                            VIR_STORAGE_POOL_BUILD_NO_OVERWRITE, NULL);\n\n    if (!(newDef = virStoragePoolDefParseString(xml)))\n        goto cleanup;\n\n    if (virStoragePoolCreateXMLEnsureACL(conn, newDef) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(newDef->type)) == NULL)\n        goto cleanup;\n\n    if (!(obj = virStoragePoolObjListAdd(driver->pools, newDef,\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_LIVE |\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE)))\n        goto cleanup;\n    newDef = NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    virStoragePoolObjSetStarting(obj, true);\n\n    if (backend->buildPool) {\n        if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_OVERWRITE;\n        else if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_NO_OVERWRITE;\n\n        if (build_flags ||\n            (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD)) {\n            if (backend->buildPool(obj, build_flags) < 0)\n                goto error;\n        }\n    }\n\n    if (backend->startPool &&\n        backend->startPool(obj) < 0)\n        goto error;\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n\n    if (!stateFile ||\n        virStoragePoolSaveState(stateFile, def) < 0 ||\n        storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        goto error;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STARTED,\n                                            0);\n\n    VIR_INFO(\"Creating storage pool '%s'\", def->name);\n    virStoragePoolObjSetActive(obj, true);\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    if (obj && virStoragePoolObjIsStarting(obj)) {\n        if (!virStoragePoolObjIsActive(obj))\n            virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n\n error:\n    virStoragePoolUpdateInactive(obj);\n    goto cleanup;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nstatic virStoragePoolPtr\nstoragePoolCreateXML(virConnectPtr conn,\n                     const char *xml,\n                     unsigned int flags)\n{\n    virStoragePoolObjPtr obj = NULL;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    virStorageBackendPtr backend;\n    virObjectEventPtr event = NULL;\n    unsigned int build_flags = 0;\n    g_autoptr(virStoragePoolDef) newDef = NULL;\n    g_autofree char *stateFile = NULL;\n\n    virCheckFlags(VIR_STORAGE_POOL_CREATE_WITH_BUILD |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE |\n                  VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE, NULL);\n\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_STORAGE_POOL_BUILD_OVERWRITE,\n                            VIR_STORAGE_POOL_BUILD_NO_OVERWRITE, NULL);\n\n    if (!(newDef = virStoragePoolDefParseString(xml)))\n        goto cleanup;\n\n    if (virStoragePoolCreateXMLEnsureACL(conn, newDef) < 0)\n        goto cleanup;\n\n    if ((backend = virStorageBackendForType(newDef->type)) == NULL)\n        goto cleanup;\n\n    if (!(obj = virStoragePoolObjListAdd(driver->pools, newDef,\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_LIVE |\n                                         VIR_STORAGE_POOL_OBJ_LIST_ADD_CHECK_LIVE)))\n        goto cleanup;\n    newDef = NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    virStoragePoolObjSetStarting(obj, true);\n\n    if (backend->buildPool) {\n        if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_OVERWRITE;\n        else if (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD_NO_OVERWRITE)\n            build_flags |= VIR_STORAGE_POOL_BUILD_NO_OVERWRITE;\n\n        if (build_flags ||\n            (flags & VIR_STORAGE_POOL_CREATE_WITH_BUILD)) {\n            if (backend->buildPool(obj, build_flags) < 0)\n                goto error;\n        }\n    }\n\n    if (backend->startPool &&\n        backend->startPool(obj) < 0)\n        goto error;\n\n    stateFile = virFileBuildPath(driver->stateDir, def->name, \".xml\");\n\n    if (!stateFile ||\n        virStoragePoolSaveState(stateFile, def) < 0 ||\n        storagePoolRefreshImpl(backend, obj, stateFile) < 0) {\n        goto error;\n    }\n\n    event = virStoragePoolEventLifecycleNew(def->name,\n                                            def->uuid,\n                                            VIR_STORAGE_POOL_EVENT_STARTED,\n                                            0);\n\n    VIR_INFO(\"Creating storage pool '%s'\", def->name);\n    virStoragePoolObjSetActive(obj, true);\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    if (obj && virStoragePoolObjIsStarting(obj)) {\n        if (!virStoragePoolObjIsActive(obj))\n            virStoragePoolUpdateInactive(obj);\n        virStoragePoolObjSetStarting(obj, false);\n    }\n    virObjectEventStateQueue(driver->storageEventState, event);\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n\n error:\n    virStoragePoolUpdateInactive(obj);\n    goto cleanup;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xmlDesc",
            "error"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, xmlDesc=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(xmlDesc)",
            "flags"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmlDesc"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStoragePoolPtr\nvirStoragePoolCreateXML(virConnectPtr conn,\n                        const char *xmlDesc,\n                        unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s, flags=0x%x\", conn, NULLSTR(xmlDesc), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolCreateXML) {\n        virStoragePoolPtr ret;\n        ret = conn->storageDriver->storagePoolCreateXML(conn, xmlDesc, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolLookupByTargetPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "518-542",
    "snippet": "virStoragePoolPtr\nvirStoragePoolLookupByTargetPath(virConnectPtr conn,\n                                 const char *path)\n{\n    VIR_DEBUG(\"conn=%p, path=%s\", conn, NULLSTR(path));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(path, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolLookupByTargetPath) {\n        virStoragePoolPtr ret;\n        ret = conn->storageDriver->storagePoolLookupByTargetPath(conn, path);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolLookupByTargetPath",
          "args": [
            "conn",
            "path"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolLookupByTargetPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "1726-1763",
          "snippet": "virStoragePoolPtr\nstoragePoolLookupByTargetPath(virConnectPtr conn,\n                              const char *path)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    g_autofree char *cleanpath = NULL;\n\n    cleanpath = virFileSanitizePath(path);\n    if (!cleanpath)\n        return NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storagePoolLookupByTargetPathCallback,\n                                           cleanpath))) {\n        def = virStoragePoolObjGetDef(obj);\n        if (virStoragePoolLookupByTargetPathEnsureACL(conn, def) < 0)\n            return NULL;\n\n        pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!pool) {\n        if (STREQ(path, cleanpath)) {\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching target path '%s'\"),\n                           path);\n        } else {\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching target path '%s' (%s)\"),\n                           path, cleanpath);\n        }\n    }\n\n    return pool;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStorageDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStorageDriverStatePtr driver;\n\nvirStoragePoolPtr\nstoragePoolLookupByTargetPath(virConnectPtr conn,\n                              const char *path)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n    g_autofree char *cleanpath = NULL;\n\n    cleanpath = virFileSanitizePath(path);\n    if (!cleanpath)\n        return NULL;\n\n    if ((obj = virStoragePoolObjListSearch(driver->pools,\n                                           storagePoolLookupByTargetPathCallback,\n                                           cleanpath))) {\n        def = virStoragePoolObjGetDef(obj);\n        if (virStoragePoolLookupByTargetPathEnsureACL(conn, def) < 0)\n            return NULL;\n\n        pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n        virStoragePoolObjEndAPI(&obj);\n    }\n\n    if (!pool) {\n        if (STREQ(path, cleanpath)) {\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching target path '%s'\"),\n                           path);\n        } else {\n            virReportError(VIR_ERR_NO_STORAGE_POOL,\n                           _(\"no storage pool with matching target path '%s' (%s)\"),\n                           path, cleanpath);\n        }\n    }\n\n    return pool;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "path",
            "error"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, path=%s\"",
            "conn",
            "NULLSTR(path)"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "path"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStoragePoolPtr\nvirStoragePoolLookupByTargetPath(virConnectPtr conn,\n                                 const char *path)\n{\n    VIR_DEBUG(\"conn=%p, path=%s\", conn, NULLSTR(path));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(path, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolLookupByTargetPath) {\n        virStoragePoolPtr ret;\n        ret = conn->storageDriver->storagePoolLookupByTargetPath(conn, path);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolLookupByVolume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "479-501",
    "snippet": "virStoragePoolPtr\nvirStoragePoolLookupByVolume(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n\n    if (vol->conn->storageDriver && vol->conn->storageDriver->storagePoolLookupByVolume) {\n        virStoragePoolPtr ret;\n        ret = vol->conn->storageDriver->storagePoolLookupByVolume(vol);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "vol->conn"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vol->conn->storageDriver->storagePoolLookupByVolume",
          "args": [
            "vol"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolLookupByVolume",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "538-557",
          "snippet": "static virStoragePoolPtr\nstoragePoolLookupByVolume(virStorageVolPtr vol)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    if (!(obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByVolumeEnsureACL(vol->conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(vol->conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolPtr\nstoragePoolLookupByVolume(virStorageVolPtr vol)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    if (!(obj = storagePoolObjFindByName(vol->pool)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByVolumeEnsureACL(vol->conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(vol->conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckStorageVolReturn",
          "args": [
            "vol",
            "NULL"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vol=%p\"",
            "vol"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStoragePoolPtr\nvirStoragePoolLookupByVolume(virStorageVolPtr vol)\n{\n    VIR_DEBUG(\"vol=%p\", vol);\n\n    virResetLastError();\n\n    virCheckStorageVolReturn(vol, NULL);\n\n    if (vol->conn->storageDriver && vol->conn->storageDriver->storagePoolLookupByVolume) {\n        virStoragePoolPtr ret;\n        ret = vol->conn->storageDriver->storagePoolLookupByVolume(vol);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(vol->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolLookupByUUIDString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "441-465",
    "snippet": "virStoragePoolPtr\nvirStoragePoolLookupByUUIDString(virConnectPtr conn,\n                                 const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virStoragePoolLookupByUUID(conn, uuid);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolLookupByUUID",
          "args": [
            "conn",
            "uuid"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolLookupByUUIDString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
          "lines": "441-465",
          "snippet": "virStoragePoolPtr\nvirStoragePoolLookupByUUIDString(virConnectPtr conn,\n                                 const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virStoragePoolLookupByUUID(conn, uuid);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "uuidstr",
            "_(\"uuidstr in %s must be a valid UUID\")",
            "__FUNCTION__"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"uuidstr in %s must be a valid UUID\""
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDParse",
          "args": [
            "uuidstr",
            "uuid"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "91-135",
          "snippet": "int\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuidstr",
            "error"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, uuidstr=%s\"",
            "conn",
            "NULLSTR(uuidstr)"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uuidstr"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStoragePoolPtr\nvirStoragePoolLookupByUUIDString(virConnectPtr conn,\n                                 const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virStoragePoolLookupByUUID(conn, uuid);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolLookupByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "402-426",
    "snippet": "virStoragePoolPtr\nvirStoragePoolLookupByUUID(virConnectPtr conn,\n                           const unsigned char *uuid)\n{\n    VIR_UUID_DEBUG(conn, uuid);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolLookupByUUID) {\n        virStoragePoolPtr ret;\n        ret = conn->storageDriver->storagePoolLookupByUUID(conn, uuid);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolLookupByUUID",
          "args": [
            "conn",
            "uuid"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolLookupByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "493-514",
          "snippet": "static virStoragePoolPtr\nstoragePoolLookupByUUID(virConnectPtr conn,\n                        const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    obj = storagePoolObjFindByUUID(uuid, NULL);\n    if (!obj)\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByUUIDEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolPtr\nstoragePoolLookupByUUID(virConnectPtr conn,\n                        const unsigned char *uuid)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    obj = storagePoolObjFindByUUID(uuid, NULL);\n    if (!obj)\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByUUIDEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuid",
            "error"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_UUID_DEBUG",
          "args": [
            "conn",
            "uuid"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStoragePoolPtr\nvirStoragePoolLookupByUUID(virConnectPtr conn,\n                           const unsigned char *uuid)\n{\n    VIR_UUID_DEBUG(conn, uuid);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolLookupByUUID) {\n        virStoragePoolPtr ret;\n        ret = conn->storageDriver->storagePoolLookupByUUID(conn, uuid);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "363-387",
    "snippet": "virStoragePoolPtr\nvirStoragePoolLookupByName(virConnectPtr conn,\n                           const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolLookupByName) {\n        virStoragePoolPtr ret;\n        ret = conn->storageDriver->storagePoolLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->storagePoolLookupByName",
          "args": [
            "conn",
            "name"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "storagePoolLookupByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_driver.c",
          "lines": "516-536",
          "snippet": "static virStoragePoolPtr\nstoragePoolLookupByName(virConnectPtr conn,\n                        const char *name)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    if (!(obj = storagePoolObjFindByName(name)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"storage_util.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"configmake.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"storage_backend.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_event.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"storage_driver.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <pwd.h>",
            "#include <fcntl.h>",
            "#include <sys/param.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"storage_util.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"configmake.h\"\n#include \"virpidfile.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"viralloc.h\"\n#include \"storage_event.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"storage_driver.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <pwd.h>\n#include <fcntl.h>\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virStoragePoolPtr\nstoragePoolLookupByName(virConnectPtr conn,\n                        const char *name)\n{\n    virStoragePoolObjPtr obj;\n    virStoragePoolDefPtr def;\n    virStoragePoolPtr pool = NULL;\n\n    if (!(obj = storagePoolObjFindByName(name)))\n        return NULL;\n    def = virStoragePoolObjGetDef(obj);\n\n    if (virStoragePoolLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    pool = virGetStoragePool(conn, def->name, def->uuid, NULL, NULL);\n\n cleanup:\n    virStoragePoolObjEndAPI(&obj);\n    return pool;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "name",
            "error"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, name=%s\"",
            "conn",
            "NULLSTR(name)"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "name"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirStoragePoolPtr\nvirStoragePoolLookupByName(virConnectPtr conn,\n                           const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->storageDriver && conn->storageDriver->storagePoolLookupByName) {\n        virStoragePoolPtr ret;\n        ret = conn->storageDriver->storagePoolLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virConnectFindStoragePoolSources",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "320-348",
    "snippet": "char *\nvirConnectFindStoragePoolSources(virConnectPtr conn,\n                                 const char *type,\n                                 const char *srcSpec,\n                                 unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, type=%s, src=%s, flags=0x%x\",\n              conn, NULLSTR(type), NULLSTR(srcSpec), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(type, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->connectFindStoragePoolSources) {\n        char *ret;\n        ret = conn->storageDriver->connectFindStoragePoolSources(conn, type, srcSpec, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->connectFindStoragePoolSources",
          "args": [
            "conn",
            "type",
            "srcSpec",
            "flags"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "type",
            "error"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, type=%s, src=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(type)",
            "NULLSTR(srcSpec)",
            "flags"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "srcSpec"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "type"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nchar *\nvirConnectFindStoragePoolSources(virConnectPtr conn,\n                                 const char *type,\n                                 const char *srcSpec,\n                                 unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, type=%s, src=%s, flags=0x%x\",\n              conn, NULLSTR(type), NULLSTR(srcSpec), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(type, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->storageDriver && conn->storageDriver->connectFindStoragePoolSources) {\n        char *ret;\n        ret = conn->storageDriver->connectFindStoragePoolSources(conn, type, srcSpec, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virConnectListDefinedStoragePools",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "270-296",
    "snippet": "int\nvirConnectListDefinedStoragePools(virConnectPtr conn,\n                                  char **const names,\n                                  int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->storageDriver && conn->storageDriver->connectListDefinedStoragePools) {\n        int ret;\n        ret = conn->storageDriver->connectListDefinedStoragePools(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->connectListDefinedStoragePools",
          "args": [
            "conn",
            "names",
            "maxnames"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "maxnames",
            "error"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "names",
            "maxnames",
            "error"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, names=%p, maxnames=%d\"",
            "conn",
            "names",
            "maxnames"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectListDefinedStoragePools(virConnectPtr conn,\n                                  char **const names,\n                                  int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->storageDriver && conn->storageDriver->connectListDefinedStoragePools) {\n        int ret;\n        ret = conn->storageDriver->connectListDefinedStoragePools(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectNumOfDefinedStoragePools",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "227-249",
    "snippet": "int\nvirConnectNumOfDefinedStoragePools(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->storageDriver && conn->storageDriver->connectNumOfDefinedStoragePools) {\n        int ret;\n        ret = conn->storageDriver->connectNumOfDefinedStoragePools(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->connectNumOfDefinedStoragePools",
          "args": [
            "conn"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectNumOfDefinedStoragePools(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->storageDriver && conn->storageDriver->connectNumOfDefinedStoragePools) {\n        int ret;\n        ret = conn->storageDriver->connectNumOfDefinedStoragePools(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectListStoragePools",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "190-216",
    "snippet": "int\nvirConnectListStoragePools(virConnectPtr conn,\n                           char **const names,\n                           int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->storageDriver && conn->storageDriver->connectListStoragePools) {\n        int ret;\n        ret = conn->storageDriver->connectListStoragePools(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->connectListStoragePools",
          "args": [
            "conn",
            "names",
            "maxnames"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "maxnames",
            "error"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "names",
            "maxnames",
            "error"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, names=%p, maxnames=%d\"",
            "conn",
            "names",
            "maxnames"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectListStoragePools(virConnectPtr conn,\n                           char **const names,\n                           int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->storageDriver && conn->storageDriver->connectListStoragePools) {\n        int ret;\n        ret = conn->storageDriver->connectListStoragePools(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectNumOfStoragePools",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "147-169",
    "snippet": "int\nvirConnectNumOfStoragePools(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->storageDriver && conn->storageDriver->connectNumOfStoragePools) {\n        int ret;\n        ret = conn->storageDriver->connectNumOfStoragePools(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->connectNumOfStoragePools",
          "args": [
            "conn"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectNumOfStoragePools(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->storageDriver && conn->storageDriver->connectNumOfStoragePools) {\n        int ret;\n        ret = conn->storageDriver->connectNumOfStoragePools(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectListAllStoragePools",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "108-136",
    "snippet": "int\nvirConnectListAllStoragePools(virConnectPtr conn,\n                              virStoragePoolPtr **pools,\n                              unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, pools=%p, flags=0x%x\", conn, pools, flags);\n\n    virResetLastError();\n\n    if (pools)\n        *pools = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->storageDriver &&\n        conn->storageDriver->connectListAllStoragePools) {\n        int ret;\n        ret = conn->storageDriver->connectListAllStoragePools(conn, pools, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->storageDriver->connectListAllStoragePools",
          "args": [
            "conn",
            "pools",
            "flags"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, pools=%p, flags=0x%x\"",
            "conn",
            "pools",
            "flags"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectListAllStoragePools(virConnectPtr conn,\n                              virStoragePoolPtr **pools,\n                              unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, pools=%p, flags=0x%x\", conn, pools, flags);\n\n    virResetLastError();\n\n    if (pools)\n        *pools = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->storageDriver &&\n        conn->storageDriver->connectListAllStoragePools) {\n        int ret;\n        ret = conn->storageDriver->connectListAllStoragePools(conn, pools, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virStoragePoolGetConnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-storage.c",
    "lines": "41-51",
    "snippet": "virConnectPtr\nvirStoragePoolGetConnect(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n\n    return pool->conn;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckStoragePoolReturn",
          "args": [
            "pool",
            "NULL"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pool=%p\"",
            "pool"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirConnectPtr\nvirStoragePoolGetConnect(virStoragePoolPtr pool)\n{\n    VIR_DEBUG(\"pool=%p\", pool);\n\n    virResetLastError();\n\n    virCheckStoragePoolReturn(pool, NULL);\n\n    return pool->conn;\n}"
  }
]