[
  {
    "function_name": "lxcParseConfigString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "1128-1250",
    "snippet": "virDomainDefPtr\nlxcParseConfigString(const char *config,\n                     virCapsPtr caps G_GNUC_UNUSED,\n                     virDomainXMLOptionPtr xmlopt)\n{\n    virDomainDefPtr vmdef = NULL;\n    g_autoptr(virConf) properties = NULL;\n    g_autofree char *value = NULL;\n\n    if (!(properties = virConfReadString(config, VIR_CONF_FLAG_LXC_FORMAT)))\n        return NULL;\n\n    if (!(vmdef = virDomainDefNew()))\n        goto error;\n\n    if (virUUIDGenerate(vmdef->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to generate uuid\"));\n        goto error;\n    }\n\n    vmdef->id = -1;\n    virDomainDefSetMemoryTotal(vmdef, 64 * 1024);\n\n    vmdef->onReboot = VIR_DOMAIN_LIFECYCLE_ACTION_RESTART;\n    vmdef->onCrash = VIR_DOMAIN_LIFECYCLE_ACTION_DESTROY;\n    vmdef->onPoweroff = VIR_DOMAIN_LIFECYCLE_ACTION_DESTROY;\n    vmdef->virtType = VIR_DOMAIN_VIRT_LXC;\n\n    /* Value not handled by the LXC driver, setting to\n     * minimum required to make XML parsing pass */\n    if (virDomainDefSetVcpusMax(vmdef, 1, xmlopt) < 0)\n        goto error;\n\n    if (virDomainDefSetVcpus(vmdef, 1) < 0)\n        goto error;\n\n    vmdef->nfss = 0;\n    vmdef->os.type = VIR_DOMAIN_OSTYPE_EXE;\n\n    if (virConfGetValueString(properties, \"lxc.arch\", &value) > 0) {\n        virArch arch = virArchFromString(value);\n        if (arch == VIR_ARCH_NONE && STREQ(value, \"x86\"))\n            arch = VIR_ARCH_I686;\n        else if (arch == VIR_ARCH_NONE && STREQ(value, \"amd64\"))\n            arch = VIR_ARCH_X86_64;\n        vmdef->os.arch = arch;\n        VIR_FREE(value);\n    }\n\n    vmdef->os.init = g_strdup(\"/sbin/init\");\n\n    if (virConfGetValueString(properties, \"lxc.uts.name\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.utsname\", &value) <= 0)\n            goto error;\n    }\n\n    vmdef->name = g_strdup(value);\n\n    if (!vmdef->name)\n        vmdef->name = g_strdup(\"unnamed\");\n\n    if (lxcSetRootfs(vmdef, properties) < 0)\n        goto error;\n\n    /* LXC 3.0 uses \"lxc.mount.fstab\", while legacy used just \"lxc.mount\".\n     * In either case, generate the error to use \"lxc.mount.entry\" instead */\n    if (virConfGetValue(properties, \"lxc.mount.fstab\") ||\n        virConfGetValue(properties, \"lxc.mount\")) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"lxc.mount.fstab or lxc.mount found, use \"\n                         \"lxc.mount.entry lines instead\"));\n        goto error;\n    }\n\n    /* Loop over lxc.mount.entry to add filesystem devices for them */\n    if (virConfWalk(properties, lxcFstabWalkCallback, vmdef) < 0)\n        goto error;\n\n    /* Network configuration */\n    if (lxcConvertNetworkSettings(vmdef, properties) < 0)\n        goto error;\n\n    /* Consoles */\n    if (lxcCreateConsoles(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.idmap or legacy lxc.id_map */\n    if (virConfWalk(properties, lxcIdmapWalkCallback, vmdef) < 0)\n        goto error;\n\n    /* lxc.cgroup.memory.* */\n    if (lxcSetMemTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.cpu.* */\n    if (lxcSetCpuTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.cpuset.* */\n    if (lxcSetCpusetTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.blkio.* */\n    if (lxcSetBlkioTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cap.drop */\n    lxcSetCapDrop(vmdef, properties);\n\n    if (virDomainDefPostParse(vmdef, VIR_DOMAIN_DEF_PARSE_ABI_UPDATE,\n                              xmlopt, NULL) < 0)\n        goto error;\n\n    return vmdef;\n\n error:\n    virDomainDefFree(vmdef);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "vmdef"
          ],
          "line": 1248
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefPostParse",
          "args": [
            "vmdef",
            "VIR_DOMAIN_DEF_PARSE_ABI_UPDATE",
            "xmlopt",
            "NULL"
          ],
          "line": 1241
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefPostParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "5869-5953",
          "snippet": "int\nvirDomainDefPostParse(virDomainDefPtr def,\n                      unsigned int parseFlags,\n                      virDomainXMLOptionPtr xmlopt,\n                      void *parseOpaque)\n{\n    int ret = -1;\n    bool localParseOpaque = false;\n    struct virDomainDefPostParseDeviceIteratorData data = {\n        .xmlopt = xmlopt,\n        .parseFlags = parseFlags,\n        .parseOpaque = parseOpaque,\n    };\n\n    def->postParseFailed = false;\n\n    /* call the basic post parse callback */\n    if (xmlopt->config.domainPostParseBasicCallback) {\n        ret = xmlopt->config.domainPostParseBasicCallback(def,\n                                                          xmlopt->config.priv);\n\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    if (!data.parseOpaque &&\n        xmlopt->config.domainPostParseDataAlloc) {\n        ret = xmlopt->config.domainPostParseDataAlloc(def, parseFlags,\n                                                      xmlopt->config.priv,\n                                                      &data.parseOpaque);\n\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n        localParseOpaque = true;\n    }\n\n    /* this must be done before the hypervisor-specific callback,\n     * in case presence of a controller at a specific index is checked\n     */\n    virDomainAssignControllerIndexes(def);\n\n    /* call the domain config callback */\n    if (xmlopt->config.domainPostParseCallback) {\n        ret = xmlopt->config.domainPostParseCallback(def, parseFlags,\n                                                     xmlopt->config.priv,\n                                                     data.parseOpaque);\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    /* iterate the devices */\n    ret = virDomainDeviceInfoIterateInternal(def,\n                                             virDomainDefPostParseDeviceIterator,\n                                             DOMAIN_DEVICE_ITERATE_ALL_CONSOLES |\n                                             DOMAIN_DEVICE_ITERATE_MISSING_INFO,\n                                             &data);\n\n    if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n        goto cleanup;\n\n    if ((ret = virDomainDefPostParseCommon(def, &data, xmlopt)) < 0)\n        goto cleanup;\n\n    if (xmlopt->config.assignAddressesCallback) {\n        ret = xmlopt->config.assignAddressesCallback(def, parseFlags,\n                                                     xmlopt->config.priv,\n                                                     data.parseOpaque);\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    if ((ret = virDomainDefPostParseCheckFeatures(def, xmlopt)) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (localParseOpaque && xmlopt->config.domainPostParseDataFree)\n        xmlopt->config.domainPostParseDataFree(data.parseOpaque);\n\n    if (ret == 1)\n        ret = -1;\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "enum {\n    DOMAIN_DEVICE_ITERATE_ALL_CONSOLES = 1 << 0,\n    DOMAIN_DEVICE_ITERATE_MISSING_INFO = 1 << 1,\n} virDomainDeviceIterateFlags;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nenum {\n    DOMAIN_DEVICE_ITERATE_ALL_CONSOLES = 1 << 0,\n    DOMAIN_DEVICE_ITERATE_MISSING_INFO = 1 << 1,\n} virDomainDeviceIterateFlags;\n\nint\nvirDomainDefPostParse(virDomainDefPtr def,\n                      unsigned int parseFlags,\n                      virDomainXMLOptionPtr xmlopt,\n                      void *parseOpaque)\n{\n    int ret = -1;\n    bool localParseOpaque = false;\n    struct virDomainDefPostParseDeviceIteratorData data = {\n        .xmlopt = xmlopt,\n        .parseFlags = parseFlags,\n        .parseOpaque = parseOpaque,\n    };\n\n    def->postParseFailed = false;\n\n    /* call the basic post parse callback */\n    if (xmlopt->config.domainPostParseBasicCallback) {\n        ret = xmlopt->config.domainPostParseBasicCallback(def,\n                                                          xmlopt->config.priv);\n\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    if (!data.parseOpaque &&\n        xmlopt->config.domainPostParseDataAlloc) {\n        ret = xmlopt->config.domainPostParseDataAlloc(def, parseFlags,\n                                                      xmlopt->config.priv,\n                                                      &data.parseOpaque);\n\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n        localParseOpaque = true;\n    }\n\n    /* this must be done before the hypervisor-specific callback,\n     * in case presence of a controller at a specific index is checked\n     */\n    virDomainAssignControllerIndexes(def);\n\n    /* call the domain config callback */\n    if (xmlopt->config.domainPostParseCallback) {\n        ret = xmlopt->config.domainPostParseCallback(def, parseFlags,\n                                                     xmlopt->config.priv,\n                                                     data.parseOpaque);\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    /* iterate the devices */\n    ret = virDomainDeviceInfoIterateInternal(def,\n                                             virDomainDefPostParseDeviceIterator,\n                                             DOMAIN_DEVICE_ITERATE_ALL_CONSOLES |\n                                             DOMAIN_DEVICE_ITERATE_MISSING_INFO,\n                                             &data);\n\n    if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n        goto cleanup;\n\n    if ((ret = virDomainDefPostParseCommon(def, &data, xmlopt)) < 0)\n        goto cleanup;\n\n    if (xmlopt->config.assignAddressesCallback) {\n        ret = xmlopt->config.assignAddressesCallback(def, parseFlags,\n                                                     xmlopt->config.priv,\n                                                     data.parseOpaque);\n        if (virDomainDefPostParseCheckFailure(def, parseFlags, ret) < 0)\n            goto cleanup;\n    }\n\n    if ((ret = virDomainDefPostParseCheckFeatures(def, xmlopt)) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    if (localParseOpaque && xmlopt->config.domainPostParseDataFree)\n        xmlopt->config.domainPostParseDataFree(data.parseOpaque);\n\n    if (ret == 1)\n        ret = -1;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcSetCapDrop",
          "args": [
            "vmdef",
            "properties"
          ],
          "line": 1239
        },
        "resolved": true,
        "details": {
          "function_name": "lxcSetCapDrop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "1105-1126",
          "snippet": "static void\nlxcSetCapDrop(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    char **toDrop = NULL;\n    const char *capString;\n    size_t i;\n\n    if (virConfGetValueString(properties, \"lxc.cap.drop\", &value) > 0)\n        toDrop = virStringSplit(value, \" \", 0);\n\n    for (i = 0; i < VIR_DOMAIN_PROCES_CAPS_FEATURE_LAST; i++) {\n        capString = virDomainProcessCapsFeatureTypeToString(i);\n        if (toDrop != NULL &&\n            virStringListHasString((const char **)toDrop, capString))\n            def->caps_features[i] = VIR_TRISTATE_SWITCH_OFF;\n    }\n\n    def->features[VIR_DOMAIN_FEATURE_CAPABILITIES] = VIR_DOMAIN_CAPABILITIES_POLICY_ALLOW;\n\n    virStringListFree(toDrop);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nlxcSetCapDrop(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    char **toDrop = NULL;\n    const char *capString;\n    size_t i;\n\n    if (virConfGetValueString(properties, \"lxc.cap.drop\", &value) > 0)\n        toDrop = virStringSplit(value, \" \", 0);\n\n    for (i = 0; i < VIR_DOMAIN_PROCES_CAPS_FEATURE_LAST; i++) {\n        capString = virDomainProcessCapsFeatureTypeToString(i);\n        if (toDrop != NULL &&\n            virStringListHasString((const char **)toDrop, capString))\n            def->caps_features[i] = VIR_TRISTATE_SWITCH_OFF;\n    }\n\n    def->features[VIR_DOMAIN_FEATURE_CAPABILITIES] = VIR_DOMAIN_CAPABILITIES_POLICY_ALLOW;\n\n    virStringListFree(toDrop);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcSetBlkioTune",
          "args": [
            "vmdef",
            "properties"
          ],
          "line": 1235
        },
        "resolved": true,
        "details": {
          "function_name": "lxcSetBlkioTune",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "1085-1103",
          "snippet": "static int\nlxcSetBlkioTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.blkio.weight\",\n                              &value) > 0) {\n        if (virStrToLong_ui(value, NULL, 10, &def->blkio.weight) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse integer: '%s'\"), value);\n            return -1;\n        }\n    }\n\n    if (virConfWalk(properties, lxcBlkioDeviceWalkCallback, def) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcSetBlkioTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.blkio.weight\",\n                              &value) > 0) {\n        if (virStrToLong_ui(value, NULL, 10, &def->blkio.weight) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse integer: '%s'\"), value);\n            return -1;\n        }\n    }\n\n    if (virConfWalk(properties, lxcBlkioDeviceWalkCallback, def) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcSetCpusetTune",
          "args": [
            "vmdef",
            "properties"
          ],
          "line": 1231
        },
        "resolved": true,
        "details": {
          "function_name": "lxcSetCpusetTune",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "964-995",
          "snippet": "static int\nlxcSetCpusetTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    virBitmapPtr nodeset = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpuset.cpus\",\n                              &value) > 0) {\n        if (virBitmapParse(value, &def->cpumask, VIR_DOMAIN_CPUMASK_LEN) < 0)\n            return -1;\n        def->placement_mode = VIR_DOMAIN_CPU_PLACEMENT_MODE_STATIC;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpuset.mems\",\n                              &value) > 0) {\n        if (virBitmapParse(value, &nodeset, VIR_DOMAIN_CPUMASK_LEN) < 0)\n            return -1;\n        if (virDomainNumatuneSet(def->numa,\n                                 def->placement_mode ==\n                                 VIR_DOMAIN_CPU_PLACEMENT_MODE_STATIC,\n                                 VIR_DOMAIN_NUMATUNE_PLACEMENT_STATIC,\n                                 VIR_DOMAIN_NUMATUNE_MEM_STRICT,\n                                 nodeset) < 0) {\n            virBitmapFree(nodeset);\n            return -1;\n        }\n        virBitmapFree(nodeset);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcSetCpusetTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    virBitmapPtr nodeset = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpuset.cpus\",\n                              &value) > 0) {\n        if (virBitmapParse(value, &def->cpumask, VIR_DOMAIN_CPUMASK_LEN) < 0)\n            return -1;\n        def->placement_mode = VIR_DOMAIN_CPU_PLACEMENT_MODE_STATIC;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpuset.mems\",\n                              &value) > 0) {\n        if (virBitmapParse(value, &nodeset, VIR_DOMAIN_CPUMASK_LEN) < 0)\n            return -1;\n        if (virDomainNumatuneSet(def->numa,\n                                 def->placement_mode ==\n                                 VIR_DOMAIN_CPU_PLACEMENT_MODE_STATIC,\n                                 VIR_DOMAIN_NUMATUNE_PLACEMENT_STATIC,\n                                 VIR_DOMAIN_NUMATUNE_MEM_STRICT,\n                                 nodeset) < 0) {\n            virBitmapFree(nodeset);\n            return -1;\n        }\n        virBitmapFree(nodeset);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcSetCpuTune",
          "args": [
            "vmdef",
            "properties"
          ],
          "line": 1227
        },
        "resolved": true,
        "details": {
          "function_name": "lxcSetCpuTune",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "930-962",
          "snippet": "static int\nlxcSetCpuTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.shares\",\n                              &value) > 0) {\n        if (virStrToLong_ull(value, NULL, 10, &def->cputune.shares) < 0)\n            goto error;\n        def->cputune.sharesSpecified = true;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.cfs_quota_us\",\n                              &value) > 0) {\n        if (virStrToLong_ll(value, NULL, 10, &def->cputune.quota) < 0)\n            goto error;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.cfs_period_us\",\n                              &value) > 0) {\n        if (virStrToLong_ull(value, NULL, 10, &def->cputune.period) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"failed to parse integer: '%s'\"), value);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcSetCpuTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.shares\",\n                              &value) > 0) {\n        if (virStrToLong_ull(value, NULL, 10, &def->cputune.shares) < 0)\n            goto error;\n        def->cputune.sharesSpecified = true;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.cfs_quota_us\",\n                              &value) > 0) {\n        if (virStrToLong_ll(value, NULL, 10, &def->cputune.quota) < 0)\n            goto error;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.cfs_period_us\",\n                              &value) > 0) {\n        if (virStrToLong_ull(value, NULL, 10, &def->cputune.period) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"failed to parse integer: '%s'\"), value);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcSetMemTune",
          "args": [
            "vmdef",
            "properties"
          ],
          "line": 1223
        },
        "resolved": true,
        "details": {
          "function_name": "lxcSetMemTune",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "894-928",
          "snippet": "static int\nlxcSetMemTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    unsigned long long size = 0;\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        size = size / 1024;\n        virDomainDefSetMemoryTotal(def, size);\n        def->mem.hard_limit = virMemoryLimitTruncate(size);\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.soft_limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        def->mem.soft_limit = virMemoryLimitTruncate(size / 1024);\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.memsw.limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        def->mem.swap_hard_limit = virMemoryLimitTruncate(size / 1024);\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcSetMemTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    unsigned long long size = 0;\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        size = size / 1024;\n        virDomainDefSetMemoryTotal(def, size);\n        def->mem.hard_limit = virMemoryLimitTruncate(size);\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.soft_limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        def->mem.soft_limit = virMemoryLimitTruncate(size / 1024);\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.memsw.limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        def->mem.swap_hard_limit = virMemoryLimitTruncate(size / 1024);\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfWalk",
          "args": [
            "properties",
            "lxcIdmapWalkCallback",
            "vmdef"
          ],
          "line": 1219
        },
        "resolved": true,
        "details": {
          "function_name": "virConfWalk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1391-1408",
          "snippet": "int virConfWalk(virConfPtr conf,\n                virConfWalkCallback callback,\n                void *opaque)\n{\n    virConfEntryPtr cur;\n\n    if (!conf)\n        return 0;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (cur->name && cur->value &&\n            callback(cur->name, cur->value, opaque) < 0)\n            return -1;\n        cur = cur->next;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfWalk(virConfPtr conf,\n                virConfWalkCallback callback,\n                void *opaque)\n{\n    virConfEntryPtr cur;\n\n    if (!conf)\n        return 0;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (cur->name && cur->value &&\n            callback(cur->name, cur->value, opaque) < 0)\n            return -1;\n        cur = cur->next;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcCreateConsoles",
          "args": [
            "vmdef",
            "properties"
          ],
          "line": 1215
        },
        "resolved": true,
        "details": {
          "function_name": "lxcCreateConsoles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "809-852",
          "snippet": "static int\nlxcCreateConsoles(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    int nbttys = 0;\n    virDomainChrDefPtr console;\n    size_t i;\n\n    if (virConfGetValueString(properties, \"lxc.tty.max\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.tty\", &value) <= 0)\n            return 0;\n    }\n\n    if (virStrToLong_i(value, NULL, 10, &nbttys) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"failed to parse int: '%s'\"),\n                       value);\n        return -1;\n    }\n\n    if (VIR_ALLOC_N(def->consoles, nbttys) < 0)\n        return -1;\n\n    def->nconsoles = nbttys;\n    for (i = 0; i < nbttys; i++) {\n        if (!(console = virDomainChrDefNew(NULL)))\n            goto error;\n\n        console->deviceType = VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE;\n        console->targetType = VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_LXC;\n        console->target.port = i;\n        console->source->type = VIR_DOMAIN_CHR_TYPE_PTY;\n\n        def->consoles[i] = console;\n    }\n\n    return 0;\n\n error:\n    virDomainChrDefFree(console);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcCreateConsoles(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    int nbttys = 0;\n    virDomainChrDefPtr console;\n    size_t i;\n\n    if (virConfGetValueString(properties, \"lxc.tty.max\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.tty\", &value) <= 0)\n            return 0;\n    }\n\n    if (virStrToLong_i(value, NULL, 10, &nbttys) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"failed to parse int: '%s'\"),\n                       value);\n        return -1;\n    }\n\n    if (VIR_ALLOC_N(def->consoles, nbttys) < 0)\n        return -1;\n\n    def->nconsoles = nbttys;\n    for (i = 0; i < nbttys; i++) {\n        if (!(console = virDomainChrDefNew(NULL)))\n            goto error;\n\n        console->deviceType = VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE;\n        console->targetType = VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_LXC;\n        console->target.port = i;\n        console->source->type = VIR_DOMAIN_CHR_TYPE_PTY;\n\n        def->consoles[i] = console;\n    }\n\n    return 0;\n\n error:\n    virDomainChrDefFree(console);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcConvertNetworkSettings",
          "args": [
            "vmdef",
            "properties"
          ],
          "line": 1211
        },
        "resolved": true,
        "details": {
          "function_name": "lxcConvertNetworkSettings",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "761-807",
          "snippet": "static int\nlxcConvertNetworkSettings(virDomainDefPtr def, virConfPtr properties)\n{\n    int status;\n    bool privnet = true;\n    size_t i, j;\n    lxcNetworkParseDataArray networks = {0, NULL};\n    int ret = -1;\n\n    networks.parseData = g_new0(lxcNetworkParseDataPtr, 1);\n\n    if (virConfWalk(properties, lxcNetworkWalkCallback, &networks) < 0)\n        goto error;\n\n    for (i = 0; i < networks.ndata; i++) {\n        lxcNetworkParseDataPtr data = networks.parseData[i];\n\n        status = lxcAddNetworkDefinition(def, data);\n\n        if (status < 0)\n            goto error;\n        else if (data->type != NULL && STREQ(data->type, \"none\"))\n            privnet = false;\n    }\n\n    if (networks.ndata == 0 && privnet) {\n        /* When no network type is provided LXC only adds loopback */\n        def->features[VIR_DOMAIN_FEATURE_PRIVNET] = VIR_TRISTATE_SWITCH_ON;\n    }\n\n    ret = 0;\n\n cleanup:\n    for (i = 0; i < networks.ndata; i++)\n        VIR_FREE(networks.parseData[i]);\n    VIR_FREE(networks.parseData);\n    return ret;\n\n error:\n    for (i = 0; i < networks.ndata; i++) {\n        lxcNetworkParseDataPtr data = networks.parseData[i];\n        for (j = 0; j < data->nips; j++)\n            VIR_FREE(data->ips[j]);\n        VIR_FREE(data->ips);\n    }\n    goto cleanup;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcConvertNetworkSettings(virDomainDefPtr def, virConfPtr properties)\n{\n    int status;\n    bool privnet = true;\n    size_t i, j;\n    lxcNetworkParseDataArray networks = {0, NULL};\n    int ret = -1;\n\n    networks.parseData = g_new0(lxcNetworkParseDataPtr, 1);\n\n    if (virConfWalk(properties, lxcNetworkWalkCallback, &networks) < 0)\n        goto error;\n\n    for (i = 0; i < networks.ndata; i++) {\n        lxcNetworkParseDataPtr data = networks.parseData[i];\n\n        status = lxcAddNetworkDefinition(def, data);\n\n        if (status < 0)\n            goto error;\n        else if (data->type != NULL && STREQ(data->type, \"none\"))\n            privnet = false;\n    }\n\n    if (networks.ndata == 0 && privnet) {\n        /* When no network type is provided LXC only adds loopback */\n        def->features[VIR_DOMAIN_FEATURE_PRIVNET] = VIR_TRISTATE_SWITCH_ON;\n    }\n\n    ret = 0;\n\n cleanup:\n    for (i = 0; i < networks.ndata; i++)\n        VIR_FREE(networks.parseData[i]);\n    VIR_FREE(networks.parseData);\n    return ret;\n\n error:\n    for (i = 0; i < networks.ndata; i++) {\n        lxcNetworkParseDataPtr data = networks.parseData[i];\n        for (j = 0; j < data->nips; j++)\n            VIR_FREE(data->ips[j]);\n        VIR_FREE(data->ips);\n    }\n    goto cleanup;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"lxc.mount.fstab or lxc.mount found, use \"\n                         \"lxc.mount.entry lines instead\")"
          ],
          "line": 1200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"lxc.mount.fstab or lxc.mount found, use \"\n                         \"lxc.mount.entry lines instead\""
          ],
          "line": 1201
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValue",
          "args": [
            "properties",
            "\"lxc.mount\""
          ],
          "line": 1199
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcSetRootfs",
          "args": [
            "vmdef",
            "properties"
          ],
          "line": 1193
        },
        "resolved": true,
        "details": {
          "function_name": "lxcSetRootfs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "204-226",
          "snippet": "static int\nlxcSetRootfs(virDomainDefPtr def,\n             virConfPtr properties)\n{\n    int type = VIR_DOMAIN_FS_TYPE_MOUNT;\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.rootfs.path\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.rootfs\", &value) <= 0)\n            return -1;\n    }\n\n    if (STRPREFIX(value, \"/dev/\"))\n        type = VIR_DOMAIN_FS_TYPE_BLOCK;\n\n    if (lxcAddFSDef(def, type, value, \"/\", false, 0) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcSetRootfs(virDomainDefPtr def,\n             virConfPtr properties)\n{\n    int type = VIR_DOMAIN_FS_TYPE_MOUNT;\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.rootfs.path\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.rootfs\", &value) <= 0)\n            return -1;\n    }\n\n    if (STRPREFIX(value, \"/dev/\"))\n        type = VIR_DOMAIN_FS_TYPE_BLOCK;\n\n    if (lxcAddFSDef(def, type, value, \"/\", false, 0) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"unnamed\""
          ],
          "line": 1191
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "properties",
            "\"lxc.utsname\"",
            "&value"
          ],
          "line": 1184
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1181
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "value",
            "\"amd64\""
          ],
          "line": 1172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "value",
            "\"x86\""
          ],
          "line": 1170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virArchFromString",
          "args": [
            "value"
          ],
          "line": 1169
        },
        "resolved": true,
        "details": {
          "function_name": "virArchFromString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarch.c",
          "lines": "142-152",
          "snippet": "virArch virArchFromString(const char *archstr)\n{\n    size_t i;\n    for (i = 1; i < VIR_ARCH_LAST; i++) {\n        if (STREQ(virArchData[i].name, archstr))\n            return i;\n    }\n\n    VIR_DEBUG(\"Unknown arch %s\", archstr);\n    return VIR_ARCH_NONE;\n}",
          "includes": [
            "#include \"virarch.h\"",
            "#include \"virlog.h\"",
            "# include <sys/utsname.h>",
            "# include <windows.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct virArchData {\n    const char *name;\n    unsigned int wordsize;\n    virArchEndian endian;\n} virArchData[] = {\n    { \"none\",          0, VIR_ARCH_LITTLE_ENDIAN },\n    { \"alpha\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"armv6l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7b\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"aarch64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"cris\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"i686\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ia64\",         64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"lm32\",         32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"m68k\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblaze\",   32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblazeel\", 32, VIR_ARCH_LITTLE_ENDIAN},\n    { \"mips\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"mipsel\",       32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"mips64\",       64, VIR_ARCH_BIG_ENDIAN },\n    { \"mips64el\",     64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"openrisc\",     32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc\",       32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc64\",     64, VIR_ARCH_BIG_ENDIAN },\n\n    { \"ppc\",          32, VIR_ARCH_BIG_ENDIAN },\n    { \"ppcle\",        32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppc64\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"ppc64le\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppcemb\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"riscv32\",      32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"riscv64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"s390\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"s390x\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sh4\",          32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"sh4eb\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc\",        32, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc64\",      64, VIR_ARCH_BIG_ENDIAN },\n    { \"unicore32\",    32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"x86_64\",       64, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"xtensa\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"xtensaeb\",     32, VIR_ARCH_BIG_ENDIAN },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virarch.h\"\n#include \"virlog.h\"\n# include <sys/utsname.h>\n# include <windows.h>\n#include <config.h>\n\nstatic const struct virArchData {\n    const char *name;\n    unsigned int wordsize;\n    virArchEndian endian;\n} virArchData[] = {\n    { \"none\",          0, VIR_ARCH_LITTLE_ENDIAN },\n    { \"alpha\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"armv6l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7b\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"aarch64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"cris\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"i686\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ia64\",         64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"lm32\",         32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"m68k\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblaze\",   32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblazeel\", 32, VIR_ARCH_LITTLE_ENDIAN},\n    { \"mips\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"mipsel\",       32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"mips64\",       64, VIR_ARCH_BIG_ENDIAN },\n    { \"mips64el\",     64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"openrisc\",     32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc\",       32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc64\",     64, VIR_ARCH_BIG_ENDIAN },\n\n    { \"ppc\",          32, VIR_ARCH_BIG_ENDIAN },\n    { \"ppcle\",        32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppc64\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"ppc64le\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppcemb\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"riscv32\",      32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"riscv64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"s390\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"s390x\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sh4\",          32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"sh4eb\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc\",        32, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc64\",      64, VIR_ARCH_BIG_ENDIAN },\n    { \"unicore32\",    32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"x86_64\",       64, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"xtensa\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"xtensaeb\",     32, VIR_ARCH_BIG_ENDIAN },\n};\n\nvirArch virArchFromString(const char *archstr)\n{\n    size_t i;\n    for (i = 1; i < VIR_ARCH_LAST; i++) {\n        if (STREQ(virArchData[i].name, archstr))\n            return i;\n    }\n\n    VIR_DEBUG(\"Unknown arch %s\", archstr);\n    return VIR_ARCH_NONE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSetVcpus",
          "args": [
            "vmdef",
            "1"
          ],
          "line": 1162
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSetVcpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1889-1909",
          "snippet": "int\nvirDomainDefSetVcpus(virDomainDefPtr def,\n                     unsigned int vcpus)\n{\n    size_t i;\n\n    if (vcpus > def->maxvcpus) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"maximum vCPU count must not be less than current \"\n                         \"vCPU count\"));\n        return -1;\n    }\n\n    for (i = 0; i < vcpus; i++)\n        def->vcpus[i]->online = true;\n\n    for (i = vcpus; i < def->maxvcpus; i++)\n        def->vcpus[i]->online = false;\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSetVcpus(virDomainDefPtr def,\n                     unsigned int vcpus)\n{\n    size_t i;\n\n    if (vcpus > def->maxvcpus) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"maximum vCPU count must not be less than current \"\n                         \"vCPU count\"));\n        return -1;\n    }\n\n    for (i = 0; i < vcpus; i++)\n        def->vcpus[i]->online = true;\n\n    for (i = vcpus; i < def->maxvcpus; i++)\n        def->vcpus[i]->online = false;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSetVcpusMax",
          "args": [
            "vmdef",
            "1",
            "xmlopt"
          ],
          "line": 1159
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSetVcpusMax",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1838-1865",
          "snippet": "int\nvirDomainDefSetVcpusMax(virDomainDefPtr def,\n                        unsigned int maxvcpus,\n                        virDomainXMLOptionPtr xmlopt)\n{\n    size_t oldmax = def->maxvcpus;\n    size_t i;\n\n    if (def->maxvcpus == maxvcpus)\n        return 0;\n\n    if (def->maxvcpus < maxvcpus) {\n        if (VIR_EXPAND_N(def->vcpus, def->maxvcpus, maxvcpus - def->maxvcpus) < 0)\n            return -1;\n\n        for (i = oldmax; i < def->maxvcpus; i++) {\n            if (!(def->vcpus[i] = virDomainVcpuDefNew(xmlopt)))\n                return -1;\n        }\n    } else {\n        for (i = maxvcpus; i < def->maxvcpus; i++)\n            virDomainVcpuDefFree(def->vcpus[i]);\n\n        VIR_SHRINK_N(def->vcpus, def->maxvcpus, def->maxvcpus - maxvcpus);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSetVcpusMax(virDomainDefPtr def,\n                        unsigned int maxvcpus,\n                        virDomainXMLOptionPtr xmlopt)\n{\n    size_t oldmax = def->maxvcpus;\n    size_t i;\n\n    if (def->maxvcpus == maxvcpus)\n        return 0;\n\n    if (def->maxvcpus < maxvcpus) {\n        if (VIR_EXPAND_N(def->vcpus, def->maxvcpus, maxvcpus - def->maxvcpus) < 0)\n            return -1;\n\n        for (i = oldmax; i < def->maxvcpus; i++) {\n            if (!(def->vcpus[i] = virDomainVcpuDefNew(xmlopt)))\n                return -1;\n        }\n    } else {\n        for (i = maxvcpus; i < def->maxvcpus; i++)\n            virDomainVcpuDefFree(def->vcpus[i]);\n\n        VIR_SHRINK_N(def->vcpus, def->maxvcpus, def->maxvcpus - maxvcpus);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSetMemoryTotal",
          "args": [
            "vmdef",
            "64 * 1024"
          ],
          "line": 1150
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10931-10936",
          "snippet": "void\nvirDomainDefSetMemoryTotal(virDomainDefPtr def,\n                           unsigned long long size)\n{\n    def->mem.total_memory = size;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainDefSetMemoryTotal(virDomainDefPtr def,\n                           unsigned long long size)\n{\n    def->mem.total_memory = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"failed to generate uuid\")"
          ],
          "line": 1144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDGenerate",
          "args": [
            "vmdef->uuid"
          ],
          "line": 1143
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDGenerate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "50-79",
          "snippet": "int\nvirUUIDGenerate(unsigned char *uuid)\n{\n    if (uuid == NULL)\n        return -1;\n\n    if (virRandomBytes(uuid, VIR_UUID_BUFLEN) < 0)\n        return -1;\n\n    /*\n     * Make UUID RFC 4122 compliant. Following form will be used:\n     *\n     * xxxxxxxx-xxxx-Axxx-Bxxx-xxxxxxxxxxxx\n     *\n     * where\n     * A is version defined in 4.1.3 of RFC\n     *  Msb0  Msb1  Msb2  Msb3   Version  Description\n     *   0     1     0     0        4     The randomly or pseudo-\n     *                                    randomly generated version\n     *                                    specified in this document.\n     *\n     * B is variant defined in 4.1.1 of RFC\n     *  Msb0  Msb1  Msb2  Description\n     *   1     0     x    The variant specified in this document.\n     */\n    uuid[6] = (uuid[6] & 0x0F) | (4 << 4);\n    uuid[8] = (uuid[8] & 0x3F) | (2 << 6);\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDGenerate(unsigned char *uuid)\n{\n    if (uuid == NULL)\n        return -1;\n\n    if (virRandomBytes(uuid, VIR_UUID_BUFLEN) < 0)\n        return -1;\n\n    /*\n     * Make UUID RFC 4122 compliant. Following form will be used:\n     *\n     * xxxxxxxx-xxxx-Axxx-Bxxx-xxxxxxxxxxxx\n     *\n     * where\n     * A is version defined in 4.1.3 of RFC\n     *  Msb0  Msb1  Msb2  Msb3   Version  Description\n     *   0     1     0     0        4     The randomly or pseudo-\n     *                                    randomly generated version\n     *                                    specified in this document.\n     *\n     * B is variant defined in 4.1.1 of RFC\n     *  Msb0  Msb1  Msb2  Description\n     *   1     0     x    The variant specified in this document.\n     */\n    uuid[6] = (uuid[6] & 0x0F) | (4 << 4);\n    uuid[8] = (uuid[8] & 0x3F) | (2 << 6);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefNew",
          "args": [],
          "line": 1140
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3574-3594",
          "snippet": "virDomainDefPtr\nvirDomainDefNew(void)\n{\n    virDomainDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->numa = virDomainNumaNew()))\n        goto error;\n\n    ret->mem.hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.soft_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.swap_hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return ret;\n\n error:\n    virDomainDefFree(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefNew(void)\n{\n    virDomainDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->numa = virDomainNumaNew()))\n        goto error;\n\n    ret->mem.hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.soft_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.swap_hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return ret;\n\n error:\n    virDomainDefFree(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfReadString",
          "args": [
            "config",
            "VIR_CONF_FLAG_LXC_FORMAT"
          ],
          "line": 1137
        },
        "resolved": true,
        "details": {
          "function_name": "virConfReadString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "765-777",
          "snippet": "virConfPtr\nvirConfReadString(const char *memory, unsigned int flags)\n{\n    size_t len;\n\n    if (memory == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    len = strlen(memory);\n    return virConfParse(\"memory conf\", memory, len, flags);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfPtr\nvirConfReadString(const char *memory, unsigned int flags)\n{\n    size_t len;\n\n    if (memory == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    len = strlen(memory);\n    return virConfParse(\"memory conf\", memory, len, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainDefPtr\nlxcParseConfigString(const char *config,\n                     virCapsPtr caps G_GNUC_UNUSED,\n                     virDomainXMLOptionPtr xmlopt)\n{\n    virDomainDefPtr vmdef = NULL;\n    g_autoptr(virConf) properties = NULL;\n    g_autofree char *value = NULL;\n\n    if (!(properties = virConfReadString(config, VIR_CONF_FLAG_LXC_FORMAT)))\n        return NULL;\n\n    if (!(vmdef = virDomainDefNew()))\n        goto error;\n\n    if (virUUIDGenerate(vmdef->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to generate uuid\"));\n        goto error;\n    }\n\n    vmdef->id = -1;\n    virDomainDefSetMemoryTotal(vmdef, 64 * 1024);\n\n    vmdef->onReboot = VIR_DOMAIN_LIFECYCLE_ACTION_RESTART;\n    vmdef->onCrash = VIR_DOMAIN_LIFECYCLE_ACTION_DESTROY;\n    vmdef->onPoweroff = VIR_DOMAIN_LIFECYCLE_ACTION_DESTROY;\n    vmdef->virtType = VIR_DOMAIN_VIRT_LXC;\n\n    /* Value not handled by the LXC driver, setting to\n     * minimum required to make XML parsing pass */\n    if (virDomainDefSetVcpusMax(vmdef, 1, xmlopt) < 0)\n        goto error;\n\n    if (virDomainDefSetVcpus(vmdef, 1) < 0)\n        goto error;\n\n    vmdef->nfss = 0;\n    vmdef->os.type = VIR_DOMAIN_OSTYPE_EXE;\n\n    if (virConfGetValueString(properties, \"lxc.arch\", &value) > 0) {\n        virArch arch = virArchFromString(value);\n        if (arch == VIR_ARCH_NONE && STREQ(value, \"x86\"))\n            arch = VIR_ARCH_I686;\n        else if (arch == VIR_ARCH_NONE && STREQ(value, \"amd64\"))\n            arch = VIR_ARCH_X86_64;\n        vmdef->os.arch = arch;\n        VIR_FREE(value);\n    }\n\n    vmdef->os.init = g_strdup(\"/sbin/init\");\n\n    if (virConfGetValueString(properties, \"lxc.uts.name\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.utsname\", &value) <= 0)\n            goto error;\n    }\n\n    vmdef->name = g_strdup(value);\n\n    if (!vmdef->name)\n        vmdef->name = g_strdup(\"unnamed\");\n\n    if (lxcSetRootfs(vmdef, properties) < 0)\n        goto error;\n\n    /* LXC 3.0 uses \"lxc.mount.fstab\", while legacy used just \"lxc.mount\".\n     * In either case, generate the error to use \"lxc.mount.entry\" instead */\n    if (virConfGetValue(properties, \"lxc.mount.fstab\") ||\n        virConfGetValue(properties, \"lxc.mount\")) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"lxc.mount.fstab or lxc.mount found, use \"\n                         \"lxc.mount.entry lines instead\"));\n        goto error;\n    }\n\n    /* Loop over lxc.mount.entry to add filesystem devices for them */\n    if (virConfWalk(properties, lxcFstabWalkCallback, vmdef) < 0)\n        goto error;\n\n    /* Network configuration */\n    if (lxcConvertNetworkSettings(vmdef, properties) < 0)\n        goto error;\n\n    /* Consoles */\n    if (lxcCreateConsoles(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.idmap or legacy lxc.id_map */\n    if (virConfWalk(properties, lxcIdmapWalkCallback, vmdef) < 0)\n        goto error;\n\n    /* lxc.cgroup.memory.* */\n    if (lxcSetMemTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.cpu.* */\n    if (lxcSetCpuTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.cpuset.* */\n    if (lxcSetCpusetTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.blkio.* */\n    if (lxcSetBlkioTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cap.drop */\n    lxcSetCapDrop(vmdef, properties);\n\n    if (virDomainDefPostParse(vmdef, VIR_DOMAIN_DEF_PARSE_ABI_UPDATE,\n                              xmlopt, NULL) < 0)\n        goto error;\n\n    return vmdef;\n\n error:\n    virDomainDefFree(vmdef);\n    return NULL;\n}"
  },
  {
    "function_name": "lxcSetCapDrop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "1105-1126",
    "snippet": "static void\nlxcSetCapDrop(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    char **toDrop = NULL;\n    const char *capString;\n    size_t i;\n\n    if (virConfGetValueString(properties, \"lxc.cap.drop\", &value) > 0)\n        toDrop = virStringSplit(value, \" \", 0);\n\n    for (i = 0; i < VIR_DOMAIN_PROCES_CAPS_FEATURE_LAST; i++) {\n        capString = virDomainProcessCapsFeatureTypeToString(i);\n        if (toDrop != NULL &&\n            virStringListHasString((const char **)toDrop, capString))\n            def->caps_features[i] = VIR_TRISTATE_SWITCH_OFF;\n    }\n\n    def->features[VIR_DOMAIN_FEATURE_CAPABILITIES] = VIR_DOMAIN_CAPABILITIES_POLICY_ALLOW;\n\n    virStringListFree(toDrop);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "toDrop"
          ],
          "line": 1125
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringListHasString",
          "args": [
            "(const char **)toDrop",
            "capString"
          ],
          "line": 1119
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListHasString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "350-365",
          "snippet": "bool\nvirStringListHasString(const char **strings,\n                       const char *needle)\n{\n    size_t i = 0;\n\n    if (!strings)\n        return false;\n\n    while (strings[i]) {\n        if (STREQ(strings[i++], needle))\n            return true;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringListHasString(const char **strings,\n                       const char *needle)\n{\n    size_t i = 0;\n\n    if (!strings)\n        return false;\n\n    while (strings[i]) {\n        if (STREQ(strings[i++], needle))\n            return true;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainProcessCapsFeatureTypeToString",
          "args": [
            "i"
          ],
          "line": 1117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "value",
            "\" \"",
            "0"
          ],
          "line": 1114
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "properties",
            "\"lxc.cap.drop\"",
            "&value"
          ],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nlxcSetCapDrop(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    char **toDrop = NULL;\n    const char *capString;\n    size_t i;\n\n    if (virConfGetValueString(properties, \"lxc.cap.drop\", &value) > 0)\n        toDrop = virStringSplit(value, \" \", 0);\n\n    for (i = 0; i < VIR_DOMAIN_PROCES_CAPS_FEATURE_LAST; i++) {\n        capString = virDomainProcessCapsFeatureTypeToString(i);\n        if (toDrop != NULL &&\n            virStringListHasString((const char **)toDrop, capString))\n            def->caps_features[i] = VIR_TRISTATE_SWITCH_OFF;\n    }\n\n    def->features[VIR_DOMAIN_FEATURE_CAPABILITIES] = VIR_DOMAIN_CAPABILITIES_POLICY_ALLOW;\n\n    virStringListFree(toDrop);\n}"
  },
  {
    "function_name": "lxcSetBlkioTune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "1085-1103",
    "snippet": "static int\nlxcSetBlkioTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.blkio.weight\",\n                              &value) > 0) {\n        if (virStrToLong_ui(value, NULL, 10, &def->blkio.weight) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse integer: '%s'\"), value);\n            return -1;\n        }\n    }\n\n    if (virConfWalk(properties, lxcBlkioDeviceWalkCallback, def) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfWalk",
          "args": [
            "properties",
            "lxcBlkioDeviceWalkCallback",
            "def"
          ],
          "line": 1099
        },
        "resolved": true,
        "details": {
          "function_name": "virConfWalk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1391-1408",
          "snippet": "int virConfWalk(virConfPtr conf,\n                virConfWalkCallback callback,\n                void *opaque)\n{\n    virConfEntryPtr cur;\n\n    if (!conf)\n        return 0;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (cur->name && cur->value &&\n            callback(cur->name, cur->value, opaque) < 0)\n            return -1;\n        cur = cur->next;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfWalk(virConfPtr conf,\n                virConfWalkCallback callback,\n                void *opaque)\n{\n    virConfEntryPtr cur;\n\n    if (!conf)\n        return 0;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (cur->name && cur->value &&\n            callback(cur->name, cur->value, opaque) < 0)\n            return -1;\n        cur = cur->next;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to parse integer: '%s'\")",
            "value"
          ],
          "line": 1093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to parse integer: '%s'\""
          ],
          "line": 1094
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "value",
            "NULL",
            "10",
            "&def->blkio.weight"
          ],
          "line": 1092
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "properties",
            "\"lxc.cgroup.blkio.weight\"",
            "&value"
          ],
          "line": 1090
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcSetBlkioTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.blkio.weight\",\n                              &value) > 0) {\n        if (virStrToLong_ui(value, NULL, 10, &def->blkio.weight) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse integer: '%s'\"), value);\n            return -1;\n        }\n    }\n\n    if (virConfWalk(properties, lxcBlkioDeviceWalkCallback, def) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcBlkioDeviceWalkCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "997-1083",
    "snippet": "static int\nlxcBlkioDeviceWalkCallback(const char *name, virConfValuePtr value, void *data)\n{\n    char **parts = NULL;\n    virBlkioDevicePtr device = NULL;\n    virDomainDefPtr def = data;\n    size_t i = 0;\n    char *path = NULL;\n    int ret = -1;\n\n    if (!STRPREFIX(name, \"lxc.cgroup.blkio.\") ||\n            STREQ(name, \"lxc.cgroup.blkio.weight\")|| !value->str)\n        return 0;\n\n    if (!(parts = lxcStringSplit(value->str)))\n        return -1;\n\n    if (!parts[0] || !parts[1]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"invalid %s value: '%s'\"),\n                       name, value->str);\n        goto cleanup;\n    }\n\n    path = g_strdup_printf(\"/dev/block/%s\", parts[0]);\n\n    /* Do we already have a device definition for this path?\n     * Get that device or create a new one */\n    for (i = 0; !device && i < def->blkio.ndevices; i++) {\n        if (STREQ(def->blkio.devices[i].path, path))\n            device = &def->blkio.devices[i];\n    }\n    if (!device) {\n        if (VIR_EXPAND_N(def->blkio.devices, def->blkio.ndevices, 1) < 0)\n            goto cleanup;\n        device = &def->blkio.devices[def->blkio.ndevices - 1];\n        device->path = path;\n        path = NULL;\n    }\n\n    /* Set the value */\n    if (STREQ(name, \"lxc.cgroup.blkio.device_weight\")) {\n        if (virStrToLong_ui(parts[1], NULL, 10, &device->weight) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse device weight: '%s'\"), parts[1]);\n            goto cleanup;\n        }\n    } else if (STREQ(name, \"lxc.cgroup.blkio.throttle.read_bps_device\")) {\n        if (virStrToLong_ull(parts[1], NULL, 10, &device->rbps) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse read_bps_device: '%s'\"),\n                           parts[1]);\n            goto cleanup;\n        }\n    } else if (STREQ(name, \"lxc.cgroup.blkio.throttle.write_bps_device\")) {\n        if (virStrToLong_ull(parts[1], NULL, 10, &device->wbps) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse write_bps_device: '%s'\"),\n                           parts[1]);\n            goto cleanup;\n        }\n    } else if (STREQ(name, \"lxc.cgroup.blkio.throttle.read_iops_device\")) {\n        if (virStrToLong_ui(parts[1], NULL, 10, &device->riops) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse read_iops_device: '%s'\"),\n                           parts[1]);\n            goto cleanup;\n        }\n    } else if (STREQ(name, \"lxc.cgroup.blkio.throttle.write_iops_device\")) {\n        if (virStrToLong_ui(parts[1], NULL, 10, &device->wiops) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse write_iops_device: '%s'\"),\n                           parts[1]);\n            goto cleanup;\n        }\n    } else {\n        VIR_WARN(\"Unhandled blkio tune config: %s\", name);\n    }\n\n    ret = 0;\n\n cleanup:\n    virStringListFree(parts);\n    VIR_FREE(path);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 1080
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "parts"
          ],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unhandled blkio tune config: %s\"",
            "name"
          ],
          "line": 1073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to parse write_iops_device: '%s'\")",
            "parts[1]"
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to parse write_iops_device: '%s'\""
          ],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "parts[1]",
            "NULL",
            "10",
            "&device->wiops"
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "name",
            "\"lxc.cgroup.blkio.throttle.write_iops_device\""
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to parse read_iops_device: '%s'\")",
            "parts[1]"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "name",
            "\"lxc.cgroup.blkio.throttle.read_iops_device\""
          ],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to parse write_bps_device: '%s'\")",
            "parts[1]"
          ],
          "line": 1053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "parts[1]",
            "NULL",
            "10",
            "&device->wbps"
          ],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "name",
            "\"lxc.cgroup.blkio.throttle.write_bps_device\""
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to parse read_bps_device: '%s'\")",
            "parts[1]"
          ],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "name",
            "\"lxc.cgroup.blkio.throttle.read_bps_device\""
          ],
          "line": 1044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to parse device weight: '%s'\")",
            "parts[1]"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "name",
            "\"lxc.cgroup.blkio.device_weight\""
          ],
          "line": 1038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "def->blkio.devices",
            "def->blkio.ndevices",
            "1"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "def->blkio.devices[i].path",
            "path"
          ],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/dev/block/%s\"",
            "parts[0]"
          ],
          "line": 1021
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"invalid %s value: '%s'\")",
            "name",
            "value->str"
          ],
          "line": 1015
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcStringSplit",
          "args": [
            "value->str"
          ],
          "line": 1011
        },
        "resolved": true,
        "details": {
          "function_name": "lxcStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "106-148",
          "snippet": "static char ** lxcStringSplit(const char *string)\n{\n    char *tmp;\n    size_t i;\n    size_t ntokens = 0;\n    char **parts;\n    char **result = NULL;\n\n    tmp = g_strdup(string);\n\n    /* Replace potential \\t by a space */\n    for (i = 0; tmp[i]; i++) {\n        if (tmp[i] == '\\t')\n            tmp[i] = ' ';\n    }\n\n    if (!(parts = virStringSplit(tmp, \" \", 0)))\n        goto error;\n\n    /* Append NULL element */\n    if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n        goto error;\n\n    for (i = 0; parts[i]; i++) {\n        if (STREQ(parts[i], \"\"))\n            continue;\n\n        if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n            goto error;\n\n        result[ntokens - 2] = g_strdup(parts[i]);\n    }\n\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    return result;\n\n error:\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    virStringListFree(result);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char ** lxcStringSplit(const char *string)\n{\n    char *tmp;\n    size_t i;\n    size_t ntokens = 0;\n    char **parts;\n    char **result = NULL;\n\n    tmp = g_strdup(string);\n\n    /* Replace potential \\t by a space */\n    for (i = 0; tmp[i]; i++) {\n        if (tmp[i] == '\\t')\n            tmp[i] = ' ';\n    }\n\n    if (!(parts = virStringSplit(tmp, \" \", 0)))\n        goto error;\n\n    /* Append NULL element */\n    if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n        goto error;\n\n    for (i = 0; parts[i]; i++) {\n        if (STREQ(parts[i], \"\"))\n            continue;\n\n        if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n            goto error;\n\n        result[ntokens - 2] = g_strdup(parts[i]);\n    }\n\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    return result;\n\n error:\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    virStringListFree(result);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "name",
            "\"lxc.cgroup.blkio.weight\""
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "name",
            "\"lxc.cgroup.blkio.\""
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcBlkioDeviceWalkCallback(const char *name, virConfValuePtr value, void *data)\n{\n    char **parts = NULL;\n    virBlkioDevicePtr device = NULL;\n    virDomainDefPtr def = data;\n    size_t i = 0;\n    char *path = NULL;\n    int ret = -1;\n\n    if (!STRPREFIX(name, \"lxc.cgroup.blkio.\") ||\n            STREQ(name, \"lxc.cgroup.blkio.weight\")|| !value->str)\n        return 0;\n\n    if (!(parts = lxcStringSplit(value->str)))\n        return -1;\n\n    if (!parts[0] || !parts[1]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"invalid %s value: '%s'\"),\n                       name, value->str);\n        goto cleanup;\n    }\n\n    path = g_strdup_printf(\"/dev/block/%s\", parts[0]);\n\n    /* Do we already have a device definition for this path?\n     * Get that device or create a new one */\n    for (i = 0; !device && i < def->blkio.ndevices; i++) {\n        if (STREQ(def->blkio.devices[i].path, path))\n            device = &def->blkio.devices[i];\n    }\n    if (!device) {\n        if (VIR_EXPAND_N(def->blkio.devices, def->blkio.ndevices, 1) < 0)\n            goto cleanup;\n        device = &def->blkio.devices[def->blkio.ndevices - 1];\n        device->path = path;\n        path = NULL;\n    }\n\n    /* Set the value */\n    if (STREQ(name, \"lxc.cgroup.blkio.device_weight\")) {\n        if (virStrToLong_ui(parts[1], NULL, 10, &device->weight) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse device weight: '%s'\"), parts[1]);\n            goto cleanup;\n        }\n    } else if (STREQ(name, \"lxc.cgroup.blkio.throttle.read_bps_device\")) {\n        if (virStrToLong_ull(parts[1], NULL, 10, &device->rbps) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse read_bps_device: '%s'\"),\n                           parts[1]);\n            goto cleanup;\n        }\n    } else if (STREQ(name, \"lxc.cgroup.blkio.throttle.write_bps_device\")) {\n        if (virStrToLong_ull(parts[1], NULL, 10, &device->wbps) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse write_bps_device: '%s'\"),\n                           parts[1]);\n            goto cleanup;\n        }\n    } else if (STREQ(name, \"lxc.cgroup.blkio.throttle.read_iops_device\")) {\n        if (virStrToLong_ui(parts[1], NULL, 10, &device->riops) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse read_iops_device: '%s'\"),\n                           parts[1]);\n            goto cleanup;\n        }\n    } else if (STREQ(name, \"lxc.cgroup.blkio.throttle.write_iops_device\")) {\n        if (virStrToLong_ui(parts[1], NULL, 10, &device->wiops) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"failed to parse write_iops_device: '%s'\"),\n                           parts[1]);\n            goto cleanup;\n        }\n    } else {\n        VIR_WARN(\"Unhandled blkio tune config: %s\", name);\n    }\n\n    ret = 0;\n\n cleanup:\n    virStringListFree(parts);\n    VIR_FREE(path);\n\n    return ret;\n}"
  },
  {
    "function_name": "lxcSetCpusetTune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "964-995",
    "snippet": "static int\nlxcSetCpusetTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    virBitmapPtr nodeset = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpuset.cpus\",\n                              &value) > 0) {\n        if (virBitmapParse(value, &def->cpumask, VIR_DOMAIN_CPUMASK_LEN) < 0)\n            return -1;\n        def->placement_mode = VIR_DOMAIN_CPU_PLACEMENT_MODE_STATIC;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpuset.mems\",\n                              &value) > 0) {\n        if (virBitmapParse(value, &nodeset, VIR_DOMAIN_CPUMASK_LEN) < 0)\n            return -1;\n        if (virDomainNumatuneSet(def->numa,\n                                 def->placement_mode ==\n                                 VIR_DOMAIN_CPU_PLACEMENT_MODE_STATIC,\n                                 VIR_DOMAIN_NUMATUNE_PLACEMENT_STATIC,\n                                 VIR_DOMAIN_NUMATUNE_MEM_STRICT,\n                                 nodeset) < 0) {\n            virBitmapFree(nodeset);\n            return -1;\n        }\n        virBitmapFree(nodeset);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "nodeset"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNumatuneSet",
          "args": [
            "def->numa",
            "def->placement_mode ==\n                                 VIR_DOMAIN_CPU_PLACEMENT_MODE_STATIC",
            "VIR_DOMAIN_NUMATUNE_PLACEMENT_STATIC",
            "VIR_DOMAIN_NUMATUNE_MEM_STRICT",
            "nodeset"
          ],
          "line": 982
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNumatuneSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/numa_conf.c",
          "lines": "492-566",
          "snippet": "int\nvirDomainNumatuneSet(virDomainNumaPtr numa,\n                     bool placement_static,\n                     int placement,\n                     int mode,\n                     virBitmapPtr nodeset)\n{\n    /* No need to do anything in this case */\n    if (mode == -1 && placement == -1 && !nodeset)\n        return 0;\n\n    if (!numa->memory.specified) {\n        if (mode == -1)\n            mode = VIR_DOMAIN_NUMATUNE_MEM_STRICT;\n        if (placement == -1)\n            placement = VIR_DOMAIN_NUMATUNE_PLACEMENT_DEFAULT;\n    }\n\n    /* Range checks */\n    if (mode != -1 &&\n        (mode < 0 || mode >= VIR_DOMAIN_NUMATUNE_MEM_LAST)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported numatune mode '%d'\"),\n                       mode);\n        return -1;\n    }\n\n    if (placement != -1 &&\n        (placement < 0 || placement >= VIR_DOMAIN_NUMATUNE_PLACEMENT_LAST)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported numatune placement '%d'\"),\n                       mode);\n        return -1;\n    }\n\n    if (mode != -1)\n        numa->memory.mode = mode;\n\n    if (nodeset) {\n        virBitmapFree(numa->memory.nodeset);\n        if (!(numa->memory.nodeset = virBitmapNewCopy(nodeset)))\n            return -1;\n        if (placement == -1)\n            placement = VIR_DOMAIN_NUMATUNE_PLACEMENT_STATIC;\n    }\n\n    if (placement == VIR_DOMAIN_NUMATUNE_PLACEMENT_DEFAULT) {\n        if (numa->memory.nodeset || placement_static)\n            placement = VIR_DOMAIN_NUMATUNE_PLACEMENT_STATIC;\n        else\n            placement = VIR_DOMAIN_NUMATUNE_PLACEMENT_AUTO;\n    }\n\n    if (placement == VIR_DOMAIN_NUMATUNE_PLACEMENT_STATIC &&\n        !numa->memory.nodeset) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"nodeset for NUMA memory tuning must be set \"\n                         \"if 'placement' is 'static'\"));\n        return -1;\n    }\n\n    /* setting nodeset when placement auto is invalid */\n    if (placement == VIR_DOMAIN_NUMATUNE_PLACEMENT_AUTO &&\n        numa->memory.nodeset) {\n        virBitmapFree(numa->memory.nodeset);\n        numa->memory.nodeset = NULL;\n    }\n\n    if (placement != -1)\n        numa->memory.placement = placement;\n\n    numa->memory.specified = true;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"numa_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"numa_conf.h\"\n#include <config.h>\n\nint\nvirDomainNumatuneSet(virDomainNumaPtr numa,\n                     bool placement_static,\n                     int placement,\n                     int mode,\n                     virBitmapPtr nodeset)\n{\n    /* No need to do anything in this case */\n    if (mode == -1 && placement == -1 && !nodeset)\n        return 0;\n\n    if (!numa->memory.specified) {\n        if (mode == -1)\n            mode = VIR_DOMAIN_NUMATUNE_MEM_STRICT;\n        if (placement == -1)\n            placement = VIR_DOMAIN_NUMATUNE_PLACEMENT_DEFAULT;\n    }\n\n    /* Range checks */\n    if (mode != -1 &&\n        (mode < 0 || mode >= VIR_DOMAIN_NUMATUNE_MEM_LAST)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported numatune mode '%d'\"),\n                       mode);\n        return -1;\n    }\n\n    if (placement != -1 &&\n        (placement < 0 || placement >= VIR_DOMAIN_NUMATUNE_PLACEMENT_LAST)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported numatune placement '%d'\"),\n                       mode);\n        return -1;\n    }\n\n    if (mode != -1)\n        numa->memory.mode = mode;\n\n    if (nodeset) {\n        virBitmapFree(numa->memory.nodeset);\n        if (!(numa->memory.nodeset = virBitmapNewCopy(nodeset)))\n            return -1;\n        if (placement == -1)\n            placement = VIR_DOMAIN_NUMATUNE_PLACEMENT_STATIC;\n    }\n\n    if (placement == VIR_DOMAIN_NUMATUNE_PLACEMENT_DEFAULT) {\n        if (numa->memory.nodeset || placement_static)\n            placement = VIR_DOMAIN_NUMATUNE_PLACEMENT_STATIC;\n        else\n            placement = VIR_DOMAIN_NUMATUNE_PLACEMENT_AUTO;\n    }\n\n    if (placement == VIR_DOMAIN_NUMATUNE_PLACEMENT_STATIC &&\n        !numa->memory.nodeset) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"nodeset for NUMA memory tuning must be set \"\n                         \"if 'placement' is 'static'\"));\n        return -1;\n    }\n\n    /* setting nodeset when placement auto is invalid */\n    if (placement == VIR_DOMAIN_NUMATUNE_PLACEMENT_AUTO &&\n        numa->memory.nodeset) {\n        virBitmapFree(numa->memory.nodeset);\n        numa->memory.nodeset = NULL;\n    }\n\n    if (placement != -1)\n        numa->memory.placement = placement;\n\n    numa->memory.specified = true;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapParse",
          "args": [
            "value",
            "&nodeset",
            "VIR_DOMAIN_CPUMASK_LEN"
          ],
          "line": 980
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "581-587",
          "snippet": "int\nvirBitmapParse(const char *str,\n               virBitmapPtr *bitmap,\n               size_t bitmapSize)\n{\n    return virBitmapParseSeparator(str, '\\0', bitmap, bitmapSize);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapParse(const char *str,\n               virBitmapPtr *bitmap,\n               size_t bitmapSize)\n{\n    return virBitmapParseSeparator(str, '\\0', bitmap, bitmapSize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "properties",
            "\"lxc.cgroup.cpuset.mems\"",
            "&value"
          ],
          "line": 978
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 975
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcSetCpusetTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    virBitmapPtr nodeset = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpuset.cpus\",\n                              &value) > 0) {\n        if (virBitmapParse(value, &def->cpumask, VIR_DOMAIN_CPUMASK_LEN) < 0)\n            return -1;\n        def->placement_mode = VIR_DOMAIN_CPU_PLACEMENT_MODE_STATIC;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpuset.mems\",\n                              &value) > 0) {\n        if (virBitmapParse(value, &nodeset, VIR_DOMAIN_CPUMASK_LEN) < 0)\n            return -1;\n        if (virDomainNumatuneSet(def->numa,\n                                 def->placement_mode ==\n                                 VIR_DOMAIN_CPU_PLACEMENT_MODE_STATIC,\n                                 VIR_DOMAIN_NUMATUNE_PLACEMENT_STATIC,\n                                 VIR_DOMAIN_NUMATUNE_MEM_STRICT,\n                                 nodeset) < 0) {\n            virBitmapFree(nodeset);\n            return -1;\n        }\n        virBitmapFree(nodeset);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcSetCpuTune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "930-962",
    "snippet": "static int\nlxcSetCpuTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.shares\",\n                              &value) > 0) {\n        if (virStrToLong_ull(value, NULL, 10, &def->cputune.shares) < 0)\n            goto error;\n        def->cputune.sharesSpecified = true;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.cfs_quota_us\",\n                              &value) > 0) {\n        if (virStrToLong_ll(value, NULL, 10, &def->cputune.quota) < 0)\n            goto error;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.cfs_period_us\",\n                              &value) > 0) {\n        if (virStrToLong_ull(value, NULL, 10, &def->cputune.period) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"failed to parse integer: '%s'\"), value);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to parse integer: '%s'\")",
            "value"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to parse integer: '%s'\""
          ],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "value",
            "NULL",
            "10",
            "&def->cputune.period"
          ],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "properties",
            "\"lxc.cgroup.cpu.cfs_period_us\"",
            "&value"
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ll",
          "args": [
            "value",
            "NULL",
            "10",
            "&def->cputune.quota"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcSetCpuTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.shares\",\n                              &value) > 0) {\n        if (virStrToLong_ull(value, NULL, 10, &def->cputune.shares) < 0)\n            goto error;\n        def->cputune.sharesSpecified = true;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.cfs_quota_us\",\n                              &value) > 0) {\n        if (virStrToLong_ll(value, NULL, 10, &def->cputune.quota) < 0)\n            goto error;\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties, \"lxc.cgroup.cpu.cfs_period_us\",\n                              &value) > 0) {\n        if (virStrToLong_ull(value, NULL, 10, &def->cputune.period) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"failed to parse integer: '%s'\"), value);\n    return -1;\n}"
  },
  {
    "function_name": "lxcSetMemTune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "894-928",
    "snippet": "static int\nlxcSetMemTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    unsigned long long size = 0;\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        size = size / 1024;\n        virDomainDefSetMemoryTotal(def, size);\n        def->mem.hard_limit = virMemoryLimitTruncate(size);\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.soft_limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        def->mem.soft_limit = virMemoryLimitTruncate(size / 1024);\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.memsw.limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        def->mem.swap_hard_limit = virMemoryLimitTruncate(size / 1024);\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMemoryLimitTruncate",
          "args": [
            "size / 1024"
          ],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "virMemoryLimitTruncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1616-1621",
          "snippet": "unsigned long long\nvirMemoryLimitTruncate(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED ? value :\n        VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nunsigned long long\nvirMemoryLimitTruncate(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED ? value :\n        VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcConvertSize",
          "args": [
            "value",
            "&size"
          ],
          "line": 923
        },
        "resolved": true,
        "details": {
          "function_name": "lxcConvertSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "228-254",
          "snippet": "static int\nlxcConvertSize(const char *size, unsigned long long *value)\n{\n    char *unit = NULL;\n\n    /* Split the string into value and unit */\n    if (virStrToLong_ull(size, &unit, 10, value) < 0)\n        goto error;\n\n    if (STREQ(unit, \"%\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't convert relative size: '%s'\"),\n                       size);\n        return -1;\n    } else {\n        if (virScaleInteger(value, unit, 1, ULLONG_MAX) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"failed to convert size: '%s'\"),\n                   size);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcConvertSize(const char *size, unsigned long long *value)\n{\n    char *unit = NULL;\n\n    /* Split the string into value and unit */\n    if (virStrToLong_ull(size, &unit, 10, value) < 0)\n        goto error;\n\n    if (STREQ(unit, \"%\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't convert relative size: '%s'\"),\n                       size);\n        return -1;\n    } else {\n        if (virScaleInteger(value, unit, 1, ULLONG_MAX) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"failed to convert size: '%s'\"),\n                   size);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "properties",
            "\"lxc.cgroup.memory.memsw.limit_in_bytes\"",
            "&value"
          ],
          "line": 920
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDefSetMemoryTotal",
          "args": [
            "def",
            "size"
          ],
          "line": 906
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10931-10936",
          "snippet": "void\nvirDomainDefSetMemoryTotal(virDomainDefPtr def,\n                           unsigned long long size)\n{\n    def->mem.total_memory = size;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainDefSetMemoryTotal(virDomainDefPtr def,\n                           unsigned long long size)\n{\n    def->mem.total_memory = size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcSetMemTune(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    unsigned long long size = 0;\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        size = size / 1024;\n        virDomainDefSetMemoryTotal(def, size);\n        def->mem.hard_limit = virMemoryLimitTruncate(size);\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.soft_limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        def->mem.soft_limit = virMemoryLimitTruncate(size / 1024);\n        VIR_FREE(value);\n    }\n\n    if (virConfGetValueString(properties,\n                              \"lxc.cgroup.memory.memsw.limit_in_bytes\",\n                              &value) > 0) {\n        if (lxcConvertSize(value, &size) < 0)\n            return -1;\n        def->mem.swap_hard_limit = virMemoryLimitTruncate(size / 1024);\n    }\n    return 0;\n}"
  },
  {
    "function_name": "lxcIdmapWalkCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "854-892",
    "snippet": "static int\nlxcIdmapWalkCallback(const char *name, virConfValuePtr value, void *data)\n{\n    virDomainDefPtr def = data;\n    virDomainIdMapEntryPtr idmap = NULL;\n    char type;\n    unsigned long start, target, count;\n\n    /* LXC 3.0 uses \"lxc.idmap\", while legacy used \"lxc.id_map\" */\n    if (STRNEQ(name, \"lxc.idmap\") || !value->str) {\n        if (!value->str || STRNEQ(name, \"lxc.id_map\"))\n            return 0;\n    }\n\n    if (sscanf(value->str, \"%c %lu %lu %lu\", &type,\n               &target, &start, &count) != 4) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"invalid %s: '%s'\"),\n                       name, value->str);\n        return -1;\n    }\n\n    if (type == 'u') {\n        if (VIR_EXPAND_N(def->idmap.uidmap, def->idmap.nuidmap, 1) < 0)\n            return -1;\n        idmap = &def->idmap.uidmap[def->idmap.nuidmap - 1];\n    } else if (type == 'g') {\n        if (VIR_EXPAND_N(def->idmap.gidmap, def->idmap.ngidmap, 1) < 0)\n            return -1;\n        idmap = &def->idmap.gidmap[def->idmap.ngidmap - 1];\n    } else {\n        return -1;\n    }\n\n    idmap->start = start;\n    idmap->target = target;\n    idmap->count = count;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "def->idmap.gidmap",
            "def->idmap.ngidmap",
            "1"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "def->idmap.uidmap",
            "def->idmap.nuidmap",
            "1"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"invalid %s: '%s'\")",
            "name",
            "value->str"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"invalid %s: '%s'\""
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "value->str",
            "\"%c %lu %lu %lu\"",
            "&type",
            "&target",
            "&start",
            "&count"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "name",
            "\"lxc.id_map\""
          ],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "name",
            "\"lxc.idmap\""
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcIdmapWalkCallback(const char *name, virConfValuePtr value, void *data)\n{\n    virDomainDefPtr def = data;\n    virDomainIdMapEntryPtr idmap = NULL;\n    char type;\n    unsigned long start, target, count;\n\n    /* LXC 3.0 uses \"lxc.idmap\", while legacy used \"lxc.id_map\" */\n    if (STRNEQ(name, \"lxc.idmap\") || !value->str) {\n        if (!value->str || STRNEQ(name, \"lxc.id_map\"))\n            return 0;\n    }\n\n    if (sscanf(value->str, \"%c %lu %lu %lu\", &type,\n               &target, &start, &count) != 4) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"invalid %s: '%s'\"),\n                       name, value->str);\n        return -1;\n    }\n\n    if (type == 'u') {\n        if (VIR_EXPAND_N(def->idmap.uidmap, def->idmap.nuidmap, 1) < 0)\n            return -1;\n        idmap = &def->idmap.uidmap[def->idmap.nuidmap - 1];\n    } else if (type == 'g') {\n        if (VIR_EXPAND_N(def->idmap.gidmap, def->idmap.ngidmap, 1) < 0)\n            return -1;\n        idmap = &def->idmap.gidmap[def->idmap.ngidmap - 1];\n    } else {\n        return -1;\n    }\n\n    idmap->start = start;\n    idmap->target = target;\n    idmap->count = count;\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcCreateConsoles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "809-852",
    "snippet": "static int\nlxcCreateConsoles(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    int nbttys = 0;\n    virDomainChrDefPtr console;\n    size_t i;\n\n    if (virConfGetValueString(properties, \"lxc.tty.max\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.tty\", &value) <= 0)\n            return 0;\n    }\n\n    if (virStrToLong_i(value, NULL, 10, &nbttys) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"failed to parse int: '%s'\"),\n                       value);\n        return -1;\n    }\n\n    if (VIR_ALLOC_N(def->consoles, nbttys) < 0)\n        return -1;\n\n    def->nconsoles = nbttys;\n    for (i = 0; i < nbttys; i++) {\n        if (!(console = virDomainChrDefNew(NULL)))\n            goto error;\n\n        console->deviceType = VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE;\n        console->targetType = VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_LXC;\n        console->target.port = i;\n        console->source->type = VIR_DOMAIN_CHR_TYPE_PTY;\n\n        def->consoles[i] = console;\n    }\n\n    return 0;\n\n error:\n    virDomainChrDefFree(console);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainChrDefFree",
          "args": [
            "console"
          ],
          "line": 850
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainChrDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2706-2733",
          "snippet": "void virDomainChrDefFree(virDomainChrDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch (def->deviceType) {\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_CHANNEL:\n        switch (def->targetType) {\n        case VIR_DOMAIN_CHR_CHANNEL_TARGET_TYPE_GUESTFWD:\n            VIR_FREE(def->target.addr);\n            break;\n\n        case VIR_DOMAIN_CHR_CHANNEL_TARGET_TYPE_XEN:\n        case VIR_DOMAIN_CHR_CHANNEL_TARGET_TYPE_VIRTIO:\n            VIR_FREE(def->target.name);\n            break;\n        }\n        break;\n\n    default:\n        break;\n    }\n\n    virObjectUnref(def->source);\n    virDomainDeviceInfoClear(&def->info);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainChrDefFree(virDomainChrDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch (def->deviceType) {\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_CHANNEL:\n        switch (def->targetType) {\n        case VIR_DOMAIN_CHR_CHANNEL_TARGET_TYPE_GUESTFWD:\n            VIR_FREE(def->target.addr);\n            break;\n\n        case VIR_DOMAIN_CHR_CHANNEL_TARGET_TYPE_XEN:\n        case VIR_DOMAIN_CHR_CHANNEL_TARGET_TYPE_VIRTIO:\n            VIR_FREE(def->target.name);\n            break;\n        }\n        break;\n\n    default:\n        break;\n    }\n\n    virObjectUnref(def->source);\n    virDomainDeviceInfoClear(&def->info);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainChrDefNew",
          "args": [
            "NULL"
          ],
          "line": 836
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainChrDefNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "13232-13246",
          "snippet": "virDomainChrDefPtr\nvirDomainChrDefNew(virDomainXMLOptionPtr xmlopt)\n{\n    virDomainChrDefPtr def = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->target.port = -1;\n\n    if (!(def->source = virDomainChrSourceDefNew(xmlopt)))\n        VIR_FREE(def);\n\n    return def;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainChrDefPtr\nvirDomainChrDefNew(virDomainXMLOptionPtr xmlopt)\n{\n    virDomainChrDefPtr def = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->target.port = -1;\n\n    if (!(def->source = virDomainChrSourceDefNew(xmlopt)))\n        VIR_FREE(def);\n\n    return def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "def->consoles",
            "nbttys"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to parse int: '%s'\")",
            "value"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to parse int: '%s'\""
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "value",
            "NULL",
            "10",
            "&nbttys"
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "properties",
            "\"lxc.tty\"",
            "&value"
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcCreateConsoles(virDomainDefPtr def, virConfPtr properties)\n{\n    g_autofree char *value = NULL;\n    int nbttys = 0;\n    virDomainChrDefPtr console;\n    size_t i;\n\n    if (virConfGetValueString(properties, \"lxc.tty.max\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.tty\", &value) <= 0)\n            return 0;\n    }\n\n    if (virStrToLong_i(value, NULL, 10, &nbttys) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"failed to parse int: '%s'\"),\n                       value);\n        return -1;\n    }\n\n    if (VIR_ALLOC_N(def->consoles, nbttys) < 0)\n        return -1;\n\n    def->nconsoles = nbttys;\n    for (i = 0; i < nbttys; i++) {\n        if (!(console = virDomainChrDefNew(NULL)))\n            goto error;\n\n        console->deviceType = VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE;\n        console->targetType = VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_LXC;\n        console->target.port = i;\n        console->source->type = VIR_DOMAIN_CHR_TYPE_PTY;\n\n        def->consoles[i] = console;\n    }\n\n    return 0;\n\n error:\n    virDomainChrDefFree(console);\n    return -1;\n}"
  },
  {
    "function_name": "lxcConvertNetworkSettings",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "761-807",
    "snippet": "static int\nlxcConvertNetworkSettings(virDomainDefPtr def, virConfPtr properties)\n{\n    int status;\n    bool privnet = true;\n    size_t i, j;\n    lxcNetworkParseDataArray networks = {0, NULL};\n    int ret = -1;\n\n    networks.parseData = g_new0(lxcNetworkParseDataPtr, 1);\n\n    if (virConfWalk(properties, lxcNetworkWalkCallback, &networks) < 0)\n        goto error;\n\n    for (i = 0; i < networks.ndata; i++) {\n        lxcNetworkParseDataPtr data = networks.parseData[i];\n\n        status = lxcAddNetworkDefinition(def, data);\n\n        if (status < 0)\n            goto error;\n        else if (data->type != NULL && STREQ(data->type, \"none\"))\n            privnet = false;\n    }\n\n    if (networks.ndata == 0 && privnet) {\n        /* When no network type is provided LXC only adds loopback */\n        def->features[VIR_DOMAIN_FEATURE_PRIVNET] = VIR_TRISTATE_SWITCH_ON;\n    }\n\n    ret = 0;\n\n cleanup:\n    for (i = 0; i < networks.ndata; i++)\n        VIR_FREE(networks.parseData[i]);\n    VIR_FREE(networks.parseData);\n    return ret;\n\n error:\n    for (i = 0; i < networks.ndata; i++) {\n        lxcNetworkParseDataPtr data = networks.parseData[i];\n        for (j = 0; j < data->nips; j++)\n            VIR_FREE(data->ips[j]);\n        VIR_FREE(data->ips);\n    }\n    goto cleanup;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->ips"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->ips[j]"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "networks.parseData"
          ],
          "line": 796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "networks.parseData[i]"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "data->type",
            "\"none\""
          ],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcAddNetworkDefinition",
          "args": [
            "def",
            "data"
          ],
          "line": 778
        },
        "resolved": true,
        "details": {
          "function_name": "lxcAddNetworkDefinition",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "474-561",
          "snippet": "static int\nlxcAddNetworkDefinition(virDomainDefPtr def, lxcNetworkParseData *data)\n{\n    virDomainNetDefPtr net = NULL;\n    virDomainHostdevDefPtr hostdev = NULL;\n    bool isPhys, isVlan = false;\n    size_t i;\n\n    if ((data->type == NULL) || STREQ(data->type, \"empty\") ||\n         STREQ(data->type, \"\") ||  STREQ(data->type, \"none\"))\n        return 0;\n\n    isPhys = STREQ(data->type, \"phys\");\n    isVlan = STREQ(data->type, \"vlan\");\n    if (data->type != NULL && (isPhys || isVlan)) {\n        if (!data->link) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Missing 'link' attribute for NIC\"));\n            goto error;\n        }\n        if (!(hostdev = lxcCreateHostdevDef(VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES,\n                                            VIR_DOMAIN_HOSTDEV_CAPS_TYPE_NET,\n                                            data->link)))\n            goto error;\n\n        /* This still requires the user to manually setup the vlan interface\n         * on the host */\n        if (isVlan && data->vlanid) {\n            VIR_FREE(hostdev->source.caps.u.net.ifname);\n            hostdev->source.caps.u.net.ifname = g_strdup_printf(\"%s.%s\",\n                                                                data->link,\n                                                                data->vlanid);\n        }\n\n        hostdev->source.caps.u.net.ip.ips = data->ips;\n        hostdev->source.caps.u.net.ip.nips = data->nips;\n\n        if (data->gateway_ipv4 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv4, AF_INET,\n                                         &hostdev->source.caps.u.net.ip.routes,\n                                         &hostdev->source.caps.u.net.ip.nroutes) < 0)\n                goto error;\n\n        if (data->gateway_ipv6 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv6, AF_INET6,\n                                         &hostdev->source.caps.u.net.ip.routes,\n                                         &hostdev->source.caps.u.net.ip.nroutes) < 0)\n                goto error;\n\n        if (VIR_EXPAND_N(def->hostdevs, def->nhostdevs, 1) < 0)\n            goto error;\n        def->hostdevs[def->nhostdevs - 1] = hostdev;\n    } else {\n        if (!(net = lxcCreateNetDef(data->type, data->link, data->mac,\n                                    data->flag, data->macvlanmode,\n                                    data->name)))\n            goto error;\n\n        net->guestIP.ips = data->ips;\n        net->guestIP.nips = data->nips;\n\n        if (data->gateway_ipv4 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv4, AF_INET,\n                                         &net->guestIP.routes,\n                                         &net->guestIP.nroutes) < 0)\n                goto error;\n\n        if (data->gateway_ipv6 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv6, AF_INET6,\n                                         &net->guestIP.routes,\n                                         &net->guestIP.nroutes) < 0)\n                goto error;\n\n        if (VIR_EXPAND_N(def->nets, def->nnets, 1) < 0)\n            goto error;\n        def->nets[def->nnets - 1] = net;\n    }\n\n    return 1;\n\n error:\n    for (i = 0; i < data->nips; i++)\n        VIR_FREE(data->ips[i]);\n    VIR_FREE(data->ips);\n    virDomainNetDefFree(net);\n    virDomainHostdevDefFree(hostdev);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcAddNetworkDefinition(virDomainDefPtr def, lxcNetworkParseData *data)\n{\n    virDomainNetDefPtr net = NULL;\n    virDomainHostdevDefPtr hostdev = NULL;\n    bool isPhys, isVlan = false;\n    size_t i;\n\n    if ((data->type == NULL) || STREQ(data->type, \"empty\") ||\n         STREQ(data->type, \"\") ||  STREQ(data->type, \"none\"))\n        return 0;\n\n    isPhys = STREQ(data->type, \"phys\");\n    isVlan = STREQ(data->type, \"vlan\");\n    if (data->type != NULL && (isPhys || isVlan)) {\n        if (!data->link) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Missing 'link' attribute for NIC\"));\n            goto error;\n        }\n        if (!(hostdev = lxcCreateHostdevDef(VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES,\n                                            VIR_DOMAIN_HOSTDEV_CAPS_TYPE_NET,\n                                            data->link)))\n            goto error;\n\n        /* This still requires the user to manually setup the vlan interface\n         * on the host */\n        if (isVlan && data->vlanid) {\n            VIR_FREE(hostdev->source.caps.u.net.ifname);\n            hostdev->source.caps.u.net.ifname = g_strdup_printf(\"%s.%s\",\n                                                                data->link,\n                                                                data->vlanid);\n        }\n\n        hostdev->source.caps.u.net.ip.ips = data->ips;\n        hostdev->source.caps.u.net.ip.nips = data->nips;\n\n        if (data->gateway_ipv4 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv4, AF_INET,\n                                         &hostdev->source.caps.u.net.ip.routes,\n                                         &hostdev->source.caps.u.net.ip.nroutes) < 0)\n                goto error;\n\n        if (data->gateway_ipv6 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv6, AF_INET6,\n                                         &hostdev->source.caps.u.net.ip.routes,\n                                         &hostdev->source.caps.u.net.ip.nroutes) < 0)\n                goto error;\n\n        if (VIR_EXPAND_N(def->hostdevs, def->nhostdevs, 1) < 0)\n            goto error;\n        def->hostdevs[def->nhostdevs - 1] = hostdev;\n    } else {\n        if (!(net = lxcCreateNetDef(data->type, data->link, data->mac,\n                                    data->flag, data->macvlanmode,\n                                    data->name)))\n            goto error;\n\n        net->guestIP.ips = data->ips;\n        net->guestIP.nips = data->nips;\n\n        if (data->gateway_ipv4 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv4, AF_INET,\n                                         &net->guestIP.routes,\n                                         &net->guestIP.nroutes) < 0)\n                goto error;\n\n        if (data->gateway_ipv6 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv6, AF_INET6,\n                                         &net->guestIP.routes,\n                                         &net->guestIP.nroutes) < 0)\n                goto error;\n\n        if (VIR_EXPAND_N(def->nets, def->nnets, 1) < 0)\n            goto error;\n        def->nets[def->nnets - 1] = net;\n    }\n\n    return 1;\n\n error:\n    for (i = 0; i < data->nips; i++)\n        VIR_FREE(data->ips[i]);\n    VIR_FREE(data->ips);\n    virDomainNetDefFree(net);\n    virDomainHostdevDefFree(hostdev);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfWalk",
          "args": [
            "properties",
            "lxcNetworkWalkCallback",
            "&networks"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "virConfWalk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1391-1408",
          "snippet": "int virConfWalk(virConfPtr conf,\n                virConfWalkCallback callback,\n                void *opaque)\n{\n    virConfEntryPtr cur;\n\n    if (!conf)\n        return 0;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (cur->name && cur->value &&\n            callback(cur->name, cur->value, opaque) < 0)\n            return -1;\n        cur = cur->next;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfWalk(virConfPtr conf,\n                virConfWalkCallback callback,\n                void *opaque)\n{\n    virConfEntryPtr cur;\n\n    if (!conf)\n        return 0;\n\n    cur = conf->entries;\n    while (cur != NULL) {\n        if (cur->name && cur->value &&\n            callback(cur->name, cur->value, opaque) < 0)\n            return -1;\n        cur = cur->next;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "lxcNetworkParseDataPtr",
            "1"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcConvertNetworkSettings(virDomainDefPtr def, virConfPtr properties)\n{\n    int status;\n    bool privnet = true;\n    size_t i, j;\n    lxcNetworkParseDataArray networks = {0, NULL};\n    int ret = -1;\n\n    networks.parseData = g_new0(lxcNetworkParseDataPtr, 1);\n\n    if (virConfWalk(properties, lxcNetworkWalkCallback, &networks) < 0)\n        goto error;\n\n    for (i = 0; i < networks.ndata; i++) {\n        lxcNetworkParseDataPtr data = networks.parseData[i];\n\n        status = lxcAddNetworkDefinition(def, data);\n\n        if (status < 0)\n            goto error;\n        else if (data->type != NULL && STREQ(data->type, \"none\"))\n            privnet = false;\n    }\n\n    if (networks.ndata == 0 && privnet) {\n        /* When no network type is provided LXC only adds loopback */\n        def->features[VIR_DOMAIN_FEATURE_PRIVNET] = VIR_TRISTATE_SWITCH_ON;\n    }\n\n    ret = 0;\n\n cleanup:\n    for (i = 0; i < networks.ndata; i++)\n        VIR_FREE(networks.parseData[i]);\n    VIR_FREE(networks.parseData);\n    return ret;\n\n error:\n    for (i = 0; i < networks.ndata; i++) {\n        lxcNetworkParseDataPtr data = networks.parseData[i];\n        for (j = 0; j < data->nips; j++)\n            VIR_FREE(data->ips[j]);\n        VIR_FREE(data->ips);\n    }\n    goto cleanup;\n}"
  },
  {
    "function_name": "lxcNetworkWalkCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "748-759",
    "snippet": "static int\nlxcNetworkWalkCallback(const char *name, virConfValuePtr value, void *data)\n{\n    lxcNetworkParseDataArray *networks = data;\n\n    if (STRPREFIX(name, \"lxc.network.\"))\n        return lxcNetworkParseDataEntryLegacy(name, value, networks);\n    if (STRPREFIX(name, \"lxc.net.\"))\n        return lxcNetworkParseDataEntry(name, value, networks);\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcNetworkParseDataEntry",
          "args": [
            "name",
            "value",
            "networks"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "lxcNetworkParseDataEntryLegacy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "733-745",
          "snippet": "static int\nlxcNetworkParseDataEntryLegacy(const char *name,\n                               virConfValuePtr value,\n                               lxcNetworkParseDataArray *networks)\n{\n    const char *suffix = STRSKIP(name, \"lxc.network.\");\n    lxcNetworkParseData *parseData;\n\n    if (!(parseData = lxcNetworkGetParseDataByIndexLegacy(networks, suffix)))\n        return -1;\n\n    return lxcNetworkParseDataSuffix(suffix, value, parseData);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcNetworkParseDataEntryLegacy(const char *name,\n                               virConfValuePtr value,\n                               lxcNetworkParseDataArray *networks)\n{\n    const char *suffix = STRSKIP(name, \"lxc.network.\");\n    lxcNetworkParseData *parseData;\n\n    if (!(parseData = lxcNetworkGetParseDataByIndexLegacy(networks, suffix)))\n        return -1;\n\n    return lxcNetworkParseDataSuffix(suffix, value, parseData);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "name",
            "\"lxc.net.\""
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "name",
            "\"lxc.network.\""
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcNetworkWalkCallback(const char *name, virConfValuePtr value, void *data)\n{\n    lxcNetworkParseDataArray *networks = data;\n\n    if (STRPREFIX(name, \"lxc.network.\"))\n        return lxcNetworkParseDataEntryLegacy(name, value, networks);\n    if (STRPREFIX(name, \"lxc.net.\"))\n        return lxcNetworkParseDataEntry(name, value, networks);\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcNetworkParseDataEntryLegacy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "733-745",
    "snippet": "static int\nlxcNetworkParseDataEntryLegacy(const char *name,\n                               virConfValuePtr value,\n                               lxcNetworkParseDataArray *networks)\n{\n    const char *suffix = STRSKIP(name, \"lxc.network.\");\n    lxcNetworkParseData *parseData;\n\n    if (!(parseData = lxcNetworkGetParseDataByIndexLegacy(networks, suffix)))\n        return -1;\n\n    return lxcNetworkParseDataSuffix(suffix, value, parseData);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcNetworkParseDataSuffix",
          "args": [
            "suffix",
            "value",
            "parseData"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "lxcNetworkParseDataSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "603-653",
          "snippet": "static int\nlxcNetworkParseDataSuffix(const char *entry,\n                          virConfValuePtr value,\n                          lxcNetworkParseData *parseData)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n\n    switch (elem) {\n    case VIR_LXC_NETWORK_CONFIG_TYPE:\n        parseData->type = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_LINK:\n        parseData->link = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_HWADDR:\n        parseData->mac = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_FLAGS:\n        parseData->flag = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_MACVLAN_MODE:\n        parseData->macvlanmode = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_VLAN_ID:\n        parseData->vlanid = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_NAME:\n        parseData->name = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4:\n    case VIR_LXC_NETWORK_CONFIG_IPV4_ADDRESS:\n    case VIR_LXC_NETWORK_CONFIG_IPV6:\n    case VIR_LXC_NETWORK_CONFIG_IPV6_ADDRESS:\n        if (lxcNetworkParseDataIPs(entry, value, parseData) < 0)\n            return -1;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4_GATEWAY:\n        parseData->gateway_ipv4 = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV6_GATEWAY:\n        parseData->gateway_ipv6 = value->str;\n        break;\n    default:\n        VIR_WARN(\"Unhandled network property: %s = %s\",\n                 entry,\n                 value->str);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcNetworkParseDataSuffix(const char *entry,\n                          virConfValuePtr value,\n                          lxcNetworkParseData *parseData)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n\n    switch (elem) {\n    case VIR_LXC_NETWORK_CONFIG_TYPE:\n        parseData->type = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_LINK:\n        parseData->link = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_HWADDR:\n        parseData->mac = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_FLAGS:\n        parseData->flag = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_MACVLAN_MODE:\n        parseData->macvlanmode = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_VLAN_ID:\n        parseData->vlanid = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_NAME:\n        parseData->name = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4:\n    case VIR_LXC_NETWORK_CONFIG_IPV4_ADDRESS:\n    case VIR_LXC_NETWORK_CONFIG_IPV6:\n    case VIR_LXC_NETWORK_CONFIG_IPV6_ADDRESS:\n        if (lxcNetworkParseDataIPs(entry, value, parseData) < 0)\n            return -1;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4_GATEWAY:\n        parseData->gateway_ipv4 = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV6_GATEWAY:\n        parseData->gateway_ipv6 = value->str;\n        break;\n    default:\n        VIR_WARN(\"Unhandled network property: %s = %s\",\n                 entry,\n                 value->str);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcNetworkGetParseDataByIndexLegacy",
          "args": [
            "networks",
            "suffix"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "lxcNetworkGetParseDataByIndexLegacy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "705-730",
          "snippet": "static lxcNetworkParseDataPtr\nlxcNetworkGetParseDataByIndexLegacy(lxcNetworkParseDataArray *networks,\n                                    const char *entry)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n    size_t ndata = networks->ndata;\n\n    if (elem == VIR_LXC_NETWORK_CONFIG_TYPE) {\n        /* Index was not found. So, it is time to add new *\n         * interface and return this last position.       */\n        if (VIR_EXPAND_N(networks->parseData, networks->ndata, 1) < 0)\n            return NULL;\n\n        networks->parseData[ndata] = g_new0(lxcNetworkParseData, 1);\n        networks->parseData[ndata]->index = networks->ndata;\n\n        return networks->parseData[ndata];\n    }\n\n    /* Return last element added like a stack. */\n    if (ndata > 0)\n        return networks->parseData[ndata - 1];\n\n    /* Not able to retrive an element */\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic lxcNetworkParseDataPtr\nlxcNetworkGetParseDataByIndexLegacy(lxcNetworkParseDataArray *networks,\n                                    const char *entry)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n    size_t ndata = networks->ndata;\n\n    if (elem == VIR_LXC_NETWORK_CONFIG_TYPE) {\n        /* Index was not found. So, it is time to add new *\n         * interface and return this last position.       */\n        if (VIR_EXPAND_N(networks->parseData, networks->ndata, 1) < 0)\n            return NULL;\n\n        networks->parseData[ndata] = g_new0(lxcNetworkParseData, 1);\n        networks->parseData[ndata]->index = networks->ndata;\n\n        return networks->parseData[ndata];\n    }\n\n    /* Return last element added like a stack. */\n    if (ndata > 0)\n        return networks->parseData[ndata - 1];\n\n    /* Not able to retrive an element */\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRSKIP",
          "args": [
            "name",
            "\"lxc.network.\""
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcNetworkParseDataEntryLegacy(const char *name,\n                               virConfValuePtr value,\n                               lxcNetworkParseDataArray *networks)\n{\n    const char *suffix = STRSKIP(name, \"lxc.network.\");\n    lxcNetworkParseData *parseData;\n\n    if (!(parseData = lxcNetworkGetParseDataByIndexLegacy(networks, suffix)))\n        return -1;\n\n    return lxcNetworkParseDataSuffix(suffix, value, parseData);\n}"
  },
  {
    "function_name": "lxcNetworkGetParseDataByIndexLegacy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "705-730",
    "snippet": "static lxcNetworkParseDataPtr\nlxcNetworkGetParseDataByIndexLegacy(lxcNetworkParseDataArray *networks,\n                                    const char *entry)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n    size_t ndata = networks->ndata;\n\n    if (elem == VIR_LXC_NETWORK_CONFIG_TYPE) {\n        /* Index was not found. So, it is time to add new *\n         * interface and return this last position.       */\n        if (VIR_EXPAND_N(networks->parseData, networks->ndata, 1) < 0)\n            return NULL;\n\n        networks->parseData[ndata] = g_new0(lxcNetworkParseData, 1);\n        networks->parseData[ndata]->index = networks->ndata;\n\n        return networks->parseData[ndata];\n    }\n\n    /* Return last element added like a stack. */\n    if (ndata > 0)\n        return networks->parseData[ndata - 1];\n\n    /* Not able to retrive an element */\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "lxcNetworkParseData",
            "1"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "networks->parseData",
            "networks->ndata",
            "1"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCNetworkConfigEntryTypeFromString",
          "args": [
            "entry"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic lxcNetworkParseDataPtr\nlxcNetworkGetParseDataByIndexLegacy(lxcNetworkParseDataArray *networks,\n                                    const char *entry)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n    size_t ndata = networks->ndata;\n\n    if (elem == VIR_LXC_NETWORK_CONFIG_TYPE) {\n        /* Index was not found. So, it is time to add new *\n         * interface and return this last position.       */\n        if (VIR_EXPAND_N(networks->parseData, networks->ndata, 1) < 0)\n            return NULL;\n\n        networks->parseData[ndata] = g_new0(lxcNetworkParseData, 1);\n        networks->parseData[ndata]->index = networks->ndata;\n\n        return networks->parseData[ndata];\n    }\n\n    /* Return last element added like a stack. */\n    if (ndata > 0)\n        return networks->parseData[ndata - 1];\n\n    /* Not able to retrive an element */\n    return NULL;\n}"
  },
  {
    "function_name": "lxcNetworkParseDataEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "680-702",
    "snippet": "static int\nlxcNetworkParseDataEntry(const char *name,\n                         virConfValuePtr value,\n                         lxcNetworkParseDataArray *networks)\n{\n    lxcNetworkParseData *parseData;\n    const char *suffix_tmp = STRSKIP(name, \"lxc.net.\");\n    char *suffix = NULL;\n    unsigned long long index;\n\n    if (virStrToLong_ull(suffix_tmp, &suffix, 10, &index) < 0)\n        return -1;\n\n    if (suffix[0] != '.')\n        return -1;\n\n    suffix++;\n\n    if (!(parseData = lxcNetworkGetParseDataByIndex(networks, index)))\n        return -1;\n\n    return lxcNetworkParseDataSuffix(suffix, value, parseData);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcNetworkParseDataSuffix",
          "args": [
            "suffix",
            "value",
            "parseData"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "lxcNetworkParseDataSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "603-653",
          "snippet": "static int\nlxcNetworkParseDataSuffix(const char *entry,\n                          virConfValuePtr value,\n                          lxcNetworkParseData *parseData)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n\n    switch (elem) {\n    case VIR_LXC_NETWORK_CONFIG_TYPE:\n        parseData->type = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_LINK:\n        parseData->link = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_HWADDR:\n        parseData->mac = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_FLAGS:\n        parseData->flag = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_MACVLAN_MODE:\n        parseData->macvlanmode = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_VLAN_ID:\n        parseData->vlanid = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_NAME:\n        parseData->name = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4:\n    case VIR_LXC_NETWORK_CONFIG_IPV4_ADDRESS:\n    case VIR_LXC_NETWORK_CONFIG_IPV6:\n    case VIR_LXC_NETWORK_CONFIG_IPV6_ADDRESS:\n        if (lxcNetworkParseDataIPs(entry, value, parseData) < 0)\n            return -1;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4_GATEWAY:\n        parseData->gateway_ipv4 = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV6_GATEWAY:\n        parseData->gateway_ipv6 = value->str;\n        break;\n    default:\n        VIR_WARN(\"Unhandled network property: %s = %s\",\n                 entry,\n                 value->str);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcNetworkParseDataSuffix(const char *entry,\n                          virConfValuePtr value,\n                          lxcNetworkParseData *parseData)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n\n    switch (elem) {\n    case VIR_LXC_NETWORK_CONFIG_TYPE:\n        parseData->type = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_LINK:\n        parseData->link = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_HWADDR:\n        parseData->mac = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_FLAGS:\n        parseData->flag = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_MACVLAN_MODE:\n        parseData->macvlanmode = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_VLAN_ID:\n        parseData->vlanid = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_NAME:\n        parseData->name = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4:\n    case VIR_LXC_NETWORK_CONFIG_IPV4_ADDRESS:\n    case VIR_LXC_NETWORK_CONFIG_IPV6:\n    case VIR_LXC_NETWORK_CONFIG_IPV6_ADDRESS:\n        if (lxcNetworkParseDataIPs(entry, value, parseData) < 0)\n            return -1;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4_GATEWAY:\n        parseData->gateway_ipv4 = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV6_GATEWAY:\n        parseData->gateway_ipv6 = value->str;\n        break;\n    default:\n        VIR_WARN(\"Unhandled network property: %s = %s\",\n                 entry,\n                 value->str);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcNetworkGetParseDataByIndex",
          "args": [
            "networks",
            "index"
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "lxcNetworkGetParseDataByIndexLegacy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "705-730",
          "snippet": "static lxcNetworkParseDataPtr\nlxcNetworkGetParseDataByIndexLegacy(lxcNetworkParseDataArray *networks,\n                                    const char *entry)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n    size_t ndata = networks->ndata;\n\n    if (elem == VIR_LXC_NETWORK_CONFIG_TYPE) {\n        /* Index was not found. So, it is time to add new *\n         * interface and return this last position.       */\n        if (VIR_EXPAND_N(networks->parseData, networks->ndata, 1) < 0)\n            return NULL;\n\n        networks->parseData[ndata] = g_new0(lxcNetworkParseData, 1);\n        networks->parseData[ndata]->index = networks->ndata;\n\n        return networks->parseData[ndata];\n    }\n\n    /* Return last element added like a stack. */\n    if (ndata > 0)\n        return networks->parseData[ndata - 1];\n\n    /* Not able to retrive an element */\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic lxcNetworkParseDataPtr\nlxcNetworkGetParseDataByIndexLegacy(lxcNetworkParseDataArray *networks,\n                                    const char *entry)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n    size_t ndata = networks->ndata;\n\n    if (elem == VIR_LXC_NETWORK_CONFIG_TYPE) {\n        /* Index was not found. So, it is time to add new *\n         * interface and return this last position.       */\n        if (VIR_EXPAND_N(networks->parseData, networks->ndata, 1) < 0)\n            return NULL;\n\n        networks->parseData[ndata] = g_new0(lxcNetworkParseData, 1);\n        networks->parseData[ndata]->index = networks->ndata;\n\n        return networks->parseData[ndata];\n    }\n\n    /* Return last element added like a stack. */\n    if (ndata > 0)\n        return networks->parseData[ndata - 1];\n\n    /* Not able to retrive an element */\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "suffix_tmp",
            "&suffix",
            "10",
            "&index"
          ],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRSKIP",
          "args": [
            "name",
            "\"lxc.net.\""
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcNetworkParseDataEntry(const char *name,\n                         virConfValuePtr value,\n                         lxcNetworkParseDataArray *networks)\n{\n    lxcNetworkParseData *parseData;\n    const char *suffix_tmp = STRSKIP(name, \"lxc.net.\");\n    char *suffix = NULL;\n    unsigned long long index;\n\n    if (virStrToLong_ull(suffix_tmp, &suffix, 10, &index) < 0)\n        return -1;\n\n    if (suffix[0] != '.')\n        return -1;\n\n    suffix++;\n\n    if (!(parseData = lxcNetworkGetParseDataByIndex(networks, index)))\n        return -1;\n\n    return lxcNetworkParseDataSuffix(suffix, value, parseData);\n}"
  },
  {
    "function_name": "lxcNetworkGetParseDataByIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "656-677",
    "snippet": "static lxcNetworkParseDataPtr\nlxcNetworkGetParseDataByIndex(lxcNetworkParseDataArray *networks,\n                              unsigned int index)\n{\n    size_t ndata = networks->ndata;\n    size_t i;\n\n    for (i = 0; i < ndata; i++) {\n        if (networks->parseData[i]->index == index)\n            return networks->parseData[i];\n    }\n\n    /* Index was not found. So, it is time to add new *\n     * interface and return this last position.       */\n    if (VIR_EXPAND_N(networks->parseData, networks->ndata, 1) < 0)\n        return NULL;\n\n    networks->parseData[ndata] = g_new0(lxcNetworkParseData, 1);\n    networks->parseData[ndata]->index = index;\n\n    return networks->parseData[ndata];\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "lxcNetworkParseData",
            "1"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "networks->parseData",
            "networks->ndata",
            "1"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic lxcNetworkParseDataPtr\nlxcNetworkGetParseDataByIndex(lxcNetworkParseDataArray *networks,\n                              unsigned int index)\n{\n    size_t ndata = networks->ndata;\n    size_t i;\n\n    for (i = 0; i < ndata; i++) {\n        if (networks->parseData[i]->index == index)\n            return networks->parseData[i];\n    }\n\n    /* Index was not found. So, it is time to add new *\n     * interface and return this last position.       */\n    if (VIR_EXPAND_N(networks->parseData, networks->ndata, 1) < 0)\n        return NULL;\n\n    networks->parseData[ndata] = g_new0(lxcNetworkParseData, 1);\n    networks->parseData[ndata]->index = index;\n\n    return networks->parseData[ndata];\n}"
  },
  {
    "function_name": "lxcNetworkParseDataSuffix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "603-653",
    "snippet": "static int\nlxcNetworkParseDataSuffix(const char *entry,\n                          virConfValuePtr value,\n                          lxcNetworkParseData *parseData)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n\n    switch (elem) {\n    case VIR_LXC_NETWORK_CONFIG_TYPE:\n        parseData->type = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_LINK:\n        parseData->link = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_HWADDR:\n        parseData->mac = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_FLAGS:\n        parseData->flag = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_MACVLAN_MODE:\n        parseData->macvlanmode = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_VLAN_ID:\n        parseData->vlanid = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_NAME:\n        parseData->name = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4:\n    case VIR_LXC_NETWORK_CONFIG_IPV4_ADDRESS:\n    case VIR_LXC_NETWORK_CONFIG_IPV6:\n    case VIR_LXC_NETWORK_CONFIG_IPV6_ADDRESS:\n        if (lxcNetworkParseDataIPs(entry, value, parseData) < 0)\n            return -1;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4_GATEWAY:\n        parseData->gateway_ipv4 = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV6_GATEWAY:\n        parseData->gateway_ipv6 = value->str;\n        break;\n    default:\n        VIR_WARN(\"Unhandled network property: %s = %s\",\n                 entry,\n                 value->str);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unhandled network property: %s = %s\"",
            "entry",
            "value->str"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcNetworkParseDataIPs",
          "args": [
            "entry",
            "value",
            "parseData"
          ],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "lxcNetworkParseDataIPs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "564-600",
          "snippet": "static int\nlxcNetworkParseDataIPs(const char *name,\n                       virConfValuePtr value,\n                       lxcNetworkParseData *parseData)\n{\n    int family = AF_INET;\n    char **ipparts = NULL;\n    virNetDevIPAddrPtr ip = NULL;\n\n    if (VIR_ALLOC(ip) < 0)\n        return -1;\n\n    if (STREQ(name, \"ipv6\") || STREQ(name, \"ipv6.address\"))\n        family = AF_INET6;\n\n    ipparts = virStringSplit(value->str, \"/\", 2);\n    if (virStringListLength((const char * const *)ipparts) != 2 ||\n        virSocketAddrParse(&ip->address, ipparts[0], family) < 0 ||\n        virStrToLong_ui(ipparts[1], NULL, 10, &ip->prefix) < 0) {\n\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid CIDR address: '%s'\"), value->str);\n\n        virStringListFree(ipparts);\n        VIR_FREE(ip);\n        return -1;\n    }\n\n    virStringListFree(ipparts);\n\n    if (VIR_APPEND_ELEMENT(parseData->ips, parseData->nips, ip) < 0) {\n        VIR_FREE(ip);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcNetworkParseDataIPs(const char *name,\n                       virConfValuePtr value,\n                       lxcNetworkParseData *parseData)\n{\n    int family = AF_INET;\n    char **ipparts = NULL;\n    virNetDevIPAddrPtr ip = NULL;\n\n    if (VIR_ALLOC(ip) < 0)\n        return -1;\n\n    if (STREQ(name, \"ipv6\") || STREQ(name, \"ipv6.address\"))\n        family = AF_INET6;\n\n    ipparts = virStringSplit(value->str, \"/\", 2);\n    if (virStringListLength((const char * const *)ipparts) != 2 ||\n        virSocketAddrParse(&ip->address, ipparts[0], family) < 0 ||\n        virStrToLong_ui(ipparts[1], NULL, 10, &ip->prefix) < 0) {\n\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid CIDR address: '%s'\"), value->str);\n\n        virStringListFree(ipparts);\n        VIR_FREE(ip);\n        return -1;\n    }\n\n    virStringListFree(ipparts);\n\n    if (VIR_APPEND_ELEMENT(parseData->ips, parseData->nips, ip) < 0) {\n        VIR_FREE(ip);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCNetworkConfigEntryTypeFromString",
          "args": [
            "entry"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcNetworkParseDataSuffix(const char *entry,\n                          virConfValuePtr value,\n                          lxcNetworkParseData *parseData)\n{\n    int elem = virLXCNetworkConfigEntryTypeFromString(entry);\n\n    switch (elem) {\n    case VIR_LXC_NETWORK_CONFIG_TYPE:\n        parseData->type = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_LINK:\n        parseData->link = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_HWADDR:\n        parseData->mac = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_FLAGS:\n        parseData->flag = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_MACVLAN_MODE:\n        parseData->macvlanmode = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_VLAN_ID:\n        parseData->vlanid = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_NAME:\n        parseData->name = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4:\n    case VIR_LXC_NETWORK_CONFIG_IPV4_ADDRESS:\n    case VIR_LXC_NETWORK_CONFIG_IPV6:\n    case VIR_LXC_NETWORK_CONFIG_IPV6_ADDRESS:\n        if (lxcNetworkParseDataIPs(entry, value, parseData) < 0)\n            return -1;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV4_GATEWAY:\n        parseData->gateway_ipv4 = value->str;\n        break;\n    case VIR_LXC_NETWORK_CONFIG_IPV6_GATEWAY:\n        parseData->gateway_ipv6 = value->str;\n        break;\n    default:\n        VIR_WARN(\"Unhandled network property: %s = %s\",\n                 entry,\n                 value->str);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcNetworkParseDataIPs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "564-600",
    "snippet": "static int\nlxcNetworkParseDataIPs(const char *name,\n                       virConfValuePtr value,\n                       lxcNetworkParseData *parseData)\n{\n    int family = AF_INET;\n    char **ipparts = NULL;\n    virNetDevIPAddrPtr ip = NULL;\n\n    if (VIR_ALLOC(ip) < 0)\n        return -1;\n\n    if (STREQ(name, \"ipv6\") || STREQ(name, \"ipv6.address\"))\n        family = AF_INET6;\n\n    ipparts = virStringSplit(value->str, \"/\", 2);\n    if (virStringListLength((const char * const *)ipparts) != 2 ||\n        virSocketAddrParse(&ip->address, ipparts[0], family) < 0 ||\n        virStrToLong_ui(ipparts[1], NULL, 10, &ip->prefix) < 0) {\n\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid CIDR address: '%s'\"), value->str);\n\n        virStringListFree(ipparts);\n        VIR_FREE(ip);\n        return -1;\n    }\n\n    virStringListFree(ipparts);\n\n    if (VIR_APPEND_ELEMENT(parseData->ips, parseData->nips, ip) < 0) {\n        VIR_FREE(ip);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ip"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "parseData->ips",
            "parseData->nips",
            "ip"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "ipparts"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ip"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid CIDR address: '%s'\")",
            "value->str"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid CIDR address: '%s'\""
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "ipparts[1]",
            "NULL",
            "10",
            "&ip->prefix"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSocketAddrParse",
          "args": [
            "&ip->address",
            "ipparts[0]",
            "family"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "135-158",
          "snippet": "int virSocketAddrParse(virSocketAddrPtr addr, const char *val, int family)\n{\n    int len;\n    struct addrinfo *res;\n\n    if (virSocketAddrParseInternal(&res, val, family, AI_NUMERICHOST, true) < 0)\n        return -1;\n\n    if (res == NULL) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"No socket addresses found for '%s'\"),\n                       val);\n        return -1;\n    }\n\n    len = res->ai_addrlen;\n    if (addr != NULL) {\n        memcpy(&addr->data.stor, res->ai_addr, len);\n        addr->len = res->ai_addrlen;\n    }\n\n    freeaddrinfo(res);\n    return len;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nint virSocketAddrParse(virSocketAddrPtr addr, const char *val, int family)\n{\n    int len;\n    struct addrinfo *res;\n\n    if (virSocketAddrParseInternal(&res, val, family, AI_NUMERICHOST, true) < 0)\n        return -1;\n\n    if (res == NULL) {\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"No socket addresses found for '%s'\"),\n                       val);\n        return -1;\n    }\n\n    len = res->ai_addrlen;\n    if (addr != NULL) {\n        memcpy(&addr->data.stor, res->ai_addr, len);\n        addr->len = res->ai_addrlen;\n    }\n\n    freeaddrinfo(res);\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringListLength",
          "args": [
            "(const char * const *)ipparts"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "893-901",
          "snippet": "size_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nsize_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "value->str",
            "\"/\"",
            "2"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "name",
            "\"ipv6.address\""
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "name",
            "\"ipv6\""
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ip"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcNetworkParseDataIPs(const char *name,\n                       virConfValuePtr value,\n                       lxcNetworkParseData *parseData)\n{\n    int family = AF_INET;\n    char **ipparts = NULL;\n    virNetDevIPAddrPtr ip = NULL;\n\n    if (VIR_ALLOC(ip) < 0)\n        return -1;\n\n    if (STREQ(name, \"ipv6\") || STREQ(name, \"ipv6.address\"))\n        family = AF_INET6;\n\n    ipparts = virStringSplit(value->str, \"/\", 2);\n    if (virStringListLength((const char * const *)ipparts) != 2 ||\n        virSocketAddrParse(&ip->address, ipparts[0], family) < 0 ||\n        virStrToLong_ui(ipparts[1], NULL, 10, &ip->prefix) < 0) {\n\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid CIDR address: '%s'\"), value->str);\n\n        virStringListFree(ipparts);\n        VIR_FREE(ip);\n        return -1;\n    }\n\n    virStringListFree(ipparts);\n\n    if (VIR_APPEND_ELEMENT(parseData->ips, parseData->nips, ip) < 0) {\n        VIR_FREE(ip);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcAddNetworkDefinition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "474-561",
    "snippet": "static int\nlxcAddNetworkDefinition(virDomainDefPtr def, lxcNetworkParseData *data)\n{\n    virDomainNetDefPtr net = NULL;\n    virDomainHostdevDefPtr hostdev = NULL;\n    bool isPhys, isVlan = false;\n    size_t i;\n\n    if ((data->type == NULL) || STREQ(data->type, \"empty\") ||\n         STREQ(data->type, \"\") ||  STREQ(data->type, \"none\"))\n        return 0;\n\n    isPhys = STREQ(data->type, \"phys\");\n    isVlan = STREQ(data->type, \"vlan\");\n    if (data->type != NULL && (isPhys || isVlan)) {\n        if (!data->link) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Missing 'link' attribute for NIC\"));\n            goto error;\n        }\n        if (!(hostdev = lxcCreateHostdevDef(VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES,\n                                            VIR_DOMAIN_HOSTDEV_CAPS_TYPE_NET,\n                                            data->link)))\n            goto error;\n\n        /* This still requires the user to manually setup the vlan interface\n         * on the host */\n        if (isVlan && data->vlanid) {\n            VIR_FREE(hostdev->source.caps.u.net.ifname);\n            hostdev->source.caps.u.net.ifname = g_strdup_printf(\"%s.%s\",\n                                                                data->link,\n                                                                data->vlanid);\n        }\n\n        hostdev->source.caps.u.net.ip.ips = data->ips;\n        hostdev->source.caps.u.net.ip.nips = data->nips;\n\n        if (data->gateway_ipv4 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv4, AF_INET,\n                                         &hostdev->source.caps.u.net.ip.routes,\n                                         &hostdev->source.caps.u.net.ip.nroutes) < 0)\n                goto error;\n\n        if (data->gateway_ipv6 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv6, AF_INET6,\n                                         &hostdev->source.caps.u.net.ip.routes,\n                                         &hostdev->source.caps.u.net.ip.nroutes) < 0)\n                goto error;\n\n        if (VIR_EXPAND_N(def->hostdevs, def->nhostdevs, 1) < 0)\n            goto error;\n        def->hostdevs[def->nhostdevs - 1] = hostdev;\n    } else {\n        if (!(net = lxcCreateNetDef(data->type, data->link, data->mac,\n                                    data->flag, data->macvlanmode,\n                                    data->name)))\n            goto error;\n\n        net->guestIP.ips = data->ips;\n        net->guestIP.nips = data->nips;\n\n        if (data->gateway_ipv4 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv4, AF_INET,\n                                         &net->guestIP.routes,\n                                         &net->guestIP.nroutes) < 0)\n                goto error;\n\n        if (data->gateway_ipv6 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv6, AF_INET6,\n                                         &net->guestIP.routes,\n                                         &net->guestIP.nroutes) < 0)\n                goto error;\n\n        if (VIR_EXPAND_N(def->nets, def->nnets, 1) < 0)\n            goto error;\n        def->nets[def->nnets - 1] = net;\n    }\n\n    return 1;\n\n error:\n    for (i = 0; i < data->nips; i++)\n        VIR_FREE(data->ips[i]);\n    VIR_FREE(data->ips);\n    virDomainNetDefFree(net);\n    virDomainHostdevDefFree(hostdev);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainHostdevDefFree",
          "args": [
            "hostdev"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3002-3015",
          "snippet": "void virDomainHostdevDefFree(virDomainHostdevDefPtr def)\n{\n    if (!def)\n        return;\n\n    /* free all subordinate objects */\n    virDomainHostdevDefClear(def);\n\n    /* If there is a parentnet device object, it will handle freeing\n     * the memory.\n     */\n    if (!def->parentnet)\n        VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def)\n{\n    if (!def)\n        return;\n\n    /* free all subordinate objects */\n    virDomainHostdevDefClear(def);\n\n    /* If there is a parentnet device object, it will handle freeing\n     * the memory.\n     */\n    if (!def->parentnet)\n        VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetDefFree",
          "args": [
            "net"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2481-2489",
          "snippet": "void\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->ips"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data->ips[i]"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "def->nets",
            "def->nnets",
            "1"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcAddNetworkRouteDefinition",
          "args": [
            "data->gateway_ipv6",
            "AF_INET6",
            "&net->guestIP.routes",
            "&net->guestIP.nroutes"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "lxcAddNetworkRouteDefinition",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "440-472",
          "snippet": "static int\nlxcAddNetworkRouteDefinition(const char *address,\n                             int family,\n                             virNetDevIPRoutePtr **routes,\n                             size_t *nroutes)\n{\n    virNetDevIPRoutePtr route = NULL;\n    char *familyStr = NULL;\n    char *zero = NULL;\n\n    zero = g_strdup(family == AF_INET ? VIR_SOCKET_ADDR_IPV4_ALL : VIR_SOCKET_ADDR_IPV6_ALL);\n\n    familyStr = g_strdup(family == AF_INET ? \"ipv4\" : \"ipv6\");\n\n    if (!(route = virNetDevIPRouteCreate(_(\"Domain interface\"), familyStr,\n                                         zero, NULL, address, 0, false,\n                                         0, false)))\n        goto error;\n\n    if (VIR_APPEND_ELEMENT(*routes, *nroutes, route) < 0)\n        goto error;\n\n    VIR_FREE(familyStr);\n    VIR_FREE(zero);\n\n    return 0;\n\n error:\n    VIR_FREE(familyStr);\n    VIR_FREE(zero);\n    virNetDevIPRouteFree(route);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcAddNetworkRouteDefinition(const char *address,\n                             int family,\n                             virNetDevIPRoutePtr **routes,\n                             size_t *nroutes)\n{\n    virNetDevIPRoutePtr route = NULL;\n    char *familyStr = NULL;\n    char *zero = NULL;\n\n    zero = g_strdup(family == AF_INET ? VIR_SOCKET_ADDR_IPV4_ALL : VIR_SOCKET_ADDR_IPV6_ALL);\n\n    familyStr = g_strdup(family == AF_INET ? \"ipv4\" : \"ipv6\");\n\n    if (!(route = virNetDevIPRouteCreate(_(\"Domain interface\"), familyStr,\n                                         zero, NULL, address, 0, false,\n                                         0, false)))\n        goto error;\n\n    if (VIR_APPEND_ELEMENT(*routes, *nroutes, route) < 0)\n        goto error;\n\n    VIR_FREE(familyStr);\n    VIR_FREE(zero);\n\n    return 0;\n\n error:\n    VIR_FREE(familyStr);\n    VIR_FREE(zero);\n    virNetDevIPRouteFree(route);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcCreateNetDef",
          "args": [
            "data->type",
            "data->link",
            "data->mac",
            "data->flag",
            "data->macvlanmode",
            "data->name"
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "lxcCreateNetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "344-398",
          "snippet": "static virDomainNetDefPtr\nlxcCreateNetDef(const char *type,\n                const char *linkdev,\n                const char *mac,\n                const char *flag,\n                const char *macvlanmode,\n                const char *name)\n{\n    virDomainNetDefPtr net = NULL;\n    virMacAddr macAddr;\n\n    if (!(net = virDomainNetDefNew(NULL)))\n        goto error;\n\n    if (STREQ_NULLABLE(flag, \"up\"))\n        net->linkstate = VIR_DOMAIN_NET_INTERFACE_LINK_STATE_UP;\n    else\n        net->linkstate = VIR_DOMAIN_NET_INTERFACE_LINK_STATE_DOWN;\n\n    net->ifname_guest = g_strdup(name);\n\n    if (mac && virMacAddrParse(mac, &macAddr) == 0)\n        net->mac = macAddr;\n\n    if (STREQ(type, \"veth\")) {\n        if (linkdev) {\n            net->type = VIR_DOMAIN_NET_TYPE_BRIDGE;\n            net->data.bridge.brname = g_strdup(linkdev);\n        } else {\n            net->type = VIR_DOMAIN_NET_TYPE_ETHERNET;\n        }\n    } else if (STREQ(type, \"macvlan\")) {\n        net->type = VIR_DOMAIN_NET_TYPE_DIRECT;\n\n        if (!linkdev)\n            goto error;\n\n        net->data.direct.linkdev = g_strdup(linkdev);\n\n        if (!macvlanmode || STREQ(macvlanmode, \"private\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_PRIVATE;\n        else if (STREQ(macvlanmode, \"vepa\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_VEPA;\n        else if (STREQ(macvlanmode, \"bridge\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_BRIDGE;\n        else\n            VIR_WARN(\"Unknown macvlan type: %s\", macvlanmode);\n    }\n\n    return net;\n\n error:\n    virDomainNetDefFree(net);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virDomainNetDefPtr\nlxcCreateNetDef(const char *type,\n                const char *linkdev,\n                const char *mac,\n                const char *flag,\n                const char *macvlanmode,\n                const char *name)\n{\n    virDomainNetDefPtr net = NULL;\n    virMacAddr macAddr;\n\n    if (!(net = virDomainNetDefNew(NULL)))\n        goto error;\n\n    if (STREQ_NULLABLE(flag, \"up\"))\n        net->linkstate = VIR_DOMAIN_NET_INTERFACE_LINK_STATE_UP;\n    else\n        net->linkstate = VIR_DOMAIN_NET_INTERFACE_LINK_STATE_DOWN;\n\n    net->ifname_guest = g_strdup(name);\n\n    if (mac && virMacAddrParse(mac, &macAddr) == 0)\n        net->mac = macAddr;\n\n    if (STREQ(type, \"veth\")) {\n        if (linkdev) {\n            net->type = VIR_DOMAIN_NET_TYPE_BRIDGE;\n            net->data.bridge.brname = g_strdup(linkdev);\n        } else {\n            net->type = VIR_DOMAIN_NET_TYPE_ETHERNET;\n        }\n    } else if (STREQ(type, \"macvlan\")) {\n        net->type = VIR_DOMAIN_NET_TYPE_DIRECT;\n\n        if (!linkdev)\n            goto error;\n\n        net->data.direct.linkdev = g_strdup(linkdev);\n\n        if (!macvlanmode || STREQ(macvlanmode, \"private\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_PRIVATE;\n        else if (STREQ(macvlanmode, \"vepa\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_VEPA;\n        else if (STREQ(macvlanmode, \"bridge\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_BRIDGE;\n        else\n            VIR_WARN(\"Unknown macvlan type: %s\", macvlanmode);\n    }\n\n    return net;\n\n error:\n    virDomainNetDefFree(net);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "def->hostdevs",
            "def->nhostdevs",
            "1"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s.%s\"",
            "data->link",
            "data->vlanid"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "hostdev->source.caps.u.net.ifname"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcCreateHostdevDef",
          "args": [
            "VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES",
            "VIR_DOMAIN_HOSTDEV_CAPS_TYPE_NET",
            "data->link"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "lxcCreateHostdevDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "400-415",
          "snippet": "static virDomainHostdevDefPtr\nlxcCreateHostdevDef(int mode, int type, const char *data)\n{\n    virDomainHostdevDefPtr hostdev = virDomainHostdevDefNew();\n\n    if (!hostdev)\n        return NULL;\n\n    hostdev->mode = mode;\n    hostdev->source.caps.type = type;\n\n    if (type == VIR_DOMAIN_HOSTDEV_CAPS_TYPE_NET)\n        hostdev->source.caps.u.net.ifname = g_strdup(data);\n\n    return hostdev;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virDomainHostdevDefPtr\nlxcCreateHostdevDef(int mode, int type, const char *data)\n{\n    virDomainHostdevDefPtr hostdev = virDomainHostdevDefNew();\n\n    if (!hostdev)\n        return NULL;\n\n    hostdev->mode = mode;\n    hostdev->source.caps.type = type;\n\n    if (type == VIR_DOMAIN_HOSTDEV_CAPS_TYPE_NET)\n        hostdev->source.caps.u.net.ifname = g_strdup(data);\n\n    return hostdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Missing 'link' attribute for NIC\")"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Missing 'link' attribute for NIC\""
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "data->type",
            "\"vlan\""
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "data->type",
            "\"phys\""
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "data->type",
            "\"none\""
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "data->type",
            "\"\""
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "data->type",
            "\"empty\""
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcAddNetworkDefinition(virDomainDefPtr def, lxcNetworkParseData *data)\n{\n    virDomainNetDefPtr net = NULL;\n    virDomainHostdevDefPtr hostdev = NULL;\n    bool isPhys, isVlan = false;\n    size_t i;\n\n    if ((data->type == NULL) || STREQ(data->type, \"empty\") ||\n         STREQ(data->type, \"\") ||  STREQ(data->type, \"none\"))\n        return 0;\n\n    isPhys = STREQ(data->type, \"phys\");\n    isVlan = STREQ(data->type, \"vlan\");\n    if (data->type != NULL && (isPhys || isVlan)) {\n        if (!data->link) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Missing 'link' attribute for NIC\"));\n            goto error;\n        }\n        if (!(hostdev = lxcCreateHostdevDef(VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES,\n                                            VIR_DOMAIN_HOSTDEV_CAPS_TYPE_NET,\n                                            data->link)))\n            goto error;\n\n        /* This still requires the user to manually setup the vlan interface\n         * on the host */\n        if (isVlan && data->vlanid) {\n            VIR_FREE(hostdev->source.caps.u.net.ifname);\n            hostdev->source.caps.u.net.ifname = g_strdup_printf(\"%s.%s\",\n                                                                data->link,\n                                                                data->vlanid);\n        }\n\n        hostdev->source.caps.u.net.ip.ips = data->ips;\n        hostdev->source.caps.u.net.ip.nips = data->nips;\n\n        if (data->gateway_ipv4 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv4, AF_INET,\n                                         &hostdev->source.caps.u.net.ip.routes,\n                                         &hostdev->source.caps.u.net.ip.nroutes) < 0)\n                goto error;\n\n        if (data->gateway_ipv6 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv6, AF_INET6,\n                                         &hostdev->source.caps.u.net.ip.routes,\n                                         &hostdev->source.caps.u.net.ip.nroutes) < 0)\n                goto error;\n\n        if (VIR_EXPAND_N(def->hostdevs, def->nhostdevs, 1) < 0)\n            goto error;\n        def->hostdevs[def->nhostdevs - 1] = hostdev;\n    } else {\n        if (!(net = lxcCreateNetDef(data->type, data->link, data->mac,\n                                    data->flag, data->macvlanmode,\n                                    data->name)))\n            goto error;\n\n        net->guestIP.ips = data->ips;\n        net->guestIP.nips = data->nips;\n\n        if (data->gateway_ipv4 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv4, AF_INET,\n                                         &net->guestIP.routes,\n                                         &net->guestIP.nroutes) < 0)\n                goto error;\n\n        if (data->gateway_ipv6 &&\n            lxcAddNetworkRouteDefinition(data->gateway_ipv6, AF_INET6,\n                                         &net->guestIP.routes,\n                                         &net->guestIP.nroutes) < 0)\n                goto error;\n\n        if (VIR_EXPAND_N(def->nets, def->nnets, 1) < 0)\n            goto error;\n        def->nets[def->nnets - 1] = net;\n    }\n\n    return 1;\n\n error:\n    for (i = 0; i < data->nips; i++)\n        VIR_FREE(data->ips[i]);\n    VIR_FREE(data->ips);\n    virDomainNetDefFree(net);\n    virDomainHostdevDefFree(hostdev);\n    return -1;\n}"
  },
  {
    "function_name": "lxcAddNetworkRouteDefinition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "440-472",
    "snippet": "static int\nlxcAddNetworkRouteDefinition(const char *address,\n                             int family,\n                             virNetDevIPRoutePtr **routes,\n                             size_t *nroutes)\n{\n    virNetDevIPRoutePtr route = NULL;\n    char *familyStr = NULL;\n    char *zero = NULL;\n\n    zero = g_strdup(family == AF_INET ? VIR_SOCKET_ADDR_IPV4_ALL : VIR_SOCKET_ADDR_IPV6_ALL);\n\n    familyStr = g_strdup(family == AF_INET ? \"ipv4\" : \"ipv6\");\n\n    if (!(route = virNetDevIPRouteCreate(_(\"Domain interface\"), familyStr,\n                                         zero, NULL, address, 0, false,\n                                         0, false)))\n        goto error;\n\n    if (VIR_APPEND_ELEMENT(*routes, *nroutes, route) < 0)\n        goto error;\n\n    VIR_FREE(familyStr);\n    VIR_FREE(zero);\n\n    return 0;\n\n error:\n    VIR_FREE(familyStr);\n    VIR_FREE(zero);\n    virNetDevIPRouteFree(route);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevIPRouteFree",
          "args": [
            "route"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevIPRouteFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevip.c",
          "lines": "975-982",
          "snippet": "void\nvirNetDevIPRouteFree(virNetDevIPRoutePtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}",
          "includes": [
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <net/if.h>",
            "# include <sys/ioctl.h>",
            "# include <ifaddrs.h>",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetlink.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevip.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <net/if.h>\n# include <sys/ioctl.h>\n# include <ifaddrs.h>\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virnetlink.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevip.h\"\n#include <config.h>\n\nvoid\nvirNetDevIPRouteFree(virNetDevIPRoutePtr def)\n{\n    if (!def)\n        return;\n    VIR_FREE(def->family);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "zero"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "familyStr"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "zero"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "familyStr"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "*routes",
            "*nroutes",
            "route"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevIPRouteCreate",
          "args": [
            "_(\"Domain interface\")",
            "familyStr",
            "zero",
            "NULL",
            "address",
            "0",
            "false",
            "0",
            "false"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevIPRouteCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/networkcommon_conf.c",
          "lines": "33-218",
          "snippet": "virNetDevIPRoutePtr\nvirNetDevIPRouteCreate(const char *errorDetail,\n                       const char *family,\n                       const char *address,\n                       const char *netmask,\n                       const char *gateway,\n                       unsigned int prefix,\n                       bool hasPrefix,\n                       unsigned int metric,\n                       bool hasMetric)\n{\n    virNetDevIPRoutePtr def = NULL;\n    virSocketAddr testAddr;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->family = g_strdup(family);\n\n    def->prefix = prefix;\n    def->has_prefix = hasPrefix;\n    def->metric = metric;\n    def->has_metric = hasMetric;\n\n    /* Note: both network and gateway addresses must be specified */\n\n    if (!address) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required address attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (!gateway) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required gateway attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->address, address, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad network address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->gateway, gateway, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad gateway address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, gateway);\n        goto error;\n    }\n\n    /* validate network address, etc. for each family */\n    if ((def->family == NULL) || (STREQ(def->family, \"ipv4\"))) {\n        if (!(VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET) ||\n              VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_UNSPEC))) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 address '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            if (virSocketAddrParse(&def->netmask, netmask, AF_UNSPEC) < 0) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Bad netmask address '%s' \"\n                                 \"in route definition\"),\n                               errorDetail, netmask);\n                goto error;\n            }\n            if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->netmask, AF_INET)) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Invalid netmask '%s' \"\n                                 \"for address '%s' (both must be IPv4)\"),\n                               errorDetail, netmask, address);\n                goto error;\n            }\n            if (def->has_prefix) {\n                /* can't have both netmask and prefix at the same time */\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Route definition cannot have both \"\n                                 \"a prefix and a netmask\"),\n                               errorDetail);\n                goto error;\n            }\n        }\n        if (def->prefix > 32) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 32\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else if (STREQ(def->family, \"ipv6\")) {\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 family specified for non-IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Specifying netmask invalid for IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 specified for non-IPv6 gateway address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, gateway);\n            goto error;\n        }\n        if (def->prefix > 128) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 128\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Unrecognized family '%s' \"\n                         \"in route definition\"),\n                       errorDetail, def->family);\n        goto error;\n    }\n\n    /* make sure the address is a network address */\n    if (netmask) {\n        if (virSocketAddrMask(&def->address, &def->netmask, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with netmask '%s' \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, netmask);\n            goto error;\n        }\n    } else {\n        if (virSocketAddrMaskByPrefix(&def->address,\n                                      def->prefix, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with prefix %u \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, def->prefix);\n            goto error;\n        }\n    }\n    if (!virSocketAddrEqual(&def->address, &testAddr)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Address '%s' in route definition \"\n                         \"is not a network address\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    return def;\n\n error:\n    virNetDevIPRouteFree(def);\n    return NULL;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"networkcommon_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirNetDevIPRoutePtr\nvirNetDevIPRouteCreate(const char *errorDetail,\n                       const char *family,\n                       const char *address,\n                       const char *netmask,\n                       const char *gateway,\n                       unsigned int prefix,\n                       bool hasPrefix,\n                       unsigned int metric,\n                       bool hasMetric)\n{\n    virNetDevIPRoutePtr def = NULL;\n    virSocketAddr testAddr;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->family = g_strdup(family);\n\n    def->prefix = prefix;\n    def->has_prefix = hasPrefix;\n    def->metric = metric;\n    def->has_metric = hasMetric;\n\n    /* Note: both network and gateway addresses must be specified */\n\n    if (!address) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required address attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (!gateway) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Missing required gateway attribute \"\n                         \"in route definition\"),\n                       errorDetail);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->address, address, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad network address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    if (virSocketAddrParse(&def->gateway, gateway, AF_UNSPEC) < 0) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Bad gateway address '%s' \"\n                         \"in route definition\"),\n                       errorDetail, gateway);\n        goto error;\n    }\n\n    /* validate network address, etc. for each family */\n    if ((def->family == NULL) || (STREQ(def->family, \"ipv4\"))) {\n        if (!(VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET) ||\n              VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_UNSPEC))) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 address '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           def->family == NULL ?\n                           _(\"%s: No family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\") :\n                           _(\"%s: IPv4 family specified for non-IPv4 gateway '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            if (virSocketAddrParse(&def->netmask, netmask, AF_UNSPEC) < 0) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Bad netmask address '%s' \"\n                                 \"in route definition\"),\n                               errorDetail, netmask);\n                goto error;\n            }\n            if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->netmask, AF_INET)) {\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Invalid netmask '%s' \"\n                                 \"for address '%s' (both must be IPv4)\"),\n                               errorDetail, netmask, address);\n                goto error;\n            }\n            if (def->has_prefix) {\n                /* can't have both netmask and prefix at the same time */\n                virReportError(VIR_ERR_XML_ERROR,\n                               _(\"%s: Route definition cannot have both \"\n                                 \"a prefix and a netmask\"),\n                               errorDetail);\n                goto error;\n            }\n        }\n        if (def->prefix > 32) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 32\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else if (STREQ(def->family, \"ipv6\")) {\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->address, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 family specified for non-IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (netmask) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Specifying netmask invalid for IPv6 address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, address);\n            goto error;\n        }\n        if (!VIR_SOCKET_ADDR_IS_FAMILY(&def->gateway, AF_INET6)) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: ipv6 specified for non-IPv6 gateway address '%s' \"\n                             \"in route definition\"),\n                           errorDetail, gateway);\n            goto error;\n        }\n        if (def->prefix > 128) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"%s: Invalid prefix %u specified \"\n                             \"in route definition, \"\n                             \"must be 0 - 128\"),\n                           errorDetail, def->prefix);\n            goto error;\n        }\n    } else {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Unrecognized family '%s' \"\n                         \"in route definition\"),\n                       errorDetail, def->family);\n        goto error;\n    }\n\n    /* make sure the address is a network address */\n    if (netmask) {\n        if (virSocketAddrMask(&def->address, &def->netmask, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with netmask '%s' \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, netmask);\n            goto error;\n        }\n    } else {\n        if (virSocketAddrMaskByPrefix(&def->address,\n                                      def->prefix, &testAddr) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"%s: Error converting address '%s' with prefix %u \"\n                             \"to network-address \"\n                             \"in route definition\"),\n                           errorDetail, address, def->prefix);\n            goto error;\n        }\n    }\n    if (!virSocketAddrEqual(&def->address, &testAddr)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"%s: Address '%s' in route definition \"\n                         \"is not a network address\"),\n                       errorDetail, address);\n        goto error;\n    }\n\n    return def;\n\n error:\n    virNetDevIPRouteFree(def);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Domain interface\""
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "family == AF_INET ? \"ipv4\" : \"ipv6\""
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcAddNetworkRouteDefinition(const char *address,\n                             int family,\n                             virNetDevIPRoutePtr **routes,\n                             size_t *nroutes)\n{\n    virNetDevIPRoutePtr route = NULL;\n    char *familyStr = NULL;\n    char *zero = NULL;\n\n    zero = g_strdup(family == AF_INET ? VIR_SOCKET_ADDR_IPV4_ALL : VIR_SOCKET_ADDR_IPV6_ALL);\n\n    familyStr = g_strdup(family == AF_INET ? \"ipv4\" : \"ipv6\");\n\n    if (!(route = virNetDevIPRouteCreate(_(\"Domain interface\"), familyStr,\n                                         zero, NULL, address, 0, false,\n                                         0, false)))\n        goto error;\n\n    if (VIR_APPEND_ELEMENT(*routes, *nroutes, route) < 0)\n        goto error;\n\n    VIR_FREE(familyStr);\n    VIR_FREE(zero);\n\n    return 0;\n\n error:\n    VIR_FREE(familyStr);\n    VIR_FREE(zero);\n    virNetDevIPRouteFree(route);\n    return -1;\n}"
  },
  {
    "function_name": "lxcCreateHostdevDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "400-415",
    "snippet": "static virDomainHostdevDefPtr\nlxcCreateHostdevDef(int mode, int type, const char *data)\n{\n    virDomainHostdevDefPtr hostdev = virDomainHostdevDefNew();\n\n    if (!hostdev)\n        return NULL;\n\n    hostdev->mode = mode;\n    hostdev->source.caps.type = type;\n\n    if (type == VIR_DOMAIN_HOSTDEV_CAPS_TYPE_NET)\n        hostdev->source.caps.u.net.ifname = g_strdup(data);\n\n    return hostdev;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "data"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHostdevDefNew",
          "args": [],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevDefNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2889-2906",
          "snippet": "virDomainHostdevDefPtr\nvirDomainHostdevDefNew(void)\n{\n    virDomainHostdevDefPtr def;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    if (VIR_ALLOC(def->info) < 0)\n        goto error;\n\n    return def;\n\n error:\n    VIR_FREE(def->info);\n    VIR_FREE(def);\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainHostdevDefPtr\nvirDomainHostdevDefNew(void)\n{\n    virDomainHostdevDefPtr def;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    if (VIR_ALLOC(def->info) < 0)\n        goto error;\n\n    return def;\n\n error:\n    VIR_FREE(def->info);\n    VIR_FREE(def);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virDomainHostdevDefPtr\nlxcCreateHostdevDef(int mode, int type, const char *data)\n{\n    virDomainHostdevDefPtr hostdev = virDomainHostdevDefNew();\n\n    if (!hostdev)\n        return NULL;\n\n    hostdev->mode = mode;\n    hostdev->source.caps.type = type;\n\n    if (type == VIR_DOMAIN_HOSTDEV_CAPS_TYPE_NET)\n        hostdev->source.caps.u.net.ifname = g_strdup(data);\n\n    return hostdev;\n}"
  },
  {
    "function_name": "lxcCreateNetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "344-398",
    "snippet": "static virDomainNetDefPtr\nlxcCreateNetDef(const char *type,\n                const char *linkdev,\n                const char *mac,\n                const char *flag,\n                const char *macvlanmode,\n                const char *name)\n{\n    virDomainNetDefPtr net = NULL;\n    virMacAddr macAddr;\n\n    if (!(net = virDomainNetDefNew(NULL)))\n        goto error;\n\n    if (STREQ_NULLABLE(flag, \"up\"))\n        net->linkstate = VIR_DOMAIN_NET_INTERFACE_LINK_STATE_UP;\n    else\n        net->linkstate = VIR_DOMAIN_NET_INTERFACE_LINK_STATE_DOWN;\n\n    net->ifname_guest = g_strdup(name);\n\n    if (mac && virMacAddrParse(mac, &macAddr) == 0)\n        net->mac = macAddr;\n\n    if (STREQ(type, \"veth\")) {\n        if (linkdev) {\n            net->type = VIR_DOMAIN_NET_TYPE_BRIDGE;\n            net->data.bridge.brname = g_strdup(linkdev);\n        } else {\n            net->type = VIR_DOMAIN_NET_TYPE_ETHERNET;\n        }\n    } else if (STREQ(type, \"macvlan\")) {\n        net->type = VIR_DOMAIN_NET_TYPE_DIRECT;\n\n        if (!linkdev)\n            goto error;\n\n        net->data.direct.linkdev = g_strdup(linkdev);\n\n        if (!macvlanmode || STREQ(macvlanmode, \"private\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_PRIVATE;\n        else if (STREQ(macvlanmode, \"vepa\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_VEPA;\n        else if (STREQ(macvlanmode, \"bridge\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_BRIDGE;\n        else\n            VIR_WARN(\"Unknown macvlan type: %s\", macvlanmode);\n    }\n\n    return net;\n\n error:\n    virDomainNetDefFree(net);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainNetDefFree",
          "args": [
            "net"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2481-2489",
          "snippet": "void\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unknown macvlan type: %s\"",
            "macvlanmode"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "macvlanmode",
            "\"bridge\""
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "macvlanmode",
            "\"vepa\""
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "macvlanmode",
            "\"private\""
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "linkdev"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"macvlan\""
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "\"veth\""
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrParse",
          "args": [
            "mac",
            "&macAddr"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrParseHex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "205-218",
          "snippet": "int\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "flag",
            "\"up\""
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainNetDefNew",
          "args": [
            "NULL"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetDefNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "14783-14798",
          "snippet": "virDomainNetDefPtr\nvirDomainNetDefNew(virDomainXMLOptionPtr xmlopt)\n{\n    virDomainNetDefPtr def = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    if (xmlopt && xmlopt->privateData.networkNew &&\n        !(def->privateData = xmlopt->privateData.networkNew())) {\n        virDomainNetDefFree(def);\n        def = NULL;\n    }\n\n    return def;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainNetDefPtr\nvirDomainNetDefNew(virDomainXMLOptionPtr xmlopt)\n{\n    virDomainNetDefPtr def = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    if (xmlopt && xmlopt->privateData.networkNew &&\n        !(def->privateData = xmlopt->privateData.networkNew())) {\n        virDomainNetDefFree(def);\n        def = NULL;\n    }\n\n    return def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virDomainNetDefPtr\nlxcCreateNetDef(const char *type,\n                const char *linkdev,\n                const char *mac,\n                const char *flag,\n                const char *macvlanmode,\n                const char *name)\n{\n    virDomainNetDefPtr net = NULL;\n    virMacAddr macAddr;\n\n    if (!(net = virDomainNetDefNew(NULL)))\n        goto error;\n\n    if (STREQ_NULLABLE(flag, \"up\"))\n        net->linkstate = VIR_DOMAIN_NET_INTERFACE_LINK_STATE_UP;\n    else\n        net->linkstate = VIR_DOMAIN_NET_INTERFACE_LINK_STATE_DOWN;\n\n    net->ifname_guest = g_strdup(name);\n\n    if (mac && virMacAddrParse(mac, &macAddr) == 0)\n        net->mac = macAddr;\n\n    if (STREQ(type, \"veth\")) {\n        if (linkdev) {\n            net->type = VIR_DOMAIN_NET_TYPE_BRIDGE;\n            net->data.bridge.brname = g_strdup(linkdev);\n        } else {\n            net->type = VIR_DOMAIN_NET_TYPE_ETHERNET;\n        }\n    } else if (STREQ(type, \"macvlan\")) {\n        net->type = VIR_DOMAIN_NET_TYPE_DIRECT;\n\n        if (!linkdev)\n            goto error;\n\n        net->data.direct.linkdev = g_strdup(linkdev);\n\n        if (!macvlanmode || STREQ(macvlanmode, \"private\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_PRIVATE;\n        else if (STREQ(macvlanmode, \"vepa\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_VEPA;\n        else if (STREQ(macvlanmode, \"bridge\"))\n            net->data.direct.mode = VIR_NETDEV_MACVLAN_MODE_BRIDGE;\n        else\n            VIR_WARN(\"Unknown macvlan type: %s\", macvlanmode);\n    }\n\n    return net;\n\n error:\n    virDomainNetDefFree(net);\n    return NULL;\n}"
  },
  {
    "function_name": "lxcFstabWalkCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "321-342",
    "snippet": "static int\nlxcFstabWalkCallback(const char* name, virConfValuePtr value, void * data)\n{\n    int ret = 0;\n    lxcFstabPtr fstabLine;\n    virDomainDefPtr def = data;\n\n    /* We only care about lxc.mount.entry lines */\n    if (STRNEQ(name, \"lxc.mount.entry\"))\n        return 0;\n\n    fstabLine = lxcParseFstabLine(value->str);\n\n    if (!fstabLine)\n        return -1;\n\n    if (lxcAddFstabLine(def, fstabLine) < 0)\n        ret = -1;\n\n    lxcFstabFree(fstabLine);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcFstabFree",
          "args": [
            "fstabLine"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "lxcFstabFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "89-104",
          "snippet": "static void\nlxcFstabFree(lxcFstabPtr fstab)\n{\n    while (fstab) {\n        lxcFstabPtr next = NULL;\n        next = fstab->next;\n\n        VIR_FREE(fstab->src);\n        VIR_FREE(fstab->dst);\n        VIR_FREE(fstab->type);\n        VIR_FREE(fstab->options);\n        VIR_FREE(fstab);\n\n        fstab = next;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nlxcFstabFree(lxcFstabPtr fstab)\n{\n    while (fstab) {\n        lxcFstabPtr next = NULL;\n        next = fstab->next;\n\n        VIR_FREE(fstab->src);\n        VIR_FREE(fstab->dst);\n        VIR_FREE(fstab->type);\n        VIR_FREE(fstab->options);\n        VIR_FREE(fstab);\n\n        fstab = next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcAddFstabLine",
          "args": [
            "def",
            "fstabLine"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "lxcAddFstabLine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "256-319",
          "snippet": "static int\nlxcAddFstabLine(virDomainDefPtr def, lxcFstabPtr fstab)\n{\n    const char *src = NULL;\n    char *dst = NULL;\n    char **options = virStringSplit(fstab->options, \",\", 0);\n    bool readonly;\n    int type = VIR_DOMAIN_FS_TYPE_MOUNT;\n    unsigned long long usage = 0;\n    int ret = -1;\n\n    if (!options)\n        return -1;\n\n    if (fstab->dst[0] != '/') {\n        dst = g_strdup_printf(\"/%s\", fstab->dst);\n    } else {\n        dst = g_strdup(fstab->dst);\n    }\n\n    /* Check that we don't add basic mounts */\n    if (lxcIsBasicMountLocation(dst)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (STREQ(fstab->type, \"tmpfs\")) {\n        char *sizeStr = NULL;\n        size_t i;\n        type = VIR_DOMAIN_FS_TYPE_RAM;\n\n        for (i = 0; options[i]; i++) {\n            if ((sizeStr = STRSKIP(options[i], \"size=\"))) {\n                if (lxcConvertSize(sizeStr, &usage) < 0)\n                    goto cleanup;\n                break;\n            }\n        }\n        if (!sizeStr) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"missing tmpfs size, set the size option\"));\n            goto cleanup;\n        }\n    } else {\n        src = fstab->src;\n    }\n\n    /* Is it a block device that needs special favor? */\n    if (STRPREFIX(fstab->src, \"/dev/\"))\n        type = VIR_DOMAIN_FS_TYPE_BLOCK;\n\n    /* Do we have ro in options? */\n    readonly = virStringListHasString((const char **)options, \"ro\");\n\n    if (lxcAddFSDef(def, type, src, dst, readonly, usage) < 0)\n        goto cleanup;\n\n    ret = 1;\n\n cleanup:\n    VIR_FREE(dst);\n    virStringListFree(options);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcAddFstabLine(virDomainDefPtr def, lxcFstabPtr fstab)\n{\n    const char *src = NULL;\n    char *dst = NULL;\n    char **options = virStringSplit(fstab->options, \",\", 0);\n    bool readonly;\n    int type = VIR_DOMAIN_FS_TYPE_MOUNT;\n    unsigned long long usage = 0;\n    int ret = -1;\n\n    if (!options)\n        return -1;\n\n    if (fstab->dst[0] != '/') {\n        dst = g_strdup_printf(\"/%s\", fstab->dst);\n    } else {\n        dst = g_strdup(fstab->dst);\n    }\n\n    /* Check that we don't add basic mounts */\n    if (lxcIsBasicMountLocation(dst)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (STREQ(fstab->type, \"tmpfs\")) {\n        char *sizeStr = NULL;\n        size_t i;\n        type = VIR_DOMAIN_FS_TYPE_RAM;\n\n        for (i = 0; options[i]; i++) {\n            if ((sizeStr = STRSKIP(options[i], \"size=\"))) {\n                if (lxcConvertSize(sizeStr, &usage) < 0)\n                    goto cleanup;\n                break;\n            }\n        }\n        if (!sizeStr) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"missing tmpfs size, set the size option\"));\n            goto cleanup;\n        }\n    } else {\n        src = fstab->src;\n    }\n\n    /* Is it a block device that needs special favor? */\n    if (STRPREFIX(fstab->src, \"/dev/\"))\n        type = VIR_DOMAIN_FS_TYPE_BLOCK;\n\n    /* Do we have ro in options? */\n    readonly = virStringListHasString((const char **)options, \"ro\");\n\n    if (lxcAddFSDef(def, type, src, dst, readonly, usage) < 0)\n        goto cleanup;\n\n    ret = 1;\n\n cleanup:\n    VIR_FREE(dst);\n    virStringListFree(options);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcParseFstabLine",
          "args": [
            "value->str"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "lxcParseFstabLine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "150-178",
          "snippet": "static lxcFstabPtr\nlxcParseFstabLine(char *fstabLine)\n{\n    lxcFstabPtr fstab = NULL;\n    char **parts;\n\n    if (!fstabLine || VIR_ALLOC(fstab) < 0)\n        return NULL;\n\n    if (!(parts = lxcStringSplit(fstabLine)))\n        goto error;\n\n    if (!parts[0] || !parts[1] || !parts[2] || !parts[3])\n        goto error;\n\n    fstab->src = g_strdup(parts[0]);\n    fstab->dst = g_strdup(parts[1]);\n    fstab->type = g_strdup(parts[2]);\n    fstab->options = g_strdup(parts[3]);\n\n    virStringListFree(parts);\n\n    return fstab;\n\n error:\n    lxcFstabFree(fstab);\n    virStringListFree(parts);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic lxcFstabPtr\nlxcParseFstabLine(char *fstabLine)\n{\n    lxcFstabPtr fstab = NULL;\n    char **parts;\n\n    if (!fstabLine || VIR_ALLOC(fstab) < 0)\n        return NULL;\n\n    if (!(parts = lxcStringSplit(fstabLine)))\n        goto error;\n\n    if (!parts[0] || !parts[1] || !parts[2] || !parts[3])\n        goto error;\n\n    fstab->src = g_strdup(parts[0]);\n    fstab->dst = g_strdup(parts[1]);\n    fstab->type = g_strdup(parts[2]);\n    fstab->options = g_strdup(parts[3]);\n\n    virStringListFree(parts);\n\n    return fstab;\n\n error:\n    lxcFstabFree(fstab);\n    virStringListFree(parts);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "name",
            "\"lxc.mount.entry\""
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcFstabWalkCallback(const char* name, virConfValuePtr value, void * data)\n{\n    int ret = 0;\n    lxcFstabPtr fstabLine;\n    virDomainDefPtr def = data;\n\n    /* We only care about lxc.mount.entry lines */\n    if (STRNEQ(name, \"lxc.mount.entry\"))\n        return 0;\n\n    fstabLine = lxcParseFstabLine(value->str);\n\n    if (!fstabLine)\n        return -1;\n\n    if (lxcAddFstabLine(def, fstabLine) < 0)\n        ret = -1;\n\n    lxcFstabFree(fstabLine);\n    return ret;\n}"
  },
  {
    "function_name": "lxcAddFstabLine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "256-319",
    "snippet": "static int\nlxcAddFstabLine(virDomainDefPtr def, lxcFstabPtr fstab)\n{\n    const char *src = NULL;\n    char *dst = NULL;\n    char **options = virStringSplit(fstab->options, \",\", 0);\n    bool readonly;\n    int type = VIR_DOMAIN_FS_TYPE_MOUNT;\n    unsigned long long usage = 0;\n    int ret = -1;\n\n    if (!options)\n        return -1;\n\n    if (fstab->dst[0] != '/') {\n        dst = g_strdup_printf(\"/%s\", fstab->dst);\n    } else {\n        dst = g_strdup(fstab->dst);\n    }\n\n    /* Check that we don't add basic mounts */\n    if (lxcIsBasicMountLocation(dst)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (STREQ(fstab->type, \"tmpfs\")) {\n        char *sizeStr = NULL;\n        size_t i;\n        type = VIR_DOMAIN_FS_TYPE_RAM;\n\n        for (i = 0; options[i]; i++) {\n            if ((sizeStr = STRSKIP(options[i], \"size=\"))) {\n                if (lxcConvertSize(sizeStr, &usage) < 0)\n                    goto cleanup;\n                break;\n            }\n        }\n        if (!sizeStr) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"missing tmpfs size, set the size option\"));\n            goto cleanup;\n        }\n    } else {\n        src = fstab->src;\n    }\n\n    /* Is it a block device that needs special favor? */\n    if (STRPREFIX(fstab->src, \"/dev/\"))\n        type = VIR_DOMAIN_FS_TYPE_BLOCK;\n\n    /* Do we have ro in options? */\n    readonly = virStringListHasString((const char **)options, \"ro\");\n\n    if (lxcAddFSDef(def, type, src, dst, readonly, usage) < 0)\n        goto cleanup;\n\n    ret = 1;\n\n cleanup:\n    VIR_FREE(dst);\n    virStringListFree(options);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "options"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dst"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcAddFSDef",
          "args": [
            "def",
            "type",
            "src",
            "dst",
            "readonly",
            "usage"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "lxcAddFSDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "180-202",
          "snippet": "static int\nlxcAddFSDef(virDomainDefPtr def,\n            int type,\n            const char *src,\n            const char *dst,\n            bool readonly,\n            unsigned long long usage)\n{\n    virDomainFSDefPtr fsDef = NULL;\n\n    if (!(fsDef = lxcCreateFSDef(type, src, dst, readonly, usage)))\n        goto error;\n\n    if (VIR_EXPAND_N(def->fss, def->nfss, 1) < 0)\n        goto error;\n    def->fss[def->nfss - 1] = fsDef;\n\n    return 0;\n\n error:\n    virDomainFSDefFree(fsDef);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcAddFSDef(virDomainDefPtr def,\n            int type,\n            const char *src,\n            const char *dst,\n            bool readonly,\n            unsigned long long usage)\n{\n    virDomainFSDefPtr fsDef = NULL;\n\n    if (!(fsDef = lxcCreateFSDef(type, src, dst, readonly, usage)))\n        goto error;\n\n    if (VIR_EXPAND_N(def->fss, def->nfss, 1) < 0)\n        goto error;\n    def->fss[def->nfss - 1] = fsDef;\n\n    return 0;\n\n error:\n    virDomainFSDefFree(fsDef);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringListHasString",
          "args": [
            "(const char **)options",
            "\"ro\""
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListHasString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "350-365",
          "snippet": "bool\nvirStringListHasString(const char **strings,\n                       const char *needle)\n{\n    size_t i = 0;\n\n    if (!strings)\n        return false;\n\n    while (strings[i]) {\n        if (STREQ(strings[i++], needle))\n            return true;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringListHasString(const char **strings,\n                       const char *needle)\n{\n    size_t i = 0;\n\n    if (!strings)\n        return false;\n\n    while (strings[i]) {\n        if (STREQ(strings[i++], needle))\n            return true;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "fstab->src",
            "\"/dev/\""
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing tmpfs size, set the size option\")"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"missing tmpfs size, set the size option\""
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcConvertSize",
          "args": [
            "sizeStr",
            "&usage"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "lxcConvertSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "228-254",
          "snippet": "static int\nlxcConvertSize(const char *size, unsigned long long *value)\n{\n    char *unit = NULL;\n\n    /* Split the string into value and unit */\n    if (virStrToLong_ull(size, &unit, 10, value) < 0)\n        goto error;\n\n    if (STREQ(unit, \"%\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't convert relative size: '%s'\"),\n                       size);\n        return -1;\n    } else {\n        if (virScaleInteger(value, unit, 1, ULLONG_MAX) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"failed to convert size: '%s'\"),\n                   size);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcConvertSize(const char *size, unsigned long long *value)\n{\n    char *unit = NULL;\n\n    /* Split the string into value and unit */\n    if (virStrToLong_ull(size, &unit, 10, value) < 0)\n        goto error;\n\n    if (STREQ(unit, \"%\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't convert relative size: '%s'\"),\n                       size);\n        return -1;\n    } else {\n        if (virScaleInteger(value, unit, 1, ULLONG_MAX) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"failed to convert size: '%s'\"),\n                   size);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRSKIP",
          "args": [
            "options[i]",
            "\"size=\""
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "fstab->type",
            "\"tmpfs\""
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcIsBasicMountLocation",
          "args": [
            "dst"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "lxcIsBasicMountLocation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "808-818",
          "snippet": "bool lxcIsBasicMountLocation(const char *path)\n{\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(lxcBasicMounts); i++) {\n        if (STREQ(path, lxcBasicMounts[i].dst))\n            return true;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const virLXCBasicMountInfo lxcBasicMounts[] = {\n    { \"proc\", \"/proc\", \"proc\", MS_NOSUID|MS_NOEXEC|MS_NODEV, false, false, false },\n    { \"/proc/sys\", \"/proc/sys\", \"none\", MS_BIND|MS_NOSUID|MS_NOEXEC|MS_NODEV|MS_RDONLY, false, false, false },\n    { \"/.oldroot/proc/sys/net/ipv4\", \"/proc/sys/net/ipv4\", \"none\", MS_BIND, false, false, true },\n    { \"/.oldroot/proc/sys/net/ipv6\", \"/proc/sys/net/ipv6\", \"none\", MS_BIND, false, false, true },\n    { \"sysfs\", \"/sys\", \"sysfs\", MS_NOSUID|MS_NOEXEC|MS_NODEV|MS_RDONLY, false, false, false },\n    { \"securityfs\", \"/sys/kernel/security\", \"securityfs\", MS_NOSUID|MS_NOEXEC|MS_NODEV|MS_RDONLY, true, true, false },\n#if WITH_SELINUX\n    { SELINUX_MOUNT, SELINUX_MOUNT, \"selinuxfs\", MS_NOSUID|MS_NOEXEC|MS_NODEV|MS_RDONLY, true, true, false },\n#endif\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic const virLXCBasicMountInfo lxcBasicMounts[] = {\n    { \"proc\", \"/proc\", \"proc\", MS_NOSUID|MS_NOEXEC|MS_NODEV, false, false, false },\n    { \"/proc/sys\", \"/proc/sys\", \"none\", MS_BIND|MS_NOSUID|MS_NOEXEC|MS_NODEV|MS_RDONLY, false, false, false },\n    { \"/.oldroot/proc/sys/net/ipv4\", \"/proc/sys/net/ipv4\", \"none\", MS_BIND, false, false, true },\n    { \"/.oldroot/proc/sys/net/ipv6\", \"/proc/sys/net/ipv6\", \"none\", MS_BIND, false, false, true },\n    { \"sysfs\", \"/sys\", \"sysfs\", MS_NOSUID|MS_NOEXEC|MS_NODEV|MS_RDONLY, false, false, false },\n    { \"securityfs\", \"/sys/kernel/security\", \"securityfs\", MS_NOSUID|MS_NOEXEC|MS_NODEV|MS_RDONLY, true, true, false },\n#if WITH_SELINUX\n    { SELINUX_MOUNT, SELINUX_MOUNT, \"selinuxfs\", MS_NOSUID|MS_NOEXEC|MS_NODEV|MS_RDONLY, true, true, false },\n#endif\n};\n\nbool lxcIsBasicMountLocation(const char *path)\n{\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(lxcBasicMounts); i++) {\n        if (STREQ(path, lxcBasicMounts[i].dst))\n            return true;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "fstab->dst"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "fstab->options",
            "\",\"",
            "0"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcAddFstabLine(virDomainDefPtr def, lxcFstabPtr fstab)\n{\n    const char *src = NULL;\n    char *dst = NULL;\n    char **options = virStringSplit(fstab->options, \",\", 0);\n    bool readonly;\n    int type = VIR_DOMAIN_FS_TYPE_MOUNT;\n    unsigned long long usage = 0;\n    int ret = -1;\n\n    if (!options)\n        return -1;\n\n    if (fstab->dst[0] != '/') {\n        dst = g_strdup_printf(\"/%s\", fstab->dst);\n    } else {\n        dst = g_strdup(fstab->dst);\n    }\n\n    /* Check that we don't add basic mounts */\n    if (lxcIsBasicMountLocation(dst)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (STREQ(fstab->type, \"tmpfs\")) {\n        char *sizeStr = NULL;\n        size_t i;\n        type = VIR_DOMAIN_FS_TYPE_RAM;\n\n        for (i = 0; options[i]; i++) {\n            if ((sizeStr = STRSKIP(options[i], \"size=\"))) {\n                if (lxcConvertSize(sizeStr, &usage) < 0)\n                    goto cleanup;\n                break;\n            }\n        }\n        if (!sizeStr) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"missing tmpfs size, set the size option\"));\n            goto cleanup;\n        }\n    } else {\n        src = fstab->src;\n    }\n\n    /* Is it a block device that needs special favor? */\n    if (STRPREFIX(fstab->src, \"/dev/\"))\n        type = VIR_DOMAIN_FS_TYPE_BLOCK;\n\n    /* Do we have ro in options? */\n    readonly = virStringListHasString((const char **)options, \"ro\");\n\n    if (lxcAddFSDef(def, type, src, dst, readonly, usage) < 0)\n        goto cleanup;\n\n    ret = 1;\n\n cleanup:\n    VIR_FREE(dst);\n    virStringListFree(options);\n    return ret;\n}"
  },
  {
    "function_name": "lxcConvertSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "228-254",
    "snippet": "static int\nlxcConvertSize(const char *size, unsigned long long *value)\n{\n    char *unit = NULL;\n\n    /* Split the string into value and unit */\n    if (virStrToLong_ull(size, &unit, 10, value) < 0)\n        goto error;\n\n    if (STREQ(unit, \"%\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't convert relative size: '%s'\"),\n                       size);\n        return -1;\n    } else {\n        if (virScaleInteger(value, unit, 1, ULLONG_MAX) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"failed to convert size: '%s'\"),\n                   size);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to convert size: '%s'\")",
            "size"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to convert size: '%s'\""
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virScaleInteger",
          "args": [
            "value",
            "unit",
            "1",
            "ULLONG_MAX"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "virScaleInteger",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "175-235",
          "snippet": "int\nvirScaleInteger(unsigned long long *value, const char *suffix,\n                unsigned long long scale, unsigned long long limit)\n{\n    if (!suffix || !*suffix) {\n        if (!scale) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid scale %llu\"), scale);\n            return -1;\n        }\n        suffix = \"\";\n    } else if (STRCASEEQ(suffix, \"b\") || STRCASEEQ(suffix, \"byte\") ||\n               STRCASEEQ(suffix, \"bytes\")) {\n        scale = 1;\n    } else {\n        int base;\n\n        if (!suffix[1] || STRCASEEQ(suffix + 1, \"iB\")) {\n            base = 1024;\n        } else if (g_ascii_tolower(suffix[1]) == 'b' && !suffix[2]) {\n            base = 1000;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n        scale = 1;\n        switch (g_ascii_tolower(*suffix)) {\n        case 'e':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'p':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 't':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'g':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'm':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'k':\n            scale *= base;\n            break;\n        default:\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n    }\n\n    if (*value && *value > (limit / scale)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"value too large: %llu%s\"),\n                       *value, suffix);\n        return -1;\n    }\n    *value *= scale;\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirScaleInteger(unsigned long long *value, const char *suffix,\n                unsigned long long scale, unsigned long long limit)\n{\n    if (!suffix || !*suffix) {\n        if (!scale) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid scale %llu\"), scale);\n            return -1;\n        }\n        suffix = \"\";\n    } else if (STRCASEEQ(suffix, \"b\") || STRCASEEQ(suffix, \"byte\") ||\n               STRCASEEQ(suffix, \"bytes\")) {\n        scale = 1;\n    } else {\n        int base;\n\n        if (!suffix[1] || STRCASEEQ(suffix + 1, \"iB\")) {\n            base = 1024;\n        } else if (g_ascii_tolower(suffix[1]) == 'b' && !suffix[2]) {\n            base = 1000;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n        scale = 1;\n        switch (g_ascii_tolower(*suffix)) {\n        case 'e':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'p':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 't':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'g':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'm':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'k':\n            scale *= base;\n            break;\n        default:\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n    }\n\n    if (*value && *value > (limit / scale)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"value too large: %llu%s\"),\n                       *value, suffix);\n        return -1;\n    }\n    *value *= scale;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"can't convert relative size: '%s'\")",
            "size"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "unit",
            "\"%\""
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "size",
            "&unit",
            "10",
            "value"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcConvertSize(const char *size, unsigned long long *value)\n{\n    char *unit = NULL;\n\n    /* Split the string into value and unit */\n    if (virStrToLong_ull(size, &unit, 10, value) < 0)\n        goto error;\n\n    if (STREQ(unit, \"%\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't convert relative size: '%s'\"),\n                       size);\n        return -1;\n    } else {\n        if (virScaleInteger(value, unit, 1, ULLONG_MAX) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"failed to convert size: '%s'\"),\n                   size);\n    return -1;\n}"
  },
  {
    "function_name": "lxcSetRootfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "204-226",
    "snippet": "static int\nlxcSetRootfs(virDomainDefPtr def,\n             virConfPtr properties)\n{\n    int type = VIR_DOMAIN_FS_TYPE_MOUNT;\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.rootfs.path\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.rootfs\", &value) <= 0)\n            return -1;\n    }\n\n    if (STRPREFIX(value, \"/dev/\"))\n        type = VIR_DOMAIN_FS_TYPE_BLOCK;\n\n    if (lxcAddFSDef(def, type, value, \"/\", false, 0) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcAddFSDef",
          "args": [
            "def",
            "type",
            "value",
            "\"/\"",
            "false",
            "0"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "lxcAddFSDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "180-202",
          "snippet": "static int\nlxcAddFSDef(virDomainDefPtr def,\n            int type,\n            const char *src,\n            const char *dst,\n            bool readonly,\n            unsigned long long usage)\n{\n    virDomainFSDefPtr fsDef = NULL;\n\n    if (!(fsDef = lxcCreateFSDef(type, src, dst, readonly, usage)))\n        goto error;\n\n    if (VIR_EXPAND_N(def->fss, def->nfss, 1) < 0)\n        goto error;\n    def->fss[def->nfss - 1] = fsDef;\n\n    return 0;\n\n error:\n    virDomainFSDefFree(fsDef);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcAddFSDef(virDomainDefPtr def,\n            int type,\n            const char *src,\n            const char *dst,\n            bool readonly,\n            unsigned long long usage)\n{\n    virDomainFSDefPtr fsDef = NULL;\n\n    if (!(fsDef = lxcCreateFSDef(type, src, dst, readonly, usage)))\n        goto error;\n\n    if (VIR_EXPAND_N(def->fss, def->nfss, 1) < 0)\n        goto error;\n    def->fss[def->nfss - 1] = fsDef;\n\n    return 0;\n\n error:\n    virDomainFSDefFree(fsDef);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "value",
            "\"/dev/\""
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "properties",
            "\"lxc.rootfs\"",
            "&value"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcSetRootfs(virDomainDefPtr def,\n             virConfPtr properties)\n{\n    int type = VIR_DOMAIN_FS_TYPE_MOUNT;\n    g_autofree char *value = NULL;\n\n    if (virConfGetValueString(properties, \"lxc.rootfs.path\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.rootfs\", &value) <= 0)\n            return -1;\n    }\n\n    if (STRPREFIX(value, \"/dev/\"))\n        type = VIR_DOMAIN_FS_TYPE_BLOCK;\n\n    if (lxcAddFSDef(def, type, value, \"/\", false, 0) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcAddFSDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "180-202",
    "snippet": "static int\nlxcAddFSDef(virDomainDefPtr def,\n            int type,\n            const char *src,\n            const char *dst,\n            bool readonly,\n            unsigned long long usage)\n{\n    virDomainFSDefPtr fsDef = NULL;\n\n    if (!(fsDef = lxcCreateFSDef(type, src, dst, readonly, usage)))\n        goto error;\n\n    if (VIR_EXPAND_N(def->fss, def->nfss, 1) < 0)\n        goto error;\n    def->fss[def->nfss - 1] = fsDef;\n\n    return 0;\n\n error:\n    virDomainFSDefFree(fsDef);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainFSDefFree",
          "args": [
            "fsDef"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainFSDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2328-2341",
          "snippet": "void virDomainFSDefFree(virDomainFSDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->dst);\n    virDomainDeviceInfoClear(&def->info);\n    VIR_FREE(def->virtio);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def->binary);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainFSDefFree(virDomainFSDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->dst);\n    virDomainDeviceInfoClear(&def->info);\n    VIR_FREE(def->virtio);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def->binary);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "def->fss",
            "def->nfss",
            "1"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcCreateFSDef",
          "args": [
            "type",
            "src",
            "dst",
            "readonly",
            "usage"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "lxcCreateFSDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "56-77",
          "snippet": "static virDomainFSDefPtr\nlxcCreateFSDef(int type,\n               const char *src,\n               const char* dst,\n               bool readonly,\n               unsigned long long usage)\n{\n    virDomainFSDefPtr def;\n\n    if (!(def = virDomainFSDefNew(NULL)))\n        return NULL;\n\n    def->type = type;\n    def->accessmode = VIR_DOMAIN_FS_ACCESSMODE_PASSTHROUGH;\n    if (src)\n        def->src->path = g_strdup(src);\n    def->dst = g_strdup(dst);\n    def->readonly = readonly;\n    def->usage = usage;\n\n    return def;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virDomainFSDefPtr\nlxcCreateFSDef(int type,\n               const char *src,\n               const char* dst,\n               bool readonly,\n               unsigned long long usage)\n{\n    virDomainFSDefPtr def;\n\n    if (!(def = virDomainFSDefNew(NULL)))\n        return NULL;\n\n    def->type = type;\n    def->accessmode = VIR_DOMAIN_FS_ACCESSMODE_PASSTHROUGH;\n    if (src)\n        def->src->path = g_strdup(src);\n    def->dst = g_strdup(dst);\n    def->readonly = readonly;\n    def->usage = usage;\n\n    return def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nlxcAddFSDef(virDomainDefPtr def,\n            int type,\n            const char *src,\n            const char *dst,\n            bool readonly,\n            unsigned long long usage)\n{\n    virDomainFSDefPtr fsDef = NULL;\n\n    if (!(fsDef = lxcCreateFSDef(type, src, dst, readonly, usage)))\n        goto error;\n\n    if (VIR_EXPAND_N(def->fss, def->nfss, 1) < 0)\n        goto error;\n    def->fss[def->nfss - 1] = fsDef;\n\n    return 0;\n\n error:\n    virDomainFSDefFree(fsDef);\n    return -1;\n}"
  },
  {
    "function_name": "lxcParseFstabLine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "150-178",
    "snippet": "static lxcFstabPtr\nlxcParseFstabLine(char *fstabLine)\n{\n    lxcFstabPtr fstab = NULL;\n    char **parts;\n\n    if (!fstabLine || VIR_ALLOC(fstab) < 0)\n        return NULL;\n\n    if (!(parts = lxcStringSplit(fstabLine)))\n        goto error;\n\n    if (!parts[0] || !parts[1] || !parts[2] || !parts[3])\n        goto error;\n\n    fstab->src = g_strdup(parts[0]);\n    fstab->dst = g_strdup(parts[1]);\n    fstab->type = g_strdup(parts[2]);\n    fstab->options = g_strdup(parts[3]);\n\n    virStringListFree(parts);\n\n    return fstab;\n\n error:\n    lxcFstabFree(fstab);\n    virStringListFree(parts);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "parts"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcFstabFree",
          "args": [
            "fstab"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "lxcFstabFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "89-104",
          "snippet": "static void\nlxcFstabFree(lxcFstabPtr fstab)\n{\n    while (fstab) {\n        lxcFstabPtr next = NULL;\n        next = fstab->next;\n\n        VIR_FREE(fstab->src);\n        VIR_FREE(fstab->dst);\n        VIR_FREE(fstab->type);\n        VIR_FREE(fstab->options);\n        VIR_FREE(fstab);\n\n        fstab = next;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nlxcFstabFree(lxcFstabPtr fstab)\n{\n    while (fstab) {\n        lxcFstabPtr next = NULL;\n        next = fstab->next;\n\n        VIR_FREE(fstab->src);\n        VIR_FREE(fstab->dst);\n        VIR_FREE(fstab->type);\n        VIR_FREE(fstab->options);\n        VIR_FREE(fstab);\n\n        fstab = next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "parts[3]"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcStringSplit",
          "args": [
            "fstabLine"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "lxcStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "106-148",
          "snippet": "static char ** lxcStringSplit(const char *string)\n{\n    char *tmp;\n    size_t i;\n    size_t ntokens = 0;\n    char **parts;\n    char **result = NULL;\n\n    tmp = g_strdup(string);\n\n    /* Replace potential \\t by a space */\n    for (i = 0; tmp[i]; i++) {\n        if (tmp[i] == '\\t')\n            tmp[i] = ' ';\n    }\n\n    if (!(parts = virStringSplit(tmp, \" \", 0)))\n        goto error;\n\n    /* Append NULL element */\n    if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n        goto error;\n\n    for (i = 0; parts[i]; i++) {\n        if (STREQ(parts[i], \"\"))\n            continue;\n\n        if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n            goto error;\n\n        result[ntokens - 2] = g_strdup(parts[i]);\n    }\n\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    return result;\n\n error:\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    virStringListFree(result);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char ** lxcStringSplit(const char *string)\n{\n    char *tmp;\n    size_t i;\n    size_t ntokens = 0;\n    char **parts;\n    char **result = NULL;\n\n    tmp = g_strdup(string);\n\n    /* Replace potential \\t by a space */\n    for (i = 0; tmp[i]; i++) {\n        if (tmp[i] == '\\t')\n            tmp[i] = ' ';\n    }\n\n    if (!(parts = virStringSplit(tmp, \" \", 0)))\n        goto error;\n\n    /* Append NULL element */\n    if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n        goto error;\n\n    for (i = 0; parts[i]; i++) {\n        if (STREQ(parts[i], \"\"))\n            continue;\n\n        if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n            goto error;\n\n        result[ntokens - 2] = g_strdup(parts[i]);\n    }\n\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    return result;\n\n error:\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    virStringListFree(result);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "fstab"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic lxcFstabPtr\nlxcParseFstabLine(char *fstabLine)\n{\n    lxcFstabPtr fstab = NULL;\n    char **parts;\n\n    if (!fstabLine || VIR_ALLOC(fstab) < 0)\n        return NULL;\n\n    if (!(parts = lxcStringSplit(fstabLine)))\n        goto error;\n\n    if (!parts[0] || !parts[1] || !parts[2] || !parts[3])\n        goto error;\n\n    fstab->src = g_strdup(parts[0]);\n    fstab->dst = g_strdup(parts[1]);\n    fstab->type = g_strdup(parts[2]);\n    fstab->options = g_strdup(parts[3]);\n\n    virStringListFree(parts);\n\n    return fstab;\n\n error:\n    lxcFstabFree(fstab);\n    virStringListFree(parts);\n    return NULL;\n}"
  },
  {
    "function_name": "lxcStringSplit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "106-148",
    "snippet": "static char ** lxcStringSplit(const char *string)\n{\n    char *tmp;\n    size_t i;\n    size_t ntokens = 0;\n    char **parts;\n    char **result = NULL;\n\n    tmp = g_strdup(string);\n\n    /* Replace potential \\t by a space */\n    for (i = 0; tmp[i]; i++) {\n        if (tmp[i] == '\\t')\n            tmp[i] = ' ';\n    }\n\n    if (!(parts = virStringSplit(tmp, \" \", 0)))\n        goto error;\n\n    /* Append NULL element */\n    if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n        goto error;\n\n    for (i = 0; parts[i]; i++) {\n        if (STREQ(parts[i], \"\"))\n            continue;\n\n        if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n            goto error;\n\n        result[ntokens - 2] = g_strdup(parts[i]);\n    }\n\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    return result;\n\n error:\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    virStringListFree(result);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "result"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "parts[i]"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "result",
            "ntokens",
            "1"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "parts[i]",
            "\"\""
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "result",
            "ntokens",
            "1"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "tmp",
            "\" \"",
            "0"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char ** lxcStringSplit(const char *string)\n{\n    char *tmp;\n    size_t i;\n    size_t ntokens = 0;\n    char **parts;\n    char **result = NULL;\n\n    tmp = g_strdup(string);\n\n    /* Replace potential \\t by a space */\n    for (i = 0; tmp[i]; i++) {\n        if (tmp[i] == '\\t')\n            tmp[i] = ' ';\n    }\n\n    if (!(parts = virStringSplit(tmp, \" \", 0)))\n        goto error;\n\n    /* Append NULL element */\n    if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n        goto error;\n\n    for (i = 0; parts[i]; i++) {\n        if (STREQ(parts[i], \"\"))\n            continue;\n\n        if (VIR_EXPAND_N(result, ntokens, 1) < 0)\n            goto error;\n\n        result[ntokens - 2] = g_strdup(parts[i]);\n    }\n\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    return result;\n\n error:\n    VIR_FREE(tmp);\n    virStringListFree(parts);\n    virStringListFree(result);\n    return NULL;\n}"
  },
  {
    "function_name": "lxcFstabFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "89-104",
    "snippet": "static void\nlxcFstabFree(lxcFstabPtr fstab)\n{\n    while (fstab) {\n        lxcFstabPtr next = NULL;\n        next = fstab->next;\n\n        VIR_FREE(fstab->src);\n        VIR_FREE(fstab->dst);\n        VIR_FREE(fstab->type);\n        VIR_FREE(fstab->options);\n        VIR_FREE(fstab);\n\n        fstab = next;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fstab"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fstab->options"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fstab->type"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fstab->dst"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fstab->src"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nlxcFstabFree(lxcFstabPtr fstab)\n{\n    while (fstab) {\n        lxcFstabPtr next = NULL;\n        next = fstab->next;\n\n        VIR_FREE(fstab->src);\n        VIR_FREE(fstab->dst);\n        VIR_FREE(fstab->type);\n        VIR_FREE(fstab->options);\n        VIR_FREE(fstab);\n\n        fstab = next;\n    }\n}"
  },
  {
    "function_name": "lxcCreateFSDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
    "lines": "56-77",
    "snippet": "static virDomainFSDefPtr\nlxcCreateFSDef(int type,\n               const char *src,\n               const char* dst,\n               bool readonly,\n               unsigned long long usage)\n{\n    virDomainFSDefPtr def;\n\n    if (!(def = virDomainFSDefNew(NULL)))\n        return NULL;\n\n    def->type = type;\n    def->accessmode = VIR_DOMAIN_FS_ACCESSMODE_PASSTHROUGH;\n    if (src)\n        def->src->path = g_strdup(src);\n    def->dst = g_strdup(dst);\n    def->readonly = readonly;\n    def->usage = usage;\n\n    return def;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"conf/domain_conf.h\"",
      "#include \"util/virconf.h\"",
      "#include \"util/virstring.h\"",
      "#include \"util/virlog.h\"",
      "#include \"util/virfile.h\"",
      "#include \"util/viralloc.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_container.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "dst"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainFSDefNew",
          "args": [
            "NULL"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainFSDefNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2304-2326",
          "snippet": "virDomainFSDefPtr\nvirDomainFSDefNew(virDomainXMLOptionPtr xmlopt)\n{\n    virDomainFSDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->src = virStorageSourceNew()))\n        goto cleanup;\n\n    if (xmlopt &&\n        xmlopt->privateData.fsNew &&\n        !(ret->privateData = xmlopt->privateData.fsNew()))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virDomainFSDefFree(ret);\n    return NULL;\n\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainFSDefPtr\nvirDomainFSDefNew(virDomainXMLOptionPtr xmlopt)\n{\n    virDomainFSDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->src = virStorageSourceNew()))\n        goto cleanup;\n\n    if (xmlopt &&\n        xmlopt->privateData.fsNew &&\n        !(ret->privateData = xmlopt->privateData.fsNew()))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virDomainFSDefFree(ret);\n    return NULL;\n\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virDomainFSDefPtr\nlxcCreateFSDef(int type,\n               const char *src,\n               const char* dst,\n               bool readonly,\n               unsigned long long usage)\n{\n    virDomainFSDefPtr def;\n\n    if (!(def = virDomainFSDefNew(NULL)))\n        return NULL;\n\n    def->type = type;\n    def->accessmode = VIR_DOMAIN_FS_ACCESSMODE_PASSTHROUGH;\n    if (src)\n        def->src->path = g_strdup(src);\n    def->dst = g_strdup(dst);\n    def->readonly = readonly;\n    def->usage = usage;\n\n    return def;\n}"
  }
]