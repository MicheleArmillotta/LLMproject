[
  {
    "function_name": "virNetDevMacVLanReserveName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1281-1287",
    "snippet": "int virNetDevMacVLanReserveName(const char *name G_GNUC_UNUSED,\n                                bool quietFail G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Cannot create macvlan devices on this platform\")"
          ],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot create macvlan devices on this platform\""
          ],
          "line": 1285
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanReserveName(const char *name G_GNUC_UNUSED,\n                                bool quietFail G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanReleaseName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1274-1279",
    "snippet": "int virNetDevMacVLanReleaseName(const char *name G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Cannot create macvlan devices on this platform\")"
          ],
          "line": 1276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot create macvlan devices on this platform\""
          ],
          "line": 1277
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanReleaseName(const char *name G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanVPortProfileRegisterCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1262-1272",
    "snippet": "int virNetDevMacVLanVPortProfileRegisterCallback(const char *ifname G_GNUC_UNUSED,\n                                                 const virMacAddr *macaddress G_GNUC_UNUSED,\n                                                 const char *linkdev G_GNUC_UNUSED,\n                                                 const unsigned char *vmuuid G_GNUC_UNUSED,\n                                                 const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                                 virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Cannot create macvlan devices on this platform\")"
          ],
          "line": 1269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot create macvlan devices on this platform\""
          ],
          "line": 1270
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanVPortProfileRegisterCallback(const char *ifname G_GNUC_UNUSED,\n                                                 const virMacAddr *macaddress G_GNUC_UNUSED,\n                                                 const char *linkdev G_GNUC_UNUSED,\n                                                 const unsigned char *vmuuid G_GNUC_UNUSED,\n                                                 const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                                 virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanRestartWithVPortProfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1250-1260",
    "snippet": "int virNetDevMacVLanRestartWithVPortProfile(const char *cr_ifname G_GNUC_UNUSED,\n                                            const virMacAddr *macaddress G_GNUC_UNUSED,\n                                            const char *linkdev G_GNUC_UNUSED,\n                                            const unsigned char *vmuuid G_GNUC_UNUSED,\n                                            const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                            virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Cannot create macvlan devices on this platform\")"
          ],
          "line": 1257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot create macvlan devices on this platform\""
          ],
          "line": 1258
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanRestartWithVPortProfile(const char *cr_ifname G_GNUC_UNUSED,\n                                            const virMacAddr *macaddress G_GNUC_UNUSED,\n                                            const char *linkdev G_GNUC_UNUSED,\n                                            const unsigned char *vmuuid G_GNUC_UNUSED,\n                                            const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                            virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanDeleteWithVPortProfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1238-1248",
    "snippet": "int virNetDevMacVLanDeleteWithVPortProfile(const char *ifname G_GNUC_UNUSED,\n                                           const virMacAddr *macaddress G_GNUC_UNUSED,\n                                           const char *linkdev G_GNUC_UNUSED,\n                                           int mode G_GNUC_UNUSED,\n                                           const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                           char *stateDir G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Cannot create macvlan devices on this platform\")"
          ],
          "line": 1245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot create macvlan devices on this platform\""
          ],
          "line": 1246
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanDeleteWithVPortProfile(const char *ifname G_GNUC_UNUSED,\n                                           const virMacAddr *macaddress G_GNUC_UNUSED,\n                                           const char *linkdev G_GNUC_UNUSED,\n                                           int mode G_GNUC_UNUSED,\n                                           const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                           char *stateDir G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanCreateWithVPortProfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1219-1236",
    "snippet": "int virNetDevMacVLanCreateWithVPortProfile(const char *ifname G_GNUC_UNUSED,\n                                           const virMacAddr *macaddress G_GNUC_UNUSED,\n                                           const char *linkdev G_GNUC_UNUSED,\n                                           virNetDevMacVLanMode mode G_GNUC_UNUSED,\n                                           const virNetDevVlan *vlan G_GNUC_UNUSED,\n                                           const unsigned char *vmuuid G_GNUC_UNUSED,\n                                           const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                           char **res_ifname G_GNUC_UNUSED,\n                                           virNetDevVPortProfileOp vmop G_GNUC_UNUSED,\n                                           char *stateDir G_GNUC_UNUSED,\n                                           int *tapfd G_GNUC_UNUSED,\n                                           size_t tapfdSize G_GNUC_UNUSED,\n                                           unsigned int unused_flags G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Cannot create macvlan devices on this platform\")"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot create macvlan devices on this platform\""
          ],
          "line": 1234
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanCreateWithVPortProfile(const char *ifname G_GNUC_UNUSED,\n                                           const virMacAddr *macaddress G_GNUC_UNUSED,\n                                           const char *linkdev G_GNUC_UNUSED,\n                                           virNetDevMacVLanMode mode G_GNUC_UNUSED,\n                                           const virNetDevVlan *vlan G_GNUC_UNUSED,\n                                           const unsigned char *vmuuid G_GNUC_UNUSED,\n                                           const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                           char **res_ifname G_GNUC_UNUSED,\n                                           virNetDevVPortProfileOp vmop G_GNUC_UNUSED,\n                                           char *stateDir G_GNUC_UNUSED,\n                                           int *tapfd G_GNUC_UNUSED,\n                                           size_t tapfdSize G_GNUC_UNUSED,\n                                           unsigned int unused_flags G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanTapSetup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1209-1217",
    "snippet": "int\nvirNetDevMacVLanTapSetup(int *tapfd G_GNUC_UNUSED,\n                         size_t tapfdSize G_GNUC_UNUSED,\n                         bool vnet_hdr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Cannot create macvlan devices on this platform\")"
          ],
          "line": 1214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot create macvlan devices on this platform\""
          ],
          "line": 1215
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanTapSetup(int *tapfd G_GNUC_UNUSED,\n                         size_t tapfdSize G_GNUC_UNUSED,\n                         bool vnet_hdr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanTapOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1199-1207",
    "snippet": "int\nvirNetDevMacVLanTapOpen(const char *ifname G_GNUC_UNUSED,\n                        int *tapfd G_GNUC_UNUSED,\n                        size_t tapfdSize G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Cannot create macvlan devices on this platform\")"
          ],
          "line": 1204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot create macvlan devices on this platform\""
          ],
          "line": 1205
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanTapOpen(const char *ifname G_GNUC_UNUSED,\n                        int *tapfd G_GNUC_UNUSED,\n                        size_t tapfdSize G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1192-1197",
    "snippet": "int virNetDevMacVLanDelete(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Cannot create macvlan devices on this platform\")"
          ],
          "line": 1194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot create macvlan devices on this platform\""
          ],
          "line": 1195
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanDelete(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1180-1190",
    "snippet": "int virNetDevMacVLanCreate(const char *ifname G_GNUC_UNUSED,\n                           const char *type G_GNUC_UNUSED,\n                           const virMacAddr *macaddress G_GNUC_UNUSED,\n                           const char *srcdev G_GNUC_UNUSED,\n                           uint32_t macvlan_mode G_GNUC_UNUSED,\n                           int *retry G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Cannot create macvlan devices on this platform\")"
          ],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot create macvlan devices on this platform\""
          ],
          "line": 1188
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanCreate(const char *ifname G_GNUC_UNUSED,\n                           const char *type G_GNUC_UNUSED,\n                           const virMacAddr *macaddress G_GNUC_UNUSED,\n                           const char *srcdev G_GNUC_UNUSED,\n                           uint32_t macvlan_mode G_GNUC_UNUSED,\n                           int *retry G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanIsMacvtap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1173-1178",
    "snippet": "bool virNetDevMacVLanIsMacvtap(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return false;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Cannot create macvlan devices on this platform\")"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot create macvlan devices on this platform\""
          ],
          "line": 1176
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nbool virNetDevMacVLanIsMacvtap(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return false;\n}"
  },
  {
    "function_name": "virNetDevMacVLanRestartWithVPortProfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1145-1170",
    "snippet": "int virNetDevMacVLanRestartWithVPortProfile(const char *cr_ifname,\n                                            const virMacAddr *macaddress,\n                                            const char *linkdev,\n                                            const unsigned char *vmuuid,\n                                            const virNetDevVPortProfile *virtPortProfile,\n                                            virNetDevVPortProfileOp vmOp)\n{\n    int rc = 0;\n\n    rc = virNetDevMacVLanVPortProfileRegisterCallback(cr_ifname, macaddress,\n                                                      linkdev, vmuuid,\n                                                      virtPortProfile, vmOp);\n    if (rc < 0)\n        return rc;\n\n    ignore_value(virNetDevVPortProfileAssociate(cr_ifname,\n                                                virtPortProfile,\n                                                macaddress,\n                                                linkdev,\n                                                -1,\n                                                vmuuid,\n                                                vmOp, true));\n\n    return rc;\n\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virNetDevVPortProfileAssociate(cr_ifname,\n                                                virtPortProfile,\n                                                macaddress,\n                                                linkdev,\n                                                -1,\n                                                vmuuid,\n                                                vmOp, true)"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevVPortProfileAssociate",
          "args": [
            "cr_ifname",
            "virtPortProfile",
            "macaddress",
            "linkdev",
            "-1",
            "vmuuid",
            "vmOp",
            "true"
          ],
          "line": 1160
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevVPortProfileAssociate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevvportprofile.c",
          "lines": "1351-1363",
          "snippet": "int virNetDevVPortProfileAssociate(const char *macvtap_ifname G_GNUC_UNUSED,\n                                   const virNetDevVPortProfile *virtPort G_GNUC_UNUSED,\n                                   const virMacAddr *macvtap_macaddr G_GNUC_UNUSED,\n                                   const char *linkdev G_GNUC_UNUSED,\n                                   int vf G_GNUC_UNUSED,\n                                   const unsigned char *vmuuid G_GNUC_UNUSED,\n                                   virNetDevVPortProfileOp vmOp G_GNUC_UNUSED,\n                                   bool setlink_only G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Virtual port profile association not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virlog.h\"",
            "# include \"virfile.h\"",
            "# include \"virnetlink.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virnetdev.h\"\n# include \"virlog.h\"\n# include \"virfile.h\"\n# include \"virnetlink.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetdevvportprofile.h\"\n#include <config.h>\n\nint virNetDevVPortProfileAssociate(const char *macvtap_ifname G_GNUC_UNUSED,\n                                   const virNetDevVPortProfile *virtPort G_GNUC_UNUSED,\n                                   const virMacAddr *macvtap_macaddr G_GNUC_UNUSED,\n                                   const char *linkdev G_GNUC_UNUSED,\n                                   int vf G_GNUC_UNUSED,\n                                   const unsigned char *vmuuid G_GNUC_UNUSED,\n                                   virNetDevVPortProfileOp vmOp G_GNUC_UNUSED,\n                                   bool setlink_only G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Virtual port profile association not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanVPortProfileRegisterCallback",
          "args": [
            "cr_ifname",
            "macaddress",
            "linkdev",
            "vmuuid",
            "virtPortProfile",
            "vmOp"
          ],
          "line": 1154
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanVPortProfileRegisterCallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1262-1272",
          "snippet": "int virNetDevMacVLanVPortProfileRegisterCallback(const char *ifname G_GNUC_UNUSED,\n                                                 const virMacAddr *macaddress G_GNUC_UNUSED,\n                                                 const char *linkdev G_GNUC_UNUSED,\n                                                 const unsigned char *vmuuid G_GNUC_UNUSED,\n                                                 const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                                 virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanVPortProfileRegisterCallback(const char *ifname G_GNUC_UNUSED,\n                                                 const virMacAddr *macaddress G_GNUC_UNUSED,\n                                                 const char *linkdev G_GNUC_UNUSED,\n                                                 const unsigned char *vmuuid G_GNUC_UNUSED,\n                                                 const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                                 virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanRestartWithVPortProfile(const char *cr_ifname,\n                                            const virMacAddr *macaddress,\n                                            const char *linkdev,\n                                            const unsigned char *vmuuid,\n                                            const virNetDevVPortProfile *virtPortProfile,\n                                            virNetDevVPortProfileOp vmOp)\n{\n    int rc = 0;\n\n    rc = virNetDevMacVLanVPortProfileRegisterCallback(cr_ifname, macaddress,\n                                                      linkdev, vmuuid,\n                                                      virtPortProfile, vmOp);\n    if (rc < 0)\n        return rc;\n\n    ignore_value(virNetDevVPortProfileAssociate(cr_ifname,\n                                                virtPortProfile,\n                                                macaddress,\n                                                linkdev,\n                                                -1,\n                                                vmuuid,\n                                                vmOp, true));\n\n    return rc;\n\n}"
  },
  {
    "function_name": "virNetDevMacVLanDeleteWithVPortProfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "1090-1129",
    "snippet": "int virNetDevMacVLanDeleteWithVPortProfile(const char *ifname,\n                                           const virMacAddr *macaddr,\n                                           const char *linkdev,\n                                           int mode,\n                                           const virNetDevVPortProfile *virtPortProfile,\n                                           char *stateDir)\n{\n    int ret = 0;\n\n    if (ifname) {\n        if (virNetDevVPortProfileDisassociate(ifname,\n                                              virtPortProfile,\n                                              macaddr,\n                                              linkdev,\n                                              -1,\n                                              VIR_NETDEV_VPORT_PROFILE_OP_DESTROY) < 0)\n            ret = -1;\n        if (virNetDevMacVLanDelete(ifname) < 0)\n            ret = -1;\n        virNetDevMacVLanReleaseName(ifname);\n    }\n\n    if (mode == VIR_NETDEV_MACVLAN_MODE_PASSTHRU) {\n        g_autoptr(virMacAddr) MAC = NULL;\n        g_autoptr(virMacAddr) adminMAC = NULL;\n        g_autoptr(virNetDevVlan) vlan = NULL;\n\n        if ((virNetDevReadNetConfig(linkdev, -1, stateDir,\n                                    &adminMAC, &vlan, &MAC) == 0) &&\n            (adminMAC || vlan || MAC)) {\n\n            ignore_value(virNetDevSetNetConfig(linkdev, -1,\n                                               adminMAC, vlan, MAC, !!vlan));\n        }\n    }\n\n    virNetlinkEventRemoveClient(0, macaddr, NETLINK_ROUTE);\n\n    return ret;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetlinkEventRemoveClient",
          "args": [
            "0",
            "macaddr",
            "NETLINK_ROUTE"
          ],
          "line": 1126
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkEventRemoveClient",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1369-1375",
          "snippet": "int virNetlinkEventRemoveClient(int watch G_GNUC_UNUSED,\n                                const virMacAddr *macaddr G_GNUC_UNUSED,\n                                unsigned int protocol G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint virNetlinkEventRemoveClient(int watch G_GNUC_UNUSED,\n                                const virMacAddr *macaddr G_GNUC_UNUSED,\n                                unsigned int protocol G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virNetDevSetNetConfig(linkdev, -1,\n                                               adminMAC, vlan, MAC, !!vlan)"
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSetNetConfig",
          "args": [
            "linkdev",
            "-1",
            "adminMAC",
            "vlan",
            "MAC",
            "!!vlan"
          ],
          "line": 1121
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetNetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2384-2395",
          "snippet": "int\nvirNetDevSetNetConfig(const char *linkdev G_GNUC_UNUSED,\n                      int vf G_GNUC_UNUSED,\n                      const virMacAddr *adminMAC G_GNUC_UNUSED,\n                      const virNetDevVlan *vlan G_GNUC_UNUSED,\n                      const virMacAddr *MAC G_GNUC_UNUSED,\n                      bool setVlan G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set net device config on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetNetConfig(const char *linkdev G_GNUC_UNUSED,\n                      int vf G_GNUC_UNUSED,\n                      const virMacAddr *adminMAC G_GNUC_UNUSED,\n                      const virNetDevVlan *vlan G_GNUC_UNUSED,\n                      const virMacAddr *MAC G_GNUC_UNUSED,\n                      bool setVlan G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set net device config on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevReadNetConfig",
          "args": [
            "linkdev",
            "-1",
            "stateDir",
            "&adminMAC",
            "&vlan",
            "&MAC"
          ],
          "line": 1117
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevReadNetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2370-2381",
          "snippet": "int\nvirNetDevReadNetConfig(const char *linkdev G_GNUC_UNUSED,\n                       int vf G_GNUC_UNUSED,\n                       const char *stateDir G_GNUC_UNUSED,\n                       virMacAddrPtr *adminMAC G_GNUC_UNUSED,\n                       virNetDevVlanPtr *vlan G_GNUC_UNUSED,\n                       virMacAddrPtr *MAC G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to read net device config on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevReadNetConfig(const char *linkdev G_GNUC_UNUSED,\n                       int vf G_GNUC_UNUSED,\n                       const char *stateDir G_GNUC_UNUSED,\n                       virMacAddrPtr *adminMAC G_GNUC_UNUSED,\n                       virNetDevVlanPtr *vlan G_GNUC_UNUSED,\n                       virMacAddrPtr *MAC G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to read net device config on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanReleaseName",
          "args": [
            "ifname"
          ],
          "line": 1109
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanReleaseName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1274-1279",
          "snippet": "int virNetDevMacVLanReleaseName(const char *name G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanReleaseName(const char *name G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanDelete",
          "args": [
            "ifname"
          ],
          "line": 1107
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1192-1197",
          "snippet": "int virNetDevMacVLanDelete(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanDelete(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevVPortProfileDisassociate",
          "args": [
            "ifname",
            "virtPortProfile",
            "macaddr",
            "linkdev",
            "-1",
            "VIR_NETDEV_VPORT_PROFILE_OP_DESTROY"
          ],
          "line": 1100
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevVPortProfileDisassociate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevvportprofile.c",
          "lines": "1365-1375",
          "snippet": "int virNetDevVPortProfileDisassociate(const char *macvtap_ifname G_GNUC_UNUSED,\n                                      const virNetDevVPortProfile *virtPort G_GNUC_UNUSED,\n                                      const virMacAddr *macvtap_macaddr G_GNUC_UNUSED,\n                                      const char *linkdev G_GNUC_UNUSED,\n                                      int vf G_GNUC_UNUSED,\n                                      virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Virtual port profile association not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virlog.h\"",
            "# include \"virfile.h\"",
            "# include \"virnetlink.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virnetdev.h\"\n# include \"virlog.h\"\n# include \"virfile.h\"\n# include \"virnetlink.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetdevvportprofile.h\"\n#include <config.h>\n\nint virNetDevVPortProfileDisassociate(const char *macvtap_ifname G_GNUC_UNUSED,\n                                      const virNetDevVPortProfile *virtPort G_GNUC_UNUSED,\n                                      const virMacAddr *macvtap_macaddr G_GNUC_UNUSED,\n                                      const char *linkdev G_GNUC_UNUSED,\n                                      int vf G_GNUC_UNUSED,\n                                      virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Virtual port profile association not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanDeleteWithVPortProfile(const char *ifname,\n                                           const virMacAddr *macaddr,\n                                           const char *linkdev,\n                                           int mode,\n                                           const virNetDevVPortProfile *virtPortProfile,\n                                           char *stateDir)\n{\n    int ret = 0;\n\n    if (ifname) {\n        if (virNetDevVPortProfileDisassociate(ifname,\n                                              virtPortProfile,\n                                              macaddr,\n                                              linkdev,\n                                              -1,\n                                              VIR_NETDEV_VPORT_PROFILE_OP_DESTROY) < 0)\n            ret = -1;\n        if (virNetDevMacVLanDelete(ifname) < 0)\n            ret = -1;\n        virNetDevMacVLanReleaseName(ifname);\n    }\n\n    if (mode == VIR_NETDEV_MACVLAN_MODE_PASSTHRU) {\n        g_autoptr(virMacAddr) MAC = NULL;\n        g_autoptr(virMacAddr) adminMAC = NULL;\n        g_autoptr(virNetDevVlan) vlan = NULL;\n\n        if ((virNetDevReadNetConfig(linkdev, -1, stateDir,\n                                    &adminMAC, &vlan, &MAC) == 0) &&\n            (adminMAC || vlan || MAC)) {\n\n            ignore_value(virNetDevSetNetConfig(linkdev, -1,\n                                               adminMAC, vlan, MAC, !!vlan));\n        }\n    }\n\n    virNetlinkEventRemoveClient(0, macaddr, NETLINK_ROUTE);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevMacVLanCreateWithVPortProfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "890-1077",
    "snippet": "int\nvirNetDevMacVLanCreateWithVPortProfile(const char *ifnameRequested,\n                                       const virMacAddr *macaddress,\n                                       const char *linkdev,\n                                       virNetDevMacVLanMode mode,\n                                       const virNetDevVlan *vlan,\n                                       const unsigned char *vmuuid,\n                                       const virNetDevVPortProfile *virtPortProfile,\n                                       char **ifnameResult,\n                                       virNetDevVPortProfileOp vmOp,\n                                       char *stateDir,\n                                       int *tapfd,\n                                       size_t tapfdSize,\n                                       unsigned int flags)\n{\n    const char *type = VIR_NET_GENERATED_PREFIX;\n    const char *pattern = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        VIR_NET_GENERATED_MACVTAP_PATTERN : VIR_NET_GENERATED_MACVLAN_PATTERN;\n    int reservedID = -1;\n    char ifname[IFNAMSIZ];\n    int retries, do_retry = 0;\n    uint32_t macvtapMode;\n    const char *ifnameCreated = NULL;\n    int vf = -1;\n    bool vnet_hdr = flags & VIR_NETDEV_MACVLAN_VNET_HDR;\n\n    macvtapMode = modeMap[mode];\n\n    *ifnameResult = NULL;\n\n    /** Note: When using PASSTHROUGH mode with MACVTAP devices the link\n     * device's MAC address must be set to the VMs MAC address. In\n     * order to not confuse the first switch or bridge in line this MAC\n     * address must be reset when the VM is shut down.\n     * This is especially important when using SRIOV capable cards that\n     * emulate their switch in firmware.\n     */\n\n    if (mode == VIR_NETDEV_MACVLAN_MODE_PASSTHRU) {\n        bool setVlan = true;\n\n        if (virtPortProfile &&\n            virtPortProfile->virtPortType == VIR_NETDEV_VPORT_PROFILE_8021QBH) {\n            /* The Cisco enic driver (the only SRIOV-capable card that\n             * uses 802.1Qbh) doesn't support IFLA_VFINFO_LIST, which\n             * is required to get/set the vlan tag of a VF.\n             */\n            setVlan = false;\n        }\n\n        if (virNetDevSaveNetConfig(linkdev, -1, stateDir, setVlan) < 0)\n           return -1;\n\n        if (virNetDevSetNetConfig(linkdev, -1, NULL, vlan, macaddress, setVlan) < 0)\n           return -1;\n    }\n\n    if (ifnameRequested) {\n        int rc;\n        bool isAutoName\n            = (STRPREFIX(ifnameRequested, VIR_NET_GENERATED_MACVTAP_PREFIX) ||\n               STRPREFIX(ifnameRequested, VIR_NET_GENERATED_MACVLAN_PREFIX));\n\n        VIR_INFO(\"Requested macvtap device name: %s\", ifnameRequested);\n        virMutexLock(&virNetDevMacVLanCreateMutex);\n\n        if ((rc = virNetDevExists(ifnameRequested)) < 0) {\n            virMutexUnlock(&virNetDevMacVLanCreateMutex);\n            return -1;\n        }\n        if (rc) {\n            if (isAutoName)\n                goto create_name;\n            virReportSystemError(EEXIST,\n                                 _(\"Unable to create %s device %s\"),\n                                 type, ifnameRequested);\n            virMutexUnlock(&virNetDevMacVLanCreateMutex);\n            return -1;\n        }\n        if (isAutoName &&\n            (reservedID = virNetDevMacVLanReserveName(ifnameRequested, true)) < 0) {\n            reservedID = -1;\n            goto create_name;\n        }\n\n        if (virNetDevMacVLanCreate(ifnameRequested, type, macaddress,\n                                   linkdev, macvtapMode, &do_retry) < 0) {\n            if (isAutoName) {\n                virNetDevMacVLanReleaseName(ifnameRequested);\n                reservedID = -1;\n                goto create_name;\n            }\n            virMutexUnlock(&virNetDevMacVLanCreateMutex);\n            return -1;\n        }\n        /* virNetDevMacVLanCreate() was successful - use this name */\n        ifnameCreated = ifnameRequested;\n create_name:\n        virMutexUnlock(&virNetDevMacVLanCreateMutex);\n    }\n\n    retries = MACVLAN_MAX_ID;\n    while (!ifnameCreated && retries) {\n        virMutexLock(&virNetDevMacVLanCreateMutex);\n        reservedID = virNetDevMacVLanReserveID(reservedID, flags, false, true);\n        if (reservedID < 0) {\n            virMutexUnlock(&virNetDevMacVLanCreateMutex);\n            return -1;\n        }\n        g_snprintf(ifname, sizeof(ifname), pattern, reservedID);\n        if (virNetDevMacVLanCreate(ifname, type, macaddress, linkdev,\n                                   macvtapMode, &do_retry) < 0) {\n            virNetDevMacVLanReleaseID(reservedID, flags);\n            virMutexUnlock(&virNetDevMacVLanCreateMutex);\n            if (!do_retry)\n                return -1;\n            VIR_INFO(\"Device %s wasn't reserved but already existed, skipping\",\n                     ifname);\n            retries--;\n            continue;\n        }\n        ifnameCreated = ifname;\n        virMutexUnlock(&virNetDevMacVLanCreateMutex);\n    }\n\n    if (!ifnameCreated) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many unreserved %s devices in use\"),\n                       type);\n        return -1;\n    }\n\n    if (virNetDevVPortProfileAssociate(ifnameCreated,\n                                       virtPortProfile,\n                                       macaddress,\n                                       linkdev,\n                                       vf,\n                                       vmuuid, vmOp, false) < 0)\n        goto link_del_exit;\n\n    if (flags & VIR_NETDEV_MACVLAN_CREATE_IFUP) {\n        if (virNetDevSetOnline(ifnameCreated, true) < 0)\n            goto disassociate_exit;\n    }\n\n    if (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) {\n        if (virNetDevMacVLanTapOpen(ifnameCreated, tapfd, tapfdSize) < 0)\n            goto disassociate_exit;\n\n        if (virNetDevMacVLanTapSetup(tapfd, tapfdSize, vnet_hdr) < 0)\n            goto disassociate_exit;\n\n        *ifnameResult = g_strdup(ifnameCreated);\n    } else {\n        *ifnameResult = g_strdup(ifnameCreated);\n    }\n\n    if (vmOp == VIR_NETDEV_VPORT_PROFILE_OP_CREATE ||\n        vmOp == VIR_NETDEV_VPORT_PROFILE_OP_RESTORE) {\n        /* Only directly register upon a create or restore (restarting\n         * a saved image) - migration and libvirtd restart are handled\n         * elsewhere.\n         */\n        if (virNetDevMacVLanVPortProfileRegisterCallback(ifnameCreated, macaddress,\n                                                         linkdev, vmuuid,\n                                                         virtPortProfile,\n                                                         vmOp) < 0)\n            goto disassociate_exit;\n    }\n\n    return 0;\n\n disassociate_exit:\n    ignore_value(virNetDevVPortProfileDisassociate(ifnameCreated,\n                                                   virtPortProfile,\n                                                   macaddress,\n                                                   linkdev,\n                                                   vf,\n                                                   vmOp));\n    while (tapfdSize--)\n        VIR_FORCE_CLOSE(tapfd[tapfdSize]);\n\n link_del_exit:\n    ignore_value(virNetDevMacVLanDelete(ifnameCreated));\n    virNetDevMacVLanReleaseName(ifnameCreated);\n\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevMacVLanReleaseName",
          "args": [
            "ifnameCreated"
          ],
          "line": 1074
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanReleaseName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1274-1279",
          "snippet": "int virNetDevMacVLanReleaseName(const char *name G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanReleaseName(const char *name G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virNetDevMacVLanDelete(ifnameCreated)"
          ],
          "line": 1073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanDelete",
          "args": [
            "ifnameCreated"
          ],
          "line": 1073
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1192-1197",
          "snippet": "int virNetDevMacVLanDelete(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanDelete(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "tapfd[tapfdSize]"
          ],
          "line": 1070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virNetDevVPortProfileDisassociate(ifnameCreated,\n                                                   virtPortProfile,\n                                                   macaddress,\n                                                   linkdev,\n                                                   vf,\n                                                   vmOp)"
          ],
          "line": 1063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevVPortProfileDisassociate",
          "args": [
            "ifnameCreated",
            "virtPortProfile",
            "macaddress",
            "linkdev",
            "vf",
            "vmOp"
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevVPortProfileDisassociate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevvportprofile.c",
          "lines": "1365-1375",
          "snippet": "int virNetDevVPortProfileDisassociate(const char *macvtap_ifname G_GNUC_UNUSED,\n                                      const virNetDevVPortProfile *virtPort G_GNUC_UNUSED,\n                                      const virMacAddr *macvtap_macaddr G_GNUC_UNUSED,\n                                      const char *linkdev G_GNUC_UNUSED,\n                                      int vf G_GNUC_UNUSED,\n                                      virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Virtual port profile association not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virlog.h\"",
            "# include \"virfile.h\"",
            "# include \"virnetlink.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virnetdev.h\"\n# include \"virlog.h\"\n# include \"virfile.h\"\n# include \"virnetlink.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetdevvportprofile.h\"\n#include <config.h>\n\nint virNetDevVPortProfileDisassociate(const char *macvtap_ifname G_GNUC_UNUSED,\n                                      const virNetDevVPortProfile *virtPort G_GNUC_UNUSED,\n                                      const virMacAddr *macvtap_macaddr G_GNUC_UNUSED,\n                                      const char *linkdev G_GNUC_UNUSED,\n                                      int vf G_GNUC_UNUSED,\n                                      virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Virtual port profile association not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanVPortProfileRegisterCallback",
          "args": [
            "ifnameCreated",
            "macaddress",
            "linkdev",
            "vmuuid",
            "virtPortProfile",
            "vmOp"
          ],
          "line": 1053
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanVPortProfileRegisterCallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1262-1272",
          "snippet": "int virNetDevMacVLanVPortProfileRegisterCallback(const char *ifname G_GNUC_UNUSED,\n                                                 const virMacAddr *macaddress G_GNUC_UNUSED,\n                                                 const char *linkdev G_GNUC_UNUSED,\n                                                 const unsigned char *vmuuid G_GNUC_UNUSED,\n                                                 const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                                 virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanVPortProfileRegisterCallback(const char *ifname G_GNUC_UNUSED,\n                                                 const virMacAddr *macaddress G_GNUC_UNUSED,\n                                                 const char *linkdev G_GNUC_UNUSED,\n                                                 const unsigned char *vmuuid G_GNUC_UNUSED,\n                                                 const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                                 virNetDevVPortProfileOp vmOp G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "ifnameCreated"
          ],
          "line": 1044
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanTapSetup",
          "args": [
            "tapfd",
            "tapfdSize",
            "vnet_hdr"
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanTapSetup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1209-1217",
          "snippet": "int\nvirNetDevMacVLanTapSetup(int *tapfd G_GNUC_UNUSED,\n                         size_t tapfdSize G_GNUC_UNUSED,\n                         bool vnet_hdr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanTapSetup(int *tapfd G_GNUC_UNUSED,\n                         size_t tapfdSize G_GNUC_UNUSED,\n                         bool vnet_hdr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanTapOpen",
          "args": [
            "ifnameCreated",
            "tapfd",
            "tapfdSize"
          ],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanTapOpen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1199-1207",
          "snippet": "int\nvirNetDevMacVLanTapOpen(const char *ifname G_GNUC_UNUSED,\n                        int *tapfd G_GNUC_UNUSED,\n                        size_t tapfdSize G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanTapOpen(const char *ifname G_GNUC_UNUSED,\n                        int *tapfd G_GNUC_UNUSED,\n                        size_t tapfdSize G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetOnline",
          "args": [
            "ifnameCreated",
            "true"
          ],
          "line": 1031
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetOnline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "660-665",
          "snippet": "int\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevVPortProfileAssociate",
          "args": [
            "ifnameCreated",
            "virtPortProfile",
            "macaddress",
            "linkdev",
            "vf",
            "vmuuid",
            "vmOp",
            "false"
          ],
          "line": 1022
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevVPortProfileAssociate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevvportprofile.c",
          "lines": "1351-1363",
          "snippet": "int virNetDevVPortProfileAssociate(const char *macvtap_ifname G_GNUC_UNUSED,\n                                   const virNetDevVPortProfile *virtPort G_GNUC_UNUSED,\n                                   const virMacAddr *macvtap_macaddr G_GNUC_UNUSED,\n                                   const char *linkdev G_GNUC_UNUSED,\n                                   int vf G_GNUC_UNUSED,\n                                   const unsigned char *vmuuid G_GNUC_UNUSED,\n                                   virNetDevVPortProfileOp vmOp G_GNUC_UNUSED,\n                                   bool setlink_only G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Virtual port profile association not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virlog.h\"",
            "# include \"virfile.h\"",
            "# include \"virnetlink.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virnetdev.h\"\n# include \"virlog.h\"\n# include \"virfile.h\"\n# include \"virnetlink.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetdevvportprofile.h\"\n#include <config.h>\n\nint virNetDevVPortProfileAssociate(const char *macvtap_ifname G_GNUC_UNUSED,\n                                   const virNetDevVPortProfile *virtPort G_GNUC_UNUSED,\n                                   const virMacAddr *macvtap_macaddr G_GNUC_UNUSED,\n                                   const char *linkdev G_GNUC_UNUSED,\n                                   int vf G_GNUC_UNUSED,\n                                   const unsigned char *vmuuid G_GNUC_UNUSED,\n                                   virNetDevVPortProfileOp vmOp G_GNUC_UNUSED,\n                                   bool setlink_only G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Virtual port profile association not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Too many unreserved %s devices in use\")",
            "type"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&virNetDevMacVLanCreateMutex"
          ],
          "line": 1012
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Device %s wasn't reserved but already existed, skipping\"",
            "ifname"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanReleaseID",
          "args": [
            "reservedID",
            "flags"
          ],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanReleaseID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "163-195",
          "snippet": "static int\nvirNetDevMacVLanReleaseID(int id, unsigned int flags)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n        return 0;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't free name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if (id < 0)\n        return 0;\n\n    VIR_INFO(\"releasing %sdevice %s%d\",\n             virBitmapIsBitSet(bitmap, id) ? \"\" : \"unreserved\",\n             VIR_NET_GENERATED_PREFIX, id);\n\n    if (virBitmapClearBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as unused\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic int\nvirNetDevMacVLanReleaseID(int id, unsigned int flags)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n        return 0;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't free name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if (id < 0)\n        return 0;\n\n    VIR_INFO(\"releasing %sdevice %s%d\",\n             virBitmapIsBitSet(bitmap, id) ? \"\" : \"unreserved\",\n             VIR_NET_GENERATED_PREFIX, id);\n\n    if (virBitmapClearBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as unused\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanCreate",
          "args": [
            "ifname",
            "type",
            "macaddress",
            "linkdev",
            "macvtapMode",
            "&do_retry"
          ],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1180-1190",
          "snippet": "int virNetDevMacVLanCreate(const char *ifname G_GNUC_UNUSED,\n                           const char *type G_GNUC_UNUSED,\n                           const virMacAddr *macaddress G_GNUC_UNUSED,\n                           const char *srcdev G_GNUC_UNUSED,\n                           uint32_t macvlan_mode G_GNUC_UNUSED,\n                           int *retry G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanCreate(const char *ifname G_GNUC_UNUSED,\n                           const char *type G_GNUC_UNUSED,\n                           const virMacAddr *macaddress G_GNUC_UNUSED,\n                           const char *srcdev G_GNUC_UNUSED,\n                           uint32_t macvlan_mode G_GNUC_UNUSED,\n                           int *retry G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "ifname",
            "sizeof(ifname)",
            "pattern",
            "reservedID"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanReserveID",
          "args": [
            "reservedID",
            "flags",
            "false",
            "true"
          ],
          "line": 994
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanReserveID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "106-154",
          "snippet": "static int\nvirNetDevMacVLanReserveID(int id, unsigned int flags,\n                          bool quietFail, bool nextFree)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n       return -1;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't use name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if ((id < 0 || nextFree) &&\n        (id = virBitmapNextClearBit(bitmap, id)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"no unused %s names available\"),\n                       VIR_NET_GENERATED_PREFIX);\n        return -1;\n    }\n\n    if (virBitmapIsBitSet(bitmap, id)) {\n        if (quietFail) {\n            VIR_INFO(\"couldn't reserve name %s%d - already in use\",\n                     VIR_NET_GENERATED_PREFIX, id);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"couldn't reserve name %s%d - already in use\"),\n                           VIR_NET_GENERATED_PREFIX, id);\n        }\n        return -1;\n    }\n\n    if (virBitmapSetBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as used\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n\n    VIR_INFO(\"reserving device %s%d\", VIR_NET_GENERATED_PREFIX, id);\n    return id;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic int\nvirNetDevMacVLanReserveID(int id, unsigned int flags,\n                          bool quietFail, bool nextFree)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n       return -1;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't use name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if ((id < 0 || nextFree) &&\n        (id = virBitmapNextClearBit(bitmap, id)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"no unused %s names available\"),\n                       VIR_NET_GENERATED_PREFIX);\n        return -1;\n    }\n\n    if (virBitmapIsBitSet(bitmap, id)) {\n        if (quietFail) {\n            VIR_INFO(\"couldn't reserve name %s%d - already in use\",\n                     VIR_NET_GENERATED_PREFIX, id);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"couldn't reserve name %s%d - already in use\"),\n                           VIR_NET_GENERATED_PREFIX, id);\n        }\n        return -1;\n    }\n\n    if (virBitmapSetBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as used\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n\n    VIR_INFO(\"reserving device %s%d\", VIR_NET_GENERATED_PREFIX, id);\n    return id;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&virNetDevMacVLanCreateMutex"
          ],
          "line": 993
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanReserveName",
          "args": [
            "ifnameRequested",
            "true"
          ],
          "line": 970
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanReserveName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1281-1287",
          "snippet": "int virNetDevMacVLanReserveName(const char *name G_GNUC_UNUSED,\n                                bool quietFail G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanReserveName(const char *name G_GNUC_UNUSED,\n                                bool quietFail G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EEXIST",
            "_(\"Unable to create %s device %s\")",
            "type",
            "ifnameRequested"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevExists",
          "args": [
            "ifnameRequested"
          ],
          "line": 956
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "218-223",
          "snippet": "int virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Requested macvtap device name: %s\"",
            "ifnameRequested"
          ],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "ifnameRequested",
            "VIR_NET_GENERATED_MACVLAN_PREFIX"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "ifnameRequested",
            "VIR_NET_GENERATED_MACVTAP_PREFIX"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSetNetConfig",
          "args": [
            "linkdev",
            "-1",
            "NULL",
            "vlan",
            "macaddress",
            "setVlan"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetNetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2384-2395",
          "snippet": "int\nvirNetDevSetNetConfig(const char *linkdev G_GNUC_UNUSED,\n                      int vf G_GNUC_UNUSED,\n                      const virMacAddr *adminMAC G_GNUC_UNUSED,\n                      const virNetDevVlan *vlan G_GNUC_UNUSED,\n                      const virMacAddr *MAC G_GNUC_UNUSED,\n                      bool setVlan G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set net device config on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetNetConfig(const char *linkdev G_GNUC_UNUSED,\n                      int vf G_GNUC_UNUSED,\n                      const virMacAddr *adminMAC G_GNUC_UNUSED,\n                      const virNetDevVlan *vlan G_GNUC_UNUSED,\n                      const virMacAddr *MAC G_GNUC_UNUSED,\n                      bool setVlan G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set net device config on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSaveNetConfig",
          "args": [
            "linkdev",
            "-1",
            "stateDir",
            "setVlan"
          ],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSaveNetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2358-2367",
          "snippet": "int\nvirNetDevSaveNetConfig(const char *linkdev G_GNUC_UNUSED,\n                       int vf G_GNUC_UNUSED,\n                       const char *stateDir G_GNUC_UNUSED,\n                       bool saveVlan G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to save net device config on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSaveNetConfig(const char *linkdev G_GNUC_UNUSED,\n                       int vf G_GNUC_UNUSED,\n                       const char *stateDir G_GNUC_UNUSED,\n                       bool saveVlan G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to save net device config on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanCreateWithVPortProfile(const char *ifnameRequested,\n                                       const virMacAddr *macaddress,\n                                       const char *linkdev,\n                                       virNetDevMacVLanMode mode,\n                                       const virNetDevVlan *vlan,\n                                       const unsigned char *vmuuid,\n                                       const virNetDevVPortProfile *virtPortProfile,\n                                       char **ifnameResult,\n                                       virNetDevVPortProfileOp vmOp,\n                                       char *stateDir,\n                                       int *tapfd,\n                                       size_t tapfdSize,\n                                       unsigned int flags)\n{\n    const char *type = VIR_NET_GENERATED_PREFIX;\n    const char *pattern = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        VIR_NET_GENERATED_MACVTAP_PATTERN : VIR_NET_GENERATED_MACVLAN_PATTERN;\n    int reservedID = -1;\n    char ifname[IFNAMSIZ];\n    int retries, do_retry = 0;\n    uint32_t macvtapMode;\n    const char *ifnameCreated = NULL;\n    int vf = -1;\n    bool vnet_hdr = flags & VIR_NETDEV_MACVLAN_VNET_HDR;\n\n    macvtapMode = modeMap[mode];\n\n    *ifnameResult = NULL;\n\n    /** Note: When using PASSTHROUGH mode with MACVTAP devices the link\n     * device's MAC address must be set to the VMs MAC address. In\n     * order to not confuse the first switch or bridge in line this MAC\n     * address must be reset when the VM is shut down.\n     * This is especially important when using SRIOV capable cards that\n     * emulate their switch in firmware.\n     */\n\n    if (mode == VIR_NETDEV_MACVLAN_MODE_PASSTHRU) {\n        bool setVlan = true;\n\n        if (virtPortProfile &&\n            virtPortProfile->virtPortType == VIR_NETDEV_VPORT_PROFILE_8021QBH) {\n            /* The Cisco enic driver (the only SRIOV-capable card that\n             * uses 802.1Qbh) doesn't support IFLA_VFINFO_LIST, which\n             * is required to get/set the vlan tag of a VF.\n             */\n            setVlan = false;\n        }\n\n        if (virNetDevSaveNetConfig(linkdev, -1, stateDir, setVlan) < 0)\n           return -1;\n\n        if (virNetDevSetNetConfig(linkdev, -1, NULL, vlan, macaddress, setVlan) < 0)\n           return -1;\n    }\n\n    if (ifnameRequested) {\n        int rc;\n        bool isAutoName\n            = (STRPREFIX(ifnameRequested, VIR_NET_GENERATED_MACVTAP_PREFIX) ||\n               STRPREFIX(ifnameRequested, VIR_NET_GENERATED_MACVLAN_PREFIX));\n\n        VIR_INFO(\"Requested macvtap device name: %s\", ifnameRequested);\n        virMutexLock(&virNetDevMacVLanCreateMutex);\n\n        if ((rc = virNetDevExists(ifnameRequested)) < 0) {\n            virMutexUnlock(&virNetDevMacVLanCreateMutex);\n            return -1;\n        }\n        if (rc) {\n            if (isAutoName)\n                goto create_name;\n            virReportSystemError(EEXIST,\n                                 _(\"Unable to create %s device %s\"),\n                                 type, ifnameRequested);\n            virMutexUnlock(&virNetDevMacVLanCreateMutex);\n            return -1;\n        }\n        if (isAutoName &&\n            (reservedID = virNetDevMacVLanReserveName(ifnameRequested, true)) < 0) {\n            reservedID = -1;\n            goto create_name;\n        }\n\n        if (virNetDevMacVLanCreate(ifnameRequested, type, macaddress,\n                                   linkdev, macvtapMode, &do_retry) < 0) {\n            if (isAutoName) {\n                virNetDevMacVLanReleaseName(ifnameRequested);\n                reservedID = -1;\n                goto create_name;\n            }\n            virMutexUnlock(&virNetDevMacVLanCreateMutex);\n            return -1;\n        }\n        /* virNetDevMacVLanCreate() was successful - use this name */\n        ifnameCreated = ifnameRequested;\n create_name:\n        virMutexUnlock(&virNetDevMacVLanCreateMutex);\n    }\n\n    retries = MACVLAN_MAX_ID;\n    while (!ifnameCreated && retries) {\n        virMutexLock(&virNetDevMacVLanCreateMutex);\n        reservedID = virNetDevMacVLanReserveID(reservedID, flags, false, true);\n        if (reservedID < 0) {\n            virMutexUnlock(&virNetDevMacVLanCreateMutex);\n            return -1;\n        }\n        g_snprintf(ifname, sizeof(ifname), pattern, reservedID);\n        if (virNetDevMacVLanCreate(ifname, type, macaddress, linkdev,\n                                   macvtapMode, &do_retry) < 0) {\n            virNetDevMacVLanReleaseID(reservedID, flags);\n            virMutexUnlock(&virNetDevMacVLanCreateMutex);\n            if (!do_retry)\n                return -1;\n            VIR_INFO(\"Device %s wasn't reserved but already existed, skipping\",\n                     ifname);\n            retries--;\n            continue;\n        }\n        ifnameCreated = ifname;\n        virMutexUnlock(&virNetDevMacVLanCreateMutex);\n    }\n\n    if (!ifnameCreated) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many unreserved %s devices in use\"),\n                       type);\n        return -1;\n    }\n\n    if (virNetDevVPortProfileAssociate(ifnameCreated,\n                                       virtPortProfile,\n                                       macaddress,\n                                       linkdev,\n                                       vf,\n                                       vmuuid, vmOp, false) < 0)\n        goto link_del_exit;\n\n    if (flags & VIR_NETDEV_MACVLAN_CREATE_IFUP) {\n        if (virNetDevSetOnline(ifnameCreated, true) < 0)\n            goto disassociate_exit;\n    }\n\n    if (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) {\n        if (virNetDevMacVLanTapOpen(ifnameCreated, tapfd, tapfdSize) < 0)\n            goto disassociate_exit;\n\n        if (virNetDevMacVLanTapSetup(tapfd, tapfdSize, vnet_hdr) < 0)\n            goto disassociate_exit;\n\n        *ifnameResult = g_strdup(ifnameCreated);\n    } else {\n        *ifnameResult = g_strdup(ifnameCreated);\n    }\n\n    if (vmOp == VIR_NETDEV_VPORT_PROFILE_OP_CREATE ||\n        vmOp == VIR_NETDEV_VPORT_PROFILE_OP_RESTORE) {\n        /* Only directly register upon a create or restore (restarting\n         * a saved image) - migration and libvirtd restart are handled\n         * elsewhere.\n         */\n        if (virNetDevMacVLanVPortProfileRegisterCallback(ifnameCreated, macaddress,\n                                                         linkdev, vmuuid,\n                                                         virtPortProfile,\n                                                         vmOp) < 0)\n            goto disassociate_exit;\n    }\n\n    return 0;\n\n disassociate_exit:\n    ignore_value(virNetDevVPortProfileDisassociate(ifnameCreated,\n                                                   virtPortProfile,\n                                                   macaddress,\n                                                   linkdev,\n                                                   vf,\n                                                   vmOp));\n    while (tapfdSize--)\n        VIR_FORCE_CLOSE(tapfd[tapfdSize]);\n\n link_del_exit:\n    ignore_value(virNetDevMacVLanDelete(ifnameCreated));\n    virNetDevMacVLanReleaseName(ifnameCreated);\n\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanVPortProfileRegisterCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "823-857",
    "snippet": "int\nvirNetDevMacVLanVPortProfileRegisterCallback(const char *ifname,\n                                             const virMacAddr *macaddress,\n                                             const char *linkdev,\n                                             const unsigned char *vmuuid,\n                                             const virNetDevVPortProfile *virtPortProfile,\n                                             virNetDevVPortProfileOp vmOp)\n{\n    virNetlinkCallbackDataPtr calld = NULL;\n\n    if (virtPortProfile && virNetlinkEventServiceIsRunning(NETLINK_ROUTE)) {\n        if (VIR_ALLOC(calld) < 0)\n            goto error;\n        calld->cr_ifname = g_strdup(ifname);\n        if (VIR_ALLOC(calld->virtPortProfile) < 0)\n            goto error;\n        memcpy(calld->virtPortProfile, virtPortProfile, sizeof(*virtPortProfile));\n        virMacAddrSet(&calld->macaddress, macaddress);\n        calld->linkdev = g_strdup(linkdev);\n        memcpy(calld->vmuuid, vmuuid, sizeof(calld->vmuuid));\n\n        calld->vmOp = vmOp;\n\n        if (virNetlinkEventAddClient(virNetDevMacVLanVPortProfileCallback,\n                                     virNetDevMacVLanVPortProfileDestroyCallback,\n                                     calld, macaddress, NETLINK_ROUTE) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virNetlinkCallbackDataFree(calld);\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetlinkCallbackDataFree",
          "args": [
            "calld"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkCallbackDataFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "793-802",
          "snippet": "static void\nvirNetlinkCallbackDataFree(virNetlinkCallbackDataPtr calld)\n{\n    if (calld) {\n        VIR_FREE(calld->cr_ifname);\n        VIR_FREE(calld->virtPortProfile);\n        VIR_FREE(calld->linkdev);\n    }\n    VIR_FREE(calld);\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic void\nvirNetlinkCallbackDataFree(virNetlinkCallbackDataPtr calld)\n{\n    if (calld) {\n        VIR_FREE(calld->cr_ifname);\n        VIR_FREE(calld->virtPortProfile);\n        VIR_FREE(calld->linkdev);\n    }\n    VIR_FREE(calld);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetlinkEventAddClient",
          "args": [
            "virNetDevMacVLanVPortProfileCallback",
            "virNetDevMacVLanVPortProfileDestroyCallback",
            "calld",
            "macaddress",
            "NETLINK_ROUTE"
          ],
          "line": 846
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkEventAddClient",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1356-1364",
          "snippet": "int virNetlinkEventAddClient(virNetlinkEventHandleCallback handleCB G_GNUC_UNUSED,\n                             virNetlinkEventRemoveCallback removeCB G_GNUC_UNUSED,\n                             void *opaque G_GNUC_UNUSED,\n                             const virMacAddr *macaddr G_GNUC_UNUSED,\n                             unsigned int protocol G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint virNetlinkEventAddClient(virNetlinkEventHandleCallback handleCB G_GNUC_UNUSED,\n                             virNetlinkEventRemoveCallback removeCB G_GNUC_UNUSED,\n                             void *opaque G_GNUC_UNUSED,\n                             const virMacAddr *macaddr G_GNUC_UNUSED,\n                             unsigned int protocol G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "calld->vmuuid",
            "vmuuid",
            "sizeof(calld->vmuuid)"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "linkdev"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrSet",
          "args": [
            "&calld->macaddress",
            "macaddress"
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrSetRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "113-117",
          "snippet": "void\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "calld->virtPortProfile",
            "virtPortProfile",
            "sizeof(*virtPortProfile)"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "calld->virtPortProfile"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "calld"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetlinkEventServiceIsRunning",
          "args": [
            "NETLINK_ROUTE"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkEventServiceIsRunning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1340-1344",
          "snippet": "bool virNetlinkEventServiceIsRunning(unsigned int protocol G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nbool virNetlinkEventServiceIsRunning(unsigned int protocol G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanVPortProfileRegisterCallback(const char *ifname,\n                                             const virMacAddr *macaddress,\n                                             const char *linkdev,\n                                             const unsigned char *vmuuid,\n                                             const virNetDevVPortProfile *virtPortProfile,\n                                             virNetDevVPortProfileOp vmOp)\n{\n    virNetlinkCallbackDataPtr calld = NULL;\n\n    if (virtPortProfile && virNetlinkEventServiceIsRunning(NETLINK_ROUTE)) {\n        if (VIR_ALLOC(calld) < 0)\n            goto error;\n        calld->cr_ifname = g_strdup(ifname);\n        if (VIR_ALLOC(calld->virtPortProfile) < 0)\n            goto error;\n        memcpy(calld->virtPortProfile, virtPortProfile, sizeof(*virtPortProfile));\n        virMacAddrSet(&calld->macaddress, macaddress);\n        calld->linkdev = g_strdup(linkdev);\n        memcpy(calld->vmuuid, vmuuid, sizeof(calld->vmuuid));\n\n        calld->vmOp = vmOp;\n\n        if (virNetlinkEventAddClient(virNetDevMacVLanVPortProfileCallback,\n                                     virNetDevMacVLanVPortProfileDestroyCallback,\n                                     calld, macaddress, NETLINK_ROUTE) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    virNetlinkCallbackDataFree(calld);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanVPortProfileDestroyCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "815-821",
    "snippet": "static void\nvirNetDevMacVLanVPortProfileDestroyCallback(int watch G_GNUC_UNUSED,\n                                            const virMacAddr *macaddr G_GNUC_UNUSED,\n                                            void *opaque)\n{\n    virNetlinkCallbackDataFree((virNetlinkCallbackDataPtr)opaque);\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetlinkCallbackDataFree",
          "args": [
            "(virNetlinkCallbackDataPtr)opaque"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkCallbackDataFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "793-802",
          "snippet": "static void\nvirNetlinkCallbackDataFree(virNetlinkCallbackDataPtr calld)\n{\n    if (calld) {\n        VIR_FREE(calld->cr_ifname);\n        VIR_FREE(calld->virtPortProfile);\n        VIR_FREE(calld->linkdev);\n    }\n    VIR_FREE(calld);\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic void\nvirNetlinkCallbackDataFree(virNetlinkCallbackDataPtr calld)\n{\n    if (calld) {\n        VIR_FREE(calld->cr_ifname);\n        VIR_FREE(calld->virtPortProfile);\n        VIR_FREE(calld->linkdev);\n    }\n    VIR_FREE(calld);\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic void\nvirNetDevMacVLanVPortProfileDestroyCallback(int watch G_GNUC_UNUSED,\n                                            const virMacAddr *macaddr G_GNUC_UNUSED,\n                                            void *opaque)\n{\n    virNetlinkCallbackDataFree((virNetlinkCallbackDataPtr)opaque);\n}"
  },
  {
    "function_name": "virNetlinkCallbackDataFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "793-802",
    "snippet": "static void\nvirNetlinkCallbackDataFree(virNetlinkCallbackDataPtr calld)\n{\n    if (calld) {\n        VIR_FREE(calld->cr_ifname);\n        VIR_FREE(calld->virtPortProfile);\n        VIR_FREE(calld->linkdev);\n    }\n    VIR_FREE(calld);\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "calld"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "calld->linkdev"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "calld->virtPortProfile"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "calld->cr_ifname"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic void\nvirNetlinkCallbackDataFree(virNetlinkCallbackDataPtr calld)\n{\n    if (calld) {\n        VIR_FREE(calld->cr_ifname);\n        VIR_FREE(calld->virtPortProfile);\n        VIR_FREE(calld->linkdev);\n    }\n    VIR_FREE(calld);\n}"
  },
  {
    "function_name": "virNetDevMacVLanVPortProfileCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "555-781",
    "snippet": "static void\nvirNetDevMacVLanVPortProfileCallback(struct nlmsghdr *hdr,\n                                     unsigned int length,\n                                     struct sockaddr_nl *peer,\n                                     bool *handled,\n                                     void *opaque)\n{\n    struct nla_policy ifla_vf_policy[IFLA_VF_MAX + 1] = {\n        [IFLA_VF_MAC] = {.minlen = sizeof(struct ifla_vf_mac),\n                         .maxlen = sizeof(struct ifla_vf_mac)},\n        [IFLA_VF_VLAN] = {.minlen = sizeof(struct ifla_vf_vlan),\n                          .maxlen = sizeof(struct ifla_vf_vlan)},\n    };\n\n    struct nla_policy ifla_port_policy[IFLA_PORT_MAX + 1] = {\n        [IFLA_PORT_RESPONSE] = {.type = NLA_U16},\n    };\n\n    struct nlattr *tb[IFLA_MAX + 1], *tb3[IFLA_PORT_MAX + 1],\n        *tb_vfinfo[IFLA_VF_MAX + 1], *tb_vfinfo_list;\n\n    struct ifinfomsg ifinfo;\n    void *data;\n    int rem;\n    char *ifname;\n    bool indicate = false;\n    virNetlinkCallbackDataPtr calld = opaque;\n    pid_t lldpad_pid = 0;\n    pid_t virip_pid = 0;\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n\n    data = nlmsg_data(hdr);\n\n    /* Quickly decide if we want this or not */\n\n    if (virPidFileReadPath(LLDPAD_PID_FILE, &lldpad_pid) < 0)\n        return;\n\n    ignore_value(virPidFileReadPath(VIRIP_PID_FILE, &virip_pid));\n\n    if (hdr->nlmsg_pid != lldpad_pid && hdr->nlmsg_pid != virip_pid)\n        return; /* we only care for lldpad and virip messages */\n    if (hdr->nlmsg_type != RTM_SETLINK)\n        return; /* we only care for RTM_SETLINK */\n    if (*handled)\n        return; /* if it has been handled - dont handle again */\n\n    /* DEBUG start */\n    VIR_INFO(\"netlink message nl_sockaddr: %p len: %d\", peer, length);\n    VIR_DEBUG(\"nlmsg_type  = 0x%02x\", hdr->nlmsg_type);\n    VIR_DEBUG(\"nlmsg_len   = 0x%04x\", hdr->nlmsg_len);\n    VIR_DEBUG(\"nlmsg_pid   = %d\", hdr->nlmsg_pid);\n    VIR_DEBUG(\"nlmsg_seq   = 0x%08x\", hdr->nlmsg_seq);\n    VIR_DEBUG(\"nlmsg_flags = 0x%04x\", hdr->nlmsg_flags);\n\n    VIR_DEBUG(\"lldpad pid  = %d\", lldpad_pid);\n\n    switch (hdr->nlmsg_type) {\n    case RTM_NEWLINK:\n    case RTM_DELLINK:\n    case RTM_SETLINK:\n    case RTM_GETLINK:\n        VIR_DEBUG(\" IFINFOMSG\");\n        VIR_DEBUG(\"        ifi_family = 0x%02x\",\n                  ((struct ifinfomsg *)data)->ifi_family);\n        VIR_DEBUG(\"        ifi_type   = 0x%x\",\n                  ((struct ifinfomsg *)data)->ifi_type);\n        VIR_DEBUG(\"        ifi_index  = %i\",\n                  ((struct ifinfomsg *)data)->ifi_index);\n        VIR_DEBUG(\"        ifi_flags  = 0x%04x\",\n                  ((struct ifinfomsg *)data)->ifi_flags);\n        VIR_DEBUG(\"        ifi_change = 0x%04x\",\n                  ((struct ifinfomsg *)data)->ifi_change);\n    }\n    /* DEBUG end */\n\n    /* Parse netlink message assume a setlink with vfports */\n    memcpy(&ifinfo, NLMSG_DATA(hdr), sizeof(ifinfo));\n    VIR_DEBUG(\"family:%#x type:%#x index:%d flags:%#x change:%#x\",\n              ifinfo.ifi_family, ifinfo.ifi_type, ifinfo.ifi_index,\n              ifinfo.ifi_flags, ifinfo.ifi_change);\n    if (nlmsg_parse(hdr, sizeof(ifinfo),\n                    (struct nlattr **)&tb, IFLA_MAX, NULL)) {\n        VIR_DEBUG(\"error parsing request...\");\n        return;\n    }\n\n    if (tb[IFLA_VFINFO_LIST]) {\n        VIR_DEBUG(\"FOUND IFLA_VFINFO_LIST!\");\n\n        nla_for_each_nested(tb_vfinfo_list, tb[IFLA_VFINFO_LIST], rem) {\n            if (nla_type(tb_vfinfo_list) != IFLA_VF_INFO) {\n                VIR_DEBUG(\"nested parsing of\"\n                          \"IFLA_VFINFO_LIST failed.\");\n                return;\n            }\n            if (nla_parse_nested(tb_vfinfo, IFLA_VF_MAX,\n                                 tb_vfinfo_list, ifla_vf_policy)) {\n                VIR_DEBUG(\"nested parsing of \"\n                          \"IFLA_VF_INFO failed.\");\n                return;\n            }\n        }\n\n        if (tb_vfinfo[IFLA_VF_MAC]) {\n            struct ifla_vf_mac *mac = RTA_DATA(tb_vfinfo[IFLA_VF_MAC]);\n            unsigned char *m = mac->mac;\n\n            VIR_DEBUG(\"IFLA_VF_MAC = %2x:%2x:%2x:%2x:%2x:%2x\",\n                      m[0], m[1], m[2], m[3], m[4], m[5]);\n\n            if (virMacAddrCmpRaw(&calld->macaddress, mac->mac)) {\n                /* Repeat the same check for a broadcast mac */\n                size_t i;\n\n                for (i = 0; i < VIR_MAC_BUFLEN; i++) {\n                    if (calld->macaddress.addr[i] != 0xff) {\n                        VIR_DEBUG(\"MAC address match failed (wasn't broadcast)\");\n                        return;\n                    }\n                }\n            }\n        }\n\n        if (tb_vfinfo[IFLA_VF_VLAN]) {\n            struct ifla_vf_vlan *vlan = RTA_DATA(tb_vfinfo[IFLA_VF_VLAN]);\n\n            VIR_DEBUG(\"IFLA_VF_VLAN = %d\", vlan->vlan);\n        }\n    }\n\n    if (tb[IFLA_IFNAME]) {\n        ifname = (char *)RTA_DATA(tb[IFLA_IFNAME]);\n        VIR_DEBUG(\"IFLA_IFNAME = %s\", ifname);\n    }\n\n    if (tb[IFLA_OPERSTATE]) {\n        rem = *(unsigned short *)RTA_DATA(tb[IFLA_OPERSTATE]);\n        VIR_DEBUG(\"IFLA_OPERSTATE = %d\", rem);\n    }\n\n    if (tb[IFLA_VF_PORTS]) {\n        struct nlattr *tb_vf_ports;\n\n        VIR_DEBUG(\"found IFLA_VF_PORTS\");\n        nla_for_each_nested(tb_vf_ports, tb[IFLA_VF_PORTS], rem) {\n\n            VIR_DEBUG(\"iterating\");\n            if (nla_type(tb_vf_ports) != IFLA_VF_PORT) {\n                VIR_DEBUG(\"not a IFLA_VF_PORT. skipping\");\n                continue;\n            }\n            if (nla_parse_nested(tb3, IFLA_PORT_MAX, tb_vf_ports,\n                                 ifla_port_policy)) {\n                VIR_DEBUG(\"nested parsing on level 2\"\n                          \" failed.\");\n            }\n            if (tb3[IFLA_PORT_VF]) {\n                VIR_DEBUG(\"IFLA_PORT_VF = %d\",\n                          *(uint32_t *) (RTA_DATA(tb3[IFLA_PORT_VF])));\n            }\n            if (tb3[IFLA_PORT_PROFILE]) {\n                VIR_DEBUG(\"IFLA_PORT_PROFILE = %s\",\n                          (char *) RTA_DATA(tb3[IFLA_PORT_PROFILE]));\n            }\n\n            if (tb3[IFLA_PORT_VSI_TYPE]) {\n                struct ifla_port_vsi *pvsi;\n                int tid = 0;\n\n                pvsi = (struct ifla_port_vsi *)\n                    RTA_DATA(tb3[IFLA_PORT_VSI_TYPE]);\n                tid = ((pvsi->vsi_type_id[2] << 16) |\n                       (pvsi->vsi_type_id[1] << 8) |\n                       pvsi->vsi_type_id[0]);\n\n                VIR_DEBUG(\"mgr_id: %d\", pvsi->vsi_mgr_id);\n                VIR_DEBUG(\"type_id: %d\", tid);\n                VIR_DEBUG(\"type_version: %d\",\n                          pvsi->vsi_type_version);\n            }\n\n            if (tb3[IFLA_PORT_INSTANCE_UUID]) {\n                char instance[INSTANCE_STRLEN + 2];\n                unsigned char *uuid;\n\n                uuid = (unsigned char *)\n                    RTA_DATA(tb3[IFLA_PORT_INSTANCE_UUID]);\n                instance2str(uuid, instance, sizeof(instance));\n                VIR_DEBUG(\"IFLA_PORT_INSTANCE_UUID = %s\",\n                          instance);\n            }\n\n            if (tb3[IFLA_PORT_REQUEST]) {\n                uint8_t req = *(uint8_t *) RTA_DATA(tb3[IFLA_PORT_REQUEST]);\n                VIR_DEBUG(\"IFLA_PORT_REQUEST = %d\", req);\n\n                if (req == PORT_REQUEST_DISASSOCIATE) {\n                    VIR_DEBUG(\"Set disassociated.\");\n                    indicate = true;\n                }\n            }\n\n            if (tb3[IFLA_PORT_RESPONSE]) {\n                VIR_DEBUG(\"IFLA_PORT_RESPONSE = %d\",\n                          *(uint16_t *) RTA_DATA(tb3[IFLA_PORT_RESPONSE]));\n            }\n        }\n    }\n\n    if (!indicate)\n        return;\n\n    VIR_INFO(\"Re-send 802.1qbg associate request:\");\n    VIR_INFO(\"  if: %s\", calld->cr_ifname);\n    VIR_INFO(\"  lf: %s\", calld->linkdev);\n    VIR_INFO(\" mac: %s\", virMacAddrFormat(&calld->macaddress, macaddr));\n    ignore_value(virNetDevVPortProfileAssociate(calld->cr_ifname,\n                                                calld->virtPortProfile,\n                                                &calld->macaddress,\n                                                calld->linkdev,\n                                                calld->vf,\n                                                calld->vmuuid,\n                                                calld->vmOp, true));\n    *handled = true;\n    return;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virNetDevVPortProfileAssociate(calld->cr_ifname,\n                                                calld->virtPortProfile,\n                                                &calld->macaddress,\n                                                calld->linkdev,\n                                                calld->vf,\n                                                calld->vmuuid,\n                                                calld->vmOp, true)"
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevVPortProfileAssociate",
          "args": [
            "calld->cr_ifname",
            "calld->virtPortProfile",
            "&calld->macaddress",
            "calld->linkdev",
            "calld->vf",
            "calld->vmuuid",
            "calld->vmOp",
            "true"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevVPortProfileAssociate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevvportprofile.c",
          "lines": "1351-1363",
          "snippet": "int virNetDevVPortProfileAssociate(const char *macvtap_ifname G_GNUC_UNUSED,\n                                   const virNetDevVPortProfile *virtPort G_GNUC_UNUSED,\n                                   const virMacAddr *macvtap_macaddr G_GNUC_UNUSED,\n                                   const char *linkdev G_GNUC_UNUSED,\n                                   int vf G_GNUC_UNUSED,\n                                   const unsigned char *vmuuid G_GNUC_UNUSED,\n                                   virNetDevVPortProfileOp vmOp G_GNUC_UNUSED,\n                                   bool setlink_only G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Virtual port profile association not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virlog.h\"",
            "# include \"virfile.h\"",
            "# include \"virnetlink.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virnetdev.h\"\n# include \"virlog.h\"\n# include \"virfile.h\"\n# include \"virnetlink.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetdevvportprofile.h\"\n#include <config.h>\n\nint virNetDevVPortProfileAssociate(const char *macvtap_ifname G_GNUC_UNUSED,\n                                   const virNetDevVPortProfile *virtPort G_GNUC_UNUSED,\n                                   const virMacAddr *macvtap_macaddr G_GNUC_UNUSED,\n                                   const char *linkdev G_GNUC_UNUSED,\n                                   int vf G_GNUC_UNUSED,\n                                   const unsigned char *vmuuid G_GNUC_UNUSED,\n                                   virNetDevVPortProfileOp vmOp G_GNUC_UNUSED,\n                                   bool setlink_only G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Virtual port profile association not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\" mac: %s\"",
            "virMacAddrFormat(&calld->macaddress, macaddr)"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "&calld->macaddress",
            "macaddr"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"  lf: %s\"",
            "calld->linkdev"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"  if: %s\"",
            "calld->cr_ifname"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Re-send 802.1qbg associate request:\""
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"IFLA_PORT_RESPONSE = %d\"",
            "*(uint16_t *) RTA_DATA(tb3[IFLA_PORT_RESPONSE])"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb3[IFLA_PORT_RESPONSE]"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Set disassociated.\""
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"IFLA_PORT_REQUEST = %d\"",
            "req"
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb3[IFLA_PORT_REQUEST]"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"IFLA_PORT_INSTANCE_UUID = %s\"",
            "instance"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "instance2str",
          "args": [
            "uuid",
            "instance",
            "sizeof(instance)"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "instance2str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "525-536",
          "snippet": "static int instance2str(const unsigned char *p, char *dst, size_t size)\n{\n    if (dst && size > INSTANCE_STRLEN) {\n        g_snprintf(dst, size, \"%02x%02x%02x%02x-%02x%02x-%02x%02x-\"\n                   \"%02x%02x-%02x%02x%02x%02x%02x%02x\",\n                   p[0], p[1], p[2], p[3],\n                   p[4], p[5], p[6], p[7],\n                   p[8], p[9], p[10], p[11], p[12], p[13], p[14], p[15]);\n        return 0;\n    }\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic int instance2str(const unsigned char *p, char *dst, size_t size)\n{\n    if (dst && size > INSTANCE_STRLEN) {\n        g_snprintf(dst, size, \"%02x%02x%02x%02x-%02x%02x-%02x%02x-\"\n                   \"%02x%02x-%02x%02x%02x%02x%02x%02x\",\n                   p[0], p[1], p[2], p[3],\n                   p[4], p[5], p[6], p[7],\n                   p[8], p[9], p[10], p[11], p[12], p[13], p[14], p[15]);\n        return 0;\n    }\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb3[IFLA_PORT_INSTANCE_UUID]"
          ],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"type_version: %d\"",
            "pvsi->vsi_type_version"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"type_id: %d\"",
            "tid"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"mgr_id: %d\"",
            "pvsi->vsi_mgr_id"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb3[IFLA_PORT_VSI_TYPE]"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"IFLA_PORT_PROFILE = %s\"",
            "(char *) RTA_DATA(tb3[IFLA_PORT_PROFILE])"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb3[IFLA_PORT_PROFILE]"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"IFLA_PORT_VF = %d\"",
            "*(uint32_t *) (RTA_DATA(tb3[IFLA_PORT_VF]))"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb3[IFLA_PORT_VF]"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nested parsing on level 2\"\n                          \" failed.\""
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_parse_nested",
          "args": [
            "tb3",
            "IFLA_PORT_MAX",
            "tb_vf_ports",
            "ifla_port_policy"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"not a IFLA_VF_PORT. skipping\""
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_type",
          "args": [
            "tb_vf_ports"
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"iterating\""
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_for_each_nested",
          "args": [
            "tb_vf_ports",
            "tb[IFLA_VF_PORTS]",
            "rem"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"found IFLA_VF_PORTS\""
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"IFLA_OPERSTATE = %d\"",
            "rem"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb[IFLA_OPERSTATE]"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"IFLA_IFNAME = %s\"",
            "ifname"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb[IFLA_IFNAME]"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"IFLA_VF_VLAN = %d\"",
            "vlan->vlan"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb_vfinfo[IFLA_VF_VLAN]"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"MAC address match failed (wasn't broadcast)\""
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrCmpRaw",
          "args": [
            "&calld->macaddress",
            "mac->mac"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrCmpRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "86-91",
          "snippet": "int\nvirMacAddrCmpRaw(const virMacAddr *mac1,\n                 const unsigned char mac2[VIR_MAC_BUFLEN])\n{\n    return memcmp(mac1->addr, mac2, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrCmpRaw(const virMacAddr *mac1,\n                 const unsigned char mac2[VIR_MAC_BUFLEN])\n{\n    return memcmp(mac1->addr, mac2, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"IFLA_VF_MAC = %2x:%2x:%2x:%2x:%2x:%2x\"",
            "m[0]",
            "m[1]",
            "m[2]",
            "m[3]",
            "m[4]",
            "m[5]"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb_vfinfo[IFLA_VF_MAC]"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nested parsing of \"\n                          \"IFLA_VF_INFO failed.\""
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_parse_nested",
          "args": [
            "tb_vfinfo",
            "IFLA_VF_MAX",
            "tb_vfinfo_list",
            "ifla_vf_policy"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nested parsing of\"\n                          \"IFLA_VFINFO_LIST failed.\""
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_type",
          "args": [
            "tb_vfinfo_list"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_for_each_nested",
          "args": [
            "tb_vfinfo_list",
            "tb[IFLA_VFINFO_LIST]",
            "rem"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"FOUND IFLA_VFINFO_LIST!\""
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"error parsing request...\""
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_parse",
          "args": [
            "hdr",
            "sizeof(ifinfo)",
            "(struct nlattr **)&tb",
            "IFLA_MAX",
            "NULL"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"family:%#x type:%#x index:%d flags:%#x change:%#x\"",
            "ifinfo.ifi_family",
            "ifinfo.ifi_type",
            "ifinfo.ifi_index",
            "ifinfo.ifi_flags",
            "ifinfo.ifi_change"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ifinfo",
            "NLMSG_DATA(hdr)",
            "sizeof(ifinfo)"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_DATA",
          "args": [
            "hdr"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"        ifi_change = 0x%04x\"",
            "((struct ifinfomsg *)data)->ifi_change"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"        ifi_flags  = 0x%04x\"",
            "((struct ifinfomsg *)data)->ifi_flags"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"        ifi_index  = %i\"",
            "((struct ifinfomsg *)data)->ifi_index"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"        ifi_type   = 0x%x\"",
            "((struct ifinfomsg *)data)->ifi_type"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"        ifi_family = 0x%02x\"",
            "((struct ifinfomsg *)data)->ifi_family"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\" IFINFOMSG\""
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"lldpad pid  = %d\"",
            "lldpad_pid"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nlmsg_flags = 0x%04x\"",
            "hdr->nlmsg_flags"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nlmsg_seq   = 0x%08x\"",
            "hdr->nlmsg_seq"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nlmsg_pid   = %d\"",
            "hdr->nlmsg_pid"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nlmsg_len   = 0x%04x\"",
            "hdr->nlmsg_len"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"nlmsg_type  = 0x%02x\"",
            "hdr->nlmsg_type"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"netlink message nl_sockaddr: %p len: %d\"",
            "peer",
            "length"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virPidFileReadPath(VIRIP_PID_FILE, &virip_pid)"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPidFileReadPath",
          "args": [
            "VIRIP_PID_FILE",
            "&virip_pid"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "virPidFileReadPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpidfile.c",
          "lines": "105-145",
          "snippet": "int virPidFileReadPath(const char *path,\n                       pid_t *pid)\n{\n    int fd;\n    int rc;\n    ssize_t bytes;\n    long long pid_value = 0;\n    char pidstr[VIR_INT64_STR_BUFLEN];\n    char *endptr = NULL;\n\n    *pid = 0;\n\n    if ((fd = open(path, O_RDONLY)) < 0) {\n        rc = -errno;\n        goto cleanup;\n    }\n\n    bytes = saferead(fd, pidstr, sizeof(pidstr));\n    if (bytes < 0) {\n        rc = -errno;\n        VIR_FORCE_CLOSE(fd);\n        goto cleanup;\n    }\n    pidstr[bytes] = '\\0';\n\n    if (virStrToLong_ll(pidstr, &endptr, 10, &pid_value) < 0 ||\n        !(*endptr == '\\0' || g_ascii_isspace(*endptr)) ||\n        (pid_t) pid_value != pid_value) {\n        rc = -EINVAL;\n        goto cleanup;\n    }\n\n    *pid = pid_value;\n    rc = 0;\n\n cleanup:\n    if (VIR_CLOSE(fd) < 0)\n        rc = -errno;\n\n    return rc;\n}",
          "includes": [
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virpidfile.h\"",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virpidfile.h\"\n#include <sys/stat.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virPidFileReadPath(const char *path,\n                       pid_t *pid)\n{\n    int fd;\n    int rc;\n    ssize_t bytes;\n    long long pid_value = 0;\n    char pidstr[VIR_INT64_STR_BUFLEN];\n    char *endptr = NULL;\n\n    *pid = 0;\n\n    if ((fd = open(path, O_RDONLY)) < 0) {\n        rc = -errno;\n        goto cleanup;\n    }\n\n    bytes = saferead(fd, pidstr, sizeof(pidstr));\n    if (bytes < 0) {\n        rc = -errno;\n        VIR_FORCE_CLOSE(fd);\n        goto cleanup;\n    }\n    pidstr[bytes] = '\\0';\n\n    if (virStrToLong_ll(pidstr, &endptr, 10, &pid_value) < 0 ||\n        !(*endptr == '\\0' || g_ascii_isspace(*endptr)) ||\n        (pid_t) pid_value != pid_value) {\n        rc = -EINVAL;\n        goto cleanup;\n    }\n\n    *pid = pid_value;\n    rc = 0;\n\n cleanup:\n    if (VIR_CLOSE(fd) < 0)\n        rc = -errno;\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlmsg_data",
          "args": [
            "hdr"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic void\nvirNetDevMacVLanVPortProfileCallback(struct nlmsghdr *hdr,\n                                     unsigned int length,\n                                     struct sockaddr_nl *peer,\n                                     bool *handled,\n                                     void *opaque)\n{\n    struct nla_policy ifla_vf_policy[IFLA_VF_MAX + 1] = {\n        [IFLA_VF_MAC] = {.minlen = sizeof(struct ifla_vf_mac),\n                         .maxlen = sizeof(struct ifla_vf_mac)},\n        [IFLA_VF_VLAN] = {.minlen = sizeof(struct ifla_vf_vlan),\n                          .maxlen = sizeof(struct ifla_vf_vlan)},\n    };\n\n    struct nla_policy ifla_port_policy[IFLA_PORT_MAX + 1] = {\n        [IFLA_PORT_RESPONSE] = {.type = NLA_U16},\n    };\n\n    struct nlattr *tb[IFLA_MAX + 1], *tb3[IFLA_PORT_MAX + 1],\n        *tb_vfinfo[IFLA_VF_MAX + 1], *tb_vfinfo_list;\n\n    struct ifinfomsg ifinfo;\n    void *data;\n    int rem;\n    char *ifname;\n    bool indicate = false;\n    virNetlinkCallbackDataPtr calld = opaque;\n    pid_t lldpad_pid = 0;\n    pid_t virip_pid = 0;\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n\n    data = nlmsg_data(hdr);\n\n    /* Quickly decide if we want this or not */\n\n    if (virPidFileReadPath(LLDPAD_PID_FILE, &lldpad_pid) < 0)\n        return;\n\n    ignore_value(virPidFileReadPath(VIRIP_PID_FILE, &virip_pid));\n\n    if (hdr->nlmsg_pid != lldpad_pid && hdr->nlmsg_pid != virip_pid)\n        return; /* we only care for lldpad and virip messages */\n    if (hdr->nlmsg_type != RTM_SETLINK)\n        return; /* we only care for RTM_SETLINK */\n    if (*handled)\n        return; /* if it has been handled - dont handle again */\n\n    /* DEBUG start */\n    VIR_INFO(\"netlink message nl_sockaddr: %p len: %d\", peer, length);\n    VIR_DEBUG(\"nlmsg_type  = 0x%02x\", hdr->nlmsg_type);\n    VIR_DEBUG(\"nlmsg_len   = 0x%04x\", hdr->nlmsg_len);\n    VIR_DEBUG(\"nlmsg_pid   = %d\", hdr->nlmsg_pid);\n    VIR_DEBUG(\"nlmsg_seq   = 0x%08x\", hdr->nlmsg_seq);\n    VIR_DEBUG(\"nlmsg_flags = 0x%04x\", hdr->nlmsg_flags);\n\n    VIR_DEBUG(\"lldpad pid  = %d\", lldpad_pid);\n\n    switch (hdr->nlmsg_type) {\n    case RTM_NEWLINK:\n    case RTM_DELLINK:\n    case RTM_SETLINK:\n    case RTM_GETLINK:\n        VIR_DEBUG(\" IFINFOMSG\");\n        VIR_DEBUG(\"        ifi_family = 0x%02x\",\n                  ((struct ifinfomsg *)data)->ifi_family);\n        VIR_DEBUG(\"        ifi_type   = 0x%x\",\n                  ((struct ifinfomsg *)data)->ifi_type);\n        VIR_DEBUG(\"        ifi_index  = %i\",\n                  ((struct ifinfomsg *)data)->ifi_index);\n        VIR_DEBUG(\"        ifi_flags  = 0x%04x\",\n                  ((struct ifinfomsg *)data)->ifi_flags);\n        VIR_DEBUG(\"        ifi_change = 0x%04x\",\n                  ((struct ifinfomsg *)data)->ifi_change);\n    }\n    /* DEBUG end */\n\n    /* Parse netlink message assume a setlink with vfports */\n    memcpy(&ifinfo, NLMSG_DATA(hdr), sizeof(ifinfo));\n    VIR_DEBUG(\"family:%#x type:%#x index:%d flags:%#x change:%#x\",\n              ifinfo.ifi_family, ifinfo.ifi_type, ifinfo.ifi_index,\n              ifinfo.ifi_flags, ifinfo.ifi_change);\n    if (nlmsg_parse(hdr, sizeof(ifinfo),\n                    (struct nlattr **)&tb, IFLA_MAX, NULL)) {\n        VIR_DEBUG(\"error parsing request...\");\n        return;\n    }\n\n    if (tb[IFLA_VFINFO_LIST]) {\n        VIR_DEBUG(\"FOUND IFLA_VFINFO_LIST!\");\n\n        nla_for_each_nested(tb_vfinfo_list, tb[IFLA_VFINFO_LIST], rem) {\n            if (nla_type(tb_vfinfo_list) != IFLA_VF_INFO) {\n                VIR_DEBUG(\"nested parsing of\"\n                          \"IFLA_VFINFO_LIST failed.\");\n                return;\n            }\n            if (nla_parse_nested(tb_vfinfo, IFLA_VF_MAX,\n                                 tb_vfinfo_list, ifla_vf_policy)) {\n                VIR_DEBUG(\"nested parsing of \"\n                          \"IFLA_VF_INFO failed.\");\n                return;\n            }\n        }\n\n        if (tb_vfinfo[IFLA_VF_MAC]) {\n            struct ifla_vf_mac *mac = RTA_DATA(tb_vfinfo[IFLA_VF_MAC]);\n            unsigned char *m = mac->mac;\n\n            VIR_DEBUG(\"IFLA_VF_MAC = %2x:%2x:%2x:%2x:%2x:%2x\",\n                      m[0], m[1], m[2], m[3], m[4], m[5]);\n\n            if (virMacAddrCmpRaw(&calld->macaddress, mac->mac)) {\n                /* Repeat the same check for a broadcast mac */\n                size_t i;\n\n                for (i = 0; i < VIR_MAC_BUFLEN; i++) {\n                    if (calld->macaddress.addr[i] != 0xff) {\n                        VIR_DEBUG(\"MAC address match failed (wasn't broadcast)\");\n                        return;\n                    }\n                }\n            }\n        }\n\n        if (tb_vfinfo[IFLA_VF_VLAN]) {\n            struct ifla_vf_vlan *vlan = RTA_DATA(tb_vfinfo[IFLA_VF_VLAN]);\n\n            VIR_DEBUG(\"IFLA_VF_VLAN = %d\", vlan->vlan);\n        }\n    }\n\n    if (tb[IFLA_IFNAME]) {\n        ifname = (char *)RTA_DATA(tb[IFLA_IFNAME]);\n        VIR_DEBUG(\"IFLA_IFNAME = %s\", ifname);\n    }\n\n    if (tb[IFLA_OPERSTATE]) {\n        rem = *(unsigned short *)RTA_DATA(tb[IFLA_OPERSTATE]);\n        VIR_DEBUG(\"IFLA_OPERSTATE = %d\", rem);\n    }\n\n    if (tb[IFLA_VF_PORTS]) {\n        struct nlattr *tb_vf_ports;\n\n        VIR_DEBUG(\"found IFLA_VF_PORTS\");\n        nla_for_each_nested(tb_vf_ports, tb[IFLA_VF_PORTS], rem) {\n\n            VIR_DEBUG(\"iterating\");\n            if (nla_type(tb_vf_ports) != IFLA_VF_PORT) {\n                VIR_DEBUG(\"not a IFLA_VF_PORT. skipping\");\n                continue;\n            }\n            if (nla_parse_nested(tb3, IFLA_PORT_MAX, tb_vf_ports,\n                                 ifla_port_policy)) {\n                VIR_DEBUG(\"nested parsing on level 2\"\n                          \" failed.\");\n            }\n            if (tb3[IFLA_PORT_VF]) {\n                VIR_DEBUG(\"IFLA_PORT_VF = %d\",\n                          *(uint32_t *) (RTA_DATA(tb3[IFLA_PORT_VF])));\n            }\n            if (tb3[IFLA_PORT_PROFILE]) {\n                VIR_DEBUG(\"IFLA_PORT_PROFILE = %s\",\n                          (char *) RTA_DATA(tb3[IFLA_PORT_PROFILE]));\n            }\n\n            if (tb3[IFLA_PORT_VSI_TYPE]) {\n                struct ifla_port_vsi *pvsi;\n                int tid = 0;\n\n                pvsi = (struct ifla_port_vsi *)\n                    RTA_DATA(tb3[IFLA_PORT_VSI_TYPE]);\n                tid = ((pvsi->vsi_type_id[2] << 16) |\n                       (pvsi->vsi_type_id[1] << 8) |\n                       pvsi->vsi_type_id[0]);\n\n                VIR_DEBUG(\"mgr_id: %d\", pvsi->vsi_mgr_id);\n                VIR_DEBUG(\"type_id: %d\", tid);\n                VIR_DEBUG(\"type_version: %d\",\n                          pvsi->vsi_type_version);\n            }\n\n            if (tb3[IFLA_PORT_INSTANCE_UUID]) {\n                char instance[INSTANCE_STRLEN + 2];\n                unsigned char *uuid;\n\n                uuid = (unsigned char *)\n                    RTA_DATA(tb3[IFLA_PORT_INSTANCE_UUID]);\n                instance2str(uuid, instance, sizeof(instance));\n                VIR_DEBUG(\"IFLA_PORT_INSTANCE_UUID = %s\",\n                          instance);\n            }\n\n            if (tb3[IFLA_PORT_REQUEST]) {\n                uint8_t req = *(uint8_t *) RTA_DATA(tb3[IFLA_PORT_REQUEST]);\n                VIR_DEBUG(\"IFLA_PORT_REQUEST = %d\", req);\n\n                if (req == PORT_REQUEST_DISASSOCIATE) {\n                    VIR_DEBUG(\"Set disassociated.\");\n                    indicate = true;\n                }\n            }\n\n            if (tb3[IFLA_PORT_RESPONSE]) {\n                VIR_DEBUG(\"IFLA_PORT_RESPONSE = %d\",\n                          *(uint16_t *) RTA_DATA(tb3[IFLA_PORT_RESPONSE]));\n            }\n        }\n    }\n\n    if (!indicate)\n        return;\n\n    VIR_INFO(\"Re-send 802.1qbg associate request:\");\n    VIR_INFO(\"  if: %s\", calld->cr_ifname);\n    VIR_INFO(\"  lf: %s\", calld->linkdev);\n    VIR_INFO(\" mac: %s\", virMacAddrFormat(&calld->macaddress, macaddr));\n    ignore_value(virNetDevVPortProfileAssociate(calld->cr_ifname,\n                                                calld->virtPortProfile,\n                                                &calld->macaddress,\n                                                calld->linkdev,\n                                                calld->vf,\n                                                calld->vmuuid,\n                                                calld->vmOp, true));\n    *handled = true;\n    return;\n}"
  },
  {
    "function_name": "instance2str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "525-536",
    "snippet": "static int instance2str(const unsigned char *p, char *dst, size_t size)\n{\n    if (dst && size > INSTANCE_STRLEN) {\n        g_snprintf(dst, size, \"%02x%02x%02x%02x-%02x%02x-%02x%02x-\"\n                   \"%02x%02x-%02x%02x%02x%02x%02x%02x\",\n                   p[0], p[1], p[2], p[3],\n                   p[4], p[5], p[6], p[7],\n                   p[8], p[9], p[10], p[11], p[12], p[13], p[14], p[15]);\n        return 0;\n    }\n    return -1;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "dst",
            "size",
            "\"%02x%02x%02x%02x-%02x%02x-%02x%02x-\"\n                   \"%02x%02x-%02x%02x%02x%02x%02x%02x\"",
            "p[0]",
            "p[1]",
            "p[2]",
            "p[3]",
            "p[4]",
            "p[5]",
            "p[6]",
            "p[7]",
            "p[8]",
            "p[9]",
            "p[10]",
            "p[11]",
            "p[12]",
            "p[13]",
            "p[14]",
            "p[15]"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic int instance2str(const unsigned char *p, char *dst, size_t size)\n{\n    if (dst && size > INSTANCE_STRLEN) {\n        g_snprintf(dst, size, \"%02x%02x%02x%02x-%02x%02x-%02x%02x-\"\n                   \"%02x%02x-%02x%02x%02x%02x%02x%02x\",\n                   p[0], p[1], p[2], p[3],\n                   p[4], p[5], p[6], p[7],\n                   p[8], p[9], p[10], p[11], p[12], p[13], p[14], p[15]);\n        return 0;\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevMacVLanTapSetup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "444-499",
    "snippet": "int\nvirNetDevMacVLanTapSetup(int *tapfd, size_t tapfdSize, bool vnet_hdr)\n{\n    unsigned int features;\n    struct ifreq ifreq;\n    short new_flags = 0;\n    size_t i;\n\n    for (i = 0; i < tapfdSize; i++) {\n        memset(&ifreq, 0, sizeof(ifreq));\n\n        if (ioctl(tapfd[i], TUNGETIFF, &ifreq) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"cannot get interface flags on macvtap tap\"));\n            return -1;\n        }\n\n        new_flags = ifreq.ifr_flags;\n\n        if (vnet_hdr) {\n            if (ioctl(tapfd[i], TUNGETFEATURES, &features) < 0) {\n                virReportSystemError(errno, \"%s\",\n                                     _(\"cannot get feature flags on macvtap tap\"));\n                return -1;\n            }\n            if (features & IFF_VNET_HDR)\n                new_flags |= IFF_VNET_HDR;\n        } else {\n            new_flags &= ~IFF_VNET_HDR;\n        }\n\n# ifdef IFF_MULTI_QUEUE\n        if (tapfdSize > 1)\n            new_flags |= IFF_MULTI_QUEUE;\n        else\n            new_flags &= ~IFF_MULTI_QUEUE;\n# else\n        if (tapfdSize > 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Multiqueue devices are not supported on this system\"));\n            return -1;\n        }\n# endif\n\n        if (new_flags != ifreq.ifr_flags) {\n            ifreq.ifr_flags = new_flags;\n            if (ioctl(tapfd[i], TUNSETIFF, &ifreq) < 0) {\n                virReportSystemError(errno, \"%s\",\n                                     _(\"unable to set vnet or multiqueue flags on macvtap\"));\n                return -1;\n            }\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"unable to set vnet or multiqueue flags on macvtap\")"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unable to set vnet or multiqueue flags on macvtap\""
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "tapfd[i]",
            "TUNSETIFF",
            "&ifreq"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Multiqueue devices are not supported on this system\")"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"cannot get feature flags on macvtap tap\")"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"cannot get interface flags on macvtap tap\")"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ifreq",
            "0",
            "sizeof(ifreq)"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanTapSetup(int *tapfd, size_t tapfdSize, bool vnet_hdr)\n{\n    unsigned int features;\n    struct ifreq ifreq;\n    short new_flags = 0;\n    size_t i;\n\n    for (i = 0; i < tapfdSize; i++) {\n        memset(&ifreq, 0, sizeof(ifreq));\n\n        if (ioctl(tapfd[i], TUNGETIFF, &ifreq) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"cannot get interface flags on macvtap tap\"));\n            return -1;\n        }\n\n        new_flags = ifreq.ifr_flags;\n\n        if (vnet_hdr) {\n            if (ioctl(tapfd[i], TUNGETFEATURES, &features) < 0) {\n                virReportSystemError(errno, \"%s\",\n                                     _(\"cannot get feature flags on macvtap tap\"));\n                return -1;\n            }\n            if (features & IFF_VNET_HDR)\n                new_flags |= IFF_VNET_HDR;\n        } else {\n            new_flags &= ~IFF_VNET_HDR;\n        }\n\n# ifdef IFF_MULTI_QUEUE\n        if (tapfdSize > 1)\n            new_flags |= IFF_MULTI_QUEUE;\n        else\n            new_flags &= ~IFF_MULTI_QUEUE;\n# else\n        if (tapfdSize > 1) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Multiqueue devices are not supported on this system\"));\n            return -1;\n        }\n# endif\n\n        if (new_flags != ifreq.ifr_flags) {\n            ifreq.ifr_flags = new_flags;\n            if (ioctl(tapfd[i], TUNSETIFF, &ifreq) < 0) {\n                virReportSystemError(errno, \"%s\",\n                                     _(\"unable to set vnet or multiqueue flags on macvtap\"));\n                return -1;\n            }\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevMacVLanTapOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "380-423",
    "snippet": "int\nvirNetDevMacVLanTapOpen(const char *ifname,\n                        int *tapfd,\n                        size_t tapfdSize)\n{\n    int retries = 10;\n    int ret = -1;\n    int ifindex;\n    size_t i = 0;\n    g_autofree char *tapname = NULL;\n\n    if (virNetDevGetIndex(ifname, &ifindex) < 0)\n        return -1;\n\n    tapname = g_strdup_printf(\"/dev/tap%d\", ifindex);\n\n    for (i = 0; i < tapfdSize; i++) {\n        int fd = -1;\n\n        while (fd < 0) {\n            if ((fd = open(tapname, O_RDWR)) >= 0) {\n                tapfd[i] = fd;\n            } else if (retries-- > 0) {\n                /* may need to wait for udev to be done */\n                g_usleep(20000);\n            } else {\n                /* However, if haven't succeeded, quit. */\n                virReportSystemError(errno,\n                                     _(\"cannot open macvtap tap device %s\"),\n                                     tapname);\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        while (i--)\n            VIR_FORCE_CLOSE(tapfd[i]);\n    }\n    return ret;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "tapfd[i]"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot open macvtap tap device %s\")",
            "tapname"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot open macvtap tap device %s\""
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_usleep",
          "args": [
            "20000"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "tapname",
            "O_RDWR"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetIndex",
          "args": [
            "ifname",
            "&ifindex"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "893-899",
          "snippet": "int virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanTapOpen(const char *ifname,\n                        int *tapfd,\n                        size_t tapfdSize)\n{\n    int retries = 10;\n    int ret = -1;\n    int ifindex;\n    size_t i = 0;\n    g_autofree char *tapname = NULL;\n\n    if (virNetDevGetIndex(ifname, &ifindex) < 0)\n        return -1;\n\n    tapname = g_strdup_printf(\"/dev/tap%d\", ifindex);\n\n    for (i = 0; i < tapfdSize; i++) {\n        int fd = -1;\n\n        while (fd < 0) {\n            if ((fd = open(tapname, O_RDWR)) >= 0) {\n                tapfd[i] = fd;\n            } else if (retries-- > 0) {\n                /* may need to wait for udev to be done */\n                g_usleep(20000);\n            } else {\n                /* However, if haven't succeeded, quit. */\n                virReportSystemError(errno,\n                                     _(\"cannot open macvtap tap device %s\"),\n                                     tapname);\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        while (i--)\n            VIR_FORCE_CLOSE(tapfd[i]);\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevMacVLanDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "364-367",
    "snippet": "int virNetDevMacVLanDelete(const char *ifname)\n{\n    return virNetlinkDelLink(ifname, NULL);\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetlinkDelLink",
          "args": [
            "ifname",
            "NULL"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkDelLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1275-1281",
          "snippet": "int\nvirNetlinkDelLink(const char *ifname G_GNUC_UNUSED,\n                  virNetlinkDelLinkFallback fallback G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetlinkDelLink(const char *ifname G_GNUC_UNUSED,\n                  virNetlinkDelLinkFallback fallback G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanDelete(const char *ifname)\n{\n    return virNetlinkDelLink(ifname, NULL);\n}"
  },
  {
    "function_name": "virNetDevMacVLanCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "318-353",
    "snippet": "int\nvirNetDevMacVLanCreate(const char *ifname,\n                       const char *type,\n                       const virMacAddr *macaddress,\n                       const char *srcdev,\n                       uint32_t macvlan_mode,\n                       int *retry)\n{\n    int error = 0;\n    int ifindex = 0;\n    virNetlinkNewLinkData data = {\n        .macvlan_mode = &macvlan_mode,\n        .mac = macaddress,\n    };\n\n    *retry = 0;\n\n    if (virNetDevGetIndex(srcdev, &ifindex) < 0)\n        return -1;\n\n    data.ifindex = &ifindex;\n    if (virNetlinkNewLink(ifname, type, &data, &error) < 0) {\n        char macstr[VIR_MAC_STRING_BUFLEN];\n        if (error == -EEXIST)\n            *retry = 1;\n        else if (error < 0)\n            virReportSystemError(-error,\n                                 _(\"error creating %s interface %s@%s (%s)\"),\n                                 type, ifname, srcdev,\n                                 virMacAddrFormat(macaddress, macstr));\n\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "-error",
            "_(\"error creating %s interface %s@%s (%s)\")",
            "type",
            "ifname",
            "srcdev",
            "virMacAddrFormat(macaddress, macstr)"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "virReportSystemErrorFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1322-1360",
          "snippet": "void virReportSystemErrorFull(int domcode,\n                              int theerrno,\n                              const char *filename,\n                              const char *funcname,\n                              size_t linenr,\n                              const char *fmt, ...)\n{\n    int save_errno = errno;\n    char msgDetailBuf[VIR_ERROR_MAX_LENGTH];\n\n    const char *errnoDetail = g_strerror(theerrno);\n    const char *msg = virErrorMsg(VIR_ERR_SYSTEM_ERROR, fmt);\n    const char *msgDetail = NULL;\n\n    if (fmt) {\n        va_list args;\n        int n;\n\n        va_start(args, fmt);\n        n = g_vsnprintf(msgDetailBuf, sizeof(msgDetailBuf), fmt, args);\n        va_end(args);\n\n        size_t len = strlen(errnoDetail);\n        if (0 <= n && n + 2 + len < sizeof(msgDetailBuf)) {\n          strcpy(msgDetailBuf + n, \": \");\n          n += 2;\n          strcpy(msgDetailBuf + n, errnoDetail);\n          msgDetail = msgDetailBuf;\n        }\n    }\n\n    if (!msgDetail)\n        msgDetail = errnoDetail;\n\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, VIR_ERR_SYSTEM_ERROR, VIR_ERR_ERROR,\n                      msg, msgDetail, NULL, theerrno, -1, msg, msgDetail);\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virReportSystemErrorFull(int domcode,\n                              int theerrno,\n                              const char *filename,\n                              const char *funcname,\n                              size_t linenr,\n                              const char *fmt, ...)\n{\n    int save_errno = errno;\n    char msgDetailBuf[VIR_ERROR_MAX_LENGTH];\n\n    const char *errnoDetail = g_strerror(theerrno);\n    const char *msg = virErrorMsg(VIR_ERR_SYSTEM_ERROR, fmt);\n    const char *msgDetail = NULL;\n\n    if (fmt) {\n        va_list args;\n        int n;\n\n        va_start(args, fmt);\n        n = g_vsnprintf(msgDetailBuf, sizeof(msgDetailBuf), fmt, args);\n        va_end(args);\n\n        size_t len = strlen(errnoDetail);\n        if (0 <= n && n + 2 + len < sizeof(msgDetailBuf)) {\n          strcpy(msgDetailBuf + n, \": \");\n          n += 2;\n          strcpy(msgDetailBuf + n, errnoDetail);\n          msgDetail = msgDetailBuf;\n        }\n    }\n\n    if (!msgDetail)\n        msgDetail = errnoDetail;\n\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, VIR_ERR_SYSTEM_ERROR, VIR_ERR_ERROR,\n                      msg, msgDetail, NULL, theerrno, -1, msg, msgDetail);\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "macaddress",
            "macstr"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"error creating %s interface %s@%s (%s)\""
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetlinkNewLink",
          "args": [
            "ifname",
            "type",
            "&data",
            "&error"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkNewLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1284-1292",
          "snippet": "int\nvirNetlinkNewLink(const char *ifname G_GNUC_UNUSED,\n                  const char *type G_GNUC_UNUSED,\n                  virNetlinkNewLinkDataPtr extra_args G_GNUC_UNUSED,\n                  int *error G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetlinkNewLink(const char *ifname G_GNUC_UNUSED,\n                  const char *type G_GNUC_UNUSED,\n                  virNetlinkNewLinkDataPtr extra_args G_GNUC_UNUSED,\n                  int *error G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetIndex",
          "args": [
            "srcdev",
            "&ifindex"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "893-899",
          "snippet": "int virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanCreate(const char *ifname,\n                       const char *type,\n                       const virMacAddr *macaddress,\n                       const char *srcdev,\n                       uint32_t macvlan_mode,\n                       int *retry)\n{\n    int error = 0;\n    int ifindex = 0;\n    virNetlinkNewLinkData data = {\n        .macvlan_mode = &macvlan_mode,\n        .mac = macaddress,\n    };\n\n    *retry = 0;\n\n    if (virNetDevGetIndex(srcdev, &ifindex) < 0)\n        return -1;\n\n    data.ifindex = &ifindex;\n    if (virNetlinkNewLink(ifname, type, &data, &error) < 0) {\n        char macstr[VIR_MAC_STRING_BUFLEN];\n        if (error == -EEXIST)\n            *retry = 1;\n        else if (error < 0)\n            virReportSystemError(-error,\n                                 _(\"error creating %s interface %s@%s (%s)\"),\n                                 type, ifname, srcdev,\n                                 virMacAddrFormat(macaddress, macstr));\n\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevMacVLanIsMacvtap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "287-299",
    "snippet": "bool\nvirNetDevMacVLanIsMacvtap(const char *ifname)\n{\n    int ifindex;\n    g_autofree char *tapname = NULL;\n\n    if (virNetDevGetIndex(ifname, &ifindex) < 0)\n        return false;\n\n    tapname = g_strdup_printf(\"/dev/tap%d\", ifindex);\n\n    return virFileExists(tapname);\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "tapname"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/dev/tap%d\"",
            "ifindex"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetIndex",
          "args": [
            "ifname",
            "&ifindex"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "893-899",
          "snippet": "int virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nbool\nvirNetDevMacVLanIsMacvtap(const char *ifname)\n{\n    int ifindex;\n    g_autofree char *tapname = NULL;\n\n    if (virNetDevGetIndex(ifname, &ifindex) < 0)\n        return false;\n\n    tapname = g_strdup_printf(\"/dev/tap%d\", ifindex);\n\n    return virFileExists(tapname);\n}"
  },
  {
    "function_name": "virNetDevMacVLanReleaseName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "251-277",
    "snippet": "int\nvirNetDevMacVLanReleaseName(const char *name)\n{\n    unsigned int id;\n    unsigned int flags = 0;\n    const char *idstr = NULL;\n\n    if (virNetDevMacVLanInitialize() < 0)\n       return -1;\n\n    if (STRPREFIX(name, VIR_NET_GENERATED_MACVTAP_PREFIX)) {\n        idstr = name + strlen(VIR_NET_GENERATED_MACVTAP_PREFIX);\n        flags |= VIR_NETDEV_MACVLAN_CREATE_WITH_TAP;\n    } else if (STRPREFIX(name, VIR_NET_GENERATED_MACVLAN_PREFIX)) {\n        idstr = name + strlen(VIR_NET_GENERATED_MACVLAN_PREFIX);\n    } else {\n        return 0;\n    }\n\n    if (virStrToLong_ui(idstr, NULL, 10, &id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't get id value from macvtap device name %s\"),\n                       name);\n        return -1;\n    }\n    return virNetDevMacVLanReleaseID(id, flags);\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevMacVLanReleaseID",
          "args": [
            "id",
            "flags"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanReleaseID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "163-195",
          "snippet": "static int\nvirNetDevMacVLanReleaseID(int id, unsigned int flags)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n        return 0;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't free name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if (id < 0)\n        return 0;\n\n    VIR_INFO(\"releasing %sdevice %s%d\",\n             virBitmapIsBitSet(bitmap, id) ? \"\" : \"unreserved\",\n             VIR_NET_GENERATED_PREFIX, id);\n\n    if (virBitmapClearBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as unused\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic int\nvirNetDevMacVLanReleaseID(int id, unsigned int flags)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n        return 0;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't free name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if (id < 0)\n        return 0;\n\n    VIR_INFO(\"releasing %sdevice %s%d\",\n             virBitmapIsBitSet(bitmap, id) ? \"\" : \"unreserved\",\n             VIR_NET_GENERATED_PREFIX, id);\n\n    if (virBitmapClearBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as unused\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"couldn't get id value from macvtap device name %s\")",
            "name"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"couldn't get id value from macvtap device name %s\""
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "idstr",
            "NULL",
            "10",
            "&id"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "VIR_NET_GENERATED_MACVLAN_PREFIX"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "name",
            "VIR_NET_GENERATED_MACVLAN_PREFIX"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "VIR_NET_GENERATED_MACVTAP_PREFIX"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "name",
            "VIR_NET_GENERATED_MACVTAP_PREFIX"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanInitialize",
          "args": [],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanReleaseName(const char *name)\n{\n    unsigned int id;\n    unsigned int flags = 0;\n    const char *idstr = NULL;\n\n    if (virNetDevMacVLanInitialize() < 0)\n       return -1;\n\n    if (STRPREFIX(name, VIR_NET_GENERATED_MACVTAP_PREFIX)) {\n        idstr = name + strlen(VIR_NET_GENERATED_MACVTAP_PREFIX);\n        flags |= VIR_NETDEV_MACVLAN_CREATE_WITH_TAP;\n    } else if (STRPREFIX(name, VIR_NET_GENERATED_MACVLAN_PREFIX)) {\n        idstr = name + strlen(VIR_NET_GENERATED_MACVLAN_PREFIX);\n    } else {\n        return 0;\n    }\n\n    if (virStrToLong_ui(idstr, NULL, 10, &id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't get id value from macvtap device name %s\"),\n                       name);\n        return -1;\n    }\n    return virNetDevMacVLanReleaseID(id, flags);\n}"
  },
  {
    "function_name": "virNetDevMacVLanReserveName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "211-237",
    "snippet": "int\nvirNetDevMacVLanReserveName(const char *name, bool quietFail)\n{\n    unsigned int id;\n    unsigned int flags = 0;\n    const char *idstr = NULL;\n\n    if (virNetDevMacVLanInitialize() < 0)\n       return -1;\n\n    if (STRPREFIX(name, VIR_NET_GENERATED_MACVTAP_PREFIX)) {\n        idstr = name + strlen(VIR_NET_GENERATED_MACVTAP_PREFIX);\n        flags |= VIR_NETDEV_MACVLAN_CREATE_WITH_TAP;\n    } else if (STRPREFIX(name, VIR_NET_GENERATED_MACVLAN_PREFIX)) {\n        idstr = name + strlen(VIR_NET_GENERATED_MACVLAN_PREFIX);\n    } else {\n        return -2;\n    }\n\n    if (virStrToLong_ui(idstr, NULL, 10, &id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't get id value from macvtap device name %s\"),\n                       name);\n        return -1;\n    }\n    return virNetDevMacVLanReserveID(id, flags, quietFail, false);\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevMacVLanReserveID",
          "args": [
            "id",
            "flags",
            "quietFail",
            "false"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanReserveID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "106-154",
          "snippet": "static int\nvirNetDevMacVLanReserveID(int id, unsigned int flags,\n                          bool quietFail, bool nextFree)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n       return -1;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't use name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if ((id < 0 || nextFree) &&\n        (id = virBitmapNextClearBit(bitmap, id)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"no unused %s names available\"),\n                       VIR_NET_GENERATED_PREFIX);\n        return -1;\n    }\n\n    if (virBitmapIsBitSet(bitmap, id)) {\n        if (quietFail) {\n            VIR_INFO(\"couldn't reserve name %s%d - already in use\",\n                     VIR_NET_GENERATED_PREFIX, id);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"couldn't reserve name %s%d - already in use\"),\n                           VIR_NET_GENERATED_PREFIX, id);\n        }\n        return -1;\n    }\n\n    if (virBitmapSetBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as used\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n\n    VIR_INFO(\"reserving device %s%d\", VIR_NET_GENERATED_PREFIX, id);\n    return id;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic int\nvirNetDevMacVLanReserveID(int id, unsigned int flags,\n                          bool quietFail, bool nextFree)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n       return -1;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't use name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if ((id < 0 || nextFree) &&\n        (id = virBitmapNextClearBit(bitmap, id)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"no unused %s names available\"),\n                       VIR_NET_GENERATED_PREFIX);\n        return -1;\n    }\n\n    if (virBitmapIsBitSet(bitmap, id)) {\n        if (quietFail) {\n            VIR_INFO(\"couldn't reserve name %s%d - already in use\",\n                     VIR_NET_GENERATED_PREFIX, id);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"couldn't reserve name %s%d - already in use\"),\n                           VIR_NET_GENERATED_PREFIX, id);\n        }\n        return -1;\n    }\n\n    if (virBitmapSetBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as used\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n\n    VIR_INFO(\"reserving device %s%d\", VIR_NET_GENERATED_PREFIX, id);\n    return id;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"couldn't get id value from macvtap device name %s\")",
            "name"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"couldn't get id value from macvtap device name %s\""
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "idstr",
            "NULL",
            "10",
            "&id"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "VIR_NET_GENERATED_MACVLAN_PREFIX"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "name",
            "VIR_NET_GENERATED_MACVLAN_PREFIX"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "VIR_NET_GENERATED_MACVTAP_PREFIX"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "name",
            "VIR_NET_GENERATED_MACVTAP_PREFIX"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanInitialize",
          "args": [],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanReserveName(const char *name, bool quietFail)\n{\n    unsigned int id;\n    unsigned int flags = 0;\n    const char *idstr = NULL;\n\n    if (virNetDevMacVLanInitialize() < 0)\n       return -1;\n\n    if (STRPREFIX(name, VIR_NET_GENERATED_MACVTAP_PREFIX)) {\n        idstr = name + strlen(VIR_NET_GENERATED_MACVTAP_PREFIX);\n        flags |= VIR_NETDEV_MACVLAN_CREATE_WITH_TAP;\n    } else if (STRPREFIX(name, VIR_NET_GENERATED_MACVLAN_PREFIX)) {\n        idstr = name + strlen(VIR_NET_GENERATED_MACVLAN_PREFIX);\n    } else {\n        return -2;\n    }\n\n    if (virStrToLong_ui(idstr, NULL, 10, &id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't get id value from macvtap device name %s\"),\n                       name);\n        return -1;\n    }\n    return virNetDevMacVLanReserveID(id, flags, quietFail, false);\n}"
  },
  {
    "function_name": "virNetDevMacVLanReleaseID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "163-195",
    "snippet": "static int\nvirNetDevMacVLanReleaseID(int id, unsigned int flags)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n        return 0;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't free name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if (id < 0)\n        return 0;\n\n    VIR_INFO(\"releasing %sdevice %s%d\",\n             virBitmapIsBitSet(bitmap, id) ? \"\" : \"unreserved\",\n             VIR_NET_GENERATED_PREFIX, id);\n\n    if (virBitmapClearBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as unused\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"couldn't mark %s%d as unused\")",
            "VIR_NET_GENERATED_PREFIX",
            "id"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"couldn't mark %s%d as unused\""
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapClearBit",
          "args": [
            "bitmap",
            "id"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapClearBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "265-277",
          "snippet": "int\nvirBitmapClearBitExpand(virBitmapPtr bitmap,\n                        size_t b)\n{\n    if (bitmap->nbits <= b) {\n        if (virBitmapExpand(bitmap, b) < 0)\n            return -1;\n    } else {\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapClearBitExpand(virBitmapPtr bitmap,\n                        size_t b)\n{\n    if (bitmap->nbits <= b) {\n        if (virBitmapExpand(bitmap, b) < 0)\n            return -1;\n    } else {\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"releasing %sdevice %s%d\"",
            "virBitmapIsBitSet(bitmap, id) ? \"\" : \"unreserved\"",
            "VIR_NET_GENERATED_PREFIX",
            "id"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapIsBitSet",
          "args": [
            "bitmap",
            "id"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsBitSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "298-306",
          "snippet": "bool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"can't free name %s%d - out of range 0-%d\")",
            "VIR_NET_GENERATED_PREFIX",
            "id",
            "MACVLAN_MAX_ID"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanInitialize",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic int\nvirNetDevMacVLanReleaseID(int id, unsigned int flags)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n        return 0;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't free name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if (id < 0)\n        return 0;\n\n    VIR_INFO(\"releasing %sdevice %s%d\",\n             virBitmapIsBitSet(bitmap, id) ? \"\" : \"unreserved\",\n             VIR_NET_GENERATED_PREFIX, id);\n\n    if (virBitmapClearBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as unused\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevMacVLanReserveID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "106-154",
    "snippet": "static int\nvirNetDevMacVLanReserveID(int id, unsigned int flags,\n                          bool quietFail, bool nextFree)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n       return -1;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't use name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if ((id < 0 || nextFree) &&\n        (id = virBitmapNextClearBit(bitmap, id)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"no unused %s names available\"),\n                       VIR_NET_GENERATED_PREFIX);\n        return -1;\n    }\n\n    if (virBitmapIsBitSet(bitmap, id)) {\n        if (quietFail) {\n            VIR_INFO(\"couldn't reserve name %s%d - already in use\",\n                     VIR_NET_GENERATED_PREFIX, id);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"couldn't reserve name %s%d - already in use\"),\n                           VIR_NET_GENERATED_PREFIX, id);\n        }\n        return -1;\n    }\n\n    if (virBitmapSetBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as used\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n\n    VIR_INFO(\"reserving device %s%d\", VIR_NET_GENERATED_PREFIX, id);\n    return id;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"reserving device %s%d\"",
            "VIR_NET_GENERATED_PREFIX",
            "id"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"couldn't mark %s%d as used\")",
            "VIR_NET_GENERATED_PREFIX",
            "id"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"couldn't mark %s%d as used\""
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "bitmap",
            "id"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"couldn't reserve name %s%d - already in use\")",
            "VIR_NET_GENERATED_PREFIX",
            "id"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"couldn't reserve name %s%d - already in use\"",
            "VIR_NET_GENERATED_PREFIX",
            "id"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapIsBitSet",
          "args": [
            "bitmap",
            "id"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsBitSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "298-306",
          "snippet": "bool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"no unused %s names available\")",
            "VIR_NET_GENERATED_PREFIX"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapNextClearBit",
          "args": [
            "bitmap",
            "id"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNextClearBit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1078-1113",
          "snippet": "ssize_t\nvirBitmapNextClearBit(virBitmapPtr bitmap,\n                      ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = ~bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = ~bitmap->map[nl];\n\n    if (nl == bitmap->map_len - 1) {\n        /* Ensure tail bits are ignored.  */\n        int tail = bitmap->nbits % VIR_BITMAP_BITS_PER_UNIT;\n\n        if (tail)\n            bits &= -1UL >> (VIR_BITMAP_BITS_PER_UNIT - tail);\n    }\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nssize_t\nvirBitmapNextClearBit(virBitmapPtr bitmap,\n                      ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = ~bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = ~bitmap->map[nl];\n\n    if (nl == bitmap->map_len - 1) {\n        /* Ensure tail bits are ignored.  */\n        int tail = bitmap->nbits % VIR_BITMAP_BITS_PER_UNIT;\n\n        if (tail)\n            bits &= -1UL >> (VIR_BITMAP_BITS_PER_UNIT - tail);\n    }\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"can't use name %s%d - out of range 0-%d\")",
            "VIR_NET_GENERATED_PREFIX",
            "id",
            "MACVLAN_MAX_ID"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanInitialize",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic int\nvirNetDevMacVLanReserveID(int id, unsigned int flags,\n                          bool quietFail, bool nextFree)\n{\n    virBitmapPtr bitmap;\n\n    if (virNetDevMacVLanInitialize() < 0)\n       return -1;\n\n    bitmap = (flags & VIR_NETDEV_MACVLAN_CREATE_WITH_TAP) ?\n        macvtapIDs :  macvlanIDs;\n\n    if (id > MACVLAN_MAX_ID) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"can't use name %s%d - out of range 0-%d\"),\n                       VIR_NET_GENERATED_PREFIX, id, MACVLAN_MAX_ID);\n        return -1;\n    }\n\n    if ((id < 0 || nextFree) &&\n        (id = virBitmapNextClearBit(bitmap, id)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"no unused %s names available\"),\n                       VIR_NET_GENERATED_PREFIX);\n        return -1;\n    }\n\n    if (virBitmapIsBitSet(bitmap, id)) {\n        if (quietFail) {\n            VIR_INFO(\"couldn't reserve name %s%d - already in use\",\n                     VIR_NET_GENERATED_PREFIX, id);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"couldn't reserve name %s%d - already in use\"),\n                           VIR_NET_GENERATED_PREFIX, id);\n        }\n        return -1;\n    }\n\n    if (virBitmapSetBit(bitmap, id) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't mark %s%d as used\"),\n                       VIR_NET_GENERATED_PREFIX, id);\n        return -1;\n    }\n\n    VIR_INFO(\"reserving device %s%d\", VIR_NET_GENERATED_PREFIX, id);\n    return id;\n}"
  },
  {
    "function_name": "virNetDevMacVLanOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
    "lines": "78-88",
    "snippet": "static int\nvirNetDevMacVLanOnceInit(void)\n{\n    if (!macvtapIDs &&\n        !(macvtapIDs = virBitmapNew(MACVLAN_MAX_ID + 1)))\n        return -1;\n    if (!macvlanIDs &&\n        !(macvlanIDs = virBitmapNew(MACVLAN_MAX_ID + 1)))\n        return -1;\n    return 0;\n}",
    "includes": [
      "# include \"virsocket.h\"",
      "# include \"virbitmap.h\"",
      "# include \"virpidfile.h\"",
      "# include \"virnetdev.h\"",
      "# include \"virnetlink.h\"",
      "# include \"virfile.h\"",
      "# include \"viruuid.h\"",
      "# include \"virlog.h\"",
      "# include \"viralloc.h\"",
      "# include <linux/if_tun.h>",
      "# include <net/if.h>",
      "# include <fcntl.h>",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virerror.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "MACVLAN_MAX_ID + 1"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nstatic int\nvirNetDevMacVLanOnceInit(void)\n{\n    if (!macvtapIDs &&\n        !(macvtapIDs = virBitmapNew(MACVLAN_MAX_ID + 1)))\n        return -1;\n    if (!macvlanIDs &&\n        !(macvlanIDs = virBitmapNew(MACVLAN_MAX_ID + 1)))\n        return -1;\n    return 0;\n}"
  }
]