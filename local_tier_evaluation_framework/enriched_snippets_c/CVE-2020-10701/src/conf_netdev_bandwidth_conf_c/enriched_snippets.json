[
  {
    "function_name": "virNetDevBandwidthSupportsFloor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
    "lines": "332-349",
    "snippet": "bool virNetDevBandwidthSupportsFloor(virNetworkForwardType type)\n{\n    switch (type) {\n    case VIR_NETWORK_FORWARD_NONE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_OPEN:\n        return true;\n    case VIR_NETWORK_FORWARD_BRIDGE:\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n    case VIR_NETWORK_FORWARD_LAST:\n        break;\n    }\n    return false;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nbool virNetDevBandwidthSupportsFloor(virNetworkForwardType type)\n{\n    switch (type) {\n    case VIR_NETWORK_FORWARD_NONE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_OPEN:\n        return true;\n    case VIR_NETWORK_FORWARD_BRIDGE:\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n    case VIR_NETWORK_FORWARD_LAST:\n        break;\n    }\n    return false;\n}"
  },
  {
    "function_name": "virNetDevBandwidthHasFloor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
    "lines": "325-329",
    "snippet": "bool\nvirNetDevBandwidthHasFloor(const virNetDevBandwidth *b)\n{\n    return b && b->in && b->in->floor != 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nbool\nvirNetDevBandwidthHasFloor(const virNetDevBandwidth *b)\n{\n    return b && b->in && b->in->floor != 0;\n}"
  },
  {
    "function_name": "virNetDevSupportsBandwidth",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
    "lines": "302-322",
    "snippet": "bool virNetDevSupportsBandwidth(virDomainNetType type)\n{\n    switch ((virDomainNetType) type) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nbool virNetDevSupportsBandwidth(virDomainNetType type)\n{\n    switch ((virDomainNetType) type) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}"
  },
  {
    "function_name": "virDomainClearNetBandwidth",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
    "lines": "287-299",
    "snippet": "void\nvirDomainClearNetBandwidth(virDomainDefPtr def)\n{\n    size_t i;\n    virDomainNetType type;\n\n    for (i = 0; i < def->nnets; i++) {\n        type = virDomainNetGetActualType(def->nets[i]);\n        if (virDomainNetGetActualBandwidth(def->nets[i]) &&\n            virNetDevSupportsBandwidth(type))\n            virNetDevBandwidthClear(def->nets[i]->ifname);\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBandwidthClear",
          "args": [
            "def->nets[i]->ifname"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBandwidthClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbandwidth.c",
          "lines": "404-431",
          "snippet": "int\nvirNetDevBandwidthClear(const char *ifname)\n{\n    int ret = 0;\n    int dummy; /* for ignoring the exit status */\n    virCommandPtr cmd = NULL;\n\n    if (!ifname)\n       return 0;\n\n    cmd = virCommandNew(TC);\n    virCommandAddArgList(cmd, \"qdisc\", \"del\", \"dev\", ifname, \"root\", NULL);\n\n    if (virCommandRun(cmd, &dummy) < 0)\n        ret = -1;\n\n    virCommandFree(cmd);\n\n    cmd = virCommandNew(TC);\n    virCommandAddArgList(cmd, \"qdisc\",  \"del\", \"dev\", ifname, \"ingress\", NULL);\n\n    if (virCommandRun(cmd, &dummy) < 0)\n        ret = -1;\n\n    virCommandFree(cmd);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virnetdevbandwidth.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetDevBandwidthClear(const char *ifname)\n{\n    int ret = 0;\n    int dummy; /* for ignoring the exit status */\n    virCommandPtr cmd = NULL;\n\n    if (!ifname)\n       return 0;\n\n    cmd = virCommandNew(TC);\n    virCommandAddArgList(cmd, \"qdisc\", \"del\", \"dev\", ifname, \"root\", NULL);\n\n    if (virCommandRun(cmd, &dummy) < 0)\n        ret = -1;\n\n    virCommandFree(cmd);\n\n    cmd = virCommandNew(TC);\n    virCommandAddArgList(cmd, \"qdisc\",  \"del\", \"dev\", ifname, \"ingress\", NULL);\n\n    if (virCommandRun(cmd, &dummy) < 0)\n        ret = -1;\n\n    virCommandFree(cmd);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSupportsBandwidth",
          "args": [
            "type"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSupportsBandwidth",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
          "lines": "302-322",
          "snippet": "bool virNetDevSupportsBandwidth(virDomainNetType type)\n{\n    switch ((virDomainNetType) type) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nbool virNetDevSupportsBandwidth(virDomainNetType type)\n{\n    switch ((virDomainNetType) type) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualBandwidth",
          "args": [
            "def->nets[i]"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualBandwidth",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30257-30267",
          "snippet": "const virNetDevBandwidth *\nvirDomainNetGetActualBandwidth(const virDomainNetDef *iface)\n{\n    /* if there is an ActualNetDef, *always* return\n     * its bandwidth rather than the NetDef's bandwidth.\n     */\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual)\n        return iface->data.network.actual->bandwidth;\n    return iface->bandwidth;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst virNetDevBandwidth *\nvirDomainNetGetActualBandwidth(const virDomainNetDef *iface)\n{\n    /* if there is an ActualNetDef, *always* return\n     * its bandwidth rather than the NetDef's bandwidth.\n     */\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual)\n        return iface->data.network.actual->bandwidth;\n    return iface->bandwidth;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualType",
          "args": [
            "def->nets[i]"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30154-30162",
          "snippet": "virDomainNetType\nvirDomainNetGetActualType(const virDomainNetDef *iface)\n{\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n    if (!iface->data.network.actual)\n        return iface->type;\n    return iface->data.network.actual->type;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainNetType\nvirDomainNetGetActualType(const virDomainNetDef *iface)\n{\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n    if (!iface->data.network.actual)\n        return iface->type;\n    return iface->data.network.actual->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nvoid\nvirDomainClearNetBandwidth(virDomainDefPtr def)\n{\n    size_t i;\n    virDomainNetType type;\n\n    for (i = 0; i < def->nnets; i++) {\n        type = virDomainNetGetActualType(def->nets[i]);\n        if (virDomainNetGetActualBandwidth(def->nets[i]) &&\n            virNetDevSupportsBandwidth(type))\n            virNetDevBandwidthClear(def->nets[i]->ifname);\n    }\n}"
  },
  {
    "function_name": "virNetDevBandwidthFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
    "lines": "262-285",
    "snippet": "int\nvirNetDevBandwidthFormat(const virNetDevBandwidth *def,\n                         unsigned int class_id,\n                         virBufferPtr buf)\n{\n    if (!buf)\n        return -1;\n\n    if (!def)\n        return 0;\n\n    virBufferAddLit(buf, \"<bandwidth\");\n    if (class_id)\n        virBufferAsprintf(buf, \" classID='%u'\", class_id);\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n    if (virNetDevBandwidthRateFormat(def->in, buf, \"inbound\") < 0 ||\n        virNetDevBandwidthRateFormat(def->out, buf, \"outbound\") < 0)\n        return -1;\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</bandwidth>\\n\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</bandwidth>\\n\""
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevBandwidthRateFormat",
          "args": [
            "def->out",
            "buf",
            "\"outbound\""
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBandwidthRateFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
          "lines": "221-249",
          "snippet": "static int\nvirNetDevBandwidthRateFormat(virNetDevBandwidthRatePtr def,\n                             virBufferPtr buf,\n                             const char *elem_name)\n{\n    if (!buf || !elem_name)\n        return -1;\n    if (!def)\n        return 0;\n\n    if (def->average || def->floor) {\n        virBufferAsprintf(buf, \"<%s\", elem_name);\n\n        if (def->average)\n            virBufferAsprintf(buf, \" average='%llu'\", def->average);\n\n        if (def->peak)\n            virBufferAsprintf(buf, \" peak='%llu'\", def->peak);\n\n        if (def->floor)\n            virBufferAsprintf(buf, \" floor='%llu'\", def->floor);\n\n        if (def->burst)\n            virBufferAsprintf(buf, \" burst='%llu'\", def->burst);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBandwidthRateFormat(virNetDevBandwidthRatePtr def,\n                             virBufferPtr buf,\n                             const char *elem_name)\n{\n    if (!buf || !elem_name)\n        return -1;\n    if (!def)\n        return 0;\n\n    if (def->average || def->floor) {\n        virBufferAsprintf(buf, \"<%s\", elem_name);\n\n        if (def->average)\n            virBufferAsprintf(buf, \" average='%llu'\", def->average);\n\n        if (def->peak)\n            virBufferAsprintf(buf, \" peak='%llu'\", def->peak);\n\n        if (def->floor)\n            virBufferAsprintf(buf, \" floor='%llu'\", def->floor);\n\n        if (def->burst)\n            virBufferAsprintf(buf, \" burst='%llu'\", def->burst);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\">\\n\""
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\" classID='%u'\"",
            "class_id"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<bandwidth\""
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nint\nvirNetDevBandwidthFormat(const virNetDevBandwidth *def,\n                         unsigned int class_id,\n                         virBufferPtr buf)\n{\n    if (!buf)\n        return -1;\n\n    if (!def)\n        return 0;\n\n    virBufferAddLit(buf, \"<bandwidth\");\n    if (class_id)\n        virBufferAsprintf(buf, \" classID='%u'\", class_id);\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n    if (virNetDevBandwidthRateFormat(def->in, buf, \"inbound\") < 0 ||\n        virNetDevBandwidthRateFormat(def->out, buf, \"outbound\") < 0)\n        return -1;\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</bandwidth>\\n\");\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBandwidthRateFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
    "lines": "221-249",
    "snippet": "static int\nvirNetDevBandwidthRateFormat(virNetDevBandwidthRatePtr def,\n                             virBufferPtr buf,\n                             const char *elem_name)\n{\n    if (!buf || !elem_name)\n        return -1;\n    if (!def)\n        return 0;\n\n    if (def->average || def->floor) {\n        virBufferAsprintf(buf, \"<%s\", elem_name);\n\n        if (def->average)\n            virBufferAsprintf(buf, \" average='%llu'\", def->average);\n\n        if (def->peak)\n            virBufferAsprintf(buf, \" peak='%llu'\", def->peak);\n\n        if (def->floor)\n            virBufferAsprintf(buf, \" floor='%llu'\", def->floor);\n\n        if (def->burst)\n            virBufferAsprintf(buf, \" burst='%llu'\", def->burst);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\" burst='%llu'\"",
            "def->burst"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBandwidthRateFormat(virNetDevBandwidthRatePtr def,\n                             virBufferPtr buf,\n                             const char *elem_name)\n{\n    if (!buf || !elem_name)\n        return -1;\n    if (!def)\n        return 0;\n\n    if (def->average || def->floor) {\n        virBufferAsprintf(buf, \"<%s\", elem_name);\n\n        if (def->average)\n            virBufferAsprintf(buf, \" average='%llu'\", def->average);\n\n        if (def->peak)\n            virBufferAsprintf(buf, \" peak='%llu'\", def->peak);\n\n        if (def->floor)\n            virBufferAsprintf(buf, \" floor='%llu'\", def->floor);\n\n        if (def->burst)\n            virBufferAsprintf(buf, \" burst='%llu'\", def->burst);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevBandwidthParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
    "lines": "112-219",
    "snippet": "int\nvirNetDevBandwidthParse(virNetDevBandwidthPtr *bandwidth,\n                        unsigned int *class_id,\n                        xmlNodePtr node,\n                        bool allowFloor)\n{\n    int ret = -1;\n    virNetDevBandwidthPtr def = NULL;\n    xmlNodePtr cur;\n    xmlNodePtr in = NULL, out = NULL;\n    char *class_id_prop = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    if (!node || !virXMLNodeNameEqual(node, \"bandwidth\")) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"invalid argument supplied\"));\n        goto cleanup;\n    }\n\n    class_id_prop = virXMLPropString(node, \"classID\");\n    if (class_id_prop) {\n        if (!class_id) {\n            virReportError(VIR_ERR_XML_DETAIL, \"%s\",\n                           _(\"classID attribute not supported on <bandwidth> \"\n                             \"in this usage context\"));\n            goto cleanup;\n        }\n        if (virStrToLong_ui(class_id_prop, NULL, 10, class_id) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse class id '%s'\"),\n                           class_id_prop);\n            goto cleanup;\n        }\n    }\n\n    cur = node->children;\n\n    while (cur) {\n        if (cur->type == XML_ELEMENT_NODE) {\n            if (virXMLNodeNameEqual(cur, \"inbound\")) {\n                if (in) {\n                    virReportError(VIR_ERR_XML_DETAIL, \"%s\",\n                                   _(\"Only one child <inbound> \"\n                                     \"element allowed\"));\n                    goto cleanup;\n                }\n                in = cur;\n            } else if (virXMLNodeNameEqual(cur, \"outbound\")) {\n                if (out) {\n                    virReportError(VIR_ERR_XML_DETAIL, \"%s\",\n                                   _(\"Only one child <outbound> \"\n                                     \"element allowed\"));\n                    goto cleanup;\n                }\n                out = cur;\n            }\n            /* Silently ignore unknown elements */\n        }\n        cur = cur->next;\n    }\n\n    if (in) {\n        if (VIR_ALLOC(def->in) < 0)\n            goto cleanup;\n\n        if (virNetDevBandwidthParseRate(in, def->in) < 0) {\n            /* helper reported error for us */\n            goto cleanup;\n        }\n\n        if (def->in->floor && !allowFloor) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"floor attribute is not supported for this config\"));\n            goto cleanup;\n        }\n    }\n\n    if (out) {\n        if (VIR_ALLOC(def->out) < 0)\n            goto cleanup;\n\n        if (virNetDevBandwidthParseRate(out, def->out) < 0) {\n            /* helper reported error for us */\n            goto cleanup;\n        }\n\n        if (def->out->floor) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"'floor' attribute allowed \"\n                             \"only in <inbound> element\"));\n            goto cleanup;\n        }\n    }\n\n    if (!def->in && !def->out)\n        VIR_FREE(def);\n\n    *bandwidth = def;\n    def = NULL;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(class_id_prop);\n    virNetDevBandwidthFree(def);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevBandwidthFree",
          "args": [
            "def"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBandwidthFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbandwidth.c",
          "lines": "31-40",
          "snippet": "void\nvirNetDevBandwidthFree(virNetDevBandwidthPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->in);\n    VIR_FREE(def->out);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virnetdevbandwidth.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirNetDevBandwidthFree(virNetDevBandwidthPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->in);\n    VIR_FREE(def->out);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "class_id_prop"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"'floor' attribute allowed \"\n                             \"only in <inbound> element\")"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"'floor' attribute allowed \"\n                             \"only in <inbound> element\""
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevBandwidthParseRate",
          "args": [
            "out",
            "def->out"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBandwidthParseRate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
          "lines": "28-97",
          "snippet": "static int\nvirNetDevBandwidthParseRate(xmlNodePtr node, virNetDevBandwidthRatePtr rate)\n{\n    int ret = -1;\n    char *average = NULL;\n    char *peak = NULL;\n    char *burst = NULL;\n    char *floor = NULL;\n\n    if (!node || !rate) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"invalid argument supplied\"));\n        return -1;\n    }\n\n    average = virXMLPropString(node, \"average\");\n    peak = virXMLPropString(node, \"peak\");\n    burst = virXMLPropString(node, \"burst\");\n    floor = virXMLPropString(node, \"floor\");\n\n    if (average) {\n        if (virStrToLong_ullp(average, NULL, 10, &rate->average) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"could not convert bandwidth average value '%s'\"),\n                           average);\n            goto cleanup;\n        }\n    } else if (!floor) {\n        virReportError(VIR_ERR_XML_DETAIL, \"%s\",\n                       _(\"Missing mandatory average or floor attributes\"));\n        goto cleanup;\n    }\n\n    if ((peak || burst) && !average) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"'peak' and 'burst' require 'average' attribute\"));\n        goto cleanup;\n    }\n\n    if (peak && virStrToLong_ullp(peak, NULL, 10, &rate->peak) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth peak value '%s'\"),\n                       peak);\n        goto cleanup;\n    }\n\n    if (burst && virStrToLong_ullp(burst, NULL, 10, &rate->burst) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth burst value '%s'\"),\n                       burst);\n        goto cleanup;\n    }\n\n    if (floor && virStrToLong_ullp(floor, NULL, 10, &rate->floor) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth floor value '%s'\"),\n                       floor);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(average);\n    VIR_FREE(peak);\n    VIR_FREE(burst);\n    VIR_FREE(floor);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBandwidthParseRate(xmlNodePtr node, virNetDevBandwidthRatePtr rate)\n{\n    int ret = -1;\n    char *average = NULL;\n    char *peak = NULL;\n    char *burst = NULL;\n    char *floor = NULL;\n\n    if (!node || !rate) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"invalid argument supplied\"));\n        return -1;\n    }\n\n    average = virXMLPropString(node, \"average\");\n    peak = virXMLPropString(node, \"peak\");\n    burst = virXMLPropString(node, \"burst\");\n    floor = virXMLPropString(node, \"floor\");\n\n    if (average) {\n        if (virStrToLong_ullp(average, NULL, 10, &rate->average) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"could not convert bandwidth average value '%s'\"),\n                           average);\n            goto cleanup;\n        }\n    } else if (!floor) {\n        virReportError(VIR_ERR_XML_DETAIL, \"%s\",\n                       _(\"Missing mandatory average or floor attributes\"));\n        goto cleanup;\n    }\n\n    if ((peak || burst) && !average) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"'peak' and 'burst' require 'average' attribute\"));\n        goto cleanup;\n    }\n\n    if (peak && virStrToLong_ullp(peak, NULL, 10, &rate->peak) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth peak value '%s'\"),\n                       peak);\n        goto cleanup;\n    }\n\n    if (burst && virStrToLong_ullp(burst, NULL, 10, &rate->burst) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth burst value '%s'\"),\n                       burst);\n        goto cleanup;\n    }\n\n    if (floor && virStrToLong_ullp(floor, NULL, 10, &rate->floor) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth floor value '%s'\"),\n                       floor);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(average);\n    VIR_FREE(peak);\n    VIR_FREE(burst);\n    VIR_FREE(floor);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def->out"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"floor attribute is not supported for this config\")"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def->in"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_DETAIL",
            "\"%s\"",
            "_(\"Only one child <outbound> \"\n                                     \"element allowed\")"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLNodeNameEqual",
          "args": [
            "cur",
            "\"outbound\""
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLNodeNameEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1013-1018",
          "snippet": "bool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nbool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_DETAIL",
            "\"%s\"",
            "_(\"Only one child <inbound> \"\n                                     \"element allowed\")"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse class id '%s'\")",
            "class_id_prop"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "class_id_prop",
            "NULL",
            "10",
            "class_id"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_DETAIL",
            "\"%s\"",
            "_(\"classID attribute not supported on <bandwidth> \"\n                             \"in this usage context\")"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"classID\""
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"invalid argument supplied\")"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nint\nvirNetDevBandwidthParse(virNetDevBandwidthPtr *bandwidth,\n                        unsigned int *class_id,\n                        xmlNodePtr node,\n                        bool allowFloor)\n{\n    int ret = -1;\n    virNetDevBandwidthPtr def = NULL;\n    xmlNodePtr cur;\n    xmlNodePtr in = NULL, out = NULL;\n    char *class_id_prop = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return ret;\n\n    if (!node || !virXMLNodeNameEqual(node, \"bandwidth\")) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"invalid argument supplied\"));\n        goto cleanup;\n    }\n\n    class_id_prop = virXMLPropString(node, \"classID\");\n    if (class_id_prop) {\n        if (!class_id) {\n            virReportError(VIR_ERR_XML_DETAIL, \"%s\",\n                           _(\"classID attribute not supported on <bandwidth> \"\n                             \"in this usage context\"));\n            goto cleanup;\n        }\n        if (virStrToLong_ui(class_id_prop, NULL, 10, class_id) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to parse class id '%s'\"),\n                           class_id_prop);\n            goto cleanup;\n        }\n    }\n\n    cur = node->children;\n\n    while (cur) {\n        if (cur->type == XML_ELEMENT_NODE) {\n            if (virXMLNodeNameEqual(cur, \"inbound\")) {\n                if (in) {\n                    virReportError(VIR_ERR_XML_DETAIL, \"%s\",\n                                   _(\"Only one child <inbound> \"\n                                     \"element allowed\"));\n                    goto cleanup;\n                }\n                in = cur;\n            } else if (virXMLNodeNameEqual(cur, \"outbound\")) {\n                if (out) {\n                    virReportError(VIR_ERR_XML_DETAIL, \"%s\",\n                                   _(\"Only one child <outbound> \"\n                                     \"element allowed\"));\n                    goto cleanup;\n                }\n                out = cur;\n            }\n            /* Silently ignore unknown elements */\n        }\n        cur = cur->next;\n    }\n\n    if (in) {\n        if (VIR_ALLOC(def->in) < 0)\n            goto cleanup;\n\n        if (virNetDevBandwidthParseRate(in, def->in) < 0) {\n            /* helper reported error for us */\n            goto cleanup;\n        }\n\n        if (def->in->floor && !allowFloor) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"floor attribute is not supported for this config\"));\n            goto cleanup;\n        }\n    }\n\n    if (out) {\n        if (VIR_ALLOC(def->out) < 0)\n            goto cleanup;\n\n        if (virNetDevBandwidthParseRate(out, def->out) < 0) {\n            /* helper reported error for us */\n            goto cleanup;\n        }\n\n        if (def->out->floor) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"'floor' attribute allowed \"\n                             \"only in <inbound> element\"));\n            goto cleanup;\n        }\n    }\n\n    if (!def->in && !def->out)\n        VIR_FREE(def);\n\n    *bandwidth = def;\n    def = NULL;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(class_id_prop);\n    virNetDevBandwidthFree(def);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevBandwidthParseRate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
    "lines": "28-97",
    "snippet": "static int\nvirNetDevBandwidthParseRate(xmlNodePtr node, virNetDevBandwidthRatePtr rate)\n{\n    int ret = -1;\n    char *average = NULL;\n    char *peak = NULL;\n    char *burst = NULL;\n    char *floor = NULL;\n\n    if (!node || !rate) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"invalid argument supplied\"));\n        return -1;\n    }\n\n    average = virXMLPropString(node, \"average\");\n    peak = virXMLPropString(node, \"peak\");\n    burst = virXMLPropString(node, \"burst\");\n    floor = virXMLPropString(node, \"floor\");\n\n    if (average) {\n        if (virStrToLong_ullp(average, NULL, 10, &rate->average) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"could not convert bandwidth average value '%s'\"),\n                           average);\n            goto cleanup;\n        }\n    } else if (!floor) {\n        virReportError(VIR_ERR_XML_DETAIL, \"%s\",\n                       _(\"Missing mandatory average or floor attributes\"));\n        goto cleanup;\n    }\n\n    if ((peak || burst) && !average) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"'peak' and 'burst' require 'average' attribute\"));\n        goto cleanup;\n    }\n\n    if (peak && virStrToLong_ullp(peak, NULL, 10, &rate->peak) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth peak value '%s'\"),\n                       peak);\n        goto cleanup;\n    }\n\n    if (burst && virStrToLong_ullp(burst, NULL, 10, &rate->burst) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth burst value '%s'\"),\n                       burst);\n        goto cleanup;\n    }\n\n    if (floor && virStrToLong_ullp(floor, NULL, 10, &rate->floor) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth floor value '%s'\"),\n                       floor);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(average);\n    VIR_FREE(peak);\n    VIR_FREE(burst);\n    VIR_FREE(floor);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "floor"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "burst"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "peak"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "average"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"could not convert bandwidth floor value '%s'\")",
            "floor"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not convert bandwidth floor value '%s'\""
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ullp",
          "args": [
            "floor",
            "NULL",
            "10",
            "&rate->floor"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"could not convert bandwidth burst value '%s'\")",
            "burst"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"could not convert bandwidth peak value '%s'\")",
            "peak"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"'peak' and 'burst' require 'average' attribute\")"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_DETAIL",
            "\"%s\"",
            "_(\"Missing mandatory average or floor attributes\")"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"could not convert bandwidth average value '%s'\")",
            "average"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"floor\""
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"invalid argument supplied\")"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nstatic int\nvirNetDevBandwidthParseRate(xmlNodePtr node, virNetDevBandwidthRatePtr rate)\n{\n    int ret = -1;\n    char *average = NULL;\n    char *peak = NULL;\n    char *burst = NULL;\n    char *floor = NULL;\n\n    if (!node || !rate) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"invalid argument supplied\"));\n        return -1;\n    }\n\n    average = virXMLPropString(node, \"average\");\n    peak = virXMLPropString(node, \"peak\");\n    burst = virXMLPropString(node, \"burst\");\n    floor = virXMLPropString(node, \"floor\");\n\n    if (average) {\n        if (virStrToLong_ullp(average, NULL, 10, &rate->average) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"could not convert bandwidth average value '%s'\"),\n                           average);\n            goto cleanup;\n        }\n    } else if (!floor) {\n        virReportError(VIR_ERR_XML_DETAIL, \"%s\",\n                       _(\"Missing mandatory average or floor attributes\"));\n        goto cleanup;\n    }\n\n    if ((peak || burst) && !average) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"'peak' and 'burst' require 'average' attribute\"));\n        goto cleanup;\n    }\n\n    if (peak && virStrToLong_ullp(peak, NULL, 10, &rate->peak) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth peak value '%s'\"),\n                       peak);\n        goto cleanup;\n    }\n\n    if (burst && virStrToLong_ullp(burst, NULL, 10, &rate->burst) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth burst value '%s'\"),\n                       burst);\n        goto cleanup;\n    }\n\n    if (floor && virStrToLong_ullp(floor, NULL, 10, &rate->floor) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"could not convert bandwidth floor value '%s'\"),\n                       floor);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(average);\n    VIR_FREE(peak);\n    VIR_FREE(burst);\n    VIR_FREE(floor);\n\n    return ret;\n}"
  }
]