[
  {
    "function_name": "virSecurityStackRestoreTPMLabels",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "913-928",
    "snippet": "static int\nvirSecurityStackRestoreTPMLabels(virSecurityManagerPtr mgr,\n                                 virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreTPMLabels(item->securityManager,\n                                               vm) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreTPMLabels",
          "args": [
            "item->securityManager",
            "vm"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreTPMLabels",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1230-1245",
          "snippet": "int\nvirSecurityManagerRestoreTPMLabels(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm)\n{\n    int ret;\n\n    if (mgr->drv->domainRestoreSecurityTPMLabels) {\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityTPMLabels(mgr, vm);\n        virObjectUnlock(mgr);\n\n        return ret;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreTPMLabels(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm)\n{\n    int ret;\n\n    if (mgr->drv->domainRestoreSecurityTPMLabels) {\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityTPMLabels(mgr, vm);\n        virObjectUnlock(mgr);\n\n        return ret;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackRestoreTPMLabels(virSecurityManagerPtr mgr,\n                                 virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreTPMLabels(item->securityManager,\n                                               vm) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackSetTPMLabels",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "883-910",
    "snippet": "static int\nvirSecurityStackSetTPMLabels(virSecurityManagerPtr mgr,\n                             virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetTPMLabels(item->securityManager,\n                                           vm) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreTPMLabels(item->securityManager,\n                                               vm) < 0) {\n            VIR_WARN(\"Unable to restore TPM label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name);\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to restore TPM label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s\"",
            "virSecurityManagerGetVirtDriver(mgr)",
            "virSecurityManagerGetDriver(item->securityManager)",
            "vm->name"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetDriver",
          "args": [
            "item->securityManager"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "335-339",
          "snippet": "const char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetVirtDriver",
          "args": [
            "mgr"
          ],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetVirtDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "328-332",
          "snippet": "const char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreTPMLabels",
          "args": [
            "item->securityManager",
            "vm"
          ],
          "line": 900
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreTPMLabels",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1230-1245",
          "snippet": "int\nvirSecurityManagerRestoreTPMLabels(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm)\n{\n    int ret;\n\n    if (mgr->drv->domainRestoreSecurityTPMLabels) {\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityTPMLabels(mgr, vm);\n        virObjectUnlock(mgr);\n\n        return ret;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreTPMLabels(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm)\n{\n    int ret;\n\n    if (mgr->drv->domainRestoreSecurityTPMLabels) {\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityTPMLabels(mgr, vm);\n        virObjectUnlock(mgr);\n\n        return ret;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetTPMLabels",
          "args": [
            "item->securityManager",
            "vm"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetTPMLabels",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1212-1227",
          "snippet": "int\nvirSecurityManagerSetTPMLabels(virSecurityManagerPtr mgr,\n                               virDomainDefPtr vm)\n{\n    int ret;\n\n    if (mgr->drv->domainSetSecurityTPMLabels) {\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityTPMLabels(mgr, vm);\n        virObjectUnlock(mgr);\n\n        return ret;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetTPMLabels(virSecurityManagerPtr mgr,\n                               virDomainDefPtr vm)\n{\n    int ret;\n\n    if (mgr->drv->domainSetSecurityTPMLabels) {\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityTPMLabels(mgr, vm);\n        virObjectUnlock(mgr);\n\n        return ret;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetTPMLabels(virSecurityManagerPtr mgr,\n                             virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetTPMLabels(item->securityManager,\n                                           vm) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreTPMLabels(item->securityManager,\n                                               vm) < 0) {\n            VIR_WARN(\"Unable to restore TPM label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name);\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackDomainRestoreChardevLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "862-880",
    "snippet": "static int\nvirSecurityStackDomainRestoreChardevLabel(virSecurityManagerPtr mgr,\n                                          virDomainDefPtr def,\n                                          virDomainChrSourceDefPtr dev_source,\n                                          bool chardevStdioLogd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreChardevLabel(item->securityManager,\n                                                  def, dev_source,\n                                                  chardevStdioLogd) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreChardevLabel",
          "args": [
            "item->securityManager",
            "def",
            "dev_source",
            "chardevStdioLogd"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreChardevLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1192-1209",
          "snippet": "int\nvirSecurityManagerRestoreChardevLabel(virSecurityManagerPtr mgr,\n                                      virDomainDefPtr def,\n                                      virDomainChrSourceDefPtr dev_source,\n                                      bool chardevStdioLogd)\n{\n    if (mgr->drv->domainRestoreSecurityChardevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityChardevLabel(mgr, def, dev_source,\n                                                          chardevStdioLogd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreChardevLabel(virSecurityManagerPtr mgr,\n                                      virDomainDefPtr def,\n                                      virDomainChrSourceDefPtr dev_source,\n                                      bool chardevStdioLogd)\n{\n    if (mgr->drv->domainRestoreSecurityChardevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityChardevLabel(mgr, def, dev_source,\n                                                          chardevStdioLogd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackDomainRestoreChardevLabel(virSecurityManagerPtr mgr,\n                                          virDomainDefPtr def,\n                                          virDomainChrSourceDefPtr dev_source,\n                                          bool chardevStdioLogd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreChardevLabel(item->securityManager,\n                                                  def, dev_source,\n                                                  chardevStdioLogd) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackDomainSetChardevLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "828-860",
    "snippet": "static int\nvirSecurityStackDomainSetChardevLabel(virSecurityManagerPtr mgr,\n                                      virDomainDefPtr def,\n                                      virDomainChrSourceDefPtr dev_source,\n                                      bool chardevStdioLogd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetChardevLabel(item->securityManager,\n                                              def, dev_source,\n                                              chardevStdioLogd) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreChardevLabel(item->securityManager,\n                                                  def,\n                                                  dev_source,\n                                                  chardevStdioLogd) < 0) {\n            VIR_WARN(\"Unable to restore chardev label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s dev_source=%p\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     def->name, dev_source);\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to restore chardev label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s dev_source=%p\"",
            "virSecurityManagerGetVirtDriver(mgr)",
            "virSecurityManagerGetDriver(item->securityManager)",
            "def->name",
            "dev_source"
          ],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetDriver",
          "args": [
            "item->securityManager"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "335-339",
          "snippet": "const char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetVirtDriver",
          "args": [
            "mgr"
          ],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetVirtDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "328-332",
          "snippet": "const char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreChardevLabel",
          "args": [
            "item->securityManager",
            "def",
            "dev_source",
            "chardevStdioLogd"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreChardevLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1192-1209",
          "snippet": "int\nvirSecurityManagerRestoreChardevLabel(virSecurityManagerPtr mgr,\n                                      virDomainDefPtr def,\n                                      virDomainChrSourceDefPtr dev_source,\n                                      bool chardevStdioLogd)\n{\n    if (mgr->drv->domainRestoreSecurityChardevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityChardevLabel(mgr, def, dev_source,\n                                                          chardevStdioLogd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreChardevLabel(virSecurityManagerPtr mgr,\n                                      virDomainDefPtr def,\n                                      virDomainChrSourceDefPtr dev_source,\n                                      bool chardevStdioLogd)\n{\n    if (mgr->drv->domainRestoreSecurityChardevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityChardevLabel(mgr, def, dev_source,\n                                                          chardevStdioLogd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetChardevLabel",
          "args": [
            "item->securityManager",
            "def",
            "dev_source",
            "chardevStdioLogd"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetChardevLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1172-1189",
          "snippet": "int\nvirSecurityManagerSetChardevLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr def,\n                                  virDomainChrSourceDefPtr dev_source,\n                                  bool chardevStdioLogd)\n{\n    if (mgr->drv->domainSetSecurityChardevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityChardevLabel(mgr, def, dev_source,\n                                                      chardevStdioLogd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetChardevLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr def,\n                                  virDomainChrSourceDefPtr dev_source,\n                                  bool chardevStdioLogd)\n{\n    if (mgr->drv->domainSetSecurityChardevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityChardevLabel(mgr, def, dev_source,\n                                                      chardevStdioLogd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 834
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackDomainSetChardevLabel(virSecurityManagerPtr mgr,\n                                      virDomainDefPtr def,\n                                      virDomainChrSourceDefPtr dev_source,\n                                      bool chardevStdioLogd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetChardevLabel(item->securityManager,\n                                              def, dev_source,\n                                              chardevStdioLogd) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreChardevLabel(item->securityManager,\n                                                  def,\n                                                  dev_source,\n                                                  chardevStdioLogd) < 0) {\n            VIR_WARN(\"Unable to restore chardev label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s dev_source=%p\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     def->name, dev_source);\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackDomainSetPathLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "809-826",
    "snippet": "static int\nvirSecurityStackDomainSetPathLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm,\n                                   const char *path,\n                                   bool allowSubtree)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerDomainSetPathLabel(item->securityManager,\n                                                 vm, path, allowSubtree) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerDomainSetPathLabel",
          "args": [
            "item->securityManager",
            "vm",
            "path",
            "allowSubtree"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerDomainSetPathLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1062-1077",
          "snippet": "int\nvirSecurityManagerDomainSetPathLabel(virSecurityManagerPtr mgr,\n                                     virDomainDefPtr vm,\n                                     const char *path,\n                                     bool allowSubtree)\n{\n    if (mgr->drv->domainSetPathLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetPathLabel(mgr, vm, path, allowSubtree);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerDomainSetPathLabel(virSecurityManagerPtr mgr,\n                                     virDomainDefPtr vm,\n                                     const char *path,\n                                     bool allowSubtree)\n{\n    if (mgr->drv->domainSetPathLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetPathLabel(mgr, vm, path, allowSubtree);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackDomainSetPathLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm,\n                                   const char *path,\n                                   bool allowSubtree)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerDomainSetPathLabel(item->securityManager,\n                                                 vm, path, allowSubtree) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackRestoreInputLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "791-807",
    "snippet": "static int\nvirSecurityStackRestoreInputLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  virDomainInputDefPtr input)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreInputLabel(item->securityManager,\n                                                vm, input) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreInputLabel",
          "args": [
            "item->securityManager",
            "vm",
            "input"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreInputLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1154-1169",
          "snippet": "int\nvirSecurityManagerRestoreInputLabel(virSecurityManagerPtr mgr,\n                                    virDomainDefPtr vm,\n                                    virDomainInputDefPtr input)\n{\n    if (mgr->drv->domainRestoreSecurityInputLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityInputLabel(mgr, vm, input);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreInputLabel(virSecurityManagerPtr mgr,\n                                    virDomainDefPtr vm,\n                                    virDomainInputDefPtr input)\n{\n    if (mgr->drv->domainRestoreSecurityInputLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityInputLabel(mgr, vm, input);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackRestoreInputLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  virDomainInputDefPtr input)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreInputLabel(item->securityManager,\n                                                vm, input) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackSetInputLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "761-789",
    "snippet": "static int\nvirSecurityStackSetInputLabel(virSecurityManagerPtr mgr,\n                              virDomainDefPtr vm,\n                              virDomainInputDefPtr input)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetInputLabel(item->securityManager, vm, input) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreInputLabel(item->securityManager,\n                                                vm,\n                                                input) < 0) {\n            VIR_WARN(\"Unable to restore input label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s input=%p\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name, input);\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to restore input label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s input=%p\"",
            "virSecurityManagerGetVirtDriver(mgr)",
            "virSecurityManagerGetDriver(item->securityManager)",
            "vm->name",
            "input"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetDriver",
          "args": [
            "item->securityManager"
          ],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "335-339",
          "snippet": "const char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetVirtDriver",
          "args": [
            "mgr"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetVirtDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "328-332",
          "snippet": "const char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreInputLabel",
          "args": [
            "item->securityManager",
            "vm",
            "input"
          ],
          "line": 778
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreInputLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1154-1169",
          "snippet": "int\nvirSecurityManagerRestoreInputLabel(virSecurityManagerPtr mgr,\n                                    virDomainDefPtr vm,\n                                    virDomainInputDefPtr input)\n{\n    if (mgr->drv->domainRestoreSecurityInputLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityInputLabel(mgr, vm, input);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreInputLabel(virSecurityManagerPtr mgr,\n                                    virDomainDefPtr vm,\n                                    virDomainInputDefPtr input)\n{\n    if (mgr->drv->domainRestoreSecurityInputLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityInputLabel(mgr, vm, input);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetInputLabel",
          "args": [
            "item->securityManager",
            "vm",
            "input"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetInputLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1136-1151",
          "snippet": "int\nvirSecurityManagerSetInputLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                virDomainInputDefPtr input)\n{\n    if (mgr->drv->domainSetSecurityInputLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityInputLabel(mgr, vm, input);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetInputLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                virDomainInputDefPtr input)\n{\n    if (mgr->drv->domainSetSecurityInputLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityInputLabel(mgr, vm, input);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetInputLabel(virSecurityManagerPtr mgr,\n                              virDomainDefPtr vm,\n                              virDomainInputDefPtr input)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetInputLabel(item->securityManager, vm, input) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreInputLabel(item->securityManager,\n                                                vm,\n                                                input) < 0) {\n            VIR_WARN(\"Unable to restore input label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s input=%p\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name, input);\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackRestoreMemoryLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "743-759",
    "snippet": "static int\nvirSecurityStackRestoreMemoryLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm,\n                                   virDomainMemoryDefPtr mem)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreMemoryLabel(item->securityManager,\n                                                 vm, mem) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreMemoryLabel",
          "args": [
            "item->securityManager",
            "vm",
            "mem"
          ],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreMemoryLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1118-1133",
          "snippet": "int\nvirSecurityManagerRestoreMemoryLabel(virSecurityManagerPtr mgr,\n                                        virDomainDefPtr vm,\n                                        virDomainMemoryDefPtr mem)\n{\n    if (mgr->drv->domainRestoreSecurityMemoryLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityMemoryLabel(mgr, vm, mem);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreMemoryLabel(virSecurityManagerPtr mgr,\n                                        virDomainDefPtr vm,\n                                        virDomainMemoryDefPtr mem)\n{\n    if (mgr->drv->domainRestoreSecurityMemoryLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityMemoryLabel(mgr, vm, mem);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackRestoreMemoryLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm,\n                                   virDomainMemoryDefPtr mem)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreMemoryLabel(item->securityManager,\n                                                 vm, mem) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackSetMemoryLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "713-741",
    "snippet": "static int\nvirSecurityStackSetMemoryLabel(virSecurityManagerPtr mgr,\n                               virDomainDefPtr vm,\n                               virDomainMemoryDefPtr mem)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetMemoryLabel(item->securityManager, vm, mem) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreMemoryLabel(item->securityManager,\n                                                 vm,\n                                                 mem) < 0) {\n            VIR_WARN(\"Unable to restore memory label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s mem=%p\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name, mem);\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to restore memory label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s mem=%p\"",
            "virSecurityManagerGetVirtDriver(mgr)",
            "virSecurityManagerGetDriver(item->securityManager)",
            "vm->name",
            "mem"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetDriver",
          "args": [
            "item->securityManager"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "335-339",
          "snippet": "const char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetVirtDriver",
          "args": [
            "mgr"
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetVirtDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "328-332",
          "snippet": "const char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreMemoryLabel",
          "args": [
            "item->securityManager",
            "vm",
            "mem"
          ],
          "line": 730
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreMemoryLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1118-1133",
          "snippet": "int\nvirSecurityManagerRestoreMemoryLabel(virSecurityManagerPtr mgr,\n                                        virDomainDefPtr vm,\n                                        virDomainMemoryDefPtr mem)\n{\n    if (mgr->drv->domainRestoreSecurityMemoryLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityMemoryLabel(mgr, vm, mem);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreMemoryLabel(virSecurityManagerPtr mgr,\n                                        virDomainDefPtr vm,\n                                        virDomainMemoryDefPtr mem)\n{\n    if (mgr->drv->domainRestoreSecurityMemoryLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityMemoryLabel(mgr, vm, mem);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetMemoryLabel",
          "args": [
            "item->securityManager",
            "vm",
            "mem"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetMemoryLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "1090-1105",
          "snippet": "int\nvirSecurityManagerSetMemoryLabel(virSecurityManagerPtr mgr,\n                                     virDomainDefPtr vm,\n                                     virDomainMemoryDefPtr mem)\n{\n    if (mgr->drv->domainSetSecurityMemoryLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityMemoryLabel(mgr, vm, mem);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetMemoryLabel(virSecurityManagerPtr mgr,\n                                     virDomainDefPtr vm,\n                                     virDomainMemoryDefPtr mem)\n{\n    if (mgr->drv->domainSetSecurityMemoryLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityMemoryLabel(mgr, vm, mem);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetMemoryLabel(virSecurityManagerPtr mgr,\n                               virDomainDefPtr vm,\n                               virDomainMemoryDefPtr mem)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetMemoryLabel(item->securityManager, vm, mem) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreMemoryLabel(item->securityManager,\n                                                 vm,\n                                                 mem) < 0) {\n            VIR_WARN(\"Unable to restore memory label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s mem=%p\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name, mem);\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackMoveImageMetadata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "694-711",
    "snippet": "static int\nvirSecurityStackMoveImageMetadata(virSecurityManagerPtr mgr,\n                                  pid_t pid,\n                                  virStorageSourcePtr src,\n                                  virStorageSourcePtr dst)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerMoveImageMetadata(item->securityManager,\n                                                pid, src, dst) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerMoveImageMetadata",
          "args": [
            "item->securityManager",
            "pid",
            "src",
            "dst"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerMoveImageMetadata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "462-478",
          "snippet": "int\nvirSecurityManagerMoveImageMetadata(virSecurityManagerPtr mgr,\n                                    pid_t pid,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr dst)\n{\n    if (mgr->drv->domainMoveImageMetadata) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainMoveImageMetadata(mgr, pid, src, dst);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerMoveImageMetadata(virSecurityManagerPtr mgr,\n                                    pid_t pid,\n                                    virStorageSourcePtr src,\n                                    virStorageSourcePtr dst)\n{\n    if (mgr->drv->domainMoveImageMetadata) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainMoveImageMetadata(mgr, pid, src, dst);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 700
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackMoveImageMetadata(virSecurityManagerPtr mgr,\n                                  pid_t pid,\n                                  virStorageSourcePtr src,\n                                  virStorageSourcePtr dst)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerMoveImageMetadata(item->securityManager,\n                                                pid, src, dst) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackRestoreImageLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "675-692",
    "snippet": "static int\nvirSecurityStackRestoreImageLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  virStorageSourcePtr src,\n                                  virSecurityDomainImageLabelFlags flags)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreImageLabel(item->securityManager,\n                                                vm, src, flags) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreImageLabel",
          "args": [
            "item->securityManager",
            "vm",
            "src",
            "flags"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreImageLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "423-439",
          "snippet": "int\nvirSecurityManagerRestoreImageLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm,\n                                   virStorageSourcePtr src,\n                                   virSecurityDomainImageLabelFlags flags)\n{\n    if (mgr->drv->domainRestoreSecurityImageLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityImageLabel(mgr, vm, src, flags);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreImageLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm,\n                                   virStorageSourcePtr src,\n                                   virSecurityDomainImageLabelFlags flags)\n{\n    if (mgr->drv->domainRestoreSecurityImageLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityImageLabel(mgr, vm, src, flags);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackRestoreImageLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  virStorageSourcePtr src,\n                                  virSecurityDomainImageLabelFlags flags)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreImageLabel(item->securityManager,\n                                                vm, src, flags) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackSetImageLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "641-673",
    "snippet": "static int\nvirSecurityStackSetImageLabel(virSecurityManagerPtr mgr,\n                              virDomainDefPtr vm,\n                              virStorageSourcePtr src,\n                              virSecurityDomainImageLabelFlags flags)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetImageLabel(item->securityManager, vm, src,\n                                            flags) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreImageLabel(item->securityManager,\n                                                vm,\n                                                src,\n                                                flags) < 0) {\n            VIR_WARN(\"Unable to restore image label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s src=%p (path=%s) \"\n                     \"flags=0x%x\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name, src, NULLSTR(src->path), flags);\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to restore image label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s src=%p (path=%s) \"\n                     \"flags=0x%x\"",
            "virSecurityManagerGetVirtDriver(mgr)",
            "virSecurityManagerGetDriver(item->securityManager)",
            "vm->name",
            "src",
            "NULLSTR(src->path)",
            "flags"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "src->path"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetDriver",
          "args": [
            "item->securityManager"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "335-339",
          "snippet": "const char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetVirtDriver",
          "args": [
            "mgr"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetVirtDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "328-332",
          "snippet": "const char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreImageLabel",
          "args": [
            "item->securityManager",
            "vm",
            "src",
            "flags"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreImageLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "423-439",
          "snippet": "int\nvirSecurityManagerRestoreImageLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm,\n                                   virStorageSourcePtr src,\n                                   virSecurityDomainImageLabelFlags flags)\n{\n    if (mgr->drv->domainRestoreSecurityImageLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityImageLabel(mgr, vm, src, flags);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreImageLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm,\n                                   virStorageSourcePtr src,\n                                   virSecurityDomainImageLabelFlags flags)\n{\n    if (mgr->drv->domainRestoreSecurityImageLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityImageLabel(mgr, vm, src, flags);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetImageLabel",
          "args": [
            "item->securityManager",
            "vm",
            "src",
            "flags"
          ],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetImageLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "543-559",
          "snippet": "int\nvirSecurityManagerSetImageLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                virStorageSourcePtr src,\n                                virSecurityDomainImageLabelFlags flags)\n{\n    if (mgr->drv->domainSetSecurityImageLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityImageLabel(mgr, vm, src, flags);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetImageLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                virStorageSourcePtr src,\n                                virSecurityDomainImageLabelFlags flags)\n{\n    if (mgr->drv->domainSetSecurityImageLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityImageLabel(mgr, vm, src, flags);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetImageLabel(virSecurityManagerPtr mgr,\n                              virDomainDefPtr vm,\n                              virStorageSourcePtr src,\n                              virSecurityDomainImageLabelFlags flags)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetImageLabel(item->securityManager, vm, src,\n                                            flags) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreImageLabel(item->securityManager,\n                                                vm,\n                                                src,\n                                                flags) < 0) {\n            VIR_WARN(\"Unable to restore image label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s src=%p (path=%s) \"\n                     \"flags=0x%x\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name, src, NULLSTR(src->path), flags);\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackGetBaseLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "634-639",
    "snippet": "static const char *\nvirSecurityStackGetBaseLabel(virSecurityManagerPtr mgr, int virtType)\n{\n    return virSecurityManagerGetBaseLabel(virSecurityStackGetPrimary(mgr),\n                                          virtType);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerGetBaseLabel",
          "args": [
            "virSecurityStackGetPrimary(mgr)",
            "virtType"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetBaseLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "375-388",
          "snippet": "const char *\nvirSecurityManagerGetBaseLabel(virSecurityManagerPtr mgr,\n                               int virtType)\n{\n    if (mgr->drv->getBaseLabel) {\n        const char *ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->getBaseLabel(mgr, virtType);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetBaseLabel(virSecurityManagerPtr mgr,\n                               int virtType)\n{\n    if (mgr->drv->getBaseLabel) {\n        const char *ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->getBaseLabel(mgr, virtType);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityStackGetPrimary",
          "args": [
            "mgr"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityStackGetPrimary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
          "lines": "71-76",
          "snippet": "virSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_stack.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nvirSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic const char *\nvirSecurityStackGetBaseLabel(virSecurityManagerPtr mgr, int virtType)\n{\n    return virSecurityManagerGetBaseLabel(virSecurityStackGetPrimary(mgr),\n                                          virtType);\n}"
  },
  {
    "function_name": "virSecurityStackGetNested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "612-632",
    "snippet": "virSecurityManagerPtr*\nvirSecurityStackGetNested(virSecurityManagerPtr mgr)\n{\n    virSecurityManagerPtr *list = NULL;\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item;\n    int len = 0;\n    size_t i;\n\n    for (item = priv->itemsHead; item; item = item->next)\n        len++;\n\n    if (VIR_ALLOC_N(list, len + 1) < 0)\n        return NULL;\n\n    for (i = 0, item = priv->itemsHead; item; item = item->next, i++)\n        list[i] = item->securityManager;\n    list[len] = NULL;\n\n    return list;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "list",
            "len + 1"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nvirSecurityManagerPtr*\nvirSecurityStackGetNested(virSecurityManagerPtr mgr)\n{\n    virSecurityManagerPtr *list = NULL;\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item;\n    int len = 0;\n    size_t i;\n\n    for (item = priv->itemsHead; item; item = item->next)\n        len++;\n\n    if (VIR_ALLOC_N(list, len + 1) < 0)\n        return NULL;\n\n    for (i = 0, item = priv->itemsHead; item; item = item->next, i++)\n        list[i] = item->securityManager;\n    list[len] = NULL;\n\n    return list;\n}"
  },
  {
    "function_name": "virSecurityStackGetMountOptions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "605-610",
    "snippet": "static char *\nvirSecurityStackGetMountOptions(virSecurityManagerPtr mgr G_GNUC_UNUSED,\n                                virDomainDefPtr vm G_GNUC_UNUSED)\n{\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic char *\nvirSecurityStackGetMountOptions(virSecurityManagerPtr mgr G_GNUC_UNUSED,\n                                virDomainDefPtr vm G_GNUC_UNUSED)\n{\n    return NULL;\n}"
  },
  {
    "function_name": "virSecurityStackSetTapFDLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "588-603",
    "snippet": "static int\nvirSecurityStackSetTapFDLabel(virSecurityManagerPtr mgr,\n                              virDomainDefPtr vm,\n                              int fd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetTapFDLabel(item->securityManager, vm, fd) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerSetTapFDLabel",
          "args": [
            "item->securityManager",
            "vm",
            "fd"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetTapFDLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "996-1011",
          "snippet": "int\nvirSecurityManagerSetTapFDLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                int fd)\n{\n    if (mgr->drv->domainSetSecurityTapFDLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityTapFDLabel(mgr, vm, fd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetTapFDLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                int fd)\n{\n    if (mgr->drv->domainSetSecurityTapFDLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityTapFDLabel(mgr, vm, fd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetTapFDLabel(virSecurityManagerPtr mgr,\n                              virDomainDefPtr vm,\n                              int fd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetTapFDLabel(item->securityManager, vm, fd) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackSetImageFDLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "571-586",
    "snippet": "static int\nvirSecurityStackSetImageFDLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                int fd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetImageFDLabel(item->securityManager, vm, fd) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerSetImageFDLabel",
          "args": [
            "item->securityManager",
            "vm",
            "fd"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetImageFDLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "978-993",
          "snippet": "int\nvirSecurityManagerSetImageFDLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  int fd)\n{\n    if (mgr->drv->domainSetSecurityImageFDLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityImageFDLabel(mgr, vm, fd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetImageFDLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  int fd)\n{\n    if (mgr->drv->domainSetSecurityImageFDLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityImageFDLabel(mgr, vm, fd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetImageFDLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                int fd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetImageFDLabel(item->securityManager, vm, fd) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackClearSocketLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "555-569",
    "snippet": "static int\nvirSecurityStackClearSocketLabel(virSecurityManagerPtr mgr,\n                                 virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerClearSocketLabel(item->securityManager, vm) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerClearSocketLabel",
          "args": [
            "item->securityManager",
            "vm"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerClearSocketLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "515-529",
          "snippet": "int\nvirSecurityManagerClearSocketLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm)\n{\n    if (mgr->drv->domainClearSecuritySocketLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainClearSecuritySocketLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerClearSocketLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm)\n{\n    if (mgr->drv->domainClearSecuritySocketLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainClearSecuritySocketLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackClearSocketLabel(virSecurityManagerPtr mgr,\n                                 virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerClearSocketLabel(item->securityManager, vm) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackSetSocketLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "527-552",
    "snippet": "static int\nvirSecurityStackSetSocketLabel(virSecurityManagerPtr mgr,\n                               virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetSocketLabel(item->securityManager, vm) < 0)\n            goto rollback;\n    }\n\n    return 0;\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerClearSocketLabel(item->securityManager,\n                                               vm) < 0) {\n            VIR_WARN(\"Unable to clear new socket label after failed \"\n                     \"set label call virDriver=%s driver=%s domain=%s\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name);\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to clear new socket label after failed \"\n                     \"set label call virDriver=%s driver=%s domain=%s\"",
            "virSecurityManagerGetVirtDriver(mgr)",
            "virSecurityManagerGetDriver(item->securityManager)",
            "vm->name"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetDriver",
          "args": [
            "item->securityManager"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "335-339",
          "snippet": "const char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetVirtDriver",
          "args": [
            "mgr"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetVirtDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "328-332",
          "snippet": "const char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerClearSocketLabel",
          "args": [
            "item->securityManager",
            "vm"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerClearSocketLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "515-529",
          "snippet": "int\nvirSecurityManagerClearSocketLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm)\n{\n    if (mgr->drv->domainClearSecuritySocketLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainClearSecuritySocketLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerClearSocketLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm)\n{\n    if (mgr->drv->domainClearSecuritySocketLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainClearSecuritySocketLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetSocketLabel",
          "args": [
            "item->securityManager",
            "vm"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetSocketLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "498-512",
          "snippet": "int\nvirSecurityManagerSetSocketLabel(virSecurityManagerPtr mgr,\n                                 virDomainDefPtr vm)\n{\n    if (mgr->drv->domainSetSecuritySocketLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecuritySocketLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetSocketLabel(virSecurityManagerPtr mgr,\n                                 virDomainDefPtr vm)\n{\n    if (mgr->drv->domainSetSecuritySocketLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecuritySocketLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetSocketLabel(virSecurityManagerPtr mgr,\n                               virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetSocketLabel(item->securityManager, vm) < 0)\n            goto rollback;\n    }\n\n    return 0;\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerClearSocketLabel(item->securityManager,\n                                               vm) < 0) {\n            VIR_WARN(\"Unable to clear new socket label after failed \"\n                     \"set label call virDriver=%s driver=%s domain=%s\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name);\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackSetDaemonSocketLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "499-524",
    "snippet": "static int\nvirSecurityStackSetDaemonSocketLabel(virSecurityManagerPtr mgr,\n                                     virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetDaemonSocketLabel(item->securityManager, vm) < 0)\n            goto rollback;\n    }\n\n    return 0;\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerClearSocketLabel(item->securityManager,\n                                               vm) < 0) {\n            VIR_WARN(\"Unable to clear new daemon socket label after failed \"\n                     \"set label call virDriver=%s driver=%s domain=%s\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name);\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to clear new daemon socket label after failed \"\n                     \"set label call virDriver=%s driver=%s domain=%s\"",
            "virSecurityManagerGetVirtDriver(mgr)",
            "virSecurityManagerGetDriver(item->securityManager)",
            "vm->name"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetDriver",
          "args": [
            "item->securityManager"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "335-339",
          "snippet": "const char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetVirtDriver",
          "args": [
            "mgr"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetVirtDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "328-332",
          "snippet": "const char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerClearSocketLabel",
          "args": [
            "item->securityManager",
            "vm"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerClearSocketLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "515-529",
          "snippet": "int\nvirSecurityManagerClearSocketLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm)\n{\n    if (mgr->drv->domainClearSecuritySocketLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainClearSecuritySocketLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerClearSocketLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm)\n{\n    if (mgr->drv->domainClearSecuritySocketLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainClearSecuritySocketLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetDaemonSocketLabel",
          "args": [
            "item->securityManager",
            "vm"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetDaemonSocketLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "481-495",
          "snippet": "int\nvirSecurityManagerSetDaemonSocketLabel(virSecurityManagerPtr mgr,\n                                       virDomainDefPtr vm)\n{\n    if (mgr->drv->domainSetSecurityDaemonSocketLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityDaemonSocketLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetDaemonSocketLabel(virSecurityManagerPtr mgr,\n                                       virDomainDefPtr vm)\n{\n    if (mgr->drv->domainSetSecurityDaemonSocketLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityDaemonSocketLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetDaemonSocketLabel(virSecurityManagerPtr mgr,\n                                     virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetDaemonSocketLabel(item->securityManager, vm) < 0)\n            goto rollback;\n    }\n\n    return 0;\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerClearSocketLabel(item->securityManager,\n                                               vm) < 0) {\n            VIR_WARN(\"Unable to clear new daemon socket label after failed \"\n                     \"set label call virDriver=%s driver=%s domain=%s\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name);\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackGetProcessLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "479-496",
    "snippet": "static int\nvirSecurityStackGetProcessLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                pid_t pid,\n                                virSecurityLabelPtr seclabel)\n{\n    int rc = 0;\n\n/* TODO */\n#if 0\n    if (virSecurityManagerGetProcessLabel(priv->secondary, vm, pid, seclabel) < 0)\n        rc = -1;\n#endif\n    if (virSecurityManagerGetProcessLabel(virSecurityStackGetPrimary(mgr), vm, pid, seclabel) < 0)\n        rc = -1;\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerGetProcessLabel",
          "args": [
            "virSecurityStackGetPrimary(mgr)",
            "vm",
            "pid",
            "seclabel"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetProcessLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "899-915",
          "snippet": "int\nvirSecurityManagerGetProcessLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  pid_t pid,\n                                  virSecurityLabelPtr sec)\n{\n    if (mgr->drv->domainGetSecurityProcessLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainGetSecurityProcessLabel(mgr, vm, pid, sec);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerGetProcessLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  pid_t pid,\n                                  virSecurityLabelPtr sec)\n{\n    if (mgr->drv->domainGetSecurityProcessLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainGetSecurityProcessLabel(mgr, vm, pid, sec);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityStackGetPrimary",
          "args": [
            "mgr"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityStackGetPrimary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
          "lines": "71-76",
          "snippet": "virSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_stack.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nvirSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackGetProcessLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                pid_t pid,\n                                virSecurityLabelPtr seclabel)\n{\n    int rc = 0;\n\n/* TODO */\n#if 0\n    if (virSecurityManagerGetProcessLabel(priv->secondary, vm, pid, seclabel) < 0)\n        rc = -1;\n#endif\n    if (virSecurityManagerGetProcessLabel(virSecurityStackGetPrimary(mgr), vm, pid, seclabel) < 0)\n        rc = -1;\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackSetChildProcessLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "462-477",
    "snippet": "static int\nvirSecurityStackSetChildProcessLabel(virSecurityManagerPtr mgr,\n                                     virDomainDefPtr vm,\n                                     virCommandPtr cmd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetChildProcessLabel(item->securityManager, vm, cmd) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerSetChildProcessLabel",
          "args": [
            "item->securityManager",
            "vm",
            "cmd"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetChildProcessLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "935-945",
          "snippet": "int\nvirSecurityManagerSetChildProcessLabel(virSecurityManagerPtr mgr,\n                                       virDomainDefPtr vm,\n                                       virCommandPtr cmd)\n{\n    if (mgr->drv->domainSetSecurityChildProcessLabel)\n       return mgr->drv->domainSetSecurityChildProcessLabel(mgr, vm, cmd);\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetChildProcessLabel(virSecurityManagerPtr mgr,\n                                       virDomainDefPtr vm,\n                                       virCommandPtr cmd)\n{\n    if (mgr->drv->domainSetSecurityChildProcessLabel)\n       return mgr->drv->domainSetSecurityChildProcessLabel(mgr, vm, cmd);\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetChildProcessLabel(virSecurityManagerPtr mgr,\n                                     virDomainDefPtr vm,\n                                     virCommandPtr cmd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetChildProcessLabel(item->securityManager, vm, cmd) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackSetProcessLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "446-460",
    "snippet": "static int\nvirSecurityStackSetProcessLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetProcessLabel(item->securityManager, vm) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerSetProcessLabel",
          "args": [
            "item->securityManager",
            "vm"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetProcessLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "918-932",
          "snippet": "int\nvirSecurityManagerSetProcessLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm)\n{\n    if (mgr->drv->domainSetSecurityProcessLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityProcessLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetProcessLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm)\n{\n    if (mgr->drv->domainSetSecurityProcessLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityProcessLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetProcessLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetProcessLabel(item->securityManager, vm) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackRestoreSavedStateLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "428-443",
    "snippet": "static int\nvirSecurityStackRestoreSavedStateLabel(virSecurityManagerPtr mgr,\n                                       virDomainDefPtr vm,\n                                       const char *savefile)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreSavedStateLabel(item->securityManager, vm, savefile) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreSavedStateLabel",
          "args": [
            "item->securityManager",
            "vm",
            "savefile"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreSavedStateLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "617-632",
          "snippet": "int\nvirSecurityManagerRestoreSavedStateLabel(virSecurityManagerPtr mgr,\n                                         virDomainDefPtr vm,\n                                         const char *savefile)\n{\n    if (mgr->drv->domainRestoreSavedStateLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSavedStateLabel(mgr, vm, savefile);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreSavedStateLabel(virSecurityManagerPtr mgr,\n                                         virDomainDefPtr vm,\n                                         const char *savefile)\n{\n    if (mgr->drv->domainRestoreSavedStateLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSavedStateLabel(mgr, vm, savefile);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackRestoreSavedStateLabel(virSecurityManagerPtr mgr,\n                                       virDomainDefPtr vm,\n                                       const char *savefile)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreSavedStateLabel(item->securityManager, vm, savefile) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackSetSavedStateLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "397-425",
    "snippet": "static int\nvirSecurityStackSetSavedStateLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm,\n                                   const char *savefile)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetSavedStateLabel(item->securityManager, vm, savefile) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreSavedStateLabel(item->securityManager,\n                                                     vm,\n                                                     savefile) < 0) {\n            VIR_WARN(\"Unable to restore saved state label after failed set \"\n                     \"label call virDriver=%s driver=%s savefile=%s\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     savefile);\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to restore saved state label after failed set \"\n                     \"label call virDriver=%s driver=%s savefile=%s\"",
            "virSecurityManagerGetVirtDriver(mgr)",
            "virSecurityManagerGetDriver(item->securityManager)",
            "savefile"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetDriver",
          "args": [
            "item->securityManager"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "335-339",
          "snippet": "const char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetVirtDriver",
          "args": [
            "mgr"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetVirtDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "328-332",
          "snippet": "const char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreSavedStateLabel",
          "args": [
            "item->securityManager",
            "vm",
            "savefile"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreSavedStateLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "617-632",
          "snippet": "int\nvirSecurityManagerRestoreSavedStateLabel(virSecurityManagerPtr mgr,\n                                         virDomainDefPtr vm,\n                                         const char *savefile)\n{\n    if (mgr->drv->domainRestoreSavedStateLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSavedStateLabel(mgr, vm, savefile);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreSavedStateLabel(virSecurityManagerPtr mgr,\n                                         virDomainDefPtr vm,\n                                         const char *savefile)\n{\n    if (mgr->drv->domainRestoreSavedStateLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSavedStateLabel(mgr, vm, savefile);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetSavedStateLabel",
          "args": [
            "item->securityManager",
            "vm",
            "savefile"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetSavedStateLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "600-615",
          "snippet": "int\nvirSecurityManagerSetSavedStateLabel(virSecurityManagerPtr mgr,\n                                     virDomainDefPtr vm,\n                                     const char *savefile)\n{\n    if (mgr->drv->domainSetSavedStateLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSavedStateLabel(mgr, vm, savefile);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetSavedStateLabel(virSecurityManagerPtr mgr,\n                                     virDomainDefPtr vm,\n                                     const char *savefile)\n{\n    if (mgr->drv->domainSetSavedStateLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSavedStateLabel(mgr, vm, savefile);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetSavedStateLabel(virSecurityManagerPtr mgr,\n                                   virDomainDefPtr vm,\n                                   const char *savefile)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetSavedStateLabel(item->securityManager, vm, savefile) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreSavedStateLabel(item->securityManager,\n                                                     vm,\n                                                     savefile) < 0) {\n            VIR_WARN(\"Unable to restore saved state label after failed set \"\n                     \"label call virDriver=%s driver=%s savefile=%s\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     savefile);\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackRestoreAllLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "377-394",
    "snippet": "static int\nvirSecurityStackRestoreAllLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                bool migrated,\n                                bool chardevStdioLogd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreAllLabel(item->securityManager, vm,\n                                              migrated, chardevStdioLogd) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreAllLabel",
          "args": [
            "item->securityManager",
            "vm",
            "migrated",
            "chardevStdioLogd"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreAllLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "880-897",
          "snippet": "int\nvirSecurityManagerRestoreAllLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  bool migrated,\n                                  bool chardevStdioLogd)\n{\n    if (mgr->drv->domainRestoreSecurityAllLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityAllLabel(mgr, vm, migrated,\n                                                      chardevStdioLogd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreAllLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  bool migrated,\n                                  bool chardevStdioLogd)\n{\n    if (mgr->drv->domainRestoreSecurityAllLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityAllLabel(mgr, vm, migrated,\n                                                      chardevStdioLogd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackRestoreAllLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                bool migrated,\n                                bool chardevStdioLogd)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreAllLabel(item->securityManager, vm,\n                                              migrated, chardevStdioLogd) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackSetAllLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "341-374",
    "snippet": "static int\nvirSecurityStackSetAllLabel(virSecurityManagerPtr mgr,\n                            virDomainDefPtr vm,\n                            const char *stdin_path,\n                            bool chardevStdioLogd,\n                            bool migrated)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetAllLabel(item->securityManager, vm,\n                                          stdin_path, chardevStdioLogd,\n                                          migrated) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreAllLabel(item->securityManager,\n                                              vm,\n                                              migrated,\n                                              chardevStdioLogd) < 0) {\n            VIR_WARN(\"Unable to restore all labels after failed set label call \"\n                     \"virDriver=%s driver=%s domain=%s migrated=%d\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name, migrated);\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to restore all labels after failed set label call \"\n                     \"virDriver=%s driver=%s domain=%s migrated=%d\"",
            "virSecurityManagerGetVirtDriver(mgr)",
            "virSecurityManagerGetDriver(item->securityManager)",
            "vm->name",
            "migrated"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetDriver",
          "args": [
            "item->securityManager"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "335-339",
          "snippet": "const char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetVirtDriver",
          "args": [
            "mgr"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetVirtDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "328-332",
          "snippet": "const char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreAllLabel",
          "args": [
            "item->securityManager",
            "vm",
            "migrated",
            "chardevStdioLogd"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreAllLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "880-897",
          "snippet": "int\nvirSecurityManagerRestoreAllLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  bool migrated,\n                                  bool chardevStdioLogd)\n{\n    if (mgr->drv->domainRestoreSecurityAllLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityAllLabel(mgr, vm, migrated,\n                                                      chardevStdioLogd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreAllLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  bool migrated,\n                                  bool chardevStdioLogd)\n{\n    if (mgr->drv->domainRestoreSecurityAllLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityAllLabel(mgr, vm, migrated,\n                                                      chardevStdioLogd);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetAllLabel",
          "args": [
            "item->securityManager",
            "vm",
            "stdin_path",
            "chardevStdioLogd",
            "migrated"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetAllLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "858-877",
          "snippet": "int\nvirSecurityManagerSetAllLabel(virSecurityManagerPtr mgr,\n                              virDomainDefPtr vm,\n                              const char *stdin_path,\n                              bool chardevStdioLogd,\n                              bool migrated)\n{\n    if (mgr->drv->domainSetSecurityAllLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityAllLabel(mgr, vm, stdin_path,\n                                                  chardevStdioLogd,\n                                                  migrated);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetAllLabel(virSecurityManagerPtr mgr,\n                              virDomainDefPtr vm,\n                              const char *stdin_path,\n                              bool chardevStdioLogd,\n                              bool migrated)\n{\n    if (mgr->drv->domainSetSecurityAllLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityAllLabel(mgr, vm, stdin_path,\n                                                  chardevStdioLogd,\n                                                  migrated);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetAllLabel(virSecurityManagerPtr mgr,\n                            virDomainDefPtr vm,\n                            const char *stdin_path,\n                            bool chardevStdioLogd,\n                            bool migrated)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetAllLabel(item->securityManager, vm,\n                                          stdin_path, chardevStdioLogd,\n                                          migrated) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreAllLabel(item->securityManager,\n                                              vm,\n                                              migrated,\n                                              chardevStdioLogd) < 0) {\n            VIR_WARN(\"Unable to restore all labels after failed set label call \"\n                     \"virDriver=%s driver=%s domain=%s migrated=%d\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name, migrated);\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackRestoreHostdevLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "319-338",
    "snippet": "static int\nvirSecurityStackRestoreHostdevLabel(virSecurityManagerPtr mgr,\n                                    virDomainDefPtr vm,\n                                    virDomainHostdevDefPtr dev,\n                                    const char *vroot)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreHostdevLabel(item->securityManager,\n                                                  vm,\n                                                  dev,\n                                                  vroot) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreHostdevLabel",
          "args": [
            "item->securityManager",
            "vm",
            "dev",
            "vroot"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreHostdevLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "562-578",
          "snippet": "int\nvirSecurityManagerRestoreHostdevLabel(virSecurityManagerPtr mgr,\n                                      virDomainDefPtr vm,\n                                      virDomainHostdevDefPtr dev,\n                                      const char *vroot)\n{\n    if (mgr->drv->domainRestoreSecurityHostdevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityHostdevLabel(mgr, vm, dev, vroot);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreHostdevLabel(virSecurityManagerPtr mgr,\n                                      virDomainDefPtr vm,\n                                      virDomainHostdevDefPtr dev,\n                                      const char *vroot)\n{\n    if (mgr->drv->domainRestoreSecurityHostdevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityHostdevLabel(mgr, vm, dev, vroot);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackRestoreHostdevLabel(virSecurityManagerPtr mgr,\n                                    virDomainDefPtr vm,\n                                    virDomainHostdevDefPtr dev,\n                                    const char *vroot)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerRestoreHostdevLabel(item->securityManager,\n                                                  vm,\n                                                  dev,\n                                                  vroot) < 0)\n            rc = -1;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackSetHostdevLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "282-316",
    "snippet": "static int\nvirSecurityStackSetHostdevLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                virDomainHostdevDefPtr dev,\n                                const char *vroot)\n\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetHostdevLabel(item->securityManager,\n                                              vm,\n                                              dev,\n                                              vroot) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreHostdevLabel(item->securityManager,\n                                                  vm,\n                                                  dev,\n                                                  vroot) < 0) {\n            VIR_WARN(\"Unable to restore hostdev label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s hostdev=%p\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name, dev);\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to restore hostdev label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s hostdev=%p\"",
            "virSecurityManagerGetVirtDriver(mgr)",
            "virSecurityManagerGetDriver(item->securityManager)",
            "vm->name",
            "dev"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetDriver",
          "args": [
            "item->securityManager"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "335-339",
          "snippet": "const char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->drv->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetVirtDriver",
          "args": [
            "mgr"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetVirtDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "328-332",
          "snippet": "const char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetVirtDriver(virSecurityManagerPtr mgr)\n{\n    return mgr->virtDriver;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerRestoreHostdevLabel",
          "args": [
            "item->securityManager",
            "vm",
            "dev",
            "vroot"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerRestoreHostdevLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "562-578",
          "snippet": "int\nvirSecurityManagerRestoreHostdevLabel(virSecurityManagerPtr mgr,\n                                      virDomainDefPtr vm,\n                                      virDomainHostdevDefPtr dev,\n                                      const char *vroot)\n{\n    if (mgr->drv->domainRestoreSecurityHostdevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityHostdevLabel(mgr, vm, dev, vroot);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerRestoreHostdevLabel(virSecurityManagerPtr mgr,\n                                      virDomainDefPtr vm,\n                                      virDomainHostdevDefPtr dev,\n                                      const char *vroot)\n{\n    if (mgr->drv->domainRestoreSecurityHostdevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainRestoreSecurityHostdevLabel(mgr, vm, dev, vroot);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetHostdevLabel",
          "args": [
            "item->securityManager",
            "vm",
            "dev",
            "vroot"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetHostdevLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "581-597",
          "snippet": "int\nvirSecurityManagerSetHostdevLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  virDomainHostdevDefPtr dev,\n                                  const char *vroot)\n{\n    if (mgr->drv->domainSetSecurityHostdevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityHostdevLabel(mgr, vm, dev, vroot);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetHostdevLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  virDomainHostdevDefPtr dev,\n                                  const char *vroot)\n{\n    if (mgr->drv->domainSetSecurityHostdevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityHostdevLabel(mgr, vm, dev, vroot);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackSetHostdevLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                virDomainHostdevDefPtr dev,\n                                const char *vroot)\n\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerSetHostdevLabel(item->securityManager,\n                                              vm,\n                                              dev,\n                                              vroot) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev) {\n        if (virSecurityManagerRestoreHostdevLabel(item->securityManager,\n                                                  vm,\n                                                  dev,\n                                                  vroot) < 0) {\n            VIR_WARN(\"Unable to restore hostdev label after failed set label \"\n                     \"call virDriver=%s driver=%s domain=%s hostdev=%p\",\n                     virSecurityManagerGetVirtDriver(mgr),\n                     virSecurityManagerGetDriver(item->securityManager),\n                     vm->name, dev);\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackReserveLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "262-279",
    "snippet": "static int\nvirSecurityStackReserveLabel(virSecurityManagerPtr mgr,\n                             virDomainDefPtr vm,\n                             pid_t pid)\n{\n    int rc = 0;\n\n    if (virSecurityManagerReserveLabel(virSecurityStackGetPrimary(mgr), vm, pid) < 0)\n        rc = -1;\n/* TODO */\n#if 0\n    /* XXX See note in GenLabel */\n    if (virSecurityManagerReserveLabel(priv->secondary, vm, pid) < 0)\n        rc = -1;\n#endif\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerReserveLabel",
          "args": [
            "priv->secondary",
            "vm",
            "pid"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerReserveLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "716-731",
          "snippet": "int\nvirSecurityManagerReserveLabel(virSecurityManagerPtr mgr,\n                               virDomainDefPtr vm,\n                               pid_t pid)\n{\n    if (mgr->drv->domainReserveSecurityLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainReserveSecurityLabel(mgr, vm, pid);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerReserveLabel(virSecurityManagerPtr mgr,\n                               virDomainDefPtr vm,\n                               pid_t pid)\n{\n    if (mgr->drv->domainReserveSecurityLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainReserveSecurityLabel(mgr, vm, pid);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityStackGetPrimary",
          "args": [
            "mgr"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityStackGetPrimary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
          "lines": "71-76",
          "snippet": "virSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_stack.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nvirSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackReserveLabel(virSecurityManagerPtr mgr,\n                             virDomainDefPtr vm,\n                             pid_t pid)\n{\n    int rc = 0;\n\n    if (virSecurityManagerReserveLabel(virSecurityStackGetPrimary(mgr), vm, pid) < 0)\n        rc = -1;\n/* TODO */\n#if 0\n    /* XXX See note in GenLabel */\n    if (virSecurityManagerReserveLabel(priv->secondary, vm, pid) < 0)\n        rc = -1;\n#endif\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackReleaseLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "242-259",
    "snippet": "static int\nvirSecurityStackReleaseLabel(virSecurityManagerPtr mgr,\n                             virDomainDefPtr vm)\n{\n    int rc = 0;\n\n    if (virSecurityManagerReleaseLabel(virSecurityStackGetPrimary(mgr), vm) < 0)\n        rc = -1;\n\n/* TODO */\n#if 0\n    /* XXX See note in GenLabel */\n    if (virSecurityManagerReleaseLabel(priv->secondary, vm) < 0)\n        rc = -1;\n#endif\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerReleaseLabel",
          "args": [
            "priv->secondary",
            "vm"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerReleaseLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "734-748",
          "snippet": "int\nvirSecurityManagerReleaseLabel(virSecurityManagerPtr mgr,\n                               virDomainDefPtr vm)\n{\n    if (mgr->drv->domainReleaseSecurityLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainReleaseSecurityLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerReleaseLabel(virSecurityManagerPtr mgr,\n                               virDomainDefPtr vm)\n{\n    if (mgr->drv->domainReleaseSecurityLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainReleaseSecurityLabel(mgr, vm);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityStackGetPrimary",
          "args": [
            "mgr"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityStackGetPrimary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
          "lines": "71-76",
          "snippet": "virSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_stack.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nvirSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackReleaseLabel(virSecurityManagerPtr mgr,\n                             virDomainDefPtr vm)\n{\n    int rc = 0;\n\n    if (virSecurityManagerReleaseLabel(virSecurityStackGetPrimary(mgr), vm) < 0)\n        rc = -1;\n\n/* TODO */\n#if 0\n    /* XXX See note in GenLabel */\n    if (virSecurityManagerReleaseLabel(priv->secondary, vm) < 0)\n        rc = -1;\n#endif\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackGenLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "217-239",
    "snippet": "static int\nvirSecurityStackGenLabel(virSecurityManagerPtr mgr,\n                         virDomainDefPtr vm)\n{\n    int rc = 0;\n\n    if (virSecurityManagerGenLabel(virSecurityStackGetPrimary(mgr), vm) < 0)\n        rc = -1;\n\n/* TODO */\n#if 0\n    /* We don't allow secondary drivers to generate labels.\n     * This may have to change in the future, but requires\n     * changes elsewhere in domain_conf.c and capabilities.c\n     * XML formats first, to allow recording of multiple\n     * labels\n     */\n    if (virSecurityManagerGenLabel(priv->secondary, vm) < 0)\n        rc = -1;\n#endif\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerGenLabel",
          "args": [
            "priv->secondary",
            "vm"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGenLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "635-713",
          "snippet": "int\nvirSecurityManagerGenLabel(virSecurityManagerPtr mgr,\n                           virDomainDefPtr vm)\n{\n    int ret = -1;\n    size_t i;\n    virSecurityManagerPtr* sec_managers = NULL;\n    virSecurityLabelDefPtr seclabel;\n    bool generated = false;\n\n    if ((sec_managers = virSecurityManagerGetNested(mgr)) == NULL)\n        return ret;\n\n    virObjectLock(mgr);\n\n    for (i = 0; sec_managers[i]; i++) {\n        generated = false;\n        seclabel = virDomainDefGetSecurityLabelDef(vm, sec_managers[i]->drv->name);\n        if (seclabel == NULL) {\n            /* Only generate seclabel if confinement is enabled */\n            if (!virSecurityManagerGetDefaultConfined(sec_managers[i])) {\n                VIR_DEBUG(\"Skipping auto generated seclabel\");\n                continue;\n            } else {\n                if (!(seclabel = virSecurityLabelDefNew(sec_managers[i]->drv->name)))\n                    goto cleanup;\n                generated = seclabel->implicit = true;\n                seclabel->type = VIR_DOMAIN_SECLABEL_DYNAMIC;\n            }\n        } else {\n            if (seclabel->type == VIR_DOMAIN_SECLABEL_DEFAULT) {\n                if (virSecurityManagerGetDefaultConfined(sec_managers[i])) {\n                    seclabel->type = VIR_DOMAIN_SECLABEL_DYNAMIC;\n                } else {\n                    seclabel->type = VIR_DOMAIN_SECLABEL_NONE;\n                    seclabel->relabel = false;\n                }\n            }\n\n            if (seclabel->type == VIR_DOMAIN_SECLABEL_NONE) {\n                if (virSecurityManagerGetRequireConfined(sec_managers[i])) {\n                    virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                                   _(\"Unconfined guests are not allowed on this host\"));\n                    goto cleanup;\n                }\n            }\n        }\n\n        if (!sec_managers[i]->drv->domainGenSecurityLabel) {\n            virReportUnsupportedError();\n            virSecurityLabelDefFree(seclabel);\n            seclabel = NULL;\n        } else {\n            /* The seclabel must be added to @vm prior calling domainGenSecurityLabel\n             * which may require seclabel to be presented already */\n            if (generated &&\n                VIR_APPEND_ELEMENT(vm->seclabels, vm->nseclabels, seclabel) < 0)\n                goto cleanup;\n\n            if (sec_managers[i]->drv->domainGenSecurityLabel(sec_managers[i], vm) < 0) {\n                if (VIR_DELETE_ELEMENT(vm->seclabels,\n                                       vm->nseclabels -1, vm->nseclabels) < 0)\n                    vm->nseclabels--;\n                goto cleanup;\n            }\n\n            seclabel = NULL;\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(mgr);\n    if (generated)\n        virSecurityLabelDefFree(seclabel);\n    VIR_FREE(sec_managers);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerGenLabel(virSecurityManagerPtr mgr,\n                           virDomainDefPtr vm)\n{\n    int ret = -1;\n    size_t i;\n    virSecurityManagerPtr* sec_managers = NULL;\n    virSecurityLabelDefPtr seclabel;\n    bool generated = false;\n\n    if ((sec_managers = virSecurityManagerGetNested(mgr)) == NULL)\n        return ret;\n\n    virObjectLock(mgr);\n\n    for (i = 0; sec_managers[i]; i++) {\n        generated = false;\n        seclabel = virDomainDefGetSecurityLabelDef(vm, sec_managers[i]->drv->name);\n        if (seclabel == NULL) {\n            /* Only generate seclabel if confinement is enabled */\n            if (!virSecurityManagerGetDefaultConfined(sec_managers[i])) {\n                VIR_DEBUG(\"Skipping auto generated seclabel\");\n                continue;\n            } else {\n                if (!(seclabel = virSecurityLabelDefNew(sec_managers[i]->drv->name)))\n                    goto cleanup;\n                generated = seclabel->implicit = true;\n                seclabel->type = VIR_DOMAIN_SECLABEL_DYNAMIC;\n            }\n        } else {\n            if (seclabel->type == VIR_DOMAIN_SECLABEL_DEFAULT) {\n                if (virSecurityManagerGetDefaultConfined(sec_managers[i])) {\n                    seclabel->type = VIR_DOMAIN_SECLABEL_DYNAMIC;\n                } else {\n                    seclabel->type = VIR_DOMAIN_SECLABEL_NONE;\n                    seclabel->relabel = false;\n                }\n            }\n\n            if (seclabel->type == VIR_DOMAIN_SECLABEL_NONE) {\n                if (virSecurityManagerGetRequireConfined(sec_managers[i])) {\n                    virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                                   _(\"Unconfined guests are not allowed on this host\"));\n                    goto cleanup;\n                }\n            }\n        }\n\n        if (!sec_managers[i]->drv->domainGenSecurityLabel) {\n            virReportUnsupportedError();\n            virSecurityLabelDefFree(seclabel);\n            seclabel = NULL;\n        } else {\n            /* The seclabel must be added to @vm prior calling domainGenSecurityLabel\n             * which may require seclabel to be presented already */\n            if (generated &&\n                VIR_APPEND_ELEMENT(vm->seclabels, vm->nseclabels, seclabel) < 0)\n                goto cleanup;\n\n            if (sec_managers[i]->drv->domainGenSecurityLabel(sec_managers[i], vm) < 0) {\n                if (VIR_DELETE_ELEMENT(vm->seclabels,\n                                       vm->nseclabels -1, vm->nseclabels) < 0)\n                    vm->nseclabels--;\n                goto cleanup;\n            }\n\n            seclabel = NULL;\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(mgr);\n    if (generated)\n        virSecurityLabelDefFree(seclabel);\n    VIR_FREE(sec_managers);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityStackGetPrimary",
          "args": [
            "mgr"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityStackGetPrimary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
          "lines": "71-76",
          "snippet": "virSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_stack.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nvirSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackGenLabel(virSecurityManagerPtr mgr,\n                         virDomainDefPtr vm)\n{\n    int rc = 0;\n\n    if (virSecurityManagerGenLabel(virSecurityStackGetPrimary(mgr), vm) < 0)\n        rc = -1;\n\n/* TODO */\n#if 0\n    /* We don't allow secondary drivers to generate labels.\n     * This may have to change in the future, but requires\n     * changes elsewhere in domain_conf.c and capabilities.c\n     * XML formats first, to allow recording of multiple\n     * labels\n     */\n    if (virSecurityManagerGenLabel(priv->secondary, vm) < 0)\n        rc = -1;\n#endif\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackVerify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "198-214",
    "snippet": "static int\nvirSecurityStackVerify(virSecurityManagerPtr mgr,\n                       virDomainDefPtr def)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerVerify(item->securityManager, def) < 0) {\n            rc = -1;\n            break;\n        }\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerVerify",
          "args": [
            "item->securityManager",
            "def"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerVerify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "948-975",
          "snippet": "int\nvirSecurityManagerVerify(virSecurityManagerPtr mgr,\n                         virDomainDefPtr def)\n{\n    virSecurityLabelDefPtr secdef;\n\n    if (mgr == NULL || mgr->drv == NULL)\n        return 0;\n\n    /* NULL model == dynamic labelling, with whatever driver\n     * is active, so we can short circuit verify check to\n     * avoid drivers de-referencing NULLs by accident\n     */\n    secdef = virDomainDefGetSecurityLabelDef(def, mgr->drv->name);\n    if (secdef == NULL || secdef->model == NULL)\n        return 0;\n\n    if (mgr->drv->domainSecurityVerify) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSecurityVerify(mgr, def);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerVerify(virSecurityManagerPtr mgr,\n                         virDomainDefPtr def)\n{\n    virSecurityLabelDefPtr secdef;\n\n    if (mgr == NULL || mgr->drv == NULL)\n        return 0;\n\n    /* NULL model == dynamic labelling, with whatever driver\n     * is active, so we can short circuit verify check to\n     * avoid drivers de-referencing NULLs by accident\n     */\n    secdef = virDomainDefGetSecurityLabelDef(def, mgr->drv->name);\n    if (secdef == NULL || secdef->model == NULL)\n        return 0;\n\n    if (mgr->drv->domainSecurityVerify) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSecurityVerify(mgr, def);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackVerify(virSecurityManagerPtr mgr,\n                       virDomainDefPtr def)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerVerify(item->securityManager, def) < 0) {\n            rc = -1;\n            break;\n        }\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackTransactionAbort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "187-195",
    "snippet": "static void\nvirSecurityStackTransactionAbort(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next)\n        virSecurityManagerTransactionAbort(item->securityManager);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerTransactionAbort",
          "args": [
            "item->securityManager"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerTransactionAbort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "311-318",
          "snippet": "void\nvirSecurityManagerTransactionAbort(virSecurityManagerPtr mgr)\n{\n    virObjectLock(mgr);\n    if (mgr->drv->transactionAbort)\n        mgr->drv->transactionAbort(mgr);\n    virObjectUnlock(mgr);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirSecurityManagerTransactionAbort(virSecurityManagerPtr mgr)\n{\n    virObjectLock(mgr);\n    if (mgr->drv->transactionAbort)\n        mgr->drv->transactionAbort(mgr);\n    virObjectUnlock(mgr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic void\nvirSecurityStackTransactionAbort(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next)\n        virSecurityManagerTransactionAbort(item->securityManager);\n}"
  },
  {
    "function_name": "virSecurityStackTransactionCommit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "165-184",
    "snippet": "static int\nvirSecurityStackTransactionCommit(virSecurityManagerPtr mgr,\n                                  pid_t pid,\n                                  bool lock)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerTransactionCommit(item->securityManager, pid, lock) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev)\n        virSecurityManagerTransactionAbort(item->securityManager);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerTransactionAbort",
          "args": [
            "item->securityManager"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerTransactionAbort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "311-318",
          "snippet": "void\nvirSecurityManagerTransactionAbort(virSecurityManagerPtr mgr)\n{\n    virObjectLock(mgr);\n    if (mgr->drv->transactionAbort)\n        mgr->drv->transactionAbort(mgr);\n    virObjectUnlock(mgr);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirSecurityManagerTransactionAbort(virSecurityManagerPtr mgr)\n{\n    virObjectLock(mgr);\n    if (mgr->drv->transactionAbort)\n        mgr->drv->transactionAbort(mgr);\n    virObjectUnlock(mgr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerTransactionCommit",
          "args": [
            "item->securityManager",
            "pid",
            "lock"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerTransactionCommit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "290-302",
          "snippet": "int\nvirSecurityManagerTransactionCommit(virSecurityManagerPtr mgr,\n                                    pid_t pid,\n                                    bool lock)\n{\n    int ret = 0;\n\n    virObjectLock(mgr);\n    if (mgr->drv->transactionCommit)\n        ret = mgr->drv->transactionCommit(mgr, pid, lock);\n    virObjectUnlock(mgr);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerTransactionCommit(virSecurityManagerPtr mgr,\n                                    pid_t pid,\n                                    bool lock)\n{\n    int ret = 0;\n\n    virObjectLock(mgr);\n    if (mgr->drv->transactionCommit)\n        ret = mgr->drv->transactionCommit(mgr, pid, lock);\n    virObjectUnlock(mgr);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackTransactionCommit(virSecurityManagerPtr mgr,\n                                  pid_t pid,\n                                  bool lock)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerTransactionCommit(item->securityManager, pid, lock) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev)\n        virSecurityManagerTransactionAbort(item->securityManager);\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackTransactionStart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "145-162",
    "snippet": "static int\nvirSecurityStackTransactionStart(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerTransactionStart(item->securityManager) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev)\n        virSecurityManagerTransactionAbort(item->securityManager);\n    return -1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerTransactionAbort",
          "args": [
            "item->securityManager"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerTransactionAbort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "311-318",
          "snippet": "void\nvirSecurityManagerTransactionAbort(virSecurityManagerPtr mgr)\n{\n    virObjectLock(mgr);\n    if (mgr->drv->transactionAbort)\n        mgr->drv->transactionAbort(mgr);\n    virObjectUnlock(mgr);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirSecurityManagerTransactionAbort(virSecurityManagerPtr mgr)\n{\n    virObjectLock(mgr);\n    if (mgr->drv->transactionAbort)\n        mgr->drv->transactionAbort(mgr);\n    virObjectUnlock(mgr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerTransactionStart",
          "args": [
            "item->securityManager"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerTransactionStart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "255-265",
          "snippet": "int\nvirSecurityManagerTransactionStart(virSecurityManagerPtr mgr)\n{\n    int ret = 0;\n\n    virObjectLock(mgr);\n    if (mgr->drv->transactionStart)\n        ret = mgr->drv->transactionStart(mgr);\n    virObjectUnlock(mgr);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerTransactionStart(virSecurityManagerPtr mgr)\n{\n    int ret = 0;\n\n    virObjectLock(mgr);\n    if (mgr->drv->transactionStart)\n        ret = mgr->drv->transactionStart(mgr);\n    virObjectUnlock(mgr);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackTransactionStart(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n\n    for (; item; item = item->next) {\n        if (virSecurityManagerTransactionStart(item->securityManager) < 0)\n            goto rollback;\n    }\n\n    return 0;\n\n rollback:\n    for (item = item->prev; item; item = item->prev)\n        virSecurityManagerTransactionAbort(item->securityManager);\n    return -1;\n}"
  },
  {
    "function_name": "virSecurityStackPreFork",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "118-142",
    "snippet": "static int\nvirSecurityStackPreFork(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    /* XXX For now, we rely on no driver having any state that requires\n     * rollback if a later driver in the stack fails; if this changes,\n     * we'd need to split this into transaction semantics by dividing\n     * the work into prepare/commit/abort.  */\n    for (; item; item = item->next) {\n        if (virSecurityManagerPreFork(item->securityManager) < 0) {\n            rc = -1;\n            break;\n        }\n        /* Undo the unbalanced locking left behind after recursion; if\n         * PostFork ever delegates to driver callbacks, we'd instead\n         * need to recurse to an internal method that does not regrab\n         * a lock. */\n        virSecurityManagerPostFork(item->securityManager);\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerPostFork",
          "args": [
            "item->securityManager"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerPostFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "238-242",
          "snippet": "void\nvirSecurityManagerPostFork(virSecurityManagerPtr mgr)\n{\n    virObjectUnlock(mgr);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirSecurityManagerPostFork(virSecurityManagerPtr mgr)\n{\n    virObjectUnlock(mgr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerPreFork",
          "args": [
            "item->securityManager"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerPreFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "218-231",
          "snippet": "int\nvirSecurityManagerPreFork(virSecurityManagerPtr mgr)\n{\n    int ret = 0;\n\n    virObjectLock(mgr);\n    if (mgr->drv->preFork) {\n        ret = mgr->drv->preFork(mgr);\n        if (ret < 0)\n            virObjectUnlock(mgr);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerPreFork(virSecurityManagerPtr mgr)\n{\n    int ret = 0;\n\n    virObjectLock(mgr);\n    if (mgr->drv->preFork) {\n        ret = mgr->drv->preFork(mgr);\n        if (ret < 0)\n            virObjectUnlock(mgr);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackPreFork(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr item = priv->itemsHead;\n    int rc = 0;\n\n    /* XXX For now, we rely on no driver having any state that requires\n     * rollback if a later driver in the stack fails; if this changes,\n     * we'd need to split this into transaction semantics by dividing\n     * the work into prepare/commit/abort.  */\n    for (; item; item = item->next) {\n        if (virSecurityManagerPreFork(item->securityManager) < 0) {\n            rc = -1;\n            break;\n        }\n        /* Undo the unbalanced locking left behind after recursion; if\n         * PostFork ever delegates to driver callbacks, we'd instead\n         * need to recurse to an internal method that does not regrab\n         * a lock. */\n        virSecurityManagerPostFork(item->securityManager);\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virSecurityStackGetDOI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "112-116",
    "snippet": "static const char *\nvirSecurityStackGetDOI(virSecurityManagerPtr mgr)\n{\n    return virSecurityManagerGetDOI(virSecurityStackGetPrimary(mgr));\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerGetDOI",
          "args": [
            "virSecurityStackGetPrimary(mgr)"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetDOI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "342-355",
          "snippet": "const char *\nvirSecurityManagerGetDOI(virSecurityManagerPtr mgr)\n{\n    if (mgr->drv->getDOI) {\n        const char *ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->getDOI(mgr);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return NULL;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetDOI(virSecurityManagerPtr mgr)\n{\n    if (mgr->drv->getDOI) {\n        const char *ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->getDOI(mgr);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityStackGetPrimary",
          "args": [
            "mgr"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityStackGetPrimary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
          "lines": "71-76",
          "snippet": "virSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_stack.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nvirSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic const char *\nvirSecurityStackGetDOI(virSecurityManagerPtr mgr)\n{\n    return virSecurityManagerGetDOI(virSecurityStackGetPrimary(mgr));\n}"
  },
  {
    "function_name": "virSecurityStackGetModel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "106-110",
    "snippet": "static const char *\nvirSecurityStackGetModel(virSecurityManagerPtr mgr)\n{\n    return virSecurityManagerGetModel(virSecurityStackGetPrimary(mgr));\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerGetModel",
          "args": [
            "virSecurityStackGetPrimary(mgr)"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetModel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "358-371",
          "snippet": "const char *\nvirSecurityManagerGetModel(virSecurityManagerPtr mgr)\n{\n    if (mgr->drv->getModel) {\n        const char *ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->getModel(mgr);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return NULL;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nconst char *\nvirSecurityManagerGetModel(virSecurityManagerPtr mgr)\n{\n    if (mgr->drv->getModel) {\n        const char *ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->getModel(mgr);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityStackGetPrimary",
          "args": [
            "mgr"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityStackGetPrimary",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
          "lines": "71-76",
          "snippet": "virSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_stack.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nvirSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic const char *\nvirSecurityStackGetModel(virSecurityManagerPtr mgr)\n{\n    return virSecurityManagerGetModel(virSecurityStackGetPrimary(mgr));\n}"
  },
  {
    "function_name": "virSecurityStackClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "90-104",
    "snippet": "static int\nvirSecurityStackClose(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr next, item = priv->itemsHead;\n\n    while (item) {\n        next = item->next;\n        virObjectUnref(item->securityManager);\n        VIR_FREE(item);\n        item = next;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "item"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "item->securityManager"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackClose(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr next, item = priv->itemsHead;\n\n    while (item) {\n        next = item->next;\n        virObjectUnref(item->securityManager);\n        VIR_FREE(item);\n        item = next;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virSecurityStackOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "84-88",
    "snippet": "static int\nvirSecurityStackOpen(virSecurityManagerPtr mgr G_GNUC_UNUSED)\n{\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic int\nvirSecurityStackOpen(virSecurityManagerPtr mgr G_GNUC_UNUSED)\n{\n    return 0;\n}"
  },
  {
    "function_name": "virSecurityStackProbe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "78-82",
    "snippet": "static virSecurityDriverStatus\nvirSecurityStackProbe(const char *virtDriver G_GNUC_UNUSED)\n{\n    return SECURITY_DRIVER_ENABLE;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nstatic virSecurityDriverStatus\nvirSecurityStackProbe(const char *virtDriver G_GNUC_UNUSED)\n{\n    return SECURITY_DRIVER_ENABLE;\n}"
  },
  {
    "function_name": "virSecurityStackGetPrimary",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "71-76",
    "snippet": "virSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nvirSecurityManagerPtr\nvirSecurityStackGetPrimary(virSecurityManagerPtr mgr)\n{\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    return priv->itemsHead->securityManager;\n}"
  },
  {
    "function_name": "virSecurityStackAddNested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_stack.c",
    "lines": "47-69",
    "snippet": "int\nvirSecurityStackAddNested(virSecurityManagerPtr mgr,\n                          virSecurityManagerPtr nested)\n{\n    virSecurityStackItemPtr item = NULL;\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr tmp;\n\n    tmp = priv->itemsHead;\n    while (tmp && tmp->next)\n        tmp = tmp->next;\n\n    if (VIR_ALLOC(item) < 0)\n        return -1;\n    item->securityManager = nested;\n    item->prev = tmp;\n    if (tmp)\n        tmp->next = item;\n    else\n        priv->itemsHead = item;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"security_stack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "item"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetPrivateData",
          "args": [
            "mgr"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "321-325",
          "snippet": "void *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid *\nvirSecurityManagerGetPrivateData(virSecurityManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_stack.h\"\n#include <config.h>\n\nint\nvirSecurityStackAddNested(virSecurityManagerPtr mgr,\n                          virSecurityManagerPtr nested)\n{\n    virSecurityStackItemPtr item = NULL;\n    virSecurityStackDataPtr priv = virSecurityManagerGetPrivateData(mgr);\n    virSecurityStackItemPtr tmp;\n\n    tmp = priv->itemsHead;\n    while (tmp && tmp->next)\n        tmp = tmp->next;\n\n    if (VIR_ALLOC(item) < 0)\n        return -1;\n    item->securityManager = nested;\n    item->prev = tmp;\n    if (tmp)\n        tmp->next = item;\n    else\n        priv->itemsHead = item;\n\n    return 0;\n}"
  }
]